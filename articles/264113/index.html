<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code contracts vs incoming data validation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The validation rules for incoming data are often mistaken for contracts in the code (as, indeed, vice versa). Let's see what is the difference between...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Code contracts vs incoming data validation</h1><div class="post__text post__text-html js-mediator-article">  The validation rules for incoming data are often mistaken for contracts in the code (as, indeed, vice versa).  Let's see what is the difference between these two concepts and in what cases they are applicable. <br><a name="habracut"></a><br><h2>  Code contracts: preconditions </h2><br>  What is the purpose of the use of contracts in the code, namely preconditions, postconditions and invariants?  The idea is closely related to the <a href="https://en.wikipedia.org/wiki/Fail-fast">Fail-fast principle</a> : the sooner you notice unexpected behavior, the faster you will correct it. <br><br>  In most cases, it is more effective to let an application crash, rather than try to recover automatically from an error, because  You never know for sure what exactly this error is and how it will affect the application.  Continuing the work of the software after an error in it can lead to inconsistent data state in the database. <br><br>  So what are contract preconditions and how do they differ from validating incoming data?  The key point here is that a <b>violation of the precondition always indicates the presence of a bug in the client code</b> .  Invalid input data, on the other hand, are not an error in the system operation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is the main difference, all others are the result of it.  Let's look at them in more detail. <br><br><h2>  Differences between contract preconditions and validation of incoming data </h2><br>  Contract preconditions can be thought of as a shield placed inside your code to make sure everything goes well.  On the other hand, validation of incoming data is a screen placed for ‚Äúdefense‚Äù against the outside world: <br><br><div style="text-align:center;"><img height="50%" width="50%" src="https://habrastorage.org/getpro/habr/post_images/c1e/4d1/e6b/c1e4d1e6bf8959b16464b6a075320c3e.png" alt="image"></div><br><br>  Red signals indicate incorrect interactions (or invalid data) coming from users or other applications.  Green signals mean acceptable interactions.  Your goal as a developer is to make sure that non-valid melons cannot get inside the system. <br><br>  If a red signal appears inside your system, this means that either you have not filtered the incoming data, or your own code generates incorrect data. <br><br>  In any case, this is a bug in the system that needs to be localized and eliminated as quickly as possible.  And this is where contracts help us.  They allow you to stop the distribution of invalid data on the application and quickly identify the cause of bugs: <br><br><div style="text-align:center;"><img height="50%" width="50%" src="https://habrastorage.org/getpro/habr/post_images/979/ef4/e18/979ef4e18c833be0cd84e9c2d3ca8a7d.png" alt="image"></div><br><br>  When your application has a good set of preconditions for contracts (and, better yet, postconditions and invariants), invalid interactions are localized and their distribution stops as soon as they occur, which makes debugging the application very easy. <br><br>  Validation of incoming data is a mechanism designed to protect your application from the entry of incorrect data from the outside.  This mechanism <b>makes no assumptions about the data with which it works</b> .  This means that the data may be invalid, and this in itself is a valid situation. <br><br>  In fact, if the user enters "ten" in the integer field, you do not want your application to crash.  Instead, you politely point the user to an error. <br><br>  On the other hand, <b>preconditions for contracts make assumptions that the data inside your system is in a valid state</b> .  If this is not the case, an error has crept into your application. <br><br><h2>  Contract preconditions: best practices </h2><br>  Let's see what can be considered as a precondition of a contract.  A contract is a public offer offered by a service class.  It states that if the client follows certain rules (preconditions), the service guarantees some results described in the postconditions. <br><br>  This leads to the following characteristics, which must be followed by each precondition of the contract: <br><br><ul><li>  Preconditions must be public.  This means that the developer of the client class should be able to learn about them before starting to write code. </li><li>  They should be easily verifiable.  The client developer does not have to write complex algorithms to test them before calling the method. </li><li>  Preconditions should not rely on a non-public state, since  this limits the client‚Äôs ability to pre-screen them. </li><li>  They must be stable.  This means that the result of the precondition check should not be dependent on the external state. </li></ul><br>  Let's look at these points in more detail.  The first is fairly simple, it means that all preconditions must be described in some way, so the developer can familiarize himself with them before using the class.  C # does not yet allow embedding contracts directly in the method signature, so the best way at the moment is to describe them at the beginning of the method. <br><br>  The second item means that the service class should not force the client class developer to perform complex checks in order to satisfy the contract.  If the verification algorithm is complicated, it should be put in a separate method that customers can use to validate the precondition: <br><br><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Distribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> amount</span></span></span><span class="hljs-function">)</span></span> { Contract.Requires(CanDistribute(amount)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DistributeCore(amount); }</code> </pre> <br>  The next point follows from this: you should not make your preconditions dependent on non-public methods or fields, otherwise clients will not be able to do the appropriate checks before interacting with the class. <br><br>  The last item speaks of the repeatability of the test result.  If class preconditions depend on the external environment ‚Äî for example, the existence of a file on disk ‚Äî clients will not be able to successfully complete the method in 100% of cases: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filePath</span></span></span><span class="hljs-function">)</span></span> { Contract.Requires(File.Exists(filePath)); <span class="hljs-comment"><span class="hljs-comment">// Rest of the method }</span></span></code> </pre><br>  In this example, the file may be deleted or become inaccessible between the call to the ReadFile method and the start of the verification of the contract, and the client cannot do anything to avoid it.  <b>Such verification is not a precondition for contact, since</b>  <b>it does not indicate the presence of a bug in the client code</b> , so we cannot enter it as a precondition. <br><br><h2>  Conclusion </h2><br>  Contact preconditions and input data validation have similar, but nonetheless different purpose.  While validating incoming data allows you to make sure that the system is protected from the outside world, contract preconditions protect your code inside the system and allow you to quickly localize and eliminate errors in it. <br><br>  Link to original article: <a href="http://enterprisecraftsmanship.com/2015/02/14/code-contracts-vs-input-validation/">C # code contracts vs input validation</a> </div><p>Source: <a href="https://habr.com/ru/post/264113/">https://habr.com/ru/post/264113/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264099/index.html">The magic of tensor algebra: Part 17 - Sketch of nut Janibekova</a></li>
<li><a href="../264101/index.html">Can information security increase revenue, increase customer loyalty, and solve other business problems?</a></li>
<li><a href="../264103/index.html">Application Development with NexStreaming NexPlayer SDK</a></li>
<li><a href="../264105/index.html">Each host branch with capistrano</a></li>
<li><a href="../264109/index.html">Starkon 2015 through the eyes of an indie developer</a></li>
<li><a href="../264115/index.html">Creating a game on Blend4Web. Programmer's path</a></li>
<li><a href="../264117/index.html">Passing the Experience: The Jedi Path</a></li>
<li><a href="../264119/index.html">"All Tolstoy in one click": how we did it</a></li>
<li><a href="../264121/index.html">Botan.io - an experimental analytics tool for Telegram bots from Yandex</a></li>
<li><a href="../264123/index.html">Researchers have created a worm that can infect Mac firmware</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>