<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>433MHz radio channel and time synchronization from GPS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 
 I want to share the experience of creating a single time synchronization system within an apartment / office with elements of the old scho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>433MHz radio channel and time synchronization from GPS</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/856/fa0/23b/856fa023b4f84cef79b4a9acd83eb1b9.jpg" alt="image" align="left">  Good day! <br>  I want to share the experience of creating a single time synchronization system within an apartment / office with elements of the old school and post-apocalypse. <br><br>  Always wanted to make a clock that does not need time correction.  As a student, I tried to assemble a receiver of time synchronization signals on a DV ( <a href="http://ru.wikipedia.org/wiki/DCF77">DCF77</a> ), I even sawed the quartz I needed.  But the signal from Germany reached a weak one, and the serious antenna was obtained. <br><br>  Then came the ability to synchronize from GPS.  At one time, I acquired an RS232 GPS module that provides information about the coordinates in <a href="http://ru.wikipedia.org/wiki/NMEA">NMEA</a> , which I connected to a black and white PALM m105 and was happy about the PathAway program.  But there was no progress on the spot, other tasks appeared and the GPS module lain on the shelf until now. <br><a name="habracut"></a><br>  The lack of time synchronization from GPS is the need to position the receiver in direct line of sight of at least one satellite, which is not always acceptable in the context of hours.  In connection with this, the idea of ‚Äã‚Äãwireless synchronization appeared, i.e.  the receiver is located on the window sill and distributes the exact time to the nearby wishing radio channel.  To fence the duplex channel so that the time is synchronized on demand, found it unnecessary.  The GPS receiver itself transmits synchronization with a specified period. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a radio channel used lying nodes dead car alarm (operating frequency 433 MHz).  After updating the network equipment in the home office (provider), the domestic production of the LightCOM S100 was released, the management of which was based on the PIC18F452 processor, so no additional financial costs were foreseen. <br><br>  To avoid further questions below, a device with a GPS receiver and a synchronization transmitter will be called a transmitter, and a clock with a synchronization receiver will be called a receiver. <br>  Historically, I used to assemble circuits on circuit boards using MGTF. <br><img src="https://habrastorage.org/storage2/0f0/15d/506/0f015d5062fe6cebe67e5fc397d92e2e.jpg" alt="image"><br>  So supporters of LUT please do not kick.  Having drunk the processor stuck it to the installer.  I don‚Äôt cite the transmitter circuitry and 2 hours, there are pinouts in the code. <br>  So let's start with the transmitter: <br><img src="https://habrastorage.org/storage2/d38/254/4ff/d382544ffc9c032f5b65610a71b05e28.jpg" alt="image"><br>  The system of functioning of the transmitter is simple.  We accept the USART PICa NMEA port of the offer and get data from there about the current time, date and relevance of this data.  As soon as the synchronization period comes up (I have 4 minutes) - we transmit all this on the air.  From the features of the transmitter circuit, I note the following: <br><br>  - the circuit is powered by 5 volts, while the key fob wants 12 volts.  I had to fence the diode-capacitor voltage doubler. <br>  - in order not to make a level converter from RS232 to TTL, I opened the GPS module and output the TTL signal to the output RS232 converter. <br><br>  Here is the back of the transmitter: <br><br><img src="https://habrastorage.org/storage2/7c8/fe7/da3/7c8fe7da36be3670ae2c41d3155df491.jpg" alt="image"><br><br>  The peculiarity of car alarm radio exchange is the need to transmit so-called.  the preamble is a meander of a certain duration for the output of receiving chains and AGC to a stable mode (you can read the specification on keeloq on the Internet).  So, by transferring the preamble, we transfer the necessary bytes and at the end - the checksum byte to reduce the likelihood of errors on the receiving side. <br><br>  The first synchronization receiver (clock) made on the basis of the indicator from the written-off cash terminal: <br><br><img src="https://habrastorage.org/storage2/474/9b5/ec0/4749b5ec0215641d01d02194ba77d5cd.jpg" alt="image"><br><br>  The peculiarity of this watch, and any that use external synchronization, is the absence of the need for its own accurate clock (RTC), usually implemented on chips with 326868 quartz or available on board most modern microcontrollers.  In principle, the same clock can be made on the RC-generator.  The main thing is that the accuracy is not significantly floated during the synchronization period. <br><br><img src="https://habrastorage.org/storage2/c33/a5d/b5f/c33a5db5fc832569206557dbff767535.jpg" alt="image"><br><br>  The clock scheme is trivial.  The indicator is connected in the 4-bit data bus mode.  The input from int0 PICa is the output from the car alarm receiver.  To implement the display of large numbers on the 2-line text indicator, we had to use client-changeable characters in cgram.  Design characters honestly <a href="http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl%3Fnum%3D1265696343/all">stole.</a> <br>  Having found the IN-14 lamps in the storeroom, which are a little younger than me, I could not resist creating the second hours: <br><br><img src="https://habrastorage.org/storage2/706/7c9/eb7/7067c9eb753369a9f792dc92a6de8041.jpg" alt="image"><br><br>  Circuitry, there are also no special delights, but still: <br>  - the indication is static (the benefit is there are a lot of free conclusions from PICa and even 155ID1 is enough). <br><br><img src="https://habrastorage.org/storage2/457/d27/01e/457d2701ed0cc07cb579be3db9f48696.jpg" alt="image"><br><br>  - I had to hang basking elements on the radiator <br><br><img src="https://habrastorage.org/storage2/c67/dd5/140/c67dd5140ce3f00254923cca6e457f15.jpg" alt="image"><br>  voltage multiplier (180V according to the specification for IN14 lamps) <br><br><img src="https://habrastorage.org/storage2/841/ca6/6ea/841ca66eae67ab0dc6af674cc937be8d.jpg" alt="image"><br><br>  Just a couple of design moves to emphasize the post-apocalyptic plot: <br><br>  - I decided to pack the watch in a gas mask, for which I had to make a mannequin of the head out of polyurethane foam and pieces of foam: <br><br><img src="https://habrastorage.org/storage2/b38/eaf/d9d/b38eafd9d7d851995bdf7a8169c359b4.jpg" alt="image"><br><br>  - added glitches to the display (show on video) <br>  - added a buzzer to create sounds of a working dosimeter <br>  - glitches and a dosimeter signal are generated using the rand () function in c18, the seed of which is formed with the participation of atmospheric noise taken from the receiver output. <br>  - the switching of minutes is accompanied by the switching off of the multiplier and the beautiful extinction of the indication <br><br>  Finished watch number 2: <br><br><img src="https://habrastorage.org/storage2/392/215/7a8/3922157a86dc18c656d6cbbf3786d83a.jpg" alt="image"><br><br>  Video of work: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/wlQML3Wo4Nw%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhj-6kpyeeAgXGIWeP455rJfTTKjug" frameborder="0" allowfullscreen=""></iframe><br><br>  More videos: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/h9mNPalq-4Q%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhi-TchPUbu8W29y0AS4Vm7VIZzAgA" frameborder="0" allowfullscreen=""></iframe><br><br>  I wrote for the first time on c18.  Previously, under the PIC wrote in assembler. <br><br>  <a href="">Sources</a> </div><p>Source: <a href="https://habr.com/ru/post/143568/">https://habr.com/ru/post/143568/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143562/index.html">Facebook announced the imminent release of App Center for iOS, Android and HTML 5</a></li>
<li><a href="../143564/index.html">CISCO ACE - Application Balancing</a></li>
<li><a href="../143565/index.html">Alternative method of visualization of the progress of the IT project</a></li>
<li><a href="../143566/index.html">What does your application code look like?</a></li>
<li><a href="../143567/index.html">Codeception - project news</a></li>
<li><a href="../143569/index.html">5 Common Rails Developers Mistakes</a></li>
<li><a href="../143570/index.html">Post office. Linux tuning basics</a></li>
<li><a href="../143571/index.html">How was the Moscow Facebook Garage</a></li>
<li><a href="../143572/index.html">Qt Creator 2.5.0 has been released!</a></li>
<li><a href="../143574/index.html">Improving the "endless scrolling"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>