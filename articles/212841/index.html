<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Portal migration from SharePoint 2010 to SharePoint 2013. What has changed and how to live with it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this topic, we share our real experience in the migration of portals from 2010 to 2013 SharePoint. The issue has been resolved long ago, it is nece...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Portal migration from SharePoint 2010 to SharePoint 2013. What has changed and how to live with it</h1><div class="post__text post__text-html js-mediator-article">  In this topic, we share our real experience in the migration of portals from 2010 to 2013 SharePoint.  The issue has been resolved long ago, it is necessary to migrate, and for sure the management has already set deadlines when this should be done.  This is where our material may be useful for understanding how to approach this matter.  In order not to make a huge article with a bunch of specific inserts of technical information, we focused on the main thing - on differences in migration from 2007 to 2010 with migration 2010 to 2013 and at the main stages. <br><br>  If you are faced with an even more difficult task to migrate 2007 to 2010, and then to 2013, read <a href="http://habrahabr.ru/company/eastbanctech/blog/168493/">our last year‚Äôs material</a> , where we already talked about the migration of the SharePoint 2007 portal to SharePoint 2010. <br><br><a name="habracut"></a><h5>  As always, we tell in practice, let's start with the task before us: </h5><br>  Before us is an internal corporate portal: <br><ul><li>  Intranet - an old information portal with specialized functionality and design, developed by Company 1, is currently being used by several company divisions; </li><li>  Intraru2 is a new information portal with specialized functionality and design developed by Company 2. Also, modules developed by us for <a href="http://habrahabr.ru/company/eastbanctech/blog/195110/">booking meeting rooms are</a> involved in the portal.  Currently used by most divisions of the company; </li><li>  Docflow - a portal with specialized functionality and design, developed by Company 3, is used for the workflow by the legal department; </li><li>  HelpdeskCo - a portal with standard functionality, used by the IT department; </li><li>  KnowledgeBase is a portal with standard functionality used by the IT department. </li></ul><br>  Complementing the picture with the final touches: there are more than 15 different Solutions installed on the SharePoint farm, more than 50 GB of content databases, and various service applications are used in the work of the portals: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  profile service </li><li>  search service </li><li>  webapp application service </li><li>  metadata service. </li></ul><br>  All this farm is used by more than 2.5 thousand users. <br><br>  Our task was to migrate the Intranet, HelpdeskCo, KnowledgeBase portals and our modules for booking talks from the Intraru2 portal to Sharepoint 2013. Two important points worth mentioning here are: <br><br><ol><li>  As always, you need to switch the portal version so that almost no one notices. </li><li>  "Company 2" migrated its part of the development itself. </li><li>  "Company 1" and "Company 3" no longer lead customer support, so their decisions were hanging in the air. </li></ol><br>  Practical advice to those who support and develop portals: buy third-party solutions with source code only and use your administrators by using them - you will be sure that you will not be asked for extra money and that you have exactly what you bought. <br><br>  As experience shows, when upgrading to the next portal versions, developers request additional money, and they are not always justified. <br><br><h5>  What has changed in the approach to migration for 2013 </h5><br>  Let's look briefly at the changes in the migration process, as well as in the requirements for the farm: <br>  <a href="http://technet.microsoft.com/en-us/library/ee617150">technet.microsoft.com/en-us/library/ee617150</a> (v = office.15) <br>  <a href="http://technet.microsoft.com/en-us/library/cc262485.aspx">technet.microsoft.com/en-us/library/cc262485.aspx</a> <br>  <a href="http://technet.microsoft.com/en-us/library/ff382641.aspx">technet.microsoft.com/en-us/library/ff382641.aspx</a> <br><br>  Farm hardware requirements: <br><br><ul><li>  the farm 2013 web server requires approximately twice as much RAM as the farm 2010 web server (8GB versus 4GB for development and 12GB versus 8GB for minimal use); </li><li>  Farm 2013 web server is officially supported on Windows 2008R2SP1 / 2012, but is not yet supported on 2012R2. </li><li>  Fast-Search site migration is not supported: you must either delete sites or replace them with ‚ÄúEnterprise Search‚Äù; </li><li>  The migration of PowerPoint Broadcast sites that come with the Web App is not supported. </li></ul><br>  You can migrate only some service applications: <br><ul><li>  Business Data Connectivity </li><li>  Managed metadata </li><li>  Performancepoint </li><li>  Secure store </li><li>  User Profile </li><li>  Search Administration. </li></ul><br>  Rejection of the ‚ÄúVisual Upgrade‚Äù function: <br><br>  1. Now there is no ‚Äúvisual upgrade‚Äù function, but the opportunity has appeared to test and migrate individual collections of sites to the 2013 species. <br>  2. Now there is a native mode of operation of 2010 sites, and on the file system, in addition to folder 15, there is also folder 14, while the ‚Äú\ _layouts \‚Äù link goes to the ‚Äú14 / layouts‚Äù directory, and the ‚Äú\ _layouts \ 15 \‚Äù link goes to the directory "15 / layouts". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77a/c58/bfc/77ac58bfca606bcefb5e0bf249609014.png"><br><br>  3. Now it is possible to install WSP solutions from the 2010 farm, and you need to use the ‚Äú-CompatibilityLevel‚Äú 14,15 ‚Äùflag and, as practice has shown, most of the solutions will work. <br>  4. By default, web applications on farm 2013 are created and operate in the ‚ÄúCLAIM‚Äù mode of authorization, so that during migration you will need to convert the web application and users to the ‚ÄúCLAIM‚Äù mode. <br><br><h5>  Usually we train (test migration) </h5><br>  So, as usual we analyzed the portal, made a test farm, on which we worked out the first errors.  90% of WSP solutions were installed without problems, others required corrections, the main errors encountered were: <br><br><ul><li>  wrong file paths; </li><li>  Solution incompatibility with Framework 4.5. </li></ul><br>  When checking the database, there were mostly errors ‚Äúresidues from remote solutions‚Äù: <br><br><ul><li>  incorrect web parts on pages; </li><li>  incorrect "Feature"; </li><li>  incorrect WSP solutions. </li></ul><br>  Next, having made sure that these web parts, features and solutions are not used in the work, we cleaned the base, deleted unused site collections, document versions and baskets data. <br><br>  The result was a clean, error-free database of content, which was connected to the test farm. <br><br>  During the test migration, service applications were also migrated, which did not cause any difficulties: <br><br><ul><li>  profile service; </li><li>  metadata service. </li></ul><br>  After connecting the databases and converting the web application to the authorization mode, ‚ÄúCLAIM‚Äù got a problem with the functionality of our solution for booking meeting rooms, so it was necessary to fix it to work with ‚ÄúCLAIMS‚Äù. <br><br>  As an example of custom-development migration, we present the <a href="http://habrahabr.ru/company/eastbanctech/blog/195110/">solution for booking meeting rooms</a> , the correct architecture allowed us to make the edits minimal, namely, to change the configuration for the wcf service in the web.config. <br><br>  For example, adding the useRequestHeadersForMetadataAddress attribute to the behavior section: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceBehaviors</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behavior</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"RoowRequestBehavior"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceMetadata</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">httpGetEnabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceDebug</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">includeExceptionDetailInFaults</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">behavior</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">serviceBehaviors</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  In addition to the changes to the web.config, fixes touched on how to interact with SharePoint Search Services.  If in SharePoint 2010 the interaction occurred through FullTextSqlQuery and resembled a normal SQL query: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> querySchema = <span class="hljs-string"><span class="hljs-string">"SELECT {0},{1} FROM Scope() WHERE (\"scope\"='people') AND (\"{2}\"='{3}'"</span></span>; ResultTableCollection rtc = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ftsq = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FullTextSqlQuery(ServerContext.Current) { QueryText = String.Format(querySchema, employeeIdField, nameField, departmentField, department), ResultTypes = ResultType.RelevantResults }; rtc = ftsq.Execute();</code> </pre> <br><br>  Now you need to use KeywordQuery and the same query will look like this: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> querySchema = <span class="hljs-string"><span class="hljs-string">"{0}:{1}"</span></span>; ResultTableCollection rtc = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> kwq = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KeywordQuery(site) { QueryText = String.Format(querySchema, departmentField, department), ResultTypes = ResultType.RelevantResults, KeywordInclusion = KeywordInclusion.AllKeywords, HiddenConstraints = <span class="hljs-string"><span class="hljs-string">"scope:"</span></span> + <span class="hljs-string"><span class="hljs-string">"\"People\""</span></span> }; kwq.SelectProperties.Add(employeeIdField); kwq.SelectProperties.Add(nameField); SearchExecutor se = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SearchExecutor(); rtc = se.ExecuteQuery(kwq);</code> </pre><br><br><br>  <b>Our advice: before migration, if there are custom components, <a href="http://msdn.microsoft.com/en-us/library/office/jj164060.aspx">look</a> at the changes in the API, usually it ends with minor changes in the code.</b> <br><br>  Next, we had to update the sites to the 2013 view. There were no problems with standard web applications, and the site collections were updated correctly to the 2013 view. Difficulties arose with the web application of the old intranet portal, the check showed multiple notifications: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a7b/572/636/a7b57263696806762609be939c14c459.png"><br><br>  Accordingly, the next step was a systematic work to adjust the appearance of the portal.  I note that not all of the design was successfully transferred to 2013 and there were minor flaws that did not affect the functionality of the portal and, as agreed with the customer, did not correct them any further. <br><br>  As a result, on the test farm, we worked out possible errors, got a checklist for verification and the order of steps for combat migration. <br><br><h5>  Battle Migration </h5><br>  As always, after the test migration, we once again did a training run on a clean infrastructure and wrote down in steps how and what to do.  Combat migration was performed on a day off so as not to interfere with the daily work of portal users.  No new errors occurred during the combat migration, it took about 6 hours. <br><br>  In the end, I would like to say that the migration process has become a little easier, but you need to remember simple things: <br><br><ol><li>  Do not litter your portal with unnecessary solutions. </li><li>  Keep the source, settings, all versions of what you install on the portal.  Then sometimes it is impossible to figure out where it came from and what will happen if you do not migrate. </li><li>  Describe (document) the configuration of services - search service, profiles, reports, etc.  - time passes all is forgotten.  As a rule, each setting is important for the performance of the portal. </li><li>  Try not to reinvent the wheel and use the portal functionality as well as possible. </li><li>  Gathered to migrate - do not take the time to practice. </li></ol><br>  We will be glad if our experience is useful to you.  Write questions, if we know the answer, we will definitely advise and help! </div><p>Source: <a href="https://habr.com/ru/post/212841/">https://habr.com/ru/post/212841/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212831/index.html"># 3dprintexpo: Russia's first exhibition of three-dimensional printing</a></li>
<li><a href="../212833/index.html">Lshell instead of chroot ssh</a></li>
<li><a href="../212835/index.html">Tame ZoG (Part 3: Football of the Kumsk Valley)</a></li>
<li><a href="../212837/index.html">The basics of creating a 2D character in Godot. Part 2: compiling templates, a little about GDScript, movement and animation of the hero</a></li>
<li><a href="../212839/index.html">SIP Security Essay</a></li>
<li><a href="../212843/index.html">Monthly digest of interesting IT-projects on Kickstarter ‚Ññ1</a></li>
<li><a href="../212847/index.html">Denormalization of trees</a></li>
<li><a href="../212849/index.html">Rare PDA Casio Cassiopeia A-11A</a></li>
<li><a href="../212851/index.html">We look at closed profiles in LinkedIn</a></li>
<li><a href="../212855/index.html">How would the story turn: Samsung could buy Android first</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>