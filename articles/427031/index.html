<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automation with Codeception + Gherkin + PageObject for the smallest</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not finding a single concrete example of the Gherkin implementation with the Page Object design pattern for Codeception on the Internet , I thought th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automation with Codeception + Gherkin + PageObject for the smallest</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/fw/m3/sr/fwm3srs7ha0clnqekm-lbexd5sk.jpeg"></div><br>  Not finding a single concrete example of the Gherkin implementation with the <a href="https://kreisfahrer.gitbooks.io/selenium-webdriver/content/page_object_pattern_arhitektura_testovogo_proekta/ispolzovanie_patterna_page_object.html">Page Object</a> design pattern for <a href="https://codeception.com/">Codeception</a> on the <a href="https://codeception.com/">Internet</a> , I thought that it would not be superfluous to tell the Internet about its own implementation of this pattern. <br><br>  This article is intended more for those who are already a little familiar with Codeception or similar frameworks, but do not yet know how using Page Object to make tests more readable, simplify their support and reduce the amount of excess code.  Nevertheless, I tried to step by step explain all the main points of the assembly of the automation project from scratch. <br><a name="habracut"></a><br>  The Page Object template allows you to encapsulate work with page elements, which in turn allows you to reduce the amount of code and simplify its support.  All changes to the UI are easily and quickly implemented - just update the Page Object class that describes this page.  Another important advantage of this architectural approach is that it allows you not to clutter up the HTML test script with details, which makes it more understandable and easy to read. <br><br>  This is what a test looks like without using Page Object. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/8d/9v/qn/8d9vqnqtthsneoqsml5zqziabkc.png"><br><br>  Using Page Object <br><br><img src="https://habrastorage.org/webt/qa/zx/vj/qazxvjdq7qt6h24uxlpwpwmpuxo.png"><br><br>  I will not dwell on the installation of the base environment in detail; I will give my initial data: <br><br><ul><li>  Ubuntu bionic beaver </li><li>  PHP 7.1.19-1 </li><li>  Composer - dependency manager for PHP, installed globally </li><li>  PhpStorm - development environment </li></ul><br>  To run the tests, we also need: <br><br><ul><li>  <a href="http://chromedriver.chromium.org/downloads">hromedriver 2.41</a> (by the link you can not only download, but also see which driver corresponds to your chrome version) </li><li>  Chrome 67.0.3396.99 </li><li>  <a href="http://selenium-release.storage.googleapis.com/index.html">Selenium-server-standalone-3.14.0</a> (article about installing selenium on ubuntu) </li></ul><br><h4>  Expand Codeception </h4><br>  Getting down to installing Codeception: <br><br>  Open in the terminal the directory we need where we will build the project, or create a directory for the project and go to it: <br><br><pre><code class="bash hljs">mkdir ProjectTutorial <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ProjectTutorial</code> </pre> <br>  Install the Codeception framework and its dependencies: <br><br><pre> <code class="bash hljs">composer require codeception/codeception --dev</code> </pre> <br><img src="https://habrastorage.org/webt/er/gc/df/ergcdf-_mg38pirctf7z0af7pt8.png"><br><br>  The installation installation file composer.json in the project will look like this: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"require"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"php"</span></span>: <span class="hljs-string"><span class="hljs-string">"&gt;=5.6.0 &lt;8.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"facebook/webdriver"</span></span>: <span class="hljs-string"><span class="hljs-string">"&gt;=1.1.3 &lt;2.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"behat/gherkin"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.4.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"codeception/phpunit-wrapper"</span></span>: <span class="hljs-string"><span class="hljs-string">"^6.0.9|^7.0.6"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"require-dev"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"codeception/codeception"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"codeception/base"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.5"</span></span> } }</code> </pre> <br>  We develop the project: <br><br><pre> <code class="bash hljs">php vendor/bin/codecept bootstrap</code> </pre> <br><img src="https://habrastorage.org/webt/5c/dy/td/5cdytd9w9s0ycaz8q65nbohmtvg.png"><br><br>  More information about how to install the project can be obtained in the <a href="https://codeception.com/install">official documentation</a> . <br><br>  At this stage in our project are three sets of (suite) tests.  By default, Codeception separates them into acceptance, functional, and unit.  To these sets, Codeception also generates three yml files.  In them we specify all the necessary <a href="https://codeception.com/docs/reference/Configuration">configurations</a> , we connect the modules and properties to run our tests. <br><br>  This lesson is built on the example of the Acceptance test, so I will bring the settings to Acceptance.suite.yml. <br><br>  Open our project in PHP Storm (or another favorite development environment) and go to <b>Acceptance.suite.yml</b> (by default it lies in the tests / acceptance.suite.yml folder). <br>  We prescribe the minimum necessary dependencies and be sure to pay attention to formatting.  The modules are separated by a "-" sign and must be located on the same level, otherwise errors will sprinkle when the test is started. <br><br>  It turns out: <br><br><pre> <code class="hljs pgsql">actor: AcceptanceTester modules: enabled: - WebDriver: url: <span class="hljs-string"><span class="hljs-string">'http://yandex.ru/'</span></span> //    ,        browser: <span class="hljs-string"><span class="hljs-string">'chrome'</span></span> - \Helper\Acceptance //          gherkin: contexts: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: - AcceptanceTester</code> </pre> <br>  And a little more preparatory work: <br><br>  Create a separate directory in the project root (I have lib). <br>  In this directory, create an executable file run.sh, which will run Selenium and Chrome Driver. <br><br>  We put Selenium and Chrome Driver here, and write the run command to run.sh: <br><br><pre> <code class="actionscript hljs">java -jar -Dwebdriver.chrome.driver=chromedriver_241 selenium-server-standalone<span class="hljs-number"><span class="hljs-number">-3.14</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>.jar</code> </pre> <br>  How it looks in the project: <br><br><img src="https://habrastorage.org/webt/cy/qn/pq/cyqnpqzz2puwryeomp2spafekfs.png"><br><br>  We return to the console and change access rights: <br><br><pre> <code class="bash hljs">chmod +x ./run.sh</code> </pre> <br>  <i>(note. The names of the drivers in the directory must exactly match those specified in the startup command).</i> <br><br>  You can start Selenium and Webdriver right now so that you don‚Äôt have to return to it.  To do this, open a new tab of the terminal, go to the directory where the file run.sh lies and write the start command: <br><br><pre> <code class="bash hljs">~/AutomationProjects/ProjectTutorial/lib$ ./run.sh</code> </pre> <br>  Make sure that the server is running: <br><br><img src="https://habrastorage.org/webt/ux/uh/3c/uxuh3cft4npzg-3dtg81kylvvx8.png"><br><br>  Leave it in disrepair.  This preparatory work is completed. <br><br><h4>  Writing a test script </h4><br>  Moving on to creating a feature file for our test script.  For this, a special command is provided to Codeception, run it in the console: <br><br><pre> <code class="bash hljs">cept g:feature acceptance check</code> </pre> <br>  <i>(note ‚Äúcheck‚Äù - the name of my test)</i> <br><br>  We see in the acceptance folder a new check.feature file. <br><br><img src="https://habrastorage.org/webt/rc/u4/78/rcu478xuheqd4kcdyogaqmudqu0.png"><br><br>  We do not need the default content, immediately delete and write our test. <br><br>  In order for the collector to recognize the Cyrillic alphabet, do not forget to start the script with #language: ru. <br>  We write a short script in Russian.  I remind you that each sentence must begin with the key words: ‚ÄúWhen‚Äù, ‚ÄúThen‚Äù, ‚ÄúAnd‚Äù, the symbol ‚Äú*‚Äù, etc. <br><br>  For my example, I took the site Yandex, you can take any. <br><br><img src="https://habrastorage.org/webt/os/ov/tc/osovtc_rsa3drmoxchalhqsu1bu.png"><br><br>  To see what steps there are in the test, we run our script in the terminal: <br><br><pre> <code class="bash hljs">cept dry-run acceptance check.feature</code> </pre> <br><img src="https://habrastorage.org/webt/tf/y8/b2/tfy8b2ochm_yqbp1mkpbnk-uwmo.png"><br><br>  The script steps are output to the console, but they are not yet implemented. <br><br>  Then we run a command that automatically generates templates for implementing our methods: <br><br><pre> <code class="bash hljs">cept gherkin:snippets acceptance</code> </pre> <br><img src="https://habrastorage.org/webt/a0/q6/_e/a0q6_efw3x0szqgsrx_6xwcxnhy.png"><br><br>  All names from the script that were in quotes are replaced with variables: arg. <br>  We copy them from the terminal and paste into the <b>AcceptanceTester.php</b> file, where the methods of working with page elements will lie. <br><br><img src="https://habrastorage.org/webt/ac/za/s3/aczas3m2n_53nrhw9abnefwgrww.png"><br><br>  Rename the methods to readable, reflecting their essence (optional), and write their implementation. <br><br><img src="https://habrastorage.org/webt/u_/h9/pk/u_h9pkwslb6m31rcsldym5ckns8.png"><br><br>  Everything is simple, but even easier if you work in a smart development environment, such as Storm, which itself will prompt the necessary commands from the library: <br><br><img src="https://habrastorage.org/webt/ky/jp/1q/kyjp1qqvw3mhuwhjlfpnews6nhy.png"><br><br>  Delete the excess and write the methods: <br><br><pre> <code class="hljs php"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@When</span></span></span><span class="hljs-comment">      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_beingOnMainPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($page)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;amOnPage(<span class="hljs-string"><span class="hljs-string">'/'</span></span>); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    :element */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_seeElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($element)</span></span></span><span class="hljs-function"> </span></span>{ this-&gt;seeElement($element); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    :button */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_clickOnButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($button)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;click($button); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    :field  :text */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_fillField</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($field, $text)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;fillField($field, $text); }</code> </pre> <br>  Let's see what happened.  Run the command that will show us which methods (step) we now have implementation. <br><br><pre> <code class="bash hljs">cept gherkin:steps acceptance</code> </pre> <br><img src="https://habrastorage.org/webt/in/fr/sa/infrsa44-bbn5w7dv5npl76seu0.png"><br><br>  Success! <br><br>  But the steps in the feature file are still not recognized as methods. <br><br><img src="https://habrastorage.org/webt/sc/ng/dv/scngdvuysz8lx3uvma099_ttcwg.png"><br><br>  To Storm understand what to do with the steppes, let's check the trick with the implementation of the Context interface from the namespace Gherkin Context. <br><br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> Behat\Behat\Context { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class"> </span></span>{} }</code> </pre> <br>  Wrap our AcceptanceTester class in a namespace and inherit from Context. <br><br><pre> <code class="hljs tex">implements <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Behat</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Behat</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Context</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Context</span></span></span></span></code> </pre> <br><img src="https://habrastorage.org/webt/g9/er/es/g9eresucfntsxrvvcg_p_w3b66o.png"><br><br>  Now all the steps of the feature file are tied to their implementation: <br><br><img src="https://habrastorage.org/webt/fa/ja/jw/fajajwdnqmw5fepmypnohmhqgqa.png"><br><br>  In order for Webdriver to understand what to click and where to look, you need to replace the readable names of the elements and the addresses of the pages with the corresponding locators and URLs, which in the form of arguments will fall into the methods. <br><br>  Then we get a test of the form: <br><br><img src="https://habrastorage.org/webt/dq/zi/vp/dqzivp0x5a7kgc7li0ltr_xnhtu.png"><br><br>  And you can run: <br><br><pre> <code class="bash hljs">cept run acceptance</code> </pre> <br><img src="https://habrastorage.org/webt/ao/pu/ql/aopuqlvrkj5hdenn2nj-a326xri.png"><br><br>  Passed. <br><br>  <i>approx.</i>  If page elements take a long time to load, you can add a wait to the desired method: <br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;waitForElementVisible($element);</code> </pre> <br>  We return to our test script.  We are upset that all the readability of the test is lost due to the fact that instead of clear names of elements and pages we see HTML elements and url. <br><br>  If we want to fix this, it's time to move on to implementing the Page Object pattern. <br><br><h4>  Go to Page Object </h4><br>  In the _support directory we create the Page directory where we will add our class pages: <br><br><pre> <code class="bash hljs">php vendor/bin/codecept generate:pageobject MainPage</code> </pre> <br>  The first Page Object is the Yandex main page, let's call it MainPage, let's call the class the same: <br><br><img src="https://habrastorage.org/webt/nj/ri/fr/njrifrqvws-yerkevm6jvcqefgi.png"><br><br>  Here we declare static fields and methods so that they can be called without creating an object. <br><br>  Since in the configurations of Acceptance.suite.yml we have already indicated the starting page url: <a href="http://yandex.ru/">yandex.ru</a> , then for the main page it will be sufficient to specify <br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $URL = <span class="hljs-string"><span class="hljs-string">'/'</span></span>;</code> </pre> <br>  Next comes the array of page elements.  We describe locators for several elements and give them clear and unique names. <br><br>  Now you need to add the getElement method, which will return the locator by the name of the element from the array. <br><br>  As a result, we have: <br><br><pre> <code class="hljs perl">&lt;?php //location: tests/_support/Page/MainPage.php namespace Page; <span class="hljs-regexp"><span class="hljs-regexp">/**   */</span></span> class MainPage { public static $URL = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; public static $elements = array( <span class="hljs-string"><span class="hljs-string">' '</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"//*[@id='wd-wrapper-_afisha']"</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"//*[@data-statlog='afisha.title.link']"</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"//*[@class='weather__icon weather__icon_ovc']|//*[@class='weather__icon weather__icon_skc_d']"</span></span>, ); public static function getElement($name){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self::$elements[$name]; } }</code> </pre> <br>  Add a couple of classes of pages: <br><br>  / ** Poster * / <br><br><img src="https://habrastorage.org/webt/ti/dw/pw/tidwpwbnw2jedklmo6tq8x83hey.png"><br><br>  / ** Poster - Search results * / <br><br><img src="https://habrastorage.org/webt/b9/wf/zn/b9wfznt94mctpp1pognnwfn5u6i.png"><br><br>  We return to the <b>AcceptanceTester.php</b> class, where we wrote our methods. <br>  Create an array of PageObject classes in it, where we assign names to pages and specify their class names in the namespace: <br><br><pre> <code class="hljs php"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $pages = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">" "</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"\Page\MainPage"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"\Page\AfishaPage"</span></span>, <span class="hljs-string"><span class="hljs-string">" -  "</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"\Page\AfishaResult"</span></span> );</code> </pre> <br>  Each new PageObject is similarly added to this array. <br><br>  Next, we need to create the currentPage field in which the link to the PageObject of the current page will be stored: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">private</span></span> <span class="hljs-variable"><span class="hljs-variable">$currentPage</span></span>;</code> </pre> <br>  Now we will write a method, by calling which we will be able to get the currentPage and initialize the PageObject class we need. <br><br>  It is logical to make a step like this ‚ÄúWhen the user navigates to the page title page.‚Äù  Then the easiest way to initialize the PageObject class, without checks, will look like this: <br><br><pre> <code class="hljs php"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@When</span></span></span><span class="hljs-comment">     :page */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_beingOn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($page)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   pageObject $this-&gt;currentPage = $this-&gt;pages[$page]; }</span></span></code> </pre> <br>  Now we write the getPageElement method, which will allow us to get an element, or rather, its locator from the current page: <br><br><pre> <code class="hljs ruby">private function getPageElement($elementName) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>         $curPage = $this-&gt;currentPage; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $curPage<span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-symbol"><span class="hljs-symbol">:getElement</span></span>($elementName); }</code> </pre> <br><img src="https://habrastorage.org/webt/s-/ox/3i/s-ox3ijtg-riak5czcm-wb-lgfi.png"><br><br>  For already implemented methods, it is necessary to replace the arguments, which we initially obtained directly from the text of the feature, with elements from PageObject, that is: <br><br><pre> <code class="hljs perl">$arg</code> </pre> <br>  take the form <br><br><pre> <code class="hljs perl">getPageElement($arg))</code> </pre> <br>  Then our methods will take the form: <br><br><pre> <code class="hljs bash">/** * @When     :page */ public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> step_beingOnMainPage(<span class="hljs-variable"><span class="hljs-variable">$page</span></span>) { //      pageObject <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;currentPage = <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;pages[<span class="hljs-variable"><span class="hljs-variable">$page</span></span>]; <span class="hljs-variable"><span class="hljs-variable">$curPage</span></span> = <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;currentPage; <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;amOnPage(<span class="hljs-variable"><span class="hljs-variable">$curPage</span></span>::<span class="hljs-variable"><span class="hljs-variable">$URL</span></span>); } /** * @Then    :element */ public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> step_seeElement(<span class="hljs-variable"><span class="hljs-variable">$element</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;waitForElementVisible(<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$element</span></span>)); <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;seeElement(<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$element</span></span>)); } /** * @Then    :button */ public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> step_clickOnButton(<span class="hljs-variable"><span class="hljs-variable">$button</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;click(<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$button</span></span>)); } /** * @Then    :field  :text */ public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> step_fillField(<span class="hljs-variable"><span class="hljs-variable">$field</span></span>, <span class="hljs-variable"><span class="hljs-variable">$text</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;fillField(<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$field</span></span>), <span class="hljs-variable"><span class="hljs-variable">$text</span></span>); } /** * @Then      :field */ public <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> step_deleteText(<span class="hljs-variable"><span class="hljs-variable">$field</span></span>) { <span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;clearField(<span class="hljs-variable"><span class="hljs-variable">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$field</span></span>)); }</code> </pre><br>  Added another method to display the search results by pressing the Enter key: <br><br><pre> <code class="hljs php"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    ENTER */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_keyboardButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;pressKey(<span class="hljs-string"><span class="hljs-string">'//input'</span></span>,WebDriverKeys::ENTER); }</code> </pre> <br>  The last step is when all the necessary methods and PageObjects are described, you need to refactor the test itself.  Add steps that will initialize PageObject when moving to a new page.  We have this ‚Äú* user navigated to page: page‚Äù. <br><br>  For clarity, I will add a few more steps.  The result is the following test: <br><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#language: ru :     :   .    .   .      </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">      </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">  </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     ENTER      </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" -  "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"   "</span></span></span><span class="hljs-meta">       </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">  </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">     ENTER</span></span></code> </pre><br>  Such a test script is understandable and readable to any outsider. <br><br>  Run! <br><br>  To view a more detailed result of the run, you can use the command <br><br><pre> <code class="bash hljs">cept run acceptance --debug</code> </pre> <br>  See the result: <br><br><img src="https://habrastorage.org/webt/hj/qe/si/hjqesizorxxs8ekelolrqjoetkm.png"><br><br>  Thus, using the Page Object pattern allows you to separate all page elements from test scripts and store them in a separate directory. <br><br>  The project itself can be found at <a href="https://github.com/Remneva/ProjectTutorial">https://github.com/Remneva/ProjectTutorial</a> <br><br>  As a novice automator, I would be grateful if you share your ideas and, perhaps, tell me how logical it is to transform and simplify the structure of the project. </div><p>Source: <a href="https://habr.com/ru/post/427031/">https://habr.com/ru/post/427031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427019/index.html">Data Halloween - a conference about the possibilities of Data Science for business</a></li>
<li><a href="../427021/index.html">Chrome 70 supports [feature list] and AV1 - why is support for this codec so important?</a></li>
<li><a href="../427025/index.html">Five stones in the blockchain garden</a></li>
<li><a href="../427027/index.html">Where to work in IT, issue 2: SKB Kontur</a></li>
<li><a href="../427029/index.html">Diagnosis of sensuality</a></li>
<li><a href="../427035/index.html">Internet of things: are we stuck in place?</a></li>
<li><a href="../427037/index.html">Social proof</a></li>
<li><a href="../427039/index.html">Voltmeter for batteries: a pocket gadget for a smartphone with crocodiles</a></li>
<li><a href="../427041/index.html">Friday. Nonsense programmer 3.0</a></li>
<li><a href="../427047/index.html">Honey, we kill free text content.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>