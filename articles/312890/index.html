<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kerosene vs. Patriots: How American military programmers learned how to round correctly</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On February 11, 1991, the Patriot Project Office received Israeli data on a defect in the Patriot missile system. They found that if the system is run...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kerosene vs. Patriots: How American military programmers learned how to round correctly</h1><div class="post__text post__text-html js-mediator-article">  <b>On February 11,</b> 1991, the Patriot Project Office received Israeli data on a defect in the Patriot missile system.  They found that if the system is running for 8 hours, it starts smearing by 20%.  They figured that after 20 hours of operation, the system begins to miss so much that it will no longer be able to capture, track and hit ballistic missiles.  The US military did not take into account the importance of the discovery, saying that the system is designed for portable and short-term protective operations and that no one will ever use the system for more than 8 hours. <br><br>  <b>February 16</b> was released Bug Fix, but to introduce it into all units of military equipment, it took time, because the war. <br><br>  <b>February 21, the</b> military issued an indication that the system should not work for a long time.  The military did not specify how long it lasts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>On February 25</b> in Dhahran (Saudi Arabia) a ballistic missile " <a href="https://ru.wikipedia.org/wiki/%25D0%25A0-17">kerosene</a> " flew into the barracks to visit the Americans (it‚Äôs also the P-17, it‚Äôs Scud).  28 killed 96 were wounded because the Patriot missile system had missed due to a program error. <br><br>  <b>February 26</b> Bug Fix was delivered to Dhahran. <br><br><img src="https://habrastorage.org/files/853/04a/1dc/85304a1dc1b6499d94d5394436e42faf.jpg"><br><br><a name="habracut"></a><br><img src="https://habrastorage.org/files/d5b/a87/27d/d5ba8727d878468aaf50e892ed08a83d.jpg"><br><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A0-17">R-17</a> (according to the classification of the US and NATO Defense Forces - SS-1c Scud B, export designation R-300, unofficially - ‚Äúkerosene‚Äù) - Soviet liquid single-stage ballistic missile on long-lasting fuel components. <br><br><div class="spoiler">  <b class="spoiler_title">photos P-17</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/9f1/bc7/70c/9f1bc770c1918e4cb1294bb47356a2da.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ada/0a4/b26/ada0a4b266fbb962eefe6e6c2cdea032.jpg"><br>  Military inspect the R-17 type missile shot down in the desert by the Patriot MIM-104 air defense missile system during Operation Desert Storm <br></div></div><br><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%258D%25D1%2582%25D1%2580%25D0%25B8%25D0%25BE%25D1%2582">MIM-104 "Patriot"</a> (eng. MIM-104 Patriot, translated from English - Patriot) - American anti-aircraft missile system (ZRK), used by the US Army and its allies. <br><br><div class="spoiler">  <b class="spoiler_title">Patriot pictures</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/4ee/01e/745/4ee01e74545fdd8e8c13cd21ff700c20.gif"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f07/dde/4fb/f07dde4fbdb36898e08ba71f57386341.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e4/f7d/90e/8e4f7d90e801fd9e4d623ea34fe2e4c7.jpg"><br>  A detailed view of an AN / MPQ-53 radar set.  It is the main component of the phased array, which constitutes 5,000 individual elements, each of 39 millimeters (1.535 in) diameter. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/48f/aa2/c90/48faa2c905b0f4abc8f11c71c86186f5.jpg"><br>  PAC-3 missile launcher, note four missiles in each canister <br></div></div><br><br>  In the software responsible for maintaining the goal, there was a bug, due to which over time the internal clock gradually deviated from the true value of time. <br><br>  The system time was stored as an integer in a 24-bit register with an accuracy of one tenth of a second.  Therefore, at each cycle, 0.1 sec was ‚Äúlost‚Äù part of the time.  When calculating the data were translated in real numbers. <br>  [ <a href="http://www.cs.usyd.edu.au/~alum/patriot_bug.html">source</a> ] <br><br>  The number 1/10 equals 1/2 <sup>4</sup> +1/2 <sup>5</sup> +1/2 <sup>8</sup> +1/2 <sup>9</sup> +1/2 <sup>12</sup> +1/2 <sup>13</sup> + ... In other words, the binary 1/10 decomposition = 0.0001100110011001100110011001100 ... Therefore, 24 bit the register in the Patriot system kept 0.00011001100110011001100 instead, introducing an error of 0.000000000000000000001111111100 ... in binary terms, or approximately 0.000000095 in decimal.  During one hundred hours of operation, 0.000000095 √ó 100 √ó 60 √ó 60 √ó 10 = 0.34 seconds <br><br>  "Kerosene" flies at a speed of 1676 meters per second, and passes in 0.34 seconds more than half a kilometer.  This is more than enough to smash the radius of defeat of the Patriots.  It's funny that the crooked time calculation was fixed in some parts of the program, but not in all. <br><br>  The software was written in assembler 15-20 years ago and since then has been modified several times by various programming teams. <br><br>  <b>Several slides from the <a href="https://msquair.files.wordpress.com/2015/05/patriot-timing-error.pdf">report</a> , which revealed problems with the Patriot system:</b> <b><br></b> <br><img src="https://habrastorage.org/files/03c/743/f44/03c743f44fd4460180b1c33e986b8804.jpg"><br><br><img src="https://habrastorage.org/files/ba1/159/66a/ba115966a97f4a36a1078b92c5825307.jpg"><br><br><img src="https://habrastorage.org/files/1f8/18e/30d/1f818e30d47e4ef1aa80bb5384d42b0c.jpg"><br><br><h4>  Golden Rules </h4><br><ul><li>  Choose the right size.  Always carefully double-check how many bits you need to store each variable to choose (long, int, double, float, etc.) in a particular language and specific operating system. </li><li>  Use integers instead of float where possible.  Keep money in cents, not dollars (or rather satosi).  If you still need to use float, use double precision. </li><li>  Never use float as a loop counter. </li><li>  Avoid mixed types (signed, unsigned; integer, floating point; single precision, double precision).  Carefully perform the conversion. </li><li>  Check for possible overflow situations.  Check the division by zero. </li></ul><br>  Article from PVS: <a href="http://www.viva64.com/ru/b/0074/">Why do we get different results in 32-bit and 64-bit code?</a> <br>  Article from habraravtora (229 comments): <a href="https://habrahabr.ru/post/309812/">Fatal errors of binary arithmetic when working with floating-point numbers</a> . <br><br><h2>  Read more about the Patriot </h2><br><ul><li>  Bug <a href="https://news.ycombinator.com/item%3Fid%3D7458812">talk</a> on hackernews </li><li>  New York Times: <a href="http://www.nytimes.com/1991/05/20/world/after-war-army-blaming-patriot-s-computer-for-failure-stop-dhahran-scud.html%3Fpagewanted%3Dall">AFTER THE WAR;</a>  <a href="http://www.nytimes.com/1991/05/20/world/after-war-army-blaming-patriot-s-computer-for-failure-stop-dhahran-scud.html%3Fpagewanted%3Dall">For the Failure to Stop the Dhahran Scud Army</a> </li><li>  <a href="http://embeddedgurus.com/barr-code/2014/03/lethal-software-defects-patriot-missile-failure/">Lethal Software Defects: Patriot Missile Failure</a> </li><li>  Software Bug Report: <a href="http://www.cs.usyd.edu.au/~alum/patriot_bug.html">Patriot Missile Software Problem</a> </li></ul><br><h2>  Conclusion </h2><br>  We want to draw people's attention to the problems of software reliability.  Programs are not only strange incomprehensible calculations of scientists on Fortran or computer games for a long time.  This is what surrounds us for a long time and everywhere. <br><br>  Previously, serious bugs caused damage in narrow specific areas - peaceful rocketry ( <a href="https://habrahabr.ru/company/pvs-studio/blog/306748/">Ariane 5</a> ) and military ( <a href="https://habrahabr.ru/topic/312890/">Patriot</a> ).  Now you may encounter an error in the program not only sitting at the computer, but also sitting in the car ( <a href="https://habrahabr.ru/company/pvs-studio/blog/310862/">Toyota</a> ) or visiting the hospital ( <a href="https://habrahabr.ru/company/pvs-studio/blog/307788/">Therac-25</a> ).  We are one of those who fight on the side of programmers against bugs.  We have developed a <a href="http://www.viva64.com/ru/t/0046/">static code analyzer PVS-Studio</a> , which allows detecting many errors in C, C ++ and C # programs at the coding stage.  And taking this opportunity, I want to remind you that from October 25, 2016, not only Windows, but also the Linux version of this analyzer will be available. </div><p>Source: <a href="https://habr.com/ru/post/312890/">https://habr.com/ru/post/312890/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312880/index.html">Math in javascript</a></li>
<li><a href="../312882/index.html">Anatomy of KD-Trees</a></li>
<li><a href="../312884/index.html">A brief history of the gaming industry by platform</a></li>
<li><a href="../312886/index.html">Telegram bots: to help the editor</a></li>
<li><a href="../312888/index.html">IoT market. There are many grades, no consensus</a></li>
<li><a href="../312892/index.html">We introduce a full-fledged system of feedback about each other on "Freelance"</a></li>
<li><a href="../312894/index.html">How in Java to shoot yourself in the leg of lambda and not to miss</a></li>
<li><a href="../312896/index.html">Welcome to Moscow CocoaHeads Meetup October 28</a></li>
<li><a href="../312898/index.html">Thermal Resistance: Theory</a></li>
<li><a href="../312900/index.html">Multiseat on a Debian computer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>