<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with tables in MultiCAD.NET. Part 2. Creating and editing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article, we introduced you to an example of using the table functionality of the MultiCAD.NET API to automatically generate a report o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with tables in MultiCAD.NET. Part 2. Creating and editing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/299/286/8ec/2992868ecc6f2f7893017886676f0999.png"><br><br>  In the previous <a href="http://habrahabr.ru/company/nanosoft/blog/197794/">article,</a> we introduced you to an example of using the table functionality of the MultiCAD.NET API to automatically generate a report on selected objects.  We intentionally violate the chronology and today's publication will begin with the creation and formatting of the simplest table.  Consider filling the table with data in text and numeric format, as well as the use of formulas.  Then, we proceed to adding blocks and sub-tables as the contents of cells and conclude the article with a description of using properties of drawing objects as dynamically changeable data in a table. <br><a name="habracut"></a><br><br><h5>  Creating and formatting tables </h5><br>  In the MultiCAD.NET API, tables are represented by the <code>McTable</code> class from the <code>Multicad.Symbols.Tables</code> namespace.  The following code fragment creates an empty table, and then adds 2 rows and 3 columns to it, starting from the zero position: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs">McTable Table1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> McTable(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowCount = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> colCount = <span class="hljs-number"><span class="hljs-number">5</span></span>; Table1.Rows.AddRange(<span class="hljs-number"><span class="hljs-number">0</span></span>, rowCount + <span class="hljs-number"><span class="hljs-number">1</span></span>); Table1.Columns.AddRange(<span class="hljs-number"><span class="hljs-number">0</span></span>, colCount);</code> </pre><br><br>  In the same way, any range of rows and columns can be added to the specified positions. <br><br>  Add the content for the newly created table and define the format of the cells.  For example, the table will store data on the list of parts: the sequence number in the table, name, batch number, material and quantity.  For cells containing the number of units, we define the number format, the remaining cells will contain text. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/001/11c/04f/00111c04ff758d1c54b1c473bdb62781.png"><br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Sets color and text height that will be used for all table cells by default: Table1.DefaultCell.TextHeight = 2.5; Table1.DefaultCell.TextColor = System.Drawing.Color.Aqua; // The first row is the title, let's merge all its cells and set text alignment and height System.Drawing.Rectangle rect = new System.Drawing.Rectangle(0, 0, colCount - 1, 0); Table1.Merge(rect); Table1[0, 0].HorizontalTextAlign = HorizTextAlign.Center; Table1[0, 0].VerticalTextAlign = VertTextAlign.Center; Table1[0, 0].TextHeight = 5; // Fill up the table foreach (var cell in Table1.Rows[2].Cells) { cell.VerticalTextAlign = VertTextAlign.Center; cell.HorizontalTextAlign = HorizTextAlign.Center; } Table1.Columns[0].Width = 10; Table1[0, 0].Value = " "; Table1[1, 0].Value = "."; Table1[1, 1].Value = ""; Table1[1, 2].Value = ", ."; Table1[1, 3].Value = ""; Table1[1, 4].Value = " "; Table1[2, 0].Value = "1."; Table1[2, 1].Value = ""; Table1[2, 2].Type = CellFormatEnum.Number; Table1[2, 2].Value = "1"; Table1[2, 3].Value = " "; Table1[2, 4].Value = "1938-1"; Table1[3, 0].Value = "2."; Table1[3, 1].Value = ""; Table1[3, 2].Type = CellFormatEnum.Number; Table1[3, 2].Value = "1"; Table1[3, 3].Value = " "; Table1[3, 4].Value = "0132-2"; Table1[4, 0].Value = "3."; Table1[4, 1].Value = ""; Table1[4, 2].Type = CellFormatEnum.Number; Table1[4, 2].Value = "1"; Table1[4, 3].Value = ""; Table1[4, 4].Value = "0715-7";</span></span></code> </pre><br><br>  One of the distinguishing features of tables in MultiCAD.NET is the ability to specify the placement of text in a cell if the width or height of the text is larger than the cell size when the table is filled.  Using the <code>HorzFits</code> property <code>HorzFits</code> you can set the following horizontal <code>HorzFits</code> modes: <br><br><ul><li>  <code>HorizontalFitsEnum.None</code> - do not enter text, the text may overlap adjacent cells, </li><li>  <code>HorizontalFitsEnum.Shrink</code> - compress text horizontally (the default mode), </li><li>  <code>HorizontalFitsEnum.Wrap</code> - wrap by words. </li></ul><br><br>  The <code>VertFits</code> property sets vertical text entry: <br><br><ul><li>  <code>VerticalFitsEnum.None</code> - do not enter text, the text may overlap adjacent cells, </li><li>  <code>VerticalFitsEnum.Shrink</code> - reduce the font height (the default mode), </li><li>  <code>VerticalFitsEnum.Expand</code> - increase line height, </li><li>  <code>VerticalFitsEnum.AddRows</code> - add pseudo-lines for each line of text. </li></ul><br><br>  Of course, after the table is formed, you can edit its structure.  For example, add, delete, or copy rows and columns.  Add another ‚ÄúBolt‚Äù part to the list, move the ‚ÄúQuantity‚Äù column to the last position and delete the column with part numbers: <br><br><pre> <code class="cs hljs">Table1.Rows.CopyRange(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); Table1.Columns.Move(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>); Table1.Columns.Delete(<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1bd/6dc/152/1bd6dc152c8c6c39d8f2ed694ae56034.png"><br><br>  Then add the ability to take into account the total number of parts in the table, using the built-in table formula "Amount": <br><br><pre> <code class="cs hljs">Table1.Rows.AddRange(Table1.Rows.Count, <span class="hljs-number"><span class="hljs-number">1</span></span>); System.Drawing.Rectangle rect2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> System.Drawing.Rectangle(<span class="hljs-number"><span class="hljs-number">0</span></span>, Table1.Rows.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>, Table1.Columns.Count - <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); Table1.Merge(rect2); Table1[Table1.Rows.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>].TextHeight = <span class="hljs-number"><span class="hljs-number">5</span></span>; Table1[Table1.Rows.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>].Value = <span class="hljs-string"><span class="hljs-string">":"</span></span>; String SummStartCell = Table1[<span class="hljs-number"><span class="hljs-number">2</span></span>, Table1.Columns.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].AddressOfCell(); String SummEndCell = Table1[Table1.Rows.Count - <span class="hljs-number"><span class="hljs-number">2</span></span>, Table1.Columns.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].AddressOfCell(); Table1[Table1.Rows.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>, Table1.Columns.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].ValueFormula = <span class="hljs-string"><span class="hljs-string">"=summ("</span></span> + SummStartCell + <span class="hljs-string"><span class="hljs-string">":"</span></span> + SummEndCell + <span class="hljs-string"><span class="hljs-string">")"</span></span>;</code> </pre><br><br>  As a result, our table will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8a5/459/fa9/8a5459fa931937ccb88d92cd1e1791ab.png"><br><br>  To summarize data from a range of cells, a string representation of the formula was added to the result cell.  In the table editor, the contents of this cell will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/35c/313/db1/35c313db1724830e21f542e1a094b5a2.png"><br><br>  The table editor itself can be called by double-clicking on the table in the drawing or programmatically by calling the <code>OnEdit()</code> method <code>OnEdit()</code> table object. <br><br>  Note that in the example for the contents of the cells with the number of parts, the number format was previously set.  The default format is <code>Auto</code> , which allows you to automatically determine the type of data. <br><br><h5>  Adding a table to a drawing </h5><br>  As a normal primitive, a table can be added to a drawing using one of two methods: <br><br> <code>Table.DbEntity.AddToCurrentDocument();</code>  - adds a table primitive to the drawing, the coordinates of the upper left corner of the table coincide with the origin. <br> <code>Table.PlaceObject();</code>  - interactive object insertion.  The user will be prompted to define the table insertion point.  Depending on the values ‚Äã‚Äãof the arguments, insertion can be performed with a preliminary call to the table editor.  Calling the method without arguments, as well as with the value <code>McEntity.PlaceFlags.Normal</code> will call the table editor. <br>  Add a table to the drawing using the interactive selection of the insertion point, without calling the table editor: <br><br><pre> <code class="cs hljs">Table1.PlaceObject(McEntity.PlaceFlags.Silent);</code> </pre><br><br><h5>  Using blocks and sub-tables as cell contents </h5><br>  In tables MultiCAD.NET, in addition to the usual text and numeric data, as the contents of the cells, you can use blocks and other tables.  Consider this possibility on the example of creating a table that will describe the elements of a metal profile.  The first column will indicate the type of the profile, the second - its specification, the third - the profile image: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2dc/1f2/92f/2dc1f292fd60f60aeff4151b8cdd41f3.png"><br><br>  Suppose a profile type specification is stored in a table of the following form: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f7/7a6/dd5/5f77a6dd5ed3d678d17e8e18eb7bcdf5.png"><br><br>  And the general view of various profiles is in the external file as separate blocks: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/290/c53/db7/290c53db74010053aae2637278c62e9f.png"><br><br>  Add a profile image and its specification to the main table. <br><br><h6>  Insert subtables </h6><br>  To insert subtables, use the method <br><br> <code>McTable.InsertSubtable(ref McTable inTable, int row, int col, InsertionModeEnum mode);</code> <br>  <code>inTable</code> - the table to be inserted <br>  <code>row, col</code> is the row and column number of the cell to insert into, <br>  <code>mode</code> - insert table mode. <br>  The insert modes can be as follows: <br><br>  <code>InSingleCell</code> - the table will be inserted into a separate cell.  The structure of the resulting table will be changed in accordance with the structure of the inserted table. <br>  <code>CellByCell</code> - the table will be inserted ‚Äúcell into cell‚Äù, starting with the top left.  The resulting table will contain those cells that are common to the structures of both tables. <br>  <code>Over</code> - the table will be inserted over.  The cell sizes of both tables do not change. <br><br>  Insert the profile specification table into a separate cell of the main table: <br><br><pre> <code class="cs hljs">Table1.InsertSubtable(ProfileTable1, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, InsertionModeEnum.InSingleCell);</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba7/50f/c10/ba750fc105cdcbe84825788540c6cf33.png"><br><br><h6>  Blocks as cell contents </h6><br>  To insert a block, use the <code>EmbedBlock()</code> method of the <code>Cell</code> class, which allows you to embed a block in a separate cell, specifying the block ID, its name or the block name and the name of the file that contains it: <br><br> <code>bool EmbedBlock(int row, int col, McObjectId Id);</code> <br> <code>bool EmbedBlock(int row, int col, ref String name);</code> <br> <code>bool EmbedBlock(int row, int col, ref String name, ref String fileName);</code> <br>  Insert the image of the guide profile, which is stored in an external file as a block: <br><br><pre> <code class="cs hljs">Table1[<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>].Value = <span class="hljs-string"><span class="hljs-string">" "</span></span>; Table1[<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>].EmbedBlock(<span class="hljs-string"><span class="hljs-string">"Profile_03"</span></span>, <span class="hljs-string"><span class="hljs-string">"C:\\Profiles.dwg"</span></span>);</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/299/286/8ec/2992868ecc6f2f7893017886676f0999.png"><br><br><h5>  Retrieving object properties to a table </h5><br>  Another useful function of the table API in MultiCAD.NET is the binding of primitives to the table.  After an object is attached to a table, you can use its properties as the contents of a cell using formulas.  The following code fragment appends a closed polyline to the table and receives the value of the area bounded by the polyline as the cell contents (0, 0): <br><br><pre> <code class="cs hljs">String <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> = Table1.AttachObject(polyline.ID); Table1[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>].ValueFormula = <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> + <span class="hljs-string"><span class="hljs-string">".\"Geometry.Area\""</span></span>;</code> </pre><br><br>  Binding objects to a table allows you to dynamically track changes: when the properties of an attached object change, the contents of the corresponding cell will also change. <br><br>  Discussion of the article is also available on our forum: <a href="http://forum.nanocad.ru/index.php%3Fshowtopic%3D6511">forum.nanocad.ru/index.php?showtopic=6511</a> . <br><br>  Translation of the article into English: <a href="http://developer.nanocad.com/blog/2014/04/02/tables-in-multicad-net-part-2-creating-and-modifying/">Tables in MultiCAD.NET.</a>  <a href="http://developer.nanocad.com/blog/2014/04/02/tables-in-multicad-net-part-2-creating-and-modifying/">Part 2: Creating and modifying</a> . <br><br><h5>  See also: </h5><br>  <a href="http://habrahabr.ru/company/nanosoft/blog/197794/">Work with tables in MultiCAD.NET.</a>  <a href="http://habrahabr.ru/company/nanosoft/blog/197794/">Part 1. Creating a report based on a template</a> <br>  <a href="http://habrahabr.ru/company/nanosoft/blog/198788/">Work with tables in MultiCAD.NET.</a>  <a href="http://habrahabr.ru/company/nanosoft/blog/198788/">Part 3. External table files and data exchange with Microsoft Excel</a> </div><p>Source: <a href="https://habr.com/ru/post/198774/">https://habr.com/ru/post/198774/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198762/index.html">Chicken or egg: what before, prototypes or TK?</a></li>
<li><a href="../198764/index.html">A record for the speed of data transmission through lasers to the moon and back</a></li>
<li><a href="../198766/index.html">How 45 minutes to lose $ 172 222 per second</a></li>
<li><a href="../198770/index.html">World View: stratospheric tourism in an air (helium) balloon</a></li>
<li><a href="../198772/index.html">Active authors in social media: a study by age group</a></li>
<li><a href="../198776/index.html">JavaFX WebView (HTML / JS) - we use web practices for developing desktop applications</a></li>
<li><a href="../198778/index.html">The story of one Google Chrome extension</a></li>
<li><a href="../198780/index.html">Qt Meta System over Network. Part 2 - Signals and Slots</a></li>
<li><a href="../198782/index.html">Modding of the pulse power supply unit ARPV-SC1E-12005T</a></li>
<li><a href="../198784/index.html">Materials of the summer school on bioinformatics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>