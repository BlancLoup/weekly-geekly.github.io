<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The first acquaintance with the Linux kernel version 3.3 and 3.4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Next is an article translation from the IBM website. It is unlikely that you will learn something fundamentally new from it. This article is good to u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The first acquaintance with the Linux kernel version 3.3 and 3.4</h1><div class="post__text post__text-html js-mediator-article">  <i>Next is an article translation from the IBM website.</i>  <i>It is unlikely that you will learn something fundamentally new from it.</i>  <i>This article is good to use as a starting point for reading about interesting or previously unknown features of Linux.</i>  <i>Some references I cited in the text of the article in italics, some can be seen at the end of the original article.</i>  <i>My explanations or comments are in italics.</i> <br><br>  Linux kernel releases versions 3.3 and 3.4 include an impressive amount of improvements.  However, these releases are not just kernel development, but an ominous line on the path of this development. <br>  The release of version 3.3 is the first release of the Linux kernel, the volume of which exceeded 15 million lines (even if it is based on a frankly curved measurement method).  If you subtract the variable, non-permanent part of the code (various drivers, platform-specific code and various utilities), the number of lines drops slightly below 4 million ‚Äî the leviathan in person. <br><a name="habracut"></a><br>  The speed at which the core grows is ominous at this turn (a fifty percent growth since 2008), and the fact that this growth can adversely affect the core (both in terms of performance and in terms of core capabilities).  Opportunities and performance usually do not measure ‚Äúby the bat‚Äù, so a bug that may last for some time may well get into the kernel (for example, a problem with PCIe ASPM, which was in the kernel for almost a year, but was fixed in version 3.3. <i>Description of <a href="http://www.pcworld.com/businesscenter/article/244277/new_kernel_patch_slashes_linuxs_power_appetite.html">www.pcworld com / businesscenter / article / 244277 / new_kernel_patch_slashes_linuxs_power_appetite.html</a> and patch ( <a href="https://lkml.org/lkml/2011/11/10/467">lkml.org/lkml/2011/11/10/467</a></i> ) <br><br>  In less than 21 years, Linux has grown from 10,000 lines of code to more than 15 million.  In addition, most of this code is in the drivers subtree, and the complexity of the kernel increases with its size.  Sooner or later, this extension should result in changes that will make the kernel more simple.  Both from the point of view of the code, and from the point of view of support of this code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/28f/7ae/b48/28f7aeb483a1b765c5e5c9938b66290c.jpg"><br><br>  As shown in Figure 1, the kernel has grown rapidly since the release of 2.4 in 2001 (from 3,377,902 lines to 15,998,651 lines in 2012).  During this period, each year about a million lines were added to the core.  This is a stunning illustration and should inspire fear to every software developer. <br><br>  They quote the words of Torvalds himself, about his concern for supporting the core, as it grows.  With 4 million lines of code that make up the core of the kernel, the current kernel source control system may need to be improved. <br><br><h5>  Android integration. </h5><br><br>  The biggest news of kernel 3.3 is the inclusion of Google Android in the main branch of the kernel.  This integration will continue in kernel 3.4, but already in the kernel there is enough code from the android to support the loading of the android in user-space.  The core of the android is a fork of the Linux kernel, with several features.  These features are introduced for the efficient operation of mobile devices, which are severely limited in available power.  In addition, in Android, the main focus is on the ARM architecture, although x86 support is also present (for example, for the Google TV project). <br><br>  The problems of interaction between Linux maintainers and Google led to the fact that Android was developed separately for several years.  In the winter of 2011-2012, the Android Mainlining project was created, whose goal is to integrate drivers and new Android core functions into the main Linux source tree.  The work done was presented to the general public in kernel 3.3 and will be continued in subsequent releases. <br><br>  Android made several improvements to Linux that were needed to be competitive in a mobile environment.  As an example, fast interprocess communication mechanisms (Fast IPC), improved memory management mechanisms and solving the problem of managing large continuous memory areas can be cited. <br><br>  <b>Binder</b> is a driver that has become the answer of Android to standard IPC mechanisms.  Android developers could easily use existing code, however, <b>Binder's</b> development provided several unique ‚Äúchips‚Äù that were previously unavailable (sending messages without copying and sending ‚Äúmandates.‚Äù For more information, see <a href="http://lwn.net/Articles/466304/">lwn.net/Articles/466304</a> ).  In Android, applications never exit as usual, they work until the kernel completes them.  To optimize the use of memory, there is a mechanism called <b>Shrinker</b> .  Applications register a function that, when called, minimizes the amount of memory they use.  The kernel calls these functions when it starts to run out of memory.  Another mechanism that migrated from Android is <b>Pmem</b> .  This mechanism allows you to allocate a physically continuous section of memory.  This function is used, for example, when the camera is operating in phones.  As part of this mechanism, there is an API in user space with which you can get a continuous chunk of memory from the system.  In addition to these mechanisms, other functions specific to mobile devices were transferred from Android. <br><br>  Some mechanisms have not yet hit the core.  For example, <b>wakelocks</b> is a power management mechanism that allows individual programs to prevent the system from entering a low-power state (for example, if an update is in progress).  This, of course, does not prevent Android from booting up, but it can lead to a quick devouring of the battery. <br><br>  The merging of Android with the mainstream Linux kernel is another illustration of the flexibility of Linux.  From embedded and mobile systems to the world's largest mainframes and supercomputers: Linux has got accustomed everywhere.  And Linux continues its development as a universal system on more than 300 million mobile devices. <br><br><h5>  Open vSwitch </h5><br><br>  Linux continues to be the most popular virtualization platform.  Linux is not only a world-class operating system, but also a world-class hypervisor.  The introduction of <b>Open vSwitch</b> into the main branch of the kernel confirms this status for those users who use Linux as a virtualization platform and provide IaaS services on Linux. <br><br>  A virtual switch is nothing more than a software implementation of a hardware switch.  Let me remind you just in case that the virtualization platform (as done in KVM or Xen) allows you to run multiple copies of operating systems (as virtual machines) on a hypervisor that controls access to the physical resources of the machine.  The introduction of a virtual switch extends this abstraction by introducing new forms of network infrastructure.  A virtual switch provides efficient tools for virtual machines to communicate with each other over a virtual network.  <b>Open vSwitch</b> extends the functions of a virtual switch, allowing you to integrate virtual networks of several hypervisors.  Thus, virtual machines can communicate via a virtual network with machines that are on other hypervisors. <br><br>  Inside the <b>Open vSwitch</b> implemented a wide range of functions for network virtualization.  These features include QoS, vlans, filtering and isolating traffic, as well as a set of protocols for monitoring and control (such as OpenFlow and NetFlow).  Despite the fact that Linux already had a virtual switch implementation (Linux Bridge), <b>Open vSwitch is a</b> much more functional solution and therefore a welcome addition. <br><br><h5>  File system changes. </h5><br><br>  In release 3.3, some changes have been made to a number of file systems that will be relevant for both users and developers.  For users, this is an online resizing of <b>ext4</b> volumes, by monitoring I / O operations (calling ioctl with the ‚ÄúEXT4_IOC_RESIZE_FS‚Äù flag).  By "online" is meant that the system remains in working condition.  In addition, now the entire resizing operation is performed in the kernel, which speeds it up. <br><br>  The balancing mechanism for <b>btrfs has been rewritten</b> .  Now it supports suspending and resuming work.  This mechanism is used to change the structure of the metadata in such cases, for example, as adding a new hard disk.  The <b>btrfs enhancement</b> continued in release 3.4, in which the utility for recovering data from damaged volumes was introduced ( <b>btrfs-restore</b> ).  In addition, some changes were made to release 3.4, which improved speed and error handling in <b>btrfs</b> : instead of some error messages, now there is an elegant handling of these very errors.  <i>Before the 3.4 <b>btrfs</b> release, due to the COW mechanism, it was not very compatible with the Linux virtual memory manager (the latter tended to cache already unnecessary btrfs pages for too long).</i>  <i>A revision was made to cure this deficiency.</i>  <i>(corrected according to <a href="http://juick.com/thegreatz/1982110">juick.com/thegreatz/1982110#5</a> )</i> <br><br>  <b>RAID</b> implementation has also been changed.  Now the software implementation of RAID supports ‚Äúhot swap‚Äù: data from one volume can be transferred to another volume, with the first one being later removed from the array without losing data.  This function is controlled through the familiar mdadm. <br>  Finally, in release 3.4, support for the <b>QNX4</b> file system has been added (so far in read-only mode). <br><br>  Developers were able to make errors in the network file system ( <b>NFS</b> ) to verify the client‚Äôs ability to recover from these errors (the mechanism works through sysfs).  For <b>brtfs</b> developers, a file system integrity check utility has been added that can be used to detect invalid write requests, which will make it possible to fix problems faster. <br><br><h5>  Network improvements. </h5><br><br>  Also in release 3.3 several advanced changes were made. <br><br>  For low-latency environments (such as supercomputer computing), the ability to provide access to devices using the SCSI RDMA protocol was introduced ( <i>you can read very briefly here: <a href="http://ru.wikipedia.org/wiki/InfiniBand">ru.wikipedia.org/wiki/InfiniBand</a></i> ).  SCSI RDMA is a protocol that allows you to use RDMA as a transport for block devices.  RDMA is supported by InfiniBand and is quite common in supercomputer computing environments. <br><br>  The <b>RED (Random Early Detection</b> ) package scheduler has been modified.  The work algorithm was changed in accordance with the proposals of Sally Floyd, Ramakrishna Gummadi and Scott Shenker.  The new scheduler is called <b>ARED</b> (Adaptive RED, it is customary to translate ‚Äúadaptive‚Äù;).  RED tracks the average size of the queue and dropped packets based on statistical probability.  With an empty queue, all packets are accepted.  When the queue is full above the threshold, almost all packets are dropped.  In each case, ARED decides whether to make the RED more or less aggressive, based on observations of the average queue length.  <i>You can learn more about ARED from the materials at the link: <a href="http://icir.org/floyd/papers/adaptiveRed.pdf">icir.org/floyd/papers/adaptiveRed.pdf</a> .</i> <br><br>  Also in release 3.3 a new implementation was added to replace the outdated <b>bonding</b> driver.  Grouping several physical interfaces into one virtual interface allows you to create interfaces with more reliability and bandwidth (in accordance with, for example, the 802.1AX protocol).  Currently, two modes of operation of the new mechanism are supported: simple packet distribution according to the round-robin or active-backup rule.  In the first case, the packets are sent in turn from each of the physical interfaces.  In the second case, the data is transmitted over one physical interface, and during its ‚Äúfall‚Äù - over the backup one. <br><br>  Among the large number of changes made, you can also highlight an interesting addition to the <b>cgroups</b> implementation: added implementation of buffer constraints for TCP.  <b>cgroups</b> are used in various ways.  Including - to limit the resources of virtual machines.  After this change, the use of system memory has become more subtle, and therefore more detailed control of the system as a whole. <br><br><h5>  Other interesting changes </h5><br><br>  The release of kernel 3.3 also includes changes unrelated to file systems or the network.  Support for the new architecture has been added: the project code has been added to the main branch of the kernel, to support the C6x process from Texas Instruments.  C6x is a VLIW processor architecture with one or more cores.  These processors do not support features such as SMP and cache coherence.  In addition, they do not have a memory management unit (MMU).  Despite these shortcomings, processors of the C6x series have a wide range of peripherals and additional units made directly on the chip (for example, for fast Fourier transform). <br>  Release 3.4 includes support for the latest GPUs, such as Nvidia Kepler and the latest AMD Radeons and Trinity <br><br>  In the ARM architecture, the LPAE extension is now supported (PAE for working with memory up to 1TB. For more details, for example, pdf from the page <a href="http://www.linux-arm.info/index.php/130-linux-support-for-arm-lpae">www.linux-arm.info/index.php/130-linux-support-for-arm-lpae</a> ).  In addition, support for Nvidia single-chip systems (Tegra 3) is included.  These changes allow ARM processors to compete with Intel processors in the low-power server segment.  A number of changes were made to the implementation of AMD IOMMU, which improved resizable memory page management and security in terms of memory access.  Virtual I / O functions are expanding the KVM capabilities for providing devices to virtual machines. In addition, the S390 architecture has been enhanced to support up to 64TB of RAM (as opposed to 1 TB in previous versions) <br><br>  The performance monitoring unit received a virtual interface for KVM.  Thus, the guest OS can now monitor the performance on its platform.  Within the framework of this monitoring, such metrics as ‚Äúthe number of executed instructions (retired instructions), hits and misses on the cache, as well as the success of prediction of transitions are available.  Another useful innovation is the "safe reset" function.  This function allows you not only to mark a sector in the query as free, but to completely delete it. <br>  Different I / O drivers (blk, net, balloon and console) now support ACPI and S4 sleep state, which means that guest VMs on Xen can now be hibernated. <br><br>  To debug complex memory corruption problems, a new configuration option CONFIG_DEBUG_PAGEALLOC has been added.  When enabled, the processor access to non-alloted pages will be monitored.  Enabling this option will naturally lead to a decrease in performance. <br><br><h5>  A look into the future. </h5><br><br>  Linux continues to evolve and while release 3.4 is already out, release candidate 3.5 is almost ready for release in August 2012. <br>  In the next release, we are also waiting for a lot of new things: btrfs has improved the writeback mechanism, added the ability to store checksums to ext4, to determine data manipulations.  Linux may soon support the provision of access to its devices via SCSI over FireWire or SCSI over USB.  They also promise to include support for the survey in the user-space and use SystemTap to analyze the data.  In the future, many more interesting things await us, as the core develops. </div><p>Source: <a href="https://habr.com/ru/post/147517/">https://habr.com/ru/post/147517/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147510/index.html">Script for easy viewing Wikipedia July 10, 2012</a></li>
<li><a href="../147512/index.html">WysiBB - WYSIWYG BBCode Editor</a></li>
<li><a href="../147513/index.html">How to remove the stub on wikipedia</a></li>
<li><a href="../147515/index.html">CMS among the winners of the contest "Rating Runet-2011"</a></li>
<li><a href="../147516/index.html">Instructions for compiling Android 4.1 "Jelly Bean" on Ubuntu</a></li>
<li><a href="../147518/index.html">FuelPHP year after 1.0</a></li>
<li><a href="../147521/index.html">Ballmer: Microsoft will not leave uncovered areas for Apple</a></li>
<li><a href="../147522/index.html">Install Ubuntu / Debian via debootstrap from another Linux system</a></li>
<li><a href="../147524/index.html">Deploying Skype Alert Gateway In The Cloud</a></li>
<li><a href="../147525/index.html">Up-to-date Unix Way or pipe to browser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>