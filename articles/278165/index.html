<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Best practices Richard Siddeway Powershell in depth</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Powershell in depth translation. chapter 40. 

 This chapter contains: 
 best practice for all occasions 
 best practice for advanced scripts 
 best p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Best practices Richard Siddeway Powershell in depth</h1><div class="post__text post__text-html js-mediator-article">  <b>Powershell in depth translation.</b>  <b>chapter 40.</b> <br><br>  This chapter contains: <br>  best practice for all occasions <br>  best practice for advanced scripts <br>  best practice for industrial use <br><br>  Throughout this book, useful tips, practical tricks were given on how to ease your efforts, facilitate script support, speed up execution, and achieve greater flexibility.  In this chapter, we collected our recommendations and organized them for convenient use.  Our best recommendation is to use PowerShell every day.  The following recommendations are not in order of importance. <br><a name="habracut"></a><br>  <b>40.1 PowerShell general best practices</b> <br>  these recommendations are given to you to become better in powershell <br><ul><li>  Read the help system, it contains a lot of useful information, especially examples. </li><li>  Use powershell 3 to do a task in the scheduler for regular help updates. </li><li>  Set a script execution policy to at least <i>RemoteSigned</i> </li><li>  Use conveyor.  PowerShell is designed for use with pipeline.  If you encode in the style of old scripting languages, you will lose most of the functionality and create yourself a lot of work. </li><li>  Let variable names meaningful, for example, <i>$ computer is</i> better than <i>$ x</i> </li><li>  Avoid names with spaces or special characters such as <i>$ {computer}</i> </li><li>  Never set <i>$ ErrorActionPreference</i> (or <i>$ VerbosePreference</i> or any other ‚Äúpreference‚Äù variable) globally in a shell, script, or function.  Instead, use parameters, such as <i>-ErrorAction</i> , or for the function parameter <i>-Verbose</i> , to set the parameter where required. </li><li>  Avoid brute force collections ‚Äî use <i>ForEach-Object</i> or <i>ForEach</i> , except when there is no other way to achieve the goal.  (PowerShell doesn't like For-type constructions) </li><li>  Use mostly single quotes if you do not need to substitute a variable or evaluate expressions within a string.  If you work with SQL queries, remember that single quotes are used for strings and you need to specifically isolate or use double quotes. </li><li>  Replacing strings, or animating is much easier than string concatenation. </li><li>  Use built-in constants, PowerShell understands KB, MB, GB, TB and PB (built-in variables) </li><li>  Avoid using native .NET classes and methods, except when there is no other alternative. </li><li>  Be careful with the code downloaded from the Internet, always double check what the code does.  Your environment may be different than the author‚Äôs environment and may cause many problems in your environment. </li><li>  Filter early, format late!  Do data sampling as soon as possible by reducing their volume, but format the data as late as possible, preferably just before displaying it. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>40.2 best practices for advanced scripts</b> <br><ul><li>  These recommendations are designed to write the best scripts. </li><li>  Explicitly <i>indicate the</i> type of the variable, write <i>[string] $ logfile</i> </li><li>  Assign variables to an explicit value after creation, if this variable is in this osprey.  (easier - always initialize) </li><li>  Give names to functions and threads in the style of gagol-action for example <i>Get-DiskInfo</i> </li><li>  When a script that performs a task begins to be used before it is designed as a separate function, give the script file a name in the style of cmdlets, for example, <i>Set-UserAttributes.ps1</i> </li><li>  Giving the name of the function or script in the form of a verb-noun add two or three letters of the prefix to the noun.  This is usually abbreviated from the name of your organization.  For example, for the company <i>‚Äúgreat things‚Äù</i> it could be <i>GT</i> , then the function name could look like <i>Get-GTUserInfo</i> or the script could be called <i>Set-GTUserInfo.ps1</i> </li><li>  If you create private (non-exported) variables in a module, give these variables distinct names.  Many developers use an underscore to highlight these names, such as <i>$ _private</i> or <i>$ _counter</i> . </li><li>  When defining script parameters or functions, use the parameter names that match the parameter names of standard cmdlets that perform the same function.  For example, the name of the <i>-Computername</i> parameter <i>is</i> preferable to <i>-host</i> or <i>-machines,</i> since  is standard for cmdlets.  You can always define an alias if you like it that way. </li><li>  Avoid using Write-Host except when you need to display a message on the screen.  If you are using Write-Host, use color highlighting or background color highlighting so your message will be highlighted on the screen. </li><li>  Use <i>[CmdletBinding]</i> in your scripts and functions to use verbose, debugging, and advanced functionality. </li><li>  If your function makes changes to the system, add support for <i>-WhatIf</i> and <i>-Confirm</i> </li><li>  Use <i>Write-Verbose</i> to display the progress of the execution so that you can use this parameter to track where your function is going, or what it is doing now. </li><li>  Use <i>Write-Debug</i> to display messages necessary for more successful debugging, remember that <i>Write-Debug</i> stops the execution of the script and gives you the opportunity to suspend its work. </li><li>  Remember that <i>Write-Warning</i> exists for those cases when you need to display an informational message on the screen. </li><li>  <b>Scripts and functions must produce one and only one type of data at the output.</b>  Usually this is an object and it can be a specially designed type of object combining the properties of many different objects. </li><li>  Always write help for your scripts and functions, even if it is based on comments.  XML help is usually used if you need to do help in different languages. </li><li>  Avoid changing aliases, variables, and other elements of a different scope than yours.  (It turned out abstrusely. It's easier - do not change anything in other Osprey, in every possible way avoid it, otherwise you will get a code that is difficult to refactor and debug) </li><li>  <i>Separate the task into clear, small pieces according to their functionality and select each as a function.</i>  An example, a script that executes 10 different things should be split into 10 different functions, and the script should make calls to these functions in the right order. </li><li>  Sign the code examples that you plan to distribute along with the script with your certificate if you plan to post it in public.  Yes, this requires that you have a certificate for signing the code, for this you have to get it somewhere.  But this is a good way for a public to check that your code has not been corrected by anyone. </li><li>  Avoid using Hungarian notation in variable names.  Conventions like <i>$ strName</i> or <i>$ intCounter</i> for powershell are obsolete and have no meaning.  (easier - do not use the naming from the old school, just call it. There are no types in PowerShell as such, there is no need for Hungarian notation) </li><li>  Use padding for code blocks such as {your code here} in contractions, your code will become readable. </li><li>  Use <i>Write-Verbose</i> , <i>Write-Debug,</i> and similar inserts to document scripts and functions, use these constructions instead of inserting comments for the same purpose. </li><li>  In scripts, functions, or <i>workflow,</i> avoid aliases (with the exception of common ones, such as <i>Dir</i> ) and abbreviations for parameter names.  Write the full names of the parameters and cmdlets for better understanding and readability. </li><li>  Avoid using the hyphen (`) at the end of the line to move the rest of the line to another line.  Instead, break the line in a ‚Äúnatural‚Äù place.  Make a line break after any of the following characters <i>({,; |</i> these characters allow you to continue the current line from a new line. </li><li>  If you use a proxy function, make sure that you publish it in your module. </li><li>  Use the <i>Test-Path</i> and verify to them the existence of a folder and files. </li><li>  <i>Try..Catch ... Finally</i> should be used wherever an exception can cause execution problems. </li><li>  <b>Keep the code logically simple</b> , for example, avoid double negative in the <i>if</i> expression </li><li>  <i>Do not use Notepad as a script editor</i> , with the exception of very simple actions.  Use Powershell ISE.  Notepad is suitable for quick viewing the code of small scripts, because  notepad is the default editor </li><li>  <i>Avoid using the word return</i> .  <b>Instead, think about how objects are transmitted along the conveyor</b> .  (there is a special chapter describing how to correctly pass the parameters. It is so specific for posed that it deserves a separate article) </li></ul><br><br>  <b>40.3 best practices for industrial use</b> <br>  These recommendations are designed for better use in the industrial environment. <br><ul><li>  Use group policies to distribute <i>PowerShell remoting</i> settings and script execution policies </li><li>  Use remote connection and <i>CIM sessions</i> to access if there are more than one remote machines. </li><li>  Use tasks <i>(PowerShell jobs)</i> if you need to perform long operations </li><li>  Use workflows when you need scripts that can survive reboot, interrupt, or parallel computations. </li><li>  Keep the scripts in the version control system, you will have a backup copy and you can return to the old version if necessary. </li><li>  Restrict access to your scripts, only for those who need them. </li><li>  Use <i>Test-Connection</i> to check the availability of the remote machine before you start working with it.  (easier - check the availability of the host always) </li><li>  Make sure that remoting is enabled on your servers. </li><li>  Credits must be specified before they are used, do not create them in the code, especially if you need more than one.  (easier - do not generate or store passwords in scripts, request them before use) </li><li>  Use <i>DCOM WS-MAN</i> for <i>CIM sessions</i> if possible. </li><li>  Develop standardized script templates, especially if the script is written by a team of administrators. </li><li>  Set the <i>AllSigned</i> execution <i>policy</i> , use the code signature with a certificate from your PKI (later I will do a separate translation of the Security debate chapter) </li><li>  Create a public script and define in it common functions, aliases, variables that your team may need.  Store this script in a publicly accessible location <i>accessible by UNC</i> and then add it to your profile. </li><li>  We hope that this is understandable without words.  <i>Test everything in a test environment</i> .  With modern virtualization capabilities, it's easy to do checks.  You will not need any particularly expensive hardware, you can start with free VirtualBox or install a trial version of the product from Microsoft </li></ul><br><br>  Don Jones, Richard Siddaway.  Powershell in depth.  chapter 40. </div><p>Source: <a href="https://habr.com/ru/post/278165/">https://habr.com/ru/post/278165/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278137/index.html">PHP Digest number 80 - interesting news, materials and tools (February 14 - 28, 2016)</a></li>
<li><a href="../278151/index.html">Pathfinding: A simple implementation of a funnel algorithm (Funnel Algorithm)</a></li>
<li><a href="../278153/index.html">Part 1. Installing and Configuring a Reputable DNS Server Based on the PowerDNS Solution // Basic Installation</a></li>
<li><a href="../278159/index.html">Debian's RISC under QEMU</a></li>
<li><a href="../278163/index.html">CodingFuture + Puppet. Part III: Install Puppet Server (cfpuppetserver)</a></li>
<li><a href="../278167/index.html">HTTP / 2: getting ready for the transition</a></li>
<li><a href="../278169/index.html">How to shoot yourself in Kotlin</a></li>
<li><a href="../278171/index.html">Simple checksum calculation</a></li>
<li><a href="../278173/index.html">ASP.NET Core + Docker: Cooking Together</a></li>
<li><a href="../278175/index.html">Differences between Azure Resource Manager and Azure Service Manager - a developer‚Äôs perspective</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>