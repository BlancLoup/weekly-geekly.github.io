<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to strengthen password protection "12345" from brute-force attack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Object: web login form. 
 Given the task: to strengthen the protection of a user account from the selection of a simple password to his account, using...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to strengthen password protection "12345" from brute-force attack</h1><div class="post__text post__text-html js-mediator-article">  <b>Object:</b> web login form. <br>  <b>Given the task:</b> to strengthen the protection of a user account from the selection of a simple password to his account, using a minimum of funds. <br><br>  What is the minimum of funds?  It does not use reference tables for blocking by IP address and User-Agent.  Do not use unnecessary requests to the system, do not litter the authorization system with unnecessary cycles. <br><br>  And, to fulfill a completely magical requirement - even if the bot enters the necessary login and password ... do not let it enter, but let the real user in. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Is it possible to do so?  In theory, of course not.  But in practice, in private and under certain conditions, as it turned out, it is quite possible. <br>  I invite under the cat for details. <br><a name="habracut"></a><br>  So, suppose that our user‚Äôs login is ‚Äútest‚Äù and the password is ‚Äú12345‚Äù.  Nasty bot has connected its dictionary of generated passwords, and is ready to work at a speed of 700 passwords per second.  He knows that the username is ‚Äútest‚Äù.  The situation is sad: the password "12345" will be calculated in a very short time.  The user, meanwhile, opened the site and began to enter the login and password into the web login form. <br><br>  Let's make changes to the authorization system, while none of them started their work, and trouble did not happen. <br><br>  The magic will be in the third variable, which should be ‚Äúpasted‚Äù to the login-password pair.  I called it <b>touch</b> . <br><br>  Every time when someone receives (attention: <b>receives</b> , but does not request!) Login password, the date of ‚Äútouch‚Äù for the user ‚Äútest‚Äù is updated for the current date-time: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">login</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>/touch: <span class="hljs-string"><span class="hljs-string">'test'</span></span>, <span class="hljs-string"><span class="hljs-string">'12345'</span></span>, <span class="hljs-string"><span class="hljs-string">'2014-12-13 14:00:00'</span></span>.</code> </pre> <br>  Suppose the bot started the first iteration and suggested the password ‚Äú1‚Äù for the login ‚Äútest‚Äù in 2014-12-13 15:00:00.  It is running a login_check controller, which reads a login-password pair from the database, which no one ‚Äútouched‚Äù for 2 seconds!  Where do these 2 seconds come from ?!  This will be further. <br><br>  This pair of login-password is located.  The difference between the last ‚Äútouch‚Äù and the current time is 1 hour.  Therefore, the record returns successfully to our request. <br><br>  First, the login-password pair is matched and login_check concludes that ‚Äútest / 12345‚Äù is not equal to ‚Äútest / 1‚Äù.  The controller returns "auth error".  And then the date of ‚Äútouch‚Äù for the user ‚Äútest‚Äù is updated to the current one: '2014-12-13 15:00:00'. <br><br>  The bot proceeds to the next iteration: it tries the password "2". <br><br>  The speed of the bot is measured in microseconds.  He is trying to log in immediately: in '2014-12-13 15:00:00'. <br>  And here our algorithm comes into action - the condition on the ‚Äútouch‚Äù parameter is no longer fulfilled.  2 seconds have not passed yet.  Fail. <br><br>  The login_check controller modified by our logic cannot receive a login-password pair. <br>  The record exists, but its ‚Äútouch‚Äù date is still too ‚Äúfresh.‚Äù <br><br>  And she is no longer in the sample.  And if there is no such login-password pair, the controller will respond to the bot ‚Äúauth error‚Äù. <br><br>  The bot does not give up, continues selection and, finally, comes to the correct password "12345". <br>  The probability that it is the current attempt will return success - extremely and extremely small.  1/700 for every login attempt!  That is, if earlier it was 1: 1, now it is 1: 700.  And the faster the bot, the greater the likelihood that it will fail. <br><br>  As a result, only a very small part of the passwords will be really verified.  The rest will receive false positives, even if they are correct. <br><br>  <b>And what about the user?</b> <br>  Let's start with the user.  The user, unlike a bot, enters the data in a web form with his hands through the keyboard and looks at the monitor with visual organs.  And the flexibility of its algorithmic abilities is much better than a bot.  In fact, the user is in some way an artificial intelligence.  So, part of the logic already lies in it.  And we will use it! <br><br>  When a user sees an authorization error, he often rewrites the password again.  Even if the password he just hammered himself.  Even if the password is substituted automatically from the password-manager.  I did this before I applied my simple password protection system. <br><br>  Yes, I promised to tell you about two seconds.  I tell: <br>  Two seconds is the optimal time for which the user performs data correction operations and makes the next attempt to enter.  In these two seconds, the user fits completely.  If the user does not meet, he can always try again and during this time the touch action is probably canceled. <br><br>  <b>Finally.</b> <br>  What will happen if the bot learns about the 2-second delay?  If we apply our test data, this means that the effectiveness of the bot will decrease: only 1 attempt to select a password instead of 1400. <br><br>  <b>PS</b> I really want to hear criticism, because the system has already been implemented in one project, and has not yet created a single ticket with the problem of access to the system. <br><br>  Thank you in advance. </div><p>Source: <a href="https://habr.com/ru/post/245903/">https://habr.com/ru/post/245903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245893/index.html">PHP Namespaces</a></li>
<li><a href="../245895/index.html">Introduction to cross-platform game development on haxe, flow, snow, luxe</a></li>
<li><a href="../245897/index.html">Video of Badoo reports from the Highload 2014 conference</a></li>
<li><a href="../245899/index.html">Collecting information about workstations via Powershell</a></li>
<li><a href="../245901/index.html">Introduction to .NET Core</a></li>
<li><a href="../245907/index.html">AppCode 3.1 and Swift: fast execution of your brilliant ideas</a></li>
<li><a href="../245909/index.html">Building a frontend with ErgoJS</a></li>
<li><a href="../245911/index.html">How to just make friends Symfony2 and RequireJS on the example of SPA</a></li>
<li><a href="../245913/index.html">The official release of JetBrains Upsource 1.0: viewing and reviewing code</a></li>
<li><a href="../245915/index.html">Those village - reviews of people working in the IT-sphere, about life in different cities and countries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>