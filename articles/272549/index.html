<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Getting SharePoint data on a client using SPServices</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, I needed to build a non-standard interface for list items in one of the projects on SharePoint 2013. The task can be divided into two...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Getting SharePoint data on a client using SPServices</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago, I needed to build a non-standard interface for list items in one of the projects on SharePoint 2013. The task can be divided into two subtasks: data acquisition and output to a page.  If the second is more or less clear how to solve (there are a lot of JavaScript-frameworks for data output), then the solution to the first approach can be called only the web services of the platform.  Already gathered to write something that would work with them, I found that it was already done in the form of the jQuery-library <a href="http://spservices.codeplex.com/">SPServices</a> , which allows you to use functions that work on top of the SharePoint web services.  Frankly, I was surprised a lot when I found that the topic was barely covered in Habr√©, there are only mentions in <a href="http://habrahabr.ru/post/154953/">two</a> <a href="http://habrahabr.ru/company/infopulse/blog/133117/">posts</a> .  In this article we will try to correct this omission. <br><a name="habracut"></a><br>  SPServices is a jQuery library written by <a href="http://sympmarc.com/">Mark Anderson</a> , which makes it quite easy to work with the SharePoint 2007/2010/2013 web services on the client side.  The library contains many possibilities for manipulating data: from getting the current user to updating list items. <br><br>  As an example, we will look at the solution of one of the most common tasks - obtaining data from the list, we will display on the page all employees with the last name Ivanov from the People list. <br><br>  First we use the library's GetListItems function and get a JSON object with the elements we need. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> src=<span class="hljs-string"><span class="hljs-string">"/SiteAssets/libs/SPServices.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> JSONdata; $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $().SPServices({ <span class="hljs-attr"><span class="hljs-attr">operation</span></span>: <span class="hljs-string"><span class="hljs-string">"GetListItems"</span></span>, <span class="hljs-attr"><span class="hljs-attr">webURL</span></span>: <span class="hljs-string"><span class="hljs-string">"/PeopleDataWeb"</span></span>, <span class="hljs-attr"><span class="hljs-attr">async</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">listName</span></span>: <span class="hljs-string"><span class="hljs-string">"People list"</span></span>, <span class="hljs-attr"><span class="hljs-attr">CAMLQuery</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;Query&gt;&lt;Where&gt;&lt;Eq&gt;&lt;FieldRef Name='LastName' /&gt;&lt;Value Type='Text'&gt;&lt;/Value&gt;&lt;/Eq&gt;&lt;/Where&gt;&lt;/Query&gt;'; CAMLViewFields: "</span></span>&lt;ViewFields&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FieldRef</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'FirstName'</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FieldRef</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'LastName'</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FieldRef</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'Age'</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ViewFields</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">", completefunc: function (xData, Status) { JSONdata = $(xData.responseXML).SPFilterNode("z:row").SPXmlToJson({ mapping: { ows_FirstName: {mappedName: "FirstName", objectType: "Text"}, ows_LastName: {mappedName: "LastName", objectType: "Text"}, ows_Age: {mappedName: "Age", objectType: "Integer"} }, includeAllAttrs: true }); } }); }); </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Consider what happens here: <br><br><ul><li>  In operation, we specify the type of operation.  There are a lot of operation types; in the <a href="http://spservices.codeplex.com/wikipage%3Ftitle%3D%2524%2528%2529.SPServices">documentation,</a> they are conveniently grouped by objects. </li><li>  webURL allows you to specify the relative address of the site where the list we need is located.  This parameter is optional, unless you explicitly specify it, the node will be taken from the current one. </li><li>  The async parameter specifies the asynchronous operation.  The default is true. </li><li>  listName is here, I think, understandable.  Indicates the display name (DisplayName) of the list.  Can be set as {GUID}.  Important point: the list should be on the site specified in the webURL parameter, even if we specify it through the GUID. </li><li>  CAMLQuery allows you to specify a CAML query for list items.  If the parameter is not specified, all elements are selected.  Let me remind you, for example, we take from the list of all employees with the last name Ivanov. </li><li>  And in CAMLViewFields, you must specify the list fields that we need. </li><li>  In the completefunc function, we describe what should happen if the request to the web service is successful.  Since in this example we are interested in receiving data in the form of JSON, we use two other library functions: SPFilterNode and SPXmlToJson to parse the XML response and convert to JSON, respectively.  The mapping parameter of the latter allows you to specify the internal name (Internal Name) of a list column and match it with a field in JSON, specifying the type. </li></ul><br>  So, we have JSON on the client side.  For completeness, we will display it on the page.  I will use Telerik's <a href="http://www.telerik.com/kendo-ui">Kendo UI</a> framework, which makes it easy to display data on a page. <br><br><pre> <code class="javascript hljs">&lt;link href=<span class="hljs-string"><span class="hljs-string">"/SiteAssets/kendo/styles/kendo.common.min.css"</span></span> rel=<span class="hljs-string"><span class="hljs-string">"stylesheet"</span></span> /&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">link</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/SiteAssets/kendo/styles/kendo.default.min.css"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/SiteAssets/kendo/js/kendo.kendo.min.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/SiteAssets/kendo/js/kendo.all.min.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="javascript"><span class="xml"><span class="javascript"> $(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"#grid"</span></span></span></span><span class="xml"><span class="javascript">).kendoGrid({ </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">columns</span></span></span></span><span class="xml"><span class="javascript">: [ { </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">title</span></span></span></span><span class="xml"><span class="javascript">: </span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"First name"</span></span></span></span><span class="xml"><span class="javascript">, </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">field</span></span></span></span><span class="xml"><span class="javascript">: </span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"FirstName"</span></span></span></span><span class="xml"><span class="javascript"> }, { </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">title</span></span></span></span><span class="xml"><span class="javascript">: </span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"Last Name"</span></span></span></span><span class="xml"><span class="javascript">, </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">field</span></span></span></span><span class="xml"><span class="javascript">: </span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"LastName"</span></span></span></span><span class="xml"><span class="javascript"> }, { </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">title</span></span></span></span><span class="xml"><span class="javascript">: </span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"Age"</span></span></span></span><span class="xml"><span class="javascript">, </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">field</span></span></span></span><span class="xml"><span class="javascript">: </span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"Age"</span></span></span></span><span class="xml"><span class="javascript"> } ], </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">dataSource</span></span></span></span><span class="xml"><span class="javascript">: { </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="javascript">: JSONdata, }, </span></span><span class="hljs-attr"><span class="xml"><span class="javascript"><span class="hljs-attr">height</span></span></span></span><span class="xml"><span class="javascript">: </span></span><span class="hljs-number"><span class="xml"><span class="javascript"><span class="hljs-number">600</span></span></span></span><span class="xml"><span class="javascript"> }); </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"grid"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">grid</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  Used Books: <br><br><ul><li>  <a href="http://spservices.codeplex.com/documentation">SPServices Documentation</a> - very detailed documentation on the capabilities of the library. </li><li>  <a href="http://www.nothingbutsharepoint.com/2010/10/04/real-life-example-with-spservices-telephone-list-gadget-aspx/">Real Life Example with SPServices: Telephone List Gadget</a> is a bit outdated, but a working example of use. </li><li>  <a href="http://www.sharepointhillbilly.com/Lists/Posts/Post.aspx%3FID%3D5">A Dummies Guide to SharePoint &amp; jQuery - Reading List Data With SPServices</a> - and another one. </li></ul><br><br>  If you have questions, suggestions or curses, welcome to comments. </div><p>Source: <a href="https://habr.com/ru/post/272549/">https://habr.com/ru/post/272549/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272539/index.html">Laboratory penetration testing "Test lab v.8": the bank is broken</a></li>
<li><a href="../272541/index.html">The mistakes of our youth. Or how a network engineer learns the nature of the console.</a></li>
<li><a href="../272543/index.html">Food court from the inside. Or how the programmer did the foodcourt</a></li>
<li><a href="../272545/index.html">PostgreSQL document-oriented API design: Finding what you are looking for (Part 3)</a></li>
<li><a href="../272547/index.html">Anonymous connect to meterpreter / reverse_tcp via an intermediate server using SSH tunnels</a></li>
<li><a href="../272551/index.html">Announcement Rambler.iOS V - V for VIPER</a></li>
<li><a href="../272553/index.html">Licensing Windows Server 2016</a></li>
<li><a href="../272555/index.html">Next, in search of palindromes 2</a></li>
<li><a href="../272557/index.html">We are again on Habr√©</a></li>
<li><a href="../272559/index.html">Django: How to quickly get unnecessary duplicates in a simple QuerySet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>