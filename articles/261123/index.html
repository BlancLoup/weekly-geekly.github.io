<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Eat filed, sit down, please connect</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, Intel Edison with a set of sensors and actuators will help us do the following: play the song ‚ÄúA grasshopper in the grass‚Äù, determine whether w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Eat filed, sit down, please connect</h1><div class="post__text post__text-html js-mediator-article">  Today, Intel Edison with a set of sensors and actuators will help us do the following: play the song ‚ÄúA grasshopper in the grass‚Äù, determine whether water flows well, whether fire is burning, pump water, check if there is a couple of spirits in the air, dusty room, as the kettle boils, determine your coordinates, find a magnet.  And something else. <br><br><img src="https://habrastorage.org/files/51d/425/c33/51d425c3307e4977866edbed05bcb7e8.jpg"><br><a name="habracut"></a><br>  We will look at the following sensors and actuators, and how to use them with Intel Edison. <br><ul><li>  Grove - Hall Sensor - Hall sensor. </li><li>  Grove - Speaker - speaker. </li><li>  Grove - Flame Sensor - fire sensor. </li><li>  Grove - LED Bar - LED progress indicator. </li><li>  Grove - Encoder - turn sensor. </li><li>  Grove - Gas Sensor (MQ5) - gas sensor. </li><li>  Grove - Air quality sensor - air quality sensor. </li><li>  Grove - Infrared Temperature Sensor - IR temperature meter. </li><li>  G1 / 4 "Water Flow Sensor - water flow sensor. </li><li>  Grove - I2C Motor Driver - motor driver. </li><li>  6V mini water pump - water pump. </li><li>  Grove - Digital Light Sensor - light sensor. </li><li>  Grove - Alcohol Sensor - alcohol sensor. </li><li>  Grove - Dust Sensor - dust sensor. </li><li>  Planet Geared Motor F280 - motor. </li><li>  Grove - GPS - GPS module. </li></ul><br>  Examples of the sensors can be viewed in the video: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/tyvLY57t09c%3Ffeature%3Doembed&amp;xid=17259,15700022,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjHtW7rEKl2QO3dNH8r1EwxN8H5Kg" frameborder="0" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If you have not worked with sensors and Intel Edison before this point, see the <a href="http://habrahabr.ru/company/intel/blog/260259/">previous article</a> . <br>  Before we begin, a small note.  If during the example startup process, you will have an error when working with UPM functions, for example, the following message will appear: <br><pre><code class="bash hljs">Cannot find module <span class="hljs-string"><span class="hljs-string">'jsupm_rotaryencoder'</span></span></code> </pre> <br>  So you need to update the installed packages, including UPM.  This is done very simply with the command: <br><pre> <code class="bash hljs">opkg upgrade</code> </pre> <br>  It is advisable to update the firmware of the board itself. <br><br><h2>  <font color="#0071c5">Hall Sensor</font> </h2><br><img src="https://habrastorage.org/files/b1a/445/909/b1a4459092df4549a26d5adaa776c8c7.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Hall-Sensor-p-965.html">Grove - Hall Sensor</a> .  SKU: SEN14034P <br><br>  Application: Determining the presence of a magnetic field.  Determination of rotational speed. <br>  To determine the rotational speed, for example, the wheel, you can mount the magnet on the wheel and place the sensor near the place where the magnet will pass, while rotating.  Then at the time of their approach there will be a signal. <br><br>  The Hall sensor is connected to any digital input D2-D8.  Gives out 0 - in the presence of a magnetic field, 1 - in its absence.  On the sensor board is an LED that turns on when a magnetic field appears. <br><br>  An example of a program in which the LED on the Intel Edison board lights up when there is no magnetic field.  And in the presence of it turns off. <br>  The sensor is connected to the D2. <br><br>  The program sends to the built-in LED (D13), the value read from the Hall sensor.  We use the library MRAA. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mraa'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hallSensor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Gpio(<span class="hljs-number"><span class="hljs-number">2</span></span>); hallSensor.dir(mraa.DIR_IN); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myOnboardLed = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Gpio(<span class="hljs-number"><span class="hljs-number">13</span></span>); myOnboardLed.dir(mraa.DIR_OUT); periodicActivity(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">periodicActivity</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = hallSensor.read(); myOnboardLed.write(value); setTimeout(periodicActivity,<span class="hljs-number"><span class="hljs-number">20</span></span>); }</code> </pre> </div></div><br><h2>  <font color="#0071c5">Speaker</font> </h2><br><img src="https://habrastorage.org/files/2cc/352/7c6/2cc3527c64224353ab13f629930c5fa6.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Speaker-p-1445.html">Grove - Speaker</a> .  SKU: COM05051P <br><br>  Connects to a digital output.  The signal that is fed to this output is set on the speaker.  Therefore, if you quickly change the signal with a certain frequency, you can play the sound.  The volume can be changed trimmer. <br><br>  The UPM library has functions for working with a speaker. <br><br>  An example of playing one note. <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> groveSpeaker = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jsupm_grovespeaker'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mySpeaker = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> groveSpeaker.GroveSpeaker(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   D2 mySpeaker.playSound('a', true, "med");// </span></span></code> </pre> <br>  Function: <br><pre> <code class="javascript hljs">playSound(<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"med"</span></span>);</code> </pre> <br>  The first parameter, the note 'a', 'b', 'c', 'd', 'e', ‚Äã‚Äã'f', or 'g' (A, B, C, D, M, F, Sal). <br>  The second parameter is whether to use Sharp for this note. <br>  The third parameter, the octave, can be ‚Äúlow‚Äù, ‚Äúmed‚Äù, or ‚Äúhigh‚Äù. <br>  The duration can not be set, but each note sounds about 0.1 seconds. <br><br>  It seems that the sound is played by software, because the speaker can be connected to any digital output.  And because of this, the sound is not very clear, he wheezes. <br><br>  Therefore, it is convenient to use PWM for working with sound, since it allows hardware to generate a signal.  (About working with PWM, you can read in the <a href="http://habrahabr.ru/company/intel/blog/260259/">previous article</a> ). <br><br>  The speaker is connected to the D3, as it supports PWM.  (Contacts that support PWM are indicated on the board with a tilde "~", these are D3, D5, D6). <br><br>  For example, you can play the note A in this way for one second. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"mraa"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pwm3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Pwm(<span class="hljs-number"><span class="hljs-number">3</span></span>); freq = <span class="hljs-number"><span class="hljs-number">440</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   var period = 1000000 / freq; pwm3.period_us(period); pwm3.pulsewidth_us(period/2); pwm3.enable(true); setTimeout( function(){pwm3.enable(false);}, 1000);</span></span></code> </pre> </div></div><br>  Now let's move on to hardcore and manually program the melody ‚ÄúA grasshopper sat in the grass‚Äù, which will sound clean and beautiful. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"mraa"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pwm3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Pwm(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">//       // , -, , -, , , -, , -, , -,  var freq = [261.63, 277.18, 293.66, 311.13, 329.63, 349.23, 369.99, 392.00, 415.30, 440.00, 466.16, 493.88 ]; //     // .  N,V // N-  (-1-),  1/V var notes = [ 9,4, 4,4, 9,4, 4,4, 9,4, 8,4, 8,2, 8,4, 4,4, 8,4, 4,4, 8,4, 9,4, 9,2, 9,4, 4,4, 9,4, 4,4, 9,4, 8,4, 8,2, 8,4, 4,4, 8,4, 4,4, 8,4, 9, 1.33]; var currNote = 0; var baseValue = 1000;//      nextNote(); function nextNote() { pwm3.enable(false); if( currNote &gt;= notes.length / 2 ) { return; } var note = notes[currNote*2]; var value = notes[currNote*2+1]; //  : // 0.25 -   // 0.5 -   // 1 -   // 2 -   // 4 -   // 8 -   // 16 -   var octaveScale = 2;//    ,   console.log('note='+note+' value='+value); if( note &gt;= 0 ) { var frequency = freq[ note ] * octaveScale; var period = 1000000 / frequency; console.log('frequency='+frequency+ ' Hz'); pwm3.period_us(period); pwm3.pulsewidth_us(period/2); pwm3.enable(true); } currNote++; setTimeout( nextNote, baseValue/value); }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">Water flow sensor</font> </h2><br><img src="https://habrastorage.org/files/097/7c4/851/0977c4851ca64cc1b029ac3883d6b48d.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/G14-Water-Flow-Sensor-p-1345.html">G1 / 4 "Water Flow Sensor</a> . SKU: TEM01071B <br><br>  The sensor allows you to determine the amount of water passing through it.  Range from 0.3 to 6 liters per minute.  The arrow on the cover shows the direction of water movement. <br>  Inside the sensor is a Hall sensor, triggered by the rotation of the inner impeller.  The frequency of its operation is proportional to the volume of flowing water.  At the sensor output, signal 0 and 1 changes. We will monitor the value of the signal at the sensor output and take into account its change from 0 to 1. <br>  We calculate the number of pulses per second, that is, the frequency of their movement.  The formula for converting frequency to stream is as follows: <br>  <i>L = Q / 73</i> , <br>  where Q is the pulse frequency (Hz). <br>  L - flow (l / minute) <br><br>  There are some minor problems with connecting the sensor.  It does not have standard connectors.  Installed three-contact, and need four.  But it is easy to decide if you have three wires Male-Male.  They fit well into the connectors. <br><br>  Connect the sensor to D2. <br>  The program works as follows.  Let's make two timers.  The first will trigger once a millisecond and check the status of the sensor.  If the value from 0 has passed to 1, increase the pulse counter. <br>  The second timer will fire once per second.  It reads the value of the counted pulses. <br>  Since we take 1 second for accumulation, the minimum value of the flow will be 1/73 = 0.013 l / min. <br>  It should be noted that the algorithm without interruptions works less accurately, because if the pulses arrive too often, we will not notice them.  On my tests, about 230 pulses per second normally worked, this is about 3 liters per minute.  If you increase the speed, the calculated value starts to decrease.  The value is displayed on the LCD screen.  To connect to the water sensor, I bought a 4 mm diameter hose in the store. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mraa'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jsUpmI2cLcd = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (<span class="hljs-string"><span class="hljs-string">'jsupm_i2clcd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lcd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> jsUpmI2cLcd.Jhd1313m1(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0x3E</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>); lcd.setColor(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> waterFlowSensor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Gpio(<span class="hljs-number"><span class="hljs-number">2</span></span>); waterFlowSensor.dir(mraa.DIR_IN); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> prev = waterFlowSensor.read(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; setInterval( checkSensor, <span class="hljs-number"><span class="hljs-number">1</span></span> ); setInterval( countProc, <span class="hljs-number"><span class="hljs-number">1000</span></span> ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkSensor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curr = waterFlowSensor.read(); <span class="hljs-comment"><span class="hljs-comment">//    1 if( prev === 0 &amp;&amp; curr === 1 ) { count++; } prev = curr; } function countProc() { var litres = count / 73; var currCount = count; count = 0; console.log('count='+currCount+ ' water=' + litres + ' Litres/hour, water=' + (litres/60) + 'L/min'); lcd.setCursor(0,0); lcd.write("Count=" + currCount + ' '); lcd.setCursor(1,0); lcd.write("Flow=" + parseFloat(litres).toFixed(2)+ ' L/min '); }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">Fire sensor</font> </h2><br><img src="https://habrastorage.org/files/b4a/089/acc/b4a089accf704875ab082bf7d6cd62d7.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Flame-Sensor-p-1450.html">Grove - Flame Sensor</a> .  SKU: SEN05082P <br><br>  The sensor responds to the presence of fire, or rather to radiation from a wavelength of 760nm - 1100nm.  It is possible to adjust the sensitivity using a trimmer resistor.  In my test, the sensor did not respond to the green LED placed next to it.  Reacting to a white LED flashlight, only when the center of its beam was directed to the sensor.  When you turn on the gas lighter, the sensor worked at a distance of about 50 centimeters.  At about the same distance, it worked from a lit match.  The sensor is triggered from the remote control.  Most likely, the same photodiode is used as in household appliances.  Reacts to sunlight.  But since the sensitivity is adjustable, it can be adjusted so that there are no false positives. <br>  The manual says that the distance of operation is 0-1 m. <br><br>  An example in which the sensor is connected to D2 and its value is shown on the on-board LED. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mraa'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> flameSensor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Gpio(<span class="hljs-number"><span class="hljs-number">2</span></span>); flameSensor.dir(mraa.DIR_IN); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myOnboardLed = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Gpio(<span class="hljs-number"><span class="hljs-number">13</span></span>); myOnboardLed.dir(mraa.DIR_OUT); periodicActivity(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">periodicActivity</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = flameSensor.read(); myOnboardLed.write(<span class="hljs-number"><span class="hljs-number">1</span></span>-value); setTimeout(periodicActivity,<span class="hljs-number"><span class="hljs-number">20</span></span>); }</code> </pre> </div></div><br><h2>  <font color="#0071c5">Non-contact IR temperature sensor</font> </h2><br><img src="https://habrastorage.org/files/953/1a3/615/9531a3615c704274b7d0b376e1785c0e.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Infrared-Temperature-Sensor-p-1058.html">Grove - Infrared Temperature Sensor</a> .  SKU: SEN01041P <br><br>  Non-contact infrared temperature sensor.  The working distance is 9 cm. It is recommended to select the distance experimentally, adjusting by melting and boiling water. <br>  Must use UPM.  The sensor produces two temperatures.  One environment, another measured object.  Inside the sensor is used TP-538U. <br><br>  Sample program.  The sensor is connected to A0 (pins A0 and A1 will be used).  Data is displayed on the console and LCD screen. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> OTP538U_AREF = <span class="hljs-number"><span class="hljs-number">5.0</span></span>;<span class="hljs-comment"><span class="hljs-comment">//   var tempIRSensor_lib = require('jsupm_otp538u'); // - var jsUpmI2cLcd = require ('jsupm_i2clcd'); var lcd = new jsUpmI2cLcd.Jhd1313m1(0, 0x3E, 0x62); //   A0 (  A0  A1) // A0 -   // A1 -   var tempIRSensor_obj = new tempIRSensor_lib.OTP538U(0, 1, OTP538U_AREF); function checkTemp() { var tempAmb = tempIRSensor_obj.ambientTemperature(); var tempObj = tempIRSensor_obj.objectTemperature(); var tempAmbStr = parseFloat(tempAmb).toFixed(2); var tempObjStr = parseFloat(tempObj).toFixed(2); var outputStr = "Ambient temp: " + tempAmbStr + " C, " +"Object temp: " + tempObjStr + " C"; lcd.setCursor(0,0); lcd.write('amb='+tempAmbStr+' '); lcd.setCursor(1,0); lcd.write('obj='+tempObjStr+' '); console.log(outputStr); } setInterval(checkTemp, 1000);</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">UV light sensor</font> </h2><br><img src="https://habrastorage.org/files/b5f/a91/121/b5fa91121018496792eb126dba1f4b2e.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-UV-Sensor-p-1540.html">Grove - UV Sensor</a> .  SKU: SEN00700P <br><br>  The sensor is connected to the analog input.  You can simply read the value, or you can use the UPM to convert to voltage.  At the same time, the library itself averages the value by performing a series of measurements.  Because of this, receiving data from the sensor can slow down. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> UVSensor = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jsupm_guvas12d'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   A0 var myUVSensor = new UVSensor.GUVAS12D(0); var g_GUVAS12D_AREF = 5.0;//  var g_SAMPLES_PER_QUERY = 1024; setInterval(function() { var val = myUVSensor.value(g_GUVAS12D_AREF, g_SAMPLES_PER_QUERY); var valStr = parseFloat(val).toFixed(6); var outputStr = "AREF: " + g_GUVAS12D_AREF + ", Voltage value (higher means more UV): " + valStr; console.log(outputStr); }, 1000);</span></span></code> </pre> </div></div><br>  In a room with good solar diffused lighting, but with the windows closed, the value is 0.283203.  If you bring it to the window on the direct rays from the sun, but behind a triple glazed window, the value rises to 0.473633.  If you open the window, you get a maximum of 4.980469 <br><br><h2>  <font color="#0071c5">Progress Bar</font> </h2><br><img src="https://habrastorage.org/files/90d/ab7/64e/90dab764e3804e0e99d6f50f57e7e9da.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-LED-Bar-p-1178.html">Grove - LED Bar</a> .  SKU: LED05031P <br><br>  The progress bar consists of 10 LEDs.  All of them are green except for two extreme ones, yellow and red.  For work it is better to use the UPM library.  It allows you to specify the side where the initial value and the number of indicators to be lit will be.  Both conductors (data and clock pulses) are used for control.  When connected to D2, it will be pin-2 and pin-3. <br><br>  In the following example, the value of the indicator increases sequentially, changing the direction each time. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> LEDBar = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"jsupm_my9221"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myLEDBar = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LEDBar.MY9221(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>);<span class="hljs-comment"><span class="hljs-comment">//  D2 (pin-D2,pin-D3) var directionBool = true; setInterval(function() { show_LED(1, directionBool); }, 1500 ); function show_LED(level, direction) { if (level &lt;= 10) { myLEDBar.setBarLevel(level, directionBool); setTimeout(show_LED, 50, ++level, directionBool); } else { directionBool = !directionBool; } }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">360 degree rotation sensor.</font>  <font color="#0071c5">Encoder</font> </h2><br><img src="https://habrastorage.org/files/af0/b93/248/af0b93248e3b41f48d1c449ca9045ef2.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Encoder-p-1352.html">Grove - Encoder</a> .  SKU: COM01112P <br><br>  Encoder, turn sensor.  It can turn a full turn in any direction. <br>  For work, it is desirable to use the UPM library.  When turning the value will increase, when turning in the other direction, decrease.  The value may become less than zero.  Two control signals are used. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rotaryEncoder = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"jsupm_rotaryencoder"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   D2 ( D2, D3) var myRotaryEncoder = new rotaryEncoder.RotaryEncoder(2, 3); getValue(); function getValue() { var v = myRotaryEncoder.position(); console.log("Position: " + v); setTimeout(getValue,100); }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">I2C Lighting Sensor</font> </h2><br><img src="https://habrastorage.org/files/819/b96/b6a/819b96b6a3f14104a5d0c2f5a434d99f.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Digital-Light-Sensor-p-1281.html">Grove - Digital Light Sensor</a> .  SKU: SEN10171P <br><br>  Light sensor.  It connects to the I2C bus.  Displays the value in suites.  According to the documentation, the values ‚Äã‚Äãare in the range of 0-40000. <br><br>  On tests, it turned out that in a bright room, the value is about 500. In the sun, through a window with blinds, it reaches 20000-40000.  If you take out the direct sun, it rolls over and the value drops to 4000. We must bear this in mind. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> digitalLightSensor = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jsupm_tsl2561'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  TSL2561 on I2C var myDigitalLightSensor = new digitalLightSensor.TSL2561(); setInterval(function() { console.log("Light value is " + myDigitalLightSensor.getLux() + ' Lux'); }, 1000);</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">MQ5 gas sensor</font> </h2><br><img src="https://habrastorage.org/files/82b/84a/fe8/82b84afe872e4129bc67cccf9b3505e0.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/grove-gas-sensormq5-p-938.html">Grove - Gas Sensor (MQ5)</a> .  SKU: SEN90502P <br><br>  Gas sensor.  Reacts to liquid solvents, natural gas.  Sensitivity can be adjusted with a potentiometer. <br><br>  Gives an analog value.  You can simply take it, but you can use the UPM library.  The library calculates the average value by performing a series of measurements, but because of this, the function call suspends the program. <br><br>  The special feature of the sensor is that it significantly heats up during operation.  This is a feature of most such detectors.  Before starting, the sensor should warm up.  The manual says that the best preheating time is 24 hours, although this is somehow strange. <br><br>  In the following example, we connect the sensor to A0 and use UPM. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> upmMQ5 = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"jsupm_gas"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   A0 var myMQ5 = new upmMQ5.MQ5(0); var threshContext = new upmMQ5.thresholdContext; threshContext.averageReading = 0; threshContext.runningAverage = 0; threshContext.averagedOver = 2; while(1) { var buffer = new upmMQ5.uint16Array(128); var len = myMQ5.getSampledWindow(2, 128, buffer); if (len) { var thresh = myMQ5.findThreshold(threshContext, 30, buffer, len); myMQ5.printGraph(threshContext, 5); } }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">Dust sensor</font> </h2><br><img src="https://habrastorage.org/files/405/9c4/7bc/4059c47bcab942bab232ef2f2366b2c4.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Dust-Sensor-p-1050.html">Grove - Dust Sensor</a> .  SKU: SEN12291P <br><br>  Dust sensor.  It produces pulses depending on the dustiness of the air.  Reacts to dust particles of 1 micron and larger.  It is advisable to use the UPM library. <br><br>  The feature that the getData function receives data within 30 seconds. <br><br>  Here is an example of his work.  This is a normal condition: <br><br><pre> <code class="bash hljs">Low pulse occupancy: 1829533 Ratio: 6.0984462 Concentration: 3279.9744018259016</code> </pre> <br>  And I shook it next to the sensor with a dusty rag: <br><br><pre> <code class="bash hljs">Low pulse occupancy: 5541164 Ratio: 18.470549560000002 Concentration: 15240.471566321306</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dustSensor = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jsupm_ppd42ns'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   D2 var myDustSensor = new dustSensor.PPD42NS(2); var data; var notice = "This program will give readings "; notice += "every 30 seconds until you stop it" console.log(notice); while(1) { data = myDustSensor.getData(); console.log("Low pulse occupancy: " + data.lowPulseOccupancy); console.log("Ratio: " + data.ratio); console.log("Concentration: " + data.concentration); }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">Air quality sensor</font> </h2><br><img src="https://habrastorage.org/files/f78/c23/ef9/f78c23ef9d354b0abe25005f17422b1d.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Air-quality-sensor-p-1065.html">Grove - Air quality sensor</a> .  SKU: SEN01111P <br><br>  Air quality sensor.  Designed for indoor use.  Reacts to carbon monoxide, hydrogen, alcohol, acetone, solvents, formaldehyde and other toxic gases. <br>  I checked his work with alcohol and gas from a lighter.  He defined them. <br>  Connects to analog input.  In the example for A0.  Just read the value. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mraa'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gas = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mraa.Aio(<span class="hljs-number"><span class="hljs-number">0</span></span>); getGas(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGas</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> g = gas.read(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(gas=<span class="hljs-string"><span class="hljs-string">'+g); setTimeout(getGas,500); }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">Alcohol sensor</font> </h2><br><img src="https://habrastorage.org/files/fea/231/bfc/fea231bfc79e4990940121de3b7129f5.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-Alcohol-Sensor-p-764.html">Grove - Alcohol Sensor</a> .  SKU: SEN21723P <br><br>  Alcohol sensor.  Gives value to analog pin.  But he also needs a digital pin to heat the sensor itself.  If we use the usual shield for the sensors, then on connector A0 there will be pins A0 and A1.  Pin A1 is actually a digital pin D15. <br>  Before starting the sensor, it is desirable to warm up for 2 minutes. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   MQ303A var mq303a = require('jsupm_mq303a'); //  mq303a // A0 ‚Äì  // A1,   D15   var myAlcoholObj = new mq303a.MQ303A(0, 15); console.log("Enabling heater and waiting 2 minutes for warmup."); //     30  statusMessage(1); statusMessage(2); statusMessage(3); function statusMessage(amt) { setTimeout(function() { console.log((amt * 30) + " seconds have passed"); }, 30000 * amt); } //     2  setTimeout(runAlcoholSensor, 120000); function runAlcoholSensor() { var notice = "This sensor may need to warm " + "until the value drops below about 450." console.log(notice); setInterval(function() { var val = myAlcoholObj.value(); var msg = "Alcohol detected "; msg += "(higher means stronger alcohol): "; console.log(msg + val); }, 1000); }</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">GPS module</font> </h2><br><img src="https://habrastorage.org/files/be8/f51/679/be8f51679d2f4457be5d3b2452edff99.JPG"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-GPS-p-959.html">Grove - GPS</a> .  SKU: SEN10752P <br><br>  Module for receiving data from GPS.  This module provides data on the serial port.  Therefore, we connect it to a connector that can work as a serial port.  This is a connector labeled UART. <br><br>  Data is transmitted in text form in NMEA 0183 format. A description of the fields can be found <a href="http://www.gpsinformation.org/dale/nmea.htm">here</a> . <br><br>  Here is a sample output from the module: <br><br><pre> <code class="javascript hljs">$GPGGA,<span class="hljs-number"><span class="hljs-number">183227.000</span></span>,<span class="hljs-number"><span class="hljs-number">5619.7971</span></span>,N,<span class="hljs-number"><span class="hljs-number">04400.5751</span></span>,E,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">3.28</span></span>,<span class="hljs-number"><span class="hljs-number">36.7</span></span>,M,<span class="hljs-number"><span class="hljs-number">9.4</span></span>,M,<span class="hljs-number"><span class="hljs-number">0000</span></span>,<span class="hljs-number"><span class="hljs-number">0000</span></span>*<span class="hljs-number"><span class="hljs-number">59</span></span> $GPGSA,A,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>,,,,,,,,,<span class="hljs-number"><span class="hljs-number">3.43</span></span>,<span class="hljs-number"><span class="hljs-number">3.28</span></span>,<span class="hljs-number"><span class="hljs-number">0.99</span></span>*<span class="hljs-number"><span class="hljs-number">05</span></span> $GPGSV,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">73</span></span>,<span class="hljs-number"><span class="hljs-number">111</span></span>,,<span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">61</span></span>,<span class="hljs-number"><span class="hljs-number">264</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>,<span class="hljs-number"><span class="hljs-number">56</span></span>,<span class="hljs-number"><span class="hljs-number">212</span></span>,<span class="hljs-number"><span class="hljs-number">26</span></span>,<span class="hljs-number"><span class="hljs-number">21</span></span>,<span class="hljs-number"><span class="hljs-number">41</span></span>,<span class="hljs-number"><span class="hljs-number">107</span></span>,*<span class="hljs-number"><span class="hljs-number">70</span></span> $GPGSV,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">302</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">054</span></span>,,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">234</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">062</span></span>,*<span class="hljs-number"><span class="hljs-number">78</span></span> $GPGSV,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">026</span></span>,,<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">06</span></span>,<span class="hljs-number"><span class="hljs-number">169</span></span>,,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">03</span></span>,<span class="hljs-number"><span class="hljs-number">340</span></span>,,<span class="hljs-number"><span class="hljs-number">04</span></span>,<span class="hljs-number"><span class="hljs-number">03</span></span>,<span class="hljs-number"><span class="hljs-number">281</span></span>,*<span class="hljs-number"><span class="hljs-number">7</span></span>A $GPRMC,<span class="hljs-number"><span class="hljs-number">183227.000</span></span>,A,<span class="hljs-number"><span class="hljs-number">5619.7971</span></span>,N,<span class="hljs-number"><span class="hljs-number">04400.5751</span></span>,E,<span class="hljs-number"><span class="hljs-number">0.00</span></span>,<span class="hljs-number"><span class="hljs-number">87.99</span></span>,<span class="hljs-number"><span class="hljs-number">230615</span></span>,,,D*<span class="hljs-number"><span class="hljs-number">53</span></span></code> </pre> <br>  We are interested in the last line with $ GPRMC <br>  183227 - time 18:32:27 in UTC. <br>  5619.7971, N - latitude <br>  04400.5751, E - longitude <br><br>  This data can be used, for example, in yandex maps, indicating them in the search bar in the following format: <br><pre> <code class="bash hljs">N56 19.7971 E44 00.5751</code> </pre> <br>  If the satellites are not detected, the output will be something like this: <br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$GPGGA</span></span>,235958.800,,,,,0,0,,,M,,M,,*40 <span class="hljs-variable"><span class="hljs-variable">$GPGSA</span></span>,A,1,,,,,,,,,,,,,,,*1E <span class="hljs-variable"><span class="hljs-variable">$GPGSV</span></span>,1,1,00*79 <span class="hljs-variable"><span class="hljs-variable">$GPRMC</span></span>,235958.800,V,,,,,0.00,0.00,050180,,,N*49</code> </pre> <br>  This program uses the serialport library to work, so it must be specified in dependencies in the package.json file: <br><br><div class="spoiler">  <b class="spoiler_title">Source package.json</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"OnboardLEDBlink"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"main.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"engines"</span></span>: { <span class="hljs-string"><span class="hljs-string">"node"</span></span>: <span class="hljs-string"><span class="hljs-string">"&gt;=0.10.0"</span></span> }, <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"serialport"</span></span> : <span class="hljs-string"><span class="hljs-string">"1.7.4"</span></span> } }</code> </pre> </div></div><br>  The following example simply displays to the console the data received from the GPS module. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mraa'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//require mraa var uartdev = new mraa.Uart(0); var com = require('serialport'); //    UART var portName = uartdev.getDevicePath();// '/dev/ttyMFD1'; var serialPort = new com.SerialPort(portName, { baudrate: 9600, dataBits: 8, parity: 'none', stopBits: 1, flowControl: false }); serialPort.on('open',function(){ console.log('Port open'); serialPort.write('\n'); }); serialPort.on('data', function(data){ console.log(data.toString()); console.log('---'); }); serialPort.on('close', function() { console.log('close'); }); serialPort.on('close', function(error) { console.log('error='+error); });</span></span></code> </pre> </div></div><br>  The following example is more complicated, since it analyzes the data received in order to extract geographic coordinates from them and display them on an LCD screen. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jsUpmI2cLcd = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (<span class="hljs-string"><span class="hljs-string">'jsupm_i2clcd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lcd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> jsUpmI2cLcd.Jhd1313m1(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0x3E</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>); lcd.setColor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mraa = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mraa'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//require mraa var uartdev = new mraa.Uart(0); var com = require('serialport'); var portName = uartdev.getDevicePath();// '/dev/ttyMFD1'; var serialPort = new com.SerialPort(portName, { baudrate: 9600, // default for serial communication dataBits: 8, parity: 'none', stopBits: 1, flowControl: false, parser: com.parsers.readline('\r\n') }); serialPort.on('open',function() { console.log('Port open'); serialPort.write('\n'); }); serialPort.on('data', function(data) { console.log(data.toString()); console.log('---'); var str = data.toString(); var vals = str.split(','); if( vals[0] === '$GPRMC' ) { var tm = vals[1].split('.')[0]; var lat = parseFloat(parseFloat(vals[3])).toFixed(1); var latS = vals[4]; var lon = parseFloat(parseFloat(vals[5])).toFixed(1); var lonS = vals[6]; //var time= Math.floor(tm); var time = [tm.substring(0,2), tm.substring(2,4), tm.substring(4,6)].join(':'); var str1 = 'time='+time; var str21 = latS+lat.substr(0,2) +' ' + lat.substr(2); var str22 = lonS+lon.substr(0,2) +' ' + lon.substr(2); var str2 = str21 + ' ' + str22; lcd.setCursor(0,0); lcd.write(str1); lcd.setCursor(1,0); lcd.write(str2); console.log('time=' + time + ' lat=' + lat + latS + ' lon=' + lon + lonS); console.log(str1); console.log(str2); } }); serialPort.on('close', function() { console.log('close'); }); serialPort.on('close', function(error) { console.log('error='+error); });</span></span></code> </pre> </div></div><br><h2>  <font color="#0071c5">Motor driver</font> </h2><br><img src="https://habrastorage.org/files/930/31e/651/93031e65164d48eab1a2fb46d04b97fc.jpg"><br><br>  <a href="http://www.seeedstudio.com/depot/Grove-I2C-Motor-Driver-p-907.html">Grove - I2C Motor Driver</a> .  SKU: ROB72212P <br><br>  The motor driver allows you to connect either two conventional motors or one four-wire two-phase stepper motor.  Management is done on the I2C bus.  The current can be up to 2A per channel.  With such a high current, the chips can heat up.  There is a button on the board that allows you to stop the engines. <br>  There are switches on the board that set the address of the I2C device on the bus.  By default, it is set to 1111, which is 15. <br>  The board has a power connector.  The motors are powered from a separate power source.  Therefore, these can be motors for voltages other than 5 V. In our examples, we will apply voltage to it from the Intel Edison board itself, it's easier. <br><br><img src="https://habrastorage.org/files/930/31e/651/93031e65164d48eab1a2fb46d04b97fc.jpg"><br><br>  When working with the UPM library, the parameters for the engines are set immediately by a pair. <br>  First you need to set the direction for each engine. <br><br><pre> <code class="javascript hljs">my_MotorDriver_obj1.setMotorDirections( groveMotorDriver_lib.GroveMD.DIR_CCW, groveMotorDriver_lib.GroveMD.DIR_CW);</code> </pre> <br>  After this command, the first engine will rotate counterclockwise, and the second clockwise. <br><br>  Then you can set the rotation speed 0-255.  With a value of 255, full voltage will be applied to the motor. <br><br><pre> <code class="javascript hljs">my_MotorDriver_obj1.setMotorSpeeds(<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">127</span></span>);</code> </pre> <br>  The first engine will rotate at full speed, the second one at half speed. <br><br>  In the following example, turn on the second motor counterclockwise at half voltage. <br><br><div class="spoiler">  <b class="spoiler_title">Source code main.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> groveMotorDriver_lib = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jsupm_grovemd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i2c_addr1 = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> my_MotorDriver_obj1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> groveMotorDriver_lib.GroveMD( groveMotorDriver_lib.GROVEMD_I2C_BUS, i2c_addr1 ); my_MotorDriver_obj1.setMotorDirections( groveMotorDriver_lib.GroveMD.DIR_CCW, groveMotorDriver_lib.GroveMD.DIR_CCW); my_MotorDriver_obj1.setMotorSpeeds(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">127</span></span>);</code> </pre> </div></div><br><h2> <font color="#0071c5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Engine</font></font></font> </h2><br><img src="https://habrastorage.org/files/c9f/866/ed9/c9f866ed9e594dbfa56f673b824588ed.JPG"><br><br> <a href="http://www.seeedstudio.com/depot/Planet-Geared-Motor-F280-p-2018.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Planet Geared Motor F280</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">SKU: 316070006 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Engine with integrated gear. </font><font style="vertical-align: inherit;">Working voltage is 3-24 V. Frequency of rotation is 80-800 rpm. </font><font style="vertical-align: inherit;">We will supply 5V to it, since we do not use an external power source. </font><font style="vertical-align: inherit;">When operating from the motor driver and set to 255, its rotational speed is about 120 rpm. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The motor does not have a connector for connection, only contacts, so you need to solder the wires. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The following example uses a rotation sensor (encoder) to control the speed and direction of rotation of the engine. </font><font style="vertical-align: inherit;">The LCD screen displays the value supplied to the motor. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The rotation sensor is connected to the D4. </font><font style="vertical-align: inherit;">LCD screen to I2C. </font><font style="vertical-align: inherit;">Motor driver for I2C.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code main.js</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> groveMotorDriver_lib = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jsupm_grovemd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rotaryEncoder = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"jsupm_rotaryencoder"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myRotaryEncoder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> rotaryEncoder.RotaryEncoder(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jsUpmI2cLcd = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (<span class="hljs-string"><span class="hljs-string">'jsupm_i2clcd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lcd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> jsUpmI2cLcd.Jhd1313m1(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0x3E</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>); lcd.setColor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i2c_addr1 = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> my_MotorDriver_obj1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> groveMotorDriver_lib.GroveMD( groveMotorDriver_lib.GROVEMD_I2C_BUS, i2c_addr1 ); my_MotorDriver_obj1.setMotorDirections( groveMotorDriver_lib.GroveMD.DIR_CCW, groveMotorDriver_lib.GroveMD.DIR_CCW); my_MotorDriver_obj1.setMotorSpeeds(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); checkButton(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkButton</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> v = myRotaryEncoder.position(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> speed = v*<span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( speed &lt; <span class="hljs-number"><span class="hljs-number">-255</span></span> ) { speed = <span class="hljs-number"><span class="hljs-number">-255</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( speed &gt; <span class="hljs-number"><span class="hljs-number">255</span></span>) { speed = <span class="hljs-number"><span class="hljs-number">255</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dir; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( speed &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { dir = groveMotorDriver_lib.GroveMD.DIR_CCW; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { speed = -speed; dir = groveMotorDriver_lib.GroveMD.DIR_CW; } my_MotorDriver_obj1.setMotorDirections( <span class="hljs-number"><span class="hljs-number">0</span></span>, dir); my_MotorDriver_obj1.setMotorSpeeds(<span class="hljs-number"><span class="hljs-number">0</span></span>, speed); lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.write(<span class="hljs-string"><span class="hljs-string">'v='</span></span>+v+<span class="hljs-string"><span class="hljs-string">' '</span></span>); lcd.setCursor(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.write(<span class="hljs-string"><span class="hljs-string">'speed='</span></span>+speed+<span class="hljs-string"><span class="hljs-string">' '</span></span>); setTimeout(checkButton,<span class="hljs-number"><span class="hljs-number">100</span></span>); }</code> </pre> </div></div><br><h2> <font color="#0071c5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mini pump</font></font></font> </h2><br><img src="https://habrastorage.org/files/f19/28e/728/f1928e7282fb4009a6269ebd6f6af325.JPG"><br><br> <a href="http://www.seeedstudio.com/depot/6V-Mini-Water-Pump-p-1945.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6V mini water pump</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . SKU: 114990073 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Water pump. Contains a motor that can be controlled through a motor driver. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To connect the water, you can use 4 mm tube. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The motor does not have a connector for connection, only contacts, so you need to solder the wires. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The supply voltage is 6 V, so you can use the voltage of 5 V from the board. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is not recommended to turn on the pump without water, as the plastic petals inside can deteriorate. When you connect the power must observe polarity. Positive contact is marked with a red dot. With this connection, water is taken through the bottom hole, and out through the side. Whether it is possible to include in the opposite direction, the documentation does not say.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The following example is similar to the previous one with a motor. </font><font style="vertical-align: inherit;">It also uses a rotation sensor and an LCD screen. </font><font style="vertical-align: inherit;">The difference is that the engine does not change the direction of rotation.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code main.js</font></font></b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> groveMotorDriver_lib = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jsupm_grovemd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rotaryEncoder = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"jsupm_rotaryencoder"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myRotaryEncoder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> rotaryEncoder.RotaryEncoder(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jsUpmI2cLcd = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span> (<span class="hljs-string"><span class="hljs-string">'jsupm_i2clcd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lcd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> jsUpmI2cLcd.Jhd1313m1(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0x3E</span></span>, <span class="hljs-number"><span class="hljs-number">0x62</span></span>); lcd.setColor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i2c_addr1 = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> my_MotorDriver_obj1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> groveMotorDriver_lib.GroveMD( groveMotorDriver_lib.GROVEMD_I2C_BUS, i2c_addr1 ); my_MotorDriver_obj1.setMotorDirections( groveMotorDriver_lib.GroveMD.DIR_CCW, groveMotorDriver_lib.GroveMD.DIR_CCW); checkButton(); <span class="hljs-comment"><span class="hljs-comment">// 255 - 2    //my_MotorDriver_obj1.setMotorSpeeds(0, 127); //set the speeds of the motors on board 1 function checkButton() { var v = 10 * myRotaryEncoder.position(); if( v &lt; 0 ) { v = 0; } if( v &gt; 255) { v = 255; } my_MotorDriver_obj1.setMotorSpeeds(0, v); lcd.setCursor(0,0); lcd.write('Speed='+v+' '); setTimeout(checkButton,100); }</span></span></code> </pre> </div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here you have the sensors, as they say, for all occasions. </font><font style="vertical-align: inherit;">Experiment on health!</font></font></div><p>Source: <a href="https://habr.com/ru/post/261123/">https://habr.com/ru/post/261123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261111/index.html">A simple algorithm for finding all matching sub-texts in two texts</a></li>
<li><a href="../261113/index.html">K-Meleon 75: Reached the final</a></li>
<li><a href="../261115/index.html">Porting OpenWRT to a new device on the example of ASUS DSL N12U</a></li>
<li><a href="../261117/index.html">The electronic teacher for blind on Arduino</a></li>
<li><a href="../261119/index.html">Western bestsellers in our book market. Career IT Project Manager</a></li>
<li><a href="../261127/index.html">Delete phantom server entries from SCVMM</a></li>
<li><a href="../261131/index.html">Internal representation of values ‚Äã‚Äãin PHP 7 (part 2)</a></li>
<li><a href="../261133/index.html">Vulnerability iOS and OS X, the success of Bethesda, a reward from Google - and other news of the week for a mobile developer</a></li>
<li><a href="../261137/index.html">Fast filter catalog for online stores based on Redis bitmaps</a></li>
<li><a href="../261139/index.html">How we developed our DNS manager</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>