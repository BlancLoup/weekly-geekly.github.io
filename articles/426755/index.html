<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The developers of Windows 10 have implemented protection against ransomware viruses. It can be circumvented by injection DLL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Windows 10, a ransomware protection mechanism called Controlled Folder Access appeared. It prevents files from changing in the specified protected ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The developers of Windows 10 have implemented protection against ransomware viruses. It can be circumvented by injection DLL</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/company/pt/blog/426755/"><img src="https://habrastorage.org/getpro/habr/post_images/03a/3ab/c63/03a3abc63848136459f2b8403a3f6a29.jpg" alt="image"></a> <br><br>  In Windows 10, a ransomware protection mechanism called Controlled Folder Access appeared.  It prevents files from changing in the specified protected folders by unknown programs.  Information Security Researcher from Fujitsu System Integration Laboratories Ltd.  <a href="https://www.bleepingcomputer.com/news/security/windows-10-ransomware-protection-bypassed-using-dll-injection/">discovered a</a> way to bypass this protection via dll injection. <a name="habracut"></a><br><br><h2>  What is the problem </h2><br>  Soya Aoyama managed to inject a malicious DLL into the Windows Explorer ‚Äî and explorer.exe is in the trusted list of Controlled Folder Access programs.  To realize his intention, the researcher used the fact that when launching explorer.exe loads the DLLs found in the registry key HKEY_CLASSES_ROOT \ * \ shellex \ ContextMenuHandlers: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/26f/dab/770/26fdab7703ebb7fa72c2315d27006735.jpg" alt="image"><br><br>  The HKEY_CLASSES_ROOT tree is the "merge" of the register information found in HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER.  When implementing this "merge", Windows assigns information from HKCU priority.  This means that if a key exists in HKCU, then it will take precedence over the same key in HKLM, and this data will flow into the HKEY_CLASSES_ROOT tree. <br><br>  When starting explorer.exe, Shell32.dll is loaded by default, which is located in the HKEY_LOCAL_MACHINE \ SOFTWARE \ Classes \ CLSID \ {90AA3A4E-1CBA-4233-B8BB-535773D48449} \ InProcServer32 key.  To load the malicious DLL into Explorer, Aoyama simply created the HKCU \ Software \ Classes \ CLSID \ {90AA3A4E-1CBA-4233-B8BB-535773D48449} \ InProcServer32 key and set the necessary library for it. <br><br>  After that, after completing and restarting the explorer.exe process, instead of the Shell32.dll, the program started the DLL created by the hacker. <br><br>  Aoyama shared the results of the study at the DerbyCon conference: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YXNj7KNkVSY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  How to protect </h2><br>  The researcher also found out that many antiviruses, including Windows Defender, Avast, ESET, Malwarebytes Premium and McAfee, do not recognize the attack scheme found by him. <br><br>  At the same time, according to Aoyama, Microsoft representatives do not believe that he discovered a vulnerability.  The researcher sent information about his findings to the company, but there he was told that he was not entitled to any rewards, and they would not release a patch, because an attacker needs access to the victim‚Äôs computer and does not exceed access rights. <br><br>  However, in combination with other vulnerabilities, the attack vector found by Aoyama may be interesting for attackers.  Basically, the infrastructure of large companies is built on Windows.  Knowing this, the attackers are developing special tools for attacks under this operating system. <br><br><blockquote>  Tomorrow, <b>October 18 at 2:00 pm</b> , experts from PT Expert Security Center will disassemble the three hacking tools that allow you to quickly develop an attack in the Windows infrastructure: impacket, CrackMapExec and Koadic.  Students will learn how they work, what activity they create in network traffic, and most importantly, how to detect their use in time.  The webinar will be of interest to employees of the SOC, blue teams and IT departments. <br><br>  To participate you must <a href="https://www.ptsecurity.com/ru-ru/research/webinar/295012/">register</a> . </blockquote></div><p>Source: <a href="https://habr.com/ru/post/426755/">https://habr.com/ru/post/426755/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426743/index.html">Ways to use the blockchain turned somewhere not there. Sony announced the creation of a DRM-system based on the chain of blocks</a></li>
<li><a href="../426745/index.html">PostgreSQL 11 released</a></li>
<li><a href="../426747/index.html">In 2018, the KDE project developers received more than $ 0.5 million in donations. And not only they ...</a></li>
<li><a href="../426749/index.html">Moving to London with his wife and dogs. Mobile Developer History</a></li>
<li><a href="../426753/index.html">Mail Design Cup 2018 - Competition for interface designers</a></li>
<li><a href="../426759/index.html">The image of a modern tester. What you need to know and be able to</a></li>
<li><a href="../426765/index.html">Basics of programming on the SAS Base. Lesson 4: Creating SAS datasets</a></li>
<li><a href="../426769/index.html">The book "Minecraft. Program your world in Python. 2nd international edition ¬ª</a></li>
<li><a href="../426771/index.html">Making a machine learning project in Python. Part 3</a></li>
<li><a href="../426773/index.html">Tips for professional use RecyclerView. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>