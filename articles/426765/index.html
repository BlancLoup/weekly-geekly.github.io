<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Basics of programming on the SAS Base. Lesson 4: Creating SAS datasets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article, we explored how to read external raw data. And today we will get acquainted with the SET operator, which reads standard SAS d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Basics of programming on the SAS Base. Lesson 4: Creating SAS datasets</h1><div class="post__text post__text-html js-mediator-article">  In the previous <a href="https://habr.com/company/sas/blog/354284/">article,</a> we explored how to read external raw data.  And today we will get acquainted with the SET operator, which reads standard SAS data sets (SAS Data Set), learn how to create data slices, set up permanent attributes, and also learn some useful SAS functions.  Again, I will try to present the material as simple as possible, using as many examples as possible. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mh/41/za/mh41zamhljv6eb9q3esmouqgqmy.jpeg"></div><br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/z5/gp/dc/z5gpdcquyr1srkiskv378g39vpa.png"></div>  Suppose data is stored in EXCEL format in the <i>C: \ workshop \ habrahabr</i> directory.  We import the spreadsheet, create a slice from it, create new calculated columns using SAS functions, and then divide this data set into two. <br><br><h2>  Importing a spreadsheet and setting a filter </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vc/h1/ea/vch1eafptkkhr1zdxbg1rejuhvy.jpeg"></div><br>  The excel file is stored in the above directory and looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      File fragment: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dp/yu/ta/dpyutaqneikteedo3fw-kz_w7dk.png"></div><br>  Apply the <a href="https://go.documentation.sas.com/%3FdocsetId%3Dproc%26docsetTarget%3Dn1qn5sclnu2l9dn1w61ifw8wqhts.htm%26docsetVersion%3D9.4%26locale%3Dru">PROC IMPORT</a> procedure to convert a spreadsheet to a SAS dataset: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">options</span></span> validvarname=v7; proc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datafile="C:\workshop\habrahabr\company.xlsx" dbms=xlsx <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>=company replace; getnames=yes; run;</code> </pre> <br>  The option <b>validvarname = V7</b> sets the ‚Äúcorrect‚Äù field names from the SAS point of view: replacing all invalid characters with underscores.  You can read about variable naming rules in <a href="https://habr.com/company/sas/blog/348168/">Lesson 1.</a> <br><br>  Let's set the filter immediately when reading an external file, for example, select only those observations in which the end date of the work is not missed.  Notice the syntax of the where parameter. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">options</span></span> validvarname=v7; proc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datafile="C:\workshop\habrahabr\company.xlsx" dbms=xlsx <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>=company (<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>=(End_Date <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> missing)) replace; getnames=yes; run;</code> </pre><br>  Consider in detail the operators of the step PROC IMPORT: <br><br>  <b>Datafile</b> - defines the full path and name of the external file <br>  <b>Dbms</b> - defines the type of data to import. <br>  <b>Out</b> ‚Äî Identifies the output SAS dataset with a single or two-level SAS name (library name and dataset name). <br>  <b>Replace</b> - overwrites an existing SAS dataset. <br>  <b>Getnames</b> - Indicates whether PROC IMPORT generates SAS variable names from the data values ‚Äã‚Äãin the first line in the input external file. <br><br>  Run the PROC IMPORT step and examine the LOG: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ie/jx/f3/iejxf3zmynbwn2enbnmsejxpehs.jpeg"></div><br>  Print the resulting SAS dataset: <br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> data=work.company noobs; run;</code> </pre> <br>  The output of the PROC PRINT procedure is shown below: <br><br>  Fragment: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/48/_q/fc/48_qfcru6laeswnqaalj9fbsm5u.jpeg"></div><br>  You can also use the ‚ÄúResults‚Äù tab in the SAS UE and familiarize yourself with the imported SAS dataset. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qt/do/sd/qtdosdz9p9fls5-zpbs6sl8sde0.jpeg"></div><br><h2>  Reading SAS datasets </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/su/sz/ny/susznyrezwwkzaae2pheftsoipa.jpeg"></div><br>  Reading the SAS dataset is implemented in the DATA step using the <a href="https://go.documentation.sas.com/%3FdocsetId%3Dlestmtsref%26docsetTarget%3Dp00hxg3x8lwivcn1f0e9axziw57y.htm%26docsetVersion%3D9.4%26locale%3Den">SET</a> statement: <br><br>  Consider the general syntax of the SET operator: <br><br><pre> <code class="hljs lisp">SET&lt;SAS-data-set(<span class="hljs-name"><span class="hljs-name">s</span></span>) &lt;(<span class="hljs-name"><span class="hljs-name">data-set-options</span></span>(<span class="hljs-name"><span class="hljs-name">s</span></span>) )&gt; &gt; &lt;options&gt;<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br>  If you do not specify a dataset in the SET statement, it reads the observations from the last created SAS dataset. <br><br>  In the SET statement, you can specify multiple data sets, in this case, SAS Data Sets will be added one under the other (UNION equivalent in SQL). <br><br>  Also, in the DATA step, there can be two SET statements, in this case, the tables are combined according to a common column.  More information about the two SET operators can be found, for example, in <a href="https://www.lexjansen.com/pnwsug/2009/Gehring,%2520Renu%2520-%2520Multiple%2520Set%2520Statements%2520in%2520a%2520Data%2520Step.pdf">this article</a> . <br><br>  The simplest code that creates a copy of the SAS dataset is as follows: <br><br><pre> <code class="hljs sql">data company1; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> company; run;</code> </pre> <br><h2>  Configuring a SAS Dataset Descriptor </h2><br>  You can examine the SAS dataset descriptor using the PROC CONTENTS procedure ( <a href="https://habr.com/company/sas/blog/349726/">see Lesson 2</a> ).  In this lesson, we will print the descriptor component using the <a href="https://go.documentation.sas.com/%3FdocsetId%3Dproc%26docsetTarget%3Dn1hmips60w5w3yn1hj9klna7aplw.htm%26docsetVersion%3D9.4%26locale%3Dru">PROC DATASETS</a> procedure: <br><br><pre> <code class="hljs pgsql">proc datasets library=<span class="hljs-keyword"><span class="hljs-keyword">work</span></span> nolist; contents data=company <span class="hljs-keyword"><span class="hljs-keyword">order</span></span>=varnum; quit;</code> </pre> <br>  Fragment of results: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hx/dv/fb/hxdvfb9xumkbypqe3kx_ps0yggy.jpeg"></div><br>  Set the constant format for the variables Travel_Expenses and Budget: <br><br><pre> <code class="hljs pgsql">data company; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> company; <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> Travel_Expenses Budget dollar10<span class="hljs-number"><span class="hljs-number">.2</span></span>; run;</code> </pre> <br>  Check the attributes of the SAS datasets: <br><br><pre> <code class="hljs pgsql">proc datasets library=<span class="hljs-keyword"><span class="hljs-keyword">work</span></span> nolist; contents data=company <span class="hljs-keyword"><span class="hljs-keyword">order</span></span>=varnum; quit;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/ue/jq/zsuejqa6eyz7mhuwznywso-j-1e.jpeg"></div><br><h2>  Creating calculated columns </h2><br>  All SAS functions can be explored in the <a href="https://go.documentation.sas.com/api/docsets/lefunctionsref/9.4/content/lefunctionsref.pdf%3Flocale%3Dru">SAS 9.4 Functions and CALL Routines Reference: Fifth Edition</a> . <br><br>  In addition, if there is no suitable function to perform a particular task, you can use the <a href="https://go.documentation.sas.com/%3FdocsetId%3Dproc%26docsetTarget%3Dp10b4qouzgi6sqn154ipglazix2q.htm%26docsetVersion%3D9.4%26locale%3Dru">PROC FCMP</a> procedure and create your own function. <br><br>  In this lesson, we will explore the three functions of YRDIF, SUM and CATS. <br><br>  To calculate the difference in dates in years, we will use <a href="https://go.documentation.sas.com/%3FdocsetId%3Dlefunctionsref%26docsetTarget%3Dp1pmmr2dtec32an1vbsqmm3abil5.htm%26docsetVersion%3D9.4%26locale%3Dru">the YRDIF function</a> . <br><br>  Let me remind you that the date in SAS format is the number of days since January 1, 1960 ( <a href="https://habr.com/company/sas/blog/348168/">see Lesson 1</a> ).  On the presented data, we need to calculate the execution time of the work: <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> company1; set work.company; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Lead_Time</span></span></span><span class="hljs-class">=yrdif(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Start_Date</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">End_Date</span></span></span><span class="hljs-class">, '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">actual'</span></span></span><span class="hljs-class">); format </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Travel_Expenses</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Budget</span></span></span><span class="hljs-class"> dollar10.2 </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Lead_Time</span></span></span><span class="hljs-class"> 3.1; run;</span></span></code> </pre><br>  Note that using the 3.1 format for the Lead_Time variable, we rounded the calculated values ‚Äã‚Äãin the report (!) To 1 decimal place.  Operator format <b>does not change the</b> values ‚Äã‚Äãin the SAS dataset! <br><br>  Fragment of results: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/t_/ch/fv/t_chfvwkcil_pslkfobagw3zhjs.jpeg"></div><br>  Next, we calculate the cost of work without travel expenses: <br><br><pre> <code class="hljs pgsql">data company1; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">work</span></span>.company; Lead_Time=yrdif(Start_Date, End_Date, <span class="hljs-string"><span class="hljs-string">'actual'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span>=Budget-Travel_Expenses; <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span> Travel_Expenses Budget dollar10<span class="hljs-number"><span class="hljs-number">.2</span></span> Lead_Time <span class="hljs-number"><span class="hljs-number">3.1</span></span>; run;</code> </pre> <br>  Fragment of results: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yp/ss/4i/ypss4iuzxz8yib7g0pkltst0jxc.jpeg"></div><br>  As part of our task, the cost of work, excluding travel expenses, we calculated without using a function.  There are no missing values ‚Äã‚Äãin our table, if one of the variables (Budget or Travel_Expenses) had a missing value, the result was ‚Äúmissing‚Äù. <br><br>  For example: <br><br>  Create a test dataset: <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> test; input </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Budget</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Travel_Expenses</span></span></span><span class="hljs-class">; datalines; 12345 233 . 345 12543 . ;</span></span></code> </pre> <br>  Calculate the difference of variables Budget Travel_Expenses <br><br><pre> <code class="hljs sql">data test; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">test</span></span>; value=Budget-Travel_Expenses; run;</code> </pre> <br>  The result of this step: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kj/ng/h9/kjngh9l39sj9hht7mf0o3ptfauy.jpeg"></div><br>  In order to get the correct result, you can use the <a href="https://go.documentation.sas.com/%3FdocsetId%3Dlefunctionsref%26docsetTarget%3Dn0zxive1z1ctqin12w06c85jfigd.htm%26docsetVersion%3D9.4%26locale%3Dru">SUM</a> function. <br><br>  This function falls into the category of <b>descriptive statistics</b> functions.  The descriptive statistics functions <b>ignore</b> missing values. <br><br>  Writing code through SUM: <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> test; set test; value=sum(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Budget</span></span></span><span class="hljs-class">,-</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Travel_Expenses</span></span></span><span class="hljs-class">); run;</span></span></code> </pre> <br>  In this case, the result of the step is as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ls/ji/6u/lsji6u565y1z9dinudwbzhrgygo.jpeg"></div><br>  The third computed column is the manager's email address.  It can be ‚Äúcollected‚Äù from the columns Manager_FirstName, Manager_LastName and the values ‚Äã‚Äãof <a href="https://habr.com/users/habr/" class="user_link">habr</a> .com <br><br>  To merge text values ‚Äã‚Äãinto a single line, you can use <a href="https://go.documentation.sas.com/%3FdocsetId%3Dlefunctionsref%26docsetTarget%3Dn1e21rr6al5m2nn19r1fat5qxwrt.htm%26docsetVersion%3D9.4%26locale%3Dru">the CATS function</a> . <br><br><pre> <code class="hljs pgsql">data company1; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">work</span></span>.company; Lead_Time=yrdif(Start_Date, End_Date, <span class="hljs-string"><span class="hljs-string">'actual'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span>=Budget-Travel_Expenses; Email=cats(Manager_FirstName, <span class="hljs-string"><span class="hljs-string">'.'</span></span>,Manager_LastName, <span class="hljs-string"><span class="hljs-string">'@habr.com'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span> Travel_Expenses Budget dollar10<span class="hljs-number"><span class="hljs-number">.2</span></span> Lead_Time <span class="hljs-number"><span class="hljs-number">3.1</span></span>; run;</code> </pre> <br>  Fragment of results: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ta/rg/cn/targcncw0c3sg7w09xf1d3hizoq.jpeg"></div><br>  Examine the handle of the dataset created: <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">proc</span></span> contents <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">=work.company1 varnum; run;</span></span></code> </pre> <br>  Handle fragment: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cu/sk/sw/cusksw789cltrxqyxhl9vumtafu.jpeg"></div><br>  Notice the length of the Email variable. It is 200 bytes; this is the length returned by the default CATS function.  If we examine the attributes of the variables Manager_FirstName and Manager_LastName, then we can make sure that the Email variable is 8 + 6 + the length of the string '@ habr.com', that is, 9 more bytes, total 23. Why should you pay attention to this?  All missing characters achieve spaces, which affects the size of the data set and large amounts of data will affect performance. <br><br>  In order to set the length of the Email variable explicitly, you must use the LENGTH operator: <br><br><pre> <code class="hljs pgsql">data company1; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">work</span></span>.company; length Email <span class="hljs-meta"><span class="hljs-meta">$23</span></span>; Lead_Time=yrdif(Start_Date, End_Date, <span class="hljs-string"><span class="hljs-string">'actual'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span>=Budget-Travel_Expenses; Email=cats(Manager_FirstName, <span class="hljs-string"><span class="hljs-string">'.'</span></span>,Manager_LastName, <span class="hljs-string"><span class="hljs-string">'@habr.com'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span> Travel_Expenses Budget dollar10<span class="hljs-number"><span class="hljs-number">.2</span></span> Lead_Time <span class="hljs-number"><span class="hljs-number">3.1</span></span>; run;</code> </pre><br>  Handle Fragment <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aa/gb/1m/aagb1mayhm8qb27qe1q_uemuc_i.jpeg"></div><br>  Create a detailed column based on the variable Lead_Time, taking into account the following conditions: <br><br><ol><li>  If the value of the variable Lead_Time is less than 1, then the Detail column is less than 1 year. </li><li>  If the value of the variable Lead_Time is in the range from 1 to 2, including the borders, then the Detail column has a value of 1-2 years. </li><li>  If the value of the variable Lead_Time is in the range from 2 to 3, excluding 2, then the Detail column has a value of 2-3 years. </li><li>  If the value of the variable Lead_Time is in the range from 3 to 4, excluding 3, then the Detail column has a value of 3-4 years. </li><li>  If the value of the variable Lead_Time is in the range from 4 to 5, excluding 4, then the Detail column is 4-5 years. </li><li>  In all other cases, the Detail column is above 5 years. </li></ol><br>  You can create a detailed column in different ways, for example, the simplest and most obvious option is to use conditional processing.  It can be implemented using the following operators: <br><br><ol><li>  IF-THEN-ELSE </li><li>  ELSE IF </li><li>  SELECT-WHEN </li></ol><br>  On large amounts of data it is more efficient to use the last two options. <br><br><pre> <code class="hljs pgsql">data company1; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">work</span></span>.company; length Email <span class="hljs-meta"><span class="hljs-meta">$23</span></span>; Lead_Time=yrdif(Start_Date, End_Date, <span class="hljs-string"><span class="hljs-string">'actual'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span>=Budget-Travel_Expenses; Email=cats(Manager_FirstName, <span class="hljs-string"><span class="hljs-string">'.'</span></span>,Manager_LastName, <span class="hljs-string"><span class="hljs-string">'@habr.com'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span> Travel_Expenses Budget dollar10<span class="hljs-number"><span class="hljs-number">.2</span></span> Lead_Time <span class="hljs-number"><span class="hljs-number">3.1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&lt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'less than a year'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time=&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'1-2 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'2-3 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'3-4 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'4-5 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> detail=<span class="hljs-string"><span class="hljs-string">'above 5 years'</span></span>; run;</code> </pre> <br>  Add a condition that selects only those observations in which the value of the Detail variable is not equal to 'above 5 years'.  When using where as a filter, a syntax error will occur: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/1g/xw/dg1gxwpxot2yr4y8hxfyf1qn5yy.jpeg"></div><br>  The where clause is not used for calculated columns.  To select the variables we need, we need the selective IF operator.  It cancels the output of the observation in the created data set: <br><br><pre> <code class="hljs pgsql">data company1; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">work</span></span>.company; length Email <span class="hljs-meta"><span class="hljs-meta">$23</span></span>; Lead_Time=yrdif(Start_Date, End_Date, <span class="hljs-string"><span class="hljs-string">'actual'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span>=Budget-Travel_Expenses; Email=cats(Manager_FirstName, <span class="hljs-string"><span class="hljs-string">'.'</span></span>,Manager_LastName, <span class="hljs-string"><span class="hljs-string">'@habr.com'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span> Travel_Expenses Budget dollar10<span class="hljs-number"><span class="hljs-number">.2</span></span> Lead_Time <span class="hljs-number"><span class="hljs-number">3.1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&lt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'less than a year'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time=&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'1-2 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'2-3 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'3-4 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'2-3 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> detail=<span class="hljs-string"><span class="hljs-string">'above 5 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> detail ne <span class="hljs-string"><span class="hljs-string">'above 5 years'</span></span>; run;</code> </pre> <br>  Note also that the selective IF operator requires an arithmetic operator.  We cannot write, for example, like this: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> detail <span class="hljs-built_in"><span class="hljs-built_in">contains</span></span> 'above <span class="hljs-number"><span class="hljs-number">5</span></span> years';</code> </pre> <br>  An error is displayed in the Log: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/pg/bn/bbpgbnq-vb-xinyyoedx4psogra.jpeg"></div><br><h2>  Configure the SAS dataset. </h2><br>  In the new SAS dataset, the variables Manager_FirstName and Manager_LastName should not be present.  This requirement is implemented using the DROP parameter, you can also use the DROP operator. <br><br><pre> <code class="hljs pgsql">data company1 (<span class="hljs-keyword"><span class="hljs-keyword">drop</span></span>=Manager_FirstName Manager_LastName); <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">work</span></span>.company; length Email <span class="hljs-meta"><span class="hljs-meta">$23</span></span>; Lead_Time=yrdif(Start_Date, End_Date, <span class="hljs-string"><span class="hljs-string">'actual'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span>=Budget-Travel_Expenses; Email=cats(Manager_FirstName, <span class="hljs-string"><span class="hljs-string">'.'</span></span>,Manager_LastName, <span class="hljs-string"><span class="hljs-string">'@habr.com'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Cost</span></span> Travel_Expenses Budget dollar10<span class="hljs-number"><span class="hljs-number">.2</span></span> Lead_Time <span class="hljs-number"><span class="hljs-number">3.1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&lt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'less than a year'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time=&gt;<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'1-2 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'2-3 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'3-4 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Lead_Time&gt;<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Lead_Time&lt;=<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> detail=<span class="hljs-string"><span class="hljs-string">'2-3 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> detail=<span class="hljs-string"><span class="hljs-string">'above 5 years'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> detail ne <span class="hljs-string"><span class="hljs-string">'above 5 years'</span></span>; run;</code> </pre> <br><h2>  We split the created SAS dataset into two according to the given condition <br></h2><br>  In one DATA step, you can create multiple SAS datasets.  Create a separate data set for each country. <br><br>  To check what values ‚Äã‚Äãare in the Country column, you can, for example, use the <a href="http://support.sas.com/documentation/cdl/en/procstat/66703/HTML/default/viewer.htm">PROC FREQ</a> procedure. <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">proc</span></span> freq <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">=company1; table </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Country</span></span></span><span class="hljs-class"> /nocum nopercent; run;</span></span></code> </pre> <br>  This step counts the number of times a particular value from the Country variable is found in the SAS dataset specified in the data = parameter. <br><br>  The result of this step will be as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iu/nw/d7/iunwd74wia2efvl8dufe1lss-wa.jpeg"></div><br>  So, we will create two data sets in one DATA step using the OUTPUT operator and conditional processing: <br><br><pre> <code class="hljs pgsql">data US AU; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">work</span></span>.company1; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Country=<span class="hljs-string"><span class="hljs-string">'AU'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> output AU; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Country=<span class="hljs-string"><span class="hljs-string">'US'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> output US; run;</code> </pre> <br>  Run the code and see the LOG: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kp/ml/qh/kpmlqhkwiaykfvnpglwkzfjryiy.jpeg"></div><br>  This is a summary of reading and configuring SAS datasets.  In the next article, we will introduce you to combining data sets using the MERGE and SET operators. <br><br>  And as a PS, let me remind you the structure of our lessons on SAS BASE: <br><br>  Articles that have already been published: <br><br><ol><li>  <a href="https://habr.com/company/sas/blog/348168/">Basics of programming on SAS BASE.</a>  <a href="https://habr.com/company/sas/blog/348168/">Lesson 1.</a> </li><li>  <a href="https://habr.com/company/sas/blog/349726/">Basics of programming on SAS BASE.</a>  <a href="https://habr.com/company/sas/blog/349726/">Lesson 2. Access to data</a> </li><li>  <a href="https://habr.com/company/sas/blog/354284/">Basics of programming on SAS BASE.</a>  <a href="https://habr.com/company/sas/blog/354284/">Lesson 3. Reading text files.</a> </li><li>  With the fourth lesson you just read. </li></ol><br>  In the following articles, I would like to highlight such issues as table association in SAS Base (merge, set), conditional processing, loops, SAS functions, creating custom formats, SAS Macro, PROC SQL. <br><br><img src="https://habrastorage.org/webt/5h/3z/5l/5h3z5lwpgz1n66okrqwkvu6gnm0.png">  I would be happy to feedback in the comments!  What other topics would you like to see in the articles? </div><p>Source: <a href="https://habr.com/ru/post/426765/">https://habr.com/ru/post/426765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426747/index.html">In 2018, the KDE project developers received more than $ 0.5 million in donations. And not only they ...</a></li>
<li><a href="../426749/index.html">Moving to London with his wife and dogs. Mobile Developer History</a></li>
<li><a href="../426753/index.html">Mail Design Cup 2018 - Competition for interface designers</a></li>
<li><a href="../426755/index.html">The developers of Windows 10 have implemented protection against ransomware viruses. It can be circumvented by injection DLL</a></li>
<li><a href="../426759/index.html">The image of a modern tester. What you need to know and be able to</a></li>
<li><a href="../426769/index.html">The book "Minecraft. Program your world in Python. 2nd international edition ¬ª</a></li>
<li><a href="../426771/index.html">Making a machine learning project in Python. Part 3</a></li>
<li><a href="../426773/index.html">Tips for professional use RecyclerView. Part 2</a></li>
<li><a href="../426777/index.html">Bad advice on communication with technical support</a></li>
<li><a href="../426779/index.html">How does the station</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>