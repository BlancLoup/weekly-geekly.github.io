<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How does the radio interface work in GSM networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think many have ever thought about how cellular networks work. After all, we use mobile phones almost every day. The number of subscribers is increa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How does the radio interface work in GSM networks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e99/46c/f9e/e9946cf9ec504fd7a8625d2bde2f4eff.jpg"><br><br>  I think many have ever thought about how cellular networks work.  After all, we use mobile phones almost every day.  The number of subscribers is increasing every day, as well as the area of ‚Äã‚Äãnetwork coverage ... The new standards are coming to replace the new ones, and the ‚Äúappetites‚Äù of mobile Internet users are growing.  If you are interested in how it all works, welcome to the cut!  Since the cellular network infrastructure is quite large, and its description can take up a whole book, in this article we will focus on the Um interface, through which our phones interact with the operator‚Äôs equipment, as well as other subscribers. <br><br>  Beware, <s>angry dog</s> many pictures! <br><a name="habracut"></a><br><h2>  Foreword </h2><br>  Cellular communication appeared quite a long time ago.  Back in the 40s of the twentieth century, research began with the goal of creating a mobile communications network.  In 1956, the Mobile System A (MTA) car telephone network was launched in several cities in Sweden.  In 1957, our compatriot L.I.  Kupriyanovich publicly demonstrates the mobile phone he developed and the base station for him.  Then, in the USSR, the development of the Altai civilian cellular communication system will begin, which in a few years will cover more than 30, and then completely 114 Soviet cities.  By the way, in some cities of the post-Soviet space Altai is still working, for example, in Novosibirsk (numbering +7 (383) 349-8XXX)!  In the 80s, Motorola launches its famous <a href="https://ru.wikipedia.org/wiki/Motorola_DynaTAC">DynaTAC 8000X</a> worth $ 3995.  And only in 1992, following the NMT-450, AMPS, ETACS, D-AMPS and NMT-900 in Germany, cellular communications are launched based on the GSM standard. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Today, after more than twenty years, we use new generation networks, such as 3G and 4G, but GSM networks have not disappeared anywhere - they are still used by ATMs, terminals, alarm systems, and even modern phones to save electricity and maintain backward compatibility.  In addition, new items, like UMTS (or W-CDMA) and LTE, have much in common with GSM.  Unlike, for example, TCP / IP, cellular networks are less accessible for study and research.  There are a lot of reasons: starting from rather high prices for equipment, ending with the ban of the majority of countries on the use of GSM-band frequencies without a license.  In my opinion, an understanding of the principles of cellular networks is very important for specialists in the field of information security, and not only.  That is why I decided to write this publication. <br><br>  Content: <br><ol><li>  Introduction to cellular networks <br>  1.1 Cellular Service Providers <br>  1.2 Principles of network coverage <br>  1.3 Cellular network infrastructure <br>  1.4 Interoperability <br></li><li>  Um-interface (GSM Air Interface) <br>  2.1 Frequency ranges <br>  2.2 Physical channels, multiple access separation <br>  2.3 Logical channels <br>  2.4 What is a burst? <br>  2.5 Types of burst <br>  2.6 Frequency Hopping <br>  2.7 Basic principles of interaction between MS and BTS <br>  2.8 Handover <br>  2.9 Speech coding <br></li><li>  Security and Privacy <br>  3.1 Basic attack vectors <br>  3.2 Subscriber Identification <br>  3.3 Authentication <br>  3.4 Traffic Encryption <br></li></ol><br><h2>  1. Introduction to cellular networks </h2><br><h3>  1.1 Cellular Service Providers </h3><br>  By analogy with Internet providers, cellular services are provided by certain companies, most often called "operators".  Each of them offers its own range of services, and also sets its own tariff plans.  Most often, operators use their own equipment to build the basic network infrastructure;  some use the existing one, for example, in Russia, the Yota operator operates on the basis of the equipment of the Megafon operator. <br><br>  From the point of view of an ordinary subscriber of mobile networks, the individuality of the operator lies in the quality of communication services provided, a certain range of numbers, its own brand SIM-cards, as well as tariff plans.  From the operators themselves, as well as other telecommunication areas, each of them is identified by the country code (MCC - Mobile Country Code) and the unique network code within the country (MNC - Mobile Network Code).  In addition, subscriber identification is carried out not by the usual telephone number, but by the international subscriber ID ‚Äî IMSI (International Mobile Subscriber Identity), which is recorded in the subscriber‚Äôs SIM card, as well as in the operator‚Äôs database.  Phone numbers are simply ‚Äútied‚Äù to a specific IMSI, so that the subscriber can change the operator by saving his phone number. <br><br><h3>  1.2 Principles of network coverage </h3><br>  Coverage of a certain area by cellular communication is provided by distributing transceiver devices over its area.  I am sure many have seen them on advertising pieces, various buildings, and even on individual masts.  Most often they are a few white directional antennas, as well as a small building where the wires are pulled.  So, in GSM terminology, such complexes are called base stations (BTS) and can consist of several transceiver devices - transceivers (TRX - Transmitter / Receiver). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/32e/52c/248/32e52c248cd04d4a801f9d3ec47c5ca0.jpg"></div><br><br>  A key feature of cellular communication is that the total coverage area is divided into cells (cells), determined by the coverage areas of individual base stations (BS).  By the way, the name ‚Äúcellular communication‚Äù originated from here.  Each base station covers one or more sectors, and also has one or more transceivers in each sector, each of which emits a signal at its own frequency.  Simply put, a cell is one of the coverage cells that has its unique identifier, called CI (Cell ID).  Honeycombs can be classified according to the scale of the covered territory: macro cell (up to 35 km, sometimes up to 70 km), ordinary cell (up to 5 km), microcell (up to 1 km), pico cell (up to 300 meters) and femto cell (most commonly found indoors, covered tens of meters). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0ed/7ca/f98/0ed7caf98a654272be96d5132aa85c20.png"></div><br><br>  The base stations located nearby operate in different frequency bands, due to which the cells of different operators can partially or almost completely overlap each other.  A collection of base stations working together is called a Location Area Code (LAC).  All base stations necessarily broadcast their identification data, such as MCC, MNC, Cell ID, and LAC, so that mobile phones are connected only to their operator‚Äôs BTS.  In addition, mobile phones with a certain interval notify the network of their current location, i.e.  LAC.  This procedure is called Location Update, but more on that later. <br><br><h3>  1.3 Cellular network infrastructure </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a23/4e9/d54/a234e9d54b524bae8365198f42f2e765.png"></div><br><br>  Base stations cannot exist by themselves, therefore, being in a certain LAC, they are connected to a base station controller - BSC (Base Station Controller).  The controllers, in turn, perform load balancing, as well as actively participate in the exchange of traffic between the network and their "slaves".  The interaction of BTS and BSC is carried out via <i>the A-bis interface</i> .  Within the network, most operators, most often, have several base station controllers that, through the <i>A-interface</i> and <i>Gb-interface</i> to the switching nodes of the network (MSC - Mobile Switching Center, SGSN - Serving GPRS Support Node). <br><br>  MSC forms the core of the network infrastructure (Core Network), which includes the following main elements: <br><br><ul><li>  <b>HLR (Home Location Register)</b> - a database containing personal data of each subscriber, including a phone number, a tariff plan, a list of connected services, as well as information about the SIM card used by the subscriber. <br></li><li>  <b>VLR (Visitor Location Register)</b> is a temporary database of subscribers that are located within the range of a certain mobile switching center.  Each base station in the network is assigned to a specific VLR, so the subscriber cannot be present in several VLRs at the same time. <br></li><li>  <b>AuC (Authentication Center)</b> is a subscriber authentication center that authenticates each SIM card that connects to the network. <br></li><li>  <b>SMSC (SMS Center)</b> is a short text messaging center dedicated to storing and routing them. <br></li><li>  <b>GMSC (Gateway MSC)</b> is a gateway that provides access to wired landline networks.  It is thanks to this element that calls between subscribers of cellular and local telephone networks are possible. <br></li><li>  <b>SGSN (Serving GPRS Support Node)</b> is a GPRS subscriber service node that acts as a connection point between the base station system (BSS) and the core network (Core Network).  SGSN can be called analogue of the GSM network MSC switch.  SGSN monitors the delivery of data packets, monitors online users, converts GSM frames to formats used by the TCP / IP protocols of the global computer network of the Internet, registers or ‚Äúattachments‚Äù subscribers, newly ‚Äúappeared‚Äù in the network coverage area, encryption data, processing incoming billing information, and also provides interaction with the register of own subscribers of the HLR network.  Unlike the above elements, the SGSN connects directly to the BSC. <br></li></ul><br>  In addition, there is a billing system inside the network infrastructure, where our ‚Äúbalance‚Äù is stored, fees for using services are written off, and various payment transactions are processed.  The operator can attach other subsystems to the core of the network at its discretion. <br><br><h3>  1.4 Interoperability </h3><br>  Networks of different operators interact with each other, so, for example, Alice, being a subscriber of operator A, can call Bob, who is a subscriber of operator B. This network is called SS-7 or SS7, it works either on the basis of special wired / wireless communication networks, or over the Internet (yes, yes, network over network).  SS7 provides a set of protocols for the interaction of various operators.  Roaming also works thanks to this network. <br><br><h2>  2. Um-interface (GSM Air Interface) </h2><br><h3>  2.1 Frequency ranges </h3><br>  Any equipment in cellular networks interacts through certain interfaces.  As already mentioned, the data exchange between the base station and the subscriber is carried out through the <a href="https://en.wikipedia.org/wiki/Um_interface">Um-interface</a> , which is primarily a radio interface, hence the data exchange takes place in the process of receiving / transmitting radio waves.  Radio waves are the same electromagnetic radiation as heat or light.  Ultraviolet, X-ray and ionizing radiation are also types of electromagnetic radiation with certain frequency ranges and specific wavelengths.  Remember this picture? <br><br><img src="https://habrastorage.org/files/850/b98/719/850b98719cd1491f91af7958733dc7da.jpg"><br><br>  So, the range of radio waves is also divided into subsidiary frequency bands, for example, the ranges of LF (30-300 kHz), MF (300-3000 kHz) and HF (3-30 MHz) are most often used for radio communications and broadcasting;  TV broadcasts are in the VHF (30-300 MHz), UHF (300-3000 MHz) and SHF (3-30 GHz) bands;  Wireless networks, such as WiFi, and satellite TV work in the same SHF.  Most of all we are interested in the range of UHF, in which GSM networks operate.  According to the 3GPP TS 45.005 standard, they have allocated as many as 14 children for the UHF band, and different bands are used in different countries.  Consider the most common: <br><table><tbody><tr><th>  Specifications </th><th>  GSM-850 </th><th>  P-GSM-900 </th><th>  E-GSM-900 </th><th>  DCS-1800 </th><th>  PCS-1900 </th></tr><tr><td>  Uplink, MHz </td><td>  824.2 - 849.2 </td><td>  890.0 - 915.0 </td><td>  880.0 - 915.0 </td><td>  1710.2 - 1784.8 </td><td>  1850.2 - 1909.8 </td></tr><tr><td>  Downlink, MHz </td><td>  869.2 - 893.8 </td><td>  935.0 - 960.0 </td><td>  925.0 - 960.0 </td><td>  1805.2 - 1879.8 </td><td>  1930.2 - 1989.8 </td></tr><tr><td>  ARFCN </td><td>  128 - 251 </td><td>  1 - 124 </td><td>  975-1023, 0-124 </td><td>  512 - 885 </td><td>  512 - 810 </td></tr></tbody></table>  P-GSM-900, E-GSM-900 and DCS-1800 are used mainly in Europe and Asia.  The GSM-850 and PCS-1900 ranges are used in the USA, Canada, selected countries of Latin America and Africa. <br><br>  Any range allocated to the cellular network is divided into a number of segments (usually 200 KHz), some of which are called Downlink ‚Äî here only base stations (BTS) transmit data, and Uplink, where only phones transmit (MS).  Pairs of such segments, where one belongs to Downlink, and the other Uplink, form radio frequency channels, called <a href="https://en.wikipedia.org/wiki/Absolute_radio-frequency_channel_number">ARFCN (Absolute radio-frequency channel number)</a> .  In other words, the phone cannot receive and transmit data at the same frequency, instead, when transmitting, it switches to Uplink frequencies, and when it is received to Downlink, and the switching process occurs very quickly. <br><br><h3>  2.2 Physical channels, multiple access separation </h3><br>  With ranges figured out.  Now imagine a small closed room in which a lot of people.  If at a certain point in time everyone starts talking, it will be difficult for the interlocutors to understand each other.  Some will speak louder, which will only worsen the situation for others.  So, in physics, this phenomenon is called <a href="http://geektimes.ru/company/audiomania/blog/259038/">interference</a> .  In other words, the interference can be called the imposition of waves.  For GSM cellular networks, this is a parasitic phenomenon, so multi-access separation technologies come to the rescue. <br><br>  The need for separation of multiple access has arisen for a long time and is used both in wired communications (I2C, USB, Ethernet) and in wireless.  Cellular networks most often use <a href="https://en.wikipedia.org/wiki/Frequency-division_multiple_access">FDMA (Frequency Division Multiple Access)</a> , <a href="https://en.wikipedia.org/wiki/Time_division_multiple_access">TDMA (Time Division Multiple Access)</a> and <a href="https://en.wikipedia.org/wiki/Code_division_multiple_access">CDMA (Code Division Multiple Access) technologies</a> .  The first two are used together in the networks of the second generation - GSM.  CDMA is the basis of modern cellular networks that exceed GSM in terms of both security and maximum data transfer rates.  What is this magic? <br><br>  For radio systems, there are two main resources - frequency and time.  The division of multiple access into frequencies, when a certain frequency is allocated to each receiver and transmitter, is called FDMA.  The separation by time, when each pair of receiver-transmitter is allocated the whole range or most of it for a selected period of time, called TDMA.  In CDMA, there are no restrictions on frequency and time.  Instead, each transmitter modulates a signal using the individual numeric code currently assigned to each user, and the receiver calculates the desired part of the signal using a similar code.  In addition, there are several other technologies: <a href="https://en.wikipedia.org/wiki/Pulse-address_multiple_access">PAMA (Pulse-Address Multiple Access)</a> , <a href="https://en.wikipedia.org/wiki/Polarization_division_multiple_access">PDMA (Polarization Division Multiple Access)</a> , <a href="https://en.wikipedia.org/wiki/Space-division_multiple_access">SDMA (Space Division Multiple Access)</a> , however, their description is beyond the scope of this article. <br><br>  <b>Fdma</b> <br>  The principle of this method is that the available frequency spectrum is divided between receivers and transmitters into equal or unequal frequency bands, some of which are allocated for Downlink (traffic from BTS to MS), part under Uplink (traffic from MS to BTS).  We already spoke about it. <br><br>  <b>TDMA</b> <br>  Together with frequency division (FDMA), in GSM, the time division method (TDMA) is used.  According to TDMA, the entire data stream is divided into frames, and the frames, in turn, are divided into several timeslots, which are distributed among the transmitting / receiving devices.  Consequently, the phone can exchange information with the network only at certain intervals allocated to it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e23/682/173/e23682173ab54263b2344225c37885e7.PNG"></div><br><br>  Frames are combined into multi-frames, which are of two types: <br><br>  <b>Control Multiframe (contains 51 frame)</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/09a/fd6/b05/09afd6b0503844e497ae258d660700c2.PNG"></div><br><br>  <b>Traffic Multiframe (contains 26 frames)</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/339/c07/016/339c070165344ebdbf2bbe9f2886e99f.PNG"></div><br><br>  Multiframes form superframes, and already superframes form hyperframes.  More information about the structure of frames and their organization can be found <a href="http://www.sharetechnote.com/html/FrameStructure_GSM.html">here</a> (source of images) and <a href="http://www.teletopix.org/gsm/how-26-and-51-multiframes-in-gsm/">here</a> . <br><br>  As a result, the physical channel between the receiver and the transmitter is determined by the frequency allocated frames and numbers of timeslots in them.  Typically, base stations use one or more ARFCN channels, one of which is used to identify the presence of BTS on the air.  The first timeslot (index 0) of the frames of this channel is used as the base service channel (base-control channel or beacon-channel).  The remaining part of the ARFCN is distributed by the operator for the CCH and TCH channels at its discretion. <br><br><h3>  2.3 Logical channels </h3><br>  On the basis of physical channels are formed logical.  Um-interface involves the exchange of both user information and service.  According to the GSM specification, each type of information corresponds to a special kind of logical channels realized by physical: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/516/76b/ae0/51676bae05bb4119a1db04aa6d339608.jpg"></div><br><br><ul><li>  traffic channels (TCH - Traffic Channel), </li><li>  service information channels (CCH - Control Channel). </li></ul><br>  Traffic channels are divided into two main types: <b>TCH / F</b> - Full rate channel with a maximum speed of up to 22.8 Kbps and <b>TCH / H</b> - Half rate channel with a maximum speed of up to 11.4 Kbps.  These types of channels can be used for voice transmission (TCH / FS, TCH / HS) and user data (TCH / F9.6, TCH / F4.8, TCH / H4.8, TCH / F2.4, TCH / H2. 4), for example, SMS. <br><br>  Service information channels are divided into: <br><br><ul><li>  <b>Broadcast (BCH - Broadcast Channels).</b> <br><ul><li>  <b>FCCH - Frequency Correction Channel (channel correction frequency).</b>  Provides information needed by a mobile phone for frequency correction. </li><li>  <b>SCH - Synchronization Channel.</b>  It provides the mobile phone with the information necessary for TDMA synchronization with the base station (BTS), as well as its <a href="https://en.wikipedia.org/wiki/Base_station_identity_code">BSIC</a> identification data. </li><li>  <b>BCCH - Broadcast Control Channel (broadcast service information channel).</b>  Transmits basic information about the base station, such as the method of organizing overhead channels, the number of blocks reserved for access grant messages, and the number of multiframes (51 TDMA frames) between the paging requests. </li></ul></li><li>  <b>General Purpose Channels (CCCH - Common Control Channels)</b> <br><ul><li>  <b>PCH - Paging Channel.</b>  Looking ahead, I‚Äôll tell you that Paging is a kind of mobile phone ping that allows you to determine its availability in a specific coverage area.  This channel is designed specifically for this. </li><li>  <b>RACH - Random Access Channel (random access channel).</b>  Used by mobile phones to request their own SDCCH service channel.  Exclusively Uplink channel. </li><li>  <b>AGCH - Access Grant Channel.</b>  On this channel, base stations respond to RACH requests from mobile phones, allocating SDCCH, or TCH immediately. </li></ul></li><li>  <b>Own channels (DCCH - Dedicated Control Channels)</b> <br>  Own channels, as well as TCH, are allocated to certain mobile phones.  There are several subspecies: <br><ul><li>  <b>SDCCH - Stand-alone Dedicated Control Channel.</b>  This channel is used for mobile phone authentication, encryption key exchange, location update procedure, as well as voice calls and SMS messaging. </li><li>  <b>SACCH - Slow Associated Control Channel.</b>  Used during a call, or when the SDCCH channel is already involved.  With its help, BTS transmits periodic instructions to the phone to change the timings and signal strength.  In the opposite direction are data on the level of the received signal (RSSI), quality TCH, as well as the signal level of the nearest base stations (BTS Measurements). </li><li>  <b>FACCH - Fast Associated Control Channel.</b>  This channel is provided with TCH and allows you to send urgent messages, for example, during the transition from one base station to another ( <a href="https://en.wikipedia.org/wiki/Handover">Handover</a> ). </li></ul><br></li></ul><br><h2>  2.4 What is a burst? </h2><br>  Data in the air is transmitted in the form of sequences of bits, most often called "burst", within timeslots.  The term ‚Äúburst‚Äù, the most suitable analogue of which is the word ‚Äúsplash‚Äù, should be familiar to many radio amateurs, and appeared most likely when drawing up graphic models for analyzing radio broadcasting, where any activity is similar to waterfalls and water bursts.  More information about them can be found in <a href="http://www.teletopix.org/gsm/what-is-burst-in-gsm-and-burst-types-in-gsm/">this wonderful article</a> (source of images), we will focus on the most important.  A schematic representation of the burst might look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a38/8e0/92a/a388e092aec74f36946f0c3b052690cf.jpg"></div><br><br>  <b>Guard Period</b> <br>  In order to avoid the occurrence of interference (i.e., the overlay of two busrt on each other), the duration of the burst is always shorter than the duration of the timeslot by a certain value (0.577 - 0.546 = 0.031 ms), called ‚ÄúGuard Period‚Äù.  This period represents a kind of time margin to compensate for possible time delays during signal transmission. <br><br>  <b>Tail bits</b> <br>  These markers define the beginning and end of the burst. <br><br>  <b>Info</b> <br>  Payload burst, for example, subscriber data, or service traffic.  Consists of two parts. <br><br>  <b>Stealing flags</b> <br>  These two bits are set when both pieces of TCH burst data are transmitted on the FACCH.  One transmitted bit instead of two means that only one part of the burst is transmitted on the FACCH. <br><br>  <b>Training sequence</b> <br>  This part of the burst is used by the receiver to determine the physical characteristics of the channel between the telephone and the base station. <br><br><h2>  2.5 Types of burst </h2><br>  Each logical channel corresponds to certain types of burst: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b15/67e/6bf/b1567e6bf6cd42d9a22d9b606ebb405d.jpg"></div><br><br>  <b>Normal burst</b> <br>  Sequences of this type implement traffic channels (TCH) between the network and subscribers, as well as all types of control channels (CCH): CCCH, BCCH and DCCH. <br><br>  <b>Frequency Correction Burst</b> <br>  The name speaks for itself.  It implements a one-way downlink channel FCCH, allowing mobile phones to more accurately tune to the BTS frequency. <br><br>  <b>Synchronization Burst</b> <br>  Burst of this type, as well as Frequency Correction Burst, implements a downlink channel, only SCH, which is intended to identify the presence of base stations on the air.  By analogy with beacon-packets in WiFi networks, each such burst is transmitted at full power, and also contains information about the BTS necessary for synchronization with it: frame rate, identification data ( <a href="https://en.wikipedia.org/wiki/Base_station_identity_code">BSIC</a> ), and others. <br><br>  <b>Dummy burst</b> <br>  A dummy burst transmitted by the base station to fill in unused timeslots.  The fact is that if there is no activity on the channel, the signal strength of the current ARFCN will be significantly less.  In this case, the mobile phone may seem like it is far from the base station.  To avoid this, BTS fills unused timeslots with meaningless traffic. <br><br>  <b>Access Burst</b> <br>  When establishing a connection with the BTS, the mobile phone sends a request for a dedicated SDCCH channel on the RACH channel.  The base station, having received such a burst, assigns the subscriber its FDMA timings and responds on the AGCH channel, after which the mobile phone can receive and send Normal Bursts.  It is worth noting the increased duration of Guard time, since initially the information on time delays is not known either to the telephone or to the base station.  In case the RACH request did not hit the timeslot, the mobile phone sends it again after a pseudo-random period of time. <br><br><h2>  2.6 Frequency Hopping </h2><br><blockquote>  <i>Quote from wikipedia:</i> <br><br>  Pseudo-random tuning of the operating frequency (FHSS - frequency-hopping spread spectrum) is a method of transmitting information by radio, a feature of which is the frequent change of the carrier frequency.  The frequency varies according to a pseudo-random number sequence known to both the sender and the receiver.  The method increases the noise immunity of the communication channel. <br></blockquote><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3f6/87e/4a2/3f687e4a27d647d8895db88bd15e9855.jpg"></div><br><br>  <a href="https://en.wikipedia.org/wiki/Frequency-hopping_spread_spectrum">Frequency Hopping (FHSS)</a> is one of the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4%25D1%258B_%25D1%2580%25D0%25B0%25D1%2581%25D1%2588%25D0%25B8%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D1%2581%25D0%25BF%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25B0">methods of spreading</a> .  In addition to GSM networks, a variation of this method is used in Bluetooth.  What for? <br><br><ul><li>  <b>Reducing the effects of interference.</b>  Due to frequent frequency changes, interference can affect the signal only for a short time. <br></li><li>  <b>Data protection from unauthorized access.</b>  Without knowing the algorithm by which the signal frequency changes, it is impossible to extract the necessary data from the noise-like stream. <br></li><li>  <b>The complication of jamming.</b>  Frequency Hopping makes it difficult to ‚Äútargeted‚Äù (i.e., jamming a particular device, or a combination of devices) to jam the signal.  In this case, it is necessary to jam the entire occupied frequency range, which requires the use of more expensive and powerful equipment. <br></li></ul><br><h2>  2.7 Basic principles of interaction between MS and BTS </h2><br>  Let's start with what happens when you turn on your mobile phone.  Most often, even if the phone is turned off with the battery inserted, it continues to work.  At this time, there is a small program called the ‚Äúloader‚Äù.  The loader waits for pressing the power key, starts the charging process when the charger is connected, and sometimes the alarm clock.  It all depends on the specific phone model.  As soon as the power key is pressed, the process of loading the operating system begins, which first checks for the presence of a SIM card and then starts scanning the air in search of the operator‚Äôs network.  Even if there is no SIM card, the phone still connects to the nearest base station, providing an emergency call feature.  If the SIM card is in place, a Location Update request is made, notifying the network of the current LAC of the subscriber.  Then, the base station requests the IMEI of the phone and the IMSI SIM card to identify the subscriber (Identity Request).  If the provided IMEI is different from the one with which the subscriber connected before, the operator can send Internet settings.  By the way, you can even find a stolen phone.  Then authorization is performed, after which the phone can be in one of two states: <br><br><ul><li>  <b>IDLE</b> - ‚Äúidle mode‚Äù.  The phone does not transmit any network data while listening to the CCCH. <br></li><li>  <b>DEDICATED</b> - an active connection is established between the network and the phone, during which the phone periodically transmits information about the signal quality to the network and also exchanges user data. <br></li></ul><br>  Now let's take a closer look at the process of connecting to the network.  Each base station necessarily has a broadcast channel CCCH, which is located on the zero timeslot of a certain ARFCN.  In the process of scanning the air, the phone sequentially switches the frequency of the tuner, measuring the power of the received signal.  As soon as the BTS with the strongest signal is found, the phone switches to its sync channel (SCH).  Then, after receiving the first Synchronization Burst, the phone determines the sequence of timeslots, as well as the BSIC identification data, which consists of the NCC (Network Color Code) and BCC (Base station Color Code).  The list of allowed and prohibited identifiers is stored on the SIM-card. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As soon as the phone finds an allowed BCCH, a RACH request is sent, the base station allocates a specific physical channel, authenticates the subscriber, and also registers its arrival in the VLR and HLR. </font><font style="vertical-align: inherit;">After that, the phone is in IDLE mode. </font><font style="vertical-align: inherit;">When an incoming call or SMS message is received, all base stations of the current LAC begin to send Paging Requests to notify the subscriber of any event. </font><font style="vertical-align: inherit;">If the phone ‚Äúheard‚Äù it, it answers, the network sends an Immediate Assignment package describing the resources allocated to the subscriber (frequency, number of timeslot, etc.). </font><font style="vertical-align: inherit;">Very similar to Ping on the Internet. </font><font style="vertical-align: inherit;">From this point on, the phone is in DEDICATED mode until the connection is broken.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If the subscriber himself acts as the initiator of the connection, he must first send a CM Service Request request, and then wait for Immediate Assignment from the network. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.8 Handover </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handover (American version - handoff) - in cellular communication the process of transferring a subscriber from one base station to another during a telephone conversation or data transfer session. </font><font style="vertical-align: inherit;">This process occurs when the subscriber leaves the coverage area of ‚Äã‚Äãone base station and enters the coverage area of ‚Äã‚Äãanother. </font><font style="vertical-align: inherit;">Also, a handover can be performed if the current base station is overloaded, or its physical channels are too noisy. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Handover is of two types:</font></font><br><br><ul><li> <b> handover (¬´break-before-make¬ª).</b>       BTS ,      .         ,    .          handover       .  :) <br></li><li> <b> handover (¬´make-before-break¬ª).</b>    ,      BTS,       ,      BTS     .         ,        . <br></li></ul><br><br><h2> 2.9   </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As already mentioned, the speech of subscribers is transmitted on the TCH channel, which can be of two types: Full Rate (FR) and Half Rate (HR). </font><font style="vertical-align: inherit;">The following standards are used for encoding an audio stream in GSM mobile networks (and not only):</font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GSM-FR (Full Rate, 13 Kbps)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the first digital standard for speech coding, which provides a rather low sound quality compared to modern standards. </font><font style="vertical-align: inherit;">Despite the existence of more modern codecs, GSM-FR is still very widely used.</font></font><br></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GSM-HR (Half Rate, 5.6 Kbps)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the codec used by phones in power saving mode. </font><font style="vertical-align: inherit;">It takes half the bandwidth of the full rate channel. </font><font style="vertical-align: inherit;">Battery saving can be up to 30%.</font></font><br></li><li> <b>GSM-EFR (Enhanced Full Rate, 12,2 /)</b> ‚Äî  ,   Nokia   ,     GSM-FR.    ,          5%  GSM-FR. <br></li><li> <b>AMR (Adaptive multi rate)</b> ‚Äî       .      GSM  UMTS,         .  /         . <br></li></ul><br><br><h2> 3.    </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It's time to consider the basic algorithms for ensuring the privacy and security of subscriber data. </font><font style="vertical-align: inherit;">Against the backdrop of loud scandals and disclosures in the field of information security, this topic is quite relevant. </font><font style="vertical-align: inherit;">GSM, like any other complex system, has its own protection mechanisms, as well as vulnerabilities, which we will consider in this chapter. </font><font style="vertical-align: inherit;">I will not go into the wilds, describing the low-level bit conversion processes during encryption, etc., otherwise the article will turn into a huge bellied book. </font><font style="vertical-align: inherit;">Who cares, you can read these materials: </font></font><br><br> <a href="https://ru.wikipedia.org/wiki/%25D0%2591%25D0%25B5%25D0%25B7%25D0%25BE%25D0%25BF%25D0%25B0%25D1%2581%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C_GSM"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia, GSM Security </font></font></a> <br> <a href="http://habrahabr.ru/post/186838/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habrahabr, GSM Security: data encryption </font></font></a> <br> <a href="https://github.com/axilirator/plmn-research/tree/master/security"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A lot of presentations and articles on this topic in my GitHub repository</font></font></a> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.1 Basic attack vectors </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since the Um interface is a radio interface, all its traffic is ‚Äúvisible‚Äù to anyone who is within the range of the BTS. Moreover, it is possible to analyze the data transmitted through the air, even without leaving home, using special equipment (for example, an old mobile phone supported by the OsmocomBB project, or a small dongle RTL-SDR) and </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">straight arms are the</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> most common computer. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are two types of attacks: passive and active. In the first case, the attacker does not interact with the network, or with the attacked subscriber - only the reception and processing of information. It is not difficult to guess that it is almost impossible to detect such an attack, but it does not have as many prospects as an active one. An active attack involves the interaction of the attacker with the attacked subscriber and / or the cellular network.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It is possible to identify the most dangerous types of attacks to which subscribers of cellular networks are subject: </font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sniffing</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leakage of personal data, SMS and voice calls</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Location data leak</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spoofing (FakeBTS or IMSI Catcher)</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remote SIM card capture, arbitrary code execution (RCE)</font></font></b> </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Denial of Service (DoS)</font></font></b> </li></ul><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.2 Subscriber Identification </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As mentioned at the beginning of the article, subscriber identification is performed by IMSI, which is recorded in the subscriber‚Äôs SIM card and the operator‚Äôs HLR. </font><font style="vertical-align: inherit;">Mobile phone identification is performed by serial number - IMEI. </font><font style="vertical-align: inherit;">However, after authentication, neither IMSI, nor IMEI in open form fly over the air. </font><font style="vertical-align: inherit;">After the Location Update procedure, the subscriber is assigned a temporary identifier - TMSI (Temporary Mobile Subscriber Identity), and further interaction is carried out with his help. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attack methods</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ideally, the subscriber‚Äôs TMSI is known only to the mobile phone and the cellular network. </font><font style="vertical-align: inherit;">However, there are ways to circumvent this protection. </font><font style="vertical-align: inherit;">If you ring the subscriber cyclically or send SMS messages (or better Silent SMS), watching the PCH channel and performing the correlation, you can select the attacked subscriber with a certain accuracy. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, having access to the inter-operator SS7 network, by phone number you can find out the IMSI and LAC of its owner. </font><font style="vertical-align: inherit;">The problem is that in the SS7 network all operators "trust" each other, thereby reducing the level of confidentiality of the data of their subscribers.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.3 Authentication </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To protect against spoofing, the network authenticates the subscriber before starting its service. </font><font style="vertical-align: inherit;">In addition to IMSI, a randomly generated sequence, called Ki, is stored in the SIM card, which it returns only in a hashed form. </font><font style="vertical-align: inherit;">Ki is also stored in the operator's HLR and is never transmitted in clear text. </font><font style="vertical-align: inherit;">In general, the authentication process is based on the principle of a four-way handshake:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8d8/689/352/8d868935249e4079b93d854120bc4566.gif"></div><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The subscriber performs the Location Update Request, then provides the IMSI. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The network sends a pseudo-random RAND value. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The phone's SIM card hashes Ki and RAND using the A3 algorithm. </font><font style="vertical-align: inherit;">A3 (RAND, Ki) = SRAND.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The network also hashes Ki and RAND using the A3 algorithm. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If the SRAND value on the subscriber side coincides with that calculated on the network side, then the subscriber has been authenticated. </font></font></li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/files/606/229/dc8/606229dc8c9a4c7c829e8d97c3643410.png"></div><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methods of attack</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Busting Ki, having RAND and SRAND values, can take quite a long time. </font><font style="vertical-align: inherit;">In addition, operators can use their own hashing algorithms. </font><font style="vertical-align: inherit;">The network has quite a bit of information about brute force attempts. </font><font style="vertical-align: inherit;">However, not all SIM cards are perfectly protected. </font><font style="vertical-align: inherit;">Some researchers managed to get direct access to the file system of the SIM card, and then extract the Ki.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.4 Traffic Encryption </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> According to the specification, there are three algorithms for encrypting user traffic: </font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A5 / 0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a formal designation for the lack of encryption, as well as OPEN in WiFi networks. </font><font style="vertical-align: inherit;">I myself have never met networks without encryption, however, according to </font></font><a href="http://gsmmap.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gsmmap.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , A5 / 0 is used in Syria and South Korea.</font></font><br></li><li> <b>A5/1</b> ‚Äî    .    ,         ,    .      2     ,     Linux   Kraken  . <br></li><li> <b>A5/2</b> ‚Äî      .    ,    . <br></li><li> <b>A5/3</b> ‚Äî       ,    2002 .          ,         .  ,          2G-.   <a href="https%253A%252F%252Fru.wikipedia.org%252Fwiki%252F%2525D0%2525A1%2525D0%25259E%2525D0%2525A0%2525D0%25259C%26usg%3DAFQjCNFdu3cc-LecrIYwAuBEjx_IMZKmvQ%26sig2%3D-8nGawK7GCohbOoK9enrsw"></a>    , ..             .        .  ,    3GPP-. <br></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attack Methods</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As already mentioned, having sniffing equipment and a computer with 2 TB of memory and the Kraken program, you can quite quickly (a few seconds) find session encryption keys A5 / 1, and then decrypt anyone's traffic. German cryptologist Karsten Nohl in 2009 </font></font><a href="http://habrahabr.ru/post/79631/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">demonstrated the</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A5 / 1 hacking method. A few years later, Carsten and Sylvain Muno demonstrated the interception and method of decrypting a telephone conversation with the help of several old Motorola phones (OsmocomBB project).</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My long story came to an end. </font><font style="vertical-align: inherit;">In more detail and from the practical side, the principles of operation of cellular networks can be found in a series of articles on </font></font><a href="http://habrahabr.ru/post/257631/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introducing OsmocomBB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as soon as I add the remaining parts. </font><font style="vertical-align: inherit;">I hope I managed to tell you something new and interesting. </font><font style="vertical-align: inherit;">Waiting for your feedback and comments!</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">References</font></font></b> <div class="spoiler_text">      <br> <a href="https://en.wikipedia.org/wiki/Um_interface">en.wikipedia.org/wiki/Um_interface</a> <br> <a href="https://en.wikipedia.org/wiki/GSM_frequency_bands">en.wikipedia.org/wiki/GSM_frequency_bands</a> <br> <a href="http://www.teletopix.org/gsm/what-is-burst-in-gsm-and-burst-types-in-gsm/">www.teletopix.org/gsm/what-is-burst-in-gsm-and-burst-types-in-gsm</a> <br> <a href="https://en.wikipedia.org/wiki/Control_channel">en.wikipedia.org/wiki/Control_channel</a> <br> <a href="http://www.etsi.org/deliver/etsi_gts/05/0502/03.08.00_60/gsmts_0502sv030800p.pdf">www.etsi.org/deliver/etsi_gts/05/0502/03.08.00_60/gsmts_0502sv030800p.pdf</a> <br> <a href="http://www.sharetechnote.com/html/FrameStructure_GSM.html">www.sharetechnote.com/html/FrameStructure_GSM.html</a> <br> <a href="http://www.teletopix.org/gsm/how-26-and-51-multiframes-in-gsm/">www.teletopix.org/gsm/how-26-and-51-multiframes-in-gsm</a> <br> <a href="http://www.teletopix.org/gsm/bch-cbch-and-ccch-works-in-gsm/">www.teletopix.org/gsm/bch-cbch-and-ccch-works-in-gsm</a> <br> <a href="http://www.teletopix.org/gsm/dedicated-control-channel-dcch-in-gsm/">www.teletopix.org/gsm/dedicated-control-channel-dcch-in-gsm</a> <br> <a href="https://en.wikipedia.org/wiki/Handover">en.wikipedia.org/wiki/Handover</a> <br> <a href="http://www.teletopix.org/gsm/slow-and-fast-frequency-hopping-in-gsm/">www.teletopix.org/gsm/slow-and-fast-frequency-hopping-in-gsm</a> <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/268127/">https://habr.com/ru/post/268127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268115/index.html">A simple graphic editor using OpenCV</a></li>
<li><a href="../268117/index.html">IntelliJ IDEA 15 Preview available</a></li>
<li><a href="../268119/index.html">Creating loadable Zabbix modules on the example of adding the Modbus protocol</a></li>
<li><a href="../268123/index.html">Fantasy on WebDAV. Regular Client</a></li>
<li><a href="../268125/index.html">Underground carders market. Translation of the book "KingPIN". Chapter 15. "UBuyWeRush"</a></li>
<li><a href="../268129/index.html">File System and Hadoop: The Twitter Experience (Part 2)</a></li>
<li><a href="../268131/index.html">Mono and OS MSVS</a></li>
<li><a href="../268135/index.html">About safety UEFI, part six</a></li>
<li><a href="../268137/index.html">Good luck in the digital age! Or turn on the paranoid and check the protection of their data</a></li>
<li><a href="../268141/index.html">Non-constant constant expressions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>