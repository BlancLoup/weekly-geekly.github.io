<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we implemented DevOps: release management in Visual Studio Team Services</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! The next issue of the article from the series ‚ÄúHow we implemented DevOps‚Äù from the Vorlon.JS team. Vorlon.JS is a node.js-based tool that allow...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we implemented DevOps: release management in Visual Studio Team Services</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/004/d96/0e4/004d960e46a04f90990b6d024145d792.png" width="600"><br><br><blockquote>  <i>Hello!</i>  <i>The next issue of the article from the series <a href="https://habrahabr.ru/search/%3Fq%3D%255Bjourney2devops%255D%26amp%3Btarget_type%3Dposts">‚ÄúHow we implemented DevOps‚Äù</a> from the Vorlon.JS team.</i>  <i>Vorlon.JS is a node.js-based tool that allows web developers a convenient way to remotely test, control and debug a web application, especially on mobile and embedded systems.</i>  <i>In their blog on MSDN, the team described the phased introduction of DevOps practices into the organization of work on Vorlon.JS and the selection of tools for solving daily tasks.</i>  <i>Vorlon.JS is an <a href="http://github.com/microsoftdx/vorlonjs">open source project</a> .</i> </blockquote><br>  Cycle content: <br><ul><li>  <a href="https://habrahabr.ru/company/microsoft/blog/280446/">Project Planning and Management with Visual Studio Team Services</a> </li><li>  <a href="https://habrahabr.ru/company/microsoft/blog/281024/">Continuous integration with GitHub and Visual Studio Team Services build system</a> </li><li>  <a href="https://habrahabr.ru/company/microsoft/blog/281505/">Infrastructure-as-code with Microsoft Azure and Azure Resource Manager</a> </li><li>  <b>Release Management in Visual Studio Team Services</b> </li><li>  Testing in production environment with Microsoft Azure App Service and Web Apps </li></ul><br>  In previous articles in this series, we discussed the use of continuous integration, which allows you to build code every time you change code in GitHub using the build system in Visual Studio Team Services.  In addition, this assembly generates a number of artifacts: application code with its dependencies and scripts (in the DeploymentTools folder), which allow you to automatically create an infrastructure (‚Äúinfrastructure-as-code‚Äù principle) in Microsoft Azure and deploy the application. <br><a name="habracut"></a><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/524/e82/3d7/524e823d7a7e11814564ae68d86d15d0.png" alt="image"></div><br><br>  The screenshot above shows the artifacts generated during assembly.  Among them, as you can see, is the deployment-package.zip archive and a number of JSON and PowerShell scripts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Zip-archive contains the code of the application and its dependencies.  This archive can be deployed to Azure Web App using Web Deploy.  JSON scripts are Azure Resource Manager templates with which we will create different environments - for development, testing and production. <br><br><blockquote>  <i>Note: you can view all these scripts in our</i> <i>GitHub repository</i> <i>,</i> <a href="https://github.com/MicrosoftDX/Vorlonjs/tree/dev/DeploymentTools"><i>https</i> <i>: //</i> <i>github</i> <i>.</i></a>  <a href="https://github.com/MicrosoftDX/Vorlonjs/tree/dev/DeploymentTools"><i>com</i> <i>/</i> <i>MicrosoftDX</i> <i>/</i> <i>Vorlonjs</i> <i>/</i> <i>tree</i> <i>/</i> <i>dev</i> <i>/</i> <i>DeploymentTools</i></a> </blockquote>  Today we will discuss the possibility of using these artifacts in Visual Studio Team Services Release Management to form a release management process that will automatically deploy the application in various environments. <br><br><h3>  Connect a Microsoft Azure subscription to Visual Studio Team Services </h3><br>  You have previously connected your GitHub account to access the source code during the build process.  Now you need to similarly connect your Microsoft Azure subscription to Visual Studio Team Services to automatically deploy applications to the cloud using Release Management. <br><br>  Press the button <img src="https://habrastorage.org/getpro/habr/post_images/01e/8a7/288/01e8a72886f8166440806764e1d546d6.png" alt="image">  in the upper right corner of the window to open the settings of the team project, and go to the Services tab.  Here you can add a new connection, in this case to your Microsoft Azure subscription: <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/e0a/252/329/e0a252329b942c5594aaeb62572c0329.png" alt="image"></div><br><br>  All you need to do is enter your credentials.  To find out the subscription ID, hover the mouse over the additional information icon and follow the link ‚Äúpublish settings file‚Äù, which will appear there: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/162/6a8/b4f/1626a8b4f93c41e18b19c85422d145f8.png" alt="image"></div><blockquote>  <i>Note.</i>  <i>If you do not have an account in</i> <i>Microsoft Azure</i> <i>, click on the</i> <a href="http://aka.ms/tryazure"><i>link</i></a> to create a new subscription, which can be used free of charge for a month. </blockquote><br><h3>  Release Definition </h3><br>  The first stage of work in VSTS Release Management is the creation of a definition for shaping the application release process.  Click the RELEASE tab. <br><br>  Press the button <img src="https://habrastorage.org/getpro/habr/post_images/7bb/d07/100/7bbd07100aa102874051a55cb13b4dbc.png" alt="image">  in the left pane to create a new release definition.  You can start working with an existing template or with an empty definition: <br><br><div style="text-align:center;"><img height="600" src="https://habrastorage.org/getpro/habr/post_images/a2d/1e0/d98/a2d1e0d9804c0f3f4cbdb31d41752105.png" alt="image"></div><br>  In the example, we selected an empty template.  The constructor looks the same as the one with which you defined the new build, but now you will need to perform several more steps before determining the release. <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/9dc/4e8/a78/9dc4e8a7816c027fc793020f88ebc5b0.png" alt="image"></div><br><br>  First, you must specify the name of the new release definition and associate it with the assembly definition.  To do this, click the link ‚ÄúLink to a build definition‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e08/a8d/858/e08a8d858b189315b955afc0869878c8.png" alt="image"></div><br><br>  This stage is very important: after it, in the definition of release, it will be possible to use the artifact published after the assembly.  In the case of Vorlon.JS, we associate the previously created CI assembly and scripts, which are published at the last stage of the assembly.  These scripts allow you to initiate the release of the application after each successful completion of the assembly, if you want to continue (continuously) to deploy the application. <br><br>  Now you can define the environments in which the application will be released.  We use three environments: <b>Development</b> , <br>  <b>Pre</b> <b>-</b> <b>Production</b> and <b>Production</b> .  To add a new environment, click the Add environments button and specify a name for each new environment: <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/423/ca2/67c/423ca267c95f22f5f9d9604c8780e27b.png" alt="image"></div><br><blockquote>  <i>Note: if the stages for all environments are identical, then you can define the first environment and then clone it by clicking the "..." icon in the menu:</i> </blockquote><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/751/2ca/edc/7512caedcdf161f4f60134f4b87d9a7d.png" alt="image"></div><br>  <i>Note: The</i> <i>Save</i> <i>as</i> <i>template</i> <i>command</i> <i>allows you to create a template based on the environment definition.</i>  <i>It will be available when creating a new release or environment definition.</i> <br><br>  For each environment, you can define a set of tasks to be performed.  There are many ready-made tasks that you can use.  To add a new task to the environment, click <img src="https://habrastorage.org/getpro/habr/post_images/91b/d4d/c39/91bd4dc3988f81cc76da0665c7cc7d73.png" alt="image">  : <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/813/28f/cb1/81328fcb18423b4b1bc83f2f1084fc48.png" alt="image"></div><br>  For example, you can select the ‚ÄúAzure Resource Group Deployment‚Äù task, which will allow you to create or update a new resource group using a JSON template with the Azure Resource Manager, or ‚ÄúAzure Web App Deployment‚Äù to deploy a web application.  Another task will help you deploy using external tools - Chef or Docker. <br><br>  The screenshot below shows the stages we set up for the release of Vorlon.JS in the Development environment: <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/getpro/habr/post_images/810/0fc/22f/8100fc22feb59516a12af9960ab2704a.png" alt="image"></div><br><br>  The first stage creates or adds a VorlonJS-Development-RG resource group using deployment templates that were published when the assembly started during the continuous integration process.  To view the artifacts published during the build and select the files, click the "..." button: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/563/6cb/bb5/5636cbbb594f8de6062af9dfa80c5aa1.png" alt="image"></div><br><br>  The second stage publishes the application to Azure Web Apps using the deployment-package.zip archive generated during the build: <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/getpro/habr/post_images/134/f6f/b8c/134f6fb8c93f14d31c05814007a9f737.png" alt="image"></div><br><br>  Stage three updates the Azure Web App configuration using the Azure Resource Manager template. <br><br>  You can also delete a resource group using the Azure Resource Group Deployment task.  We wanted to customize the Vorlon.JS release process in Production so that the infrastructure of the unused environment is immediately removed.  Therefore, the first stage of release in the Pre-Production environment is the removal of Development environment, i.e.  release of resources.  We also remove the Pre-Production environment at the beginning of the deployment of the project to Production: <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/getpro/habr/post_images/2ae/3a5/826/2ae3a58269ae8d0a41c23d4e5c2e70de.png" alt="image"></div><br><br>  Thus, we optimally use Microsoft Azure resources, without loading them with execution and support of unused applications and environments. <br><br>  After setting up all the media and stages of release, click <img src="https://habrastorage.org/getpro/habr/post_images/d47/851/bbf/d47851bbfac3839d2451cea68a441df4.png" alt="image">  in the toolbar to save the release definition. <br><br><h3>  Assign responsible </h3><br>  Each environment is a group of tasks for your release process.  To control the transition from one environment to another, you can designate responsible people - those who will make decisions before and after deployment. <br><br>  In the case of Vorlon.JS, we set up a confirmation request prior to deployment to the test and production environments.  To designate those responsible, click on the ‚Äú...‚Äù icon of the environment you want to configure, and select ‚ÄúAssign approvers ...‚Äù: <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/524/78c/cf4/52478ccf467b77af04dc3fe2d551688d.png" alt="image"></div><br><br>  In this example, the deployment in the <b>Pre</b> <b>-</b> <b>Production</b> environment will begin only after Stephan and I have approved the deployment in the <b>Development</b> environment.  This feature is very useful if different teams work on different environments. <br><br>  For example, the development team first checks the application in the Development environment before sending the application to the Pre-Production environment.  A team of quality control or test engineers then performs user interface tests or stress tests in the Pre-Production environment, obtains the approval of the person in charge of the product and initiates the deployment in the Production environment. <br><br><h3>  Configure Continuous Deployment </h3><br>  Continuous deployment is another great feature of Release Management.  You can configure VSTS so that after each successful completion of the assembly, the release (release) of the application occurs automatically.  To do this, go to the Triggers tab and select the Continuous Deployment checkbox. <br><br>  Next, select the build and environment: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fac/6da/2c4/fac6da2c4f52521d45edaefd35ebce53.png" alt="image"></div><br><br><h3>  Create new release </h3><br>  When the release definition is ready, you can check it out by initiating a new release.  To do this, click <img src="https://habrastorage.org/getpro/habr/post_images/61e/600/eb4/61e600eb42645d26580a141dbc919652.png" alt="image">  on the toolbar and select Create Release: <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/5a7/a5c/622/5a7a5c6229d484beba336ab82268d45d.png" alt="image"></div><br><br>  Click Create and wait for the release to start. <br><br><h3>  Getting release status </h3><br>  To find out the release status, double-click on its row in the Releases table.  Summary tab provides general information about the results of the release: <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/getpro/habr/post_images/626/e81/489/626e814891be77ece1429a37a4f88c02.png" alt="image"></div><br><br>  In our example, the release of the application in the Development environment was successfully completed, and to continue the release in the Pre-Production environment, we need to receive confirmation.  To approve or reject the release, just click the link on the message in the yellow box: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/013/921/b35/013921b354b94a66ca76b5e6c00b1448.png" alt="image"></div><br><br>  If the application deployed in the first environment suits you, click Approve, if not, click Reject and the application will not be deployed in other environments. <br><br>  The Logs tab contains detailed information about each phase of release: <br><br><div style="text-align:center;"><img width="800" src="https://habrastorage.org/getpro/habr/post_images/f6b/3ad/657/f6b3ad6575dc983b435447e89aac0d53.png" alt="image"></div><br>  To get more information about the release, click on its name in the panel on the left, and on the Overview tab: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dcf/638/517/dcf6385170b125a3e45d68488a810ebf.png" alt="image"></div><br><br>  In this example, the release of release at number 42 was successfully completed in the Development environment and not completed in the Pre-Production environment, and release at number 40 was rejected and was not released to Production. <br><br><h3>  Conclusion </h3><br>  Now you can manage releases of all your applications to automate and improve the way you provide new features and products to your customers.  But with the deployment of an application in production, its life cycle does not end.  Now you need to get information about this application.  Continuous improvement may require diagnostic data or usage information. <br><br>  In the work on Vorlon.JS, we used a number of tools that could be useful to you.  We will talk about them in the following articles. <br><br><h4>  About the authors </h4><br><img src="https://habrastorage.org/files/1f6/2b9/f58/1f62b9f5871741a1a3eaa583b41c2afa.jpg" align="left" width="150"><br>  Julien Corioland is a technology evangelist from Microsoft, France.  The main direction of work is the Microsoft Azure application platform.  He helps developers create cloud-based applications, and also belongs to the Vorlon.JS tool development group, in which he helps to implement DevOps practices. <br><br>  We are pleased to announce that the developers of the Vorlon.JS project - Julien Corioland and Ettiene Margraff will speak at the DevCon 2016 conference, where they will talk about their experience of implementing practices live exclusively for the participants of the DevOps Intensive by hands. <br><br>  If you have questions about this <a href="https://blogs.technet.microsoft.com/devops/2016/01/12/vorlonjs-a-journey-to-devops-introducing-the-blog-post-series/">series of publications</a> or about the DevOps methodology, you can contact the author directly via Twitter: <a href="http://twitter.com/jcorioland">twitter.com/jcorioland</a> <br><br><h4>  useful links </h4><br><ul><li>  Visual Studio 2015, Visual Studio Team Services, Visual Studio Code: <a href="https://www.visualstudio.com/ru-ru/products/free-developer-offers-vs.aspx">free offers for developers</a> </li><li>  Additional and free tools and services in <a href="https://www.visualstudio.com/ru-ru/products/visual-studio-dev-essentials-vs.aspx">Visual Studio Dev Essentials</a> </li><li>  <a href="https://msdn.microsoft.com/ru-ru/mt627843.aspx">Laboratory work</a> on the development, testing and management of the life cycle of software for Visual Studio 2015 </li></ul></div><p>Source: <a href="https://habr.com/ru/post/281895/">https://habr.com/ru/post/281895/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281879/index.html">Why is JavaScript faster than C ++?</a></li>
<li><a href="../281881/index.html">Tab closing options and other improvements in Vivaldi 1.1.453.6 assembly</a></li>
<li><a href="../281885/index.html">April 23 - Russian final of Imagine Cup and Student Day in Moscow</a></li>
<li><a href="../281887/index.html">The interaction of software and hardware</a></li>
<li><a href="../281889/index.html">How to create a virtual infrastructure provider: Experience 1cloud</a></li>
<li><a href="../281897/index.html">Quickly create MVP (minimum viable product) based on Microsoft Azure and Xamarin.Forms</a></li>
<li><a href="../281899/index.html">Deploying Django Stack on Ubuntu in Microsoft Azure Cloud</a></li>
<li><a href="../281903/index.html">Urho3D: Materials</a></li>
<li><a href="../281905/index.html">Ershov's Birthday</a></li>
<li><a href="../281913/index.html">M2M in 5 minutes with DeviceHive and Microsoft Azure. How to start your journey in IoT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>