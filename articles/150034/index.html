<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We implement RESTful Web Service on java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all farmers! 

 The reason for writing the article was that, to my great surprise at Habr√©, I did not find an article about the implementa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We implement RESTful Web Service on java</h1><div class="post__text post__text-html js-mediator-article">  Good day to all farmers! <br><br>  The reason for writing the article was that, to my great surprise at Habr√©, I did not find an article about the implementation of the RESTful Web Service in Java, but, of course, I didn‚Äôt look well.  Yes, there is a lot written about RESTful web services, but somehow it‚Äôs just that, with simple code examples, a working service, it‚Äôs not so easy to find it and not only in Habr√© ... <br><br>  In general, I got acquainted with <a href="http://en.wikipedia.org/wiki/REST">REST</a> only recently, not more than a month ago.  So I will be very grateful for the advice, amendments and criticism! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It was not so difficult to understand, and so, but I think a similar post would help me a lot and would greatly speed up the learning process!  Especially if you are a novice developer and have only heard a lot about things, but have never touched them with your hands. <br><br>  In my first impression: the thing is really very convenient, and most importantly, very simple, and if you use <a href="http://en.wikipedia.org/wiki/JSON">JSON</a> , and not <a href="http://en.wikipedia.org/wiki/XML">XML</a> , well, at least it seemed to me after the experience with <a href="http://en.wikipedia.org/wiki/SOAP">SOAP</a> and <a href="http://en.wikipedia.org/wiki/WSDL">WSDL</a> .  Well, yes, I think about it, and so everyone knows who has worked at least a little with web services. <br><br>  So, who is interested in the implementation, please under the cat <br><a name="habracut"></a><br>  Immediately make a reservation: <br><br>  1. All the code, of course, cannot be laid out in the article and cannot be told about it; <br>  2. the project version is, of course, not final, and, as I said above, I will be very grateful for comments and advice; <br>  3. Of course, there are bugs. <br><br>  And so, let's start in order: <br><br>  1. Used software: <br><ul><li>  JDK 1.6 </li><li>  <a href="http://en.wikipedia.org/wiki/Apache_CXF">Apache_CXF</a> </li><li>  <a href="http://static.springsource.org/spring/docs/3.0.x/reference/jdbc.html">Spring 3 Framework JDBC</a> </li><li>  Apache Tomcat 7.0 </li><li>  MySQL 5.1 </li><li>  Eclipse 4.2 Juno </li><li>  Maven 3.0 </li></ul><br><br>  The software was chosen on a very simple principle - the simpler, the better.  Yes, instead of MySQL for loaded services without having to make complex queries to the database, <a href="http://en.wikipedia.org/wiki/MongoDB">MongoDB is</a> very good to use, well, at least there is a lot written about this, and again it is more convenient to use it since the same <a href="http://en.wikipedia.org/wiki/JSON">JSON is</a> used at the input. <br><br>  2. In principle, what our service will do is that everything is very trite here: the service will work with a single table in the database - insert, update, delete, and, of course, receive records in a list or by Id.  Of course, I would like to be able to parameterize a request for a list of records, it would not be bad to make a ‚Äúbeautiful‚Äù URL to the service, to tie some interceptor, for example, to check the user's rights to access the service, or to do something else. before starting the service, well, somehow centrally manage the error codes in the responses from the server. <br><br>  Actually, the sign: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`customer`</span></span> ( <span class="hljs-string"><span class="hljs-string">`id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`first_name`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`last_name`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`phone`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`mail`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`adress`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`contract_id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">45</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`contract_expire_date`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> )</code> </pre> <br><br>  WS Endpoints: <br><br><pre>  1. http://mysite.com/service/customer </pre><br><pre>  2. http://mysite.com/service/customer/{id} </pre><br><br>  4 standard statuses that we will additionally process (for example, to add a version of our web services in response and in case of error our error code): <br><br>  200 - Successful; <br>  401 - Not Authorized; <br>  404 - Not Found; <br>  500 - Server error during operation. <br><br>  3. Implementation (github code <a href="">here</a> ): <br><br>  Yes, the code, minimally commented, the description of annotations <a href="http://jsr311.java.net/nonav/releases/1.1/spec/spec.html">here</a> . <br><br>  Web services themselves: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomersServiceJSON</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ICustomersService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// link to our dao object private ICustomersDAO customersDAO; // for customersDAO bean property injection public ICustomersDAO getCustomersDAO() { return customersDAO; } public void setCustomersDAO(ICustomersDAO customersDAO) { this.customersDAO = customersDAO; } // for retrieving request headers from context // an injectable interface that provides access to HTTP header information. @Context private HttpHeaders requestHeaders; private String getHeaderVersion() { return requestHeaders.getRequestHeader("version").get(0); } // get by id service @GET @Path("/{id}") public Response getCustomer(@PathParam("id") String id) { Customer customer = customersDAO.getCustomer(id); if (customer != null) { return ResponseCreator.success(getHeaderVersion(), customer); } else { return ResponseCreator.error(404, Error.NOT_FOUND.getCode(), getHeaderVersion()); } } // remove row from the customers table according with passed id and returned // status message in body @DELETE @Path("/{id}") public Response removeCustomer(@PathParam("id") String id) { if (customersDAO.removeCustomer(id)) { return ResponseCreator.success(getHeaderVersion(), "removed"); } else { return ResponseCreator.success(getHeaderVersion(), "no such id"); } } // create row representing customer and returns created customer as // object-&gt;JSON structure @POST @Consumes(MediaType.APPLICATION_JSON) public Response createCustomer(Customer customer) { System.out.println("POST"); Customer creCustomer = customersDAO.createCustomer(customer); if (creCustomer != null) { return ResponseCreator.success(getHeaderVersion(), creCustomer); } else { return ResponseCreator.error(500, Error.SERVER_ERROR.getCode(), getHeaderVersion()); } } // update row and return previous version of row representing customer as // object-&gt;JSON structure @PUT @Consumes(MediaType.APPLICATION_JSON) public Response updateCustomer(Customer customer) { Customer updCustomer = customersDAO.updateCustomer(customer); if (updCustomer != null) { return ResponseCreator.success(getHeaderVersion(), updCustomer); } else { return ResponseCreator.error(500, Error.SERVER_ERROR.getCode(), getHeaderVersion()); } } // returns list of customers meeting query params @GET //@Produces(MediaType.APPLICATION_JSON) public Response getCustomers(@QueryParam("keyword") String keyword, @QueryParam("orderby") String orderBy, @QueryParam("order") String order, @QueryParam("pagenum") Integer pageNum, @QueryParam("pagesize") Integer pageSize) { CustomerListParameters parameters = new CustomerListParameters(); parameters.setKeyword(keyword); parameters.setPageNum(pageNum); parameters.setPageSize(pageSize); parameters.setOrderBy(orderBy); parameters.setOrder(Order.fromString(order)); List&lt;Customer&gt; listCust = customersDAO.getCustomersList(parameters); if (listCust != null) { GenericEntity&lt;List&lt;Customer&gt;&gt; entity = new GenericEntity&lt;List&lt;Customer&gt;&gt;( listCust) { }; return ResponseCreator.success(getHeaderVersion(), entity); } else { return ResponseCreator.error(404, Error.NOT_FOUND.getCode(), getHeaderVersion()); } } }</span></span></code> </pre><br><br>  Everything is quite simple - 4 web services depending on the URI and the method by which this URI is pulled, there is a DAO object that is connected in beans.xml and access to the request headers to get for example the custom ‚Äúversion‚Äù header. <br><br>  A thing that works before the service is called: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PreInvokeHandler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RequestHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// just for test int count = 0; private boolean validate(String ss_id) { // just for test // needs to implement count++; System.out.println("SessionID: " + ss_id); if (count == 1) { return false; } else { return true; } } public Response handleRequest(Message message, ClassResourceInfo arg1) { Map&lt;String, List&lt;String&gt;&gt; headers = CastUtils.cast((Map&lt;?, ?&gt;) message .get(Message.PROTOCOL_HEADERS)); if (headers.get("ss_id") != null &amp;&amp; validate(headers.get("ss_id").get(0))) { // let request to continue return null; } else { // authentication failed, request the authentication, add the realm return ResponseCreator.error(401, Error.NOT_AUTHORIZED.getCode(), headers.get("version").get(0)); } } }</span></span></code> </pre><br><br>  Here, in the validate () method, you can check some preconditions, purely for the test, the verification of the custom header in the request is added to the session identifier "ss_id", well, and from the first time even with this header will fall 401. <br><br>  General exceptions handler: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomExceptionMapper</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExceptionMapper</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Exception</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Context</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HttpHeaders requestHeaders; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHeaderVersion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> requestHeaders.getRequestHeader(<span class="hljs-string"><span class="hljs-string">"version"</span></span>).get(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Response </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Exception ex)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(ex.getMessage() + ex.getCause()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseCreator.error(<span class="hljs-number"><span class="hljs-number">500</span></span>, Error.SERVER_ERROR.getCode(), getHeaderVersion()); } }</code> </pre><br><br>  Something is already a bit too much code for the post, there is another helper class for generating a response to the server and a global enum for storing our error codes.  Yes, the deployment descriptor and beans.xml still give here: <br><br>  web.xml: <br><pre> <code class="xml hljs">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">display-name</span></span></span><span class="hljs-tag">&gt;</span></span>service<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">display-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">context-param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-name</span></span></span><span class="hljs-tag">&gt;</span></span>contextConfigLocation<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-value</span></span></span><span class="hljs-tag">&gt;</span></span>WEB-INF/beans.xml<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">context-param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">listener</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">listener-class</span></span></span><span class="hljs-tag">&gt;</span></span> org.springframework.web.context.ContextLoaderListener <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">listener-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">listener</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>CXFServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">display-name</span></span></span><span class="hljs-tag">&gt;</span></span>CXF Servlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">display-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span> org.apache.cxf.transport.servlet.CXFServlet <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">load-on-startup</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">load-on-startup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>CXFServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Here the main interest is the connection of the servlet from Apache - CXFServlet and the standard SprL ContextLoaderListener. <br><br>  beans.xml: <br><pre> <code class="xml hljs">... <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Imported resources for cxf --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"classpath:META-INF/cxf/cxf.xml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"classpath:META-INF/cxf/cxf-extension-jaxrs-binding.xml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"classpath:META-INF/cxf/cxf-servlet.xml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Imported bean for dao --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">import</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"classpath:META-INF/spring/dao.xml"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.test.services.customers.rest.CustomersServiceJSON"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDAO"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersDAO"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"preInvokeHandler"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.test.services.rest.PreInvokeHandler"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bean</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customExceptionMapper"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.test.services.rest.CustomExceptionMapper"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jaxrs:server</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"restContainer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">address</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/customer"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jaxrs:serviceBeans</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ref</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bean</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customersService"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jaxrs:serviceBeans</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jaxrs:providers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ref</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bean</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"preInvokeHandler"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ref</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bean</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"customExceptionMapper"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jaxrs:providers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jaxrs:server</span></span></span><span class="hljs-tag">&gt;</span></span> .........</code> </pre><br><br>  Here, in fact, we set the necessary configuration files for CXF, connected the DAO object, our preprocessor and exception handler, of course, the bin itself with services and set the root for the services. <br><br>  In order to pull services, I used the <a href="https://chrome.google.com/webstore/detail/cokgbflfommojglbmbpenpphppikmonn%3Fhl%3Den-US">REST Console 4.0.2</a> plugin for chrome - the thing is quite simple, the main thing is to set the desired endpoint, custom headers (as I said without ‚Äúss_id‚Äù will always fall 401) and the content type.  For example: <br><br>  Request Body: <br><pre> <code class="hljs pgsql">Request Url: http://localhost:<span class="hljs-number"><span class="hljs-number">8080</span></span>/service/customer Request <span class="hljs-keyword"><span class="hljs-keyword">Method</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> Status Code: <span class="hljs-number"><span class="hljs-number">200</span></span></code> </pre><br>  Request headers: <br><pre> <code class="hljs erlang">Accept: application/json Content-Type: application/json ss_id: <span class="hljs-number"><span class="hljs-number">12312.111</span></span> version: <span class="hljs-number"><span class="hljs-number">12312.111</span></span> ........</code> </pre><br>  Response headers: <br><pre> <code class="hljs pgsql">Status Code: <span class="hljs-number"><span class="hljs-number">200</span></span> <span class="hljs-type"><span class="hljs-type">Date</span></span>: Tue, <span class="hljs-number"><span class="hljs-number">21</span></span> Aug <span class="hljs-number"><span class="hljs-number">2012</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">09</span></span>:<span class="hljs-number"><span class="hljs-number">45</span></span> GMT Content-Length: <span class="hljs-number"><span class="hljs-number">877</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Server</span></span>: Apache-Coyote/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span>: application/<span class="hljs-type"><span class="hljs-type">json</span></span> <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">12312.111</span></span></code> </pre><br>  Response body: <br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"customer"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"89ad5a46-c9a2-493f-a583-d8250ee31766"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"adress"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"contract_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"first_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"serg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"last_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"serg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mail"</span></span>: <span class="hljs-string"><span class="hljs-string">"serg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"phone"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"300ff688-a783-4e6a-9048-8bb625128dc0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"first_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"serg"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"67731ab9-87b1-4ff9-a7e4-618c1f9e8c4c"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"first_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"serg"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"cd5039bb-031f-4697-a70c-ad3e628963dd"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"first_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"serg"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"86da5446-7439-4242-b730-31c8b57a5c7d"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"first_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"serg"</span></span> }, ..........</code> </pre><br><br>  And finally, I wanted to have a ‚Äúbeautiful‚Äù, better say, url to web services we need.  Of course, you can fix server.xml or use some tool for urlRewrite, but in my opinion the easiest way is to pack our web archive in ear and set another root for our web services in application.xml, but in this post I‚Äôm I will not do it already. <br><br>  PS: I hope that this post will be useful to those who want to get acquainted with Java RESTful web services, and the more experienced will advise and criticize! <br></div><p>Source: <a href="https://habr.com/ru/post/150034/">https://habr.com/ru/post/150034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150027/index.html">Practice refactoring in large projects</a></li>
<li><a href="../150028/index.html">Alarm clock for computer in C #</a></li>
<li><a href="../150030/index.html">CSS slider</a></li>
<li><a href="../150031/index.html">Cach√© + Java + Flex. Part 2</a></li>
<li><a href="../150032/index.html">ATLAS experiment - a simplified description of the task and a bit about the detector</a></li>
<li><a href="../150037/index.html">FBI for the first time arrested websites with pirated applications for Android</a></li>
<li><a href="../150038/index.html">Smile to login!</a></li>
<li><a href="../150039/index.html">AMatch, part 2. Error codes, own errors, new callback format</a></li>
<li><a href="../150041/index.html">Class Relationships - From UML To Code</a></li>
<li><a href="../150042/index.html">Andengine: arbitrary landscape with texture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>