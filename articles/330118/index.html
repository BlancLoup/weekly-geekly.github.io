<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>British satellite imagery 2: how it was in reality</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At once I will make a reservation that this post does not bear a large technical burden and should be perceived exclusively in the ‚ÄúFriday history‚Äù mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>British satellite imagery 2: how it was in reality</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/416/a94/0f2/416a940f286b389765a246a3f53f12e6.jpg" alt="image"><br><br>  At once I will make a reservation that this post does not bear a large technical burden and should be perceived exclusively in the ‚ÄúFriday history‚Äù mode.  In addition, the text is full of English words, I don‚Äôt know how to translate some of them, but I don‚Äôt want to translate some of them. <br><br>  Summary of the <a href="https://habrahabr.ru/company/ods/blog/325096/">first part</a> : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. <a href="https://www.gov.uk/government/organisations/defence-science-and-technology-laboratory">DSTL (Science and Technology Laboratory at the Department of Defense of the United Kingdom)</a> held <a href="https://www.kaggle.com/c/dstl-satellite-imagery-feature-detection">an open competition at Kaggle</a> . <br>  2. The competition ended on March 7, the results were announced on March 14. <br>  3. Five of the top ten teams are Russian- <a href="http://ods.ai/">speaking</a> , and all of them are members of <a href="http://ods.ai/">the Open Data Science community</a> . <br>  4. The prize fund of $ 100,000 was shared by the brutal Malaysian <a href="https://www.kaggle.com/kylelee">Kyle</a> , the team of <a href="https://www.kaggle.com/zfturbo">Roman Solovyov</a> and <a href="https://www.kaggle.com/drn01z3">Arthur Kuzin</a> , as well as <a href="https://www.kaggle.com/iglovikov">me</a> and <a href="https://www.kaggle.com/ceperaang">Sergey Mushinsky</a> . <br>  5. Following the results, blog posts were written ( <a href="https://habrahabr.ru/company/ods/blog/325096/">my post on Habr√©</a> , the <a href="https://habrahabr.ru/company/avito/blog/325632/">post of Arthur on Habr√©</a> , <a href="http://blog.kaggle.com/2017/05/09/dstl-satellite-imagery-competition-3rd-place-winners-interview-vladimir-sergey/">our post with Seryoga on Kaggle</a> ), speeches were held at the meetings ( <a href="https://www.youtube.com/watch%3Fv%3DlCcLjPOCof0">my performance at Adroll</a> , <a href="https://www.youtube.com/watch%3Fv%3DEVc2NaiK3hg">my performance at H20.ai</a> , <a href="https://www.youtube.com/watch%3Fv%3D3oG_OqOpHlw%26feature%3Dyoutu.be%26t%3D58m23s">performance by Arthur at Yandex</a> , <a href="https://www.youtube.com/watch%3Fv%3DmR9gnwMaoFA">speech by Eugene Nekrasov in Mail.Ru Group</a> ), written by <a href="https://arxiv.org/abs/1706.06169">tech report on arxiv</a> . <br><br>  The organizers liked the quality of the proposed solutions, but did not like how much they unfastened for this competition.  Kaggle spent $ 500k, while the prize money was only $ 100k. <br><a name="habracut"></a><br>  It was a logical conclusion - to create your own British Kaggle with preference and high school students.  There is not enough knowledge and skills of the engines of science at the Ministry of Defense of the UK and MI6 for serious AI Research, so instead of making a closed party for their own, they organized an open competition, but with muddy rules, namely, everyone can participate, but Only those who are citizens and live in countries that are above a certain cutoff in the <a href="https://www.transparency.org/cpi2014/results">next 2014 corruption rating will</a> apply for the prize.  Why 2014, and not something more fresh?  This is still not clear.  There is a conspiracy thesis that 2014 was chosen precisely to leave the Chinese behind and not to leave the Indians.  But in 2016, India and China have the same rating, so the focus would not have passed. <br><br>  Writing a website imitating Kaggle didn‚Äôt be enough for science engines, so they hired a contractor, namely the <a href="http://www.nytimes.com/2010/02/06/business/global/06bribe.html">British corrupt</a> official BAE Systems. <br><br>  To receive money for the competition, which was discussed in the <a href="https://habrahabr.ru/company/ods/blog/325096/">first part</a> , it was necessary to hold a skype conference with DSTL representatives and briefly describe the solution.  We presented, described.  They frankly floated and, in fact, partly based on this my self-confident assumption that they do not have high-flying specialists.  But by themselves, these British scientists are quite adequate, and at the end of our speech their chief, as an advertisement, mentioned that they, too, were not made with a finger, and that they have <a href="https://www.datasciencechallenge.org/">their own platform</a> for holding competitions, and that two tasks just started , one <a href="https://www.datasciencechallenge.org/challenges/1/safe-passage">for Computer Vision</a> , the other <a href="https://www.datasciencechallenge.org/challenges/2/growing-instability">for Natural Language Processing,</a> and each has a prize fund of 40 thousand pounds (20k, 12k, 8k).  We replied that we were in the know and, in turn, politely asked: ‚ÄúWhy do you have discriminatory rules‚Äù?  The man replied that it was all nonsense, that it was not they, but the contractor who was holding the competition so nagudit, and that DSTL was also against discrimination, that they would change everything and in general, happiness to everyone and everyone. <br><br>  Later we clarified by email how seriously they intend to adhere to the correct party line and received in response: <br><blockquote>  - It is likely to be the case for datasciencechallenge.org.  It was based on legal grounds, but the following feedback was given.  Please do not let it put you off. <br></blockquote>  But in fact, it was all not important.  The idea is that, on the one hand, I strongly sagged on the knowledge in Object Detection and flew into this interview famously.  For example, in Nvidia on self driving car, I flew on the fact that I can do Image Classification, I can do Image Segmentation, but Object Detection, which is very important for many business tasks that use computer vision, is not.  And as you know, it is better to study in battle, so this is necessary either to cut your project in your free time, or to work on some competition. <br><br>  It is worth adding that the task <a href="https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring">about the classification of fish</a> , in which object detection was necessary for me, was due to lack of knowledge, and other tasks that had already begun, but were not finished, that is, <a href="https://www.kaggle.com/c/inte%250Al-mobileodt-cervical-cancer-screening">about cervical cancer</a> , <a href="https://www.kaggle.com/c/noaa-fisheries-steller-sea-lion-population-count">about the counting of fur seals</a> , and ImageNet 2017, were also depressed, forcing the complexes on their own helplessness. <br><br>  Summarizing: <br><br>  1. The fact that the cash prize does not shine for the citizens of Russia was known in advance.  When later this whole story went through the news, this piece went down, since working in the "our hit" mode is much more profitable for the rating.  Yes, there was a hope that the rules would change, but ‚Äúpromise is not to marry,‚Äù so no one expected this much. <br><br>  2. Competitions are 10-100x for specific knowledge per unit of time in machine learning, compared to academic environment or work.  It was very necessary to understand Object Detection, plus, I wanted the pipeline to appear under this type of tasks, as the pipelines have a habit of wandering from problem to problem, transforming many tasks from ‚Äûsomething is somehow understandable, but not very - I draw for a couple of months "in" the task is complicated, it means that the pipeline will take more than one evening, but two. " <br><br><h3>  Formulation of the problem </h3><br>  What is actually required?  It is necessary to create an algorithm that will take satellite images of an unknown city in the UK and find motorcycles, cars and buses of a certain type on them.  From the shadow of the Ferris wheel, it was suggested that this unknown city was London. <br><br>  In the task, about the <a href="https://www.kaggle.com/c/dstl-satellite-imagery-feature-detection">satellites</a> , about which it was told in the first part, everything was difficult with the data: <br><br>  1. Pictures are presented in a heap of various spectral ranges, resolutions, channels are shifted both in time and in space. <br><br>  2. Little data.  Train, public test and private test correspond to different distributions. <br><br>  3. Classes are highly unbalanced.  For example, in a train set, one pixel of a class of machines corresponded to 60,000 pixels of a class of trusses.  Actually, in our decision with Sergey, we completely put the bolt on the typewriters and did not bother with their presence in the Nigerian jungle in which all the action happened just because of problems with the data of this class. <br><br>  It was fascinating and very interesting, but everyone got tired.  The task was with a subdivision and more time was spent not on scientific research, but on fighting engineering mud, part of which was due to the specifics of the data, and partly by unhealthy creativity from the organizers. <br><br>  In the same task, it was the opposite: <br><br>  1. Data is presented in the usual RGB, made from the same height, and almost at the same time. <br><br>  2. Train and test are represented by 1200 pictures (600 and 600), each 2000x2000 in size, at a resolution of 5 cm / pixel.  That is enough to solve the problem, but it does not require a cluster of GPUs and several weeks of training. <br><br>  In standard benchmark datasets tagged under Object Detection, where pundits find out which algorithm is better, objects are marked through the bounding boxes, that is, the coordinates of the rectangle and the class label correspond to each object from the train, and the model, in turn, , predicts the coordinates of the rectangles, the class label and how confident the model is in the prediction. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c87/a9b/606/c87a9b60684a931f9f213b58b2acc84d.jpg" alt="image" width="400"></div><br><br>  The problem with the preparation of such datasets is that these rectangles are drawn around for a long time, and datasets need big ones, so even if you hire markers cheaply, you‚Äôll get long and expensive.  An alternative is the so-called weak labeling, where instead of boxing a dot is placed in the center of the object. <br><br>  The British went exactly along the alternative path, and marked them with dots, and, unlike the standard approach, in which there is an object - there is a label, they added imagination and labeled in the mode - the participants' algorithms will probably find this object - we will mark it. and here the car is half hidden by the crown of the tree, so we will not mark it.  So it is not necessary to do, it greatly complicates the training of models.  But we will write off these distortions on their inexperience. <br><br>  There were 9 classes, namely: <br><br><ul><li>  A - any motorcycles and scooters </li><li>  B - short light cars </li><li>  C - long light cars </li><li>  D - short dark cars </li><li>  E - long dark cars </li><li>  F - short red cars </li><li>  G - long red cars </li><li>  H - white vans </li><li>  I - red and white buses </li></ul><br><img src="https://habrastorage.org/web/28e/0fa/8b1/28e0fa8b1db6404eb43cf857809e5874.png"><br><br>  That is, it is not enough to find a typewriter, it is necessary to classify correctly, plus, not everything must be looked for.  Blue, green, yellow vehicles and other British were not interested. <br><br>  Classes are unbalanced, but the least represented classes, that is, motorcycles, buses and red cars, had pronounced signs, so the network didn‚Äôt strain it much. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/250/97d/7b9/25097d7b9e2740a895706126534fbf39.png" width="400"></div><br>  (Picture provided by Vladislav Kass) <br><br><h3>  Metrics </h3><br>  As an estimate of the accuracy of the model, jaccard similarity was used, where True Positive was counted, if the predicted point was next to the British label, and since the sizes of the objects differed, the distance depended on the class. <br><div style="text-align:center;"><img src="https://habrastorage.org/web/2bf/06f/614/2bf06f614a1a4c76ad9fcb351212cbfe.png" width="400"></div><br>  What we have?  A task that, on the one hand, is standard, and on the other, the devil knows how to approach it.  Alternatively, you can try to go on the shoulders of the team, after all, the guys who got in the Open Data Science slak have overwhelmingly high qualifications in machine learning.  But the fact that the organizers consider the citizens of Russia, Ukraine and Belarus to be second-rate people and that at the same time there is a sea of ‚Äã‚Äãother tasks, where there are no discrimination in the rules and cash prizes more sympathetic, did not add motivation to start working on the task.  In addition, the intensive felling, which was the task of the satellites, led to the fact that many burned out, took a break from the competition and did what was more important, that is, sports and personal life. <br><br>  The team to solve problems more interesting and more efficient, so the task was to figure out for yourself and select the rest for participation.  There was little time left, something around the month. <br><br>  Having plunged into the literature on Object Detection, it became clear that there are a lot of articles about detection through the boxes, and through the points in the centers of mass there are few.  Well, the code implementations that the authors lay out for the case with boxes under each framework are also sufficient, but I did not find anything under the dots during a cursory review. <br><br>  As a result, the first step that was taken was to reduce the unknown task to the standard one, namely, I killed a couple of days at work and circled all the boxes in the train.  I used the <a href="https://sloth.readthedocs.io/en/latest/">sloth</a> for this, although later, after I had already marked everything, I guessed to ask, and the team suggested that there were alternative tools, and for other tasks that were after, I used <a href="https://github.com/tzutalin/labelImg">labelimg</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/09d/bc7/f2f/09dbc7f2fe2444a48f8e8b949a1253f0.png"></div><br>  The markup took about ten hours, which, in principle, a lot, but this investment later helped to easily go to the top, and indeed, to win a prize.  Two tasks were decided at once, first, it became clear on what exactly to focus in the literature and which foreign code to interrupt for this task, and second, what is equally important, immediately added motivation to the guys in chatika, to join the work on the task .  A lot of people did not connect, because, as I mentioned above, equally interesting tasks about cervical cancer and counting fur seals went in parallel.  For example, <a href="https://www.kaggle.com/lopuhin">Konstantin Lopukhin</a> immediately said that there was little time for the task about the British typewriters, but it didn‚Äôt lose the most on the seals by finishing second in that task ( <a href="https://youtu.be/wGlcGWENRSA%3Ft%3D1h11m55s">performance in Yandex with his decision</a> ).  <a href="https://www.kaggle.com/ceperaang">Sergey Mushinsky</a> and <a href="https://www.kaggle.com/vkassym">Vladislav Kassym</a> expressed a desire to get a hand on the task of detecting British typewriters.  Actually, all three of them finished in the top 10. <br><br>  So, a month before the end, the boxes are circled, something needs to be done about it.  There are two main variations on the network architecture for the detection task: <br><br>  1. The family of two stage detectors: R-FCN, Fast-RCNN, Faster-RCNN ‚Äî that is, networks whose pipeline can be divided into two parts: the first is to find areas in the picture that correspond to the objects, and the second is to classify for each areas to determine which object is contained there. <br><br>  2. Family of one stage detectors: YOLO, YOLO9000, SSD - in these architectures the search for areas and classification occurs in one run. <br><br>  A reasonable question arises, what is better and when.  In each article, the authors claim that it is they who are tearing competitors to the British flag.  This approach is understandable, you will not be engaged in aggressive academic cherry picking, overfit to standard benchmarks and try about State Of The Art - you will not receive a grant, your graduate students will not graduate and all the other joys that we now have in an academic environment.  (On this topic, there was a very nice article recently that provided historical background on how we got to this life: <a href="https://www.theguardian.com/science/2017/jun/27/profitable-business-scientific-publishing-bad-for-science">Is it a staggeringly profitable science?</a> ). <br><br>  But these are problems of the academic environment and their local problems.  Here we have a clearly set task, there is a metric, there is a leaderboard on which participants show serious results, and I, besides the boxed boxes, do not have a damn thing.  With a large amount of time and computational resources, one could drive all the architectures through our data and look at what happened, but of course there wasn‚Äôt any time or desire to do this.  But!  The question of when and which networks are good, not tormented me alone.  A couple of years ago, Objects Detection was done exclusively by scientists, but, despite the power of the approach, it had nothing to do with business.  It all came down to the fact that, in contrast to the tasks of classification and segmentation, the detection tasks worked at the speed of an Estonian tortoise, that is, there was no talk of any real time detection.  But it was all a couple of years ago, that is, by the standards of Deep Learning, a long time ago.  Since then, many improvements have been made and now companies are actively using Object Detection to earn their trillions. <br><br>  So, at one time, pundits who work at Google took advantage of the fact that everything is fine with their computing resources and wrote a <a href="https://arxiv.org/abs/1611.10012">review article</a> in 11 authors in which, on the one hand, not a single new idea, and on the other, it has tremendous value, anyway among me.  In this article, the authors drove the Faster RCNN and SSD with various base feature extractions and analyzed the results for speed and accuracy. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/4c1/0de/523/4c10de52349f4fcc95a49abe22e605dd.png" width="500"></div><br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/356/cfc/5f7/356cfc5f7716437e9b5d4b79bc31af54.png" width="500"></div><br><br>  The article says that Faster RCNN is more accurate, especially on small objects, and the SSD predicts more brightly.  And the difference in the speed of predictions between them, in my opinion, passes just between "you can not shove in production" and "you can shove in production".  From the couch, I don‚Äôt really imagine what tasks you can shove Faster RCNN into, but I‚Äôm happy to hear about the success story in the comments. <br><br>  I took the word for this article, not because I like to take a word and not because Google writes more about its name when writing articles and, as a result, speaks more about the matter, but simply because there was no big choice.  There was very little time left for the end of the competition. <br><br>  For the above reason, namely - greater accuracy in the detection of small objects, the motorcycles in the pictures were extremely small, the choice fell on the Faster RCNN. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/af0/a27/429/af0a27429eb557d460243dc31ca30cae.png" alt="image" width="400"></div><br><br>  Cool.  I read literature, something began to clear up, but reading was not enough.  From the fact that some contours began to appear in my head and the mosaic began to gradually form into the big picture, you would not appear on the leaderboard.  You need to write code.  No code - no conversation. <br><br>  Detection is not a classification, it is hard to write from scratch, a bunch of nuances, a sea of ‚Äã‚Äãmystical parameters that the authors selected for months, so usually someone else‚Äôs code is taken and adapted to fit their data.  There are many different frameworks for working with neural networks, each with its own pros and cons.  At the beginning of work on this task, I felt most comfortable with Keras, at which we with Sergey and dragged the previous competition.  <a href="https://github.com/yhenon/keras-frcnn">No sooner said than</a> done, <a href="https://github.com/yhenon/keras-frcnn">the Faster RCNN implementation on Keras is taken</a> and interrupted by our data.  Training starts, something converges, but it is sooooo slow.  Somehow you get used to the fact that in other tasks dozens of pictures fly through the network per second, but this is not at all the case.  The fact that the Faster RCNN is slow and the fact that Tensorflow does not go off-scale in terms of performance, plus the overhead that comes from Keras, as from the wrapper. <br><br>  Something was practiced somewhere, it came together, a prediction, a leaderboard and I am the tenth with a result of 0.49.  The fact that I am in the top ten is good, but the fact that the guys in the first three have 0.8+, that is, the gap is quite large - this is not very. <br><br>  Keras is nice and pleasant, clean code, understandable code base, but it is slow and data parallelization is done with more pain than you want.  All winter I worked on the previous task, using one GPU, and already closer to the end I bought the second one.  Two GPUs - this is very convenient, at a minimum, it allows you to test two ideas at the same time, and even if there are no ideas, you don‚Äôt have to idle the hardware - you can always mine cryptocurrencies on these GPUs, which most likely solves many who solve puzzles on the Deep Learning, in his free time from training models. <br><br>  In this case, the idea is the same - to train Faster RCNN.  The network is training slowly, I have two GPUs, the implementation on Keras is slow and tricky, you can parallelize it, but with pain.  Now a lot of work is being done to enable Data Parallelization to be done on several GPUs with the little finger of the left leg.  As I understand it, at the moment the developers of mxnet and pytorch have successfully coped with this task. <br><br>  In this problem, the cards are laid down so that the choice fell on mxnet.  He is really fast in itself, he really easily parallels the little finger of his left foot.  These were pluses, from minuses - the feeling that he was written by aliens.  Probably, the effect that mxnet itself and the Faster RCNN implementation were unusual for me, but nevertheless, there are problems with taking a step to the side - a dark forest at once, there is not enough documentation, they did not leave from beginning to end.  It was saved by the fact that Sergey and Vladislav were doing exactly the same thing and through the wilds of mxnet I was torn as a part of a group, and not one. <br><br>  On this the technical part could be completed.  In fact, the application of the implementation of Faster RCNN on mxnet instantly brought to the region 0.8+.  The training was carried out on crops 1000x1000 in size, which were augmented by turns at angles multiple to 90 degrees + reflections (transformations from the D4 group).  In the prediction, the original 2000x2000 images were cut into intersecting 1000x1000 pieces.  After this, Non Maximum Supression was used to combat the effect, when the same box was predicted in different tiles.  After that, each box was the center of mass, and it went into the final prediction. <br><br>  At a certain point, despite the fact that everywhere in the literature it is stated that the Resnet 152 as a feature extractor works better than the VGG 16, it turned out that the generally accepted point of view on this task does not work.  Someone on the fool tried to use VGG 16 and this markedly improved the result.  Later, in another conversation, <a href="https://www.kaggle.com/bobutis">bobutis</a> , who in the composition of the team won the task <a href="https://www.kaggle.com/c/the-nature-conservancy-fisheries-monitoring">of classifying fish</a> and <a href="https://www.kaggle.com/c/intel-mobileodt-cervical-cancer-screening">cervical cancer</a> using Faster RCNN, confirmed that in practice, VGG as a feature extractor works better. <br><br>  In this task there were such pure data and their number was chosen so well that the network worked beyond my expectations.  Particularly pleased cases when from under the tree or from under the bridge stuck alone lights. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/720/496/6fa/7204966fadf449cb85c44eeeb4396cec.jpg" width="400"></div><br>  Where did the network have problems?  As expected, tightly packed objects were poorly predicted.  There is also a lot of literature on this subject, but in general, the detection of tightly packed objects is another task. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/33c/457/790/33c457790f02437f9b21a3ed9fd7e0c7.jpg" width="400"></div><br>  On the <a href="https://www.kaggle.com/c/noaa-fisheries-steller-sea-lion-population-count">task of counting fur seals, the</a> approach did not go through detection, it was precisely because of the tight packing that the people decided through segmentation, comparing each seal to a Gaussian and segmenting the resulting heatmap. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/15f/b33/08a/15fb3308a0a3f85c84550670c3fc4aa6.png" alt="image" width="400"></div><br>  Sometimes, but extremely rarely, the network tried to pass trash for objects of interest to us. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/bbd/d07/4c4/bbdd074c48774dd6b6912f4d53187af3.png" width="400"></div><br>  At the same time, the accuracy of my model is jaccard = 0.85, for <a href="https://www.kaggle.com/ironbar">ironabar</a> , which is 0.87 in the first place, but not 0.98-0.99.  Offhand, we made a mistake with about 1200 typewriters - and this is a lot, especially considering that I had a strong impression that the network works more precisely on this task and on this data than manual markup (for the first time I come across this in practice). <br><br>  I think what happened is this: <br><br>  1. Many classes are difficult to distinguish visually, a gray car in the shade may look like a dark one, and in the sun like a light one.  Blue and bluish cars, too, quite easily, could fall into the wrong class.  And this affected both in training and in prediction. <br><br>  2. The organizers defined the classes in a rather strange manner - not, say, a white sedan or hatchback, but a white long or short car.  With a visual assessment, even if the question of color is put aside, there are many borderline cases that are not obvious which class to assign.  Even white vans cannot always be distinguished from short white cars. <br><br>  3. Convertibles, despite the fact that they look dark from above, belong to the class to which the main coloring corresponds, that is, what a passerby would say if he were asked the color of the car.  It is not a problem if there were many such cabriolets in a train, but the number of cabriolets in London, frankly, does not exceed the limit. <br><br>  4. The organizers showed creativity and decided to simplify the task for the participants, that is, they broke the cases into simple and complex, and introduced some internal rules for this, that is, if the car is on the edge and part of the trunk goes beyond the edge of the picture, they did not take it into account in train, in test, something similar can be said about cars that are half hidden by trees.  As a result, it added noise to the markup, that is, the network during training didn‚Äôt click on False Positive in the wrong way, reducing its predictive power and some predicted cars were classified as False Positive when calculating jaccard on the competition site. <br><br>  Mid May.  The competition is over, I am the third on Public LB, the second is on Private - the organizers write a letter asking to provide: <br><blockquote>  Please send the following information to general@datasciencechallenge.org: <br>  Full name <br>  Nationality <br>  Telephone contact details <br>  For the winner announcements <br>  Passport details (scan / photo of details page with photo) <br>  Proof of address (eg. Scan / photo of a utility bill) <br>  Bank account details (IBAN, Account Number and Sort Code) <br></blockquote>  The rules say that if you are a citizen of Russia, then they will give you money.  But I will not lose clarification with me, I wrote a letter in which I wrote in English and white that I am a citizen of Russia, I live in San Francisco, USA, I have an American bank and ask a logical question: ‚ÄúWill we pay the prize money‚Äù?  In response, I receive an email that comes down to what was expected: ‚ÄúNo, there will be no prizes, because, despite the result, according to the rules, you did not come out with the color of your passport‚Äù. <br><blockquote>  ... Clause 2.3b because we have a score below 37. Thank you for your opinion. follow the criteria in the UK. <br>  ... <br></blockquote>  The answer was expected, so it was not insulting.  But!  The very fact of having all these restrictions on the place of residence and on citizenship ran out from the very beginning.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is clear that in this competition it so happened, but since they position themselves as another copy of Kaggle, I would very much like to click on the nose to increase the chances that they will think in the future before running competitions with unhealthy rules. How to click - it is not clear. I wrote something on their forum, added a couple of lines to a </font></font><a href="http://blog.kaggle.com/2017/05/09/dstl-satellite-imagery-competition-3rd-place-winners-interview-vladimir-sergey/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog post on Kaggle about satellite imagery</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , even though no one reads this blog, but to clear my conscience. I posted my first and only </font></font><a href="https://twitter.com/viglovikov/status/865730009733898240"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">twitter </font></font></a><font style="vertical-align: inherit;"></font><a href="https://t.co/aVwA2GGNmN"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">post</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font><a href="https://t.co/aVwA2GGNmN"><font style="vertical-align: inherit;">an angry facebook post</font></a><font style="vertical-align: inherit;"> . I repent. Even when I wrote, I realized that those who are not aware of the details will perceive the text as: "The vile British at the last moment changed the rules and threw me for money."</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I also dropped the link to the post on facebook and twitter in the ODS. At this, the duty to the world scientific community was completed, for it is not clear what else to do in order to click on the nose, and with these thoughts I went to sleep. To be honest, I underestimated the power of ODS, someone repostnul, someone liked, word for word, the next day this story appeared somewhere in the telegram, on some small news sites, and then it all finally got out of control . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I no longer remember the chronology of events, I only remember how at a certain point I am sitting at work, and instead of training the next model, I read the #_random_flood channel and this is perceived as front-line reports. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The people monitored various media outlets and threw off what flew by on the news. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">They tried to contact me:</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Russia Today - I refused to give an interview on camera, but answered a couple of questions by email. And this was enough for them to </font></font><a href="https://www.rt.com/uk/389545-data-challenge-russian-disqualified/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">note</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Channel One - they attacked all my Russian-speaking friends on Facebook and VK with a request to help contact me. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Channel Five - tried to contact me, did not work; tried to contact my parents, did not work; went to school and interviewed the teachers. I strongly hope that the teachers did not snap their beaks and knock out the add-on. financing. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. Ren TV - they wanted something from a series of their standard programs about aliens and other exotic things, namely, that I became the central character of the release of the program ‚ÄúCaution: Russians!‚Äù. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Komsomolskaya Pravda - they released not only the electronic, but also the paper version.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. I got home </font></font><a href="https://lenta.ru/news/2017/05/22/prizeforbritains/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lenta.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Not for long, but nonetheless. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7. Some completely unknown channels like ‚ÄúTsargrad TV‚Äù also tried to communicate, but they all disappeared in the avalanche of everyone who tried to contact me. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I did not watch it myself, but the people said that the fact that I refused to work for the camera did not stop the television crews. </font><font style="vertical-align: inherit;">They still released stories, adding my photo to the background. </font><font style="vertical-align: inherit;">Well, as usual, they invited some incomprehensible characters to express their expert assessment on what is happening.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There was no great desire to communicate with all these people. </font><font style="vertical-align: inherit;">The purpose of my post on Facebook is to click the British so that their brains move faster and that in the future they create less discriminatory competitions, and not become the central character of news stories like: ‚ÄúScandals.</font></font> Intrigue.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Investigations. I have never worked for the camera, plus, I have a sin to say what I think, and you should probably not do that for the camera. Yes, and what I say and what can happen after installation - these are two big differences, so despite the natural adventurism inherent in me, I did not fit into this.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Against the background of all this, I‚Äôm not afraid of the word, the flock, Mail.Ru Group stood out very nicely. They wrote me in plain text: ‚ÄúWe are ready to pay money instead of the British. How to contact you?". As I wrote, I did not expect to receive money from this competition, but I liked the approach itself. It is clear that for them it is PR, and it is cheap enough, but at the same time, in my opinion, this is a beautiful move. With this approach, they expressed their respect, which looked very good at the contrast with all the others, for whom ‚Äúgiving us an interview is a great honor‚Äù. We talked. The text of the press release from them was ready and within 30 seconds after I gave the go-ahead, it was published. Carefully, without hysterics, without "ours are beating", everything is in the case, as it should be a serious company.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intelligence reported that in the Mail.Ru Group itself, this decision was met ambiguously, which, in general, is expected. In fact, we have: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. What is the left guy who does not work in Mail.Ru Group. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Does not live in Russia. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Participated in the competition, which was held by British intelligence. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. According to the rules of the money should not get. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Instead of spending this money and sending workers who plow like negros on the plantations from morning till evening, to some conference, several monthly salaries of a typical Data Scientist are allocated to this left pepper.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The logic is definitely there. And I apologize to the guys whom all this has upset me. In my defense, I want to say that for the allocation of money for conferences and for PR, various departments are responsible, and that, nevertheless, for healthy PR, the money is small, so it should remain at the conference. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Money allocated, it is nice. But you can not take them, they are toxic. Although, again, let's be honest, if it was not about 12 thousand pounds, but about 120, I would probably take it.</font></font> Or not?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">God knows. But 1,200,000 just would take. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Money had to do something. Someone on the #_random_flood channel offered to donate them. I liked this idea. Very much annoying lack of funding in basic science. On the one hand, this is logical, because by and large people are paid for the very fact of their existence, hoping that at one fine moment there will be some kind of breakthrough, something big. And there are more than enough examples of such breakthroughs in history, but financing, that in Russia, that abroad, basic science, frankly, is not a fountain. So the idea to donate this money to Russian science has matured. Where to donate? God knows. When I studied in Russia, I did not apply for grants, and it was a long time ago, everything changed ten times. Who is more supportive? Who saws less?</font></font> I do not know.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Googled some funds, chose to fool RFBR. Attempts to contact them were unsuccessful. Maybe they really are fine with money and don‚Äôt accept donations. But the Russian Science Foundation agreed to take the money, although it clarified who was the organizer of the competition. Strangely enough, the answer ‚ÄúBritish intelligence‚Äù completely suited them. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As soon as the news passed that I donated a prize of twelve thousand pounds to science, the people approved, but not all. For example, a sister who is also a physicist, though an experimenter and whose funding depends on grants, wrote me an angry letter about what I did wrong and that everything was cut and that she was angry.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, this whole story was on the verge of a foul. I got a ride on the news as an offended Russian genius, and could just ride like a traitor to the motherland. He lives abroad, he developed algorithms based on British intelligence data - this is already behind the eyes. If you would like, you could wind up a lot on this topic and the fact that it was an open international competition would no longer concern anyone. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Did the money transfer? As far as I know, yes. It took more than a month, but recently I received a confirmation that the money was already in the fund. Again, I would like to hope that at least one of them will reach the engines of science themselves.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Messages came from those who reacted negatively to the fact that I live and work abroad. I ignored these messages, but let it be, I will answer them here and I will answer like this: after the demob, when I came to the military registration and enlistment office, the military commissary issued me a war veteran certificate, a medal for military prowess, shook the hand and said that Motherland is proud of me. Even if this is not the case, from that moment on I believe that I have paid all the debts for two years of military service. And this is the question with who, to whom and what should, I consider closed. Another question is why it is often easier to move science abroad than in Russia, but this is a separate problem and a detailed analysis, probably, needs to be done in another post and hopefully, I‚Äôll get my hands on it.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From funny. Quite a lot of girls wanted to be added to friends on facebook or VK. Many are very pretty. But at the same time just came the notice that someone wanted to add, without a message. So boring. But if any girl wrote a variation on the topic: ‚ÄúVladimir, you are probably hard now, such stress, come to visit me for a glass of wine, I‚Äôll invite a friend‚Äù - that would be more interesting, and, at least, I would interpret this, that the girl is confident in herself, knows how to achieve what she wants, in general, is not like everything in the good sense of the word. But the maximum that was: "You look" lightly "atypically for a programmer." Somehow even without a spark.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On this note, this post can and finish, but there are a couple of events that I want to add. One guy who lives in London and who himself experienced British nationalism in his own way, connected me with a journalist who works in some small British news publication and spoke with me, this journalist published a </font></font><a href="https://www.theregister.co.uk/2017/06/05/russian_denied_dstl_data_sci_challenge_prize/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">note</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> about these events </font><a href="https://www.theregister.co.uk/2017/06/05/russian_denied_dstl_data_sci_challenge_prize/"><font style="vertical-align: inherit;">on his website</font></a><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The organizers of the competition, despite the fact that they were not going to pay the prize, asked to raise the EC2 instance on Amazon, reproduce the decision, write the documentation and make a presentation, and for this they promised to mention my name on their website. I politely refused. But during the exchange of emails on this topic, it turned out that the journalists, that ours, that the British, tried to contact DSTL and asked questions to which they did not have beautiful answers. I do not know whether the anti-discriminatory click on the nose was successful or not, but I would like to hope that yes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Towards the middle of June, they wrote an email and said that no matter what, no one takes my second place from me, and asked for my photo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I was very much tempted to send a photo with a bear cub with the words: ‚ÄúAnd when I‚Äôm free from machine learning, I grow a bear, once again you will be discriminated against - he will eat you‚Äù. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/765/c2b/870/765c2b87029241ef8a9402c2a7114482.jpg" width="400"></div><br>  I sent the photo with the bear to them, although the wording softened and removed emotions from it.  In the final <a href="https://www.datasciencechallenge.org/challenges/1/safe-passage">press release,</a> they mentioned me, but for some reason they didn‚Äôt show clumsy toes. <br><br>  In parallel with all this history, a <a href="https://www.kaggle.com/c/zillow-prize-1">competition with a prize of $ 1,200,000</a> started on Kaggle, where for some reasons the Chinese were cut off, the team did not approve, the rules were changed, and everything seemed normal. <br><br>  About a month ago, another <a href="https://www.kaggle.com/c/passenger-screening-algorithm-challenge">open Kaggle competition</a> kicked off and was also discriminatory.  The prize is $ 1,500,000, but only US citizens and Green Card holders can apply for it, that is, this time not only China and Russia are left behind, but the European Union, the United Kingdom, Canada, Australia, Israel and everyone else who usually does not have the United States. leaves.  Seryoga on this topic wrote <a href="https://www.kaggle.com/c/passenger-screening-algorithm-challenge/discussion/35118">an angry text on the forum</a> , and judging by the number of upvotes, the team is mostly in agreement with him.  I was also noted and immediately a certain American journalist contacted me and even published a <a href="https://undark.org/article/kaggle-data-science-dhs/">text on this subject</a> . <br><br>  When I contacted the administrator of this new competition and politely said: ‚ÄúHow did it happen?  You were always for meritocracy. ‚Äù  He replied something flowery, but in essence the answer came down to two words: "We have sold out." <br><br>  I plan to participate in this competition.  It ends in a few months, let's see how it goes.  The task is rather evil, but if something sticks together, it is possible that there will be a second part of Marlezonsky ballet.  In the end, when you drown against discrimination, you hear better from prizes than you did when the damn thing didn't work out. <br><br>  And what about knowledge?  I now have a lot of knowledge in Deep Learning in various areas, at least they have enough for such a story: <br><br>  In early May, through Kaggle, I was contacted by a Tesla recruiter, who was looking for specialists for the position of AI Researcher.  I agreed to interview for this job.  Famously passed the take home test, both tech screen, onsite interview, had a good talk with his potential supervisor Andrej Karpathy, had to go through background check and that Elon Musk would approve my application.  And just at the background check stage I was cut off.  The recruiter told me that I had broken the Non Disclosure Agreement, and that I had talked about the interview process somewhere and that there would be no offer.  It was unexpected, but in a more expanded form this bike, I will probably tell you when I will write the third part of the epic about office plankton. <br><br>  Special thanks to Sergey Mushinsky and Vladislav Kassym for helping to work on this task, Sergey Belousov, for answering my stupid questions on Object Detection, without his help, I would hardly have had a chance to understand the topic so well in a month, and also Julia Semenova for assistance in the preparation of this text. </div><p>Source: <a href="https://habr.com/ru/post/330118/">https://habr.com/ru/post/330118/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330106/index.html">20 free utilities and 89 scripts for monitoring and managing databases</a></li>
<li><a href="../330108/index.html">How to work with reviews in the App Store (and with negative ones too)</a></li>
<li><a href="../330112/index.html">Dotty is on the threshold</a></li>
<li><a href="../330114/index.html">TOR network in Russia is fully controlled by the FSB</a></li>
<li><a href="../330116/index.html">Security Week 22: Vulnerability was found in Samba, ShadowBrokers opened a subscription to exploits, phishers massively mastered HTTPS</a></li>
<li><a href="../330120/index.html">Data recovery from an external hard drive Seagate FreeAgent Go</a></li>
<li><a href="../330122/index.html">‚ÄúAn interesting topic for discussion is the relativity of test coverage‚Äù: T-Systems about testing</a></li>
<li><a href="../330124/index.html">Orange Pi on car wash part 3</a></li>
<li><a href="../330126/index.html">Electronic signature in Bitrix24. Theory and experience of implementation</a></li>
<li><a href="../330128/index.html">Single Line Diagrams in Revit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>