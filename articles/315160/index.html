<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Terminal Server Scan Free</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At work, we set the task of transferring several employees to a terminal server so that everything is done on it, including scanning from a local scan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Terminal Server Scan Free</h1><div class="post__text post__text-html js-mediator-article">  At work, we set the task of transferring several employees to a terminal server so that everything is done on it, including scanning from a local scanner.  The user is working in Windows.  It would be possible to forward USB, but drivers for Windows Server did not have this model of scanner. <br><br>  I searched the network for Scan over RDP, found programs like Scan Redirector RDP Edition, TSX Scan, etc., for which they want around a hundred or so bucks for 1 license, it seems they have even seen for 800 bucks. <br><br>  I do not like unlicensed software, so I decided to implement myself: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/390/b81/532/390b815322ed468089ce2c503998ffe1.png"><br><a name="habracut"></a><br>  Here you see the main page for managing a remote scanner.  The advantage of my decision is that there is absolutely no need to install anything on the terminal server (or any other computer from which you want to scan), you just need a browser. <br><br>  If you click New JPG scan, you will see the following: <br><br><img src="https://habrastorage.org/files/5f6/4c8/0d3/5f64c80d3a3b481aad7421b8e5daceee.png" alt="image"><br><br>  And then: <br><br><img src="https://habrastorage.org/files/6f8/086/ed7/6f8086ed7d5241028ccc6ca76487fb10.png" alt="image"><br><br>  The picture can be saved by the right button.  Click New PDF scan: <br><br><img src="https://habrastorage.org/files/155/29a/f7d/15529af7dbcf401c8a0213ac24129a72.png" alt="image"><br><br>  Click a couple of times Scan PDF next page: <br><br><img src="https://habrastorage.org/files/e53/05b/06e/e5305b06e37344efa83b301f7d7d0ee1.png"><br><br>  By clicking on the picture we see it in full screen: <br><br><img src="https://habrastorage.org/files/cc4/e19/acf/cc4e19acf9ba400a86d3fd456d8c12dc.png"><br><br>  Click Delete page 2: <br><br><img src="https://habrastorage.org/files/d8a/aa4/1af/d8aaa41af3d24879a4cc9f0187071b6e.png"><br><br>  Click Make PDF: <br><br><img src="https://habrastorage.org/files/d5a/26a/8ff/d5a26a8ffce44a60a04ab58f00c71f8e.png"><br><br>  Click Browse images: <br><br><img src="https://habrastorage.org/files/165/6bb/d32/1656bbd32963426cb03a1bbd489c5cb7.png"><br><br>  Here you can view everything that was scanned before.  Somehow it works.  Any TWAIN-compatible scanner is supported.  Tested in Chrome. <br><br>  I have little experience in development, so the code is probably written in the worst traditions of all.  Kick in the comments. <br><br>  Security is minimal: so that the scanner is not used by an outsider, the file is called scan57578.php (the name can be changed to something else).  And in index.php write "Access denied". <br><br>  What should I install on a computer with a scanner? <br><br>  As you may have guessed, we need a web server.  I used <a href="http://www.denwer.ru/">Denwer</a> , which in this case is from a gun on sparrows, but you can use any other with PHP support.  At the same time, it will be necessary to correct the code accordingly, since it uses the Denver paths (the Z: drive, etc.). <br><br>  What else is needed: the <a href="http://www.gssezisoft.com/main/product/cmdtwain/">CmdTwain</a> program, which actually scans from the command line, and the console utility <a href="https://sourceforge.net/projects/jpeg2pdf/">jpeg2pfg</a> .  Install CmdTwain, run CmdTwain \ Select Source from Start, and select our scanner.  Install Denver, agree with everything by default. <br><br>  Then, on the Z drive, you need to find php.ini and set the parameter max_execution_time = 130. Select the value, measuring how long one scan takes on your scanner.  Then Restart Denwer.  We take the Start Denwer shortcut from the desktop and throw it into autoload.  We set the computer a static IP. <br><br>  Create a folder in the Z: \ home folder with the name equal to the IP of the computer.  In my case, the folder is called 10.74.0.98.  In it we create a folder www, and in it a folder in which scans will lie.  In my case, it is called scans.  The full path looks like this: Z: \ home \ 10.74.0.98 \ www \ scans. <br><br>  The web server is configured.  Next, create a folder Z: \ jpeg2pdf.  In it, copy the jpeg2pdf.exe that you downloaded from the link I gave above.  And also create a file makepdf.bat in it with the following contents: <br><br><pre><code class="hljs tex">@echo off z: cd z:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">home</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span></span>10.74.0.98<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">www</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scans</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span></span>1 z:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jpeg</span></span></span></span>2pdf<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jpeg</span></span></span></span>2pdf.exe -z none *.jpg -o <span class="hljs-comment"><span class="hljs-comment">%1.pdf move *.pdf ..</span></span></code> </pre> <br>  Fix the IP on the desired one.  This file creates a PDF from a set of JPG.  As a parameter, it is passed the name of the folder with this set. <br><br>  In the Z: \ home \ 10.74.0.98 \ www folder, place index57578.php (or whatever you want to call it) with the following content: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $ip = <span class="hljs-string"><span class="hljs-string">'10.74.0.98'</span></span>; $pagename = <span class="hljs-string"><span class="hljs-string">'scan57578.php'</span></span>; $folder = <span class="hljs-string"><span class="hljs-string">'scans'</span></span>; $jpeg2pdf = <span class="hljs-string"><span class="hljs-string">'z:\\jpeg2pdf\\makepdf.bat'</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;html&gt; &lt;script&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_GET</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(key)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = window.location.search; s = s.match(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RegExp(key + <span class="hljs-string"><span class="hljs-string">'=([^&amp;=]+)'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s ? s[<span class="hljs-number"><span class="hljs-number">1</span></span>] : <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gettime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curr_date = d.getDate(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (curr_date &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) curr_date = <span class="hljs-string"><span class="hljs-string">'0'</span></span>+curr_date; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curr_month = d.getMonth() + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (curr_month &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) curr_month = <span class="hljs-string"><span class="hljs-string">'0'</span></span>+curr_month; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curr_year = d.getFullYear(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curr_hour = d.getHours(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (curr_hour &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) curr_hour = <span class="hljs-string"><span class="hljs-string">'0'</span></span>+curr_hour; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curr_min = d.getMinutes(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (curr_min &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) curr_min = <span class="hljs-string"><span class="hljs-string">'0'</span></span>+curr_min; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curr_sec = d.getSeconds(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (curr_sec &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) curr_sec = <span class="hljs-string"><span class="hljs-string">'0'</span></span>+curr_sec; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> curr_year+<span class="hljs-string"><span class="hljs-string">'-'</span></span>+curr_month+<span class="hljs-string"><span class="hljs-string">'-'</span></span>+curr_date+<span class="hljs-string"><span class="hljs-string">'-'</span></span>+curr_hour+<span class="hljs-string"><span class="hljs-string">'-'</span></span>+curr_min+<span class="hljs-string"><span class="hljs-string">'-'</span></span>+curr_sec; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jpgclick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ document.getElementById(<span class="hljs-string"><span class="hljs-string">'scanprogress'</span></span>).style.display = <span class="hljs-string"><span class="hljs-string">'block'</span></span>; document.getElementById(<span class="hljs-string"><span class="hljs-string">'scanjpg'</span></span>).href=<span class="hljs-string"><span class="hljs-string">'/&lt;?=$pagename?&gt;?scantype=jpg&amp;time='</span></span>+gettime(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pdfclick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ document.getElementById(<span class="hljs-string"><span class="hljs-string">'scanprogress'</span></span>).style.display = <span class="hljs-string"><span class="hljs-string">'block'</span></span>; document.getElementById(<span class="hljs-string"><span class="hljs-string">'scanpdf'</span></span>).href=<span class="hljs-string"><span class="hljs-string">'/&lt;?=$pagename?&gt;?scantype=pdf&amp;time='</span></span>+gettime(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pdfnextclick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ document.getElementById(<span class="hljs-string"><span class="hljs-string">'scanprogress'</span></span>).style.display = <span class="hljs-string"><span class="hljs-string">'block'</span></span>; document.getElementById(<span class="hljs-string"><span class="hljs-string">'pdfnext'</span></span>).href=<span class="hljs-string"><span class="hljs-string">'/&lt;?=$pagename?&gt;?scantype=pdf&amp;time='</span></span>+$_GET(<span class="hljs-string"><span class="hljs-string">'time'</span></span>); } &lt;/script&gt; &lt;body&gt; &lt;div style=<span class="hljs-string"><span class="hljs-string">"font-size: 150%"</span></span>&gt;     &lt;a id=<span class="hljs-string"><span class="hljs-string">"scanpdf"</span></span> href=<span class="hljs-string"><span class="hljs-string">"#"</span></span> style=<span class="hljs-string"><span class="hljs-string">"color: #00C"</span></span> onclick=<span class="hljs-string"><span class="hljs-string">"pdfclick()"</span></span>&gt;<span class="hljs-keyword"><span class="hljs-keyword">New</span></span> PDF scan&lt;/a&gt;        &lt;a id=<span class="hljs-string"><span class="hljs-string">"pdfnext"</span></span> href=<span class="hljs-string"><span class="hljs-string">"#"</span></span> style=<span class="hljs-string"><span class="hljs-string">"display: none; color: #00C"</span></span> onclick=<span class="hljs-string"><span class="hljs-string">"pdfnextclick()"</span></span>&gt;Scan PDF next page&lt;/a&gt;        &lt;a id=<span class="hljs-string"><span class="hljs-string">"makepdf"</span></span> href=<span class="hljs-string"><span class="hljs-string">"/&lt;?=$pagename?&gt;?scantype=makepdf&amp;time=&lt;?=$_GET['time']?&gt;"</span></span> style=<span class="hljs-string"><span class="hljs-string">"color: #000; display: none"</span></span>&gt;Make PDF&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;     &lt;a id=<span class="hljs-string"><span class="hljs-string">"scanjpg"</span></span> href=<span class="hljs-string"><span class="hljs-string">"#"</span></span> style=<span class="hljs-string"><span class="hljs-string">"color: #00C"</span></span> onclick=<span class="hljs-string"><span class="hljs-string">"jpgclick()"</span></span>&gt;<span class="hljs-keyword"><span class="hljs-keyword">New</span></span> JPG scan&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;     &lt;a href=<span class="hljs-string"><span class="hljs-string">"/&lt;?=$folder?&gt;/"</span></span> target=<span class="hljs-string"><span class="hljs-string">"_blank"</span></span> style=<span class="hljs-string"><span class="hljs-string">"color: #090"</span></span>&gt;Browse images&lt;/a&gt; &lt;/div&gt; &lt;br /&gt;&lt;br /&gt; &lt;div id=<span class="hljs-string"><span class="hljs-string">"scanprogress"</span></span> style=<span class="hljs-string"><span class="hljs-string">"position: absolute; left: 0; top: 0; width: 100%; height: 100%; background: white; display: none"</span></span>&gt; &lt;h1 style=<span class="hljs-string"><span class="hljs-string">"position: absolute; left: 20%; top: 30%"</span></span>&gt;Scanning in progress. Don<span class="hljs-string"><span class="hljs-string">'t close browser tab.&lt;/h1&gt; &lt;/div&gt; &lt;?php if($_GET['</span></span>scantype<span class="hljs-string"><span class="hljs-string">']=='</span></span>jpg<span class="hljs-string"><span class="hljs-string">') { $filename = '</span></span>Z:\\home\\<span class="hljs-string"><span class="hljs-string">'.$ip.'</span></span>\\www\\<span class="hljs-string"><span class="hljs-string">'.$folder.'</span></span>\\<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">'].'</span></span>.jpg<span class="hljs-string"><span class="hljs-string">'; if(!is_file($filename)){ $cmd = '</span></span><span class="hljs-string"><span class="hljs-string">"C:\Program Files\GssEziSoft\CmdTwain\CmdTwain.exe"</span></span> <span class="hljs-string"><span class="hljs-string">"'.$filename.'"</span></span><span class="hljs-string"><span class="hljs-string">'; system($cmd); } echo ('</span></span>&lt;a href=<span class="hljs-string"><span class="hljs-string">"/'.$folder.'/'.$_GET['time'].'.jpg"</span></span>&gt;&lt;img style=<span class="hljs-string"><span class="hljs-string">"height: 80%"</span></span> src=<span class="hljs-string"><span class="hljs-string">"/'.$folder.'/'.$_GET['time'].'.jpg"</span></span> alt=<span class="hljs-string"><span class="hljs-string">"Picture"</span></span> /&gt;&lt;/a&gt;<span class="hljs-string"><span class="hljs-string">'); } if($_GET['</span></span>scantype<span class="hljs-string"><span class="hljs-string">']=='</span></span>pdf<span class="hljs-string"><span class="hljs-string">') { if($_GET['</span></span>delete<span class="hljs-string"><span class="hljs-string">']!='</span></span><span class="hljs-string"><span class="hljs-string">') { $i = -2; $files = scandir($folder.'</span></span>/<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">']); foreach($files as $filename) { $i++; if ($filename[0] == '</span></span>.<span class="hljs-string"><span class="hljs-string">') continue; if ($_GET['</span></span>delete<span class="hljs-string"><span class="hljs-string">'] == $i) system('</span></span>del <span class="hljs-string"><span class="hljs-string">'.'</span></span>Z:\\home\\<span class="hljs-string"><span class="hljs-string">'.$ip.'</span></span>\\www\\<span class="hljs-string"><span class="hljs-string">'.$folder.'</span></span>\\<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">'].'</span></span>\\<span class="hljs-string"><span class="hljs-string">'.$filename); } } else { if (!is_dir($folder.'</span></span>/<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">'])) { system('</span></span>md Z:\\home\\<span class="hljs-string"><span class="hljs-string">'.$ip.'</span></span>\\www\\<span class="hljs-string"><span class="hljs-string">'.$folder.'</span></span>\\<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">']); $filename = '</span></span>Z:\\home\\<span class="hljs-string"><span class="hljs-string">'.$ip.'</span></span>\\www\\<span class="hljs-string"><span class="hljs-string">'.$folder.'</span></span>\\<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">'].'</span></span>\\<span class="hljs-number"><span class="hljs-number">0001.</span></span>jpg<span class="hljs-string"><span class="hljs-string">'; $cmd = '</span></span><span class="hljs-string"><span class="hljs-string">"C:\Program Files\GssEziSoft\CmdTwain\CmdTwain.exe"</span></span> <span class="hljs-string"><span class="hljs-string">"'.$filename.'"</span></span><span class="hljs-string"><span class="hljs-string">'; system($cmd); } else { $n = 1; $files = scandir($folder.'</span></span>/<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">']); foreach($files as $filename) { if ($filename[0] == '</span></span>.<span class="hljs-string"><span class="hljs-string">') continue; $t = substr($filename, 0, -4)+0; if ($t &gt; $n) $n = $t; } $n++; $fn = str_pad($n, 4, "0", STR_PAD_LEFT).'</span></span>.jpg<span class="hljs-string"><span class="hljs-string">'; $filename = '</span></span>Z:\\home\\<span class="hljs-string"><span class="hljs-string">'.$ip.'</span></span>\\www\\<span class="hljs-string"><span class="hljs-string">'.$folder.'</span></span>\\<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">'].'</span></span>\\<span class="hljs-string"><span class="hljs-string">'.$fn; $cmd = '</span></span><span class="hljs-string"><span class="hljs-string">"C:\Program Files\GssEziSoft\CmdTwain\CmdTwain.exe"</span></span> <span class="hljs-string"><span class="hljs-string">"'.$filename.'"</span></span><span class="hljs-string"><span class="hljs-string">'; system($cmd); } } $i = -2; $files = scandir($folder.'</span></span>/<span class="hljs-string"><span class="hljs-string">'.$_GET['</span></span>time<span class="hljs-string"><span class="hljs-string">']); foreach($files as $filename) { $i++; if ($filename[0] == '</span></span>.<span class="hljs-string"><span class="hljs-string">') continue; echo "&lt;table style='</span></span>float: left<span class="hljs-string"><span class="hljs-string">' width='</span></span><span class="hljs-number"><span class="hljs-number">19</span></span>%<span class="hljs-string"><span class="hljs-string">'&gt;&lt;tr&gt;&lt;td&gt;&lt;a href='</span></span><span class="hljs-comment"><span class="hljs-comment">#' onclick='document.getElementById(\"preview\").style.display=\"block\"; document.getElementById(\"prepic\").src=\"/".$folder."/".$_GET['time']."/".$filename."\"'&gt;&lt;img alt='Picture' style='width: 100%' src='/".$folder."/".$_GET['time']."/".$filename."' /&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align='center'&gt;&lt;a href='/".$pagename."?scantype=pdf&amp;time=".$_GET['time']."&amp;delete=".$i."'&gt;Delete page ".$i."&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"; } if ($i == 0) echo '&lt;div style="position: absolute; left: 0; top: 0; width: 100%; height: 100%; background: white"&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;center&gt;&lt;h1&gt;&lt;a href="/'.$pagename.'"&gt; &lt;/a&gt;&lt;/h1&gt;&lt;/center&gt;&lt;/div&gt;'; } if($_GET['scantype']=='makepdf') { $cmd = $jpeg2pdf.' '.$_GET['time']; echo '&lt;span style="display: none"&gt;'; system($cmd); echo "&lt;/span&gt;&lt;h1&gt;&lt;a href='scans/".$_GET['time'].".pdf'&gt;Download PDF&lt;/a&gt;&lt;/h1&gt;"; } ?&gt; &lt;div id="preview" style="position: absolute; left: 0; top: 0; width: 100%; height: 100%; background: black; color: white; display: none"&gt;&lt;img id="prepic" style="position: relative; left: 23%; height: 100%" src="" alt="Picture" /&gt;&lt;div style="position: absolute; top: 0; right: 0; color: #FFF"&gt;&lt;a href="#" onclick="document.getElementById('preview').style.display='none'; return false" style="text-decoration: none; font-size: 250%; color: white; font-family: arial"&gt;X &lt;/a&gt;&lt;/div&gt;&lt;/div&gt; &lt;/body&gt; &lt;script&gt; if ($_GET('scantype') == 'pdf') document.getElementById('pdfnext').style.display = 'inline'; if ($_GET('scantype') == 'pdf') document.getElementById('makepdf').style.display = 'inline'; &lt;/script&gt; &lt;/html&gt;</span></span></code> </pre> <br>  At the top, 4 parameters are specified: IP of the computer with the scanner, php file name, name of the folder with scans, path to makepdf.bat. <br><br>  <b>Cons:</b> you can not set the quality of the scan - always scans in 200 DPI and in color.  It can somehow change the parameters (for example, in the registry), but they are suitable for office tasks. <br><br>  And yes, I know that the gettime () function can be written shorter and more beautiful.  Offer the most beautiful options in the comments. <br><br>  <b>Added later</b> (thanks to <a href="https://habrahabr.ru/users/faramant/" class="user_link">Faramant</a> ): <br>  Scan options can be specified on the command line.  Examples from the documentation: <br>  C: \&gt; CmdTwain ‚Äìc "PAPER LETTER DPI 300 GRAY" ... <br>  or (parameters in from file): <br>  C: \&gt; type map.txt <br>  PAPER A3 <br>  DPI 300 <br>  COLOR <br>  BR 200.0 <br>  C: \&gt; CmdTwain ‚Äìc <a href="https://habrahabr.ru/users/map/" class="user_link">map</a> .txt 75 scan.jpg <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/315160/">https://habr.com/ru/post/315160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315148/index.html">Y. Schmidhuber: ‚ÄúIt's great to be part of the future of artificial intelligence‚Äù</a></li>
<li><a href="../315150/index.html">Overclocking the performance of iOS applications</a></li>
<li><a href="../315152/index.html">Your programming language sucks</a></li>
<li><a href="../315154/index.html">VaR as a way to assess risk. Historical method</a></li>
<li><a href="../315156/index.html">The correct polymorphic Java builder.</a></li>
<li><a href="../315164/index.html">How else to use type safety to improve the API</a></li>
<li><a href="../315166/index.html">Log in or Log on? Front-end or Frontend? We continue to understand</a></li>
<li><a href="../315168/index.html">Comparing objects by value - 3, or Type-specific Equals & Equality operators</a></li>
<li><a href="../315170/index.html">One simple little problem. Fast, beautiful or clean?</a></li>
<li><a href="../315172/index.html">QUIC protocol: Web transition from TCP to UDP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>