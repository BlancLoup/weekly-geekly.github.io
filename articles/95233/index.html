<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Independently overloaded properties</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The standard mechanism for overloading properties through the __get and __set methods is not very convenient for practical use, but with it you can cr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Independently overloaded properties</h1><div class="post__text post__text-html js-mediator-article">  The standard mechanism for overloading properties through the __get and __set methods is not very convenient for practical use, but with it you can create a convenient dsl for working with properties.  Immediately an example of use (hereinafter, the <a href="http://habrahabr.ru/blogs/php/95157/">adaptive typing</a> pattern is used, which is recommended to be familiarized with in advance): <br><br><blockquote><code><font color="black"><font color="#0000ff">class</font> Title extends ProtoObject {&lt;br&gt; <font color="#0000ff">protected</font> $_text= <font color="#A31515">''</font> ;&lt;br&gt; <font color="#0000ff">function</font> set_text( $val ){&lt;br&gt; <font color="#0000ff">return</font> $ <font color="#0000ff">this</font> -&gt;aTitleString( $val );&lt;br&gt;    }&lt;br&gt; <font color="#0000ff">function</font> get_text( $val ){&lt;br&gt; <font color="#0000ff">if</font> ( empty( $val ) ) <font color="#0000ff">return</font> <font color="#A31515">'[untitled]'</font> ;&lt;br&gt; <font color="#0000ff">return</font> $val;&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> aTitleString( $val ){&lt;br&gt;        aString( &amp;$val );&lt;br&gt; <font color="#0000ff">if</font> ( strlen( $val ) &gt; 255 ) $val= substr( $val, 0, 252 ) . <font color="#A31515">'...'</font> ;&lt;br&gt; <font color="#0000ff">return</font> $val;&lt;br&gt;    }&lt;br&gt;}&lt;br&gt;&lt;br&gt;$title= <font color="#0000ff">new</font> Title;&lt;br&gt;$title-&gt;text= 123;&lt;br&gt;var_dump( $title-&gt;text ); <font color="#008000">// string(3) "123"</font> &lt;br&gt;var_dump( $title-&gt;text( <font color="#A31515">''</font> )-&gt;text() ); <font color="#008000">// string(10) "[untitled]"</font> &lt;br&gt;echo $title;&lt;br&gt; <font color="#008000">// Title Object</font> &lt;br&gt; <font color="#008000">// (</font> &lt;br&gt; <font color="#008000">//     [_text:protected] =&gt;</font> &lt;br&gt; <font color="#008000">// )</font></font></code> </blockquote> <br><a name="habracut"></a><br><h1>  Architecture </h1><br>  The field name must begin with an underscore, and the accessors must have the appropriate prefixes.  If you do not specify a property-specific getter and / or setter, then common get_ and set_ will be used.  The accessory interface is simple: they convert the value passed to them.  A new value is transferred to the setter and the result is stored in the field.  The getter enters the saved value and the result is output to the outside.  In fact, accessors act as pre- and post-filters. <br><br>  The property can be treated not only as a field, but also as a polymorphic function.  If it does not pass arguments, then it works as a getter, if you pass one parameter - as a setter that supports "chains".  If you pass more parameters, wait for the trouble ;-) To intercept calls to unknown methods whose names do not match the names of the properties, you can overload the _call method, which by default simply throws an exception. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Little bun - converting an object to a string by default makes it dump using print_r.  In general, the recommendation about __toString is such that this method should call the string that most fully reflects the internal state of the object. <br><br><h1>  Some more examples of properties </h1><br><blockquote> <code><font color="black"><font color="#0000ff">protected</font> $_count= 0;&lt;br&gt; <font color="#0000ff">function</font> set_count( $val ){&lt;br&gt;        $ <font color="#0000ff">this</font> -&gt;_message= <font color="#0000ff">null</font> ;&lt;br&gt; <font color="#0000ff">return</font> anUnsignedInt( $val );&lt;br&gt;    }</font></code> </blockquote>  Stores some non-negative integer value.  Values ‚Äã‚Äãlike '-2' and 2.1 will be converted to 2. If you pass a boolean value or, for example, a string with letters, an exception will be raised.  I propose to implement anipnster anUnsignedInt by myself. <br><br><blockquote> <code><font color="black"><font color="#0000ff">protected</font> $_message;&lt;br&gt; <font color="#0000ff">function</font> set_message( $val ){&lt;br&gt; <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">'message is autogenerated property'</font> );&lt;br&gt;    }&lt;br&gt; <font color="#0000ff">function</font> get_message( $val ){&lt;br&gt; <font color="#0000ff">if</font> ( empty( $val ) ) $val= $ <font color="#0000ff">this</font> -&gt;_message= $ <font color="#0000ff">this</font> -&gt;title . <font color="#A31515">': '</font> . $ <font color="#0000ff">this</font> -&gt;count;&lt;br&gt; <font color="#0000ff">return</font> $val;&lt;br&gt;    }</font></code> </blockquote>  Lazy property.  You cannot manually set the value, since it is a function of the values ‚Äã‚Äãof other fields.  However, this property caches the computed value in itself, therefore, in the setters of the fields on which it depends, you should write a reset of the cache. <br><br><blockquote> <code><font color="black"><font color="#0000ff">protected</font> $_point;&lt;br&gt; <font color="#0000ff">function</font> set_point( $val ){&lt;br&gt; <font color="#0000ff">return</font> Point::anInstance( $val );&lt;br&gt;    }&lt;br&gt; <font color="#0000ff">function</font> get_point( $val ){&lt;br&gt; <font color="#0000ff">return</font> clone $val;&lt;br&gt;    }</font></code> </blockquote>  Keeps an object with some interface.  If a non-object is passed, it instantiates Point with the corresponding parameters passed to it.  If the parameters are not correct - an exception.  When reading a property, only a clone is returned, and the stored object remains intact and private.  We'll leave the implementation of the Typkaster as homework ;-) <br><br>  Well, for a snack - the class "typed variable": <br><blockquote> <code><font color="black"><font color="#0000ff">class</font> Vary extends ProtoObject {&lt;br&gt;&lt;br&gt; <font color="#0000ff">protected</font> $_type;&lt;br&gt; <font color="#0000ff">function</font> set_type( $type ){&lt;br&gt;        aString( &amp;$type );&lt;br&gt; <font color="#0000ff">if</font> ( !function_exists( $type ) ) <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">'unknown type'</font> );&lt;br&gt; <font color="#0000ff">if</font> ( $ <font color="#0000ff">this</font> -&gt;type ):&lt;br&gt;            $ <font color="#0000ff">this</font> -&gt;_type= $type;&lt;br&gt;            $ <font color="#0000ff">this</font> -&gt;val= $ <font color="#0000ff">this</font> -&gt;val;&lt;br&gt;        endif;&lt;br&gt; <font color="#0000ff">return</font> $type;&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">protected</font> $_val;&lt;br&gt; <font color="#0000ff">function</font> set_val( $val ){&lt;br&gt; <font color="#0000ff">return</font> $val= call_user_func( $ <font color="#0000ff">this</font> -&gt;type, $val );&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> __construct( $type ){&lt;br&gt;        $ <font color="#0000ff">this</font> -&gt;type= $type;&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> __toString( ){&lt;br&gt; <font color="#0000ff">return</font> aString( $ <font color="#0000ff">this</font> -&gt;val );&lt;br&gt;    }&lt;br&gt;}&lt;br&gt;&lt;br&gt;$count= <font color="#0000ff">new</font> Vary( aString );&lt;br&gt;$count-&gt;val= <font color="#A31515">'5cm per second'</font> ;&lt;br&gt;echo $count-&gt;type; <font color="#008000">// aString</font> &lt;br&gt;var_dump( $count-&gt;val ); <font color="#008000">// string(14) "5cm per second"</font> &lt;br&gt;$count-&gt;type= aSoftNumber;&lt;br&gt;var_dump( $count-&gt;val ); <font color="#008000">// int(5)</font> &lt;br&gt;echo $count; <font color="#008000">// 5</font> &lt;br&gt;echo $count-&gt;val( <font color="#A31515">''</font> ); <font color="#008000">// 0</font> &lt;br&gt;var_dump( $count );&lt;br&gt; <font color="#008000">// object(Vary)#1 (2) {</font> &lt;br&gt; <font color="#008000">//  ["_type:protected"]=&gt;</font> &lt;br&gt; <font color="#008000">//  string(11) "aSoftNumber"</font> &lt;br&gt; <font color="#008000">//  ["_val:protected"]=&gt;</font> &lt;br&gt; <font color="#008000">//  int(0)</font> &lt;br&gt; <font color="#008000">// }</font></font></code> </blockquote> <br><br><h1>  Actually the hero of the occasion </h1><br><blockquote> <code><font color="black"><font color="#0000ff">class</font> ProtoObject {&lt;br&gt;&lt;br&gt; <font color="#0000ff">static</font> $version= 8;&lt;br&gt; <font color="#0000ff">static</font> $description= <font color="#A31515">'common object extension'</font> ;&lt;br&gt; <font color="#0000ff">static</font> $license= <font color="#A31515">'public domain'</font> ;&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> __toString( ){&lt;br&gt; <font color="#0000ff">return</font> print_r( $ <font color="#0000ff">this</font> , <font color="#0000ff">true</font> );&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> __set( $name, $value= <font color="#0000ff">null</font> ){&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;_aPropertyName( &amp;$name );&lt;br&gt;    $method= <font color="#A31515">'set'</font> . $name;&lt;br&gt; <font color="#0000ff">if</font> ( !method_exists( $ <font color="#0000ff">this</font> , $method ) ) $method= <font color="#A31515">'set_'</font> ;&lt;br&gt;    $value= $ <font color="#0000ff">this</font> -&gt;{ $method }( $value );&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;{ $name }= $value;&lt;br&gt; <font color="#0000ff">return</font> $ <font color="#0000ff">this</font> ;&lt;br&gt;}&lt;br&gt; <font color="#0000ff">function</font> set_( $val ){&lt;br&gt; <font color="#0000ff">return</font> $val;&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> __get( $name ){&lt;br&gt;    $ <font color="#0000ff">this</font> -&gt;_aPropertyName( &amp;$name );&lt;br&gt;    $method= <font color="#A31515">'get'</font> . $name;&lt;br&gt; <font color="#0000ff">if</font> ( !method_exists( $ <font color="#0000ff">this</font> , $method ) ) $method= <font color="#A31515">'get_'</font> ;&lt;br&gt;    $value= $ <font color="#0000ff">this</font> -&gt;{ $name };&lt;br&gt;    $value= $ <font color="#0000ff">this</font> -&gt;{ $method }( $value );&lt;br&gt; <font color="#0000ff">return</font> $value;&lt;br&gt;}&lt;br&gt; <font color="#0000ff">function</font> get_( $val ){&lt;br&gt; <font color="#0000ff">return</font> $val;&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> __call( $name, $args ){&lt;br&gt; <font color="#0000ff">try</font> {&lt;br&gt;        $ <font color="#0000ff">this</font> -&gt;_aPropertyName( &amp;$name );&lt;br&gt;    } <font color="#0000ff">catch</font> ( Exception $e ){&lt;br&gt; <font color="#0000ff">return</font> $ <font color="#0000ff">this</font> -&gt;_call( $name, $args );&lt;br&gt;    }&lt;br&gt; <font color="#0000ff">switch</font> ( count( $args ) ){&lt;br&gt; <font color="#0000ff">case</font> 0: <font color="#0000ff">return</font> $ <font color="#0000ff">this</font> -&gt;__get( $name );&lt;br&gt; <font color="#0000ff">case</font> 1: <font color="#0000ff">return</font> $ <font color="#0000ff">this</font> -&gt;__set( $name, $args[0] );&lt;br&gt; <font color="#0000ff">default</font> : <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">'wrong parameters count'</font> );&lt;br&gt;    }&lt;br&gt;}&lt;br&gt; <font color="#0000ff">function</font> _call( $name, $args ){&lt;br&gt; <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">'method not found'</font> );&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">function</font> _aPropertyName( $val ){&lt;br&gt; <font color="#0000ff">if</font> ( $val[0] !== <font color="#A31515">'_'</font> ) $val= <font color="#A31515">'_'</font> . $val;&lt;br&gt; <font color="#0000ff">if</font> ( !property_exists( $ <font color="#0000ff">this</font> , $val ) ) <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">'property not found'</font> );&lt;br&gt; <font color="#0000ff">return</font> $val;&lt;br&gt;}&lt;br&gt;&lt;br&gt;}</font></code> </blockquote> </div><p>Source: <a href="https://habr.com/ru/post/95233/">https://habr.com/ru/post/95233/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../95224/index.html">Haven and hearth</a></li>
<li><a href="../95225/index.html">Dirk-Jan Bazink (Dirkjan Bussink) how to become a successful Ruby player</a></li>
<li><a href="../95226/index.html">Crowdsourcing Testing Features for Customer</a></li>
<li><a href="../95229/index.html">Effective team building</a></li>
<li><a href="../95232/index.html">Compaq and SEGA in good hands</a></li>
<li><a href="../95235/index.html">Report about BolgenOS</a></li>
<li><a href="../95236/index.html">Your WebMoney under the protection of E-NUM</a></li>
<li><a href="../95238/index.html">Internet Explorer 9: The Most Comprehensive Developer Guide (and Not Only), Part 2</a></li>
<li><a href="../95239/index.html">It is finished. Now you can change the folder name or tag in Google Reader</a></li>
<li><a href="../95240/index.html">Juniper Research on the growth of mobile VoIP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>