<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MySQL stored procedures and out of sync</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I figured out a very long time the reason why after I make a MySQL request in which I access the stored procedure (stored procedure) (PHP 5, MyS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MySQL stored procedures and out of sync</h1><div class="post__text post__text-html js-mediator-article">  Today I figured out a very long time the reason why after I make a MySQL request in which I access the stored procedure (stored procedure) (PHP 5, MySQL 5, mysqli driver) <br><blockquote>  <font><font color="blue"><b>CALL</b></font> procedureName ()</font> </blockquote><br>  then the following request is not executed, and mysqli_error returns an error <br><a name="habracut"></a><br><blockquote>  <font>Error ‚ÄúCommands out of sync;</font>  <font>you can't run this command now "number" 2014 "in query: ...</font> </blockquote><br>  Judging by the error, the impression was that the connection was lost.  This was misleading and led the wrong way. <br><br>  As it turned out, everything comes from the fact that my procedure returns the result as a table, and not a single result (number or string or boolean).  For example, the result of such a query would be a table: <br><blockquote>  <font><font color="blue"><b>SELECT</b></font> * <font color="blue"><b>FROM</b></font> users;</font> </blockquote><br>  If the stored procedure returns such a table, then in addition to this table, another value is also output - the result of the procedure itself.  This behavior of the mysqli driver is called a <strong>multiple result</strong> .  So, most developers take the first and most often the only result.  In the case when the procedure returns the table, the secondary result also needs to be pulled out, otherwise the results buffer will remain uncleaned and other requests will not pass - they will not be able to write there. <br><br>  In the general case, after the first result is fetched by the usual fetch, you need to reset the unnecessary results by pulling them out of the buffer: <br><blockquote>  <font><font color="teal">// $ connection - your MySQLI object</font></font> <font><br></font>  <font><font color="blue"><b>while</b></font> ( <font color="blue">$ connection</font> -&gt; next_result ()) <font color="blue">$ connection</font> -&gt; store_result ();</font> <font><br></font> </blockquote><br>  <font>Thanks to the person under the name Evert, who suggested the <a href="http://www.rooftopsolutions.nl/article/173">answer</a> to this question.</font> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/21326/">https://habr.com/ru/post/21326/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213247/index.html">FDB switch tables. Adventures in the zoo. Part 1 - SNMP</a></li>
<li><a href="../213251/index.html">First blog post: moving from idea to project layout</a></li>
<li><a href="../213253/index.html">Making the game right before your eyes - part 4: Shader for fade in on the palette (a la NES)</a></li>
<li><a href="../213257/index.html">Therascale OCP Solution</a></li>
<li><a href="../213259/index.html">Code Obfuscation Techniques with LLVM</a></li>
<li><a href="../213261/index.html">CodeFest number 5 - again cake</a></li>
<li><a href="../213263/index.html">Prostokvashino on Habr√© or Uncle Fedor‚Äôs letter</a></li>
<li><a href="../213265/index.html">Init.js: Why and how to develop JavaScript with Full-Stack</a></li>
<li><a href="../213269/index.html">Deploy applications on RoR 4 using Capistrano 3</a></li>
<li><a href="../213271/index.html">Intuition as a developer tool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>