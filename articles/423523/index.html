<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Combined sensor, with preference and poetess</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At first, we made a temperature and humidity sensor for offices in a beautiful wall case with an RS-485 Modbus interface, but so far we did, appetites...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Combined sensor, with preference and poetess</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/4fa/4f0/978/4fa4f09782c605501bc41ec58afd5c19.jpg" width="350" align="right">  At first, we made a temperature and humidity sensor for offices in a beautiful wall case with an RS-485 Modbus interface, but so far we did, appetites have grown a bit. <br><br>  As a result, the sensors were placed in a compact case: <br>  - CO2 concentration, <br>  - temperature / humidity <br>  - illumination <br>  - noise <br>  - VOC concentrations - ‚Äúvolatile organic matter (VOC)‚Äù <br>  - movement <br><br>  And: <br>  - IR transmitter (with receiver for training) <br>  - and still knows how to squeak and blink "eye" red / green <br><a name="habracut"></a><br>  As a result, the quantity goes into quality.  Installing one device on a room completely covers the task of monitoring and controlling indoor climate.  Easier installation and configuration, and the device itself is cheaper than several separate ones. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  How we did the body </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/400/7fc/42a/4007fc42afc4165adbf61e5705e774f7.jpg"><br>  <i>From left to right - the sensor in the Chinese case, the first prototype, the serial case.</i> <i><br></i> <br>  Combined wall sensors for residential and office space, we have been doing for several years.  There were a lot of revisions, several thousand copies sold, several large deployments: you may have found the sensor in the case on the left, for example, in a network store or in branches of a large bank. <br><br>  Naturally, at first we used the standard case from catalogs of countless Chinese manufacturers of standard cases. <br><br>  We modified it for ourselves: milled holes, glued lenses.  It worked out quite decently and technologically, but I wanted better - more solid plastic, comfortable latches, etc. One of the funny problems: when customers hung sensors low on the walls, visitors sometimes took the button and tried to "push" .  The very strong turned out like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y-/yy/si/y-yysistqwyuvr3zifcoibbdkm8.jpeg" width="500"></div><br><img src="https://habrastorage.org/getpro/habr/post_images/acf/9e0/6c9/acf9e06c9de44b1e468be20993508366.png" width="400" align="right"><br>  When we started to make our own body, we took the old standard as a basis: we looked at it and corrected what we did not like about it. <br><br>  They deepened the lens, widened the mounting holes, added cuts for the cable, made small legs on the bottom, fixing the lens with screws.  Printing a prototype (master model) was done on a 3D printer (~ 15,000 rubles) + a pilot batch of silicone casting. <br><br>  The master model was black, and in general the form suited us, but when we received a trial batch of white cases we were saddened - it turned out worse than the Chinese original.  The principle of "black slim, white fills" is true not only for dresses.  This is not very visible in the photo, but, despite the formal equality of dimensions, the new building looked much thicker.  Due to smooth angles, bulges around the lens. <br><br><img src="https://habrastorage.org/webt/go/9f/0q/go9f0qyqlg5kk4oecspyt03naxk.jpeg"><br><br>  And the narrowing of the walls to the bottom of the Chinese case gives an interesting effect - when the case hangs on the wall and you look at it from a slight angle, you can only see the straight part of the side wall and it seems that the case is twice as thin. <br><br>  Therefore, the next version was underestimated with the zeal of the Dagestanis - and, in general, they rested against the thickness of the CO2 sensor.  We also added a side cutout for a cable channel of 10 * 15 mm - now the crookedly cut edge of the cable channel is covered by the body itself. <br><br>  The bottom line is this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/495/c4e/65c/495c4e65cfab0cfad706b26bb8131839.jpg"><br><br>  Pay attention to the little things: there are "glasses" around the mounting holes to protect the board from the installer's screwdriver;  technological openings under the latches work as windows for status LEDs;  there is only one latch, but it is so recessed that it will not work with a finger. <br><br>  I made a little mistake with the snaps - because of the tolerances they turned out to be slightly thicker than the holes for them, you have to gently modify the file, but this is only 10-20 seconds per case. <br><br>  The mold and casting were made in China.  at prices it turned out only about $ 2500 for a mold and about $ 600 for a casting of 1000 pieces.  But the construction of the hull was much more :).  A lot of time and money was spent on prototyping, though more for reasons of their sloppiness.  And the casting into silicone turned out to be an extra step - the casting accuracy still didn‚Äôt allow us to notice the absence of gaps for tolerances in the latches, and the general principle and appearance can be understood by the model from a photopolymer 3D printer if you paint it in the correct color. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b5/a99/c41/8b5a99c41b3437d9d85cb9aa4b4e6d3a.jpg" width="350" align="right"><br><h2>  About the case told, but what's inside? </h2><br>  And there is a green fee!  Part of the sensors in the form of separate modules (TH, VOC, CO2), the rest on the board. <br><br>  Briefly about the sensors: <br><br><h3>  CO2 sensors (carbon dioxide) </h3><br>  - Famous Winsen MH-Z19B.  They work on the NDIR technology ( <i>nondispersive infrared sensor,</i> non-dispersive infrared analyzer) - that is, light of a certain wavelength is driven through the gas chamber, and its intensity is measured to decrease. <br><br>  The more carbon dioxide in the air, the more the light dies out.  This technology is superior to electrochemical sensors, including its high selectivity (that is, the reaction to carbon dioxide, and not to other similar ones (for example, CO is carbon monoxide). <br><br>  The carbon dioxide concentration itself is an important parameter that directly affects human performance ( <a href="https://ehp.niehs.nih.gov/doi/10.1289/ehp.1510037">https://ehp.niehs.nih.gov/doi/10.1289/ehp.1510037</a> ) The CO2 concentration in the street is 400 ppm, a good level for the room is up to 600 ppm, at a concentration of 1000 ppm (which is easily achieved, for example, by meeting with the windows closed), the deterioration of performance is noticeable without special studies.  Elevated CO2 levels signal that the room needs to be ventilated ‚Äî not only to reduce the concentration of carbon dioxide, but also to clean the room from bacteria ‚Äî for example, causing a cold. <br><br><h3>  Temperature / Humidity Sensor </h3><br>  - we put the digital combined T + RH sensor with individual calibration.  There was a negative experience with the Chinese sensors AOSONG AM2320 - after some time (1-2 years) ~ 20% of the party began to underestimate the testimony.  Earlier, there was a large variation between different batches, which indirectly indicated that the batches were discarded but not calibrated by the manufacturer at best. <br><br>  The chip is closed in a ‚Äúsandwich‚Äù of printed circuit boards to additionally protect the sensitive element of the sensor from dust, water droplets and the installer‚Äôs fingers. <br><br><h3>  VOC sensor </h3><br>  - Sensirion's new SGPC3 multi-pixel gas sensor for measuring air quality.  The sensor itself is generally the leading edge of development, MEMS technology, low consumption, compactness, stability of readings and many other beautiful words. <br><br>  What is air quality?  What do we measure at all?  The sensor reacts to organic gases.  This evaporation of varnishes / paints, alcohols, decaying vegetables, gases emitted by man, also detects the leakage of domestic gas.  It complements, but does not exclude the CO2 sensor. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c43/999/453/c43999453a3fe79d9b647db5597d25dc.jpg" width="600"></div><br><br>  The sensor is covered with a gas permeable film (left).  Right sensor with the film removed.  And inside is such a beauty: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a04/a3e/b59/a04a3eb59807e7c35802256cc83f0fc9.jpg"><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/449/886/434/44988643423dbef60aa2bbd7d104e579.jpg" width="400"></div><br>  You can see that the wires of the spiral heater of the substrate are suitable from the right-to-left, and from the top and bottom of the wire to the 4 cells.  But it is not exactly. <br><br><h3>  Light sensor </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/a79/115/8ba/a791158baa6ea6be344bcfb35d05ed03.jpg" width="350" align="right"><br>  - advanced, with a filter that repeats the spectral sensitivity curve of the human eye.  It therefore has good accuracy and measures real suites, not parrots. <br><br>  The effect is especially noticeable when comparing the readings of our sensor with devices of competitors, where there is an ordinary photodiode, with different lighting: daylight, incandescent lamps, cheap and expensive LED lamps. <br><br>  Why do we need a light sensor?  Control of lighting, rolling shutters.  Since the suites are real, the threshold values ‚Äã‚Äãcan be set not ‚Äúby eye‚Äù, but according to the norms of SanPiN. <br><br><h3>  Motion Sensor </h3><br>  - based on the PIR sensor D203S.  Sensitivity and viewing angle is not the most outstanding (120 ¬∞, up to 10 m), but for working indoors is enough. <br><br>  It is not just a signal transmitted that there is movement / no movement, but a certain ‚Äúamount‚Äù of movement in parrots.  That allows programmatically in the system of rules to respond differently to different thresholds. <br><br><h3>  Noise sensor </h3><br>  - microphone with amplifier and filters for correction on scale A, taking into account the peculiarities of the human ear perception of sounds of different frequencies.  Can be used in addition to the motion sensor. <br><br>  You can turn down the volume of the TV, if the time is later, and the children are carried away watching the action movie.  Or squeak loudly if the poetess read their poems too loudly :) <br><br>  However, most customers have more ‚Äúboring‚Äù applications: monitor compliance with the very SanPiN;  sometimes give additional information about the work of noisy units. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e36/495/7bc/e364957bc7dab7e5606e7632f99e46a5.png"><br>  <i>In the picture: the noise in the room and the work of the Central Art Museum (this is such a very large refrigerator) in the grocery store.</i> <br><br><h3>  Emulation of IR remotes for technology </h3><br>  In the new WB-MSW under the lens hidden IR receiver for training and 8 IR LEDs.  Their power is enough to "cover" the signal of a large room. <br><br>  Training is done once - the commands are stored in the device‚Äôs memory and can be played by the Modbus command from the controller.  The number of commands remembered is large enough (up to a hundred, depending on the model of the remote control) in order to control all the devices in the room at once: a TV, an air conditioner, a receiver, a player, a projector - the main thing is that the IR receivers of the devices ‚Äúsee‚Äù the transmitter. <br><br>  Taking into account the recommendations to place temperature, humidity and carbon dioxide sensors at about the height of human growth, it will be easy to provide.  The transmitter power is enough for the controlled devices to receive not only the direct, but also the reflected signal. <br><br>  In non-residential premises, using infrared, it is possible to control the air conditioners (almost all of them have an infrared receiver window, and IR control is several times cheaper than ‚Äúnative‚Äù interfaces) and heat curtains.  Naturally, WB-MSW is suitable only if all devices in the field of visibility need to be controlled synchronously: one remote control cannot supply different modes to two different air conditioners.  For individual control of each air conditioner, the ‚Äúyounger brother‚Äù of the sensor is suitable - <a href="https://wirenboard.com/ru/product/WB-MIR/">WB-MIR</a> . <br><br><h3>  Indication </h3><img src="https://habrastorage.org/webt/xy/qq/so/xyqqso5ufezxdnh6rdilbgardr4.gif" width="300" align="right"><br><br>  The sensor can squeak loudly and blink in different colors. <br><br>  The commands for Modbus define the period and duration of the ‚Äúflashes‚Äù of the LEDs: in fact, you can change the frequency and brightness of the flash. <br><br>  On the LEDs, you can make feedback for the user, for example, blink red at a high level of CO2.  It is also convenient when you install many identical sensors in a large room: you can remotely turn on, for example, a squeaker and find the one you need. <br><br><h3>  Total </h3>  Thus, the combined sensor is a serious source of data for room automation.  With it, an advanced script on the controller can provide a comfortable stay for people. <br><br><ol><li>  Temperature and humidity conditions and air quality: control of ventilation and humidification, control heads of radiators, air conditioning, window opening / closing drives, automatic curtains (temperature, humidity, carbon dioxide, VOC). </li><li>  Security functions: motion and sound notifications (microphone, motion sensor). </li><li>  Implementation of scenarios: control of lighting, automatic curtains, background music, on / off video on a schedule, comfortable waking up, circadian lighting (light sensor, microphone). </li><li>  Drawing attention to abnormal situations (squeaker, signal leds) </li><li>  Energy saving: the presence / absence of people in the room (motion sensor, microphone, CO2 sensor). </li></ol><br><h3>  I already want to buy </h3><br>  Samples of the new model are already in happy testers, the first production batch is in production.  As usual, one and a thousand pieces can be ordered <a href="https://wirenboard.com/ru/product/wb-msw-v3/">on our website</a> . <br>  We are preparing for the arrival of the party of new MSW v.  3 and clear the shelf space: old (‚Äúmature‚Äù, ‚Äútime-tested‚Äù) WB-MSW v.  2 sold at a discount of ~ 30%. </div><p>Source: <a href="https://habr.com/ru/post/423523/">https://habr.com/ru/post/423523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423511/index.html">Interception of the installation of Firefox and Chrome in Windows 10</a></li>
<li><a href="../423513/index.html">We save on RAID-controller, or how to feed</a></li>
<li><a href="../423515/index.html">Is DRY good or can it break the SOLID O?</a></li>
<li><a href="../423519/index.html">Wandering monster: how to get rid of problems on the map</a></li>
<li><a href="../423521/index.html">Seven rules of thumb for experimenting with websites</a></li>
<li><a href="../423527/index.html">Children's apps massively collect personal data and pass it on to third parties.</a></li>
<li><a href="../423529/index.html">What do you need for the whole team to work? How to tighten all the project management system?</a></li>
<li><a href="../423531/index.html">Evolution of the Reddit Mobile Architecture</a></li>
<li><a href="../423533/index.html">FAQ on intercity passenger bus flights</a></li>
<li><a href="../423535/index.html">Why should trash can access the Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>