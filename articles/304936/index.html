<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About tasty and healthy food ESP8266 from batteries</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many of those who make different things on ESP8266, at some point thought that it would be great to take that thing, put it in my pocket - and go for ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About tasty and healthy food ESP8266 from batteries</h1><div class="post__text post__text-html js-mediator-article">  Many of those who make different things on ESP8266, at some point thought that it would be great to take that thing, put it in my pocket - and go for a walk with it.  ESP8266 is so small, and asks.  And here on our way there is a small obstacle - programming is not enough here, you have to take a soldering iron in your hands, but everything is not so bad, and I hope this article will help you. <br><a name="habracut"></a><br>  The datasheet on the ESP8266 indicates a supply voltage from 3.0 to 3.6 volts, which, in principle, allows the ESP8266 to be powered directly from two AA batteries or one lithium 1S battery.  If we are not very important stability and neat behavior of the device when the voltage drops, or do not mind the lithium battery, you can do with this, otherwise we face some questions. <br><br><h4>  Voltage conversion </h4><br>  In most cases, the battery voltage will be higher than the 3.3 V we need, and it will noticeably change as the battery discharges, so we need to lower it and stabilize it.  The first thing you need to decide is whether we want to power the rest of the circuit from the stabilized voltage, or can be directly from the battery.  The necessary current given by the voltage regulator depends on it.  ESP8266 itself needs a maximum of 200 mA, throwing a little on top of the capacitor charge and other unexpected expenses, we can assume that 300. Sensors often like stable voltage, and powerful actuators are often better powered directly from the battery. <br><br>  Next you need to decide on the type of regulator, there are two options, each with its own advantages and disadvantages - a linear regulator, or pulse. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Linear Voltage Regulator </h5><br>  The linear regulator, in fact, is a controlled resistor, on which all the ‚Äúextra‚Äù voltage drops and is dissipated in the form of heat. <br><br>  Advantages of a linear regulator: <br><ul><li>  Extreme simplicity is usually a 3-pin chip and two capacitors.  Almost impossible to mess up. </li><li>  Cheapness - from 6 rubles for the microcircuit. </li><li>  No high frequency noise in the output voltage.  This can be useful, for example, if some sensitive sensor is powered by the same voltage. </li></ul><br>  The most common variant is a type 1117 microcircuit, produced by many manufacturers, usually produced in several versions on a line of fixed output voltages, among which there are always 3.3 V - for example, AZ1117C-3.3 manufactured by Diodes Inc. <br><br><img src="https://img-fotki.yandex.ru/get/118251/3630370.0/0_1c3f43_d64c80ad_orig.png" alt="image"><br>  <i>Fig.</i>  <i>1. Typical wiring diagram for linear regulator type 1117</i> <br><br>  What you should pay attention to: <br><ul><li>  The voltage drop across the regulator.  If the voltage drop across the regulator is 1.2 V (typical value for type 1117 regulators), this means that in order to maintain 3.3 V at the output, we need to have at least 4.5 V on the battery, which means that with the dream of using three finger batteries, breake down.  The lower the voltage drop, the better. </li><li>  Maximum voltage capacitors.  For a capacitor at the output of the regulator, 6 V is enough, but at the input a margin of + 50% of the maximum battery voltage never hurts. </li><li>  Maximum current is rarely a problem, because even the simplest regulator, as a rule, will provide a current of up to 1 A without any problems. </li><li>  Maximum input voltage.  The typical value for regulators of type 1117 is 15 V, if you have a higher-voltage battery (for example, LiPo 4S) - pay attention. </li></ul><br>  The disadvantage of the linear regulator is not very high efficiency, which strongly depends on the difference between the voltage on the battery and the output 3.3 V. This difference is uselessly dissipated by the regulator in the form of heat.  If the device is powered by three AA batteries (4.5 V), then approximately 27% of the energy is wasted.  If the battery voltage is 12 V, then 73% will be wasted. <br><br><h5>  Pulse controller </h5><br>  Pulse regulators usually have a higher efficiency, little dependent on the voltage difference between the input and output.  Paying for it comes with the complexity of the scheme, as well as with certain wiring requirements for the PCB.  Since the controller uses a relatively high frequency (usually from tens of kilohertz to a few megahertz), the circuit becomes sensitive to parasitic inductances and capacitances, so it‚Äôs not enough to connect the elements correctly, the relative positioning of the elements and conductors between them can also critically affect performance.  In my practice, there was a case when, due to unsuccessful wiring of conductors on the board, the regulator began to work only when a finger was brought to it - that is, the introduction of additional parasitic capacitance.  It may also not be the best choice if your circuit is sensitive to high-frequency interference ‚Äî for example, there is a sensitive sensor near the PCB. <br><br><img src="https://img-fotki.yandex.ru/get/151273/3630370.0/0_1c3f44_6b891aca_orig.png" alt="image"><br>  <i>Fig.</i>  <i>2. A typical scheme for the inclusion of Texas Instruments company LM2736, the price is about 80 rubles</i> <br><br>  What you should pay attention to (much more points than the linear regulator!): <br><ul><li>  Pulse converters are very different, so be prepared to spend a lot of time choosing the right one. </li><li>  Necessary "binding" of the converter.  The number and ratings of used parts can significantly affect the size, cost and complexity. </li><li>  PCB layout  In a datasheet, there will almost always be either verbal recommendations or even a picture with the reference design of the board, but this is not a dogma - you can often get along with common electrical sense (all the conductors on the board are as short as possible, on the other side of the board there is a solid ground layer, etc.) . </li><li>  Input voltage range. </li><li>  Maximum output current. </li><li>  Frequency conversion.  Lower-frequency circuits are less capricious in terms of parasitic capacitances, but require large capacitors (usually tantalum, polar) and inductances.  Also, many people hear their high-frequency whistle - inductances work like small tweeters.  Higher frequency circuits are more capricious, but require smaller capacitors (usually multilayer ceramic) and inductances, and do not whistle. </li><li>  Maximum voltage capacitors.  The pulse converter can have significant high-frequency fluctuations in the output voltage (ripple), so a good margin is recommended. </li><li>  Almost all pulse converters have an adjustable output voltage, which is set by a divider of two resistances, so their ratings and tolerance must be fairly accurate. </li></ul><br><br><h4>  Battery voltage monitoring </h4><br>  There are at least two reasons why this may be necessary.  Firstly, it allows an estimate of the remaining work time until full discharge.  Secondly, if your device is powered by a lithium battery, then these batteries quickly swell and lose their characteristics from overdischarge, so it is highly desirable to turn off the device before the battery is completely discharged. <br><br>  It is very simple to make it - just a divider of two resistors connected to the ADC input is enough.  The divider is calculated so that the maximum voltage at the ADC input does not exceed 1 V (upper limit of the ADC).  In principle, if it is a little higher, then nothing bad will happen, but you need to be careful not to exceed the supply voltage - remember that the battery voltage that we measure can be significantly higher than 3.3 V - if it is accidentally fed to the ADC then ESP8266 will burn. <br><br>  The disadvantage is that it occupies the only available ADC.  This problem, in turn, can be solved by using an external multiplexer (for example, NLAS4599 manufactured by ON Semiconductor, the price is about 10 rubles), but it, in turn, will take one or several GPIOs for control.  Also to the disadvantages of this method can be attributed to the fact that the ADC can not hang interrupt, and it must be regularly interviewed himself. <br><br><h4>  Brownout detection </h4><br>  ‚ÄúBrownout‚Äù is a voltage drop below par, but not to zero.  Why do you need to detect it?  Imagine that you have a battery-powered heating pad on an ESP8266.  It gets cold - the heater turns on, it becomes warm - it turns off.  It would seem that could go wrong?  But let's see more. <br><br>  The battery as a power source has a certain internal resistance, when trying to pick up a large current from it (for example, when the heater is turned on) its output voltage sags.  What happens to the ESP8266 if it sags below 3.3V?  What happens is that a small drop in voltage is not enough for a general reset to take place and all outputs go into an inactive state, but not enough for the ‚Äúmoments to stop‚Äù for ESP8266 brains.  As a result, in our example with a heating pad, it turns out that the ESP8266 turns on a heating pad, immediately goes into a comatose due to brownout, and the GPIO output controlling the heating pad keeps a high level - respectively, the heating pad continues to warm and warms you to a medium well state The battery does not end earlier and finally the long-awaited total reset does not occur. <br><br>  In many serious microcontrollers, this problem has been solved by hardware for a long time, and often you can even choose a software response to brownout ‚Äî this can be either a forced reset or an interrupt, in which the microcontroller can ‚Äútranslate itself‚Äù (without guarantees, of course) in a safe state.  There is nothing like that in ESP8266, so you have to tackle the soldering iron.  Fortunately, everything has long been invented before us, and to solve this problem, there have long been chips with only three leads that can be connected to the ESP8266 without any additional strapping.  Where to connect - there are two options: either on reset or on GPIO and process the situation programmatically, possibly through an interrupt. <br><br><img src="https://img-fotki.yandex.ru/get/53301/3630370.0/0_1c3f45_88b9d152_orig.png" alt="image"><br>  <i>Fig.</i>  <i>3. A typical circuit for turning on the CAX803TTBI-T3 chip manufactured by ON Semiconductor, the price is about 10 rubles.</i>  <i>Note that the ESP8266 has software-enabled pull-up resistances, so external resistance is not necessary.</i> <br><br>  That's all, in most cases, the above will suffice to provide your ESP8266 with tasty, healthy and inexpensive food.  May the electromotive force be with you! </div><p>Source: <a href="https://habr.com/ru/post/304936/">https://habr.com/ru/post/304936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304918/index.html">Take a technical interview</a></li>
<li><a href="../304924/index.html">USB mass storage device and libopencm3</a></li>
<li><a href="../304926/index.html">Machine learning instead of DPI. Building a traffic classifier</a></li>
<li><a href="../304932/index.html">Data Protection - Modern Security Challenges</a></li>
<li><a href="../304934/index.html">Important aspects of the browser for developers. Part 2</a></li>
<li><a href="../304982/index.html">Sparrowdo is a simple configuration management tool.</a></li>
<li><a href="../304988/index.html">Signals and slots in PHP. Same as in Qt. Almost</a></li>
<li><a href="../304998/index.html">We play mp3 in our program and what can prevent it</a></li>
<li><a href="../305000/index.html">We are looking for vulnerabilities in code: theory, practice and prospects of SAST</a></li>
<li><a href="../305002/index.html">CMYK closed-loop search algorithm on a two-dimensional matrix</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>