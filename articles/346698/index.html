<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with AVRO format in python - fastavro library</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article describes the use of the AVRO serialization format in python, gives a brief description of the AVRO scheme with explanations of the most o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with AVRO format in python - fastavro library</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/z-/0e/wd/z-0ewdccnmr67afgrhvkkxfvjxk.png"></p><br><p>  The article describes the use of the AVRO serialization format in python, gives a brief description of the AVRO scheme with explanations of the most obscure points, provides specific examples of python code.  Intentionally excluded from consideration questions of schema evolution (schema evolution), RPC and AVRO-IDL. </p><br><p>  All the examples are given using the fastavro library, which the author had to significantly improve to meet the specification and compatibility with the java implementation. </p><a name="habracut"></a><br><h3 id="istoricheskaya-spravka">  History reference </h3><br><p>  Why AVRO, but not json, bson, msgpack, protobuf, ASN.1, thrift, yaml? </p><br><p>  When decomposing a monolithic system, it became necessary to describe the procedure for interaction between microservices.  Not long choosing between RabbitMQ and Kafka stopped at the last.  But over the next task - the choice of the serialization system had to sweat. </p><br><p>  When choosing a serialization system, the following requirements were taken into account: </p><br><ol><li><p>  Multiple programming language support </p><br><p>  The basis of our codebase is python 2.7.  Moreover, I would like to further translate productivity-sensitive processes into other languages. </p><br></li><li><p>  Validation of data during serialization </p><br><p>  In a dynamic interpreted python, it's too easy to accidentally send the wrong data.  And in the pub-sub model of kafka we chose it was very important for us to ensure the correctness of the input data in the topic.  We needed a system that allows typing kafka topics. </p><br></li><li><p>  Type support </p><br><p>  Our system actively operates with types Decimal, UUID and Datetime.  Alas, the well-known serialization formats starting ASN.1 and ending with msgpack basically describe the serialization of low-level types (int \ float \ string \ bytes) and do not offer complete solutions for those of interest. </p><br></li></ol><br><p>  Based on these considerations, the choice fell on the AVRO.  But suddenly it turned out (spring 2017) that despite the presence of support for logical types in the <a href="http://avro.apache.org/docs/current/spec.html">specification</a> and JAVA libraries - neither in the <a href="">official</a> AVRO implementation for python, nor in the competing <a href="https://github.com/tebeka/fastavro/">fastavto</a> they were simply ignored.  Had to add their own. </p><br><p>  The most adequate (and also the fastest) code turned out to be at fastavro, as a result, it was decided to finalize this library.  This was my first experience of participation in opensource. </p><br><h1 id="chto-takoe-avro">  What is AVRO </h1><br><p>  AVRO is a data serialization system created by the Hadoop project.  The data is serialized in a binary format using a previously created json scheme, and a scheme is also required for deserialization (perhaps another one). </p><br><p>  Also, AVRO will allow to pack a large number of records specified by a single scheme within a single container, which allows you to efficiently transfer large amounts of data, avoiding the overheads of other formats. </p><br><h2 id="avro-shema">  AVRO circuit </h2><br><p>  I will not describe in detail the rules for constructing schemes, since  They are set out in the <a href="http://avro.apache.org/docs/current/spec.html">official documentation.</a> <br>  I will dwell only on the basic things and not at all obvious points. </p><br><p>  The AVRO scheme is a JSON that describes a serializable \ deserializable data structure.  Data types can be: </p><br><ol><li>  Primitive <br><ul><li>  <em>null</em> </li><li>  <em>boolean</em> </li><li>  <em>int</em> - 32-bit signed integer </li><li>  <em>long</em> - 64-bit signed integer </li><li>  <em>float</em> </li><li>  <em>double</em> </li><li>  <em>string</em> - unicode string </li><li>  <em>bytes</em> - byte sequence </li><li>  <em>fixed</em> - the same bytes, but with the length specified in the scheme </li></ul></li><li>  Compound <br><ul><li>  union - type sum </li><li>  <em>recod</em> - product type </li><li>  <em>enum</em> - listing </li><li>  <em>array</em> - array / list </li><li>  <em>map</em> - associative array </li></ul></li><li>  Logical (in AVRO terminology) <br><ul><li>  <em>decimal</em> - fixed point number </li><li>  <em>date</em> - date </li><li>  <em>time-millis</em> - time with millisecond precision </li><li>  <em>time-micros</em> - time with microsecond accuracy </li><li>  <em>timestamp-millis</em> - date-time with millisecond precision </li><li>  <em>timestamp-micros</em> - date-time with microsecond accuracy </li><li>  <em>uuid</em> - universally unique identifier </li></ul></li></ol><br><p>  Although the above logical types have long been the standard in relational databases and modern programming languages, serialization libraries have bypassed them, forcing them to be reduced to primitive types, fortunately, AVRO has solved this problem. </p><br><p>  Consider a simple scheme: </p><br><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"record"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"namespace"</span></span>: <span class="hljs-string"><span class="hljs-string">"notificator"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"out"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"HTTP "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fields"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"id "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"long"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"datetime"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"long"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logicalType"</span></span>: <span class="hljs-string"><span class="hljs-string">"timestamp-millis"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"source"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-string"><span class="hljs-string">"string"</span></span> ] }, { <span class="hljs-attr"><span class="hljs-attr">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"method"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"enum"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"methods"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"symbols"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-string"><span class="hljs-string">"GET"</span></span>, ] } }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"url"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"headers"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"map"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"values"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"body"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"body"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"bytes"</span></span> } ] }</code> </pre> <br><p>  The scheme begins with a declaration of the record type with the given name and namespace.  These fields in the first lines will be used in code generation systems that are not relevant to python, since  our scheme will be processed dynamically.  Next comes the enumeration of the field types of our record. </p><br><p>  Of particular interest is the declaration of the datetime field, since  it contains a logical type.  It is important to remember that <strong>logical types should be specified as nested in the type descriptions of the field</strong> . </p><br><p>  wrong: </p><br><pre> <code class="hljs objectivec">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"datetime"</span></span>, <span class="hljs-string"><span class="hljs-string">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"long"</span></span>, <span class="hljs-string"><span class="hljs-string">"logicalType"</span></span>: <span class="hljs-string"><span class="hljs-string">"timestamp-millis"</span></span> },</code> </pre> <br><p>  right: </p><br><pre> <code class="hljs objectivec">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"datetime"</span></span>, <span class="hljs-string"><span class="hljs-string">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"long"</span></span>, <span class="hljs-string"><span class="hljs-string">"logicalType"</span></span>: <span class="hljs-string"><span class="hljs-string">"timestamp-millis"</span></span> } },</code> </pre> <br><p>  Next comes the source field declared as union <code>"type": ["null", "string"]</code> , this entry means that the value of source can be one of two types <code>null</code> or <code>string</code> .  This way you can combine not only primitive types, but also composite and logical ones.  Examples of such combinations, as well as more complex schemes can be found <a href="https://github.com/tebeka/fastavro/blob/master/tests/test_complex.py">here.</a> <br>  Another non-obvious point is related to <code>default</code> : the <code>default</code> <strong>value should be set for the first type in the enumeration</strong> . </p><br><p>  wrong: </p><br><pre> <code class="hljs objectivec">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"f"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: [<span class="hljs-string"><span class="hljs-string">"long"</span></span>, <span class="hljs-string"><span class="hljs-string">"string"</span></span>], <span class="hljs-string"><span class="hljs-string">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"asd"</span></span> },</code> </pre> <br><p>  right: </p><br><pre> <code class="hljs objectivec">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"f"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: [<span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-string"><span class="hljs-string">"long"</span></span>], <span class="hljs-string"><span class="hljs-string">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"asd"</span></span> },</code> </pre> <br><p>  The logical types are Decimal (fixed-point number) and UUID. </p><br><p>  Decimal requires additional parameters - the number of characters in the number and the number of decimal places: </p><br><pre> <code class="hljs json"> { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"money"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"doc"</span></span>: <span class="hljs-string"><span class="hljs-string">"16 , 4  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"bytes"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logicalType"</span></span>: <span class="hljs-string"><span class="hljs-string">"decimal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"precision"</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scale"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, } }</code> </pre> <br><p>  And the UUID is interesting because it is not in the specification, but its implementation <a href="">is</a> .  What is rather strangely done - the UUID is encoded as a string. </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"uuid"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logicalType"</span></span>: <span class="hljs-string"><span class="hljs-string">"uuid"</span></span> } }</code> </pre> <br><p>  I had to add such an implementation to fastavro. </p><br><h1 id="primery-raboty-s-fastavro">  Examples of working with fastavro </h1><br><h3 id="kak-prochitat-iz-konteynera">  How to read from the container </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fastavro <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> avro <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'some-file.avro'</span></span>, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> fo: <span class="hljs-comment"><span class="hljs-comment">#       reader_schema reader = fastavro.reader(fo, reader_schema=None) schema = reader.schema for record in reader: process_record(record)</span></span></code> </pre> <br><h3 id="kak-zapisat-v-konteyner">  How to write to container </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fastavro <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> writer schema = { <span class="hljs-string"><span class="hljs-string">'doc'</span></span>: <span class="hljs-string"><span class="hljs-string">'A weather reading.'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span>: <span class="hljs-string"><span class="hljs-string">'Weather'</span></span>, <span class="hljs-string"><span class="hljs-string">'namespace'</span></span>: <span class="hljs-string"><span class="hljs-string">'test'</span></span>, <span class="hljs-string"><span class="hljs-string">'type'</span></span>: <span class="hljs-string"><span class="hljs-string">'record'</span></span>, <span class="hljs-string"><span class="hljs-string">'fields'</span></span>: [ {<span class="hljs-string"><span class="hljs-string">'name'</span></span>: <span class="hljs-string"><span class="hljs-string">'station'</span></span>, <span class="hljs-string"><span class="hljs-string">'type'</span></span>: <span class="hljs-string"><span class="hljs-string">'string'</span></span>}, {<span class="hljs-string"><span class="hljs-string">'name'</span></span>: <span class="hljs-string"><span class="hljs-string">'time'</span></span>, <span class="hljs-string"><span class="hljs-string">'type'</span></span>: <span class="hljs-string"><span class="hljs-string">'long'</span></span>}, {<span class="hljs-string"><span class="hljs-string">'name'</span></span>: <span class="hljs-string"><span class="hljs-string">'temp'</span></span>, <span class="hljs-string"><span class="hljs-string">'type'</span></span>: <span class="hljs-string"><span class="hljs-string">'int'</span></span>}, ], } records = [ {<span class="hljs-string"><span class="hljs-string">'station'</span></span>: <span class="hljs-string"><span class="hljs-string">'011990-99999'</span></span>, <span class="hljs-string"><span class="hljs-string">'temp'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'time'</span></span>: <span class="hljs-number"><span class="hljs-number">1433269388</span></span>}, {<span class="hljs-string"><span class="hljs-string">'station'</span></span>: <span class="hljs-string"><span class="hljs-string">'011990-99999'</span></span>, <span class="hljs-string"><span class="hljs-string">'temp'</span></span>: <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-string"><span class="hljs-string">'time'</span></span>: <span class="hljs-number"><span class="hljs-number">1433270389</span></span>}, {<span class="hljs-string"><span class="hljs-string">'station'</span></span>: <span class="hljs-string"><span class="hljs-string">'011990-99999'</span></span>, <span class="hljs-string"><span class="hljs-string">'temp'</span></span>: <span class="hljs-number"><span class="hljs-number">-11</span></span>, <span class="hljs-string"><span class="hljs-string">'time'</span></span>: <span class="hljs-number"><span class="hljs-number">1433273379</span></span>}, {<span class="hljs-string"><span class="hljs-string">'station'</span></span>: <span class="hljs-string"><span class="hljs-string">'012650-99999'</span></span>, <span class="hljs-string"><span class="hljs-string">'temp'</span></span>: <span class="hljs-number"><span class="hljs-number">111</span></span>, <span class="hljs-string"><span class="hljs-string">'time'</span></span>: <span class="hljs-number"><span class="hljs-number">1433275478</span></span>}, ] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'weather.avro'</span></span>, <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> out: writer(out, schema, records)</code> </pre> <br><h3 id="kak-serializovat-i-deserializovat-dannye-vne-konteynera">  How to serialize and deserialize data outside the container </h3><br><p>  Used when transferring data as messages. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> io <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BytesIO <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fastavro <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(schema, data)</span></span></span><span class="hljs-function">:</span></span> bytes_writer = BytesIO() fastavro.schemaless_writer(bytes_writer, schema, data) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bytes_writer.getvalue() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deserialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(schema, binary)</span></span></span><span class="hljs-function">:</span></span> bytes_writer = BytesIO() bytes_writer.write(binary) bytes_writer.seek(<span class="hljs-number"><span class="hljs-number">0</span></span>) data = fastavro.schemaless_reader(bytes_writer, schema) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data</code> </pre> <br><h3 id="kak-podavit-chtenie-logicheskih-tipov">  How to suppress reading of logical types </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fastavro fastavro._reader.LOGICAL_READERS[<span class="hljs-string"><span class="hljs-string">'long-timestamp-millis'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> d, w, r: d</code> </pre> <br><p>  Now the timestamp-millis logical type will be read not in python datetime, but in long. </p><br><h3 id="kak-zaranee-prochitat-shemu">  How to read the scheme in advance </h3><br><p>  In fastavro, the function acquaint_schema is provided, which reads the schema into the internal repository (there are also <a href="https://docs.confluent.io/current/schema-registry/docs/intro.html">exceptions</a> , but this is a separate story). </p><br><p>  Having a scheme </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"decimal_18_6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"namespace"</span></span>: <span class="hljs-string"><span class="hljs-string">"types"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"bytes"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logicalType"</span></span>: <span class="hljs-string"><span class="hljs-string">"decimal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"precision"</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scale"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> }</code> </pre> <br><p>  and downloading it with the help of acquaint_schema you can further use a short description of the types: </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"fields"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"money1"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"types.decimal_18_6"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"money2"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"types.decimal_18_6"</span></span> }, ]</code> </pre> <br><p>  <em>Please note - the name of the type when accessing includes its namespace <strong>types</strong> .decimal_18_6</em> </p><br><p>  It is also necessary in some <a href="https://github.com/tebeka/fastavro/issues/101">non-trivial cases.</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/346698/">https://habr.com/ru/post/346698/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346686/index.html">Projection modeling. Abstracts for beginners</a></li>
<li><a href="../346688/index.html">Anton Arnautov - about accelerators</a></li>
<li><a href="../346692/index.html">‚ÄúThe notion that this framework is outdated is wrong‚Äù: Andrey Gritsevich (Solar Security) about Ext JS</a></li>
<li><a href="../346694/index.html">Software use culture in the company</a></li>
<li><a href="../346696/index.html">Writing a multiplayer snake on tornado</a></li>
<li><a href="../346700/index.html">Undocumented line tag "This is a translation, stupid!" On Habr√©</a></li>
<li><a href="../346702/index.html">We create a portrait of Central Asia that really works: the rules, methods, tips and analysis of errors</a></li>
<li><a href="../346704/index.html">Creating parametric database objects in nanoCAD Mechanics</a></li>
<li><a href="../346706/index.html">Java conference with English roots. XXXL size overview</a></li>
<li><a href="../346708/index.html">Unit testing for applications on the IBM Notes / Domino platform</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>