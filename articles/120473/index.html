<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Image recovery using neural networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once a friend asked for help with his thesis and gave a link to an article that talked about image restoration using Kohonen self-organizing maps. Aft...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Image recovery using neural networks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/e70/832/2d7/e708322d7f51316769adab40d7909287.jpg"><br>  Once a friend asked for help with his thesis and gave a link to <a href="http://jre.cplire.ru/koi/oct10/3/text.html">an article</a> that talked about image restoration using Kohonen self-organizing maps.  After reading the article, I first decided that it was some kind of nonsense, and that the neural network did not fit in with the recovery.  But, I was a bit mistaken, it turned out that this method was quite fascinating, and when I did it, I could not get enough of it. <br><a name="habracut"></a><br><h4>  How does this work? </h4><br>  The Kohonen map is a two-dimensional NXxNY grid consisting of neurons.  Each neuron in the grid is represented by a square SxS - this square is called the weight vector, the values ‚Äã‚Äãof which are equal to the color of the corresponding pixel. <br>  For training, SxS image fragments are sent to the network, after which the network searches for the neuron most similar to this fragment, the so-called BMU (best matching unit), and adjusts its weights so that it looks even more like the submitted fragment.  And then he trains his neighbors, but with less intensity.  The further the neuron is from the BMU, the smaller the contribution to it is made by the submitted fragment.  So the network is trained until the deviations of the BMU for each filed fragment reach a certain minimum value. <br>  Here are a couple of examples, the first picture shows a network 120x120 with 3x3 neurons, and the second picture shows a 24x24 network with 15x15 neurons.  Beauty! <br><img src="https://habrastorage.org/getpro/habr/post_images/224/d28/326/224d28326c35a7dcb179ebbac01c34bc.jpg"><br>  Restoration occurs in a similar way, the SxS fragment of the damaged image is taken, and the BMU is searched for non-damaged pixels, after which the damaged pixels are replaced with the corresponding values ‚Äã‚Äãfrom the neuron weight vector. <br><br><h4>  How does a neural network "see" a picture? </h4><br>  To see how a neural network "sees" a picture, I came up with the following method.  We take a trained neural network, and for each pixel in the picture we create a fragment of SxS, feed it into the neural network, extract the color of the central pixel from it and write this color along the same coordinates, but into a new picture.  The resulting picture reflects the potential recovery image of the neural network.  For experiments, I used this picture <br><br><img src="https://habrastorage.org/getpro/habr/post_images/208/bd0/521/208bd0521b4f37f4cebaa99f0114c851.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Thanks to this method, I have identified several interesting properties. <br><ol><li>  The larger the size of S - the less clear the image is. <br>  The picture shows images created with 3x3 and 15x15 neurons.  As you can see, 3x3 is not much different from the original.  In 15x15 it turns out to be blurred. <br><img src="https://habrastorage.org/getpro/habr/post_images/34c/2d1/f1d/34c2d1f1dfa04015086e52e2213558de.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/5ef/423/ee0/5ef423ee0fabc228fc9ac41cd4d7f0c7.jpg"></li><li>  The more neurons in the network, the greater the palette of colors. <br>  In the first picture, a 4x4 grid was used, and 120x120 in the second.  As you can see, the 4x4 network has sharp transitions between colors. <br><img src="https://habrastorage.org/getpro/habr/post_images/a56/b74/32d/a56b7432d4557ac49a5c1b239c44893f.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/34c/2d1/f1d/34c2d1f1dfa04015086e52e2213558de.jpg"></li><li>  The more iterations of training, the more accurately the restored colors correspond to the colors of the real picture and the better the details are visible.  In the first picture, a 10x10 neural network was used, trained in 10 fragments, and in the second, 10,000 fragments. <br><img src="https://habrastorage.org/getpro/habr/post_images/7c2/825/740/7c2825740cde7eea9f61b5ff4a9f0841.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/a9a/fb9/77e/a9afb977e4183b6ed63ec907f3d1f822.jpg"><br></li></ol><br>  By the way, pay attention, the restoration of a well-trained network of 10x10 and 120x120 visually differs very little, only if you look closely at the details you can find small differences. <br>  I designed the generator in the form of a small <a href="http://dl.dropbox.com/u/159112/som-restore/generate.html">application</a> , so you can play around yourself (checked on webkit and FF). <br><br><h4>  Repair minor accidental damage </h4><br>  Small random damage is easily eliminated by networks with small neurons, for example, 3x3 or 5x5 is enough.  They work quickly and efficiently.  Here is an example of image restoration in which 25% of pixels are damaged, by a 10x10 network and 5x5 neurons. <br><img src="https://habrastorage.org/getpro/habr/post_images/5e6/265/de0/5e6265de0af1485581a667fbd90b087b.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/966/a9f/941/966a9f9419fbedc3bf4191d07ba92762.jpg"><br><br>  To restore accidental damage, also made a separate <a href="http://dl.dropbox.com/u/159112/som-restore/restore.html">application</a> . <br><br><h4>  Recovery of large areas </h4><br>  To restore large damaged areas, it is necessary that the size of the neuron S exceeds the size of the damaged area.  Accordingly, the larger the damage size, the more smeared the reconstructed area will be. <br>  The figure shows the recovery of a 10x10 fragment by a network with a 15x15 neuron. <br><img src="https://habrastorage.org/getpro/habr/post_images/1dc/ccf/be1/1dcccfbe1c626ffd7172f4defaf5ab01.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/b4a/50c/ded/b4a50cdedbf976cefe8c4f01b0b62806.jpg"><br><br><h4>  Recovery at &lt;20% of known pixels </h4><br>  Unfortunately, it is impossible to build a map using such images, so alas, it‚Äôs impossible to restore them directly, but you can restore them if you take an already trained network.  The figure shows an example of image recovery by 12% of known pixels.  The network was trained on the original image. <br><img src="https://habrastorage.org/getpro/habr/post_images/bdd/ee2/bb8/bddee2bb8ac28639a1e7b972dde51077.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/438/309/3bb/4383093bb982f8917069cf2f5c345aac.jpg"><br>  In my opinion it turned out quite well, for such a volume of damage. <br><br>  <b>UPD:</b> about practical applications developed by me, applications: <br>  The purpose of my research is to test the concept, and not provide a working application for all occasions, so all the talk about any serious practical application of the version that exists today does not make any sense. </div><p>Source: <a href="https://habr.com/ru/post/120473/">https://habr.com/ru/post/120473/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../120464/index.html">Summer School of Apple Developers in St. Petersburg</a></li>
<li><a href="../120465/index.html">Four new tablets, laptops and the first smartphone on WP Mango 7.1</a></li>
<li><a href="../120466/index.html">More grabbers. Good and different</a></li>
<li><a href="../120468/index.html">From June 1, the first channel switches to the 16: 9 broadcast format.</a></li>
<li><a href="../120471/index.html">On the issue of cache invalidation</a></li>
<li><a href="../120474/index.html">Gigahertz cheaply - Win 2008R2 Core on Amazon</a></li>
<li><a href="../120475/index.html">Using PowerShell to Administer Microsoft SQL Server</a></li>
<li><a href="../120476/index.html">Dropbox - we get 9GB in one hour</a></li>
<li><a href="../120479/index.html">Creating Qt + PySide Hybrid Applications</a></li>
<li><a href="../120480/index.html">Road to light</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>