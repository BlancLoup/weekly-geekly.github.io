<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automated test report generation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 It so happened that in our company we keep records of testing work in well-known GoogleDocs. Since I am engaged in such an account alon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automated test report generation</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  It so happened that in our company we keep records of testing work in well-known GoogleDocs.  Since I am engaged in such an account alone, this is an ideal option.  Plus, there is still the opportunity to easily share the developments with colleagues and no need to worry about the relevance of the versions - everything is saved instantly. <br>  These are the main reasons for the chosen job.  But, as you know, any coin has two sides.  The disadvantage of this approach is that large projects are difficult to process and produce sane test reports (test management systems are certainly suitable for this purpose). <br>  Most recently, I ran into Google Script.  This tool allows you to work with documents in the cloud much more efficiently.  I decided that it would be suitable for the task of automated test reporting.  And that's what happened. <br><br><h5>  Structure </h5><br>  In a tabular document, I write descriptions of user scripts for testing applications.  I do not pretend to a detailed description, but the most critical information is available there, namely: the section to which the script relates, the name of the script itself, the steps of the script, the status of the passed script, comments and a link to the page with a description of the error in the bug tracker.  The set of statuses with us is usually limited to ‚ÄúImplemented‚Äù, ‚ÄúDefect‚Äù, ‚ÄúPostponed‚Äù.  On some projects, others may be added, but not the essence.  It looks like this: <br><br><img src="https://habrastorage.org/storage3/145/f3f/29e/145f3f29e444b59e9c4be1ab3ff5d2b6.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Obviously, such scenarios are not convenient to keep on one page - it makes sense to split into several sheets (for example, by stages or releases). <br><br><h5>  Task </h5><br>  It is necessary to simplify the tester's life as much as possible when writing test reports.  Ideal would be the option where you can see a summary of the sections and the project as a whole, as well as not only get a list of errors and links to them, but also look at the overall picture. <br><br><h5>  Decision </h5><br>  As a solution, I chose a table divided by sections.  Each line corresponds to the test scenario and is colored in the appropriate color (red for defects, green for finished tasks, yellow for the rest).  At the same time, statistics for each of the sections are summarized separately (how many errors, how many successful scenarios, how many others, the same as a percentage) and for the entire project as a whole. <br>  This is the type of report for scripts: <br><br><img src="https://habrastorage.org/storage3/908/e9d/1e5/908e9d1e5219bf640fa72211346cd501.jpg" alt="image"><br><br>  Here's what happened for the statistics: <br><br><img src="https://habrastorage.org/storage3/424/3b4/53d/4243b453de8ead6dc90d7e019dd80c55.jpg" alt="image"><br><a name="habracut"></a><br><h5>  How to do it? </h5><br>  First we need to create a script inside the document.  This is done in just a few minutes. <br>  First you need to create a table on Google Drive. <br><img src="https://habrastorage.org/storage3/a44/bb9/cf8/a44bb9cf8764750cacc280345afc2d80.jpg" alt="image"><br><br>  Then go to the "Tools" menu and select "Script Editor" <br><img src="https://habrastorage.org/storage3/444/b51/1c2/444b511c2581741703a9767e0ed3e8fd.jpg" alt="image"><br><br>  After that, select the menu item "Empty Project", erase the code and start writing your own. <br>  First, let's write the onOpen function: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onOpen</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> spreadsheet = SpreadsheetApp.getActive(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> menuItems = [ {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'   '</span></span>, <span class="hljs-attr"><span class="hljs-attr">functionName</span></span>: <span class="hljs-string"><span class="hljs-string">'generateReport_'</span></span>} ]; spreadsheet.addMenu(<span class="hljs-string"><span class="hljs-string">''</span></span>, menuItems); }</code> </pre> <br>  This will help us add a menu item to the toolbar: <br><img src="https://habrastorage.org/storage3/222/2b5/2d4/2222b52d401d5f70ceb35378a1eeaf6e.jpg" alt="image"><br><br>  Next, we write a function that will be called when this menu item is selected: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateReport_</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      var columns = ['', ' ', '', '', '']; //     var reportColumns = [' ', '', '', '']; //        var Data = getAllCases(columns); //     CreateNewSheet(); //     var stat = FormReport(Data, reportColumns); ShowStat(stat); }</span></span></code> </pre><br>  Well, now in order. <br>  The function runs over all sheets of the open file and reads all the information for the report: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAllCases</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">columns</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheets = SpreadsheetApp.getActive().getSheets(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (q=<span class="hljs-number"><span class="hljs-number">0</span></span>; q&lt;sheets.length; q++) { SpreadsheetApp.getActive().setActiveSheet(sheets[q]); data.push(getCases(columns)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data; }</code> </pre><br>  The function forms an array for output in a readable form.  There is one feature here - if you swap fields on different sheets, then nothing terrible will happen.  The parts array contains lists of sections by which scripts are grouped, and its elements are the name of the section and the list of scripts as an array: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCases</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">columns</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = SpreadsheetApp.getActiveSheet().getDataRange().getValues(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fields = FindFields(range[<span class="hljs-number"><span class="hljs-number">0</span></span>], columns); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parts = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">1</span></span>; i&lt;range.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (range[i][fields[<span class="hljs-number"><span class="hljs-number">0</span></span>]] != <span class="hljs-string"><span class="hljs-string">''</span></span>) { parts.push(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>()); parts[parts.length<span class="hljs-number"><span class="hljs-number">-1</span></span>][<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = range[i][fields[<span class="hljs-number"><span class="hljs-number">0</span></span>]]; parts[parts.length<span class="hljs-number"><span class="hljs-number">-1</span></span>][<span class="hljs-string"><span class="hljs-string">'scen'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (range[i][fields[<span class="hljs-number"><span class="hljs-number">1</span></span>]] != <span class="hljs-string"><span class="hljs-string">''</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> title = range[i][fields[<span class="hljs-number"><span class="hljs-number">1</span></span>]]; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (range[i][fields[<span class="hljs-number"><span class="hljs-number">2</span></span>]] != <span class="hljs-string"><span class="hljs-string">''</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scen = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(); scen.push(title); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">2</span></span>; j&lt;fields.length; j++) { scen.push(range[i][fields[j]]); } parts[parts.length<span class="hljs-number"><span class="hljs-number">-1</span></span>][<span class="hljs-string"><span class="hljs-string">'scen'</span></span>].push(scen); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parts; }</code> </pre><br>  Actually, this is a function, due to which it is not so scary to confuse the columns on the script pages: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindFields</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, columns</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fields = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;columns.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;data.length; j++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (columns[i] == data[j]) fields.push(j); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fields; }</code> </pre><br>  To create a new sheet with a report: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateNewSheet</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ SpreadsheetApp.getActive().insertSheet(<span class="hljs-string"><span class="hljs-string">''</span></span>); SpreadsheetApp.setActiveSheet(SpreadsheetApp.getActive().getSheetByName(<span class="hljs-string"><span class="hljs-string">''</span></span>)); }</code> </pre><br>  Formation of the report itself, the collection of statistics and some design: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FormReport</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, columns</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = SpreadsheetApp.getActive(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stat = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]; doc.appendRow(columns); doc.setColumnWidth(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">300</span></span>); doc.setColumnWidth(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>); doc.setColumnWidth(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">300</span></span>); doc.setColumnWidth(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">300</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;data.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j=<span class="hljs-number"><span class="hljs-number">0</span></span>; j&lt;data[i].length; j++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> temp = WritePart(data[i][j], columns); stat[<span class="hljs-number"><span class="hljs-number">0</span></span>] += +temp[<span class="hljs-number"><span class="hljs-number">0</span></span>]; stat[<span class="hljs-number"><span class="hljs-number">1</span></span>] += +temp[<span class="hljs-number"><span class="hljs-number">1</span></span>]; stat[<span class="hljs-number"><span class="hljs-number">2</span></span>] += +temp[<span class="hljs-number"><span class="hljs-number">2</span></span>]; stat[<span class="hljs-number"><span class="hljs-number">3</span></span>] += +temp[<span class="hljs-number"><span class="hljs-number">3</span></span>]; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stat; }</code> </pre><br>  The function of outputting information on a single section to a report and generating statistics on it, as well as a design for a more pleasant reading: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WritePart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, columns</span></span></span><span class="hljs-function">) </span></span>{ SpreadsheetApp.getActive().appendRow([data[<span class="hljs-string"><span class="hljs-string">'name'</span></span>]]).set; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line).setFontSize(<span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defects = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> done = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> skipped = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> other = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (k=<span class="hljs-number"><span class="hljs-number">0</span></span>; k&lt;data[<span class="hljs-string"><span class="hljs-string">'scen'</span></span>].length; k++) { SpreadsheetApp.getActive().appendRow(data[<span class="hljs-string"><span class="hljs-string">'scen'</span></span>][k]); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> line = SpreadsheetApp.getActive().getLastRow(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (data[<span class="hljs-string"><span class="hljs-string">'scen'</span></span>][k][<span class="hljs-number"><span class="hljs-number">1</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>: defects++; SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'red'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>: done++; SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'green'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>: skipped++; SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'yellow'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: other++; SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'yellow'</span></span>); } } SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'  :'</span></span>]); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">':'</span></span>, done, (done/(done+defects+skipped+other)*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"B"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'green'</span></span>); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">':'</span></span>, defects, (defects/(done+defects+skipped+other)*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"B"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'red'</span></span>); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">':'</span></span>, skipped, (skipped/(done+defects+skipped+other)*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"B"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'yellow'</span></span>); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">':'</span></span>, other, (other/(done+defects+skipped+other)*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"B"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":D"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'yellow'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stat = [defects, done, skipped, other]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stat; }</code> </pre><br>  And finally, the final statistics and a lot of design: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShowStat</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stat</span></span></span><span class="hljs-function">) </span></span>{ SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">'  :'</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line).setFontSize(<span class="hljs-number"><span class="hljs-number">20</span></span>); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">':'</span></span>, stat[<span class="hljs-number"><span class="hljs-number">1</span></span>], (stat[<span class="hljs-number"><span class="hljs-number">1</span></span>]/(stat[<span class="hljs-number"><span class="hljs-number">0</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">1</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">2</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">3</span></span>])*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":C"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'green'</span></span>); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">':'</span></span>, stat[<span class="hljs-number"><span class="hljs-number">0</span></span>], (stat[<span class="hljs-number"><span class="hljs-number">0</span></span>]/(stat[<span class="hljs-number"><span class="hljs-number">0</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">1</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">2</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">3</span></span>])*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":C"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'red'</span></span>); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">':'</span></span>, stat[<span class="hljs-number"><span class="hljs-number">2</span></span>], (stat[<span class="hljs-number"><span class="hljs-number">2</span></span>]/(stat[<span class="hljs-number"><span class="hljs-number">0</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">1</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">2</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">3</span></span>])*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":C"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'yellow'</span></span>); SpreadsheetApp.getActive().appendRow([<span class="hljs-string"><span class="hljs-string">':'</span></span>, stat[<span class="hljs-number"><span class="hljs-number">3</span></span>], (stat[<span class="hljs-number"><span class="hljs-number">3</span></span>]/(stat[<span class="hljs-number"><span class="hljs-number">0</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">1</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">2</span></span>]+stat[<span class="hljs-number"><span class="hljs-number">3</span></span>])*<span class="hljs-number"><span class="hljs-number">100</span></span>).toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"%"</span></span>]); line = SpreadsheetApp.getActive().getLastRow(); SpreadsheetApp.getActive().getRange(<span class="hljs-string"><span class="hljs-string">"A"</span></span>+line+<span class="hljs-string"><span class="hljs-string">":C"</span></span>+line).setBackground(<span class="hljs-string"><span class="hljs-string">'yellow'</span></span>); }</code> </pre><br>  For a full build, you need all these functions in any sequence in the script file. <br>  The code is not perfect - there is something to work on, but if it is useful to someone, I will be happy to answer questions. <br><h5>  Conclusion </h5><br>  I gave one example of using scripts from Google.  We have to admit that it is quite a powerful tool for working with documents.  At least he coped well with this task.  There are more examples of the use of scripts to help in the work, for example, <a href="http://habrahabr.ru/post/193376/">this is an interesting article</a> .  Apparently, Google Script can be a great helper in the everyday life of IT‚Äôs. </div><p>Source: <a href="https://habr.com/ru/post/195820/">https://habr.com/ru/post/195820/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../195810/index.html">Repairing a car with a 3D printer</a></li>
<li><a href="../195812/index.html">Derby.js deploy on Amazon EC2</a></li>
<li><a href="../195814/index.html">Timers in .Net</a></li>
<li><a href="../195816/index.html">Javascript function argument schema or C-style prototypes without heavyweight frameworks</a></li>
<li><a href="../195818/index.html">Go: multithreading</a></li>
<li><a href="../195830/index.html">We write a game development framework - Mechanic Framework</a></li>
<li><a href="../195832/index.html">Binary heap: proof of the complexity of the construction of O (n)</a></li>
<li><a href="../195834/index.html">Linear representation of an octree using the Morton code</a></li>
<li><a href="../195836/index.html">Methods for solving color perception problems</a></li>
<li><a href="../195838/index.html">Methods of forming a measurement with attributes type 1 and 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>