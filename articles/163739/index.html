<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We improve the experience of interaction with forms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often students ask me: ‚ÄúWhich element of the site is the most important?‚Äù, To which I answer them - forms. After all, with the help of forms, users pe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We improve the experience of interaction with forms</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/2e7/005/623/2e7005623c89574fa8b4bb2f43a3aea4.jpg" align="left">  Often students ask me: ‚ÄúWhich element of the site is the most important?‚Äù, To which I answer them - forms.  After all, with the help of forms, users perform almost all conversion actions.  It is with this element that most problems are associated.  In this article I will try to tell you what can be improved when interacting with forms.  And at the same time to describe the new features of working with them in browsers. <br><br>  However, first I would like to indicate my position on the development of such forms.  In my opinion, the right approach when developing interfaces is a progressive improvement approach. <br><a name="habracut"></a><br>  Alexander Pershin spoke in detail about this approach in his article <a href="http://htmlacademy.ru/blog/7">Progressive Enhancement</a> .  If you still have not encountered it, then I highly recommend reading it. <br><br>  Another caveat: I do not think that the interface should work and look the same in all browsers.  I am firmly convinced that you should not torment users with old browsers with your multi-kilo byte libraries - they are already without it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Browser statistics of the RuNet </h4><br>  Since I will be showing approaches using new features of browsers, take a look at the current runet statistics.  Everyone can determine for themselves the degree of user readiness.  I divided it into two categories: full and partial support. <br><br>  All receptions in this article will be <b>estimated by 56.8% of</b> users.  In this statistics there are browsers: IE 10, Firefox 11-17, Chrome 4-24, Safari 6, Opera 12. <br><br>  Some receptions will be appreciated by <b>80.1% of</b> users.  This additionally included support: IE 8-9, Safari 4-5, Opera 10-11. <br><br>  Mobile browsers did not include statistics, although they would give an even greater percentage of support.  Information was taken from <a href="http://www.liveinternet.ru/stat/ru/browsers.html%3Fslice%3Dru%3Bperiod%3Dmonth">LiveInternet with a slice in Russia</a> .  The average traffic for 3 months (October-December) of 2012 got into the calculation. <br><br><h4>  New HTML5 Attribute Forms </h4><br>  For a start, let me remind you of the new attributes of the form fields that will be used: <code>required</code> , <code>autofocus</code> , <code>placeholder</code> . <br><br><ul><li>  <code>required</code> - required field; </li><li>  <code>autofocus</code> - setting the focus on the field when loading the page; </li><li>  <code>placeholder</code> - field description. </li></ul><br>  Along with this, many new field types have appeared: <code>date</code> , <code>email</code> , <code>number</code> , <code>range</code> and others.  However, the most innocuous of them ( <code>email</code> ) is still used with caution.  But in order for it to earn special action is not necessary.  Browsers that do not know this type of field will consider it text. <br><br>  There are also additional selectors in CSS: <code>E:valid</code> , <code>E:invalid</code> , <code>E:required</code> - with which you can describe the style design of fields in different situations. <br><br>  <a href="http://simonenko.su/dev/improve-web-form/attributes.html">Demonstration of the work of new attributes of fields and their design.</a> <br><br>  Such an approach, of course, will not work in older browsers.  However, since we are progressively improving the shape, this should not bother us too much.  <b>The form remains to work even in older browsers.</b>  In any case, validation of the entered data should occur on the server side.  Take it as a rule not to trust user data and always completely check them on the server. <br><br><h4>  Write form data as you type </h4><br>  One of the common problems of filling out forms is that the data entered is lost.  This can happen for various reasons: site error, following the link, in the end, the Internet can be disconnected.  You can solve this problem in different ways, for example, write data to <code>localStorage</code> as you type. <br><br><blockquote><ol><li>  <font color="#000066">if</font> <font color="#009900">(</font> window. <font color="#660066">localStorage</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#003366">var</font> elements <font color="#339933">=</font> document.  <font color="#660066">querySelectorAll</font> <font color="#009900">(</font> <font color="#3366CC">'[name]'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  <font color="#000066">for</font> <font color="#009900">(</font> <font color="#003366">var</font> i <font color="#339933">=</font> <font color="#CC0000">0</font> <font color="#339933">,</font> length <font color="#339933">=</font> elements. <font color="#660066">length</font> <font color="#339933">;</font> i <font color="#339933">&lt;</font> length <font color="#339933">;</font> i <font color="#339933">++</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#009900">(</font> <font color="#003366">function</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#003366">var</font> <font color="#000066">name</font> <font color="#339933">=</font> element.  <font color="#660066">getAttribute</font> <font color="#009900">(</font> <font color="#3366CC">'name'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  element.  <font color="#660066">value</font> <font color="#339933">=</font> localStorage.  <font color="#660066">getItem</font> <font color="#009900">(</font> <font color="#000066">name</font> <font color="#009900">)</font> <font color="#339933">||</font>  <font color="#3366CC">''</font> <font color="#339933">;</font> </li><li></li><li>  element.  <font color="#660066">onkeyup</font> <font color="#339933">=</font> <font color="#003366">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  localStorage.  <font color="#660066">setItem</font> <font color="#009900">(</font> <font color="#000066">name</font> <font color="#339933">,</font> element. <font color="#660066">value</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#009900">(</font> elements <font color="#009900">[</font> i <font color="#009900">]</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li></ol></blockquote><br><br><h4>  Validation of the form and sending data by Ajax </h4><br>  Since we use the <code>required</code> attributes, we can also do the validation in a new way.  In the <a href="http://www.w3.org/TR/html5/">HTML5</a> specification for the form element, the <code>checkValidity()</code> method has been added.  It returns <code>true</code> or <code>false</code> .  The form's working strategy will be very simple: if the validation check gives a negative result, we block sending the form, otherwise, we allow sending. <br><br><blockquote><ol><li>  submit.  <font color="#660066">disabled</font> <font color="#339933">=</font> <font color="#339933">!</font>  form.  <font color="#660066">checkValidity</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li></ol></blockquote><br><br>  Now we add the ability to send the form without reloading, using Ajax.  With the second version of the <a href="http://www.w3.org/TR/XMLHttpRequest/">XMLHttpRequest</a> specification, we got a lot of interesting things.  For example, we can no longer engage in collecting data to submit a form, for this there is a <code>FormData</code> object. <br><br><blockquote><ol><li>  form.  <font color="#660066">onsubmit</font> <font color="#339933">=</font> <font color="#003366">function</font> <font color="#009900">(</font> event <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#000066">if</font> <font color="#009900">(</font> window. <font color="#660066">FormData</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  event.  <font color="#660066">preventDefault</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  <font color="#003366">var</font> data <font color="#339933">=</font> <font color="#003366">new</font> FormData <font color="#009900">(</font> form <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#003366">var</font> xhr <font color="#339933">=</font> <font color="#003366">new</font> XMLHttpRequest <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#003366">var</font> url <font color="#339933">=</font> form.  <font color="#660066">getAttribute</font> <font color="#009900">(</font> <font color="#3366CC">'action'</font> <font color="#009900">)</font> <font color="#339933">+</font> <font color="#3366CC">'? time ='</font> <font color="#339933">+</font> <font color="#009900">(</font> <font color="#003366">new</font> Date <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> .  <font color="#660066">getTime</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  xhr.  <font color="#000066">open</font> <font color="#009900">(</font> <font color="#3366CC">'post'</font> <font color="#339933">,</font> url <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  xhr.  <font color="#660066">onreadystatechange</font> <font color="#339933">=</font> <font color="#003366">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#000066">if</font> <font color="#009900">(</font> xhr. <font color="#660066">readyState</font> <font color="#339933">==</font> <font color="#CC0000">4</font> <font color="#339933">&amp;&amp;</font> xhr. <font color="#000066">status</font> <font color="#339933">==</font> <font color="#CC0000">200</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#006600">// server response: xhr.responseText</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#339933">;</font> </li><li>  xhr.  <font color="#660066">send</font> <font color="#009900">(</font> data <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#339933">;</font> </li></ol></blockquote><br><br>  When working with asynchronous requests, be aware that some browsers cache the result.  For example, this makes Internet Explorer, Mobile Safari (iOS 6) and others.  To avoid this problem, you can add the current time to the request address. <br><br>  Now we get the answer from the server in text form ( <code>xhr.responseText</code> ), but this will change over time.  For example, if we know for sure that the answer is JSON, we can get a JavaScript object right away. <br><br><blockquote><ol><li>  <font color="#003366">var</font> xhr <font color="#339933">=</font> <font color="#003366">new</font> XMLHttpRequest <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  xhr.  <font color="#000066">open</font> <font color="#009900">(</font> method <font color="#339933">,</font> url <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  xhr.  <font color="#660066">responseType</font> <font color="#339933">=</font> <font color="#3366CC">'json'</font> <font color="#339933">;</font> </li><li></li><li>  xhr.  <font color="#660066">onreadystatechange</font> <font color="#339933">=</font> <font color="#003366">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#000066">if</font> <font color="#009900">(</font> xhr. <font color="#660066">readyState</font> <font color="#339933">==</font> <font color="#CC0000">4</font> <font color="#339933">&amp;&amp;</font> xhr. <font color="#000066">status</font> <font color="#339933">==</font> <font color="#CC0000">200</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#006600">// server response: xhr.response</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#339933">;</font> </li><li></li><li>  xhr.  <font color="#660066">send</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li></ol></blockquote><br><br>  Please note that the server response will be in the <code>xhr.response</code> property.  And the <code>xhr.responseType</code> property can take other values, for example: <code>arraybuffer</code> , <code>blob</code> , <code>document</code> . <br><br>  <a href="http://simonenko.su/dev/improve-web-form/localstorage.html">Demonstration of saving form data and sending it using XMLHttpRequest.</a> <br><br>  After successfully submitting the form, I advise you to leave the contact information in <code>localStorage</code> and clear the rest.  Thus, if the user wants to submit the form again, some of the information will already be filled out. <br><br><h4>  Preview of uploaded photos </h4><br>  Smoothly go to work with files in the forms.  Until recently, there was almost no means for working with files.  But everything changes.  Let's start with the simple - new attributes for file upload fields. <br><br><ul><li>  <code>multiple</code> - allows you to select multiple files; </li><li>  <code>accept</code> - allows you to specify which files to select. </li></ul><br>  Suppose we want to add the ability to upload several photos to our form.  This field will look something like this. <br><br><blockquote><ol><li>  <font color="#009900">&lt; <font color="#000000">input</font> <font color="#000066">type</font> <font color="#66cc66">=</font> <font color="#ff0000">"file"</font> <font color="#000066">name</font> <font color="#66cc66">=</font> <font color="#ff0000">"image"</font> <font color="#000066">accept</font> <font color="#66cc66">=</font> <font color="#ff0000">"image / *</font> multiple <font color="#ff0000">"</font> &gt;</font> </li></ol></blockquote><br><br>  I want to remind: a field with such attributes will work in older browsers.  The constraint will be: <br><br><ol><li>  Only one file; </li><li>  File validation is performed on the server side. </li></ol><br>  Let's try to improve the experience of interacting with files.  Once we expect users to add photos, it is logical to make a preview possible.  For this we will use the <code>FileReader</code> object from the <a href="http://www.w3.org/TR/FileAPI/">File API</a> specification. <br><br><blockquote><ol><li>  document.  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'[type = file]'</font> <font color="#009900">)</font> .  <font color="#660066">addEventListener</font> <font color="#009900">(</font> <font color="#3366CC">'change'</font> <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#009900">[</font> <font color="#009900">]</font> .  <font color="#660066">forEach</font> .  <font color="#660066">call</font> <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">files</font> <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> file <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#000066">if</font> <font color="#009900">(</font> file. <font color="#660066">type</font> . <font color="#660066">match</font> <font color="#009900">(</font> <font color="#009966">/image.*/</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#003366">var</font> reader <font color="#339933">=</font> <font color="#003366">new</font> FileReader <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  reader.  <font color="#000066">onload</font> <font color="#339933">=</font> <font color="#003366">function</font> <font color="#009900">(</font> event <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#003366">var</font> img <font color="#339933">=</font> document.  <font color="#660066">createElement</font> <font color="#009900">(</font> <font color="#3366CC">'img'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  img.  <font color="#660066">src</font> <font color="#339933">=</font> event.  <font color="#660066">target</font> .  <font color="#660066">result</font> <font color="#339933">;</font> </li><li></li><li>  div.  <font color="#660066">appendChild</font> <font color="#009900">(</font> img <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  queue.  <font color="#660066">push</font> <font color="#009900">(</font> <font color="#009900">{</font> file <font color="#339933">:</font> file <font color="#339933">,</font> element <font color="#339933">:</font> img <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">;</font> </li><li></li><li>  reader.  <font color="#660066">readAsDataURL</font> <font color="#009900">(</font> file <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> </li></ol></blockquote><br><br>  Thus, we immediately display all selected photos on the site. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bba/afc/9b7/bbaafc9b7243a74bb2cbb53eb7cd59a3.jpg"><br><br>  And in order to send them using Ajax, we collect them in an array <code>queue</code> .  Earlier in the article we used the <code>FormData</code> object, now we just add a list of files to it. <br><br><blockquote><ol><li>  <font color="#003366">var</font> data <font color="#339933">=</font> <font color="#003366">new</font> FormData <font color="#009900">(</font> form <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  queue.  <font color="#660066">forEach</font> <font color="#009900">(</font> <font color="#003366">function</font> <font color="#009900">(</font> element <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  data.  <font color="#660066">append</font> <font color="#009900">(</font> <font color="#3366CC">'image'</font> <font color="#339933">,</font> element. <font color="#660066">file</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li></ol></blockquote><br><br>  That's all, the rest remains the same.  The form will be sent with files without rebooting. <br><br>  <a href="http://simonenko.su/dev/improve-web-form/ajax-upload.html">Demonstration of previewing photos and sending them using Ajax.</a> <br><br><h4>  Drag and drop files </h4><br>  Let's try to pay more attention to the files.  Add the ability to drag files from your computer immediately to the form.  In this case, the logic of previewing and sending without restarting should remain.  To get started, let's select the work with the preview in a separate function. <br><br><blockquote><ol><li>  <font color="#003366">function</font> previewImages <font color="#009900">(</font> files <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#009900">[</font> <font color="#009900">]</font> .  <font color="#660066">forEach</font> .  <font color="#660066">call</font> <font color="#009900">(</font> files <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> file <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#000066">if</font> <font color="#009900">(</font> file. <font color="#660066">type</font> . <font color="#660066">match</font> <font color="#009900">(</font> <font color="#009966">/image.*/</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#003366">var</font> reader <font color="#339933">=</font> <font color="#003366">new</font> FileReader <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  reader.  <font color="#000066">onload</font> <font color="#339933">=</font> <font color="#003366">function</font> <font color="#009900">(</font> event <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#003366">var</font> img <font color="#339933">=</font> document.  <font color="#660066">createElement</font> <font color="#009900">(</font> <font color="#3366CC">'img'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  img.  <font color="#660066">src</font> <font color="#339933">=</font> event.  <font color="#660066">target</font> .  <font color="#660066">result</font> <font color="#339933">;</font> </li><li></li><li>  div.  <font color="#660066">appendChild</font> <font color="#009900">(</font> img <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  queue.  <font color="#660066">push</font> <font color="#009900">(</font> <font color="#009900">{</font> file <font color="#339933">:</font> file <font color="#339933">,</font> element <font color="#339933">:</font> img <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">;</font> </li><li></li><li>  reader.  <font color="#660066">readAsDataURL</font> <font color="#009900">(</font> file <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li></ol></blockquote><br><br>  For example, a zone with a <code>wrapper</code> class will be a zone for moving files.  Add events for it. <br><br><blockquote><ol><li>  <font color="#003366">var</font> file <font color="#339933">=</font> document.  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'[type = file]'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#003366">var</font> dropzone <font color="#339933">=</font> document.  <font color="#660066">querySelector</font> <font color="#009900">(</font> <font color="#3366CC">'.wrapper'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  file.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> <font color="#3366CC">'change'</font> <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  previewImages <font color="#009900">(</font> <font color="#000066">this</font> . <font color="#660066">files</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#000066">this</font> .  <font color="#660066">value</font> <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  dropzone.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> <font color="#3366CC">'dragover'</font> <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> event <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  event.  <font color="#660066">preventDefault</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  dropzone.  <font color="#660066">classList</font> .  <font color="#660066">add</font> <font color="#009900">(</font> <font color="#3366CC">'active'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  event.  <font color="#660066">dataTransfer</font> .  <font color="#660066">dropEffect</font> <font color="#339933">=</font> <font color="#3366CC">'copy'</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  dropzone.  <font color="#660066">addEventListener</font> <font color="#009900">(</font> <font color="#3366CC">'drop'</font> <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> event <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  event.  <font color="#660066">preventDefault</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  dropzone.  <font color="#660066">classList</font> .  <font color="#660066">remove</font> <font color="#009900">(</font> <font color="#3366CC">'active'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  previewImages <font color="#009900">(</font> event. <font color="#660066">dataTransfer</font> . <font color="#660066">files</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> </li></ol></blockquote><br><br>  As you can see, we have added the start ( <code>dragover</code> ) and end ( <code>drop</code> ) events of moving files.  We transfer all transferred files to <code>previewImages</code> .  Thus, our form works in the same way with files selected through the site and moved from the computer. <br><br><h4>  The process of downloading files (progress bar) </h4><br>  Photos are very large, so try to display the download process.  To visualize this process, I will take the <code>progress</code> element, and you can take a <code>div</code> with a moving background.  The process itself will occur in the <code>progress</code> event of the XMLHttpRequest specification. <br><br><blockquote><ol><li>  <font color="#003366">var</font> xhr <font color="#339933">=</font> <font color="#003366">new</font> XMLHttpRequest <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li></li><li>  xhr.  <font color="#660066">upload</font>  <font color="#660066">addEventListener</font> <font color="#009900">(</font> <font color="#3366CC">'progress'</font> <font color="#339933">,</font> <font color="#003366">function</font> <font color="#009900">(</font> event <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#000066">if</font> <font color="#009900">(</font> event. <font color="#660066">lengthComputable</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  progress.  <font color="#660066">value</font> <font color="#339933">=</font> Math.  <font color="#660066">round</font> <font color="#009900">(</font> <font color="#009900">(</font> event. <font color="#660066">loaded</font> <font color="#339933">*</font> <font color="#CC0000">100</font> <font color="#009900">)</font> <font color="#339933">/</font> event. <font color="#660066">total</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#003366">false</font> <font color="#009900">)</font> <font color="#339933">;</font> </li></ol></blockquote><br><br>  <a href="http://simonenko.su/dev/improve-web-form/drag-and-drop.html">Demonstration of drag &amp; drop and file download progress.</a> <br><br><h4>  Eventually </h4><br>  Our simple form has a number of significant improvements in the UX area. <br><br><ol><li>  Validation occurs at the time of entry; </li><li>  The entered data is remembered until it is sent; </li><li>  Contact details are saved for re-work; </li><li>  Photo preview; </li><li>  The process of downloading files. </li></ol><br>  In this case, since we acted in accordance with the progressive improvement, our form works everywhere: <br><br><ul><li>  in IE 6-7 and other older browsers, </li><li>  with javascript disabled, </li><li>  on mobile devices. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/fe6/9d2/6af/fe69d26affdb8cf06e2bfba1e808a351.jpg"><br>  Work <code>FileReader</code> on iOS 6. <br><br>  I am sure, by improving the UX form, you can find more interesting solutions.  Please add your solutions, tips, criticism in the comments below.  Thank! <br><br><hr>  <a href="http://simonenko.su/38146501854/improving-ux-for-web-form">Original article on the Web Energy blog.</a> </div><p>Source: <a href="https://habr.com/ru/post/163739/">https://habr.com/ru/post/163739/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163727/index.html">Generator of texts on the basis of patterns, Hen Ryaba and Star Wars</a></li>
<li><a href="../163731/index.html">Briefly about the new: Samsung is ready to produce 14-nm FinFET chips</a></li>
<li><a href="../163733/index.html">The Open Republic portal began work in Bashkortostan</a></li>
<li><a href="../163735/index.html">Screenshot Monitor - monitor remote developers</a></li>
<li><a href="../163737/index.html">NeoQuest-2013 (doomsday is canceled)</a></li>
<li><a href="../163741/index.html">Call to Santa Claus</a></li>
<li><a href="../163743/index.html">Searchlight past events ‚Ññ1</a></li>
<li><a href="../163745/index.html">Windows exception handling</a></li>
<li><a href="../163749/index.html">UCLA created a new type of magnetoresistive memory.</a></li>
<li><a href="../163751/index.html">Electric demon and carbon dioxide</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>