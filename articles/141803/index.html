<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pentest on steroids. Automating the process</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With this topic, I spoke at CodeFest. And here I will retell in words what, how and why. 
  

 The report is rather superficial and requires almost no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pentest on steroids. Automating the process</h1><div class="post__text post__text-html js-mediator-article">  <i>With this topic, I <a href="http://codefest.ru/program/2012-03/pentest-on-steroids/">spoke</a> at CodeFest.</i>  <i>And here I will retell in words what, how and why.</i> <br> <a href="https://twitter.com/"><img src="http://img842.imageshack.us/img842/9725/twitri.jpg"></a> <br><br>  The report is rather superficial and requires almost no qualification in the field of information security.  It was designed for the target audience (web developers, testers (not penetration), system administrators, etc.).  It's pretty simple: several utilities, launched, waited, parse the report. <br><br>  Video invitation to the conference: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/7dAQJjGA-DM%3Ffeature%3Doembed&amp;xid=25657,15700022,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhiR7Uz2jkwQYx5xipbosJlnypRMfg" frameborder="0" allowfullscreen=""></iframe><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Pentest </h5><br>  <b>Pentest</b> ( <i>penetration testing</i> ) - assessment of the security of the end node or resource by means and methods of intruders ¬© <a href="http://ru.wikipedia.org/wiki/%25D0%2598%25D1%2581%25D0%25BF%25D1%258B%25D1%2582%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BD%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">Wiki</a> .  Differences from hacking in that (hacking) the task to find any vulnerability for the required purposes, unleash and exploit.  Here is a comprehensive analysis of the goal. <br><br><h5>  What are we doing? </h5><br>  <b>The goal</b> is to automate the penetration testing of a network resource using a black box strategy, obtaining objective results without spending a cent on software. <br><br><h5>  Testing stages </h5><br>  We divide the test into 2 stages: <br><ol><li>  Testing network services </li><li>  Testing web applications (applications) </li></ol><br>  We will look for vulnerabilities, check out exploits that have come out, look for ‚Äúweak‚Äù accounts, configuration errors, and just human negligence. <br><br><h4>  Let's go! </h4><br><div style="text-align:center;"><img src="http://img405.imageshack.us/img405/8837/hackergy.jpg" alt="image"></div><br><br><h5>  Part 1. Network services - Armitage (nmap + msf) </h5><br>  <b>Armitage</b> is a GUI to Metasploit Framework and Nmap.  Visualizes targets, collects data, allows to simplify the process of <s>hacking</s> pentest as a whole. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/03c/98a/b9c/03c98ab9c08a85125b3b78e2731fff1d.jpg" alt="image"></div><br><br>  To imagine more clearly what is at stake, here is the screen: <br><img src="https://habrastorage.org/getpro/habr/post_images/5c8/42f/fef/5c842ffef54af64496cd4ff19cca215e.png" alt="image"><br><br>  <b>Modules</b> <i>(blue)</i> - selection of exploits and post-exploits (they are applied already after the session has been established. For example, to get a dump of configs). <br><br>  <b>Targets</b> <i>(orange)</i> - in fact, the goal.  Depending on the status of the target, its icon changes.  If you just added the necessary host and nothing is known about it, there will be just a ‚Äúblack‚Äù monitor or an equipment icon.  If you managed to install the OS - the OS icon will appear.  And the ‚Äúlast‚Äù state ‚Äî an icon in a red frame with lightning ‚Äî one of the exploits worked, it was possible to establish a shell session. <br><br>  <b>Tabs</b> <i>(green)</i> - the current task activity console <br><br>  Let's go to the process. <br><ul><li>  Add a host (Hosts -&gt; Add Hosts) </li><li>  Click on it right, <a href="">Scan</a> .  At this stage, not the above mentioned Nmap is started, but the port scanning module built into metasploit.  But you can also use Nmap for this task. </li><li>  Attacks -&gt; <a href="">Find Attacks</a> .  At this step, a search is made for available exploits for the services found (a match occurs in open ports). </li><li>  Attacks -&gt; <a href="">Hail Mary</a> .  This is a module to launch exploits one at a time from the step above.  Runs an exploit and waits for a reverse connection.  Note that for this your IP must be ‚Äúwhite‚Äù. </li><li>  We are waiting for the completion of the operation.  The process goes like <a href="">this</a> </li></ul><br>  After the completion of the Hail Mary module, two results await us.  Or the exploit (s) worked (s) and the session (s) was created (s) <br><img src="https://habrastorage.org/getpro/habr/post_images/322/f70/017/322f70017250abe8f99836ddeb717527.jpg" alt="image"><br><br>  Or not <br><img src="https://habrastorage.org/getpro/habr/post_images/b52/594/c12/b52594c120fec3a1d0aa6e0cec7b9461.png" alt="image"><br><br>  After checking the launched network services, a test for resistance to <i>public-</i> exploit can also check the default / common accounts.  To do this, select the Login -&gt; service class -&gt; check all credentials -&gt; Launch checkbox in the menu. <br><br>  <b>Armitage</b> , Metasploit Framework is a part of Metasploit, which can be downloaded <a href="http://www.metasploit.com/download/">here</a> .  <i>The moment:</i> after installation, just 1 time start the console of the framework and close it (initialization of the initial data).  After that, start Armitage and allow it to start the metasploit RPC server. <br><br><h4>  Part 2. Web </h4><br><ul><li>  Nikto </li><li>  Skipfish </li><li>  Havij </li><li>  1337day.com, exploit-db.com </li></ul><br><br>  <i>Moment.</i>  <i>I told about Nikto and Skipfish in the article <a href="http://habrahabr.ru/post/125317/">Review of free tools for pentest web-resources and not only v2</a></i> <br><br>  <b>Nikto</b> is a perl utility to search for gaps like undeleted files (/1.php / info.php), availability of database management scripts (phpmyadmin, phppgadmin, etc.), and simply vulnerable scripts.  This is pretty tight for the latter, since the check is just sending the required HTTP request and looks at the response code (404/200), and not that the script is really susceptible to some kind of exploit already released. <br>  PS In fact, it has not been updated for a long time, you need to look for a replacement (or modify it) ... For now, only paid analogs are still in the know. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0ba/c83/99d/0bac8399d98f774a29f24e0a7cd8fd17.jpg"><br><br>  Product Page - <a href="http://www.cirt.net/nikto2">www.cirt.net/nikto2</a> <br><br>  <b>skipfish</b> <br>  Web Script Scanner for vulnerabilities from Google (now not only <a href="http://en.wikipedia.org/wiki/Micha%25C5%2582_Zalewski">Michal Zalewski</a> works on it).  Looks for all that you can, how much you can (it was almost 5 days), eats traffic and as a result generates a report in html5.  Consider, I‚Äôve put a server to them a couple of times, causing a denial of service, overflowing / tmp (php created sessions with each request). <br><br>  Source codes are downloaded <a href="http://code.google.com/p/skipfish/downloads/list">here</a> , and collected under win can be downloaded <a href="">here</a> (mentioned in <a href="http://habrahabr.ru/post/141698/">this</a> article). <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/52d/b3a/c72/52db3ac72a4ebe398e9241c8201c5094.jpg" alt="image"></a> <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/423/739/f1a/423739f1a885fb9fcfb2eb6da7662e82.jpg" alt="image" align="right"></a>  <b>Havij</b> - finds and unwinds SQL injections.  In general, a piece must have, works clearly, quickly, bypasses some filters (although it was a case, one trivial WAF did not bypass, was tested on the CTF in <a href="http://sibears.ru/labs/ndh2k12_prequals_shortener/">this</a> task).  There are two versions - paid and free.  Differ in functionality.  And one of the most necessary features is the search for an injection in a parameter with a CNC, such as <br>  <i>site.com/users/ <b>sql_inj</b> / topics</i> <br>  which is not in the free version.  There is nothing more to tell, the program has a GUI, everything is extremely clear and convenient :) <br><br>  You can download it <a href="http://itsecteam.com/en/projects/project1_page2.htm">here.</a> <br><br>  <b><a href="http://1337day.com/">1337day.com</a> / <a href="http://exploit-db.com/">exploit-db.com</a></b> <br>  Mainly intended in situations where distributed scripts are found on the target resource.  We go to the sites above and look for exploits for them, and in turn launch (a kind of Hail Mary from Armitage).  It is worth considering the moment that plugins are more often vulnerable to scripts than scripts themselves. <br><br>  <i>Also, when analyzing the web, it can happen that there is a ‚Äúneighboring‚Äù vulnerable application, and through it you can get access to the analyzer and merge the same database, infect it with a virus or perform a deface.</i> <br><br><h5>  What else? </h5><br>  Tulsa nemerenno, it makes no sense to list the <a href="http://sectools.org/">top-sec-list</a> , but some ‚Äúcombines‚Äù can not be called.  True, they already indirectly relate to our topic (remember about 0 cents for software?), But you can try to get the Shareware version. <br><br>  <b>MaxPatrol / XSpider</b> <br>  Domestic products from the company <a href="http://ptsecurity.ru/">Positive Technologies</a> , whose employees <a href="http://habrahabr.ru/company/pt/blog/">also write</a> on Habrahabr.  XSpider (7.8) is a stripped-down version of MaxPatrol.  Practically has nothing in common with previous versions in the 7th branch (it‚Äôs strange that they didn‚Äôt change the major version, because there is every reason for that).  A webinar about XSpider 7.8 (from Oleg Matykov, head of design solutions at Positive Technologies) can be found <a href="http://my.comdi.com/record/40837/">here</a> ( <a href="http://ptsecurity.ru/ics/%25D0%259E.%25D0%259C%25D0%25B0%25D1%2582%25D1%258B%25D0%25BA%25D0%25BE%25D0%25B2_XSpider_7.8.pdf">pdf</a> ). <br>  In general, I would like to say a few words about the new XSpider.  As a minus, I would have brought out the interface, it was too overloaded and ill-conceived (IMHO).  But, of course, we need something different from the product, this scan includes almost the entire article above, excluding some points (for example, skipfish self-educates, and the more often you launch it, the more its dictionary), though this is compensated just head over with constant new product builds.  He himself is crammed, perepichkan well, just with everything you can.  Dictionaries for bruteforce also pleased.  In general, I somehow recently managed to find a vulnerability on a resource (one of the most popular in runet), about which I heard only briefly and no other scanner found it.  Shareware version with restrictions on the number of hosts can be obtained by contacting the PT sales department, and already try out on their resources. <br><br>  <b>Acuentix</b> <br>  Web scanner, easy to use for beginners, very intuitive interface.  The full version can also be asked from the sales department, they are very responsive.  Just keep in mind that later they just flood you with mail - ‚Äúhow do you like our product?‚Äù, ‚ÄúDo not want to buy?‚Äù, Etc. <br><br>  <b>Nessus (OpenVAS)</b> <br>  Nessus and its free analog OpenVAS.  I would call their exploit machines :) Nessus home-version is free, and OpenVAS is free. <br><br><h5>  And what else? </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/516/846/587/5168465874e4890b25511c492c59a6c2.jpg" alt="image"><br><br>  Of course, the hands, manual analysis has not been canceled.  It directly depends on the hands and knowledge of the verifier, a little on luck, and also a little on the ‚Äúenergy hacking‚Äù, about which you will not find articles anywhere.  But this is not the topic of our article (report). <br><br>  <b>Perfect case</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/594/b0a/281/594b0a2811821ede3d03290ba096a89b.jpg" alt="image"><br><br>  This, of course, is a statistical code analysis.  I usually do it in regular intervals (although I did it 2 times in my life, it is a painfully time-consuming process and not always possible), such as <b>grep -nr ‚Äúexec‚Äù ./</b> and analyzing the result obtained.  Although there are scripts for this too, they are usually not applicable, as they are mostly outdated and intended for projects not on frameworks (the times when they wrote without them are over). <br><br><h5>  Examples </h5><br>  Probably, even more experience using utilities is higher (echoes from <a href="http://habrahabr.ru/post/138768/">my history of the</a> beginning of 2011) <br><br>  <b>1.</b> Blackbox, the whole site is checked, such things as CSRF / XSS are found, but nothing like what could ‚Äútangle‚Äù the resource completely. <br>  Armitage-&gt; Host-&gt; Login-&gt; ftp-&gt; check all credentials <br>  And there is <i>anonymous: anonymous</i> , looking by mistake in / var / www <br><br>  <b>2.</b> It seems that I killed 5 days then, leaving the PC only for sleep and food.  CSRF / XSS / <b>phpmyadmin</b> , most likely installed by the package manager, since it was in lower case and written in Apache aliases (respectively, the administrator did not see this script in public html).  PMA invulnerable (the version was vulnerable, but there were not those conditions).  And nothing ... already upset :) Skipfish fell off (just the case with a DOS resource due to scanning).  Resource raised, skipfish scans again and finds a brut ... <br>  site / scripts / config.ini <br>  <b>Bingo!</b>  .ini file, which is given to the Apache as plain text with the configs to connect to the database!  As it was learned later, it was used for some cron-script.  Use in mistakenly supplied PMA. <br><br>  PS As the media says, some of the tools above <a href="http://habrahabr.ru/post/138964/">use</a> Anonymous <a href="http://habrahabr.ru/post/138964/">in their affairs</a> . <br><br>  I have it all.  As a bonus presentation <br><div class="slideshow"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.slideshare.net/slideshow/embed_code/12266608&amp;xid=25657,15700022,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhgC9EB_2NtdASiXJ3ubRg7f_N634w" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></div><br><br>  And demo using Havij and Armitage <i>(I advise to view)</i> . <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/HHuvSGJyCa8%3Ffeature%3Doembed&amp;xid=25657,15700022,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhgPQ0v7_fqsZuR8wYVbQujSFEZi3Q" frameborder="0" allowfullscreen=""></iframe><br><br>  <i>Anyone who mastered - I shake your hand :)</i> <br><br>  upd 05/25/2012: speech record added <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/1sdGNM73Ewc%3Ffeature%3Doembed&amp;xid=25657,15700022,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhjxW0p_cDok065zlSps8fSUjPvMhA" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/141803/">https://habr.com/ru/post/141803/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141796/index.html">HP ProLiant Gen8 - 150 server design enhancements</a></li>
<li><a href="../141797/index.html">Efficient cloud queue management (Azure Queue)</a></li>
<li><a href="../141798/index.html">All the best on Herz'n'im</a></li>
<li><a href="../141801/index.html">Technical customer support via the Internet</a></li>
<li><a href="../141802/index.html">Yota transfers LTE network launch date</a></li>
<li><a href="../141804/index.html">N + 2 useful business books that are definitely worth reading.</a></li>
<li><a href="../141808/index.html">Navitel and AND will release detailed maps of Western Europe</a></li>
<li><a href="../141809/index.html">Correction of errors in large forms</a></li>
<li><a href="../141810/index.html">Yandex launched a search for CERN</a></li>
<li><a href="../141812/index.html">Digium IP phones overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>