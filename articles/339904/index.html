<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Overview of the Luigi Framework for building sequences of tasks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! We opened a completely new direction of learning - BigData , which means that the horizon of materials that we will share with you is expand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Overview of the Luigi Framework for building sequences of tasks</h1><div class="post__text post__text-html js-mediator-article">  Good day!  We opened a completely new direction of learning - <a href="https://otus.ru/lessons/BigData/%3Futm_source%3Dhabr%26utm_medium%3Daffilate%26utm_campaign%3Dbigdata%26utm_term%3Dprofi11.10">BigData</a> , which means that the horizon of materials that we will share with you is expanding a little.  Today we will consider Luigi as part of what is revealed in our course. <br><br>  <a href="https://github.com/spotify/luigi">Luigi</a> is a Python framework for building complex sequences for performing dependent tasks.  Quite a large part of the framework is aimed at transforming data from various sources (MySql, Mongo, redis, hdfs) and using various tools (from starting a process to performing tasks of different types on a Hadoop cluster).  Developed by Spotify and opened as an open source tool in 2012. <br><br>  The most important advantage of the framework is the ability to build sequences of dependent tasks.  The framework resolves dependencies, tracks the execution graph, manages task startup, handles errors with the ability to restart the necessary tasks, allocates workflow resources with the possibility of parallel operation of independent parts of the task graph. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To accomplish all these tasks there are other tools.  This <a href="http://oozie.apache.org/">Oozie</a> , <a href="https://github.com/pinterest/pinball">Pinball</a> , <a href="https://github.com/apache/incubator-airflow">Airflow</a> (is in the status of incubation in Apache - undergoing various checks, recently published a review on <a href="https://habrahabr.ru/company/mailru/blog/339392/">Habr√©</a> ).  In this article, we consider only Luigi. <br><br><img src="https://habrastorage.org/webt/59/de/7e/59de7ef4aa4ad086175249.jpeg"><br><a name="habracut"></a><br>  <b>Installation and documentation</b> <br><br>  To install, you can use the command: <br><br><pre><code class="python hljs">pip install luigi</code> </pre> <br>  Documentation is available <a href="https://luigi.readthedocs.io/en/stable/">here.</a> <br><br>  <b>Task (Task)</b> <br><br>  In the luigi_demo_tasks.py file, we define a class that inherits from luigi.Task.  We add run call for start possibility from the console. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> luigi <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Task, run <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyTask</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Task)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: run()</code> </pre> <br>  We start.  Additionally, we specify the option --local-scheduler so as not to contact the central task scheduler for now. <br><br><pre> <code class="python hljs">python -m luigi_demo_tasks MyTask --local-scheduler</code> </pre> <br>  Note.  The documentation indicates a different way to start without calling run and adding a directory to PYTHONPATH. <br><br>  We see the following result: <br><br><pre> <code class="bash hljs">DEBUG: Checking <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> MyTask() is complete /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/lib/python3.4/dist-packages/luigi/worker.py:334: UserWarning: Task MyTask() without outputs has no custom complete() method is_complete = task.complete() INFO: Informed scheduler that task MyTask__99914b932b has status PENDING INFO: Done scheduling tasks INFO: Running Worker with 1 processes DEBUG: Asking scheduler <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> work... DEBUG: Pending tasks: 1 INFO: [pid 5369] Worker Worker(salt=920153035, workers=1, host=your_host, username=username, pid=5369) running MyTask() INFO: [pid 5369] Worker Worker(salt=920153035, workers=1, host=your_host username=username, pid=5369) <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> MyTask() DEBUG: 1 running tasks, waiting <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> next task to finish INFO: Informed scheduler that task MyTask__99914b932b has status DONE DEBUG: Asking scheduler <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> work... DEBUG: Done DEBUG: There are no more tasks to run at this time INFO: Worker Worker(salt=920153035, workers=1, host=your_host, username=username, pid=5369) was stopped. Shutting down Keep-Alive thread INFO: ===== Luigi Execution Summary ===== Scheduled 1 tasks of <span class="hljs-built_in"><span class="hljs-built_in">which</span></span>: * 1 ran successfully: - 1 MyTask() This progress looks :) because there were no failed tasks or missing external dependencies ===== Luigi Execution Summary =====</code> </pre><br>  In the messages we see that the MyTask task is being executed and successfully executed.  Restarting gives exactly the same result. <br><br>  Let's do it now so that MyTask does some work.  To do this, override the run method from the base class: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> luigi <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Task, run <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyTask</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Task)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">"Hello world!"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: run()</code> </pre> <br>  In the information about the task will see the following: <br><br><pre> <code class="bash hljs">INFO: [pid 7448] Worker Worker(salt=857719525, workers=1, host=your_host, username=username, pid=7448) running MyTask() Hello world! INFO: [pid 7448] Worker Worker(salt=857719525, workers=1, host=your_host, username=username, pid=7448) <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> MyTask()</code> </pre> <br>  <b>Single task guarantee</b> <br><br>  It often happens that it is necessary to perform a certain task once.  For example, due to the fact that its implementation is resource-intensive.  In Luigi, a task is considered done if an object is generated (a file on the machine, a file in hdfs, an artifact in MySql, a table in Hive, and others), and you can check its existence.  To specify an object, you must override the output method in the task and return any heir or heirs of the Target class in it.  For example, we will use the LocalTarget file in the local file system. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> luigi <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Task, run, LocalTarget <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyTask</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Task)</span></span></span><span class="hljs-class">:</span></span> filename = <span class="hljs-string"><span class="hljs-string">"hello_file.txt"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(self.filename, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: f.write(<span class="hljs-string"><span class="hljs-string">"Hello world!"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> LocalTarget(self.filename) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: run()</code> </pre> <br>  The first task launch generates the file hello_file.txt.  Restarting the task tells us that all tasks have been completed. <br><br>  <b>Dependent tasks</b> <br><br>  In luigi tasks may depend on other tasks.  To indicate a dependency on another task, you must override the method requires.  In it, return the object of the class of any other task.  We define two dependent tasks, each of which writes a file. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> luigi <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Task, run, LocalTarget <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyTaskFirst</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Task)</span></span></span><span class="hljs-class">:</span></span> filename = <span class="hljs-string"><span class="hljs-string">"first.txt"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(self.filename, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: f.write(<span class="hljs-string"><span class="hljs-string">"first!"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> LocalTarget(self.filename) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyTaskSecond</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Task)</span></span></span><span class="hljs-class">:</span></span> filename = <span class="hljs-string"><span class="hljs-string">"second.txt"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(self.filename, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: f.write(<span class="hljs-string"><span class="hljs-string">"second!"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">requires</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MyTaskFirst() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> LocalTarget(self.filename) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: run()</code> </pre> <br>  The task launch has changed a bit.  We specify to run the latest task, the framework itself will determine and execute all the dependencies. <br><br><pre> <code class="python hljs">python -m luigi_demo_tasks MyTaskSecond --local-scheduler</code> </pre> <br>  <b>External dependencies</b> <br><br>  Sometimes the task requires data generated by external systems.  Since only other tasks can be specified in dependencies in the requires method, we will need a wrapper task for external data.  For example, consider the task of counting the frequency of each character in the file hello_file.txt: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> defaultdict <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> luigi <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Task, run, LocalTarget, ExternalTask <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExternalData</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ExternalTask)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> LocalTarget(<span class="hljs-string"><span class="hljs-string">"hello_file.txt"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TaskWithExternalData</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Task)</span></span></span><span class="hljs-class">:</span></span> filename = <span class="hljs-string"><span class="hljs-string">"char_counts.txt"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> frequencies = defaultdict(int) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(self.requires().output().path) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_in: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f_in: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> line: frequencies[c] += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(self.filename, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_out: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c, count <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> frequencies.items(): f_out.write(<span class="hljs-string"><span class="hljs-string">'{}\t{}\n'</span></span>.format(c, count)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">requires</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ExternalData() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> LocalTarget(self.filename) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: run()</code> </pre> <br>  <b>Scheduler</b> <br><br>  For centralized execution of tasks, you can use the central scheduler.  Its main tasks: to ensure the absence of simultaneous execution of identical tasks, to provide visualization of all running tasks with their dependencies. <br><br>  From the documentation run the scheduler: <br><br><pre> <code class="python hljs">$ luigid --background --pidfile &lt;PATH_TO_PIDFILE&gt; --logdir &lt;PATH_TO_LOGDIR&gt; --state-path &lt;PATH_TO_STATEFILE&gt;</code> </pre> <br>  Default scheduler address: <br>  <a href="http://localhost/">localhost</a> : 8082 / <br><br>  Run the previous task using the scheduler, after deleting the file char_counts.txt: <br><br><pre> <code class="python hljs">python -m luigi_demo_tasks TaskWithExternalData</code> </pre> <br>  In the scheduler we will see both tasks: <br><br><img src="https://habrastorage.org/webt/59/de/81/59de81fe3bb22538110452.png"><br><br>  As well as the dependency graph: <br><br><img src="https://habrastorage.org/webt/59/de/82/59de82247c23f948022540.png"><br><br>  <b>Parallel task launch</b> <br><br>  We implement several dependent tasks, the dependency is designed as an hourglass: the root task of type 1 depends on ten identical tasks of type 2. These 10 tasks of type 2 depend on one type of 3. It, in turn, depends on 10 tasks of type 4, and all these 10 depend on one type 5 task. <br><br>  Each task writes a file with its name and number as a result of the work, and also sleeps for 10 seconds.  This is necessary so that the task scheduler can be traced in the scheduler.  Note that you can pass a parameter to the task.  This allows you to run different essentially tasks with the same code. <br><br>  For implementation, we will use inheritance, as this will reduce the code.  Run 5 processes simultaneously specifying the option --workers = 5 <br><br><pre> <code class="python hljs">python -m luigi_demo_tasks Task1 --Task1-task-index=<span class="hljs-number"><span class="hljs-number">0</span></span> --workers=<span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br>  In the scheduler refreshing the page we will see the following sequence: <br><br><img src="https://habrastorage.org/webt/59/de/82/59de82495b457558795603.png"><br><img src="https://habrastorage.org/webt/59/de/82/59de828b94e72880941352.png"><br><img src="https://habrastorage.org/webt/59/de/82/59de829bb932e549855535.png"><br><img src="https://habrastorage.org/webt/59/de/82/59de82baa4de7668076374.png"><br><img src="https://habrastorage.org/webt/59/de/82/59de82c613a5e091505594.png"><br><img src="https://habrastorage.org/webt/59/de/82/59de82ecf372c358974421.png"><br><img src="https://habrastorage.org/webt/59/de/83/59de83008124e999800860.png"><br><img src="https://habrastorage.org/webt/59/de/83/59de830f26c33275128065.png"><br><br>  At the same time, no more than five tasks are performed, and sometimes only one, since all the others depend on it.  In this case, the selected workers are idle. <br><br>  <b>Running tasks</b> <br><br>  To run tasks you need to use any external scheduler, for example cron.  Accordingly, it is necessary to independently configure the receipt of the actual code for running, logging and configuring all tasks. <br><br>  <b>Additional features</b> <br><br>  In case of errors in the work, luigi can send an email. <br><br>  For each task set, you can specify an external file with settings by setting up the variable <code>LUIGI_CONFIG_PATH</code> before launching. <br><br>  Each task can be started with a certain priority. To specify the priority, you must specify the priority field in the class. <br><br>  Quite a lot of classes of tasks are implemented related to typical examples of data processing on a cluster - hadoop streaming task in Python, hadoop jar task, spark task and others.  However, they often require substantial refinement. <br><br>  You can perform any task in the form of launching a console command with tracking of the process of execution. <br><br>  The code of the library itself is often quite simple.  To understand how to build dependent tasks, just look at the source code of the base classes in luigi.  They have a fairly simple interface and good documentation. <br><br>  Developed by a large company.  At the moment there are consistently several commits to the master every week.  Most likely it will continue to be supported. <br><br>  <b>disadvantages</b> <br><br>  Checking whether the task is completed occurs only during the construction of the dependency graph.  Because of this, if you start executing a set of tasks more often than it manages to complete, a situation may arise when the scheduler starts two identical tasks. <br><br>  No built-in scheduler. <br><br>  There is no way to obtain meta-information about the tasks performed.  Without aids, it is impossible to get documentation on running tasks, data processing processes.  There is no way, for example, to get a general list of tasks that depend on a given task. <br><br>  The web interface of the scheduler is useful only to see why a particular set of tasks is not performed.  You can usually look at the dependency graph and see exactly what data is missing. <br><br>  The setup of task execution logging is not completely obvious. <br><br>  Quite often unexpected behavior occurs. <br><br>  Support and development is less active than, for example, in Airflow.  For comparison in <a href="https://github.com/spotify/luigi/graphs/commit-activity">luigi</a> and in <a href="https://github.com/apache/incubator-airflow/graphs/commit-activity">airflow</a> <br><br>  <b>Conclusion</b> <br><br>  Luigi is well suited for building data processing.  However, before starting to use this library, it makes sense to try to implement several typical tasks on different frameworks and choose one that is best suited for your tasks. <br><br>  THE END <br><br>  As always, happy to opinions, questions and slippers. </div><p>Source: <a href="https://habr.com/ru/post/339904/">https://habr.com/ru/post/339904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339892/index.html">Vraytap autumn crackme from Kaspersky Lab</a></li>
<li><a href="../339894/index.html">What every developer should know about the search</a></li>
<li><a href="../339896/index.html">Instructions on how to compile the dynamic ngx_pagespeed module for Nginx to Debian</a></li>
<li><a href="../339900/index.html">Stream in NodeJS - rivers that you enter twice</a></li>
<li><a href="../339902/index.html">Maven, where are my artifacts? Another article about dependency management</a></li>
<li><a href="../339906/index.html">Home Minecraft server in Azure part 2 - Azure Automation</a></li>
<li><a href="../339908/index.html">Killer feature Vim</a></li>
<li><a href="../339910/index.html">We break the modified AES-256</a></li>
<li><a href="../339912/index.html">Zoia.js: another web framework on Node</a></li>
<li><a href="../339914/index.html">Jupyter Widgets for implementing the Turing UI machine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>