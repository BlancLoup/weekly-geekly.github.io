<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Computer, how is my build doing?" And other magic spells</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Baruh Sadogursky tells how using the voice command service Alexa you can add a voice interface to completely unexpected things, such as IntelliJ IDEA ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Computer, how is my build doing?" And other magic spells</h1><div class="post__text post__text-html js-mediator-article">  Baruh Sadogursky tells how using the voice command service Alexa you can add a voice interface to completely unexpected things, such as IntelliJ IDEA and Jenkins, as well as, leaning back in your chair with a glass of your favorite drink, manage anything you want. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/q6z-Qkazvu0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  The article is based on the speech of Baruch at the JPoint 2017 conference in Moscow. <br><a name="habracut"></a><br>  Baruch deals with Developer Relations at JFrog.  In addition, he is an enthusiast of Groovy, DevOps, IOT and Home Automation. <br><br><h2>  What is Alexa and why is it in our lives? </h2><br>  In this article I will talk to Alexa.  This is a product of Amazon - a voice assistant, the same as Siri, Cortana (God forbid, if anyone could not remove), Google Home, etc.  Alexa is today the market leader and we will talk why, although the reason is obvious. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are three kinds of Alexa-based devices. <br><br><img src="https://habrastorage.org/webt/l6/bh/yl/l6bhylqamjvnfgjjemr0trh2dng.png"><br><br>  I will be talking to Amazon Tap.  Previously, she did not know how to respond to the name, so you had to press a button, hence the name Tap.  Now she is already responding to the name, but the name remains.  Full-fledged Alexa is big, with a good speaker.  There is also a "trinket" with a weak speaker, which is designed to connect to other receivers, speakers, etc.  All of them are quite accessible, cost 170, 130 and 50 dollars.  I have a total of nine at home.  Why do I need all this, we'll talk now. <br><br>  I mentioned that Alexa is now the undisputed market leader.  The leader is thanks to the open API for writing scripts to Alexa Skills.  Just recently it was said that the number of skills in the main base reached 10 thousand.  Most of them are stupid, but thanks to many useful skills there is nothing like Alexa in terms of usefulness or popularity.  How they clocked up 10 thousand, quite understandable.  There is a pattern by which you can make a skill by changing a couple of lines.  Then publish it, get a T-shirt - and now they have 10 thousand.  But today we will learn to write some more interesting skills - and you will understand that this is quite simple. <br><br>  Why am I interested in this and how do I use the ‚ÄúAlex‚Äù army that is in my house? <br><br><img src="https://habrastorage.org/webt/g4/gz/96/g4gz96foduueiasd0eugvmrvnim.png"><br><br>  I get up and the first thing I ask her to turn off the alarm ("Alexa, turn off the alarm").  Then somehow I get to the kitchen and ask me to turn on the light (‚ÄúAlexa, turn on morning lights‚Äù).  I greet her (‚ÄúAlexa, good morning‚Äù).  By the way, on ‚ÄúGood morning‚Äù she answers interesting things, for example, reports that a large snake was found in Malaysia last year.  Useful information in the morning, under the coffee. <br><br>  Then I ask about the news (‚ÄúAlexa, what's my news flash?‚Äù), And she reads me news from various resources.  After that I ask what's on my calendar?  (‚ÄúAlexa, what's on my agenda?‚Äù).  Because of this, I know what my day looks like.  And then I ask how I am going to work, whether there are traffic jams on the way, and so on (‚ÄúAlexa, how's my commute?‚Äù).  This is a home-oriented use, there are no custom skills at all, it‚Äôs all built-in. <br><br>  But there are still many cool applications. <br><br><img src="https://habrastorage.org/webt/ti/e2/fw/tie2fwl1pj17_mrdqqpfrhohddy.png"><br><br><ul><li>  Smart home is the coolest option.  As you have probably seen, I turned on the light through Alex.  But it can be not only light: locks, cameras, burglar alarms, all sorts of sensors - everything that connects to a smart home. <br></li><li>  Music.  Alexa can play the music I love.  This is the same - audiobooks.  Adults usually have no time for them, but my son listens to fairy tales through Alex. <br></li><li>  Questions / Answers.  That is what is usually searched on Wikipedia. <br></li><li>  News / weather - I have already spoken about this. <br></li><li>  Ordering food is, of course, very important so that you can order pizza, sushi, etc., without getting up from the sofa. <br></li></ul><br>  But you came here, of course, not to listen to the consumer talk about Alex - you came to hear about the voice interfaces of the future.  Today it is HYIP, and, in general, quite unexpected.  But this HYIP is very practical, because voice interfaces are what we are waiting for.  We grew up waiting for voice interfaces to work.  And now it is happening before our eyes. <br><br>  Analysts say that over the past 30 months, there has been progress in the field of voice interfaces, which has not been for the past 30 years.  The bottom line is that the voice interface at some point replaced the graphic one.  This is logical, because the graphical interface is a crutch that existed only because the voice was insufficiently developed. <br><br>  Of course, there are things that are better to show, but, nevertheless, a lot of what we do from the screen, it would be possible, and it would be necessary, to do it with a voice. <br><br>  This API, which lies on top of voice recognition and a certain Artificial Intelligence, which Alex has, is what guarantees explosive development in this industry and the opportunity for many people to write a lot of useful skills. <br><br>  Today we will see two skills.  The first one opens the application, my IntelliJ IDEA, and it‚Äôs certainly cool, but not very useful (since opening the application with a voice and then writing code with pens doesn‚Äôt make much sense).  The second will be about Jenkins, and it should be much more useful. <br><br><h2>  Spelling skill for alexa </h2><br>  Writing a skill is a simple thing and consists of three stages: <br><br><ul><li>  Define an interactive model - the same voice API; <br></li><li>  Write a handler of commands that come to us; <br></li><li>  Review Amazon (we will not consider this stage). <br></li></ul><br><img src="https://habrastorage.org/webt/rk/p9/ok/rkp9ok3spkwvf-yeshqaakezyb0.png"><br><br><h2>  Interactive voice model: what is it, why is it? </h2><br>  It is based on a very simple idea: <br><br><img src="https://habrastorage.org/webt/71/u2/mj/71u2mjqorjbn9ev9yfccyxkovko.png"><br><br>  We can extract variables from the text and pass to the handler (for example, I ask to open IDEA, which is a slot, but I could also ask to open Rider or Sea Lion). <br><br>  I call JSON commands, and then I give the text how these commands can sound.  And here comes the magic, because the same can be said in different ways.  And this Artificial Intelligence (Voice Recognition, which is provided by Alexa) is able to select not only the command that I have registered, but also all similar ones.  In addition, there is a set of built-in commands, such as Stop, Start, Help, Yes, No, and so on, for which no examples should be written. <br><br>  Here is JSON IntentSchema, which states what examples I want.  This is our example that opens tools from JetBrains Toolbox. <br><br><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"intents"</span></span>: [   {       <span class="hljs-attr"><span class="hljs-attr">"intent"</span></span>: <span class="hljs-string"><span class="hljs-string">"OpenIntent"</span></span>,       <span class="hljs-attr"><span class="hljs-attr">"slots"</span></span> : [        {  <span class="hljs-attr"><span class="hljs-attr">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Tool"</span></span>,              <span class="hljs-attr"><span class="hljs-attr">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"LIST_OF_TOOLS"</span></span>        }     ] }, {     <span class="hljs-attr"><span class="hljs-attr">"intent"</span></span>: <span class="hljs-string"><span class="hljs-string">"AMAZON.HelpIntent"</span></span> }   ] }</code> </pre> <br>  You see that I have an intent, which is called OpenIntent, and there is one slot Tool.  Its parameter is some list of tools.  In addition, there is still a help. <br><br><h2>  Slot types </h2><br>  Here are the types of slots: <br><br><ul><li>  Embedded, such as AMAZON.DATE, DURATION, FOUR_DIGIT_NUMBER, NUMBER, TIME; <br></li><li>  A lot of information that Alexa already knows and around which we can write skills, for example, a list of actors, ratings, a list of cities in Europe and the USA, a list of famous people, movies, drinks, etc.  (AMAZON.ACTOR, AGREATERATING, AIRLINE, EUROPE_CITY, US_CITY, PERSON, MOVIE, DRINK).  Information about them and all possible options are already stored and stored in Alexa. <br></li><li>  Custom Types. <br></li></ul><br>  Be sure to remember that they are not enum.  That is, this list is only a priority.  If Alexa learns some other word, it will be transferred to my skill. <br><br>  Here is the very List of Tools - the options that I gave her. <br><br><img src="https://habrastorage.org/webt/z9/gx/zv/z9gxzvaix_ewbkbiusxzliqc5je.png"><br><br>  Writing here is different from writing products from JetBrains simply because Alexa works with natural words.  Accordingly, if I write IntelliJ IDEA in one word, it will not be able to recognize what it is. <br><br><h2>  Sample phrases for teams </h2><br>  Here are examples of how people can apply to request the opening of this tool: <br><br><pre> <code class="hljs pgsql">OpenIntent <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> {Tool} OpenIntent <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> {Tool} OpenIntent startup {Tool} OpenIntent {Tool}</code> </pre> <br>  There are other options.  When Alexa sees this set, she knows that the synonyms of these words also fall under this intent. <br><br><h2>  Command handler </h2><br>  We described the voice interface, and then we have a command handler.  It works very simply: Alexa turns the voice we are talking to into a REST request in JSON format. <br><br>  The request can go either to AWS Lambda Function or to an arbitrary HTTP server.  The advantage of Lambda Function is that they do not need an arbitrary HTTP server.  We have a platform as a service, where we can write our handler without having to lift any services. <br><br>  Benefits of AWS Lambda Function: <br><br><ul><li>  Serverless cumpute server - it works on its own <br></li><li>  No-ops! <br></li><li>  Node.js is the most elegant of implementations.  We write Javascript functions, and when we pull this service, they are processed there. <br></li><li>  Python support (we write a script with some functions, and it all works great) <br></li><li>  Java 8. <br></li></ul><br>  Java 8 is much more complicated.  In Java, we don‚Äôt have any top-level functions that we can write and call ‚Äî all of which should be wrapped in classes.  Our friend Sergey Egorov is on a short leg with the guys who are sawing Lambda, and now he is working to make Groovy use in Lambda not like now (when we make a jar file and work with it the same way), but directly through Groovy scripts when you can write scripts with callbacks that will be called. <br><br><h2>  Speechlet </h2><br>  The class that handles Alexa requests to Java is called Speechlet.  When you see speechboxes, you remember applets, midlets, and servlets.  And you already know what to expect - a controlled execution cycle, that is, roughly speaking, some kind of interface that we, as developers, need to implement with different phases of our ‚Äúsummer‚Äù life, in this case a matchlet. <br><br>  And you were not mistaken, because here you have the Speechlet interface, where there are four methods that we need to implement: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> interface Speechlet { <span class="hljs-type"><span class="hljs-type">void</span></span> onSessionStarted(SessionStartedRequest request, <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>);      SpeechletResponse onLaunch(LaunchRequest request, <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>);      SpeechletResponse onIntent(IntentRequest request, <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>); <span class="hljs-type"><span class="hljs-type">void</span></span> onSessionEnded(SessionEndedRequest request, <span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>); }</code> </pre> <br>  At the beginning, <code>nSessionStarted</code> is when Alexa comes up and realizes that she has a match.  <code>onLaunch</code> is when we call a team with the name of our skill.  <code>onIntent</code> - when a person talked to us, and we got what he said in the form of Json and the team he called.  <code>onSessionEnded</code> is when we make a regular clone. <br><br>  In general, it is very similar to any other "years", and now we will see how everything looks in code. <br><br><h2>  Where to write speechlet </h2><br>  There are two places in Amazon that we need to work with: <br><br><img src="https://habrastorage.org/webt/bi/ct/kh/bictkhvfrazj3t5dshsjf2a9num.png"><br><br><ul><li>  Alexa Skill Kit, where we describe a new skill (interactive model, metadata, name, where to go when a request is received). <br></li><li>  Lambda or any other service where we have a speechlet that is a request handler.  That is, roughly speaking, we have something like this: <br></li></ul><br><img src="https://habrastorage.org/webt/gz/ri/1y/gzri1yxr5bwrdnef-1-wtqtpega.png"><br><br>  We have a user who says: ‚ÄúAlexa, ask Jenkins how's my build?‚Äù.  It comes to the device, in this case, Amazon Tap.  Then everything goes to the same skill that turns a voice into JSON, turns into Lambda Functions and jerks Jenkins API. <br><br><h2>  Sample Code: JbToolBoxActivator Speechlet </h2><br>  Now it's time to look at the code. <br>  ( <a href="https://github.com/jbaruch/jb-toolbox-alexa-skill/blob/master/src/main/groovy/ru/jug/jpoint2017/alexa/jbtoolboxactivator/JbToolBoxActivatorSpeechlet.groovy">https://github.com/jbaruch/jb-toolbox-alexa-skill/blob/master/src/main/groovy/ru/jug/jpoint2017/alexa/jbtoolboxactivator/JbToolBoxActivatorSpeechlet.groovy</a> ) <br><br>  Here is our match.  We derived Help Test, Default Question, and so on.  We have an HTTP BUILDER, let me remind you, this is a service that runs to Amazon Lambda.  Accordingly, he should jerk something on the Internet.  This is actually Groovy, but add a boilerplate, and you‚Äôll get Java. <br><br>  We configure our HTTP client on the <code>nSessionStarted</code> , saying that we will knock on the toolbox on such a host and such a port.  Then we read from the file a list of supported tools that you also saw (List of tools.txt). <br><br>  From <code>onLaunch</code> we issue <code>HelpResponse</code> .  This one you heard about - I can open the same tools. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/310/be9/815/310be981575a6ff98546250c5baa8b56.png"><br><br>  The <code>onIntent</code> interesting thing happens in <code>onIntent</code> .  We make a switch by the name of intent.  That is, of all the teams that we had, that came to us.  In this case, if you remember, we had two intents.  One is open, which is our customer, and the other is help.  There may be a stop, cancel and any other. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e43/4f0/72e/e434f072e434e733c8eee51f7a739963.png"><br><br>  And the most interesting is <code>openIntent</code> .  We take the same slot out of it, tul (we had IDEA and so on), and then we call HTTP-builder to our URI plus this one.  That is, we refer to the JetBrains Toolbox API, which understands this format. <br><br>  Accordingly, then we return the answer.  The answer can be either <code>Opening $toolName</code> , or, if the tool is not in the list: <i>Sorry, I can't find a tool named $ toolName in the toolbox.</i>  <i>Goodbye</i> <br><br>  The HELP works as a HELP, STOP and CANCEL does <code>Goodbye</code> .  If an intent came, which we don't have, we throw invalid invalid. <br><br>  Everything is extremely simple, I specifically wrote it so simple that you can see how simple it is. <br><br>  I have nothing <code>onSessionEnded</code> .  Here I have a <code>newAskResponse</code> method, which in the purest form of a boilerplate, within ten lines of code, creates three objects: one object, in which in the constructor it is theoretically necessary to translate two others, into which you need to translate some texts.  In general, all he does is create a <code>SpeechletResponse</code> object in which we have OutputSpeech text and repromptText.  Why does it take ten lines of code?  Well, historically, we will talk about this a bit.  I hope everything else except this boilerplate is clear and simple. <br><br><h2>  Sample Code: Jenkins Speechlet </h2><br>  Let's look at another skill.  And this time let's go the other way: from the code to the skill and at the end try to start it.  Here is Jenkins speechlet - the handler of the skill that drives Jenkins ( <a href="https://github.com/jbaruch/jenkins-alexa-skill/blob/master/src/main/groovy/ru/jug/jpoint2017/alexa/jenkins/JenkinsSpeechlet.groovy">https://github.com/jbaruch/jenkins-alexa-skill/blob/master/src/main/groovy/ru/jug/jpoint2017/alexa/jenkins/JenkinsSpeechlet.groovy</a> ). <br><br>  It all starts out very much the same: <code>nSessionStarted</code> we initialize HTTPBuilder, which will access Jenkins via the Rest API in JENKINS_HOST and log in with a specific username and password.  Here it is, of course, through environment variables is not very correct.  Alexa has a whole system that allows you to register with username and password in a skill, that is, when we install this skill on our local Alexa, a window opens in which we can log in.  But for simplicity, here we take username and password from environment variables. <br><br>  <code>onLaunch</code> we <code>onLaunch</code> the same text: ‚ÄúGreetings, giant muzzles, we manage Jenkins,‚Äù and here our interesting <code>onIntent</code> . <br><br>  Here we have, respectively, more intents, it makes sense to look at our model - <a href="">https://github.com/jbaruch/jenkins-alexa-skill/blob/master/src/main/resources/speechAssets/IntentSchema.json</a> <br><br>  We have <code>LastBuild</code> , which obviously will give us information about our latest build, <code>GetCodeCoverage</code> , which will return code coverage to us, and <code>FailBuildIntent</code> , which will fill up the build.  In addition, there is a bunch of built-in, such as help, stop, cancel, and even yes, no.  Let's see what we actually do with these yes and no. <br><br>  Let's start.  Here the intent came to us, and we take data from it by name.  If we have been asked for the last build, then we will go to the Jenkins API and take a list of builds with their name and color from there (the color red or blue has passed or has not passed).  Take last, a build with such a name, whether it is passed or not. <br><br>  <code>GetCodeCoverage</code> - again, we turn to the Jenkins API, a plugin called jacoco.  In it, as in any good plugin, there is a mass of parameters.  We take one - lineCoverage - and get some information. <br><br>  <code>FailBuild</code> is a request to turn an incoming build into a fayle.  I would not like to immediately agree on this.  Alexa often responds in vain, so there is a chance to randomly bite a build.  And we will ask her for confirmation.  We will send another request and say: ‚ÄúI want to fill up the build‚Äù ‚ÄúIs this really what you meant?‚Äù.  We put in sessions.  This is exactly what is held through different invokations, and we will put some flag in fail requested. <br><br>  And then we have that same yes-no.  If we answered yes, then we need to check if there was a question, or maybe we just said yes.  And if the question was, then again, we will create some post request, this time in our Jenkins API, and fill up the job.  And if the job really became red, we say that we have filled up the job, and if not - nothing happened.  Well, stop - we say Goodbye and exit. <br><br>  Such interesting functionality, and a code here on one page.  I tried to complicate the code, but there is nothing to complicate, because it's really that simple. <br><br>  After that we collect all this with graidl, and Gradle is the simplest here.  I have a lot of dependencies here: groovy, which I naturally need, plus three dependencies of this API, logger, commons-io, commons-lang.  Everything!  testCompile - naturally, I have tests for this case.  And then I build a ZIP in which in the main directory is my jar.  In addition, there is a lib directory with all dependencies.  Really easier to go. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ef/54d/a20/9ef54da2021670cefd6d37a162af09a5.png"><br><br><h2>  Using the Alexa Skill Kit </h2><br>  Now let's see what we do with this build.  We have two places where we really turn.  The first is the Alexa Skill Kit, it has all the skills that I wrote.  Let's look at Jenkins Skill. <br><br><img src="https://habrastorage.org/webt/3c/cn/d_/3ccnd_4frnrnz2wxcncth5kre6q.png"><br><br>  As I said, here we have metadata: the name and invocation name is that very word (Jenkins) when I say: ‚ÄúAlexa, ask Jenkins to do this and that.‚Äù <br><br><img src="https://habrastorage.org/webt/pk/ez/pl/pkezpl5ov6a8amasmvmglr9yfe8.png"><br><br>  Then you can specify whether I need an audio player (if I, for example, want to stream a sound, for example, play music, play news, and so on) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ad2/896/529/ad28965299cc273e0eefb973d1ca8043.png"><br><br>  Next we have our interactive model - the same JSON that describes intents. <br><br><img src="https://habrastorage.org/webt/qv/bv/rt/qvbvrt3jd0izjt2ybedqepffakk.png"><br><br>  There is no slot here, but in JetBrains we would have a custom slot and this slot would have values ‚Äã‚Äãand examples that work for my intents. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a7/7a5/3cb/5a77a53cbe7b7c5c9228e902a6ce2fe0.png"><br><br>  Configuration tab - what I call: Lambda or HTTPS. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5cb/221/78f/5cb22178f1fe5c64a7b99318af681e05.png"><br><br>  Immediately there is the same Account Linking - do we give the opportunity to log in when setting up the skill (and in theory, it would be nice to do this in Jenkins). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb6/b0c/b6c/fb6b0cb6c5ed6c84b162bd817296ce18.png"><br><br>  And further Permissions for all purchases, but it does not really interest us anymore. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/192/b77/2b3/192b772b3e8c43c94cf6b641f0a60512.png"><br><br>  Testing tab - here I can write what it will do if I speak. <br><br><img src="https://habrastorage.org/webt/dq/wm/n5/dqwmn5pphjbhs6n4s7vhbq4qwt8.png"><br><br>  Further tab Publishing Information.  Skill passes all checks from Amazon.  I have to tell them how good it is, how it is tested, and so on. <br><br><h2>  Using AWS Lambda </h2><br>  The second part of working with the skill is my AWS Lambda.  There I have nothing but these three skills. <br><br><img src="https://habrastorage.org/webt/u4/ol/er/u4oleru0ynokergndonirj2zx1o.png"><br><br>  Let's look at Jenkins.  Here I poured the very jar that built Gradle.  There are also variables (host, password and user). <br><br><img src="https://habrastorage.org/webt/18/xy/3s/18xy3sh6aasllq3vzvc-u-jz1pu.png"><br><br>  In the configuration I am writing, which one I need is runtime.  As I said before, Node, Python, and Java are supported.  And recently it became supported by C #.  Next is the handler.  This is where my match is inside.  Role is called lambda_basic_execution.  And I have a description.  Everything. <br><br><img src="https://habrastorage.org/webt/tx/dv/sw/txdvswzu3dahd6ujiuoh5iawssu.png"><br><br>  The trigger comes from Alexa.  There is a special kind of trigger that is called the Alexa Kit.  This means that the call will be from there. <br><br><img src="https://habrastorage.org/webt/ed/zf/xp/edzfxpqzrcmaaj6edcecbgnbzjs.png"><br><br>  And here, too, you can test, if you know what JSON Alex sends Lambda.  And I know what, because when I test it here, I will see this Jenkins.  And now let's look at this Jenkins.  I sent a request: how is my build. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bcd/290/d51/bcd290d5189b50171707a90df6a9c326.png"><br><br>  I sent an intent, the intent is called last build, and Alexa realized what I want. <br><br><img src="https://habrastorage.org/webt/9v/xl/o5/9vxlo5ekxwulrqjtgmatcxc7d3u.png"><br><br>  This is all wrapped in JSON, which I can test in Lambda.  I can say: I am sending this JSON.  And when I say this, I can only test this piece. <br><br><img src="https://habrastorage.org/webt/bb/lv/fw/bblvfw4ub00eojiiskbcx0tvwio.png"><br><br>  Yes, I have end to end testing with this voice recognition thing (text in JSON, in Lambda and then back) or I can only test this at the Lambda level, if I know the JSON that is needed. <br><br><h2>  Demonstration of Jenkins Speechlet </h2><br>  In general, it is time to start everything.  We have Jenkins, and I have a build of the previous skill. <br><br><img src="https://habrastorage.org/webt/y1/vm/qd/y1vmqdp_xbniuijvbxyi-8ctgg0.png"><br><br>  Then I have this dialogue with the system: <br><br>  <i>Baruch: Alexa, open Jenkins</i> <i><br></i>  <i>Alexa: With this skill you can control your build server</i> <i><br></i>  <i>Baruch: Alexa, ask Jenkins, how is my build?</i> <i><br></i>  <i>Alexa: You last build jb-toolbox-alexa-skill is passing.</i>  <i>What do you want to do next?</i> <i><br></i>  <i>Baruch: What's the code coverage?</i> <i><br></i>  <i>Alexa: jb-toolbox-alexa-skill build is 30%.</i>  <i>What do you want to do next?</i> <i><br></i>  <i>Baruch: Fail the build.</i> <i><br></i>  <i>Alexa: I understand you successful build.</i>  <i>Are you sure?</i> <i><br></i>  <i>Baruch: Yes</i> <i><br></i>  <i>Alexa: Successfully changed the build status to failed.</i>  <i>Thank you and goodbye.</i> <br><br><img src="https://habrastorage.org/webt/mq/io/rk/mqiorkk7mkmnto7u7oayfyu6ypu.png"><br><br>  It is very cool and very simple, even ashamed of such an easy level. <br><br><h2>  Alexa's visual companion </h2><br>  In addition to the voice interface, Alexa has a visual companion.  This application, in which in addition to setting up all devices, the Internet and other things, there are also cards.  This is such a stream of information that is auxiliary to the voice interface.  In general, this is a sensible idea, because not everything can be said with a voice.  If, for example, I have now requested <code>code coverage</code> , and she gave me some kind of metric - in fact, jacoco returns six metrics: coverage for branch execution, methods, code lines, etc.  Naturally, it makes sense to display this visually in the application.  This can be done in one line - there is a command ‚Äúsend text to the application‚Äù.  And then you can send a simple text, picture or html, which will be displayed there.  For example, if you ask about the weather, the assistant will give a brief answer.  In the application, you can see the weather for the whole week.  I also checked now that the lock was locked in my house, and that my son at the moment had turned on the fairy tale about Little Red Riding Hood.  Here's what it looks like: <br><br><img src="https://habrastorage.org/webt/bu/o3/4l/buo34loc4f11guznt8wmcv722pk.png"><br><br><h2>  Alexa‚Äôs flaws: imaginary and real </h2><br>  Let's now talk about two kinds of flaws: imaginary and real.  The first - imaginary - is associated with speech recognition.  The user can speak with an accent or not very clearly pronounce the words.  I do not know how they do it, but Alexa perfectly understands even my little son, although my wife and I do not always understand him. <br><br>  The second perceived flaw is shown in the illustration below. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dec/b07/bd3/decb07bd3fc149bed762ec0ca9f79439.png"><br><br>  In fact, this problem is solved very simply with the help of security tools: Alexa will never place an order in the store or open the door until you say a pre-set PIN code. <br><br>  There is another aspect: "Oh, oh, oh, they constantly listen to us."  It's all a long time ago, reverse-engineering, it is perfectly clear to everyone that they are listening.  The only thing that they constantly listen to is trigger words.  That is when I call her.  Sometimes trigger words are pronounced randomly, after that, within ten seconds, what we say is recorded, and the record is sent to the main intent, to the main skill.  If there it is not recognized, then thrown into the trash.  Therefore, all this paranoia is unjustified. <br><br>  And now we will talk about the real disadvantages.  They can be divided into several categories. <br><br>  There are drawbacks to the voice user interface.  They are related to the fact that some call things the same words.  Try asking for Helloween's music and not get music for Halloween.  I think that, given the progress, the context should solve this problem, because Alexa should already know that I prefer the group between the music for Halloween and the band Helloween.  Everything goes to this, but so far this is not so, especially - if the context is incomprehensible. <br><br>  And one more problem.  It is connected with the lack of support for non-standard names and names.  If Alexa does not know a name or a title, then she will not be able to pronounce it. <br><br>  In addition, Alexa itself, like a consumer device, also has flaws: <br><br><ul><li>  Does not understand multiple commands.  I can build an interactive model, like we did with Jenkins, when I didn‚Äôt say her name each time to transfer the next command.  But, for example, at the moment it cannot execute the command ‚ÄúAlexa, turn on TV and set living room lights to 20%‚Äù.  And if there are many teams and you use them all the time, it will annoy you. <br></li><li>  Does not work in a cluster.  Despite the fact that I have seven such devices at home, each of them considers himself the only one.  And therefore if I stand in a place where there are three of them, then all three answer me.  In addition, I cannot use one to turn on the music of another, because they do not know that there are more of them than one.  This problem is known, they are working on it and, I hope, it will be solved soon. <br></li><li>  Do not know where she is and where I am.  Because of this, Alexa cannot react to the ‚ÄúTurn on the lights‚Äù command.  I have to say ‚ÄúTurn on the lights in the bedroom‚Äù and this is stupid. <br></li><li>  The application itself is made on html5, it is slow, crooked, but it is also being repaired. <br></li><li>  Understands only three languages: British English, American English and German.  Accordingly, in Russian it has not yet been taught. <br></li></ul><br>  The biggest and disgusting flaws come out when trying to write Alexa Skill, for example the one we are doing now.  Java API is a nightmare, the voice model must be manually copied to the page, and this is indicated even in the documentation.  In addition, there is no bootstrap: neither Maven Archetype, nor Lazybones Template. <br><br>  There is no local test infrastructure, that is, if I changed the only line in the code, I need to go to the site of the skill and change the pens in the text area json, and then go to Lambda and load the new jar there (well, on Lambda, let's say Rest API, because it still wrote for the developers, there you can make a continuous deployment, everything is fine there).  But on the side of the skill kit with any change, I need to go and download it all and test it only on the server.  Locally there is no infrastructure, and this, of course, is also a very big minus. <br><br><h2>  Conclusion </h2><br>  That's all.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skills, which were discussed, can be taken from my Github - </font></font><a href="https://github.com/jbaruch/jb-toolbox-alexa-skill"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jb-toolbox-alexa-skill</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://github.com/jbaruch/jenkins-alexa-skill/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jenkins-alexa-skill</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">I have a big request for you: let's invent and write useful skills, then we will be able to return to this topic at the next conferences.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So that you do not miss a single detail, under the spoiler, we left for you answers to questions from the audience.</font></font></b> <div class="spoiler_text"><br> <i>  .    ,  -    (,   )?</i> <br><br>  -  ,  Alexa     ,        (, ,       ). <br><br> <i>,      .     Alexa?</i> <br><br>  Alexa   -  ,            .          -.      voice recognition,    ,      . <br><br> <i>     Alexa    Google Home?</i> <br><br> Google Home   Alexa,       .   ‚Äì  ,     Google Home  .      ,        .   Google Home    ‚Äì  .  Alexa  ,        . <br><br> <i>      Alexa.       ?</i> <br><br>        ‚Äî    .        ,    .      ,  ,      ‚Äì . <br></div></div><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We hope you find the Baruch experience useful. </font><font style="vertical-align: inherit;">And if you like to savor all the details of Java development in the same way as we do, you probably will be interested in these reports at our April </font></font><a href="https://jpoint.ru/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JPoint 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conference </font><font style="vertical-align: inherit;">:</font></font><br><br><ul><li>  <a href="https://jpoint.ru/talks/1qghn5o70siuweuqeesuoa/">Program analysis: how to understand that you are a good programmer</a> (Alexey Kudryavtsev, JetBrains) <br></li><li> <a href="https://jpoint.ru/talks/3k1gdp5ebuam4qm4skac6y/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The adventures of Senor Holmes and Junior Watson in the software development world</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Baruch Sadogursky, JFrog and Evgeniy Borisov, Naya Technologies)</font></font><br></li><li> <a href="https://jpoint.ru/talks/2sc3v1jbv2y6eeoyiuisoc/">Extreme scaling with Alibaba JDK</a> (Sanhong Li, Alibaba) <br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/352372/">https://habr.com/ru/post/352372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352358/index.html">SecaaS as a type of cloud services and other standards of the GOST project ‚ÄúInformation protection when using cloud technologies‚Äù</a></li>
<li><a href="../352362/index.html">Pumping C # Performance with Federico Luis</a></li>
<li><a href="../352364/index.html">DotNext 2018 Piter program overview</a></li>
<li><a href="../352366/index.html">Smart face control: machine learning algorithms for efficient data caching on SSD</a></li>
<li><a href="../352368/index.html">MEPhI invites to the information security competition</a></li>
<li><a href="../352374/index.html">Multithreading on ships</a></li>
<li><a href="../352376/index.html">Now I see you: detecting fileless malware</a></li>
<li><a href="../352378/index.html">From point A to point Chief</a></li>
<li><a href="../352380/index.html">New old vulnerability: Firefox password manager has been using outdated SHA-1 for 9 years</a></li>
<li><a href="../352382/index.html">Network physics in virtual reality</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>