<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Run Windows Server 2012R2 from a VHDX file from a USB disk through UEFI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided to make a disk array on the Intel Atom D410PT platform. This is a motherboard with passive cooling of the processor, two memory slots (maxim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Run Windows Server 2012R2 from a VHDX file from a USB disk through UEFI</h1><div class="post__text post__text-html js-mediator-article">  I decided to make a disk array on the Intel Atom D410PT platform.  This is a motherboard with passive cooling of the processor, two memory slots (maximum 4Gb), one PCI slot (which I used for the SATA SiliconImage 3512 controller - 2x1.5Gb / s), 2 SATA (3.0Gb / s) connectors, LAN 100mb / s , and numerous USB 2.0 ports (including on the motherboard itself). <br>  The board itself fit easily into the NaviPower PIX-1001 230W chassis.  I posted a complete description of my actions with iron <a href="http://www.raymond.pro/poleznye-programmy/zapusk-windows-server-2012r2-iz-vhdx-fajla-s-usb-diska-cerez-uefi">on my website</a> . <br><br>  Accordingly, since  it was decided to use 4 disks to create a RAID5 array, then the logical solution was to transfer the operating system to an external USB drive (in my case, the USB HDD Seagate Freeagent GoFlex).  Since installing and configuring the system from scratch is often a long and painstaking exercise, I decided that the system will lie on an external disk in the VHDX container, and since the motherboard supports UEFI, the download should go accordingly using UEFI.  The main problem was that there is no clear instructions on the Internet how to do this.  All information is very fragmented, and only parts of the solution to this problem are described. <br><br><a name="habracut"></a>  I decided to do this: first install the system as usual on a SATA disk, then transfer it to a VHDX container and then to external USB HDD. <br>  I will skip the installation of the system, since  This is a banal operation that does not require special knowledge (the only thing is that if you want to install the system on a GPT disk, you will need to play with diskpart before installation). <br>  <b>An important addition: before transferring the system to an external disk, it is necessary to turn off the paging file and the hibernation system!</b> <br>  Accordingly, we install updates to the system, programs, make settings. <br>  Next, you need to transfer the system to a VHDX container.  For this program was downloaded Disk2VHD 2.01.  Its interface is primitive.  You just need to select the drive to transfer, the VHDX file and start the process. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After that, on a working system (it is possible on Windows 7 x64, but then there will be problems with working with VHDX. It is better to take Windows Server 2012 or Windows 8 x64), you need to prepare a USB disk for booting.  In general terms, you need to clear the disk from the information, create 2 partitions, one of which will be EFI (fat32, 300Mb, 4kb), and the second will be the main (NTFS, 1Tb, 64kb) to accommodate our VHDX container. <br>  We connect the drive to the computer, run diskpart.exe. <br>  See the list of disks: <br><pre><code class="dos hljs">DISKPART&gt; list disk  ###     GPT -------- ------------- ------- ------- --- ---  <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">1863</span></span> G <span class="hljs-number"><span class="hljs-number">1024</span></span> K  <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-number"><span class="hljs-number">931</span></span> G <span class="hljs-number"><span class="hljs-number">0</span></span>   <span class="hljs-number"><span class="hljs-number">2</span></span>   <span class="hljs-number"><span class="hljs-number">931</span></span> G <span class="hljs-number"><span class="hljs-number">0</span></span>  * *  <span class="hljs-number"><span class="hljs-number">3</span></span>   <span class="hljs-number"><span class="hljs-number">1397</span></span> G <span class="hljs-number"><span class="hljs-number">0</span></span>  *  <span class="hljs-number"><span class="hljs-number">5</span></span>   <span class="hljs-number"><span class="hljs-number">931</span></span> G <span class="hljs-number"><span class="hljs-number">0</span></span>  *</code> </pre> <br>  We select a disk with which we will work.  This is usually done in size. <br>  <b>Attention!</b>  <b>if you make a mistake, you can completely erase the system and data from the computer!</b> <br><pre> <code class="dos hljs">DISKPART&gt; select disk <span class="hljs-number"><span class="hljs-number">3</span></span>   <span class="hljs-number"><span class="hljs-number">3</span></span>.</code> </pre><br>  Next, you need to clear the disk from all information: <br><pre> <code class="dos hljs">DISKPART&gt; clean DiskPart:    .</code> </pre><br>  Next, we convert the disk to a GPT disk: <br><pre> <code class="dos hljs">DISKPART&gt; <span class="hljs-built_in"><span class="hljs-built_in">convert</span></span> gpt DiskPart:       GPT.</code> </pre><br>  Next, create the first partition where the EFI loader will be stored.  We will make it 300Mb in size, and 4kb in stripe size (usually you need to test which stripe size will work faster, but I make strips as large as possible, since file sizes nowadays are usually more than 4 or even 64 KB.): <br><pre> <code class="dos hljs">DISKPART&gt; create partition efi size=<span class="hljs-number"><span class="hljs-number">300</span></span> DiskPart:    .</code> </pre><br>  Now it needs to be formatted in FAT32 format (only this format supports UEFI technology): <br><pre> <code class="dos hljs">DISKPART&gt; <span class="hljs-built_in"><span class="hljs-built_in">format</span></span> <span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>=fat32 quick unit=<span class="hljs-number"><span class="hljs-number">4</span></span>k  ( ): <span class="hljs-number"><span class="hljs-number">100</span></span>  DiskPart   .</code> </pre><br>  Now you need to assign a drive letter to this partition in order to work with it (in our case it will be the letter Y): <br><pre> <code class="dos hljs">DISKPART&gt; assign letter=y DiskPart:        .</code> </pre><br>  Now you need to mark the rest of the disk where the rayserv.vhdx file will be located.  First, create a section: <br><pre> <code class="dos hljs">DISKPART&gt; create partition primary DiskPart:    .</code> </pre><br>  Now let's format it in NTFS with a stripe size of 64kb: <br><pre> <code class="dos hljs">DISKPART&gt; <span class="hljs-built_in"><span class="hljs-built_in">format</span></span> <span class="hljs-built_in"><span class="hljs-built_in">fs</span></span>=ntfs quick unit=<span class="hljs-number"><span class="hljs-number">64</span></span>k  ( ): <span class="hljs-number"><span class="hljs-number">100</span></span>  DiskPart   .</code> </pre><br>  Now assign the letter Z to the partition: <br><pre> <code class="dos hljs">DISKPART&gt; assign letter=z DiskPart:        .</code> </pre><br>  Now you can close diskpart.exe: <br><pre> <code class="dos hljs">DISKPART&gt; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>   DiskPart...</code> </pre><br>  Now you can copy rayserv.vhdx to disk Z. <br>  Further it is necessary to make some preparatory actions.  It is necessary to connect the virtual disk to the system. <br><br>  Since I work in Windows 7 x64, accordingly, my system does not support working with VHDX files.  Therefore, I have previously made not one system image file in VHDX, but two identical system images, only one in VHD format, and the other one is VHDX.  Currently the VHD file is on the D: drive, and the VHDX file is already on the USB drive with the letter Z :.  We connect the disk under the letter H :. <br><br>  Now you need to make the EFI partition bootable. <br>  Download the bootsect.exe file on the D: disk (you can find the file using the Get Waik Tools utility, or <a href="http://www.raymond.pro/poleznye-programmy/zapusk-windows-server-2012r2-iz-vhdx-fajla-s-usb-diska-cerez-uefi">on my page</a> ).  Run with parameters: <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">D:\&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bootsect.exe</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nt60</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function">: /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">force</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Target</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">volumes</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">will</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">be</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updated</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BOOTMGR</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compatible</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bootcode</span></span></span><span class="hljs-function">. </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Y</span></span></span><span class="hljs-function">: (\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Device</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HarddiskVolume53</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Successfully</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updated</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FAT32</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filesystem</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bootcode</span></span></span><span class="hljs-function">. </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bootcode</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">was</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">successfully</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updated</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">all</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">targeted</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">volumes</span></span></span><span class="hljs-function">.</span></span></code> </pre><br>  In order to copy the boot files to the EFI partition, go to the H: \ Windows \ System32 folder and run the command: <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">H:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">System32</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bcdboot.exe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">H</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Y</span></span></span><span class="hljs-function">: /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uefi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Boot</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">files</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">successfully</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">created</span></span></span><span class="hljs-function">.</span></span></code> </pre><br>  Now you need to create the system to indicate that you need to boot from the VHDX file.  To do this, from the folder H: \ Windows \ System32 run: <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">H:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">System32</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bcdedit</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">store</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Y</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EFI</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Microsoft</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Boot</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BCD</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-function"> {</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">default</span></span></span><span class="hljs-function">} /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-function"> "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vhd</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">boot</span></span></span><span class="hljs-function"> (</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locate</span></span></span><span class="hljs-function">)" </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">The</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">entry</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">was</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">successfully</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copied</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">to</span></span></span><span class="hljs-function"> {64</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d49e0f</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ba36</span></span></span><span class="hljs-function">-11</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e3</span></span></span><span class="hljs-function">-8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">de2</span></span></span><span class="hljs-function">-1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c6f653f47df</span></span></span><span class="hljs-function">}.</span></span></code> </pre><br>  The / store key indicates the path with which BCD file we need to work with. <br>  The received code {64d49e0f-ba36-11e3-8de2-1c6f653f47df} is memorized, or copied from the screen. <br>  This command we copied the record to boot by default, and called it "vhd boot (locate)". <br>  Now assign the default number to this number: <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">H:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">System32</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bcdedit</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">store</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Y</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EFI</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Microsoft</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Boot</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BCD</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">default</span></span></span><span class="hljs-function"> {64</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d49e0f</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ba36</span></span></span><span class="hljs-function">-11</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e3</span></span></span><span class="hljs-function">-8</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">de2</span></span></span><span class="hljs-function">-1</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c6f653f47df</span></span></span><span class="hljs-function">}   .</span></span></code> </pre><br>  Now it is necessary for the system for this record to indicate that it is necessary to boot from a specific disk and a specific file. <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">H:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">System32</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bcdedit</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">store</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Y</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EFI</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Microsoft</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Boot</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BCD</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-function"> {</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">default</span></span></span><span class="hljs-function">} </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">device</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vhd</span></span></span><span class="hljs-function">=[</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locate</span></span></span><span class="hljs-function">]\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rayserv.vhdx</span></span></span><span class="hljs-function">   .</span></span></code> </pre><br>  H: \ Windows \ System32&gt; bcdedit / store Y: \ EFI \ Microsoft \ Boot \ BCD / set {default} osdevice vhd = [locate] \ rayserv.vhdx <br>  The operation completed successfully. <br><br>  By the way, the [locate] parameter is very useful.  It tells the operating system that when downloading a file, it is necessary to search the file on all disks in order. <br><br>  Now you need to enable automatic detection of devices at boot (this is required for some systems). <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">H:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">System32</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bcdedit</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">store</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Y</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EFI</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Microsoft</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Boot</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BCD</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-function"> {</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">default</span></span></span><span class="hljs-function">} </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">detecthal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-function">   .</span></span></code> </pre><br>  And finally, you need to disable autorun of the recovery console in case of problems: <br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">H:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Windows</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">System32</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bcdedit</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">store</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Y</span></span></span><span class="hljs-function">:\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EFI</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Microsoft</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Boot</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BCD</span></span></span><span class="hljs-function"> /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-function"> {</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">default</span></span></span><span class="hljs-function">} </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bootstatuspolicy</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ignoreallfailures</span></span></span><span class="hljs-function">   .</span></span></code> </pre><br>  We disconnect the virtual disk from the system through the disk control panel. <br><br>  Almost done.  Now, on the final system, you need to disconnect all drives except ours, and enable UEFI boot in the BIOS for USB drives.  It may also be necessary to increase the timeout for searching USB devices, since  With a cold start, the system may not see the external hard drive. <br>  After that, boot from the USB drive. <br><br>  When I first booted the server did not start.  I had to press F8 and select secure boot.  Here the server started working, and after rebooting everything began to work as it should.  It remains only to remove the timeout in the boot menu and everything will be ready.  This can be done on the running system through the msconfig utility. </div><p>Source: <a href="https://habr.com/ru/post/218115/">https://habr.com/ru/post/218115/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218103/index.html">Hubble eXtreme Deep Field: A small journey of 13 billion light years</a></li>
<li><a href="../218105/index.html">Overview of the Highscreen Zera F smartphone: "skit" from the flagships for 3,990 rubles</a></li>
<li><a href="../218107/index.html">Windows 8 on Intel Galileo now, for free already in the plans of Microsoft!</a></li>
<li><a href="../218109/index.html">Tame ZoG (Part 5: Mana Collection)</a></li>
<li><a href="../218113/index.html">A thousand and one gif</a></li>
<li><a href="../218119/index.html">What is a switch and how to deal with it?</a></li>
<li><a href="../218121/index.html">How to write a "skorochitku" for iOS in half an hour</a></li>
<li><a href="../218123/index.html">Unity 3D Web Player on Linux via Pipelight</a></li>
<li><a href="../218125/index.html">dub: dependency manager for D language</a></li>
<li><a href="../218127/index.html">#FailOverConf on May 23 in Moscow. Why do you need to be ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>