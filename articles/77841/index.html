<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write a simple console To-do manager in Ruby</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It so happened that before I had a little programming experience in Java and PHP. Therefore, I easily switched to Ruby. Of course, I often had to refe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write a simple console To-do manager in Ruby</h1><div class="post__text post__text-html js-mediator-article"> It so happened that before I had a little programming experience in Java and PHP.  Therefore, I easily switched to Ruby.  Of course, I often had to refer to the literature, as well as to the wonderful utility <b>ri</b> (or the more convenient analogue of <b>fxri</b> ). <br>  Features of ruby ‚Äã‚Äãlanguage came to my liking.  (I really could not say that after switching from java to php) <br><br>  The ruby ‚Äã‚Äãlanguage is rich in syntactic sugar.  A simple loop here can be written in a variety of ways, and in many cases it improves the readability of the program.  In other matters, the language itself is positioned as a programming language, which absorbed the best moments of other programming languages. <br><br>  I would like to present you a simple console utility, designed to work with the task list.  It is very simple, and if someone likes this article, <b>I will continue to increase the functionality and give detailed explanations to the program code.</b> <b><br></b> <br>  To run this utility you just need to write in the console: <br> <code>$ ruby ./rtodo.rb</code> <br> <a name="habracut"></a><br>  The program consists of three files: <br>  <b>system.rb</b> - file containing the implementation of the System class <br>  <b>rtodo.rb</b> - the main executable file <br>  <b>list.dat</b> is our task repository 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Instructions for work (in the examples): <br>  <b>add</b> Complete script for my web-page (add task) <br>  <b>list</b> (print a list of all tasks - each task has its own number) <br>  <b>remove 1</b> (delete task number 1) <br><br><h6>  First I want to show the source code without comments.  After this, I will write in detail what each line does. </h6><br><br><h5>  rtodo.rb </h5><br><img src="http://lh6.ggpht.com/_TOlWOXZe0dI/SyDkdpvTCxI/AAAAAAAAAGc/RL5HMwiziAc/1.png" alt="image"><br><br><h5>  System.rb </h5><br><img src="http://lh3.ggpht.com/_TOlWOXZe0dI/SyDkdmVsZvI/AAAAAAAAAGg/en41o3jSZn8/2.png" alt="image"><br><br><h4>  Let's start learning from the main file - <b>rtodo.rb</b> </h4><br><br>  Load the file containing the implementation of the System class. <br> <code>load 'system.rb'</code> <br>  System class is responsible for working with tasks (add / remove / show) <br><br>  create an object of class System <br> <code>system = System.new</code> <br> <br>  welcome our user <br> <code>puts "&gt; Welcome to R-todo v0.1, type 'help' to get info"</code> <br> <br>  we initialize the string variable, this is where the user will be stored <br> <code>user_input = ""</code> <br> <br>  using the <code>while</code> construct, we process everything the user enters, until the user enters 'quit', this will mean that the program should end immediately <br><br> <code>while user_input != "quit"</code> <br>  we bring in variable that entered our user in the console <br> <code>user_input = gets.chomp</code> <br>  convert the string that the user entered into the array.  Each word is a separate element of the array. <br> <code>formatted_user_input = user_input.split <br></code>  then we will go through each element of the hash array of keywords.  You are probably surprised.  You will find a description of this variable in the system.rb file ‚Äî for now, just know that this hash array contains constructions of the form 'keyword' =&gt; 'called function' <br> <code>system.keywords.each do |keyword,method|</code> <br>  if the first word in the line that the user entered corresponds to a keyword, then ... <br> <code>if formatted_user_input[0] == keyword</code> <br>  we initialize an array in which the line which was entered by the user will be stored.  Only without the first word, because  it is the key, and serves exclusively for the work of the program <br> <code>buffer = []</code> <br>  this string fills the array with words <br> <code>1.upto(formatted_user_input.index(formatted_user_input.last)) { |index| buffer.push(formatted_user_input.at(index))}</code> <br>  and then combines the words of the array into a single string, using the space character as a separator <br> <code>string_user_input = buffer.join(" ")</code> <br>  This line below should be paid special attention. <br>  In addition to syntactic sugar, there is a dangerous eval method here, you can read more about it in any book on php / ruby.  The fact is that the task_list method does not provide arguments, so if the user entered the list command, the argument of the eval function would be of the same type, and if the user entered some other command, then the argument would be quite standard for our System class. <br> <code>keyword == "list" ? eval("system.#{method}") : eval("system.#{method}(string_user_input)") <br> end <br> end <br> end <br> puts "&gt; R-todo was aborted by user"</code> <br> <br><h4>  Go to the file <b>System.rb</b> </h4><br>  I want to remind you, this file is directly responsible for working with the task list. <br><br> <code>class System</code> <br>  object variables <br> <code>attr_reader :keywords, :buffer</code> <br>  constructor method, this method will always be called when creating an object of the System class <br> <code>def initialize</code> <br>  And so, for a start we initialize the hash array of the @keywords object variable. <br>  this array will contain keywords and method names <br>  in other words, when the user enters 'add', the 'task_add' method will be called <br> <code>@keywords = { 'add' =&gt; 'task_add', 'remove' =&gt; 'task_remove', 'list' =&gt; 'task_list'}</code> <br>  create an array variable.  Here we will put all current (existing tasks) <br> <code>@buffer = []</code> <br>  I will explain in more detail. <br>  All tasks of the user are stored in the buffer.  As soon as the user deletes any task, it is first deleted from the buffer, then the entire buffer is written to the file.  In other words - every time we re-write the contents of our file.  For this program, this is permissible, but in applications that work with huge files, this method can affect performance. <br><br>  <code>list.dat</code> file contains a list of tasks <br><br>  if the file containing the task list exists <br> <code>if File.exist?('list.dat')</code> <br>  we initialize the list_file variable containing our list.dat file <br>  and transfer the data from the file to our buffer <br> <code>list_file = File.new('list.dat','r') <br> list_file.each_line do |line| <br> @buffer &lt;&lt; line <br> end</code> <br>  if this file does not exist, then ... <br> <code>else <br></code>  create new file <br> <code>list_file = File.new("list.dat","w+") <br> puts "System files was created" <br> end</code> <br>  close the file (save) <br> <code>list_file.close <br> end</code> <br> <br>  the method adds a new task, as an argument - the text of the task <br> <code>def task_add(task)</code> <br>  we put the text of the task in the buffer <br> <code>@buffer &lt;&lt; task</code> <br> <code>puts "&gt; task added to list (#{task})"</code> <br>  <code>task_write_to_file</code> call the method that writes the entire buffer to a file <br>  <code>task_list</code> call the method showing the current task list (updated) <br> <code>end</code> <br> <br>  the method deletes the task, the task number is used as an argument <br> <code>def task_remove(number)</code> <br>  if the argument is incorrect <br> <code>if number.to_i &gt; (@buffer.index(@buffer.last)) <br> puts "&gt; Please write a correct task index"</code> <br>  if right <br> <code>else <br> puts "&gt; Task #{number} removed"</code> <br>  delete the task from the buffer <br> <code>@buffer.delete_at(number.to_i)</code> <br>  Call the method that writes the entire buffer to a file. <br> <code>task_write_to_file <br> end</code> <br>  call the method showing the current task list (updated) <br> <code>task_list <br> end</code> <br> <br>  method showing current task list <br> <code>def task_list <br> puts "********* #{@buffer.index(@buffer.last) + 1} item's *********\n"</code> <br>  pass through each element of the buffer <br> <code>@buffer.each do |task| <br> puts "\t #{@buffer.index(task)} - #{task}" <br> end <br> puts "\n********* #{@buffer.index(@buffer.last) + 1} item's *********" <br> end <br></code> <br>  a method that writes the entire buffer to a file <br> <code>def task_write_to_file</code> <br>  open the file, if you specify 'w' as the second argument, then each time the file will be written again, unlike the alternative argument 'a' <br> <code>file = File.new('list.dat', 'w')</code> <br>  pass through each element of the buffer <br> <code>@buffer.each do |task|</code> <br>  write current buffer element to file <br> <code>file.puts task <br> end</code> <br>  close the file (save) <br> <code>file.close <br> end <br> end <br></code> <br><br>  <b>I want to draw your attention to the fact that this is a very raw program.</b>  <b>Including in terms of security.</b>  <b>I did not pay much attention to checking what the user enters.</b>  <b>(and meanwhile, this is the most important part) If you like this material, then I will continue to increase the functionality.</b> <br><br>  <a href="">Download the archive with the program</a> [Zip, 1.2 kb] <br>  <b><a href="http://a-pechorin.blogspot.com/2009/11/ruby-to-do.html">Version with a normal backlight in my blog</a></b> </div><p>Source: <a href="https://habr.com/ru/post/77841/">https://habr.com/ru/post/77841/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../77835/index.html">How do we give our emails and passwords</a></li>
<li><a href="../77836/index.html">Cluster Hyper-V 2008 R2 on the knee</a></li>
<li><a href="../77838/index.html">Malware presence detected in the GNOME-Look directory.</a></li>
<li><a href="../77839/index.html">Do you need TK site? (part 1)</a></li>
<li><a href="../77840/index.html">Official desire to introduce censorship in the network, apparently indestructible</a></li>
<li><a href="../77842/index.html">Dock demonstration SVG / SMIL</a></li>
<li><a href="../77844/index.html">Conference Saint Perl</a></li>
<li><a href="../77845/index.html">Alarm from computer and microphone</a></li>
<li><a href="../77846/index.html">Government procurement and open source software - lessons from tenders of the Ministry of Communications, part 2</a></li>
<li><a href="../77847/index.html">How to force users to enter normal information?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>