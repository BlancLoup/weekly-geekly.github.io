<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zabbix + SoapUI = monitoring web services</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, there are many applications and software systems from different developers, which we use to solve common problems. Data exchange and interactio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zabbix + SoapUI = monitoring web services</h1><div class="post__text post__text-html js-mediator-article">  Today, there are many applications and software systems from different developers, which we use to solve common problems.  Data exchange and interaction between applications provide web services.  To test their work, debugging the interaction between themselves and client applications also released a lot of tools.  The most popular of them is <b>SoapUI</b> : it supports SOAP / WSDL, REST, HTTP (S), JDBS, JMS and has a set of tools that make testing easier and more intuitive.  SoapUI acts as a test service and test client and allows you to test the integration of subsystems.  More information about the tool can be found <a href="http://www.soapui.org/">on the official website of the developer</a> . <br><br> <a href="http://habrahabr.ru/company/at_consulting/blog/273805/"><img src="https://habrastorage.org/files/595/db3/0bd/595db30bd4e74031877c2e5d78573519.jpg"></a> <br><br>  If a single computer and a set of applications are used to solve the task, a PC crash or a failure of one of the programs is detected quickly.  But what to do when there is a lot of hardware and software in the organization?  It is physically difficult and very costly to monitor and check every free minute whether everything is in order.  To solve this problem, specialized software systems come to the rescue, of which you will find a lot of them on the Internet: one of them is Zabbix. <br><a name="habracut"></a><br>  This software package is designed to track various network parameters and hardware performance.  If any monitoring element fails, Zabbix will be able to notify interested persons via e-mail and sms.  Read more about Zabbix can also be found <a href="http://zabbix.com/">on the official website of the developer</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Imagine the situation.  The company uses many technical tools that Zabbix monitors, and various applications are not own development, but other IT companies.  Part or all of these solutions are related to each other and solve one problem.  To ensure timely detection of failures in this set of elements and quickly locate the problem, we need to set up web services monitoring. <br>  What are the options? <br><br><h2>  The first option is using Zabbix functionality, configure web monitoring. </h2><br>  This guide is not about how to work with Zabbix, so I will briefly describe the steps. <br><br>  <b>Create a script.</b> <br>  Setup - Web‚Äì Create Script. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e33/ad2/fbf/e33ad2fbf82ea326a59f3c16a8b00d7e.png"><br><br>  On the ‚ÄúScript‚Äù tab, you must fill in the ‚ÄúData Item Group‚Äù and ‚ÄúName‚Äù (script) fields. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9af/c16/95f/9afc1695f90c8114f0e55ff9373a245c.png"><br><br>  Go to the tab "Steps", add a step script.  Fill in the fields: step name, URL, response code. <br><br>  In the "URL" enter the address of the desired web service: <a href="">http: // Host: port / Service_name</a> . <br><br>  In the "Answer code" enter " <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BF%25D0%25B8%25D1%2581%25D0%25BE%25D0%25BA_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25B2_%25D1%2581%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25B8%25D1%258F_HTTP">200 OK</a> (" good ").  A list of all HTTP status codes can be found <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BF%25D0%25B8%25D1%2581%25D0%25BE%25D0%25BA_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25B2_%25D1%2581%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25B8%25D1%258F_HTTP">here.</a> <br><br> <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BF%25D0%25B8%25D1%2581%25D0%25BE%25D0%25BA_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25B2_%25D1%2581%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25B8%25D1%258F_HTTP"><img src="https://habrastorage.org/getpro/habr/post_images/2b0/e10/392/2b0e10392ae2ff7a3c7cb349f9e21256.png"></a> <br><br>  Next, set up a trigger on the created script. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/215/305/f19/215305f1943c2a5a7912281f939bc34f.png"><br><br>  Fill in the required fields: the name of the trigger and the expression - as shown in the figure below. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/572/c33/017/572c330175bf6210afa6c8b248cbe29d.png"><br><br>  What did we get as a result?  We created a web monitoring element - ‚ÄúTest‚Äù, which polls the page at the address specified in the script, and a trigger that will work as soon as the web service is unavailable (that is, the ‚ÄúMonitoring‚Äù monitoring element receives a code other than ‚Äú200‚Äù ). <br><br>  This will be sufficient if nothing is needed except to make sure that the web service is available.  But, if you need to monitor not only accessibility, but also the correctness of the work, then this method will not work. <br><br><h2>  The second option is to ‚Äúmake friends‚Äù with Zabbix and SoapUI. </h2><br>  Immediately clarify: Zabbix-server deployed on a machine running Linux. <br><br>  We presume that SoapUI is already installed on the machine where the Zabbix server is spinning.  For example, let's take a certain web service Soap with a single getScore method, which, at the client's request, returns a certain data structure: sections with the names of fields and sections with data. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ed/ef8/ed9/7edef8ed996297aa83cd1292aa5292a4.png"><br><br>  To understand that a web service is working correctly, you need to set criteria: <br>  A) the method returns the correct answer; <br>  B) the method returns the correct composition of the fields in the field section; <br>  C) the method returns a non-empty data set (data sections are filled); <br>  D) the number of fields in the sections of fields and data are equal; <br><br>  The first thing to do is create the test itself, which we plan to check the correctness of the web service.  SoapUI allows you to create test scripts to fully test web services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d52/8fd/080/d528fd0804f06e926ab53f5d2fcb826e.png"><br><br>  As can be seen in the screenshot above, checks on criteria A and B are implemented by standard SoapUI tools.  To implement checks on the criteria of B and G will have to "poshamanit" with the element SoapUI "Groovy Scripts". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/42d/53a/04e/42d53a04ed900a9ea42242e759f733e9.png"><br><br><pre><code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">groovyUtils</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">com</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eviware</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">soapui</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">support</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GroovyUtils</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( context )</span></span></span></span>; step=context.testCase.getTestStepAt(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">holder</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">groovyUtils</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getXmlHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(step.name+</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"#Response"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; holder.declareNamespace(<span class="hljs-string"><span class="hljs-string">"scor"</span></span>,<span class="hljs-string"><span class="hljs-string">"http://xml.spss.com/scoring-v2"</span></span>) ; holder.declareNamespace(<span class="hljs-string"><span class="hljs-string">"rem"</span></span>,<span class="hljs-string"><span class="hljs-string">"http://xml.spss.com/scoring-v2/remote"</span></span>) ; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">columnNamesNode</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">holder</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDomNodes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"//scor:columnNames/scor:name"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rowValuesNode</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">holder</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDomNodes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"//scor:rowValues"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValuesNode</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">holder</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDomNodes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"//rem:getScoreResponse[1]/scor:scoreResult[1]/scor:rowValues[1]/scor:value"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; int countNames = columnNamesNode.size(); int countRowValues = rowValuesNode.size(); int countValues = ValuesNode.size(); assert   countRowValues&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> : log.error(<span class="hljs-string"><span class="hljs-string">"The Node with name \"rowValues\" is not found in the Response"</span></span>); assert   countNames==countValues : log.error (<span class="hljs-string"><span class="hljs-string">"The count of elements of the node \"columnNames\" doesn't coincide with count of  elements  of the node \"rowValues\"!"</span></span>);</code> </pre> <br>  So, the test script to verify the correctness of the web service is ready.  It remains to make Zabbix and SoapUI work in conjunction. <br><br>  SoapUI tests can be <a href="http://www.soapui.org/test-automation/running-functional-tests.html">run</a> from the console.  Why not use this opportunity? <br><br>  Below is a listing script for monitoring various services. <br><br><pre> <code class="hljs kotlin">#!/bin/sh ##   SoapUI pathSoapUIDirectory=/usr/local/soapUI/bin/ ##    Zabbix pathZabbixDirectory=/etc/zabbix ## ,    SoapUI   - pathSoapUiProjectWithName=$pathZabbixDirectory/WebTest/<span class="hljs-string"><span class="hljs-string">"$2.xml"</span></span> ##   ,      - pathParentReportDir=/<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/www/zabbix/SoapReport ##   ,      - c     pathReportsDirectory=$pathParentReportDir/<span class="hljs-string"><span class="hljs-string">"$2"</span></span> ##         .   ,     ,           pathReportsDirectoryForHost=$pathReportsDirectory/<span class="hljs-string"><span class="hljs-string">"$1"</span></span> ##              -,         . <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -d <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathParentReportDir</span></span></span><span class="hljs-string">"</span></span> ]; then chmod <span class="hljs-number"><span class="hljs-number">666</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathParentReportDir</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> mkdir <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathParentReportDir</span></span></span><span class="hljs-string">"</span></span> chmod <span class="hljs-number"><span class="hljs-number">666</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathParentReportDir</span></span></span><span class="hljs-string">"</span></span> fi <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -d <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectory</span></span></span><span class="hljs-string">"</span></span> ]; then chmod <span class="hljs-number"><span class="hljs-number">666</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectory</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> mkdir <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectory</span></span></span><span class="hljs-string">"</span></span> chmod <span class="hljs-number"><span class="hljs-number">666</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectory</span></span></span><span class="hljs-string">"</span></span> fi <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -d <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectoryForHost</span></span></span><span class="hljs-string">"</span></span> ]; then chmod <span class="hljs-number"><span class="hljs-number">666</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectoryForHost</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> mkdir <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectoryForHost</span></span></span><span class="hljs-string">"</span></span> chmod <span class="hljs-number"><span class="hljs-number">666</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectoryForHost</span></span></span><span class="hljs-string">"</span></span> fi ##   ,   SoapUI   ,    .     searchfile=$pathReportsDirectoryForHost/<span class="hljs-string"><span class="hljs-string">"alltests-fails.html"</span></span> ## host:port/service_name endPoint=<span class="hljs-string"><span class="hljs-string">"$3"</span></span> ##   ,      ( Excel),   pathTestdataDirectory=$pathZabbixDirectory/WebTest/TestData/<span class="hljs-string"><span class="hljs-string">"$6"</span></span> ##    - Excel workSpaceName=<span class="hljs-string"><span class="hljs-string">"$7"</span></span> ##      testSuiteName=<span class="hljs-string"><span class="hljs-string">"$4"</span></span> ##      testCaseName=<span class="hljs-string"><span class="hljs-string">"$5"</span></span> ##    ,       ,     SoapUI commandString=<span class="hljs-string"><span class="hljs-string">"sh </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathSoapUIDirectory</span></span></span><span class="hljs-string">/testrunner.sh -e </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$endPoint</span></span></span><span class="hljs-string"> -s </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$testSuiteName</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -n <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$testCaseName</span></span></span><span class="hljs-string">"</span></span> ] then commandString=${commandString}<span class="hljs-string"><span class="hljs-string">" -c </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$testCaseName</span></span></span><span class="hljs-string">"</span></span> fi commandString=${commandString}<span class="hljs-string"><span class="hljs-string">" -r -j -f </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathReportsDirectoryForHost</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -n <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathTestdataDirectory</span></span></span><span class="hljs-string">"</span></span> ] then commandString=${commandString}<span class="hljs-string"><span class="hljs-string">" -P pathTestData=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathTestdataDirectory</span></span></span><span class="hljs-string"> -P varSpace=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$workSpaceName</span></span></span><span class="hljs-string">"</span></span> fi commandString=${commandString}<span class="hljs-string"><span class="hljs-string">" -I </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pathSoapUiProjectWithName</span></span></span><span class="hljs-string">"</span></span> ##     zabbix cd /home/zabbix $commandString &gt; $pathReportsDirectoryForHost/<span class="hljs-string"><span class="hljs-string">"$2RunLogs.txt"</span></span> ###For Debug### #errorString=<span class="hljs-string"><span class="hljs-string">"### ErrorCode: 1 - error of start of the project, 2 - Error of assertions of the tests, 0 - All ok. The returned code:"</span></span> #echo <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$errorString</span></span></span><span class="hljs-string"> "</span></span>$? &gt;&gt; /tmp/<span class="hljs-string"><span class="hljs-string">"$2RunLogs.txt"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ $? -ne <span class="hljs-number"><span class="hljs-number">0</span></span> ]; then echo <span class="hljs-string"><span class="hljs-string">"ErrorOfRunProject"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ ! -f <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$searchfile</span></span></span><span class="hljs-string">"</span></span> ] then echo <span class="hljs-string"><span class="hljs-string">"FileNotFound"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> grep -w <span class="hljs-string"><span class="hljs-string">"Failure"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$searchfile</span></span></span><span class="hljs-string">"</span></span> &gt; /dev/<span class="hljs-literal"><span class="hljs-literal">null</span></span>; then echo <span class="hljs-string"><span class="hljs-string">"TestFailure"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> echo <span class="hljs-string"><span class="hljs-string">"OK"</span></span> fi fi fi</code> </pre><br>  This script must be placed in the / externalscripts folder so that ‚ÄúZabbix‚Äù can see it, because, by default, external scripts must be located in this folder.  In our case, the ‚ÄúRunTestService.sh‚Äù script should be in ‚Äú/ etc / zabbix / externalscripts‚Äù.  You need to give the script permission to start: <br><br><pre> <code class="hljs perl">sudo <span class="hljs-keyword"><span class="hljs-keyword">chmod</span></span> <span class="hljs-number"><span class="hljs-number">755</span></span> /etc/zabbix/externalscripts/RunTestService.sh</code> </pre> <br>  It remains to configure Zabbix itself to work with this script.  To do this, you need to create a data item with the type "External Verification". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/896/bbf/718/896bbf718d95c9bad142604f6d2de3b1.png"><br><br>  Since the script returns text values, it is necessary to specify ‚ÄúText‚Äù in the ‚ÄúType of information‚Äù. <br>  The ‚Äúkey‚Äù looks like this: <br><br><pre> <code class="hljs perl">RunTestService.sh[<span class="hljs-string"><span class="hljs-string">"{HOSTNAME}"</span></span>,<span class="hljs-string"><span class="hljs-string">"ScoringProcessTests"</span></span>,<span class="hljs-string"><span class="hljs-string">"{$SCORING.ENDPOINT}"</span></span>,<span class="hljs-string"><span class="hljs-string">"getScoreTestSuite"</span></span>,<span class="hljs-string"><span class="hljs-string">"getScoreTestCase"</span></span>]</code> </pre> <br>  Where: <br>  "RunTestService.sh" - our script; <br>  "{HOSTNAME}" - the name of the host on which the service is deployed to separate the reports of some services on different hosts; <br>  ‚ÄúScoringProcessTests‚Äù - the name of the SoapUI project for testing a web service; <br>  "{$ ENDPOINT}" - the URL of the web service; <br>  ‚ÄúGetScoreTestSuite‚Äù - the name of the test set of scenarios in the project SoapUI; <br>  ‚ÄúGetScoreTestCase‚Äù is the name of the test script in the SoapUI project; <br><br>  In order for Zabbix to inform about a detected web service failure, you need to configure a trigger. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d4/5c9/71f/3d45c971f42e0c1b3010f49a1ce0c5b1.png"><br><br>  The trigger will be triggered if the data element receives a value other than ‚ÄúOK‚Äù, and Zabbix displays in its interface the fact of a failure detection and notifies the interested persons by mail, sms or other means.  The way of notification depends on the needs of users. <br><br>  Thus, Zabbix and SoapUI each separately for free provide a huge range of functions.  Individually, these products cannot solve the tasks that they have in strength in tandem.  How else to implement this bundle, everyone can come up with himself. <br><br>  PS: The other day I deployed Zabbix from scratch on Centos 7 OS and set up monitoring according to the algorithm described above.  It turned out a number of details that I can deliver a number of problems. <br><br>  1. To work correctly, you need X11 <br>  2. SoaupUIPRO 5.1.1 not higher.  (Write in the LAN, if you need links)))) <br>  3. Sometimes the response of the ‚ÄúErrorOfRunProject‚Äù script is returned to the zabbiks, although it works out from the console under a zabbix user.  This is resolved by granting the zabbix user the right to run SoapUI under sudo for this, in / etc / sudoers, at the end of the file, add a line like this: <br><pre> <code class="hljs pgsql">zabbix <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span>) NOPASSWD: /usr/bin/java, /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/SmartBear/SoapUI-Pro<span class="hljs-number"><span class="hljs-number">-5.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/bin/testrunner.sh, /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/SmartBear/SoapUI-Pro<span class="hljs-number"><span class="hljs-number">-5.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/bin/soapui-pro.sh</code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/273805/">https://habr.com/ru/post/273805/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273795/index.html">Creating a website. Course young fighter</a></li>
<li><a href="../273797/index.html">How we made Rich Text Editor with support for co-editing under Android</a></li>
<li><a href="../273799/index.html">New Year Promotion for HPE ProLiant Gen9 Servers</a></li>
<li><a href="../273801/index.html">A new version of LinqTestable has been released - libraries for testing requests to the database via ORM</a></li>
<li><a href="../273803/index.html">IBM FlashSystem 900 storage system overview</a></li>
<li><a href="../273807/index.html">Parse HTML in .NET and Survive: Analyzing and Comparing Libraries</a></li>
<li><a href="../273809/index.html">Comparison of free software accounting traffic SQUID</a></li>
<li><a href="../273811/index.html">New Year's release of PVS-Studio 6.00: check Roslyn</a></li>
<li><a href="../273813/index.html">Balancing traffic between two NATs on different providers on the same cisco physical router</a></li>
<li><a href="../273815/index.html">A bit about container virtualization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>