<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Access Oracle Database with ADO.NET Entity Framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 

 When developing software, it has always been guided by a simple rule: the less third-party components, platforms, technologies are used i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Access Oracle Database with ADO.NET Entity Framework</h1><div class="post__text post__text-html js-mediator-article"><br>  Good day. <br><br>  When developing software, it has always been guided by a simple rule: the less third-party components, platforms, technologies are used in a developing project, the better.  Almost all ingenious is simple.  Unfortunately, the developer does not always have the opportunity to freely choose the tools and systems with which he works.  So I got the project Windows Forms + ODAC + Oracle DB Server. <br><br>  I was very happy to <a href="http://www.oracle.com/technetwork/topics/dotnet/downloads/oracleefbeta-302521.html">hear</a> about the release of the <a href="http://www.oracle.com/technetwork/topics/dotnet/downloads/oracleefbeta-302521.html">Oracle Data Access Components (ODAC) for the Microsoft Entity Framework and the LINQ to Entities (Beta2)</a> .  I was waiting for this moment and now it has happened!  You can not use third-party ORM - all turnkey. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How to teach an application to use the Entity Framework through an ODAC client installed on the end machines is described in a <a href="http://www.oracle.com/webfolder/technetwork/tutorials/obe/db/dotnet/EntityFrameworkOBE/EntityFrameworkOBE.htm">step-by-step instruction from Oracle</a> .  Who cares how to get rid of the need to install an Oracle client on users' machines, please under cat. <a name="habracut"></a><br><br><h4>  <font color="#000000">General requirements</font> </h4><br><br>  To user system: <br><ol><li>  OS is not lower than MS Windows XP SP3 </li><li>  Microsoft .NET Framework 4 </li><li>  Additional ~ 135 MB of free disk space </li></ol><br>  To the developer system: <br><ol><li>  Visual Studio 2010 Service Pack 1 </li><li>  Oracle Database server 9.2 or higher </li><li>  ODAC for Microsoft Entity Framework and LINQ to Entities </li></ol><br><br><h5>  <font color="#000000">Link Libraries</font> </h5><br>  To organize access to the Oracle database, you need to add the following libraries from the ODAC.NET package to the project: connect the library "client path" \ client_1 \ odp.net \ bin \ 4 \ <b>Oracle.DataAccess.dll</b> (~ 1.4 MB) as Reference and set the ‚Äú <i>Copy local</i> ‚Äù property to ‚Äú <i>true</i> ‚Äù. <br><br>  The following files just need to be added to the project and set the ‚Äú <i>Copy to Output Directory</i> ‚Äù property <i>to</i> ‚Äú <i>Copy if newer</i> ‚Äù: <br><ul><li>  "Client path" \ client_1 \ oci.dll (~ 1 MB) </li><li>  ‚ÄúClient path‚Äù \ client_1 \ orannzsbb11.dll (~ 1.2 MB) </li><li>  "Client path" \ client_1 \ bin \ OraOps11w.dll (~ 0.3 MB) </li><li>  "Client path" \ client_1 \ oraociei11.dll (~ 130 MB) </li></ul><br>  The connection string should look the same as in the tnsnames.ora file: <br><br>  <font color="#A31515">Data Source = (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP) (HOST = ServerNameOrIP) (PORT = PortNumber))) (CONNECT_DATA = (SERVICE_NAME = DBName))); User Id = UserName; Password = UserPa $$ w0rd;</font> <br><br>  This is enough to provide access to the database without installing the client on the user's machine: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">bool</font> TestConnect() <br> { <br> <font color="#0000ff">try</font> <br> { <br> <font color="#0000ff">var</font> oracleConnection = <font color="#0000ff">new</font> OracleConnection <br> { <br> ConnectionString = <br> <font color="#A31515">"Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ServerNameOrIP)(PORT=PortNumber)))(CONNECT_DATA=(SERVICE_NAME=DBName)));User Id=UserName;Password=UserPa$$w0rd;"</font> <br> }; <br> oracleConnection.Open(); <br> <font color="#0000ff">var</font> oracleCommand = <font color="#0000ff">new</font> OracleCommand <br> { <br> CommandText = <font color="#A31515">"select sysdate from dual"</font> , <br> Connection = oracleConnection, <br> Transaction = <font color="#0000ff">null</font> <br> }; <br> <font color="#0000ff">var</font> oracleDataAdapter = <font color="#0000ff">new</font> OracleDataAdapter {SelectCommand = oracleCommand}; <br> <font color="#0000ff">var</font> sysDateDataSet = <font color="#0000ff">new</font> DataSet( <font color="#A31515">"SomeName"</font> ); <br> oracleDataAdapter.Fill(sysDateDataSet, <font color="#A31515">"dateTimeTable"</font> ); <br> <font color="#0000ff">return</font> sysDateDataSet.Tables[0].Rows.Count &gt; 0; <br> } <br> <font color="#0000ff">catch</font> (Exception exx) <br> { <br> MessageBox.Show( <font color="#0000ff">string</font> .Format( <font color="#A31515">"Could not connect directly to an Oracle database: \n {0}"</font> , exx.Message)); <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><h5>  <font color="#000000">What you need to do to use the Entity Framework Model without installing an Oracle client</font> </h5><br>  Create, or your own ADO.NET Entity Data Model, or, as in the example, ‚ÄúHRModel‚Äù with the context ‚ÄúHREntities‚Äù.  To do this, use the Add Wizard, as shown in <a href="http://www.oracle.com/technetwork/topics/dotnet/downloads/oracleefbeta-302521.html">the Oracle manual mentioned above</a> . <br><br>  The project configuration file (App.Config / Web.Config) will automatically (if you select this corresponding item in the wizard) a connection string to the Oracle database is added: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">add</font> <font color="#ff0000">name</font> <font color="#0000ff">="HREntities"</font> <font color="#ff0000">connectionString</font> <font color="#0000ff">="metadata=res://*/HRModel.csdl|res://*/HRModel.ssdl|res://*/HRModel.msl;provider=Oracle.DataAccess.Client;provider connection string="Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ServerNameOrIP)(PORT=PortNumber)))(CONNECT_DATA=(SERVICE_NAME=DBName)));User Id=UserName;Password=UserPa$$w0rd;""</font> <font color="#ff0000">providerName</font> <font color="#0000ff">="System.Data.EntityClient"</font> <font color="#0000ff">/&gt;</font></font></code> </blockquote> <br>  Here you should pay special <b>attention</b> to the fact that the value assigned to the attribute ‚Äú <i>connection connection</i> ‚Äù must be in double quotes (to denote them, you must use the code &amp; _q_u_o_t).  This is also worth considering when dynamically forming the connection string. <br><br>  Then in <b>the project configuration file</b> you need to create a section in which we add our data provider to those already registered in the system, the list of which is in the file "% windir% \ Microsoft.NET \ Framework \ v4.0.30319 \ Config \ machine.config".  If ODAC is installed on the machine, then the <font color="#0000ff">‚ÄúOracle.DataAccess.Client‚Äù</font> provider will already be registered in the system configuration file and an attempt to add our provider will cause an error when the application starts: ‚ÄúCollision‚Äù InvariantName 'is constrained to be unique.  Value 'Oracle.DataAccess.Client' is already present. ‚Äù <br><br>  To prevent such a situation, using the tag <br>  <font color="#0000ff">&lt;</font> <font color="#800000">remove</font> <font color="#ff0000">invariant</font> <font color="#0000ff">= "Oracle.DataAccess.Client"</font> <font color="#0000ff">/&gt;</font> <br>  provider ‚ÄúOracle.DataAccess.Client‚Äù will be removed from the list of data providers, if present.  Then we add our supplier.  It will be added to the list of EntityClient providers registered in the system: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">system.data</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">DbProviderFactories</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">remove</font> <font color="#ff0000">invariant</font> <font color="#0000ff">="Oracle.DataAccess.Client"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">add</font> <font color="#ff0000">name</font> <font color="#0000ff">="Oracle.DataAccess.Client"</font> <font color="#ff0000">invariant</font> <font color="#0000ff">="Oracle.DataAccess.Client"</font> <font color="#ff0000">description</font> <font color="#0000ff">="Oracle Data Provider for .NET"</font> <font color="#ff0000">type</font> <font color="#0000ff">="Oracle.DataAccess.Client.OracleClientFactory, Oracle.DataAccess, Version=4.112.2.40, Culture=neutral, PublicKeyToken=89b483f429c47342"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">DbProviderFactories</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">system.data</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br><br><h5>  <font color="#000000">Subtleties</font> </h5><br>  When a model is dynamically connected to the database <a href="http://msdn.microsoft.com/ru-ru/library/bb738533(v%3DVS.100).aspx">using the ‚Äúcorrect‚Äù method from MS</a> , attention should be paid to the not quite correct formation of the connection string through the EntityConnectionStringBuilder object <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">string</font> providerName = <font color="#A31515">"Oracle.DataAccess.Client"</font> ; <br> <font color="#0000ff">string</font> dataSourse = (DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ServerNameOrIP)(PORT=PortNumber)))(CONNECT_DATA=(SERVICE_NAME=DBName)));User Id=UserName;Password=UserPa$$w0rd;‚Äù; <br> <font color="#0000ff">var</font> sqlBuilder = <br> <font color="#0000ff">new</font> SqlConnectionStringBuilder <br> { <br> DataSource = dataSourse <br> }; <br> <font color="#0000ff">string</font> providerString = sqlBuilder.ToString(); <br> <font color="#0000ff">var</font> entityBuilder = <br> <font color="#0000ff">new</font> EntityConnectionStringBuilder <br> { <br> Provider = providerName, <br> ProviderConnectionString = providerString, <br> Metadata = <br> <font color="#A31515">@"res://*/HRModel.csdl|res://*/HRModel.ssdl|res://*/HRModel.msl"</font> <br> }; <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> conn = <br> <font color="#0000ff">new</font> EntityConnection(entityBuilder.ToString())) <br> { <br> conn.Open(); <br> <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"Just testing the connection."</font> ); <br> conn.Close(); <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  As a result, entityBuilder.ToString () will return a connection string with extra single quotes, which enclose the entire value of the provider connection string attribute <br><blockquote> <code><font color="#A31515">metadata=‚Ä¶;provider=Oracle.DataAccess.Client;provider connection string= <font color="red">'</font> Data Source= <font color="red">\"</font> (DESCRIPTION=(‚Ä¶ ); User Id=UserName;Password=UserPa$$w0rd; <font color="red">\"'</font></font></code> </blockquote> <br>  While the Oracle provider requires a connection string of the following format: <br><blockquote> <code><font color="#A31515">metadata=‚Ä¶;provider=Oracle.DataAccess.Client;provider connection string= <font color="red">\"</font> Data Source=(DESCRIPTION(‚Ä¶); User Id=UserName;Password=UserPa$$w0rd; <font color="red">\"</font></font></code> </blockquote> <br>  - otherwise it gives an error. <br>  While you can form a connection string ugly: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">bool</font> DynamicConnect() <br> { <br> <font color="#0000ff">const</font> <font color="#0000ff">string</font> providerName = <font color="#A31515">"Oracle.DataAccess.Client"</font> ; <br> <font color="#0000ff">const</font> <font color="#0000ff">string</font> serverName = <font color="#A31515">"(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ServerNameOrIP)(PORT=PortNumber)))(CONNECT_DATA=(SERVICE_NAME=DBName)));User Id=UserName;Password=UserPa$$w0rd;"</font> ; <br> <font color="#0000ff">const</font> <font color="#0000ff">string</font> metadata = <font color="#A31515">"metadata=res://*/HRModel.csdl|res://*/HRModel.ssdl|res://*/HRModel.msl"</font> ; <br> <font color="#0000ff">var</font> entBild = <font color="#0000ff">string</font> .Format( <font color="#A31515">"metadata={0};provider={1};provider connection string=\"Data Source={2}\";"</font> , metadata, providerName, serverName); <br> <font color="#0000ff">try</font> <br> { <br> <font color="#0000ff">var</font> conn = <font color="#0000ff">new</font> EntityConnection(entBild); <br> conn.Open(); <br> <font color="#0000ff">var</font> hrEntities = <font color="#0000ff">new</font> HREntities(conn); <br> <font color="#0000ff">var</font> tmpResult = hrEntities.BRIDGE.Count(); <br> conn.Close(); <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">catch</font> (Exception exx) <br> { <br> MessageBox.Show( <font color="#0000ff">string</font> .Format( <font color="#A31515">"Could not connect directly to an Oracle database: \n {0}"</font> , exx.Message)); <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Perhaps this is the echo of the beta version - let's see how it will be in the release, which, as Oracle promises, will take place in the fourth quarter of 2011. <br><br><br><h5>  <font color="#000000">As a result, you can write to the asset:</font> </h5><br><ul><li>  Direct connection of the .NET Entity Framework with the Oracle DB Server DBMS, without using third-party developments </li><li>  Getting rid of client installation to Oracle DB Server on users' workstations </li><li>  Deploying .NET applications using Oracle DBMS using ClickOnce technology without providing administrator rights to the end user (this was my main task). </li></ul><br><h5>  <font color="#000000">In the passive can be entered:</font> </h5><br><ul><li>  An increase in the application size of ~ 130 MB is not very critical in my case, since ClickOnce downloads only modified or new files. </li></ul>  In the near future, there is a desire to compare the speed of work through the ODAC for Microsoft Entity Framework + Oracle vs System.Data.SqlClient + MS SQL Server. <br><br>  Thank you for your time. <br><br><h5>  <font color="#000000">List of sources on the topic:</font> </h5><ul><li>  <a href="http://msdn.microsoft.com/ru-ru/library/bb399572.aspx">ADO.NET Entity Framework</a> </li><li>  <a href="http://www.oracle.com/technetwork/topics/dotnet/whatsnew/index.html">Oracle .NET Developer Center</a> </li><li>  <a href="http://msdn.microsoft.com/ru-ru/asp.net/gg430455.aspx">Introduction to ASP.NET MVC</a> </li><li>  Connect to Oracle without installing the client <a href="http://ora-00001.blogspot.com/2010/01/odpnet-minimal-non-intrusive-install.html">once</a> and <a href="http://alderprogs.blogspot.com/2009/04/deploying-odpnet-with-oracle-instant.html">twice</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/127603/">https://habr.com/ru/post/127603/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127595/index.html">Startup in Russian: today and tomorrow</a></li>
<li><a href="../127596/index.html">Apple resumed sales of Final Cut Studio Pro</a></li>
<li><a href="../127597/index.html">Google Searched Queries</a></li>
<li><a href="../127599/index.html">An interesting feature of PCoIP in VMware View</a></li>
<li><a href="../127602/index.html">Amazon ElastiCache small review - does it need a typical web project?</a></li>
<li><a href="../127604/index.html">Alyosha Popovich vs Tugarin Snake or how I struggled with spam</a></li>
<li><a href="../127605/index.html">HTC Titan, HTC Radar and HTC Mozart officially presented</a></li>
<li><a href="../127606/index.html">Motivate correctly - give bream</a></li>
<li><a href="../127608/index.html">The tender for the game about the Great Patriotic War for 90 million</a></li>
<li><a href="../127609/index.html">How would you translate REpresentational State Transfer (REST) ‚Äã‚Äãinto Russian?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>