<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Genetic algorithm for constructing algorithms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a typical implementation, the genetic algorithm operates with parameters of some complex function (Diophantine equations in the article " Genetic a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Genetic algorithm for constructing algorithms</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/v3/dq/hn/v3dqhnbpl521torvctmyeifcqey.png" alt="Parker: What do you do on weekends?"></div><br>  In a typical implementation, the genetic algorithm operates with parameters of some complex function (Diophantine equations in the article " <a href="https://habrahabr.ru/post/128704/">Genetic algorithm. Just about complex</a> " <a href="https://habrahabr.ru/users/mrk-andreev/" class="user_link">mrk-andreev</a> ) or algorithm (" <a href="https://habrahabr.ru/post/184766/">Evolution of racing cars in JavaScript</a> " <a href="https://habrahabr.ru/users/ilya42/" class="user_link">ilya42</a> ).  The number of parameters is invariable, operations on them are also impossible to change, as genetics does not try, because they are given by us. <br><br><h3>  Houston, we have a problem </h3><br>  A strange situation has arisen - before applying genetic algorithms (GA) to a real problem, we must first find an algorithm by which this problem is solved in principle, and only then can it be optimized using a genetic algorithm.  If we make a mistake with the choice of the ‚Äúmain‚Äù algorithm, then genetics will not find the optimum and will not say what the error is. <br><br>  Often, and recently, it is fashionable to use a neural network instead of a deterministic algorithm.  Here we also have the widest choice (FNN, CNN, RNN, LTSM, ...), but the problem remains the same - you need to choose the right one.  According to Wikipedia, " <i>Choose the type of network should be based on the formulation of the problem and the available data for training</i> ." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What if...?  If you force the GA not to optimize the parameters, but create another algorithm that is most suitable for this task.  That's what I did for the sake of interest. <br><a name="habracut"></a><br><br> <a href="https://lmbd.ru/from_chemistry_with_love/2-podveska-trnk-iz-serebra-s-emalu/"><img src="https://habrastorage.org/webt/iq/65/fp/iq65fpzs02_qo88bog6eucho3nk.jpeg" align="right"></a> <h3>  Genotype from operations </h3><br>  Let me remind you that genetic algorithms usually operate so-called.  "Genotype" vector "genes".  For the GA itself, it does not matter what these genes will be ‚Äî numbers, letters, strings, or amino acids.  It is only important to observe the necessary actions on genotypes - crossing, mutation, selection - not necessarily in this order. <br><br>  So, the idea is that the ‚Äúgenome‚Äù will be an elementary operation, and the ‚Äúgenotype‚Äù will be an algorithm composed of these operations.  For example, a genotype composed of mathematical operations and implementing the function <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn><mi>x</mi><mo>+</mo><mn>20</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0.34</mn></mrow><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.272ex" height="3.262ex" viewBox="0 -1091.4 9589.5 1404.6" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-29" x="1512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-3D" x="2179" y="0"></use><g transform="translate(3236,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-28" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-66" x="743" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-72" x="1293" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-61" x="1745" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-63" x="2274" y="0"></use><g transform="translate(1914,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-33" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMATHI-78" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-2B" x="1073" y="0"></use><g transform="translate(1309,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-30" x="500" y="0"></use></g></g><g transform="translate(3931,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-30"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-2E" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-33" x="779" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-34" x="1279" y="0"></use></g><g transform="translate(5190,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/346134/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4eNJcmApnp01R6ttRYMkwUFXzUA#MJMAIN-32" x="550" y="675"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn><mi>x</mi><mo>+</mo><mn>20</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>0.34</mn></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> f (x) = e ^ {(\ frac {3x + 20} {0.34}) ^ 2} </script>  : <br><br><img src="https://habrastorage.org/webt/v3/fy/aq/v3fyaqw10sxdebso_tjy2wlniww.png" alt="x3 | +20 | /0.34 | ^ 2 | e ^ x"><br><br>  Then, as a result of performing GA, we will get a formula or algorithm, the structure of which we cannot predict in advance. <br><br>  Crossing does not actually change, the new genotype receives pieces from each parent. <br><br>  A mutation can be the replacement of one of the genes for some other, that is, one operation is replaced in the algorithm and / or the parameters of this operation are changed. <br><br>  With the selection and simple and difficult at the same time.  Since we are creating an algorithm, the easiest way to check it is to execute it and evaluate the result obtained.  So cars with their progress on the highway proved the optimality of its architecture.  But the machines had a clear criterion - the further she traveled, the better.  Our target algorithm in the general case can have several evaluation criteria ‚Äî length (the shorter the better), memory requirements (the smaller the better), resistance to input garbage, etc. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k9/ht/ns/k9htnspiccpuuzlao92xmljbcbu.png"></div><br>  By the way, the machines had one criterion, but it worked only within the current route.  The best machine for one track would hardly be the best for another. <br><br><h3>  And if you think? </h3><br>  In the process of thinking about which operations to include in the gene dictionary and how they should work, I realized that I could not limit myself to operations on one variable.  The same neural networks operate with all (FNN) or several (CNN) input variables at the same time, so you need a way to use the required number of variables in the resulting algorithm.  And in what operation which variable is required, I cannot foresee and I do not want to limit. <br><br>  I came to the rescue ... you can not guess ... the language of <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D1%2582_(%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F)">Forth</a> .  More precisely, the <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BF%25D0%25BE%25D0%25BB%25D1%258C%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25B7%25D0%25B0%25D0%25BF%25D0%25B8%25D1%2581%25D1%258C">reverse Polish notation</a> and stack machine with their ability to put variable values ‚Äã‚Äãon the stack and perform operations on them in the right order.  And without brackets. <br><br>  For the stack machine, in addition to arithmetic operations, you need to program the stack operations - <i>push</i> (take the next value from the input stream and put it on the stack), <i>pop</i> (take the value from the stack and return it as a result), <i>dup</i> (duplicate the top value on the stack). <br><br><h3>  Just do it! </h3><br>  It turned out such an object that implements one gene. <br><br><div class="spoiler">  <b class="spoiler_title">Gen Object</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gen</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> func = <span class="hljs-number"><span class="hljs-number">0</span></span> param = () <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.func = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>) self.param = round(random.random()*<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, value, mem)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.func == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment"># push mem.append(value + self.param) return (None, 1) elif self.func == 1: # pop return (mem.pop() + self.param, 0) elif self.func == 2: # dup mem.append(mem[-1] + self.param) return (None, 0) elif self.func == 3: # add mem.append(mem.pop() + value + self.param) return (None, 1) elif self.func == 4: # del mem.append(mem.pop() - (value + self.param)) return (None, 1) elif self.func == 5: # mul mem.append(mem.pop() * (value + self.param)) return (None, 1) elif self.func == 6: # div mem.append(mem.pop() / (value + self.param)) return (None, 1) return (self.params, 0) def funcName(self, func): if self.func &gt;= 0 and self.func &lt;= 7: return [ 'push', 'pop', 'dup', 'add', 'del', 'mul', 'div', 'const'][func] return str(func) def __str__(self): return "%s:%s" % (self.funcName(self.func), str(self.param))</span></span></code> </pre> </div></div><br>  It was the first option, in principle, working, but a problem quickly emerged with it - for arithmetic operations it was required to transmit a value, but not for <i>pop</i> and <i>dup</i> operations on the stack.  I didn‚Äôt want to distinguish the called operations in the calling code and determine how many parameters should be passed to each of them, so I did it - instead of one <i>value, I</i> passed an array of input values, and let the operation itself do what it wants with it. <br><br><div class="spoiler">  <b class="spoiler_title">Gen v.2 object</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gen</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> func = <span class="hljs-number"><span class="hljs-number">0</span></span> param = () <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.func = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>) self.param = round(random.random()*<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, values, mem)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.func == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment"># pop return mem.pop() + self.param elif self.func == 1: # push mem.append(values.pop() + self.param) return None elif self.func == 2: # dup mem.append(mem[-1] + self.param) return None elif self.func == 3: # add mem.append(mem.pop() + values.pop() + self.param) return None elif self.func == 4: # del mem.append(mem.pop() - (values.pop() + self.param)) return None elif self.func == 5: # mul mem.append(mem.pop() * (values.pop() + self.param)) return None elif self.func == 6: # div mem.append(mem.pop() / (values.pop() + self.param)) return None return self.param def funcName(self, func): if self.func &gt;= 0 and self.func &lt;= 7: return [ 'pop', 'push', 'dup', 'add', 'del', 'mul', 'div', 'const'][func] return str(func) def __str__(self): return "%s:%s" % (self.funcName(self.func), str(self.param))</span></span></code> </pre></div></div><br>  The second problem was that arithmetic operations were too demanding - they needed both the value on the stack and the input value.  As a result, not a single genotype could form a genetic algorithm.  It was necessary to divide the operations into those working with the stack and those working with the input value. <br><br>  Below is the latest version. <br><br><div class="spoiler">  <b class="spoiler_title">Gen v.8 object</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gen</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> func = <span class="hljs-number"><span class="hljs-number">0</span></span> param = () <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, func=None)</span></span></span><span class="hljs-function">:</span></span> super().__init__() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> func <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: funcMap = [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>] i = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(funcMap)<span class="hljs-number"><span class="hljs-number">-1</span></span>) func = funcMap[i] self.func = func self.param = round((random.random()<span class="hljs-number"><span class="hljs-number">-0.5</span></span>)*<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, values, mem)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> v = values[<span class="hljs-number"><span class="hljs-number">0</span></span>] values[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>]=[] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.func == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment"># pop return mem.pop() elif self.func == 1: # push mem.append(getVal()) return None elif self.func == 2: # dup mem.append(mem[-1] + self.param) return None elif self.func == 3: # addVal mem.append(getVal() + self.param) return None elif self.func == 4: # delVal mem.append(getVal() + self.param) return None elif self.func == 5: # mulVal mem.append(getVal() * self.param) return None elif self.func == 6: # divVal mem.append(getVal() / self.param) return None elif self.func == 7: # addMem mem.append(self.param + mem.pop()) return None elif self.func == 8: # delMem mem.append(self.param - mem.pop()) return None elif self.func == 9: # mulMem mem.append(self.param * mem.pop()) return None elif self.func == 10: # divMem mem.append(self.param / mem.pop()) return None mem.append(self.param) return None def funcName(self, func): funcNames = ( 'pop', 'push', 'dup', 'addVal', 'delVal', 'mulVal', 'divVal', 'addMem', 'delMem', 'mulMem', 'divMem', 'const') if self.func &gt;= 0 and self.func &lt; len(funcNames): return funcNames[func] return str(func) def __str__(self): return "%s:%s" % (self.funcName(self.func), str(round(self.param,4)))</span></span></code> </pre></div></div><br>  I had to tinker a bit with the genotype object, selecting the crossing algorithm.  Which one is better, I did not decide, I left pseudo-randomness at will.  The algorithm itself was defined in the multiplication method <i>__mul__</i> . <br><br><div class="spoiler">  <b class="spoiler_title">Dnk object</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Dnk</span></span></span><span class="hljs-class">:</span></span> gen = [] level = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, genlen=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__() self.gen = [ Gen(<span class="hljs-number"><span class="hljs-number">1</span></span>), Gen(<span class="hljs-number"><span class="hljs-number">1</span></span>) ] + [ Gen() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(genlen<span class="hljs-number"><span class="hljs-number">-2</span></span>) ] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, src)</span></span></span><span class="hljs-function">:</span></span> self.gen = src.gen <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__mul__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, other)</span></span></span><span class="hljs-function">:</span></span> divider = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> v = random.random()*(self.level + other.level) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v &lt;=self.level mode = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) minLen = min(len(self.gen), len(other.gen)) maxLen = max(len(self.gen), len(other.gen)) n = Dnk() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> mode == <span class="hljs-number"><span class="hljs-number">0</span></span>: n.gen = [ self.gen[i] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> sel() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> other.gen[i] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(minLen) ] <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> mode == <span class="hljs-number"><span class="hljs-number">1</span></span>: n.gen = [ Gen() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(minLen) ] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> g <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> n.gen: g.param += round((random.random()<span class="hljs-number"><span class="hljs-number">-0.5</span></span>)/divider,<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> mode == <span class="hljs-number"><span class="hljs-number">2</span></span>: n.gen = [ self.gen[i<span class="hljs-number"><span class="hljs-number">-1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> other.gen[i] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(minLen) ] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> g <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> n.gen: g.param += round((random.random()<span class="hljs-number"><span class="hljs-number">-0.5</span></span>)/divider,<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: v = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) n.gen = [ self.gen[i] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i % <span class="hljs-number"><span class="hljs-number">2</span></span> == v <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> other.gen[<span class="hljs-number"><span class="hljs-number">-1</span></span>-i] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(minLen) ] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> g <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> n.gen: g.param += round((random.random()<span class="hljs-number"><span class="hljs-number">-0.5</span></span>)/divider,<span class="hljs-number"><span class="hljs-number">3</span></span>) n.gen = n.gen + [ Gen() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(minLen,maxLen) ] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, values)</span></span></span><span class="hljs-function">:</span></span> res = [] mem = [] varr = values.copy() i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> g <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.gen: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: r = g.calc(varr, mem) i = i + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: self.gen = self.gen[<span class="hljs-number"><span class="hljs-number">0</span></span>:i] <span class="hljs-comment"><span class="hljs-comment">#raise break; if not r is None: res.append(r) return res def __str__(self): return '(' + ', '.join([ str(g) for g in self.gen ]) + '):'+str(round(self.level,2))</span></span></code> </pre></div></div><br>  For both classes, the method <i>__str__ has been</i> redefined to display their contents in the console. <br><br>  The algorithm calculation function is a bit more detailed: <br><br><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, values)</span></span></span><span class="hljs-function">:</span></span> res = [] mem = [] varr = values.copy() i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> g <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.gen: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: r = g.calc(varr, mem) i = i + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: self.gen = self.gen[<span class="hljs-number"><span class="hljs-number">0</span></span>:i] <span class="hljs-comment"><span class="hljs-comment">#raise break; if not r is None: res.append(r) return res</span></span></code> </pre><br>  Pay attention to the commented <i>raise</i> - initially I had an idea that a genotype with an algorithm flying out by mistake should not live in this world and should be rejected immediately.  But there were too many mistakes, the population degenerated, and then I decided not to destroy the object, but to amputate it on this gene.  So the genotype gets shorter, but remains working, and its working genes can be used. <br><br>  So, there is a genotype, there is a dictionary of genes, there is a function of crossing two genotypes.  You can check: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>a = Dnk() &gt;&gt;&gt; b = Dnk() &gt;&gt;&gt; c = a * b &gt;&gt;&gt; print(a) (push:<span class="hljs-number"><span class="hljs-number">4.061</span></span>, push:<span class="hljs-number"><span class="hljs-number">1.79</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-4.32</span></span>, mulMem:<span class="hljs-number"><span class="hljs-number">3.6</span></span>, push:<span class="hljs-number"><span class="hljs-number">-3.752</span></span>, addVal:<span class="hljs-number"><span class="hljs-number">2.4</span></span>, delVal:<span class="hljs-number"><span class="hljs-number">-1.863</span></span>, delMem:<span class="hljs-number"><span class="hljs-number">4.06</span></span>, delVal:<span class="hljs-number"><span class="hljs-number">-3.692</span></span>, addMem:<span class="hljs-number"><span class="hljs-number">0.48</span></span>):<span class="hljs-number"><span class="hljs-number">0</span></span> &gt;&gt;&gt; print(b) (push:<span class="hljs-number"><span class="hljs-number">0.356</span></span>, push:<span class="hljs-number"><span class="hljs-number">-4.8</span></span>, pop:<span class="hljs-number"><span class="hljs-number">2.865</span></span>, delVal:<span class="hljs-number"><span class="hljs-number">1.53</span></span>, addMem:<span class="hljs-number"><span class="hljs-number">-2.853</span></span>, mulVal:<span class="hljs-number"><span class="hljs-number">-1.6</span></span>, const:<span class="hljs-number"><span class="hljs-number">-2.451</span></span>, delVal:<span class="hljs-number"><span class="hljs-number">-2.53</span></span>, divVal:<span class="hljs-number"><span class="hljs-number">4.424</span></span>, delMem:<span class="hljs-number"><span class="hljs-number">-0.6</span></span>):<span class="hljs-number"><span class="hljs-number">0</span></span> &gt;&gt;&gt; print(c) (push:<span class="hljs-number"><span class="hljs-number">4.061</span></span>, divVal:<span class="hljs-number"><span class="hljs-number">4.424</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-4.32</span></span>, const:<span class="hljs-number"><span class="hljs-number">-2.451</span></span>, push:<span class="hljs-number"><span class="hljs-number">-3.752</span></span>, addMem:<span class="hljs-number"><span class="hljs-number">-2.853</span></span>, delVal:<span class="hljs-number"><span class="hljs-number">-1.863</span></span>, pop:<span class="hljs-number"><span class="hljs-number">2.865</span></span>, delVal:<span class="hljs-number"><span class="hljs-number">-3.692</span></span>, push:<span class="hljs-number"><span class="hljs-number">0.356</span></span>):<span class="hljs-number"><span class="hljs-number">0</span></span> &gt;&gt;&gt;</code> </pre> <br>  Now we need breeding functions (selection and crossing the best) and mutations. <br>  The functions of crossing and reproduction of genotypes to the required number I wrote in three versions.  But the worst half dies anyway. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        def mixIts(its, needCount): half = needCount // 2 its[half:needCount] = [] nIts = [] l = min(len(its), half) ll = l // 2 for ii in range(half,needCount): i0 = random.randint(0,l-1) i1 = random.randint(0,l-1) d0 = its[i0] d1 = its[i1] nd = d0 * d1 mutate(nd) its.append(nd) #           def mixIts2(its, needCount): half = needCount // 2 its[half:needCount] = [] nIts = [] l = min(len(its), half) ll = l // 2 for ii in range(half,needCount): i0 = random.randint(0,ll-1) i1 = random.randint(ll,l-1) d0 = its[i0] d1 = its[i1] nd = d0 * d1 mutate(nd) its.append(nd) #            def mixIts3(its, needCount): half = needCount // 2 its[half:needCount] = [] nIts = [] l = min(len(its), half) ll = l // 4 for ii in range(half,needCount): i0 = random.randint(0,ll-1) i1 = random.randint(ll,ll*2-1) d0 = its[i0] d1 = its[i1] nd = d0 * d1 mutate(nd) its.append(nd)</span></span></code> </pre><br>  The mutation function is applied to the new genotype. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mutate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(it)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#      listMix = [ (random.randint(0,len(it.gen)-1), random.randint(0,len(it.gen)-1)) for i in range(3) ] for i in listMix: it.gen[i[0]], it.gen[i[1]] = (it.gen[i[1]], it.gen[i[0]]) #    , for i in [ random.randint(0,len(it.gen)-1) for i in range(3) ]: it.gen[i] = Gen() #        for i in [ random.randint(0,len(it.gen)-1) for i in range(1) ]: it.gen[i].param = it.gen[i].param + (random.random()-0.5)*2</span></span></code> </pre><br>  How can such a genetic algorithm be applied? <br>  For example: <br>  - identify patterns among the input data, regression analysis <br>  - develop an algorithm that restores the fallout in the signal and removes interference - useful for voice communication <br>  - to separate signals that came from different sources on the same channel - useful for voice control, creating a pseudo stereo <br><br>  For these tasks, a genotype is needed, which will take as input an array of input values ‚Äã‚Äãand produce an array of output values ‚Äã‚Äãof the same length.  I tried to combine the tasks of obtaining suitable genotypes and achieving the goal, it turned out to be too difficult.  It was easier to get rid of genetics in order to select genotypes for the initial population, so that these genotypes could generally process the input array. <br><br>  For the selection of genotypes, a function is written, it generates genotypes, drives them away from the GA, rejects the result and returns an array of survivors.  HA terminates prematurely if the population has degenerated. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       dataLen = 6 #   itCount = 100 #    genLen = 80 #    epochCount = 100 srcData = [ i+1 for i in range(dataLen) ] def getIts(dest = 0): its = [ Dnk(genLen) for i in range(itCount) ] res = [] for epoch in range(epochCount): nIts = [] maxAchiev = 0 for it in its: try: res = it.calc(srcData) achiev = len(res) if achiev == 0: it = None continue maxAchiev = max(maxAchiev, achiev) it.level = achiev nIts.append(it) except: # print('Died',it[0],sys.exc_info()[1]) it = None its = nIts l = len(its) if l&lt;2: print("Low it's count:",l) break; #  ,     its.sort(key = lambda it: -it.level) if maxAchiev &gt;= dataLen: break; mixIts(its, itCount) for it in its[:]: if it.level&lt;dest: its.remove(it) return its</span></span></code> </pre><br>  The function of assessing the deviation of the result from the desired one (not quite a fitness function, because the greater the deviation, the worse the genotype, but we take this into account). <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">diffData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resData, srcData)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#     ,       if len(resData) != len(srcData): return None d = 0 for i in range(len(resData)): d = d + abs((len(resData)*30 - i) * (resData[i] - srcData[i])) return d</span></span></code> </pre><br>  Well, the final touch - actually the GA on the selected genotypes. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   bestCount = 30 #    globCount = 30000 #  ,        seekValue = 8000 its = [] while len(its)&lt;bestCount: its = its + getIts(len(destData)) print('Its len', len(its)) # ,     printIts(its[0:1], srcData) its[bestCount:len(its)]=[] for glob in range(globCount): minD = None for it in its[:]: resData = it.calc(srcData) d = diffData(resData, destData) #    ,    . if d is None: its.remove(it) continue #        it.level = 100000 - d minD = d if minD is None else min(d, minD) its.sort(key = lambda it: -it.level) if glob % 100 == 0 or glob == globCount - 1: #   ,    100-  print('glob', glob, ':', round(minD,3) if minD else 'None', len(its)) #, resData) if minD &lt; seekValue: print('Break') break mixIts2(its, bestCount) #     printIts(its[0:3], srcData)</span></span></code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">... </span></span>glob <span class="hljs-number"><span class="hljs-number">2900</span></span> : <span class="hljs-number"><span class="hljs-number">7067.129</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> glob <span class="hljs-number"><span class="hljs-number">3000</span></span> : <span class="hljs-number"><span class="hljs-number">4789.967</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> glob <span class="hljs-number"><span class="hljs-number">3100</span></span> : <span class="hljs-number"><span class="hljs-number">6791.239</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> glob <span class="hljs-number"><span class="hljs-number">3200</span></span> : <span class="hljs-number"><span class="hljs-number">6809.478</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> Break <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> (const:<span class="hljs-number"><span class="hljs-number">24.7735</span></span>, addMem:<span class="hljs-number"><span class="hljs-number">1.7929</span></span>, dup:<span class="hljs-number"><span class="hljs-number">39.1318</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-15.2363</span></span>, mulVal:<span class="hljs-number"><span class="hljs-number">24.952</span></span>, mulVal:<span class="hljs-number"><span class="hljs-number">4.7857</span></span>, pop:<span class="hljs-number"><span class="hljs-number">14.4176</span></span>, pop:<span class="hljs-number"><span class="hljs-number">19.8343</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-19.4728</span></span>, pop:<span class="hljs-number"><span class="hljs-number">2.6658</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-14.8237</span></span>, pop:<span class="hljs-number"><span class="hljs-number">6.7005</span></span>, pop:<span class="hljs-number"><span class="hljs-number">1.3567</span></span>, pop:<span class="hljs-number"><span class="hljs-number">-2.7399</span></span>):<span class="hljs-number"><span class="hljs-number">97009.88</span></span> =&gt; [<span class="hljs-number"><span class="hljs-number">9.571</span></span>, <span class="hljs-number"><span class="hljs-number">24.952</span></span>, <span class="hljs-number"><span class="hljs-number">30.989</span></span>, <span class="hljs-number"><span class="hljs-number">35.638</span></span>, <span class="hljs-number"><span class="hljs-number">50.462</span></span>, <span class="hljs-number"><span class="hljs-number">65.698</span></span>] <span class="hljs-number"><span class="hljs-number">1</span></span> (const:<span class="hljs-number"><span class="hljs-number">24.7735</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-4.8988</span></span>, dup:<span class="hljs-number"><span class="hljs-number">39.1318</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-4.3082</span></span>, mulVal:<span class="hljs-number"><span class="hljs-number">24.952</span></span>, mulVal:<span class="hljs-number"><span class="hljs-number">6.1096</span></span>, pop:<span class="hljs-number"><span class="hljs-number">14.4176</span></span>, pop:<span class="hljs-number"><span class="hljs-number">19.8343</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-19.4728</span></span>, pop:<span class="hljs-number"><span class="hljs-number">2.6658</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-14.8237</span></span>, pop:<span class="hljs-number"><span class="hljs-number">6.7005</span></span>, pop:<span class="hljs-number"><span class="hljs-number">1.3567</span></span>, pop:<span class="hljs-number"><span class="hljs-number">-2.7128</span></span>):<span class="hljs-number"><span class="hljs-number">96761.03</span></span> =&gt; [<span class="hljs-number"><span class="hljs-number">12.219</span></span>, <span class="hljs-number"><span class="hljs-number">24.952</span></span>, <span class="hljs-number"><span class="hljs-number">35.226</span></span>, <span class="hljs-number"><span class="hljs-number">39.875</span></span>, <span class="hljs-number"><span class="hljs-number">54.698</span></span>, <span class="hljs-number"><span class="hljs-number">59.007</span></span>] <span class="hljs-number"><span class="hljs-number">2</span></span> (const:<span class="hljs-number"><span class="hljs-number">24.7735</span></span>, addMem:<span class="hljs-number"><span class="hljs-number">1.7929</span></span>, dup:<span class="hljs-number"><span class="hljs-number">39.1318</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-15.2363</span></span>, mulVal:<span class="hljs-number"><span class="hljs-number">24.952</span></span>, delVal:<span class="hljs-number"><span class="hljs-number">3.4959</span></span>, pop:<span class="hljs-number"><span class="hljs-number">14.4176</span></span>, pop:<span class="hljs-number"><span class="hljs-number">19.8343</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-19.4728</span></span>, pop:<span class="hljs-number"><span class="hljs-number">2.6658</span></span>, dup:<span class="hljs-number"><span class="hljs-number">-14.8237</span></span>, pop:<span class="hljs-number"><span class="hljs-number">6.7005</span></span>, pop:<span class="hljs-number"><span class="hljs-number">1.3567</span></span>, pop:<span class="hljs-number"><span class="hljs-number">-2.7399</span></span>):<span class="hljs-number"><span class="hljs-number">96276.27</span></span> =&gt; [<span class="hljs-number"><span class="hljs-number">5.496</span></span>, <span class="hljs-number"><span class="hljs-number">24.952</span></span>, <span class="hljs-number"><span class="hljs-number">30.989</span></span>, <span class="hljs-number"><span class="hljs-number">35.638</span></span>, <span class="hljs-number"><span class="hljs-number">50.462</span></span>, <span class="hljs-number"><span class="hljs-number">65.698</span></span>] &gt;&gt;&gt;</code> </pre> </div></div><br>  Or, to put it simply, the best GA result with the goal of destData = [10, 20, 30, 40, 50, 60] was [9.571, 24.952, 30.989, 35.638, 50.462, 65.698].  This result is achieved by a genotype with an algorithm (const: 24.7735, addMem: 1.7929, dup: 39.1318, dup: -15.2363, mulVal: 24.952, mulVal: 4.7857, pop: 14.4176, pop: 19.8343, dup: -19.4728, pop: 2.6658, dup : -14.8237, pop: 6.7005, pop: 1.3567, pop: -2.7399). <br><br>  On the one hand, the algorithm is redundant - it makes actions unnecessary to get the final result.  On the other - the algorithm is limited, since it uses only two values ‚Äã‚Äãfrom the input stream of six - it is clear that this happened because of the limited input data. <br><br><h3>  What's next? </h3><br>  You can further develop the idea: <br>  - Run the resulting algorithm on a large data stream, and the further the algorithm ‚Äúpasses‚Äù along this stream with the minimum deviation, the better it is, the genotype is better.  Complete analogy with cars. <br>  - Include a full Forth-machine and make the generation of the algorithm in the text Forth.  So you can create more complex algorithms for computing, with conditional transitions and cycles. <br>  - Analyze and simplify the resulting algorithm so that only the most necessary for getting the result remains in it. <br>  - Instead of elementary gene operations, use more complex ones.  For example, such an operation may be differentiation.  Or integration.  Or learning neural network.  Although Alan J. Perlis said that it was necessary not to inflate the dictionary, but to accumulate idioms, a good dictionary of idioms would not hurt. </div><p>Source: <a href="https://habr.com/ru/post/346134/">https://habr.com/ru/post/346134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346120/index.html">Ok google get me a car</a></li>
<li><a href="../346126/index.html">Tachometer or speedometer: The flow of thoughts about measuring the frequency in the Arduino</a></li>
<li><a href="../346128/index.html">February 31</a></li>
<li><a href="../346130/index.html">So why aren't you participating in the development of open source software?</a></li>
<li><a href="../346132/index.html">Stimulus 1.0: a modest JavaScript HTML framework that you already have</a></li>
<li><a href="../346136/index.html">L√ñVE Development</a></li>
<li><a href="../346138/index.html">Game Design Techniques: Mixing</a></li>
<li><a href="../346140/index.html">Results of the development of computer vision in one year</a></li>
<li><a href="../346142/index.html">Hot reboot of components in React</a></li>
<li><a href="../346144/index.html">Mobile devices from the inside. Memory markup, file structure description and markup memory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>