<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>mogenerator for Core Data you need to know about</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Relatively recently, I learned about mogenerator , a wonderful command line application for generating classes based on the Core Data object graph. An...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>mogenerator for Core Data you need to know about</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/275/7b6/9de/2757b69de60176e4ebdceee7b6c77287.jpg"><br><br>  Relatively recently, I learned about <a href="https://github.com/rentzsch/mogenerator">mogenerator</a> , a wonderful command line application for generating classes based on the <a href="http://developer.apple.com/library/mac/">Core Data</a> object graph.  And here's what, if you don‚Äôt know about him yet, then you should definitely get to know him, the use of this application greatly simplifies changing the Core Data object graph.  mogenerator generates two classes per entity, one for machine use, the other for providing the possibility of adding additional functionality.  Having correctly configured the project in Xcode, it is possible to generate this generation automatically before building. <br>  In this article I will describe how you can use mogenerator with XCode 4 and some useful trivia. <br><a name="habracut"></a><br>  As already described above, mogenerator generates two classes per entity, a total of four files.  Let the entity be called Entity, the following files will be generated for such an entity: <br><ul><li>  _Entity.h, _Entity.m - contain the _Entity class, these two files will be regenerated every time the Entity entity changes, after adding them to the project, you can forget about them, </li><li>  Entity.h, Entity.m - contains the class Entity, inherited from _Entity, these two files will be generated only once, they can be modified, they will not be overwritten. </li></ul><br><img src="https://habrastorage.org/storage2/6ac/8f1/5b7/6ac8f15b7928866e37d5c41098bc752c.jpg"><br>  The Entity class will be used in the code to represent the Entity entity and, best of all, the _Entity class will be synchronized with the data model!  Once you set up mogenerator and add the generated files to the project, you can forget about updating the files, they will take care of this automatically. <br><br>  Until I knew about the existence of mogenerator I used categories, I had the following files for the Entity entity: <br><ul><li>  Entity.h, Entity.m - contain the class Entity, I regenerated these two files manually after changing the entity in the model, </li><li>  EntityEx.h, EntityEx.m - contain the Ex category for the Entity class, these two files I used to add functionality, in other files I connected EntityEx.h instead of Entity.h. </li></ul><br><img src="https://habrastorage.org/storage2/bee/2e6/8ee/bee2e68ee2c408d0e5de9bd196a74a02.jpg"><br>  Of course, in many cases, this approach works perfectly, but I did not override the existing methods and almost did not use entity inheritance.  In addition, as a result of any changes in the object graph, I had to generate classes for entities manually. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Setting up automatic file generation with mogenerator in XCode 4 (using the example of Xcode 4.6.2) </h4><br>  0. Of course you need to download and install <a href="http://rentzsch.github.io/mogenerator/">mogenerator</a> . <br>  1. Create scripts that will run mogenerator with the necessary parameters, the scripts that I use can be obtained <a href="https://github.com/maniak-dobrii/mogenerator-demo/tree/master/MogeneratorDemo/MogeneratorDemo/CoreData/Scripts">here</a> .  Sample script: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     #   ,          HUMAN_DIR="${PROJECT_DIR}/MogeneratorDemo/CoreData/Entities" #   ,         . MACHINE_DIR="${PROJECT_DIR}/MogeneratorDemo/CoreData/EntitiesMachine" #    ,      (#import "{className}.h")   .h  HUMAN_DIR INCLUDE_H="${PROJECT_DIR}/MogeneratorDemo/CoreData/ModelIncludes.h" mogenerator --model \"${INPUT_FILE_PATH}\" --machine-dir "$MACHINE_DIR/" --human-dir "$HUMAN_DIR/" --includeh "$INCLUDE_H" --template-var arc=true</span></span></code> </pre> <br>  Pay attention to the last parameter: - template-var arc = true, thanks to it, the generated files will be compatible with ARC. <br>  To define a base class other than NSManagedObject, use the --base-class parameter. <br><br>  2. Now in Xcode, select the desired target, open the ‚ÄúBuild Rules‚Äù tab, add two rules, one for the ‚ÄúData model version files‚Äù: <br><br><img src="https://habrastorage.org/storage2/7ad/406/344/7ad406344a8365d0433008eed8aee366.jpg"><br><br>  , another for ‚ÄúData model files‚Äù: <br><br><img src="https://habrastorage.org/storage2/17e/757/28c/17e75728c9dd6bccc774391ced2c0d2d.jpg"><br><br>  Do not forget to specify the line in the Output Files, without it, the scripts will not run at all (correct me if I'm wrong). <br><br>  3. For each entity in the model, you must specify the correct class (usually coincides with the name of the entity): <br><br><img src="https://habrastorage.org/storage2/982/ccf/d3b/982ccfd3b60fe73f199352e15095f02c.png"><br><br>  Otherwise, mogenerator will skip entities and will not generate files for them. <br><br>  4. Everything, now you can try to build a project (Build, command B) <br>  To find out the result of the mogenerator, you can look at the Log Navigator and select the latest build: <br><br><img src="https://habrastorage.org/storage2/a31/eec/d37/a31eecd377f4ac432fe0da32400f215a.jpg"><br><br>  On the image one of the problems that may occur: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"Print: Entry, "</span></span>_XCCurrentVersionName<span class="hljs-string"><span class="hljs-string">", Does Not Exist"</span></span></code> </pre> <br>  This happens if no version has yet been added to the versioned data model, for example, you have just created it.  I'm not sure if this is a big problem, but it is corrected by adding and removing (% Model% .xcdatamodeld "Show package contents", manually deleting .xcdatamodel or via the terminal, as convenient) of the version of the data model.  After this removal, you must remove and add the .xcdatamodeld file to the project. <br><br>  If everything is done correctly in the Log Navigator you can see something like the following: <br><br><img src="https://habrastorage.org/storage2/420/558/708/420558708962d8bfb515b8987d2ed8d5.jpg"><br><br>  5. The generated files themselves will not be added to the project, you need to do it yourself: <br><br><img src="https://habrastorage.org/storage2/16e/216/0d9/16e2160d9f6693a0bcaf28f322fe011c.png"><br><br>  It is enough to connect the ModelIncludes.h file and in the right place all generated .h will be available.  Once you add a newly-generated file to a project, you can forget about it, before each build the necessary files will be regenerated. <br><br>  I have compiled a demonstration <a href="https://github.com/maniak-dobrii/mogenerator-demo">project</a> in which mogenerator is configured in the manner described. <br><br><h4>  Some useful little things </h4><br><h5>  Transformable attributes </h5><br>  To store non-standard data types, Core Data provides two types of attributes: Binary Data and Transformable.  Of greater interest is the second type, since  it avoids the need to manually serialize objects in NSData.  In the data model from the <a href="https://github.com/maniak-dobrii/mogenerator-demo">project</a> , the coordinates attribute is highlighted in the CDPlace entity, it is intended to store the coordinates as an instance of <a href="https://github.com/maniak-dobrii/Coords2D">Coords2D</a> .  Coords2D is an easy class for working with coordinates that supports NSCoding.  Pay attention to its type - Transformable, thanks to this configuration it is possible, for example, the following: <br><br><pre> <code class="objectivec hljs"> CDPlace* cdPlace = ‚Ä¶ Coords2D* coords2D = ... cdPlace.coordinates = coords2D; <span class="hljs-comment"><span class="hljs-comment">//   </span></span></code> </pre><br>  The problem appears when using Transformable attributes with mogenerator - how to specify a class so that property is generated correctly? <br><br><pre> <code class="objectivec hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_CDPlace</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSManagedObject</span></span></span><span class="hljs-class"> </span></span>{} ... <span class="hljs-keyword"><span class="hljs-keyword">@property</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">nonatomic</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">strong</span></span>) Coords2D* coordinates; <span class="hljs-comment"><span class="hljs-comment">//  mogenerator     Coords2D?</span></span></code> </pre><br>  The solution is the following: you need to add the attributeValueClassName =&gt;% class_name% pair to the UserInfo attribute: <br>  1. In Xcode, select the coordinates attribute, <br><br><img src="https://habrastorage.org/storage2/753/a26/7cf/753a267cfe253978c418a1add8105345.png"><br><br>  2. On the right, select the Data Model Inspector tab, <br>  3. In the User Info group, click + below the list and add: <br><br><img src="https://habrastorage.org/storage2/2e7/3a4/ee6/2e73a4ee62cb75d411bb5905fd0d6fdf.png"><br><br>  With the next generation, property coordinates will be of type Coords2D. <br><br><h5>  Rename Entity </h5><br>  If you rename an entity, mogenerator simply generates a new pair of classes, deleting unnecessary and renaming the necessary files must be done manually. <br>  Using the --orphaned and --model parameters together allows you to get a list of source files for which no matching entities were found in the model.  For example, you can redirect mogenerator output to xargs + git to delete files for deleted and renamed entities in one command: <br><br><pre> <code class="bash hljs">$ mogenerator --model ../Model.xcdatamodel --orphaned | xargs git rm</code> </pre><br><h5>  What else? </h5><br>  mogenerator supports custom templates, i.e.  There is an opportunity to change the way you fill files as you like, unify your boilerplate code, create your template and use it with mogenerator. <br>  The standard template provides the following set of buns: <br><ul><li>  Validation - It is convenient to override attribute validation methods. </li><li>  % attribute% Value - for numeric and bool types there are convenient setters that allow you to avoid messing with NSNumber, for example: <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSInteger</span></span> sum = entity.int32AtributeValue + <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">// vs [entity.int32Atribute integerValue] + 5 entity.int32AtributeValue = 500; // vs entity.int32Atribute = @500 or [NSNumber numberWithInteger: 500]</span></span></code> </pre><br></li><li>  Convenient methods for working with <abbr title="Managed Object Context">MOC</abbr> : <br><br><pre> <code class="objectivec hljs">Entity* entity = [Entity insertInManagedObjectContext:context]; <span class="hljs-comment"><span class="hljs-comment">//   Entity  MOC context NSString* entityName = [Entity entityName]; //    NSEntityDescription* entityDescription = [Entity entityInManagedObjectContext:context]; //  EntityDescription  MOC context</span></span></code> </pre><br></li><li>  Method for fetching all instances of an entity in the repository: <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span>* allEntities = [Entity fetchAllEntities:context];</code> </pre></li></ul><br><br>  This is not a complete set; a standard template for generating classes is developed along with mogenerator. <br><br>  Total we have a great tool to ignore which in my opinion today is no longer possible. <br><br><div class="spoiler">  <b class="spoiler_title">Used sources</b> <div class="spoiler_text">  <a href="http://www.esenciadev.com/2011/05/mogen-and-xcode4-integration/">www.esenciadev.com/2011/05/mogen-and-xcode4-integration</a> <br>  <a href="https://github.com/rentzsch/mogenerator">github.com/rentzsch/mogenerator</a> <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/185894/">https://habr.com/ru/post/185894/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../185878/index.html">Own Web project on D under Ubuntu OS</a></li>
<li><a href="../185882/index.html">More about the evolution of racing cars</a></li>
<li><a href="../185886/index.html">NAT traversal with IPv6 & CloudFlare</a></li>
<li><a href="../185888/index.html">Reliable (non-extreme) overclocking of the processor and memory for ASUS motherboards with an i7 processor</a></li>
<li><a href="../185890/index.html">Multi-file storage of Java objects in xml format</a></li>
<li><a href="../185896/index.html">Automatic fluid interface and ArrayIterator in PHP models</a></li>
<li><a href="../185898/index.html">Sip via Wi-Fi + UniFi. Experience of use and modernization</a></li>
<li><a href="../185900/index.html">Obesity on the web. A little bit personal about browser development trends.</a></li>
<li><a href="../185902/index.html">Microsoft released another set of updates, July 2013</a></li>
<li><a href="../185904/index.html">Vacation in Cyprus and great things</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>