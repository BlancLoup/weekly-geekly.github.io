<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to properly configure a firewall or Check Point Security Best Practices</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am sure that most system administrators or network engineers had a question: " Did I set up the firewall correctly and what else can I do to better ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to properly configure a firewall or Check Point Security Best Practices</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/260/ee5/819/260ee5819a4441de92ac6b666c5a0e0c.PNG"><br><br>  I am sure that most system administrators or network engineers had a question: " <b>Did I set up the firewall correctly and what else can I do to better protect?</b> ".  Naturally, in this matter it is worth relying on various guides (PCI DSS, ISO, NIST, etc.) and common sense.  Help from more experienced colleagues is also welcome. <br><br>  As part of this article, we will try to describe the main recommendations or best practices for setting up firewalls.  This is a kind of ‚Äúcheck-list‚Äù, following which you can significantly improve the quality of network protection.  The manual was compiled specifically for Check Point hardware, but it can also be used as a basis for self-auditing a network built on other vendors' equipment (Cisco, Fortinet, Palo Alto, etc.).  If you are interested in it, then welcome under the cat ... <br><a name="habracut"></a><br>  <b>Compliance Blade</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Generally speaking, in the case of Check Point, the audit of the ‚Äúcorrectness‚Äù of the settings can be performed automatically.  This is done using the Compliance Software Blade, which is activated on the management server: <br><br><img src="https://habrastorage.org/files/ea9/a41/13a/ea9a4113a290495582c63b7ec8b08ed5.PNG"><br><br>  This blade performs the following functions: <br><br><ol><li>  Software Blade Monitoring 24/7 <br><br><ul><li>  Permanent monitoring of the management system, software blades and security gateways is optimally tuned. </li><li>  Shows incorrect configuration settings and security vulnerabilities. </li><li>  Provides recommendations to improve security. </li></ul><br></li><li>  Real Time Notifications <br><br><ul><li>  Shows how a configuration change will affect security. </li><li>  Notifies about changes to policies that adversely affect security. </li><li>  Teaches users what the effects of the desired changes will be. </li></ul><br></li><li>  Ready reports <br><br><ul><li>  Translates thousands of regulatory requirements into practical recommendations. </li><li>  Continuous assessment of compliance with regulatory requirements (PCI DSS, ISO, NIST, DSD, and so on). </li></ul><br></li></ol> All reports are displayed in graphical form: <br><br>  Evaluation settings: <br><br><img src="https://habrastorage.org/files/e33/e5b/3bf/e33e5b3bfdbe4141b0e65779563fc34d.PNG"><br><br>  Regulatory compliance assessment: <br><br><img src="https://habrastorage.org/files/a4e/011/380/a4e011380ab04ce88e4cb5e7e4026cb5.PNG"><br><br>  Performance evaluation of individual gateways and blades: <br><br><img src="https://habrastorage.org/files/1f4/8fc/b88/1f48fcb88a8344c985b63cadfc4f3565.PNG"><br><br>  The Compliance Blade comes free with a 1-year subscription when you purchase a management server (be it a physical appliance Smart-1 or a virtual machine).  This time is quite enough for the integrated configuration of protection with the subsequent evaluation of configurations.  Thus, in the first year you get a free audit of network security (Check Point settings). <br><br>  If you have never activated this blade, it is quite easy to do in the properties of the management server (Management Server), as was shown in the picture above.  After that, install policies and wait a while (depending on the size of the network and the number of gateways).  The result of the evaluation of configurations can be found on the corresponding Compliance tab in the SmartDashboard console: <br><br><img src="https://habrastorage.org/files/7af/377/f21/7af377f217414961b6ed6242b6de13e6.PNG"><br><br>  It is worth noting that the continued use of the Compliance Blade requires the extension of the corresponding subscription, the price of which does not always correspond to the budget of small and medium-sized companies. <br><br>  <b>What to do after the end of the subscription?</b> <br>  Especially for such cases, we have created this manual, which will allow you to manually check the ‚Äúadequacy‚Äù and security of the current settings in accordance with the recommendations of Check Point.  At the same time, we will not consider the standards of various regulators (PCI DSS, ISO, etc.), but only touch upon the best practices (Best Practices) for configuring network protection tools. <br><br>  <b>Firewall Best Practices</b> <br>  <b>1.</b> There is a Management rule (the name may differ): <br><br><img src="https://habrastorage.org/files/922/944/164/922944164ea84b65a8959bb3cf14fb94.png"><br><br>  This rule is used for access from the management server (Management Server) and the administrator‚Äôs computer to the Security Gateway.  The rest of the access should be denied. <br><br>  <b>2.</b> Present the rule of Stealth (the name may differ): <br><br><img src="https://habrastorage.org/files/412/5ae/709/4125ae70991c41e9a0e600f4b806c134.png"><br><br>  This rule is used to block any attempt to access the gateway itself, which makes it ‚Äúinvisible‚Äù and eliminates the possibility of unauthorized access.  Make sure that this rule is located lower than Management. <br><br>  <b>3.</b> There is a rule of Clean up rule (the name may differ): <br><br><img src="https://habrastorage.org/files/6dd/ee4/8ea/6ddee48ea14342bfbd20dc049a504f1b.png"><br><br>  By default, Check Point blocks all connections that are not explicitly allowed.  This rule is used exclusively for logging all packets that would be blocked without it.  The rule should be the latest in the list. <br><br>  <b>4.</b> There is a Do Not Log rule (the name may differ) for which logging is disabled: <br><br><img src="https://habrastorage.org/files/710/859/e37/710859e370874b2eb5d45bd76d2ce2ee.png"><br><br>  This rule is used to filter ‚Äúspurious‚Äù broadcast traffic.  Such traffic includes: udp-high-ports (UDP ports&gt; 1024-65535), domain-udp, bootp, NBT (NetBios), rip (the list may differ, depending on your network).  Logging is disabled intentionally in order not to overload the firewall logs with useless information.  The rule should be as high as possible in the list (preferably first). <br><br>  <b>5.</b> In the access lists in the source column there is no Any value, i.e.  any traffic.  Always specify a specific source in the rules, be it a network or a host.  With the exception of Stealth, Clean up rule, Do Not Log. <br><br>  <b>6.</b> There are no rules allowing all traffic (any any accept). <br><br>  <b>7.</b> Incoming Internet traffic is prohibited for the segments of Accounting (Finance) and Human Resources (HR). <br><br>  <b>8.</b> Prohibited FTP traffic from the Internet to the DMZ. <br><br>  <b>9.</b> There are no unused rules.  In the SmartDashboard console, you can view the hit count for each access list: <br><br><img src="https://habrastorage.org/files/8c5/97d/abd/8c597dabdf7a4fd38548d86b68658214.png"><br><br>  If the counter shows a zero value or the last match (Last hit) was more than 6 months ago, it is recommended to delete this rule in order not to overload the general list. <br><br>  <b>10.</b> For all the rules in the Track field the option Log is set.  In addition to the rules Do Not Log.  So you can log all important events excluding broadcast traffic. <br><br>  <b>11.</b> For all the rules indicated ‚Äúadequate‚Äù name and there is a comment explaining the purpose of this rule. <br><br>  <b>12.</b> Logging is enabled on all gateways. <br><br><img src="https://habrastorage.org/files/542/fee/27e/542fee27e5c74322bbc6559ca446d190.png"><br><br>  The management server (Management Server) or another third-party solution can act as a Log-server (it is possible to use SIEM or Log Management systems). <br><br>  <b>13.</b> A backup Log Server is configured on all gateways.  This will save important messages in case of failure of the main Log server. <br><br>  <b>14.</b> On all gateways, the local log storage function is also enabled.  This will allow to save information about events in case of unavailability of the Log server. <br><br>  <b>15.</b> All gateways are configured to create a new Log file when a certain size of the old one is reached. <br><br><img src="https://habrastorage.org/files/293/3e7/6d9/2933e76d9efa44ccad3020bdcdfcfbcc.png"><br><br>  This will significantly speed up the processing of logs (display, search).  You can go back to older logs by switching the Log file. <br><br>  <b>16.</b> On all gateways, notifications are set to indicate a terminating disk space.  The trigger level is selected depending on the total volume of the hard disk.  Typically, the threshold is set in the region of 50-100 MB. <br><br>  <b>17.</b> All gateways are configured to delete old Log files when disk space ends.  The trigger level is selected depending on the total volume of the hard disk.  Typically, the threshold is set in the region of 50 MB. <br><br>  <b>18.</b> All gateways have scripts configured that are executed before deleting the old Log files. <br><br><img src="https://habrastorage.org/files/924/780/622/924780622fa74e66a829b7c6e7f7991e.png"><br><br>  Using this function, you can make sure that log backups have been created. <br><br>  <b>19.</b> Global settings enable logging for ‚ÄúVPN packet handling errors‚Äù, ‚ÄúVPN successful key exchange‚Äù, ‚ÄúVPN configuration &amp; key exchange errors‚Äù, ‚ÄúAdministrative notifications‚Äù, ‚ÄúPacket is incorrectly tagged‚Äù and ‚ÄúPacket tagging brute force attack‚Äù : <br><br><img src="https://habrastorage.org/files/5e5/5a3/226/5e55a3226ee448e59f2efdfec4cf05cd.png"><br><br>  <b>20.</b> On all gateways, Anti-Spoofing is enabled in prevent mode (for all interfaces): <br><br><img src="https://habrastorage.org/files/966/899/f09/966899f09fbf4c74af5b0d84b147205f.png"><br><br>  <b>21.</b> In global properties (global properties), check the default time interval values ‚Äã‚Äãfor stateful inspection: <br><br><img src="https://habrastorage.org/files/4b0/c57/003/4b0c57003dfd4fb8a00bcd5a8195f5c6.png"><br><br>  If necessary, change to meet your network requirements. <br><br>  <b>22.</b> For the ‚ÄúDrop out of state TCP packets‚Äù, ‚ÄúDrop out of state ICMP packets‚Äù and ‚ÄúDrop out of state SCTP packets‚Äù fields, Log on drop is enabled (see picture above). <br><br>  <b>23.</b> In the properties of each gateway, the Hit Count is enabled: <br><br><img src="https://habrastorage.org/files/f83/eb8/afc/f83eb8afc5534d57b033fb00c55d4571.png"><br><br>  This will allow you to see the number of matches for each rule (access list) and remove unused ones. <br><br>  <b>24.</b> In the gateway optimization settings, specify the maximum number of competitive sessions. <br><br><img src="https://habrastorage.org/files/485/950/7c1/4859507c15f84fd380b0b4a5a2c340c2.png"><br><br>  This parameter depends on the gateway model and helps prevent overloading. <br><br>  <b>25.</b> In global settings (global properties), user account (User Accounts) and Administart (Accounts) account passwords expire no later than 180 days. <br><br><img src="https://habrastorage.org/files/46a/251/a0a/46a251a0ad3d4f52be5c6d575b3ba381.png"><br><br>  The expiring password notification should also be configured. <br><br>  <b>26.</b> When integrating with Active Directory, a password change is configured: <br><br><img src="https://habrastorage.org/files/a18/ff0/dab/a18ff0dabda74954b0afa4ff713d4c09.png"><br><br>  <b>27.</b> In the global settings (global properties) the blocking of Administrators is activated.  The account is blocked for 30 minutes in case of 3 unsuccessful login attempts. <br><br><img src="https://habrastorage.org/files/bc9/e26/767/bc9e26767d9c4104b26430fea193ae7a.png"><br><br>  Also, a notification about blocking and resetting the control session, inactive for 15 minutes, is configured. <br><br>  <b>28.</b> In the properties of gateways the option ‚ÄúRematch connections‚Äù is set. <br><br><img src="https://habrastorage.org/files/7d8/faa/8b0/7d8faa8b04ca4fd59eebe8730f9487b7.png"><br><br>  This will allow you to block forbidden connections immediately after installing a new policy and not to wait for the session to end. <br><br>  <b>29.</b> Configured time synchronization (NTP) <br><br><img src="https://habrastorage.org/files/6a7/66d/d6a/6a766dd6afd04cf4a53d81d431c452c1.png"><br><br>  This will allow you to see the current date and time for all events (logs). <br><br>  These are the Check Point recommendations for configuring the Firewall blade.  But I think many have noticed that most of the tips are applicable to other vendors.  There are similar recommendations for all blades (IPS, DLP, Application Control, URL Filtering, etc.), which we may consider in the following articles. <br>  More information on Check Point can be found in our <a href="http://tssolution.ru/blog/">corporate blog</a> . </div><p>Source: <a href="https://habr.com/ru/post/327316/">https://habr.com/ru/post/327316/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327306/index.html">Six Lessons I Learned from the Star Wars Saga</a></li>
<li><a href="../327308/index.html">Vhd native boot inside and out</a></li>
<li><a href="../327310/index.html">Overview of time tracking systems</a></li>
<li><a href="../327312/index.html">SAP HANA - a task with many solutions</a></li>
<li><a href="../327314/index.html">What if you add some magic to your workflow?</a></li>
<li><a href="../327318/index.html">The book ‚ÄúIDEA BOOK. Graphic design"</a></li>
<li><a href="../327320/index.html">The Better Parts: Douglas Crockford talk on JavaScript and future programming languages ‚Äã‚Äãfrom .concat () 2015 conference</a></li>
<li><a href="../327322/index.html">7 copywriting techniques to increase conversion</a></li>
<li><a href="../327326/index.html">How to choose an information security service provider</a></li>
<li><a href="../327332/index.html">Demonic voice controlling your smartphone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>