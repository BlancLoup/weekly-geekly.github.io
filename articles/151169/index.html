<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data Context Interaction (DCI) - the evolution of the object-oriented paradigm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Too often, the abbreviation ‚ÄúDCI‚Äù began to appear in Western blogs and Twitter. I was surprised by the fact that there is almost no information on thi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data Context Interaction (DCI) - the evolution of the object-oriented paradigm</h1><div class="post__text post__text-html js-mediator-article">  Too often, the abbreviation ‚ÄúDCI‚Äù began to appear in Western blogs and Twitter.  I was surprised by the fact that there is almost no information on this topic, only in <a href="http://ruby.rpod.ru/275445.html">Ruby NoName Podcast S04E09</a> was mentioned about it.  Curiosity took it up, and I decided to find out more about this mysterious word.  In the process of searching, I came across a good article written in English by my countryman, Victor Savkin.  This article, without abundant theory, shows with practical examples what DCI is.  Further, the story will go on behalf of Victor. <a name="habracut"></a><br><br><h4>  Advantages of OO </h4><br>  Let's start with an overview of the problems where traditional object-oriented programming has proven itself from the best side. <br><br>  Object-oriented programming has shown itself well in managing the state of the object.  Classes, fields, and properties are powerful tools that allow you to identify and operate on a state.  Since we have these state display tools built into programming languages, we can conclude about it, both at compile time and runtime.  At compile time, we can look at the definition of a class object, and in runtime we can interrogate an object about its fields. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another problem that is solved quite well by all object-oriented languages ‚Äã‚Äãis the mapping of operations related to the state of the object.  Such operations are not involved in any kind of joint work.  They are local to the owning object.  We express local operations by defining class methods.  When we define a method for a class and create an instance of it, we know that it will have this method.  This is pretty obvious. <br><br>  A good example of an object that has only local operations is the Ruby class <i>String</i> .  Each <i>String</i> has an array of bytes or characters.  All his operations work with this array.  This object is independent - it does not need to interact with other objects.  I doubt that anyone may not understand how to use a <i>String</i> .  To solve such problems, OO languages ‚Äã‚Äãwere built. <br><br><h4>  OO drawbacks </h4><br>  OO loses in the interaction display of objects.  In order to show what I mean, let's take a look at two system operations (two usage scenarios) of objects from the same group that interact with each other. <br><br><h5>  The first use case </h5><br><img src="https://habrastorage.org/storage2/6d8/1d3/f73/6d81d3f73cde451190bce86b70e7cef7.png"><br>  The picture shows the system operation of four objects that communicate with each other. <br><br><h5>  Second use case </h5><br><img src="https://habrastorage.org/storage2/dbd/b79/bcb/dbdb79bcbd7ca70945f827091ab9937d.png"><br>  And here another usage scenario is presented, another system operation using the same group of objects.  But as you can see, the model of interaction between objects and messages is different. <br><br><h5>  The code does not display system operations. </h5><br>  We have seen two system operations expressed in <i>Use Case 1</i> and <i>Use Case 2</i> .  How do we display them in code?  In the ideal case, I would like to be able to open one file and understand the object interaction model in the use case I am working on.  If I'm working on <i>Use Case 1</i> , I don't want to know anything about <i>Use Case 2</i> .  This is what I consider to be a successful mapping of usage scenarios in code. <br><br>  Unfortunately, traditional object-oriented programming does not give us any opportunity to do this.  It gives us some tools to display the state of objects and assign them local behavior.  But we don‚Äôt have any good ways to describe the interaction of objects with each other in runtime to execute the use case.  Therefore, system operations are not displayed in the code. <br><br><h5>  Source Code! = Runtime </h5><br><br>  In the end, we still write code and program system operations in some way.  How do we do it?  We divide them into many small methods and assign them to a bunch of different objects. <br><br><img src="https://habrastorage.org/storage2/b0c/dc6/b9b/b0cdc6b9b552ee4d36a830e73842776b.png"><br>  Here we see that all the methods needed for all usage scenarios are trapped in these objects.  The methods for executing the first scenario are highlighted in green, for the second - red.  In addition, these objects have some local methods.  They are used by blue and red methods. <br><br>  The problem that is illustrated in the picture is that the source code does not display what is happening in runtime.  The source code tells us about four separate objects, with a bunch of methods in each of them.  Rantaim tells us that there are four objects that communicate with each other, and only a small subset of these methods is relevant to this use case.  This discrepancy complicates the understanding of programs.  The source code shows us one story, and runtime a completely different one. <br><br>  In addition, there is no way to define system operations (usage scenarios) explicitly, so we have to track all the method calls in order to get an idea of ‚Äã‚Äãwhat is happening in the program.  We do not have a file that we could open to understand this usage scenario.  Even worse, since all classes contain methods for lots of usage scenarios, we have to spend a lot of time filtering out the methods we need. <br><br><h4>  DCI to the rescue! </h4><br>  DCI (Data, context, interaction) is a paradigm created by Trygve Reenskaug (by MVC template) to solve these problems. <br><br><h5>  First use case (DCI) </h5><br>  Let's take a look at the first usage scenario expressed in DCI style. <br><br><img src="https://habrastorage.org/storage2/57a/442/367/57a442367d93986a33d2af0e9c7c4d25.png"><br>  Here we see the separation of the unchanged part of the system, containing only data and local methods, from this use case.  All traditional object-oriented techniques can be used to model this fixed part.  In particular, I would recommend using problem-oriented design techniques (Domain-driven design), such as aggregates and repositories, but there are no context-dependent behavior and interaction, there are only local methods. <br><br><h5>  How do we model the interaction? </h5><br>  We have a new abstraction to describe the interaction - context.  A context is a class that contains all the roles for a given use case.  Each role is a co-worker in the interaction and is played up by some object.  As you can see, context-sensitive behavior is concentrated in roles.  The context only assigns roles to objects and then initiates interaction. <br><br><h5>  Second Use Case (DCI) </h5><br><img src="https://habrastorage.org/storage2/110/4e9/109/1104e91095586758b1e2c07807b1d4fc.png"><br>  I would like to point out that our Objects (Object AD) remain the same.  We did not have to add any methods for the second use case.  All presented methods are fundamental, self-sufficient and local.  All scenarios for the use of individual behaviors were highlighted in context and roles. <br><br>  It is also worth noting that we do not see the red and green methods at the same time.  Each context contains only the methods necessary for its execution. <br><br>  It may sound too abstract, so let's take a look at the sample code in Ruby. <br><br><h4>  Code example </h4><br>  Here is an example of <i>Hello World</i> only for DCI.  Anyone interested in DCI starts by transferring money, from one account to another. <br><br>  I understand that this example is too simplified, and since it is so simple, it can be successfully expressed through services (services), regular objects (regular entities) or functions.  So take a look at this example as an illustration of how you should structure your code. <br><br>  Since we are talking about transferring money from one account to another, we will need to store information about accounts in some way.  The <i>Account</i> class is responsible for this.  It stores information about the balance and the list of transactions. <br><br><pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Account</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">decrease_balance</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class">);</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">increase_balance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(amount)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">balance</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update_log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message, amount)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">self</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  As you can see, all methods here are local and context-independent.  The account does not know anything about the transfer of money.  He is only responsible for replenishing the balance and reading money from him.  The logic of money transfer is in context: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TransferringMoney</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account_id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account_id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account_id</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account_id</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TransferringMoney</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extend</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SourceAccount</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extend</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DestinationAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">in_context</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_out</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br>  I request two accounts from the database, then create an instance of the context and call the <i>transfer</i> method.  You probably noticed that I transfer two accounts to the constructor, and the transfer amount to the <i>transfer</i> method.  By this, I want to show which objects are actors in this interaction, and which are only data.  Accounts are actors, they have a behavior, and the transfer amount is already data. <br><br>  Next, I assign roles to account objects in my constructor.  I train these data objects to be a source account and a recipient account. <br><br>  At the end, I initiate the interaction by calling the <i>transef_out</i> method on the source account.  In this example, the context only initiates the interaction, but in some difficult cases it can also coordinate the actors. <br><br>  And now let's take a look at the implementation of roles: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TransferringMoney</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SourceAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextAccssor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_out</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raise</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Insufficient</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">funds</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">balance</span></span></span><span class="hljs-class"> &lt; amount </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">decrease_balance</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_in</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">update_log</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Transferred</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">out</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DestinationAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextAccssor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_in</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">increase_balance</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">update_log</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Transferred</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">in</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br>  First, I check that the source account has enough money, then I deduct the amount of the transfer from the balance.  After that, I call the recipient account through a context variable in order to inform him to get money. <br><br>  Pay attention to a few interesting things: <br><ul><li>  Separation of unchanged behavior and context-sensitive.  The account class only knows how to manipulate its data.  All checks, all business logic in context. </li><li>  Roles refer to other co-workers through a context variable.  Once again, this is done to separate the actors from the data.  If I conveyed everything as an argument, how would I know who was an actor and who wasn‚Äôt?  For this reason, the actors should be accessed through a context variable, and all data objects should be passed as arguments. </li></ul><br><br>  Context and both roles: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TransferringMoney</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account_id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account_id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account_id</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account_id</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TransferringMoney</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination</span></span></span><span class="hljs-class">).</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extend</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SourceAccount</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extend</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DestinationAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">in_context</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">do</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">source_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_out</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SourceAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextAccssor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_out</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">raise</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Insufficient</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">funds</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">balance</span></span></span><span class="hljs-class"> &lt; amount </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">decrease_balance</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destination_account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_in</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">update_log</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Transferred</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">out</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DestinationAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">include</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextAccssor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">transfer_in</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">increase_balance</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">update_log</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Transferred</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">in</span></span></span><span class="hljs-class">", </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">amount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><h4>  What we have </h4><br><h6>  Locality </h6><br>  DCI solves the problem of traditional object-oriented programming, when the algorithm is spread among many different files.  If you want to know how a usage scenario is implemented, you will need to open only one file. <br><br><h6>  Focusing </h6><br>  The context contains only methods that are part of the execution script that it represents.  So you do not have to scan dozens or even hundreds of methods that have nothing to do with the problem you are working on. <br><br><h6>  ‚ÄúWhat is the system‚Äù and ‚ÄúWhat is the system doing‚Äù </h6><br>  All data objects and their local methods express ‚ÄúWhat is the system‚Äù.  Usually, this part of the system is unchanged.  Context-sensitive, rapidly changing behavior is ‚ÄúWhat the system does‚Äù.  Separation of unchanged parts from rapidly changing ones is one of the necessary conditions for building stable software.  And DCI provides this separation: <br><ul><li>  The data in DCI shows us everything about the contents of the object and nothing about its neighbors (‚ÄúWhat is the system‚Äù) </li><li>  The context in DCI shows us everything about the network of interacting objects and nothing about their contents (‚ÄúWhat the system does‚Äù) </li></ul><br><br><h6>  Source Code == Runtime </h6><br>  Also, the source code coincides with runtime.  Runtime shows us that we have two accounts and the amount of transfer.  Here is what you see if you open the context. <br><br><h6>  Explicit roles </h6><br>  The main advantage of DCI is clearly defined roles.  Quite a lot of designers agree that the objects themselves have no responsibilities, this is a matter of roles.  For example, take me as an example of an object.  I have the following properties: I was born in Russia, my name is Victor, my weight is around 65kg.  Can these properties really express some high-level commitments?  They can not.  But when I return home and begin to play the role of a husband, I become responsible for all the marital affairs.  So objects play a role.  The fact that roles are not at the forefront of traditional object-oriented programming is wrong. <br><br><hr><br><h4>  Sources </h4><br>  Actually the article itself: <br><ul><li>  <a href="http://rubysource.com/dci-the-evolution-of-the-object-oriented-paradigm/">Data Context Interaction: The Evolution of the Object Oriented Paradigm</a> </li></ul><br>  If you are interested in this idea, I advise you to look at the following resources: <br><ul><li>  <a href="http://dci-in-ruby.info/">DCI in Ruby</a> </li><li>  <a href="http://fulloo.info/">DCI - Data Context Interaction (A New Role-Based Paradigm for specifying collaborating objects)</a> </li></ul><br>  If you prefer reading books, I can recommend these three books to you: <br><ul><li>  <a href="http://clean-ruby.com/">Clean Ruby by Jim Gay.</a>  This book addresses the need for a practical DCI presentation for rubists.  She is still in development, but already looks promising. </li><li>  <a href="http://www.leansoftwarearchitecture.com/">Lean Architecture: for Agile Software Development by James O. Coplien and Gertrud Bj√∏rnvig.</a>  This is not only the first book on the market for coherent architecture and agile development, but it also explains the difference between these two powerful approaches and shows how they can be combined.  This is also the first book containing a new software architecture from Trygve Reenskaug, called DCI: Data, Context, Interaction. </li><li>  <a href="http://www.amazon.com/Object-Design-Roles-Responsibilities-Collaborations/dp/0201379430">Object Design: Roles, Responsibilities, and Collaborations by Rebecca Wirfs-Brock and Alan McKean.</a>  Since the book was released in 2002, it does not contain information on DCI.  But it contains good material on designing objects, using roles, and modeling colleagues.  These topics are very close to the core ideas of DCI. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/151169/">https://habr.com/ru/post/151169/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151162/index.html">Asana in detail and how to use it</a></li>
<li><a href="../151163/index.html">Unobvious optimization in speed when solving a specific problem in Python</a></li>
<li><a href="../151165/index.html">Growing black swans</a></li>
<li><a href="../151166/index.html">Habrakamp about moving</a></li>
<li><a href="../151167/index.html">Emacs and Python (Article 2 of the series)</a></li>
<li><a href="../151171/index.html">Innovations in the work and 2 new video</a></li>
<li><a href="../151173/index.html">PostgreSQL 9.2 - official release</a></li>
<li><a href="../151174/index.html">Runet Today, September 10, 2012. Experts of the issue: Anna Artamonova, Vasily Esmanov</a></li>
<li><a href="../151185/index.html">Isolating code during testing using Microsoft Fakes (Shims)</a></li>
<li><a href="../151187/index.html">Details on random and pseudorandom number generators</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>