<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Foreach wrapper</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I was annoyed by the bulkiness of the code, hulking constructs and the presence of extra lines. 
 A simple foreach in accordance with the co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Foreach wrapper</h1><div class="post__text post__text-html js-mediator-article">  Recently, I was annoyed by the bulkiness of the code, hulking constructs and the presence of extra lines. <br>  A simple foreach in accordance with the codestyle turns into at least 4 lines of text <blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">foreach</font> ( <font color="#0000ff">var</font> element <font color="#0000ff">in</font> collection) <br> { <br> <font color="#008000">// Do something</font> <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Therefore, such a wrapper was formed. <a name="habracut"></a><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#2B91AF">IEnumerable</font> &lt;T&gt; Each&lt;T&gt;( <font color="#0000ff">this</font> <font color="#2B91AF">IEnumerable</font> &lt;T&gt; list, Action&lt;T&gt; func) <br> { <br> <font color="#0000ff">if</font> (func == <font color="#0000ff">null</font> ) <br> { <br> <font color="#0000ff">return</font> list; <br> } <br> <font color="#0000ff">if</font> (list == <font color="#0000ff">null</font> ) <br> { <br> <font color="#0000ff">return</font> <font color="#0000ff">null</font> ; <br> } <br> <font color="#0000ff">foreach</font> ( <font color="#0000ff">var</font> elem <font color="#0000ff">in</font> list) <br> { <br> func(elem); <br> } <br> <font color="#0000ff">return</font> list; <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  When checking the arguments, it would be more convenient to write <font color="#0000ff">throw new</font> ArgumentNullException, but for my tasks it is better to use the ‚Äúfailed, well and good‚Äù mechanism. <br><br>  Further, as I use it, I ran into a problem when I needed to know the index of the item being processed.  For this, I used the following extension: <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#2B91AF">IEnumerable</font> &lt;T&gt; Each&lt;T&gt;( <font color="#0000ff">this</font> <font color="#2B91AF">IEnumerable</font> &lt;T&gt; list, Action&lt;T, <font color="#0000ff">int</font> &gt; func) <br> { <br> <font color="#0000ff">if</font> (func == <font color="#0000ff">null</font> ) <br> { <br> <font color="#0000ff">return</font> list; <br> } <br> <font color="#0000ff">if</font> (list == <font color="#0000ff">null</font> ) <br> { <br> <font color="#0000ff">return</font> <font color="#0000ff">null</font> ; <br> } <br> <font color="#0000ff">int</font> i = 0; <br> <font color="#0000ff">foreach</font> ( <font color="#0000ff">var</font> elem <font color="#0000ff">in</font> list) <br> { <br> func(elem, i); <br> i++; <br> } <br> <font color="#0000ff">return</font> list; <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Now, replacing various odds has become a bit more convenient.  The code has become more beautiful. <br>  Example of use: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">//     .</font> <br> ddSelector.Items. <font color="#2B91AF">Cast</font> &lt;ListItem&gt;().Each((x, i) =&gt; x.Text = (i+1) + <font color="#A31515">": "</font> + x.Text); <br> <font color="#008000">//     </font> <br> radioButtonList1.Items. <font color="#2B91AF">Cast</font> &lt;ListItem&gt;().Each(x =&gt; x.Selected = <font color="#0000ff">true</font> ); <br> <font color="#008000">//  ,   -    Add    AddRange.</font> <br> listToAdd.Each(someObject.Add); <br> <font color="#008000">//   object.Add   ,        .</font></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  From a certain moment on, I ran into another problem. <br>  There is a long series of methods and Linq, then some kind of Each, then again Linq, then again Each, and then the whole collection is given to the devil knows where, and only the first 10 elements of this collection are used there. <br>  It turns out that everything was calculated, executed, assigned, and the result is not needed by anyone.  To overcome this nefariousness I had to fill the list with one more Each. <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#2B91AF">IEnumerable</font> &lt;T&gt; EachLazy&lt;T&gt;( <font color="#0000ff">this</font> <font color="#2B91AF">IEnumerable</font> &lt;T&gt; list, Action&lt;T&gt; func) <br> { <br> <font color="#0000ff">foreach</font> ( <font color="#0000ff">var</font> elem <font color="#0000ff">in</font> list) <br> { <br> func(elem); <br> <font color="#0000ff">yield</font> <font color="#0000ff">return</font> elem; <br> } <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Thanks to the <font color="#0000ff">yield return</font> construct, we get that the action will be executed only when we really need the values. <br>  Accordingly, it became possible to write constructions <br>  <font color="#0000ff">return</font> ArrayOfInstances.EachLazy (x =&gt; x.Parametr = defaultValue) .Select (x =&gt; x.SomeValue) <br>  .EachLazy (x =&gt; x. Parent = <font color="#0000ff">null</font> ); <br><br>  Here is such a man-made sugar. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/51620/">https://habr.com/ru/post/51620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../51611/index.html">Squeeze on mobile</a></li>
<li><a href="../51612/index.html">DIVA - 3D database interface</a></li>
<li><a href="../51613/index.html">IGoogle interface in Russian and English</a></li>
<li><a href="../51614/index.html">What is search engine optimization and its benefits.</a></li>
<li><a href="../51617/index.html">The underscore character in site names and cookies</a></li>
<li><a href="../51624/index.html">IPv6 here and now</a></li>
<li><a href="../51625/index.html">New device from Sony</a></li>
<li><a href="../51627/index.html">It flies!</a></li>
<li><a href="../51628/index.html">Ukrainian Workshop "Pearl Mova" - 2009</a></li>
<li><a href="../51629/index.html">Getting rid of www in the site address</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>