<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CubeDB: minimalistic storage of meters with multidimensional keys</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! My name is Dima Stanko, I work in the BI-team Badoo in the London office. It so happened in our company that we are trying to take as many m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CubeDB: minimalistic storage of meters with multidimensional keys</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/jh/rv/vv/jhrvvv19r-1uxnpsewi7ukhrtfm.jpeg"></p><br><p>  Hi, Habr!  My name is Dima Stanko, I work in the BI-team Badoo in the London office.  It so happened in our company that we are trying to take as many measurements of user activity as possible.  This is necessary for many specialists: developers test the efficiency of the code, colleagues from the product teams are convinced of the genius of their ideas, admins - that entropy will prevail not this night, and colleagues from the antispam department - that good just defeats evil in an eternal and epic battle. </p><br><p>  We have written about all this many times and we will write again, because we believe that it is not good to step on a rake and not tell others about them. </p><a name="habracut"></a><br><h3 id="mobilnaya-analitika">  Mobile analytics </h3><br><p>  A few years ago, Badoo had a need to analyze user actions in a mobile application.  Every time someone pushed a button, loaded a screen, opened an application, wrote a message, we received a notification about it and were happy.  A couple of hundred million times a day. </p><br><p>  Soon there was a need to rejoice in more specialized cases, such as scrolling the screen to the end by the user, viewing another user‚Äôs profile, sending a gift.  But this was not enough for our colleagues from the grocery team.  This is how we got Hotpanel, a mobile application tracking system, and today we receive about 320 types of notifications for a total of 12 billion per day.  We will definitely write about this, it‚Äôs a sin to hide such beauty. </p><br><p>  One of the main components of the Hotpanel interface are hourly and daily charts with different breakdowns.  To describe in a thousand words what can be described by a picture, it makes no sense, so - here: </p><br><p><img src="https://habrastorage.org/webt/q_/uy/ce/q_uycelx0n4pvbrco8clqysfurm.png"></p><br><p>  You can filter by any combination of fields: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/L3B377CvnIE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3 id="predystoriya">  Prehistory </h3><br><p>  At the dawn of this project, when I was the only developer, and there were few messages, I decided to display the problem very quickly, cheaply and angrily, but, alas, not quite efficiently: at the front it was <a href="https://dc-js.github.io/dc.js/">dc.js</a> , and it was <a href="https://dc-js.github.io/dc.js/">all</a> ‚Äúback‚Äù Redis, where each type of message and each unit of time had its own HASHMAP, the keys of which were the fields and their values, and the value the number of times the message with such a combination of fields came to us. </p><br><p>  Example: </p><br><ul><li> <code>HASHMAP: hourly:view_screen:2016-09-17</code> name <code>HASHMAP: hourly:view_screen:2016-09-17</code> </li><li>  The keys inside looked like this *: <code>screen_name=view_photo,previous_screen=welcome,platform=android,app_version=1.2.3,gender=male</code> </li><li>  The total value: 1 500 000 </li></ul><br><p>  All this meant that on September 17, 2016, a male user on his Android device opened our application version 1.2.3 and rushed to look at the picture. </p><br><p>  If on the same day another male user on the Android device opened our application version 1.2.3 and also rushed to look at the picture, we had <a href="https://redis.io/commands/hincrby">HINCRBY</a> , the value became 1500001, which gave much joy to our product manager responsible for the Android pictures in version 1.2.3. </p><br><p>  Next to Redis, there was a service in Python and Flask, which was connected to Redis, <a href="https://redis.io/commands/hgetall">HGETALL</a> 'all dictionaries with <code>hourly:view_screen:2016-07-17</code> for <code>hourly:view_screen:2016-10-17</code> , sculpted one wonderful JSON structure and merged This is all a client on dc.js.  There were, of course, many optimizations, but I will not talk about them, because all this - as they say, is the case of days gone by **. </p><br><p>  Everything was just amazing, while combinations were few.  The speed was amazing ( <a href="http://square.github.io/crossfilter/">Crossfilter</a> , which is the basis of <a href="https://dc-js.github.io/dc.js/">dc.js</a> , written by the author of the d3 package and has a response time of less than 30 ms).  In general, it was a success.  Short </p><br><p>  This success has ruined us.  With the increase in the number of message types, the emergence of new fields and values, the number of combinations grew by leaps and bounds.  Using the interface turned into torture.  We rested in such exotic ceilings, such as, for example, <a href="">limiting the maximum size of a received JSON object</a> .  But we ignored this ‚Äúsign from above‚Äù and came up with a tricky (as it seemed to us) solution with breaking JSON into pieces and then ‚Äúgluing‚Äù it on the client.  A separate torture was the questions of our colleagues from the web development department: ‚ÄúIn two minutes, your page ate one and a half gigabytes of RAM and killed Chrome, congratulations!  How did you do it?  And why are you still working with us ?! ‚Äù </p><br><p>  To this shame and disgrace were added more <a href="">white and fluffy guests from the Arctic</a> , who began to brawl with Redis at night.  Memory consumption has grown, and it turned out that even 192 GB is not so much.  Calls from the monitoring guys at three o'clock in the morning were completely inappropriate (even my one and a half year old son never did that!). </p><br><p>  In general, the same situation has ripened when "the lower classes do not want the old way and the tops <a href="http://cyclowiki.org/wiki/%25D0%2592%25D0%25B5%25D1%2580%25D1%2585%25D0%25B8_%25D0%25BD%25D0%25B5_%25D0%25BC%25D0%25BE%25D0%25B3%25D1%2583%25D1%2582,_%25D0%25BD%25D0%25B8%25D0%25B7%25D1%258B_%25D0%25BD%25D0%25B5_%25D1%2585%25D0%25BE%25D1%2582%25D1%258F%25D1%2582">can not</a> oldly."  It's time to act. </p><br><h3 id="trebovaniya-k-sisteme">  System requirements </h3><br><p>  It was necessary to find or invent a miracle-stray that would hang on the back-end and know the following: </p><br><ol><li>  Store meter data for 120 days (this is about 100 million different combinations; about 27 GB of data in uncompressed form). </li><li>  Filter by any combination of fields and by date range.  The format is <code>field1 in ('val11', 'val12' ... ) AND field2 in ('val21', 'val22', ...) .... AND dt between x and y</code> , and it is clear from this that the indices we would not help, unfortunately. </li><li><p>  Present the results in the form of facets.  If there are eight fields in the message, then eight dictionaries should be issued - for each field.  Each dictionary must contain counters for each possible field value.  If it is to be very pedantic, then in SQL it should look like this: </p><br><pre> <code class="java hljs">select <span class="hljs-string"><span class="hljs-string">'G1'</span></span> as name, G1, SUM(M) <span class="hljs-function"><span class="hljs-function">from T WHERE D2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQ2)</span></span></span><span class="hljs-function"> and D3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQ3)</span></span></span><span class="hljs-function"> ... -- skip all filters related to G1 and p between PFrom and PTo group by name, G1 UNION ALL select 'G2' as name, G2, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SUM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(M1)</span></span></span><span class="hljs-function"> from T WHERE D1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQ1)</span></span></span><span class="hljs-function"> and D3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQ3)</span></span></span><span class="hljs-function"> ... -- skip all filters related to G2 and p between PFrom and PTo group by name, G2 UNION ALL ... UNION ALL select 'GN' as name, GN, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SUM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(M1)</span></span></span><span class="hljs-function"> from T WHERE D1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQ1)</span></span></span><span class="hljs-function"> ... and </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">D</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(N</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQ(N</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">) ... -- skip all filters related to GN and p between PFrom and PTo group by name, GN UNION ALL select 'p' as name, p, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SUM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(M1)</span></span></span><span class="hljs-function"> from T WHERE D1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQ1)</span></span></span><span class="hljs-function"> ... and Dn </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DQn)</span></span></span><span class="hljs-function"> ... group by 'name', p</span></span></code> </pre> <br></li><li>  Do not strain if new fields and new field values ‚Äã‚Äãare added. </li><li>  Do not strain if new message types appear. </li><li>  To give out the result almost instantly, that is, on average over 100 ms, including the network, at worst - in 2 seconds (in this case we will screw a spinning wheel on our page). </li><li>  Be able to insert 3 million new combinations in a maximum of a minute. </li><li>  To be able to quickly delete data for the past days. </li><li>  All this should work on the existing infrastructure, that is, either on the same machine (192 GB of memory, 48 cows), or on the Hadoop cluster, or on the Exasol cluster, which we have there just at hand. </li><li>  All this should be simple in support and allow yourself to be monitored, not to call it up, and not to talk about your sores with riddles. </li></ol><br><p>  Facilitating circumstances: </p><br><ol><li>  We did not need real persistence to save data immediately after each change.  New units were added once an hour, so it was necessary to save everything to disk once immediately after loading.  However, preservation should not have been blocking. </li><li>  The number of values ‚Äã‚Äãof each field is no more than 1000. </li><li>  The number of fields is no more than 100 (they are all of type String). </li><li>  No ACL (yet). </li><li>  No transactions, etc. Naturally, the counters should be updated atomically. </li></ol><br><p>  Intermediate conclusions: </p><br><ol><li>  You can process 27 GB for 100 ms only in the case of clever compression or cunning indexing and the use of all CPUs. </li><li>  Key-value stores will not help us.  The various scripting capabilities that are available on Lua in Redis and Tarantool would help, but they are still single-threaded and are unlikely to process so much data in time. </li><li>  Relational databases also do not roll due to paragraphs 4 and 5 of the requirements. </li><li>  Presto, Impala and others like them - of course, well done, but for 100 ms they will not be able to do anything.  Yes, and 100m records for them - it's like shooting a gun on the sparrows.  About Hadoop and MapReduce do not even stutter. </li><li>  Sly and interesting things like Druid and InfluxDB would probably solve this problem, but they are too complicated.  There was simply no opportunity to put a separate cluster for this.  My more capable and less lazy colleagues have already <a href="https://habrahabr.ru/company/badoo/blog/324510/">written</a> about this. </li><li>  You probably noticed that it all looks like a time-series.  Yes, practically it is, but not in face, but in profile.  In fact, each graph that we have is not one time-series, but the sum of millions of combinations.  So we also dropped the time-series store. </li></ol><br><p>  Due to the inherent hazards and lack of time to test all the possibilities, I liked to put a tool to solve this problem in a naive tone at interviews.  But even good candidates I could not say anything encouraging;  so last hope disappeared, Elasticsearch, which seems to have been intended for a faceted search, too slowly for our atomic icebreaker. </p><br><p>  By that time, the constant humiliation from colleagues, the lack of normal sleep due to the night riot of Redis, the ever-diminishing hope of finding something ready and free, and, admittedly, purely geek interest in solving the exciting problem made itself felt: my eyes were filled with blood , the mind has clouded, and I decided to create a solution myself. </p><br><p>  I wrote at home, and the already mentioned one and a half year old son covered me.  We have agreed with him that while he is sleeping peacefully after seven in the evening, I sit in his nursery and write a code under the guise of a paternal vigil.  That couple of weeks is still remembered as the happiest since fatherhood. </p><br><p>  A couple of years ago, when <a href="https://habrahabr.ru/company/badoo/blog/271753/">we were choosing a new analytical database</a> , I was amazed at the speed of those solutions that operated only in memory.  Maybe the idea to create a data structure that gives the result in O (N) time is very unsuccessful at the interview, but in practice it is not so sad at all (provided that all these N elements live together in memory). </p><br><h3 id="u-mene-vnutre-neonkahttplurkmoretod0a3_d0bdd0b5d0b9_d0b2d0bdd183d182d180d0b5_d0bdd0b5d0bed0bdd0bad0b0">  <a href="http://lurkmore.to/%25D0%25A3_%25D0%25BD%25D0%25B5%25D0%25B9_%25D0%25B2%25D0%25BD%25D1%2583%25D1%2582%25D1%2580%25D0%25B5_%25D0%25BD%25D0%25B5%25D0%25BE%25D0%25BD%25D0%25BA%25D0%25B0">I have inside neon</a> </h3><br><p>  In fact, there were two problems: how to insert data and how to retrieve it. </p><br><h4 id="izvlechenie-schyotchikov">  Removing counters </h4><br><p>  An elegant structure was created for data storage.  All aggregates for a certain type of message were proposed to be stored in a separate object (let's call it a cube).  At the very top level, we have just a map of these cubes with the name of it as a map key. </p><br><p>  Each cube is partitioned by time (in our case, by day and hour).  Each partition stores aggregates in a row.  Adding a new field is decided by the trivial addition of a new element to the map of these fields. </p><br><p>  Since we know that the maximum number of all possible values ‚Äã‚Äãfor each field is small, we can encode it with a digit, and in our case 10 bits will suffice (but to simplify the task and the reserve, I made it 16-bit).  This not only saves memory, but also makes searching faster, since now you only need to compare 16 bits, and not the entire string.  In our case, there are two types of columns: by which values ‚Äã‚Äãare searched, they are 16-bit, and the counters themselves are 64-bit. </p><br><p>  Thus, the key already known to us is <code>screen_name=view_photo,prev_screen=welcome,platform=android,app_version=1.2.3,gender=male</code> with a value of 1500000 turns into the following data: 1: 1: 1: 1: 1 1500000. And all this now takes 5x2 + 8 = 18 bytes.  Savings - there. </p><br><p>  The search is solved by a simple full scan, with each line the value of the counter of the corresponding field value is increased by the value from the counter field. </p><br><p>  The speed is also not bad.  The current implementation in Java can calmly scan through 20 million values ‚Äã‚Äãper second in a single processor on a Mac.  Since we need a <a href="https://en.wikipedia.org/wiki/Faceted_search">faceted search</a> , we need to read the values ‚Äã‚Äãof all the fields, and not just those with the filter values, so in the case of five fields we still get 4 million counters per second. </p><br><h4 id="vstavka">  Insert </h4><br><p>  Unfortunately, such an elegant data structure cannot cope with insertion at all.  If for the insertion of each element we need to comb through the entire memory (which takes, say, 100 ms), the insertion of 3 million records (namely, so many combinations we accumulate every hour) will take approximately 83 hours, which will not go into any gate.  Somehow even it would be insulting for the CPU cycles wasted. </p><br><p>  On the other hand, we know that data is only inserted for the last few hours or days.  We also know that if we insert something, we have all the fields.  Therefore, nothing prevents us from creating a reverse index, where the key will be the numerical values ‚Äã‚Äãof the fields (1: 1: 1: 1: 1), and the value will be the line number where this combination is located.  Such a structure is created in a fraction of a second, and the key search time is generally a fraction of a millisecond. </p><br><p>  In our case, we managed to achieve a speed of about 150,000 records per second.  This is, of course, subject to an internal call, not taking into account the time of de-serialization of the REST request and the network.  Such a reverse index lives in the cache and is created for each partition.  If it has not been accessed for several days, it is deleted and the memory is freed. <br>  Most of our data is inserted on the same (or previous) day when they were sent, so there are really few partitions with existing reverse indexes. </p><br><p>  As I said, our search is trivial, and therefore it can be trivially parallelized.  Therefore, partitions are combined in parallel, in separate threads.  With an average of eight fields and 48 processors on the server, we are able to achieve a scan speed of 120 million lines per second.  That is, if the number of different combinations does not exceed 12 million, we still fit into the 100 ms period we set.  This, of course, in an ideal world, but we are almost there already. </p><br><h4 id="sohranenie-na-disk">  Saving to disk </h4><br><p>  Write data to disk makes sense immediately in such a compact form.  Dictionaries are written to the beginning of the file, and then data columns with numbers instead of rows.  And all this economy is also compressed.  Oddly enough, in the case of Java, the processor (and gzip compression) turned out to be the slowest component.  The transition to Snappy allowed to reduce the save time from 60 s to 8 s. </p><br><p>  ‚ÄúJust Fireman‚Äù also provides for saving in JSON format, so that you can manually reload data in case of loss of compatibility of future systems. </p><br><h4 id="obschenie-s-mirom">  Communication with the world </h4><br><p>  The whole interface is made through REST.  This is probably the most boring part of all software, so I guess I will not even write anything about it.  Insert via PUT, requests via GET, delete via DELETE, etc. </p><br><h4 id="java">  Java </h4><br><p>  As I mentioned, I wrote it all in Java.  Of all the so-called fast languages, I can only program in it.  But I have a very strong suspicion that C would work even faster.  Snacks like SIMD, I think, would really speed up the system.  The dream of life - in general, to rewrite all this to Rust.  But since at this stage, the performance suits us, and the son has grown and no longer agrees to go to bed at seven in the evening, we will have to wait a bit with this ***. </p><br><p>  In general, Java pleased me and upset at the same time.  In terms of full scan there is very good performance, I did not even expect it.  I was upset by a garbage collector who constantly panics when he has a lot of hanging and nothing is released.  Therefore it was necessary to write all these data structures for off-heap, using allocateDirect and unsafe'y.  And all this, of course, is very cool, but the impression is that the code is in C, not in Java.  I'm not sure that when the universe created the Java language, it assumed exactly this kind of event. </p><br><p>  The garbage collector upset me even more when it was necessary to create these same counters for facets.  When 48 processors simultaneously create a HashMap for a couple of thousand items, the assembler behaves as if it is his first time in his life.  As a result, full scan pairs of millions of lines takes less time than the transformation of results from numbers to lines and the subsequent consolidation of data from all partitions. </p><br><h3 id="nastoyaschee">  The present </h3><br><p>  At the moment, our only copy contains about 600 cubes, which consist of about 500 million records.  All this takes about 80 GB of resident memory, and backup in compressed form (Snappy) - about 5 GB on disk.  The save to disk operation takes about 30 seconds. <br>  The system is very stable and after fixing <a href="https://github.com/sztanko/cubedb/pull/13"><code>    ,  MIN_VALUE</code></a> did not fall even once. </p><br><h3 id="buduschee">  Future </h3><br><p>  Reasoning about the future is my favorite, since you can say anything, but you don‚Äôt need to show numbers. </p><br><p>  So, there are several options to improve the world: </p><br><ol><li>  First, as I mentioned, rewrite the solution in a language more suited to such things as fast and multi-threaded data processing, where the garbage collector will not embarrass everyone and himself with his presence. </li><li>  Secondly, it would be cool to teach CubeDB to communicate with their own kind and grow into a whole cluster. </li><li>  Thirdly, since everything is so fast in our memory, it makes sense to drag some tricky algorithms closer to the data.  For example, some semblance of Anomaly Detection, as it was done in the <a href="http://www.vldb.org/pvldb/vol8/p1816-teller.pdf">Facebook Gorilla</a> . </li></ol><br><p>  Since I have clearly more ideas than time, we have placed our solution in the <a href="https://github.com/sztanko/cubedb">public domain</a> .  And since you have read this far, you are probably interested.  Come, see, play, use.  I believe that the idea is very simple, but interesting, and there is still a lot that can be improved.  Dare! </p><br><p>  PS Data without a visualization is like a disco without music, so we simultaneously released a <a href="https://github.com/cubedb/react-cubedb">set of front-end components</a> for working with the CubeDB API, and also made a <a href="https://cubedb.github.io/homicide-report/">simple page</a> to demonstrate the possibilities.  I would like to warn, however, that the demo runs in a cloud on a machine with one core and it‚Äôs difficult to estimate the actual processing speed: in our internal system, on a real iron and forty-eight cores, the speed differs dramatically. </p><br><p>  <code>*</code> Actually, no - we stored everything in JSON, which is terribly inefficient. <br>  <code>**</code> Actually no, I just looked.  Forgot to demolish - just stopped using.  I've turned it off - the guys from the monitoring department immediately called me.  Well done! <br>  <code>***</code> Why don't you try? </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/342564/">https://habr.com/ru/post/342564/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342548/index.html">DEV Labs 2017. Online Scala development milestone. November 25</a></li>
<li><a href="../342550/index.html">Planning tasks and constraint programming</a></li>
<li><a href="../342556/index.html">Not a simple coordinate system, but a gold one.</a></li>
<li><a href="../342560/index.html">Telegram conference bot (start)</a></li>
<li><a href="../342562/index.html">Vim as an esoteric text editing language</a></li>
<li><a href="../342566/index.html">How to write your swagger and not regret it</a></li>
<li><a href="../342570/index.html">Rewrite the message database VKontakte from scratch and survive</a></li>
<li><a href="../342572/index.html">Classification of the humanities and techies by comments in VK</a></li>
<li><a href="../342574/index.html">We pick a cryptograph, let's call it - ‚Äúnekema‚Äù</a></li>
<li><a href="../342576/index.html">User survey Habra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>