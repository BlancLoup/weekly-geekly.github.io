<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VMware Virtual SAN (VSAN): why do you need it and how to prepare it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first post about CloudLITE, we mentioned VMware Virtual SAN (VSAN) virtual storage. Today we will dwell on this technology in more detail and t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VMware Virtual SAN (VSAN): why do you need it and how to prepare it</h1><div class="post__text post__text-html js-mediator-article">  In the first <a href="http://habrahabr.ru/company/dataline/blog/255037/">post</a> about <a href="https://cloudlite.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dreferral%26utm_campaign%3DVSAN_text">CloudLITE,</a> we mentioned VMware Virtual SAN (VSAN) virtual storage.  Today we will dwell on this technology in more detail and tell you what to look for when creating a VSAN for your project. <br><br><img src="https://habrastorage.org/files/f41/05c/cc8/f4105ccc82974ce7adcc42b8beb7961c.jpg" alt="image"><br><a name="habracut"></a><br><h4>  Why do you need VSAN </h4><br>  The traditional architecture includes three key components: <br>  ‚Ä¢ servers <br>  ‚Ä¢ data storage system (DSS), <br>  ‚Ä¢ a storage area network that connects storage systems to servers via block (FC, FCoE, iSCSI) or file protocols (NFS, SMB) using appropriate switches. <br><br><img src="https://habrastorage.org/files/8d9/d4e/a1f/8d9d4ea1fdea4728957e15f4f337b9d7.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To manage such an economy, you need three different interfaces, three different competencies and, in an amicable way, three different specialists. <br><br>  Deploying such an architecture takes a long time, and fast scaling is also a very trivial task. <br><br>  If your project involves predictable and systematic scaling, there is a week to add a new repository, and there are specialists in the staff who will be involved in designing, then the traditional architecture is your choice. <br><br>  When you have a project (for example, public cloud) grows irregularly, adding a new repository with minimal automation capabilities will take a lot of time.  This is where the VSAN converged architecture comes to the rescue, allowing you to combine computing and storage functions in a server. <br><br><img src="https://habrastorage.org/files/3b9/219/359/3b9219359f9c4e5fa4e04193fbd4e447.jpg" alt="image"><br><br><h4>  VSAN as a converged solution </h4><br>  The convergent solution allows you to create an infrastructure from standard blocks that combine several functions at once (for example, calculation, storage).  This infrastructure is managed through a single interface, and scaling through the addition of the next block. <br><br>  In the case of VSAN, each block is a server.  Not any, of course, but more on that later.  How does the server perform the storage functions?  VSAN collects virtual ‚Äúexternal‚Äù storage from local server disks that is accessible to all compute nodes of the virtualization cluster.  In this case, the software part of VSAN runs on the same servers as the compute nodes.  Thus, on the same server, both the compute node and the storage node are all located in one bottle. <br><br><h4>  How it works </h4><br>  Each server has from 1 to 5 disk groups.  In each group - at least one SSD-drive (a necessary condition for building VSAN) and from 1 to 7 HDD-drives. <br>  SSDs in these disk groups make up a common data caching pool.  VSAN first reads data in the cache;  if there is no data in the cache, VSAN is sent to the HDDs. <br><br>  For each virtual machine, you can configure your FTT (failures to tolerate).  By default, this is 2, that is, all virtual machine data is written to 2 different servers of the cluster at once.  If one of the servers fails, we will have a synchronous replica on the other, and all I / O operations will go to this second copy. <br><br><img src="https://habrastorage.org/files/be3/456/cfd/be3456cfdeff412a9ca1d2227043e58a.png" alt="image"><br><br><h4>  What to look for when designing VSAN </h4><br>  The relative ease of deployment does not negate the careful design of the VSAN architecture.  Here are a few points that we would like to elaborate on: <br><br>  1. <b>Compatible with hardware</b> .  Although VSAN gives you a certain amount of freedom in the choice of hardware, it makes sense to stay on the <a href="http://www.vmware.com/resources/compatibility/search.php">list of</a> hardware <a href="http://www.vmware.com/resources/compatibility/search.php">that is compatible</a> with VMware VSAN.  So you don‚Äôt have to choose compatible controllers, adapters, etc. by using scientific methods. In the case of <a href="https://cloudlite.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dreferral%26utm_campaign%3DVSAN_text">CloudLITE</a> , we chose Huawei FusionServer RH5885 V3 for the combination of technical and economic characteristics.  This model has on board more productive PCIe flash cards (in comparison with the already classic SSD disks), which, by the way, allow saving ‚Äúdisk slots‚Äù and creating more disk groups.  In the near future we will arrange for him unboxing.  Keep for updates :). <br><br>  2. <b>Network.</b>  In a VSAN configuration, VMs can work in one place, and be stored in another.  This places quite high demands on the network: you must have at least a 10 GB network. <br><br>  3. <b>Performance disk controllers</b> .  The disk controller must provide a volume buffer for a large queue of commands.  The load on it will be significant: the controller will give the data needed not only to this server, but also to the entire cluster.  For example, when restoring a dropped disk group to a new group, you need to record a large amount of data in a short time.  The write speed will depend on the performance of the controller. <br><br>  4. <b>Disk capacity</b> .  In this situation no longer means better.  Quite the contrary.  Although 4, 6 TB disks are now available, VSAN is best built from 1 TB disks.  Let's imagine an emergency situation when nothing gets into the cache (replacing a ‚Äúflying‚Äù disk group, backup or restoring a backup): 6 TB drives will recover 6 times longer than 1 TB drives (if you start from the ratio of read speed to volume Stored Data - IOPS / GB).  Here we are, of course, talking about the worst case, but these situations are not from the realm of fantasy.  And so that the desire to use volume disks in VSAN completely disappears, just imagine how much data will be restored on 7 hard drives of 6 TB each. <br><br>  5. <b>The ratio of the volume of SSD to hard disk capacity</b> .  It will directly affect the final performance of the disk group: the greater the capacity of the SSD (the more data will be in the cache), the better the performance.  <a href="https://cloudlite.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dreferral%26utm_campaign%3DVSAN_text">CloudLITE</a> uses PCIe flash cards for caching - they have lower latency compared to SSD.  By the way, in VSAN version 6.0, disk groups consisting only of SSD are supported. <br><br>  6. <b>The ratio of computing power to disk space</b> .  When designing VSAN, you need to carefully consider everything: calculate the ratio of processors, memory and the number of disk groups, as well as calculate the ratio in which to increase the computing power so that it is economically profitable. <br>  With the solution running, it will be impossible to add on-the-fly disk space for VSAN (storage node) without adding a new server, which means processors and memory.  The option when the server is used only as storage (i.e., the computing node of this server is idle) is possible, but economically unprofitable: in fact, it is a return to the traditional configuration and abandoning the advantages of a convergent solution. <br><br><h4>  9 months - normal flight </h4><br>  VSAN allowed us to get high performance comparable to mid-range storage systems. <br>  Over the entire period of operation, VSAN (since September 2014) has shown a very high level of accessibility, including as part of enterprise solutions. <br>  Since March, the system has been working in the virtualization cluster of the <a href="https://cloudlite.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dreferral%26utm_campaign%3DVSAN_text">CloudLITE.ru</a> online store. <br><br>  By the way, <a href="https://cloudlite.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dreferral%26utm_campaign%3DVSAN_text">go</a> for a free test drive :) </div><p>Source: <a href="https://habr.com/ru/post/258059/">https://habr.com/ru/post/258059/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258047/index.html">io.js integrates with NodeJS</a></li>
<li><a href="../258051/index.html">Designing and embedding .vsix extensions in Visual Studio on C # for dummies</a></li>
<li><a href="../258053/index.html">Sublime Text 3 - custom syntax highlighting</a></li>
<li><a href="../258055/index.html">The study of someone else's cheat for FarCry 4</a></li>
<li><a href="../258057/index.html">Event model building projects and solutions of Visual Studio for developers</a></li>
<li><a href="../258061/index.html">Some interesting and useful things for web developer # 43</a></li>
<li><a href="../258063/index.html">Windows 10 on Raspberry Pi 2, first impressions</a></li>
<li><a href="../258065/index.html">As I passed the first hack quest CTF Ratazana</a></li>
<li><a href="../258069/index.html">Rust 1.0 Preview</a></li>
<li><a href="../258071/index.html">Network infrastructure security. Advanced methods of hacking and protection. Video</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>