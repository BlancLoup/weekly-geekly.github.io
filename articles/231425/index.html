<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis sms-bot for Android. Part I</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Analysis sms-bot for Android. Part I. 
 Introduction  Analysis of smsBot (Android) in order to identify the principle of operation and interesting fun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis sms-bot for Android. Part I</h1><div class="post__text post__text-html js-mediator-article"><h4>  Analysis sms-bot for Android.  Part I. </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/a74/664/655/a7466465524889e2d5699039d7e88327.jpg" alt="image" align="left"><h4></h4><h5>  Introduction </h5>  Analysis of smsBot (Android) in order to identify the principle of operation and interesting functionality. <br>  The bot is implemented for the Android platform, the algorithm for opening the application is as follows: <br><ul><li>  Download the APK file; </li><li>  Extract the manifest file; </li><li>  We decompile the application into a readable source or bytecode; </li><li>  Analyzing the manifest and code. </li></ul><br>  <b>Tools:</b> <br><ul><li>  Apktool - Use to pull out the manifest and resources; </li><li>  Dex2jar - Decompile the apk file into bytecode; </li><li>  Jd-gui - We translate the byte code into a readable code. </li></ul><br><hr><a name="habracut"></a><h5>  Meet the manifesto </h5><br>  Having opened the manifesto, we immediately turn our attention to the system permissions that seemed more interesting to me: <br><pre><code class="java hljs">&lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.READ_PHONE_STATE"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.CALL_PHONE"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.INTERNET"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.RECEIVE_BOOT_COMPLETED"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.WRITE_SMS"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.READ_SMS"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.RECEIVE_SMS"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.SEND_SMS"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.READ_CONTACTS"</span></span> /&gt; &lt;uses-permission android:name=<span class="hljs-string"><span class="hljs-string">"android.permission.RECORD_AUDIO"</span></span> /&gt;</code> </pre> <br>  So, our bot reads the state of the phone, processes calls, writes to a USB flash drive, write / read / receive / send SMS, read contact database and record audio.  Interesting‚Ä¶ <br><br>  <b>Further, on the manifesto.</b>  <b>We see the following code:</b> <br><pre> <code class="java hljs">‚Ä¶ &lt;service android:name=<span class="hljs-string"><span class="hljs-string">"com.soft360.iService.AService"</span></span> android:enabled=<span class="hljs-string"><span class="hljs-string">"true"</span></span> android:exported=<span class="hljs-string"><span class="hljs-string">"false"</span></span> /&gt; &lt;service android:name=<span class="hljs-string"><span class="hljs-string">"com.soft360.iService.webService"</span></span> android:enabled=<span class="hljs-string"><span class="hljs-string">"true"</span></span> android:exported=<span class="hljs-string"><span class="hljs-string">"false"</span></span> /&gt; &lt;receiver android:name=<span class="hljs-string"><span class="hljs-string">"com.soft360.iService.Alarm"</span></span> android:enabled=<span class="hljs-string"><span class="hljs-string">"true"</span></span> android:exported=<span class="hljs-string"><span class="hljs-string">"false"</span></span> /&gt; &lt;receiver android:name=<span class="hljs-string"><span class="hljs-string">"com.soft360.iService.AutoStart"</span></span> android:enabled=<span class="hljs-string"><span class="hljs-string">"true"</span></span> android:exported=<span class="hljs-string"><span class="hljs-string">"false"</span></span>&gt; &lt;intent-filter&gt; &lt;action android:name=<span class="hljs-string"><span class="hljs-string">"android.intent.action.BOOT_COMPLETED"</span></span> /&gt; &lt;/intent-filter&gt; &lt;/receiver&gt; &lt;activity android:theme=<span class="hljs-string"><span class="hljs-string">"@*android:style/Theme.Translucent"</span></span> android:name=<span class="hljs-string"><span class="hljs-string">"com.BioTechnology.iClientsService.IncomingCallActivity"</span></span> /&gt; &lt;receiver android:name=<span class="hljs-string"><span class="hljs-string">"com.soft360.Receiver.MyPhoneReceiver"</span></span>&gt; &lt;intent-filter&gt; &lt;action android:name=<span class="hljs-string"><span class="hljs-string">"android.intent.action.PHONE_STATE"</span></span> /&gt; &lt;/intent-filter&gt; &lt;/receiver&gt; &lt;receiver android:name=<span class="hljs-string"><span class="hljs-string">"com.soft360.web.MyAdmin"</span></span> android:permission=<span class="hljs-string"><span class="hljs-string">"android.permission.BIND_DEVICE_ADMIN"</span></span>&gt; &lt;intent-filter&gt; &lt;action android:name=<span class="hljs-string"><span class="hljs-string">"android.app.action.DEVICE_ADMIN_ENABLED"</span></span> /&gt; &lt;/intent-filter&gt; &lt;meta-data android:name=<span class="hljs-string"><span class="hljs-string">"android.app.device_admin"</span></span> android:resource=<span class="hljs-string"><span class="hljs-string">"@layout/policies"</span></span> /&gt; &lt;/receiver&gt; ‚Ä¶</code> </pre> <br><br>  <b>See that declared:</b> <br><ul><li>  AService and webService services, </li><li>  Receivers Alarm, AutoStart, MyPhoneReceiver (monitors the status of the phone, most likely for calls), MyAdmin (the bot wants to admin the device). </li></ul><br>  The analysis of the manifesto is over.  I looked through the resource files, found nothing interesting.  Now let's proceed to the analysis of the resulting java-code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Analyzing the code </h5><br>  The bot consists of at least 19 main working classes.  As a result of the analysis, I identified the most basic and interesting classes that are responsible for the bot sabotage activity: <br><ul><li>  - AutoStart.java; </li><li>  - aService.java; </li><li>  - smsParser.java; </li><li>  - smsReciever.java; </li><li>  - webServiceRobot.java; </li></ul><br><br><h5>  MainActivity.java </h5><br>  Before you start analyzing the above classes, let's take a look at the MainActivity class.  Let's see what's interesting there. <br><pre> <code class="java hljs">Intent localIntent1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span>); localIntent1.setClass(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, SmsReciever.class); sendBroadcast(localIntent1); Intent localIntent2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, AService.class); startService(localIntent2); Intent localIntent3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, webService.class); startService(localIntent3);</code> </pre> <br><br>  Immediately when booting, the bot tries: <br><ul><li>  All incoming SMS-ki send in SmsReciver; </li><li>  Starts AService and webService services. </li></ul><br><br>  <b>Further, on the code we see still an interesting thing:</b> <br><pre> <code class="java hljs">Intent localIntent4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"android.app.action.ADD_DEVICE_ADMIN"</span></span>); localIntent4.putExtra(<span class="hljs-string"><span class="hljs-string">"android.app.extra.DEVICE_ADMIN"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.compName); localIntent4.putExtra(<span class="hljs-string"><span class="hljs-string">"android.app.extra.ADD_EXPLANATION"</span></span>, <span class="hljs-string"><span class="hljs-string">"Additional text explaining why this needs to be added."</span></span>); startActivityForResult(localIntent4, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br>  It is seen that the bot is trying to add itself as another device administrator. <br><br>  <b>Attention!</b>  <b>Con maneuver</b> <br>  Next in MainActivity.java runs many different patterns to divert the user's eyes, pretending to be an application that supposedly scans the phone for all sorts of mobile vulnerabilities, as well as supposedly updates itself.  And all this beauty is given in Portuguese, with the indication of some Australian bank. <br><br>  In fact, there is no phone scanning, certificates downloading, etc.  Only dummy templates are launched that mimic vigorous activity.  Here is an example of such a dummy: <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">template4_task</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncTask</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">template4_task</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Void </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doInBackground</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Void... paramVarArgs)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { TimeUnit.SECONDS.sleep(<span class="hljs-number"><span class="hljs-number">5L</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException localInterruptedException) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (;;) { localInterruptedException.printStackTrace(); }</code> </pre> <br>  Asintask starts, and there‚Äôs a timer that just starts and ... does nothing! <br><br><h5>  AutoStart Receiver </h5><br>  This receiver starts its work immediately after loading the phone and starts the same actions as were MainActivity: <br><pre> <code class="java hljs"> Intent localIntent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span>); localIntent.setClass(paramContext, SmsReciever.class); paramContext.sendBroadcast(localIntent); paramContext.startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(paramContext, AService.class)); paramContext.startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(paramContext, webService.class));</code> </pre> <br><br><h5>  Service aService </h5><br>  This service, by filtering events, registers and launches the smsReciever receiver, which in turn will receive and process all received SMS messages (but about it a bit later). <br>  Here is the evidence: <br><pre> <code class="java hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> IntentFilter smsFilter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntentFilter(<span class="hljs-string"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span>); ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.smsFilter.setPriority(<span class="hljs-number"><span class="hljs-number">999</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.smsReceiver = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SmsReciever(); registerReceiver(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.smsReceiver, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.smsFilter);</code> </pre> <br><br><h5>  smsReceiver and smsParser </h5><br>  Now go to the more interesting pieces of the bot code.  This is a smsReceiver receiver and a separate class for identifying codes from SMS and web admin. <br><br>  I quote a very stripped-down piece of code from smsReceiver: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context paramContext, Intent paramIntent)</span></span></span><span class="hljs-function"> </span></span>{ ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (;;) { ‚Ä¶ { smsParser localsmsParser = smsParser.getInstance(); localsmsParser.setSMSMessage(localSmsMessage.getMessageBody()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isStartSMS()) { localdbActions.setStartSMS(); } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isStopSMS()) { localdbActions.setStopSMS(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isStartCALL()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { localdbActions.setStartCALL(); } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isStopCALL()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { localdbActions.setStopCALL(); } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isSmsList()) { localdbActions.sent_smslist_to_server(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isCallList()) { localdbActions.sent_Call_Details(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isStartRecord()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (webServiceRobot.AR != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { webServiceRobot.AR.stop(); webServiceRobot.AR = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isStopRecord()) { localdbActions.setStopRecord(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (webServiceRobot.AR == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { webServiceRobot.AR.stop(); webServiceRobot.AR = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } ‚Ä¶ } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isSmsSend()) { localdbActions.SendSMS(localSmsMessage.getMessageBody()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localsmsParser.isContactList()) { localdbActions.sent_call_list_details(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!localsmsParser.isWipeData()) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> label592; } localdbActions.make_wipe_data(); ... paramContext.startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(paramContext, AService.class)); paramContext.startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(paramContext, webService.class)); ‚Ä¶</code> </pre> <br><br>  I think detailed comments are not needed.  From the code it is clear that: <br><ul><li>  Check boxes start / stop recording phone calls; </li><li>  Sending SMS; </li><li>  Sending a list of SMS; </li><li>  Sending a list of calls; </li><li>  Rubbing information, etc. </li></ul><br><br>  <b>localsmsParser key element.</b>  Therefore, let's look further at the smsParser class: <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_GET_CALL_LIST = <span class="hljs-string"><span class="hljs-string">"call list"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_GET_CONTACT_LIST = <span class="hljs-string"><span class="hljs-string">"contact list"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_GET_SMS_LIST = <span class="hljs-string"><span class="hljs-string">"sms list"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_PING = <span class="hljs-string"><span class="hljs-string">"ping"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_SEND_SMS = <span class="hljs-string"><span class="hljs-string">"sendSMS"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_START_RECORD = <span class="hljs-string"><span class="hljs-string">"start record"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_STOP_RECORD = <span class="hljs-string"><span class="hljs-string">"stop record"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String COMMAND_WIPE_DATA = <span class="hljs-string"><span class="hljs-string">"wipe data"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String startCALL = <span class="hljs-string"><span class="hljs-string">"call start"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String startSMS = <span class="hljs-string"><span class="hljs-string">"sms start"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String stopCALL = <span class="hljs-string"><span class="hljs-string">"call stop"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String stopSMS = <span class="hljs-string"><span class="hljs-string">"sms stop"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String changeNUM = <span class="hljs-string"><span class="hljs-string">"change num"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_CALL_LIST = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_CONTACT_LIST = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_NULL = -<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_PING = <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_SEND_SMS = <span class="hljs-number"><span class="hljs-number">9</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_SMS_LIST = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_START_CALL = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_START_RECORD = <span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_START_SMS = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_STOP_CALL = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_STOP_RECORD = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_STOP_SMS = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COM_WIPE_DATA = <span class="hljs-number"><span class="hljs-number">11</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> smsParser parser = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>;</code> </pre> <br>  According to these constants, we can understand what functions our bot can perform.  The same commands are given in string and digital form.  Most likely, there is a check on the source from which the commands come (SMS or Internet). <br><br><h5>  webServiceRobot </h5><br>  This class is similar to smsReceiver with the difference that it handles http requests.  Almost all the same actions are performed: <br><ul><li>  Sending SMS; </li><li>  Sending a list of SMS; </li><li>  Sending a list of calls; </li><li>  Rubbing information, etc. </li></ul><br>  Plus sending full device information to the server. <br><br><h5>  findings </h5><br>  Well, the main pieces of code we have considered.  Now let's draw conclusions.  The bot is well written and performs a very extensive number of functions.  Actually, the announcement from one of the forums for the sale of this bot: <br><blockquote>  Dear Sirs, we are pleased to offer you a bot for mobile devices.  At the moment, the bot is implemented under the Android operating system, we are also happy to inform you that the development of Blackberry is in full swing, and the first beta versions will be in the coming month, all customers on the Android bot on Blackberry will have significant discounts. <br>  Now briefly tell how it works, for those who do not know, after installing on a mobile device, the application instantly tapping into a convenient web-panel with 3g or wi-fi, and also sends an SMS to the control number with the text I am (ICCID + MODEL PHONE).  Our bot is implemented in such a way that after entering the system, the user continues to quietly use his phone, all functions are available to him in normal mode.  Unlike the famous Perkele, we have no sharpening for certain interception numbers, our bot works through the command system.  Commands are given in any way convenient for you, either from the web panel in the presence of the Internet, or SMS from the control number. </blockquote><br><br><h6>  Functional: </h6><br><ul><li>  Grabing all victim information (Phone Number, ICCID, IMEI, IMSI, Model, OS) </li><li>  Interception of all incoming SMS and sending them to the web-panel and to the control number. </li><li>  Call forwarding to any number </li><li>  Grabing all incoming and outgoing SMS </li><li>  Grabing all incoming and outgoing CALLS </li><li>  Record audio file, sending it to the server (we know what is happening around) </li><li>  Sending SMS to any number without the knowledge of the owner </li><li>  Convenient Web Panel </li></ul><br><blockquote>  So, this software is sold, the price of the bot is 4k, complete you get the admin panel configured on your server + control web number + .apk file with a unique interface designed for your needs, as well as ongoing product support.  Also, we are ready to consider options for renting and working together for a percentage (please do not knock if you do not have injections and you do not know how to use it).  For more information, write to me in the PM your jabber for contact, GPG and OTR are vital. <br><br>  Dear Sirs.  UPDATE released for Android.  All customers knock on the update and look forward to new customers. <br>  <b>What's new?</b> <br><ul><li>  Now our application is extremely difficult to delete.  When installing the application, the software requests the rights of the device admin, if the holder provides them with them, then the application will be extremely dreary, the services will restart and you will not lose this bot.  If they do not provide it, then the application will continue to work as before.  For your convenience, an indicator appeared in the admin panel, showing whether admin rights are granted or not. </li><li>  If you have admin rights, it is possible to demolish the phone with the command to the factory settings </li></ul><br></blockquote><br>  Name of sms bots for anti-virus vendors: Trojan-Spy.AndroidOS.Zbot.a / Android.Smssniffer / Android / SpySMS / AndroidOS_SMSREP.B <br><br>  <b>Nabiev Nurlan (Kazakhstan)</b> , <a href="https://www.pentestit.ru/forensic">Department of Cybercrime Investigation</a> , PentestIT </div><p>Source: <a href="https://habr.com/ru/post/231425/">https://habr.com/ru/post/231425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../231407/index.html">Chris Bird appointed new Mozilla CEO</a></li>
<li><a href="../231411/index.html">Understanding bind and bindAll in Backbone.js</a></li>
<li><a href="../231417/index.html">Web design, inkscape and all-all-all, part 1</a></li>
<li><a href="../231419/index.html">Black swans. Funding bad ideas</a></li>
<li><a href="../231421/index.html">Alfa-Bank and Visa launch the development program for fintech-startups</a></li>
<li><a href="../231427/index.html">Analysis sms-bot for Android. Part II</a></li>
<li><a href="../231429/index.html">Add Floating Action Button to your Android app.</a></li>
<li><a href="../231431/index.html">Code.Re is a minimalistic service for placing snippets.</a></li>
<li><a href="../231433/index.html">KolibriOS Digest # 6: Last Autumn</a></li>
<li><a href="../231435/index.html">General Motors will equip some Cadillac models with wireless phone chargers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>