<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Partial wow effects: magic with simple words</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is a category of sites that we usually call ‚Äúwow sites.‚Äù They are not intended for direct consumption of content, but rather impress the visitor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Partial wow effects: magic with simple words</h1><div class="post__text post__text-html js-mediator-article">  There is a category of sites that we usually call ‚Äúwow sites.‚Äù  They are not intended for direct consumption of content, but rather impress the visitor.  These sites are usually unique in their design, contain experimental solutions for interacting with the user, break stereotypes and are full of different animations.  Of particular interest are the various tricks with SVG and animations based on a large number of particles, which will be discussed in this article. <br><br><img src="https://habrastorage.org/webt/us/-a/w3/us-aw3runbp8hbabbhbxxijevv4.jpeg"><br><br>  In general, the idea of ‚Äã‚Äãrecreating various objects in the form of a set of particles has existed for a long time.  But due to the fact that the practical application of this idea is very limited, and each specific implementation is tied to specific content, there is no single structured knowledge base in which one could quickly become familiar with all the techniques.  As a result, many developers do not understand that at the heart of everything are very simple ideas.  They can be implemented by anyone who is more or less familiar with JS. <br><a name="habracut"></a><br>  We will try to make out the basic approach to creating animations from particles in 2d and see a couple of practical examples, without delving into the low-level optimizations and features of specific libraries for working with canvas.  All further reasoning will be based on the assumption that the reader is familiar with the basics of working with canvas.  If not, it is better to stop at this moment and get acquainted.  Code examples will be slightly simplified to convey ideas, rather than specific recipes for copy-paste, so it will be helpful to be in context. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A small digression: there will be people who say that all this eats up processor resources, a new MacBook lags, and in general, in general, you can‚Äôt do this on the site.  On the one hand, this remark is true.  Modern JS in the browser is not a good basis for complex calculations, especially when it comes to the average website.  But we're not talking about regular sites, are we? <br><br><h2>  Thought number one.  Size matters </h2><br><img src="https://habrastorage.org/webt/ji/st/fu/jistfuurahqfegheimz1c2o7axw.jpeg"><br><br>  In most cases, particles cannot be very small.  This is a performance issue.  On an average laptop, we will not be able to count the entire screen by one pixel and have at the same time at least 30fps, not to mention 60. It is necessary to reduce the number of particles.  In practice, animations usually use either small particles of 2-3px, if you are working with a small image, or large ones, tens of pixels in size, and intended to fill a large area of ‚Äã‚Äãthe screen. <br><br>  On the other hand, the particles cannot be too large.  This is a matter of adaptability.  It makes sense to remember that on the phone the screen is smaller and larger particles will simply create an unreadable mess.  A good choice would be to bind the size of the particles to the size of the canvas with which we work. <br><br><h2>  Thought number two.  Need a ready-made arrangement of particles. </h2><br><img src="https://habrastorage.org/webt/ud/3u/vs/ud3uvsqe9ykkurhqarbls500jsk.jpeg"><br><br>  We need a foundation.  No complicated animation will be done in a reasonable time without a base.  There are two options.  Either we base image or text.  The text may be a title, a clock, an error number, or just some word on the fence. <br><br>  Basis, whatever it is, must be transferred to the canvas.  The text is simple: once you write it with the standard fillText, we get a black and white scheme for positioning the particles.  This is exactly what we need. <br><br><pre><code class="javascript hljs">ctx.fillStyle = <span class="hljs-string"><span class="hljs-string">'#fff'</span></span>; ctx.fillRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width, height); ctx.fillStyle = <span class="hljs-string"><span class="hljs-string">'#000'</span></span>; ctx.font = <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${fontSize}</span></span></span><span class="hljs-string">px Arial`</span></span>; ctx.textAlign = <span class="hljs-string"><span class="hljs-string">'center'</span></span>; ctx.fillText(<span class="hljs-string"><span class="hljs-string">'Hello'</span></span>, width/<span class="hljs-number"><span class="hljs-number">2</span></span>, height/<span class="hljs-number"><span class="hljs-number">2</span></span> + fontSize/<span class="hljs-number"><span class="hljs-number">4</span></span>);</code> </pre> <br><img src="https://habrastorage.org/webt/di/qf/ek/diqfek6pkfok_jomdoruddhf75y.jpeg"><br><br>  It is worth noting that pre-filling the background with white will not be unnecessary.  Yes, in modern browsers the background will be formally white, but not in Safari.  If someone did not hear, then this is our new donkey, which in its own way works with transparencies, both in CSS gradients and on canvas.  Because of this, it may appear completely different colors that we expect.  And breakdowns occur in different faiths of the browser in different ways. <br><br>  Having received the color scheme of the location of the particles, we can easily create a set of these particles, each of which will have its own coordinates.  In the future, we will add additional parameters to them.  Here and below, height and width are the dimensions of the canvas, particles are an array of particles, step is the initial distance between particles. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = ctx.getImageData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width, height).data; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data32 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint32Array</span></span>(data.buffer); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; width; x += step) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; height; y += step) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> color = data32[y * width + x]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (color != <span class="hljs-number"><span class="hljs-number">0xFFFFFFFF</span></span>) { particles.push({ x, y }); } } }</code> </pre> <br>  We just go around the entire canvas by pixels with a certain step, which determines the distance between the particles, and save the particles that fall on the letters.  Since the scheme consists of two colors, it does not matter with which one to compare.  But when using a picture as a basis, it can be convenient to compare it with the background, especially if it is a product or stock person on a white background.  In some cases, such sampling is not performed at all and the particle is stored at each step of the cycle. <br><br>  No one bothers to make the particles more complex, for example, you can add a color to them that will match the color of the pixel from the original image or calculate the average color from the neighboring pixels, although this is likely to be redundant. <br><br>  Now we can clear the canvas and fill it with particles, for example, by drawing squares at their locations: <br><br><pre> <code class="javascript hljs">particles.forEach(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">particle</span></span></span><span class="hljs-function">) =&gt;</span></span> { ctx.fillStyle = particle.color; ctx.fillRect( particle.x, particle.y, step, step ); });</code> </pre> <br>  This will not give a particularly interesting effect, just our picture or text is slightly pixelated.  Or turn into a set of any other geometric shapes, if we draw not squares.  But when you add motion, you get interesting results: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/sfi0zy/embed/preview/vdYRoj" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  OK.  And what movement to add? </h2><br>  In general, the particles have the following basic parameters: <br><br><ul><li>  Coordinates </li><li>  The size </li><li>  The form </li><li>  Colour </li></ul><br>  In most cases, we will have a time counter, which we will use to determine particle parameters.  In other words, everything that will change, we try to tie to time.  This has an interesting feature - we can increase or decrease the counter, thereby changing the course of time and returning the animation to the roots. <br><br>  One of the most simple but loved by many animations is the random movement of particles around their original coordinates.  It works well with lyrics.  The more random the movement, the sharper, more jerky the result will be.  If the motion is tied to something more or less uniform, for example, to a small circle (recalling sine and cosine), the effect will be smoother, flowing, especially if the particle size is slightly changed. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/sfi0zy/embed/preview/wryYwW" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  This example shows what happens if you keep a large particle size on a small screen (compare with the previous example).  This is the question of adaptability. <br><br>  The main thing here is to add variety so that the particles change their parameters not quite synchronously.  This can be done in different ways, but usually for each particle is made some kind of factor to change its parameters, depending on the sequence number in the array of particles.  It is often enough to multiply the argument of the same sine by the ordinal number of the particle.  This approach allows you to achieve an acceptable level of accidents without much mental effort.  From the point of view of the mathematician-cryptographer, this will not look like a random sequence, but for animation it is quite enough - the viewer will have time to be impressed and go further before significant synchronization occurs in the movement of particles. <br><br>  Good advice about color for beginners: if you need to smoothly change the color of the particles over time - forget about RGB and switch to HSL.  This will allow not to bother and smoothly change only one of the parameters for changing the tone.  With saturation the same.  And even with care in black or white, you will not need to think about the fact that the color scheme floats a little like on an old TV. <br><br><h2>  The sands of Time‚Ä¶ </h2><br><img src="https://habrastorage.org/webt/ws/un/tk/wsuntk66_tx-zcvbl1u70opbrs8.jpeg"><br><br>  Another spectacular thing is to create some semblance of a waterfall, or rather, a landslide.  Particles begin to move in one direction with random acceleration, increasing in height.  They leave a trace behind them.  Similar techniques work well with pictures. <br><br>  To put a picture on canvas, we use the standard drawImage method.  If necessary, you can arrange images using behavior similar to the object-fit property: cover or contain.  The network has ready-made solutions for this case. <br><br>  But back to the effect itself.  It is easy to make from the previous example.  We need to add new parameters to the particles - size and speed. <br><br><pre> <code class="javascript hljs">particles.forEach(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">particle</span></span></span><span class="hljs-function">) =&gt;</span></span> { ctx.fillStyle = particle.color; ctx.fillRect( particle.x, particle.y, particle.width, particle.height ); particle.speed += timeCounter * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.abs(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(<span class="hljs-number"><span class="hljs-number">5</span></span> * particle.x + <span class="hljs-number"><span class="hljs-number">7</span></span>)); particle.y += particle.speed; particle.height += particle.speed; }); timeCounter++;</code> </pre> <br>  If you have ever written a random number generator, you probably already thought that the combination of two prime numbers (5 and 7) resembles something very familiar, only very small numbers.  One could recall the theory, but in practice, when creating such effects, the numerical coefficients are usually selected by trial and error ‚Äî it is difficult to say in advance what the visual effect will be as a result.  And it is he who is important. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/sfi0zy/embed/preview/xYGbdq" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Similar animations can be used to effectively replace one picture with another, when one flows in one direction and the other flows from the opposite side.  In order to make such a change of pictures, you need to calculate in advance the position of the particles for the second picture and start the time counter for it in the opposite direction.  The most convenient way to do this is by expressing all the parameters of the particles through the time counter in an explicit form. <br><br><h2>  Where to go next? </h2><br>  We have considered the simplest methods of applying particles in animations.  This is just the tip of the iceberg.  The best way to learn to do these things is to start doing them.  On CodePen regularly appear interesting demos, which will be useful to get acquainted.  Novice developers want to give advice: pay more attention to the ideas embodied in the examples that you are studying, rather than specific implementations, and do not be afraid to experiment. </div><p>Source: <a href="https://habr.com/ru/post/347962/">https://habr.com/ru/post/347962/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347952/index.html">How to create a truly random and provably secure password</a></li>
<li><a href="../347954/index.html">How we developed the technology to detect devices nearby</a></li>
<li><a href="../347956/index.html">An article about how we tried to apply modern neural network technologies to find helmets on people's heads</a></li>
<li><a href="../347958/index.html">The story of how not to let me steal credit card numbers and passwords from visitors to your sites</a></li>
<li><a href="../347960/index.html">I am a developer from 9 to 17 (and you can become one)</a></li>
<li><a href="../347964/index.html">How does blocking access to pages that distribute prohibited content (now the RKN also checks the search engines)</a></li>
<li><a href="../347966/index.html">How we set up a search using Elasticsearch and Logstash using MSSQL data</a></li>
<li><a href="../347968/index.html">Efficient data conversion using transducers</a></li>
<li><a href="../347972/index.html">You went to three fun words! New geocoding and what3words.com</a></li>
<li><a href="../347974/index.html">We are pumping a WebDriverAgent, or how to test iOS applications after a nuclear explosion. Decryption report</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>