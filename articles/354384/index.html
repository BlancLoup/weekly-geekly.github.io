<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Made an attack on MyEtherWallet, through the interception of Amazon DNS service using BGP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We somehow got used to that cryptocurrencies live their own lives, and networks and network services their own. And certainly, cryptocurrency develope...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Made an attack on MyEtherWallet, through the interception of Amazon DNS service using BGP</h1><div class="post__text post__text-html js-mediator-article">  We somehow got used to that cryptocurrencies live their own lives, and networks and network services their own.  And certainly, cryptocurrency developers do not often need the <a href="https://en.wikipedia.org/wiki/Border_Gateway_Protocol">BGP</a> protocol, which is used by Internet channel providers to exchange route information.  Well, this did not prevent the attackers to use their ingenuity, knowledge of network technologies, and arrange an elegant robbery of trusting cryptocurrency owners Ethereum. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/56b/5af/1ce/56b5af1ceceb1bc2c7d16b6d808d482d.jpg" alt="image"><br><br>  The essence of the attack is simple: using BGP, attackers were able to <a href="https://doublepulsar.com/hijack-of-amazons-internet-domain-service-used-to-reroute-web-traffic-for-two-hours-unnoticed-3a6f0dda6a6f">redirect</a> <a href="https://aws.amazon.com/ru/route53/">Amazon Route 53</a> traffic (this is a DNS service provided by Amazon) to their DNS server, which gave the IP address of the attacker to the MyEtherWallet.com website, which contains a slightly corrected clone original site.  The original MyEtherWallet.com contains the Ethereum web wallet implementation for a cryptocurrency wallet, while a clone conducted a phishing attack, which resulted in the attackers stealing 215 ETH (~ 137 thousand dollars) in two hours. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/55a/a66/0ab/55aa660ab96bc3e4b1b2684b2e9024af.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The substitution of the fictitious route was <a href="https://blog.cloudflare.com/bgp-leaks-and-crypto-currencies/">carried out</a> on behalf of the large American Internet provider <a href="http://www.ee.net/">eNet</a> ( <a href="http://www.datacentermap.com/as/10297.html">AS 10297</a> ), located in Columbus (Ohio, USA).  After the BGP announcement, all the eNet peers, among which are the largest operators such as Level 3, Hurricane Electric, Cogent and NTT, began to wrap traffic sent to Amazon Route 53, according to the route set by the attackers.  Because of the bogus announcement of BGP, requests for five Amazon-owned / 24-sized subnets (for a total of about 1300 IP addresses): <br><br><ul><li>  205.251.192.0/24 </li><li>  205.251.193.0/24 </li><li>  205.251.195.0/24 </li><li>  205.251.197.0/24 </li><li>  205.251.199.0/24 </li></ul><br>  redirected to the attacker-controlled server located in the data center of the provider Equinix in Chicago, where the MiTM-attack was launched to substitute DNS responses.  As a result, the usual DNS operation scheme, in which the request is sent to an authoritative server for a domain (on the slide below, server 205.251.195.x) continued to work as before, however, the attackers server began to appear at 205.251.195.x: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2cf/50f/9bf/2cf50f9bf1b78f442f02cca8603ec2b1.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/11b/305/2d1/11b3052d18020eb41bca3c8e286fd79c.png" alt="image"><br><br>  The situation is anecdotal, but for <b>almost two hours</b> (from 11:05 to 12:55 UTC, April 24, 2018) no one noticed this substitution, and people used a replacement website, even (attention!) Despite the fact that A <b>self-signed</b> HTTPS certificate was used (for which browsers issue a warning about problems with a secure connection).  In case of accepting a certificate (!) And authentication on a phishing site, the user was <a href="https://www.reddit.com/r/MyEtherWallet/comments/8ek0jj/think_i_got_scammedphishedhacked/">charged</a> all funds from the wallet. <br><br>  It is noteworthy that the attackers, apparently, are not poor people: on the ETH-wallet, to which transfers were redirected during the attack, currently there are 24,276 ETHs, which is more than 15 million US dollars. <br><br>  While it is known for sure that during the attack, the DNS records were replaced for the site MyEtherWallet.com, but this does not mean that it is only with this site that everything is over.  It seems logical to assume that getting access to the BGP router of a large ISP and the availability of resources to handle the huge DNS traffic indicates that the attack was not limited only to MyEtherWallet.  This hypothesis is also supported by the uninterrupted flow of transfers to the ETH wallet used in the attack.  According to other assumptions, there was only a test experiment before conducting more massive attacks. <br><br>  The question with the certificate, I must say, is quite thin.  The attackers could easily get a certificate from Let's Encrypt, since DV-checking was quite capable of them, unless it made you spend some time on it - or, which is likely (thanks to <a href="https://habr.com/users/ghost_nsk/" class="user_link">Ghost_nsk</a> for the clarification), the LE server is far enough in the network sense from the attackers , so that the announcements do not reach them, and LE did not ‚Äúsee‚Äù the malicious DNS. <br><br>  Obviously, the idea of ‚Äã‚Äãusing more secure protocols and technologies for working with DNS, such as DNS over HTTPS (DoH), or DNS over TLS (both offered by CloudFlare in its <a href="https://habr.com/post/352654/">DNS service 1.1.1.1</a> ) seems to be all more reasonable, despite the associated overhead. </div><p>Source: <a href="https://habr.com/ru/post/354384/">https://habr.com/ru/post/354384/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354370/index.html">About memory leak in one server application</a></li>
<li><a href="../354374/index.html">Protection against DDoS attacks at the level of web applications</a></li>
<li><a href="../354376/index.html">Who should NOT move to the cloud and why</a></li>
<li><a href="../354378/index.html">Why and how to conduct backlog grooming in grocery teams?</a></li>
<li><a href="../354380/index.html">Books on design systems</a></li>
<li><a href="../354386/index.html">GDPR as a weapon of mass destruction</a></li>
<li><a href="../354388/index.html">Backend optimization when switching to api-based architecture</a></li>
<li><a href="../354390/index.html">Ubuntu 18.04 LTS: what's new?</a></li>
<li><a href="../354392/index.html">Solar JSOC Forensics: mining case on 32 non-existent hypervisors</a></li>
<li><a href="../354394/index.html">How to improve performance using serverless architecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>