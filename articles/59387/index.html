<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn the iPod Shuffle G3 to speak Russian</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While we are waiting for iTunes (Apple) to teach the new iPod Shuffle to speak Russian, why not try it yourself? 

 Before you start 

 All that is de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn the iPod Shuffle G3 to speak Russian</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/c87/627/b8f/c87627b8fa69c3d0e44179dc546f063f.jpg" alt="image"><br>  While we are waiting for iTunes (Apple) to teach the new iPod Shuffle to speak Russian, why not try it yourself? <br><br>  <b>Before you start</b> <br><br>  All that is described here is not intended to replace iTunes, but rather serves as an addition, which is needed only until iTunes learns how to voice the names in Russian (I really hope that they will learn). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  <b>The technical side of the issue</b> <a rel="lightbox" href=""><img align="right" src="https://habrastorage.org/getpro/geektimes/post_images/551/c5b/020/551c5b0200c98c0d1984c19b0d5d7e9d.gif"></a> <br>  The voiceover function, which appeared in the new iPods (pronounces the name of the song / playlist), is realized, of course, not by the iPod itself, but by iTunes (which is why you need iTunes not lower than 8.1 to work with the new iPod), which synchronizes the sound files and uploads them to the iPod.  The iPod, in turn, reads them (on the "convenient" occasion). <br><br> <a rel="lightbox" href=""><img align="right" src="https://habrastorage.org/getpro/geektimes/post_images/aeb/6c4/b6e/aeb6c4b6e398f7044b60f96fc3da262b.gif"></a>  Sound files that are used for pronunciation are located in the Speakable directory.  In addition to everything else (system voice messages about battery charge, etc.) there are two subdirectories in it - Tracks and Playlists.  In which there are voiced names of playlists and tracks, in wav format (raw PCM, 22050 Hz), with rather strange names.  As it turned out, these names are identifiers of songs and playlists in a database that is stored on the iPod. <br><br>  <b>Looking for a way to read iPod - libgpod</b> <a href="" rel="lightbox"><img align="right" src="https://habrastorage.org/getpro/geektimes/post_images/889/117/e10/889117e10b252850636b6dcfc1db2aa3.gif"></a> <br>  In search of a place from where iPod takes the names of files with voice acting, stumbled upon files in the iPod_Control / iTunes directory, in which there are file names, more precisely, if some numerical sequences from the files are represented as a hexadecimal string, then the names of the files were obtained.  There was no time or desire to deal with the iTunes database format, so we decided to look for ready-made solutions.  The choice fell on the libgpod library (we learned about it from the dependencies of the gtkpod application - a very good replacement for iTunes for Linux - for which, judging from everything, this library was developed). <br><br>  Here a difficulty arose - the library returned an error, something in the spirit of ‚Äúnot the correct record size (11 &lt;18)‚Äù.  I had to watch the library source. <br>  (By the way, here we are talking about the library version 7.0, there was, at the time of the start of development, version 7.2, which also could not read the third-generation shafles.) <br>  The figure on the right shows the corresponding section of the code.  The first underlined is the offset, which in the version of the database, which is in the new iPod, has changed and became 8 (this can be seen if you open the file with a hex editor, in our case it was GHex).  The second underlined is that the changes were made (while we were looking for information on the network, we found that the numbers became 32-bit in the new iPods, they didn‚Äôt check it, but they did it just in case :). <br><br>  It is worth paying attention that since  the number that was corrected (offset) is set rigidly, regardless of the version of the database, then the libgpod patched in this way will not work with older versions of the iPod.  In order to do it in a normal way, I would have to change the library quite a lot, which was not the goal. <br><br>  So, having managed to read the iPod database, we saw that the names of the files with dubbing are identifiers of playlists and tracks.  In the same database, fortunately, there is all the information about the names of playlists, tracks, names of albums and artists.  The next question is how to voice, i.e.  how to synthesize sound files from the Russian text. <br><br>  <b>We voice in Russian, festival</b> <br><br>  I managed to find only one free solution for dubbing, - festival, the distribution kit is probably in all Linux distributions, if not, you can download the source code from the developers site ( <a href="http://www.cstr.ed.ac.uk/projects/festival/">http://www.cstr.ed.ac.uk/projects/ festival /</a> ).  The official distribution does not support the Russian language, but there is a solution that allows you to voice the Russian text.  Description can be found here ( <a href="http://festlang.berlios.de/docu/doku.php%3Fid%3Drussianru">http://festlang.berlios.de/docu/doku.php?id=russianru</a> ) <br><br>  In order to be able to use the Russian language immediately in festival, you need to add the command (set! Voice_default 'voice_msu_ru_nsh_clunits) to the /etc/festival/siteinit.scm file. <br>  The Festival allows you to get a pretty good quality of the Russian text, but it has one problem - the English text is not very good ... probably not very good at all (this is if the Russian voice is chosen). <br><br>  Examples of sound (wav, about 100k each): <br><ul><li>  <a href="">Animal jazz</a> </li><li>  <a href="">7 hours Fahrenheit</a> </li><li>  <a href="">Aravika (fortepiano version)</a> <br></li></ul><br>  <b>Actually, the program</b> <br><br>  We got this program (C, GTK +): <br><br> <a rel="lightbox" href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/5ad/e40/f8e/5ade40f8e6d84af86b4abe901d419a56.gif"></a> <a rel="lightbox" href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/f71/0ee/e2b/f710eee2be15c333ba321ea1b796f4fa.gif"></a> <br><br>  We press to read iPod, we select iPod, we receive the list of playlists and tracks.  The right column is a file, - the name of the file with ‚Äúvoice acting‚Äù, for the corresponding position <br>  Double click on the line, - play the file that currently corresponds to the track / playlist. <br>  We choose what exactly needs to be voiced, click to voice and wait for quite a long time, at the bottom of the progress. <br><br>  The program still has a console (non-interactive) interface (see - help and README). <br><br>  <b>Installation</b> <br><br>  So, we need: <br><ol><li>  Actually program ( <a href="">here</a> ) <br></li><li>  Patched libgpod ( <a href="">here</a> ) <br></li><li>  versions of GTK +, GStreamer and libgpod for developers (in Gent these are the same packages, in Debian, it seems, they are with the -dev postfix).  Put your favorite means. <br></li></ol>  We unpack libgpod, inside we execute <br>  ./configure <br>  make <br>  (only if you are not going to use gtkpod with older iPod models) make install <br><br>  Let's unpack the program, inside we execute <br>  ./configure <br>  make <br>  (you do not need to make install, because there is still no desktop file, i.e. nothing will be added to the menu) <br><br>  If in the previous paragraph (about libgpod) you didn‚Äôt make install, then you need to do the following (otherwise, you can skip to the last paragraph of this part): <br><br>  Copy the file libgpod / src / .libs / libgpod.a to the directory shuffle-vo / src, libgpod is the directory in which the unpacked library libgpod, shuffle-vo is the directory with the unpacked program. <br>  Go to the shuffle-vo / src directory, run make clean, then make, copy a line like this (it will be the last): <br><br>  gcc -Wall -g -g -O2 -Wl, - export-dynamic -o shuffle_vo main.o -pthread -L / usr / lib /usr/lib64/libgtk-x11-2.0.so / usr / lib64 / libgdk- x11-2.0.so /usr/lib64/libatk-1.0.so /usr/lib64/libpangocairo-1.0.so /usr/lib64/libpangoft2-1.0.so /usr/lib64/libcairo.so / usr / lib64 / libpixman- 1.so /usr/lib64/libpng12.so /usr/lib64/libXrender.so /usr/lib64/libX11.so /usr/lib64/libXau.so /usr/lib64/libXdmcp.so / usr / lib64 / libpango- 1.0.so /usr/lib64/libfontconfig.so /usr/lib64/libfreetype.so /usr/lib64/libexpat.so /usr/lib/libgpod.so /usr/lib64/libgdk_pixbuf-2.0.so / usr / lib64 / libgio-2.0.so /usr/lib64/libgstreamer-0.10.so /usr/lib64/libgobject-2.0.so /usr/lib64/libgmodule-2.0.so /usr/lib64/libgthread-2.0.so -lpthread -lrt / usr / lib64 / libxml2.so -ldl -lz -lm /usr/lib64/libglib-2.0.so -pthread <br><br>  and replace /usr/lib/libgpod.so in this line with libgpod.a, and then execute the resulting line <br><br>  Thus, our program will be statically linked to the desired libgpod library, while the system will have the libgpod library that can work with previous versions of the iPod. <br><br>  To check that the static binding can be done the following - ldd shuffle_vo, there should not be a line in the list <br>  libgpod.so.4 =&gt; /usr/lib/libgpod.so.4 (0x00007fe6537f1000) <br><br>  We read the README, which with the program, set up the festival accordingly. <br><br>  What's next <br><br>  The quality of sounding English words in Russian texts leaves much to be desired, so it would be great if someone, for example, uBot organizes a voice service, for <a href="http://www.ubot.ru/">uBot</a> , by the way, the quality of sounding Russian texts is higher than that of festival.  Well, we are waiting for the apple to release an update for iTunes, which will allow the Russian names to be voiced, we are waiting very much, because  iTunes speaks English lyrics very well, if it also speaks Russian will be very cool. <br><br>  This is the first public release of the program, so, for sure, it is full of glitches and errors. <br><br>  Regarding the further development of the program - feel free to download, modify and share.  I probably will not have time for its development.  Is that if there will be integration with uBot. <br>  This article and the program are written by the user and one of the creators of the it-portal <a href="http://www.thinkit.ru/">thinkit.ru</a> (it_3.0), but he does not have registration on the habr, for this I publish it at his request. </div><p>Source: <a href="https://habr.com/ru/post/59387/">https://habr.com/ru/post/59387/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../59379/index.html">‚ÄúSay NO to boring web ads‚Äù - say guys from Brainberry</a></li>
<li><a href="../59382/index.html">Pirate Bay is getting closer to reviewing the case</a></li>
<li><a href="../59383/index.html">Dell's new Mini</a></li>
<li><a href="../59385/index.html">Brandz.Ru: announcement of a new competition - from 11 to 24 May</a></li>
<li><a href="../59386/index.html">Rapha√´l</a></li>
<li><a href="../59388/index.html">Belarus and Russia - "electronic police" states</a></li>
<li><a href="../59389/index.html">Check if the IP address is in the subnet</a></li>
<li><a href="../59390/index.html">Photosynth switches to Silverlight, commercializes and integrates into Virtual Earth, while NASA shows the ISS</a></li>
<li><a href="../59392/index.html">Java vs kleptomania</a></li>
<li><a href="../59397/index.html">Russian Ministry of Economic Development on the use of free software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>