<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ping and some of its parameters</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúWhy do the ping team use the Loose, Strict, Record, Timestamp, and Verbose options?‚Äù I met this question recently in a vendor exam. They allow you to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ping and some of its parameters</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/53e/d91/fa9/53ed91fa9a424caaa2fa5818eb460311.png"></div><br>  <b>‚ÄúWhy do the ping team use the Loose, Strict, Record, Timestamp, and Verbose options?‚Äù</b> I met this question recently in a vendor exam.  They allow you to influence the routing of ICMP packets and collect information about L3 transit devices.  But being engaged in network technologies for a long time, I almost never used them. <br><br>  It became not quite clear to me why such a question is generally present in the test.  After returning home, I decided to find out, what if I really constantly lose sight of something important? <a name="habracut"></a><br><br>  The ping utility is well known to all of us.  In addition to the standard "ping 8.8.8.8", you can use various options, among which there are of us.  Their name and description are about the same for vendors. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Of the most used, I would note the following.</b> <div class="spoiler_text"><ul><li>  <b>Number of packages sent</b> <br>  Instead of the specified number of default packets (for example, in Windows - four, in Cisco equipment - five), we can send the right one.  This also includes many of the favorite ‚Äú-t‚Äù options in Windows, which starts the endless sending of packets. </li><li>  <b>Source interface</b> <br>  First of all relevant for network equipment.  By default, when using the ping command, the device sends a packet with the address of the nearest interface to the destination point.  In the case of testing NAT functions or checking VPN, there is a need to send ICMP packets from another interface.  Another classic example: how to prove to a colleague that his firewall is enabled on the host, and not the network is buggy.  We launch ping from a kernel of a network without interface instructions - pinged.  With the indication of the nearest interface - not pinged. </li><li>  <b>DF bit setting</b> <br>  A packet with a DF bit set (= 1) cannot be fragmented.  This option is useful for determining the maximum allowable frame size (MTU) between two points.  Usually used in conjunction with the parameters below. </li><li>  <b>Package size</b> <br>  You can vary the size of the package.  Together with the installation of the DF-bit helps in determining the MTU.  We send a large packet - 1500 bytes.  Does not pass.  We send a little less - 1300. Passes.  We send 1400. And so on.  In general, the dichotomy method and MTU are defined. <br>  On Windows, we specify the size of the ICMP packet data segment.  On Cisco devices, the size of the IP packet including headers. </li><li>  <b>Variation of package size in the specified range</b> <br>  For those who do not like the method of dichotomy, this mode may be useful.  We specify the initial value of the packet size, final and step.  Next, the device sends packets, gradually increasing their size.  The main thing is not to forget to set the DF-bit, otherwise everything is for nothing. </li></ul><br>  There are a number of other options left overboard (timeout, ToS, etc.), which I personally almost never use. <br></div></div><br>  Loose, Strict, Record, Timestamp, Verbose options are included in the ping utility on many network devices.  There is support in Windows. <br><br>  <b>Record (Record Route)</b> <br><br>  An ICMP packet with the Record option records the IP addresses of outgoing interfaces as it passes through L3 devices.  This is done both in the direction of the destination, and back.  This is useful, for example, when diagnosing problems related to asynchronous routing.  It turns out like traceroute, only better. <br><br><div class="spoiler">  <b class="spoiler_title">"Options"</b> <div class="spoiler_text">  I use the word ‚Äúoptions‚Äù in two contexts: ping command options and options in the ICMP packet.  In the case of ICMP, options are additional parameters that are set in the IPv4 header (hereinafter we will simply indicate IP) in the Options field.  Therefore it is more correct, of course, to talk about the IP options.  ICMP just uses them in their work. </div></div><br>  But it's too early to rejoice: the maximum number of entries is nine.  And they include data on the IP-addresses of devices <b>in both</b> directions.  This is due to the restriction that the information about IP-addresses is stored not in the package body, but in the header.  The option field cannot be too large.  It is limited to 40 bytes.  We, in the end, on the network need to drive useful data, not headers.  Only nine entries are placed in this volume (4 bytes for each IPv4 address).  The remaining (40-4 * 9) = 4 bytes go to the mark about the type of option, length, and so on. Attributes.  Let me remind you that the maximum size of an entire IPv4 header is 60 bytes. <br><br><img src="https://habrastorage.org/files/411/11b/51d/41111b51dd16487cbe0488343367fed7.png"><br><br>  We start from a PC running Windows ping with the option Record Route (-r) to the address 192.168.36.2: <br><br><div class="spoiler">  <b class="spoiler_title">C: \ Users \ user&gt; ping -n 1 -r 9 192.168.36.2</b> <div class="spoiler_text"><pre><code class="python hljs">   <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>   <span class="hljs-number"><span class="hljs-number">32</span></span>  :   <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>:  =<span class="hljs-number"><span class="hljs-number">32</span></span> =<span class="hljs-number"><span class="hljs-number">12</span></span> TTL=<span class="hljs-number"><span class="hljs-number">252</span></span> : <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.31</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.32</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.34</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.35</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.35</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.33</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.31</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>  Ping  <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>: :  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>% )   -  :  = <span class="hljs-number"><span class="hljs-number">12</span></span>,  = <span class="hljs-number"><span class="hljs-number">12</span></span> ,  = <span class="hljs-number"><span class="hljs-number">12</span></span> </code> </pre> </div></div><br>  ICMP Echo Request with Record Route (Type = 7) in the IP header: <br><br><img src="https://habrastorage.org/files/03d/1bc/190/03d1bc190e12454d813df0723ce1cd80.png"><br><br>  ICMP Echo Request comes to the recipient.  On the way, addresses of transit devices are added to it.  The recipient takes the filled fields of the IP header option, copies them to ICMP Echo Reply and sends them back.  While ICMP Echo reply gets to the initiator of the ping, it will acquire records of the return route. <br><br>  In the ICMP Echo Reply response packet, which the PC will receive, the Record Route option will already be filled: <br><br><img src="https://habrastorage.org/files/971/d62/a0a/971d62a0a6ff4149b4e747a3fa90001d.png"><br><br>  You may notice that asymmetric routing takes place in our network. <br><br><div class="spoiler">  <b class="spoiler_title">Example ping with the Record option on Cisco networking equipment.</b> <div class="spoiler_text"><pre> <code class="python hljs">R1<span class="hljs-comment"><span class="hljs-comment">#ping Protocol [ip]: Target IP address: 192.168.36.2 Repeat count [5]: 1 Datagram size [100]: Timeout in seconds [2]: Extended commands [n]: y Source address or interface: Type of service [0]: Set DF bit in IP header? [no]: Validate reply data? [no]: Data pattern [0xABCD]: Loose, Strict, Record, Timestamp, Verbose[none]: R Number of hops [ 9 ]: Loose, Strict, Record, Timestamp, Verbose[RV]: Sweep range of sizes [n]: Type escape sequence to abort. Sending 1, 100-byte ICMP Echos to 192.168.36.2, timeout is 2 seconds: Packet sent with a source address of 192.168.20.1 Packet has IP options: Total option bytes= 39, padded length=40 Record route: &lt;*&gt; (0.0.0.0) (0.0.0.0) (0.0.0.0) (0.0.0.0) (0.0.0.0) (0.0.0.0) (0.0.0.0) (0.0.0.0) (0.0.0.0) Reply to request 0 (3 ms). Received packet has options Total option bytes= 40, padded length=40 Record route: (192.168.31.2) (192.168.32.2) (192.168.34.2) (192.168.35.2) (192.168.36.2) (192.168.35.1) (192.168.33.1) (192.168.31.1) (192.168.31.2) &lt;*&gt; End of list Success rate is 100 percent (1/1), round-trip min/avg/max = 3/3/3 ms</span></span></code> </pre> </div></div><br>  <b>Timestamp</b> <br><br>  When an ICMP packet with the Timestamp option passes through an L3 device, it writes a label indicating the current time to it.  The scheme of work is similar to the Record option, only time is put instead of the address.  As in the previous case, the packet can contain only nine time records (for Windows OS, four, since, in addition to the time stamp, the device‚Äôs IP address is added). <br><br><img src="https://habrastorage.org/files/cc4/fe4/bd4/cc4fe4bd4bb24a428b4593ae1a544f51.png"><br><br>  The time in the package is in the UNIX time format.  Data analysis has at least some sense if all devices are synchronized in time (in our example this is not the case). <br><br><div class="spoiler">  <b class="spoiler_title">Example ping with the Timestamp (-s) option on a PC running Windows.</b> <div class="spoiler_text"><pre> <code class="python hljs">C:\Users\user&gt;ping -n <span class="hljs-number"><span class="hljs-number">1</span></span> -s <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>    <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>   <span class="hljs-number"><span class="hljs-number">32</span></span>  :   <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>:  =<span class="hljs-number"><span class="hljs-number">32</span></span> =<span class="hljs-number"><span class="hljs-number">4</span></span> TTL=<span class="hljs-number"><span class="hljs-number">252</span></span>  : <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.31</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> : <span class="hljs-number"><span class="hljs-number">43990397</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.32</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> : <span class="hljs-number"><span class="hljs-number">43990389</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.34</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> : <span class="hljs-number"><span class="hljs-number">2187294073</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.35</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> : <span class="hljs-number"><span class="hljs-number">2190888543</span></span>  Ping  <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>: :  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>% )   -  :  = <span class="hljs-number"><span class="hljs-number">4</span></span>,  = <span class="hljs-number"><span class="hljs-number">4</span></span> ,  = <span class="hljs-number"><span class="hljs-number">4</span></span> </code> </pre> </div></div><br>  <b>Strict (Strict Source Route)</b> <br><br>  When using this option, a list of IP addresses of L3 devices is specified, through which the ICMP packet must pass.  And it is in the sequence that we have indicated.  Records, according to tradition, a maximum of nine. <br><br>  The option works simply: on each hop, the destination IP address changes to the one we specified when running the ping utility. <br><br><img src="https://habrastorage.org/files/c09/274/f51/c09274f517fa468196d0604d445b8052.png"><br><br>  All addresses are stored in the IP header of our ICMP packet.  Therefore, each transit device can spy on them.  This scheme allows you to bypass the current routing rules on each device, since in fact we have a packet forwarded to a neighboring device. <br><br>  In our scheme, R2 has a route to the network 192.168.36.0/24 via R3.  But since we have hardcoded devices in the ICMP packet options, R2 will transfer it directly to R4. <br><br>  Run the ping utility with the -k (Strict Source Route) option in Windows OS and prescribe device addresses. <br><br><div class="spoiler">  <b class="spoiler_title">C: \ Users \ user&gt; ping ‚Äìn 1 -k 192.168.20.1 192.168.31.1 192.168.33.1 192.168.35.1 192.168.36.2</b> <div class="spoiler_text"><pre> <code class="python hljs">   <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>   <span class="hljs-number"><span class="hljs-number">32</span></span>  :   <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>:  =<span class="hljs-number"><span class="hljs-number">32</span></span> =<span class="hljs-number"><span class="hljs-number">5</span></span> TTL=<span class="hljs-number"><span class="hljs-number">252</span></span> : <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.35</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.33</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.31</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.20</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>  Ping  <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>: :  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>% )   -  :  = <span class="hljs-number"><span class="hljs-number">5</span></span>,  = <span class="hljs-number"><span class="hljs-number">5</span></span> ,  = <span class="hljs-number"><span class="hljs-number">5</span></span> </code> </pre> </div></div><br>  The ICMP Echo Request package with the Strict Source Route option (Type = 137) in the IP header on our PC looks like this: <br><br><img src="https://habrastorage.org/files/50c/a30/250/50ca30250b764e91bfa8692a2cd97d00.png"><br><br>  The PC has substituted 192.168.20.1 as the recipient address.  The remaining addresses of the transit devices were safely packed into the fields of the IP options (Source Route entries).  The destination device address is added to the Destination entry. <br><br>  The same package, after it passes R1: <br><br><img src="https://habrastorage.org/files/621/178/4a1/6211784a156e4689b81b1d7ba5e173bd.png"><br><br>  The sender's IP address remains unchanged.  Recipient's IP address changed to a new one - 192.168.31.1.  This value is taken from the Source Route field when the ICMP packet has just arrived at R1. <br><br>  It is important to note that R1 has added a new entry in the options field - Recorded Route.  There is substituted the IP address of the interface R1.  This field is required for the return packet (ICMP Echo reply) to return along the same route as the ICMP Echo request.  Similarly, will do the rest of the device.  Therefore, when the ICMP packet goes to R5, the Strict Source Route option will contain a list of IP addresses of interests through which the response packet must pass. <br><br>  ICMP Echo reply received by PC: <br><br><img src="https://habrastorage.org/files/db8/c20/edf/db8c20edf1f1439c970348814d31554d.png"><br><br>  The Recorded Route field is rewritten as the ICMP Echo reply packet proceeds, since there is always an outgoing interface address for the current packet.  Therefore, when R1 receives ICMP Echo reply, it will replace 192.168.31.2 with 192.168.20.1. <br><br>  If in the ping command we omit one of the addresses, for example, the last one (192.168.35.1 - R5), R4 will have to send the packet immediately to the device with the address 192.168.36.2.  But since this network is not local to it, R4 will report that the specified node is unreachable.  It will not route the packet normally. <br><br>  To handle the Record option on network equipment, source routing mode must be enabled.  For example, on Cisco hardware, it is enabled by default. <br><br>  <b>Loose (Loose Source Route)</b> <br><br>  This option is essentially very similar to the Strict option.  But, unlike Strict, in the Loose option, it is not the hard route of the ICMP packet that is set, but only selective devices.  Those.  The packet can be routed by other devices.  The maximum number of addresses is nine. <br><br>  The scheme of work is similar to the previous case.  The difference is that a packet with the Loose option can be routed by transit devices according to the usual rules. <br><br><img src="https://habrastorage.org/files/b9e/2dc/077/b9e2dc077e08422fb71f4110c5d3b29a.png"><br><br>  Run the ping utility with the -j (Loose Source Route) option in Windows OS and prescribe device addresses. <br><br><div class="spoiler">  <b class="spoiler_title">C: \ Users \ user&gt; ping -n 1 -j 192.168.32.1 192.168.36.2</b> <div class="spoiler_text"><pre> <code class="python hljs">   <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>   <span class="hljs-number"><span class="hljs-number">32</span></span>  :   <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>:  =<span class="hljs-number"><span class="hljs-number">32</span></span> =<span class="hljs-number"><span class="hljs-number">4</span></span> TTL=<span class="hljs-number"><span class="hljs-number">250</span></span> : <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.32</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>  Ping  <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.36</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>: :  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">1</span></span>,  = <span class="hljs-number"><span class="hljs-number">0</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>% )   -  :  = <span class="hljs-number"><span class="hljs-number">4</span></span>,  = <span class="hljs-number"><span class="hljs-number">4</span></span> ,  = <span class="hljs-number"><span class="hljs-number">4</span></span> </code> </pre> </div></div><br>  The ICMP Echo Request with the Loose Source Route option (Type = 131) in the IP header on our PC looks like this: <br><br><img src="https://habrastorage.org/files/67a/dc4/1f7/67adc41f79034c0ea4b4f8d881dcc793.png"><br><br>  The PC has substituted the address R3 (192.168.32.1) as the recipient.  In this case, the address of the end device R5 (192.168.36.2) indicated in the option IP (record Destination).  Next, the packet is routed to the network according to the usual rules, until it reaches R3.  R3 will substitute the address R5 as the destination address and, in the options, register its address through which the return packet should return (Recorded Route entry).  Then send it to the network. <br><br>  The ICMP Echo reply response packet is not of particular interest, since it is similar to the previously discussed.  In the options, the address of the outgoing R3 interface (Recorded Route entry) through which the packet passed is indicated. <br><br>  <b>Verbose</b> <br><br>  This option is activated automatically when you select any of the previously described.  Provides a more detailed display of information on the screen.  It does not affect the ICMP packet itself.  In Windows, there is no such option in the ping command. <br><br><hr><br>  So that we can take advantage of these options, the middleware must support them.  There will be no problem with this.  It is not necessary to attribute all this ‚Äúrocket science‚Äù to the innovations of the IT world.  The conclusion is: the options Loose, Strict, Record, Timestamp can be useful, even with the restriction of "nine".  If it were not for the following nuances related to security. <br><br>  <b>The first.</b>  The Record and Timestamp options can be safely used for online reconnaissance.  With their help, you can explore the network topology, get fingerprints, which determine the OS and the type of device through which the packet with these options passed. <br><br>  <b>The second.</b>  The Loose and Strict options allow you to control the movement of the packet, ignoring standard routing rules.  This provides ample opportunities for attempts to penetrate different network segments, where in the case of normal access routing should not be.  It is also possible to conduct intelligence to analyze the network topology.  Perform bandwidth utilization attacks on specific network segments.  There are many options. <br><br>  <b>Third.</b>  A part of network equipment processes packages with installed options programmatically at the control-plane level (without using various traffic routing optimization schemes), which unconditionally loads the CPU.  This means that it is possible to carry out a DoS attack on such a device. <br><br>  Many vendors (there is even a separate <a href="https://tools.ietf.org/html/rfc7126">RFC 7126</a> ) do not recommend packages with the specified options.  Options offer different.  Up to drop such packets.  True, some of the manufacturers have dissonances: on the one hand, we <a href="http://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html">recommend</a> discarding such packages, on the <a href="http://www.cisco.com/c/en/us/support/docs/ip/routing-information-protocol-rip/13730-ext-ping-trace.html">other hand</a> , ‚ÄúRecord is a very useful option‚Äù. <br><br>  A quick attempt to verify compliance with these recommendations with a couple of Internet providers showed that some of the options still work.  But source routing is disabled everywhere. <br><br>  It turns out an interesting conclusion.  Loose, Strict, Timestamp, Record options can be useful in diagnosing network problems.  But the issue of security levels it out. <br><br>  As a result, I still have a sense of misunderstanding.  Why the question sounded at the beginning was present in the test?  The Record option is relatively useful even if the network depth is shallow.  The remaining options are in question. <br><br>  Finally, a small survey.  Have a nice day, everyone! </div><p>Source: <a href="https://habr.com/ru/post/322386/">https://habr.com/ru/post/322386/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322374/index.html">Three-letter service quality</a></li>
<li><a href="../322376/index.html">Elixir and Angular 2 without Hello, world !, or Implementing work with the tree directory, part 1</a></li>
<li><a href="../322378/index.html">Warm up before the weekend: Raspberry Pi, Arduino and free evening</a></li>
<li><a href="../322380/index.html">NSRegularExpression and NSDataDetector - Quick Start</a></li>
<li><a href="../322384/index.html">Video of reports from Go 1.8 release party Moscow</a></li>
<li><a href="../322388/index.html">On the structure and scaling of complex applications for Node.JS</a></li>
<li><a href="../322390/index.html">25 Android libraries that are definitely worth using in early 2017</a></li>
<li><a href="../322392/index.html">Neural networks: practical application</a></li>
<li><a href="../322394/index.html">C #: 10 common pitfalls and bugs</a></li>
<li><a href="../322396/index.html">Happy birthday, Microsoft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>