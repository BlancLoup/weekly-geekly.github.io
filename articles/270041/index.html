<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Run iOS applications from the console on the device and simulator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article will briefly describe how to build an application with console commands and run on a real device and simulator without any need to open xc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Run iOS applications from the console on the device and simulator</h1><div class="post__text post__text-html js-mediator-article">  The article will briefly describe how to build an application with console commands and run on a real device and simulator without any need to open xcode for this. <br><br>  In general, it is worth starting with the fact that in my company there is a development ios department consisting of&gt; 10 people who work on a pack of applications.  To automate routine work, we had to deploy a CI server (for the time being, samopisny, due to special historical reasons (well, like everyone else), migration to jenkins is planned).  I refer to routine things as assembling projects, running tests (unless, of course, you write them), creating ipashki for testers and for laying out in the app store.  In general, I wanted it all to start working by clicking a button or a hook in a gita.  As long as everything works for us at the press of a button by the developer, about git so far only in the plans.  In this article I will only touch on the topic of compiling the project and packing it into an ipa file.  The functionality of launching projects on devices on the side of the CI server is still under development, but the packaging process itself has been in a ‚Äúbattle‚Äù for a long time, which can be useful. <br><br>  What we plan: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  build the application and run on the simulator </li><li>  let's collect ipa and run it on a real device </li><li>  let's collect ipa for the calculation on a market </li><li>  a little sub-build error </li></ul><a name="habracut"></a><br>  We have: <br><br><ul><li>  OS X 10.10.5 </li><li>  Xcode 7.1 </li></ul><br>  For the frequency of the experiment, we will use a third-party application so that dear readers can repeat what is described in the article.  We use the test application for the ResearchKit open-source Apple framework. <br><br><pre><code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ResearchKit/ResearchKit.git ~/Downloads/researchkit</code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Downloads/researchkit</code> </pre><br>  Before compiling the project, you must install the apple doc generator <a href="https://github.com/tomaz/appledoc">github.com/tomaz/appledoc</a> (there is a description of how to install). <br>  Go to the downloaded project.  The root project is the ResearchKit framework itself, the test application itself is in a different place, we go there: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> samples/ORKCatalog/</code> </pre><br>  We try to compile the application.  We are going to be a simulator, since for building a project for a simulator, no certificates / provisioning files are needed. <br><br><pre> <code class="bash hljs">xcodebuild -project ORKCatalog.xcodeproj -scheme ORKCatalog -arch x86_64 VALID_ARCHS=x86_64 -sdk iphonesimulator</code> </pre><br>  We get the error: <br><br><img src="https://habrastorage.org/files/e92/6ce/cba/e926cecba15d4eac86ae87a6254dbea7.png"><br><br>  Build falls, because there is no ORKCatalog scheme.  Since the scheme in the original project was not marked as shared, after the ‚Äúdrain‚Äù from the gita, xcode still does not know anything about this scheme, so that it bullies, you just need to open the project.  Therefore, simply open the project: <br><br><pre> <code class="bash hljs">open ORKCatalog.xcodeproj</code> </pre><br>  And immediately close, after our scheme appears, you can check the schemes through <u>xcodebuild -list</u> .  We try to collect again: <br><br><pre> <code class="bash hljs">xcodebuild -project ORKCatalog.xcodeproj -scheme ORKCatalog -arch x86_64 VALID_ARCHS=x86_64 -sdk iphonesimulator</code> </pre><br>  After seeing the long-awaited <u>** BUILD SUCCEEDED **</u> .  Great, it works. <br><br><h4>  Run the project on the simulator </h4><br>  We compile under the simulator, architectures can be i386 / x86_64.  Through SYMROOT we set the path to the result of the assembly: <br><br><pre> <code class="bash hljs"> xcodebuild -project ORKCatalog.xcodeproj -scheme ORKCatalog ARCHS=<span class="hljs-string"><span class="hljs-string">'x86_64 i386'</span></span> VALID_ARCHS=<span class="hljs-string"><span class="hljs-string">'x86_64 i386'</span></span> -sdk iphonesimulator -configuration Debug SYMROOT=$(<span class="hljs-built_in"><span class="hljs-built_in">pwd</span></span>)/build build</code> </pre><br>  <i>(Thoughts out loud: when I wrote the article, the compilation in the Release mode worked, before publishing the article I checked all the steps again and the compilation in this mode stopped working, so we are going to Debug, some of the recent commits broke it.)</i> <br><br>  After a successful build, we received the <u>ORKCatalog.app</u> file in <u>build / Debug-iphonesimulator /</u> .  It remains to run it on the simulator.  For this we will use the <b>ios-sim</b> utility <a href="https://github.com/phonegap/ios-sim">github.com/phonegap/ios-sim</a> .  To use it is quite simple. <br><br>  Get the list of available simulators: <br><br><pre> <code class="bash hljs">ios-sim showdevicetypes</code> </pre><br><img src="https://habrastorage.org/files/c8d/b65/5c3/c8db655c3adf4f5a980874954064a053.png"><br><br>  From the list, I chose the 'iPhone-6-Plus'.  Run the application on it: <br><br><pre> <code class="bash hljs">ios-sim --devicetypeid iPhone-6-Plus launch build/Debug-iphonesimulator/ORKCatalog.app</code> </pre><br>  If everything is done correctly, then the simulator with the application should start (to enter input mode in the console, use ctrl + C). <br><br><img src="https://habrastorage.org/files/393/08b/64f/39308b64fd6d41849d7c5f2ee8250bc7.png"><br><br><h4>  Creating an ipa file and running on a real device </h4><br>  It's a bit more complicated here, we need a mobileprovision file for development (developer) and the presence of a certificate on the machine (p12 file), and you don't need an xcode account.  When signing / packaging applications from the console, there is no need to add an account in xcode, it helps a lot, for example, you can keep only p12 files on a CI server. <br><br>  We assume that your machine has the appropriate certificate.  After we generate the developer mobileprovision through <a href="https://developer.apple.com/">developer.apple.com</a> in your account and download it to the machine (we give it the name test.mobileprovision, and the bundle id will be ru.habrahabr.test).  After copying it to the directory where xcode can pick it up: <br><br><pre> <code class="bash hljs">cp test.mobileprovision ~/Library/MobileDevice/Provisioning Profiles/</code> </pre><br>  Putting the archive under the device (this is the architecture of arm64 / armv7): <br><br><pre> <code class="bash hljs">xcodebuild -project ORKCatalog.xcodeproj -scheme ORKCatalog ARCHS=<span class="hljs-string"><span class="hljs-string">'arm64 armv7'</span></span> VALID_ARCHS=<span class="hljs-string"><span class="hljs-string">'arm64 armv7'</span></span> -sdk iphoneos -configuration Debug archive -archivePath build/archive</code> </pre><br>  The compilation will fall, since we have not yet registered our bundle id in the application and have not linked mobileprovision, the error will be the following: <br><br><img src="https://habrastorage.org/files/977/d95/e78/977d95e78803468e8fd8d8e56d5d7c3f.png"><br><br>  We will transfer the bundle id from the console + you need to register it in the Info.plist file.  Also, via the console, we will transmit a link to our mobileprovision.  Plist file is found on the path ORKCatalog / Supporting Files / Info.plist, in which for the key CFBundleIdentifier set the value ru.habrahabr.test.  Bundle id is passed through the key with the value of our id PRODUCT_BUNDLE_IDENTIFIER = ru.habrahabr.test.  The link to the mobileprovision is transmitted via the PROVISIONIG_PROFILE key, with the UUID value, which is registered in the mobileprovision. <br><br>  We get UUID: <br><br><pre> <code class="bash hljs">security cms -D -i test.mobileprovision | grep -o <span class="hljs-string"><span class="hljs-string">"\w\{8\}-\w\{4\}-\w\{4\}-\w\{4\}-\w\{12\}"</span></span></code> </pre><br>  The value will be similar to <u>87b0df89-793a-4a0f-92bf-c5f9c35f1405</u> .  Again, collect: <br><br><pre> <code class="bash hljs">xcodebuild -project ORKCatalog.xcodeproj -scheme ORKCatalog ARCHS=<span class="hljs-string"><span class="hljs-string">'arm64 armv7'</span></span> VALID_ARCHS=<span class="hljs-string"><span class="hljs-string">'arm64 armv7'</span></span> -sdk iphoneos -configuration Debug archive -archivePath build/archive PRODUCT_BUNDLE_IDENTIFIER=ru.habrahabr.test PROVISIONING_PROFILE=87b0df89-793a-4a0f-92bf-c5f9c35f1405</code> </pre><br>  As a result, we get the archive <u>build / archive.xcarchive</u> , which remains to be packaged in ipa.  In xcode 7, a new packaging method has appeared, and we will use it.  Before this we create a config file <u>options.plist</u> with the following content: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plist</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>method<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>development<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>uploadSymbols<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">false</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plist</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We try to collect ipa: <br><br><pre> <code class="bash hljs">xcodebuild -exportArchive -exportOptionsPlist options.plist -archivePath build/archive.xcarchive -exportPath build/dev-ipa/</code> </pre><br>  The assembly falls, according to the logs, you can understand that something with the entitlements: <br><br><img src="https://habrastorage.org/files/632/6ef/fa4/6326effa49e541de8ab98ded0f32a32b.png"><br><br>  By mistake, it is clear that the application is signing entitlements, the values ‚Äã‚Äãin which do not correspond to the values ‚Äã‚Äãin our mobileprovision, namely <u>com.apple.developer.healthkit</u> .  We are looking for the cause.  We look at how the entitlements are signed by the application: <br><br><pre> <code class="bash hljs">codesign -d --entitlements - build/archive.xcarchive/Products/Applications/ORKCatalog.app</code> </pre><br>  We get: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>application-identifier<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>XXXXX.ru.habrahabr.test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>beta-reports-active<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">true</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>com.apple.developer.healthkit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">true</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>com.apple.developer.team-identifier<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>XXXXX<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>get-task-allow<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">false</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plist</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We see that everything is OK, except for this: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>com.apple.developer.healthkit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">true</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  We don‚Äôt have this option in mobileprovision, we need to figure out where it came from: <br><br><pre> <code class="bash hljs">find ORKCatalog/ -name <span class="hljs-string"><span class="hljs-string">"*.entitlements"</span></span> -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f</code> </pre><br>  Search gave us <u>ORKCatalog / Supporitng Files / ORKCatalog.entitlements</u> .  See what's inside: <br><br><pre> <code class="bash hljs">cat ORKCatalog/Supporting Files/ORKCatalog.entitlements</code> </pre><br>  There is only one value: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plist</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>com.apple.developer.healthkit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">true</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plist</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Logically, you need to reload mobileprovision, to which you need to add this value, but we are lazy and for the test it is not necessary, we just need to re-sign the application with entitlements without this value. <br><br>  We have at least two options: <br><br>  1. Simply edit the existing entitlements (ORKCatalog / Supporitng Files / ORKCatalog.entitlements) and reassemble again (via archive). <br>  2. Without rebuilding, we rewrite ORKCatalog.app ourselves with the necessary entitlements. <br><br>  Choose the first option as more simple.  Therefore, from the <u>ORKCatalog / Supporitng Files / ORKCatalog.entitlements file,</u> simply delete the lines: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>com.apple.developer.healthkit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">true</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  and rebuild the archive again: <br><br><pre> <code class="bash hljs">xcodebuild -project ORKCatalog.xcodeproj -scheme ORKCatalog ARCHS=<span class="hljs-string"><span class="hljs-string">'arm64 armv7'</span></span> VALID_ARCHS=<span class="hljs-string"><span class="hljs-string">'arm64 armv7'</span></span> -sdk iphoneos -configuration Debug archive -archivePath build/archive PRODUCT_BUNDLE_IDENTIFIER=ru.habrahabr.test PROVISIONING_PROFILE=87b0df89-793a-4a0f-92bf-c5f9c35f1405</code> </pre><br>  After creating ipa: <br><br><pre> <code class="bash hljs">xcodebuild -exportArchive -exportOptionsPlist options.plist -archivePath build/archive.xcarchive -exportPath build/dev-ipa/</code> </pre><br>  We see the long-awaited message <u>** EXPORT SUCCEEDED **</u> .  Under the build / dev-ipa / ipa file will appear, which we will install on the device.  We will install on the device using <u>ios-deploy</u> <a href="https://github.com/phonegap/ios-deploy">github.com/phonegap/ios-deploy</a> .  We cling the device to the machine, we get the device id through: <br><br><pre> <code class="bash hljs">ios-deploy -c</code> </pre><br>  Deploy to device: <br><br><pre> <code class="bash hljs">ios-deploy -i &lt;device id&gt; -b build/dev-ipa/ORKCatalog.ipa</code> </pre><br><h4>  We collect ipa file for the market </h4><br>  Everything is the same as for the develop version, just change the link to the release mobileprovision, in the <u>options.plist</u> instead of <u>development we</u> put down the <u>app-store</u> (for other options you can add, see the xcodebuild -help help). <br><br><h4>  Total </h4><br>  Without using xcode, I could collect ipa files for tests and for display in the app store.  All this can be easily automated on the CI server to make life easier for developers. <br><br>  PS: It is worth noting that for the process of compiling / signing applications with a complex structure, when several targets and each require their own separate mobileprovision file (applications with extension, clock, embedded framework), the above described process will not work without a file. </div><p>Source: <a href="https://habr.com/ru/post/270041/">https://habr.com/ru/post/270041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270023/index.html">Introduction to RxJava: Key Types</a></li>
<li><a href="../270027/index.html">Why ‚Äúerrors are meanings‚Äù in Go</a></li>
<li><a href="../270031/index.html">NSNJSON. ÈÅì (Final article)</a></li>
<li><a href="../270033/index.html">Dagaz: Halfway</a></li>
<li><a href="../270039/index.html">Creating Gesture Recognition Web Applications with the Intel RealSense SDK</a></li>
<li><a href="../270045/index.html">Office as Platform: publish the SharePoint application in the Office Store</a></li>
<li><a href="../270047/index.html">Idea for handling errors in Go</a></li>
<li><a href="../270049/index.html">Retrieving deleted data in iOS</a></li>
<li><a href="../270051/index.html">We work with Xamarin: development experience on two projects</a></li>
<li><a href="../270053/index.html">Do not cos from development on Cach√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>