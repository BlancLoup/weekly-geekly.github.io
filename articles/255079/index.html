<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Freemasons choose the sun: a hacking program for Sun Solaris & SPARC in the task NeoQUEST-2015</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Leaving the usual x86 architecture is always interesting, and in the NeoQUEST-2015 ‚ÄúFreemasons choose the sun‚Äù task, participants were asked to hack a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Freemasons choose the sun: a hacking program for Sun Solaris & SPARC in the task NeoQUEST-2015</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/2c0/578/b7a/2c0578b7a0a1409ea270b991c2a319c9.jpg">  Leaving the usual x86 architecture is always interesting, and in the <a href="http://neoquest.ru/timeline.php%3Fyear%3D2015">NeoQUEST-2015</a> ‚ÄúFreemasons choose the sun‚Äù task, participants were asked to hack a program that was developed and written for the Sun Solaris 2.6 version of 1995, and even for the SPARC architecture! <br><br>  The task turned out to be difficult not only for passing - its preparation also took some time.  Under the cut: <br><ul><li>  Solaris installation tips: how to do this by minimizing labor costs? </li><li>  Running Solaris 2.6 under qemu for Windows 8.1 </li><li>  Detailed analysis of two ways to complete the task </li></ul><br><a name="habracut"></a><br><h4>  <b>We study the source data to the task</b> </h4><br>  Two binary files were given as input data in the task: a small getlaunchkey.bin and image.img, which occupies 2GB.  In addition, the text of the task included the name <b>Ivanov</b> and the IP address <b>79.175.2.82</b> . <br><br>  While the two-gigabyte disk is swinging, let's take a look at the small file getlaunchkey.bin.  By ELF signature it quickly becomes clear what kind of file it is.  The readelf ‚Äìa getlaunchkey.bin utility tells us a few useful facts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First, from the header it is clear that the program is for System V, and the architecture of the sparc x32 bit is big endian: <br><br><img src="https://habrastorage.org/files/2b1/b67/935/2b1b67935e104589bace0214748c147a.jpg"><br><br>  Secondly, from the remaining symbol table in the file, it can be seen that the program uses sockets, and contains the SHA code.  The rest is small and simple program: <br><br><img src="https://habrastorage.org/files/eba/982/db0/eba982db032046618d453b42e6d63624.jpg"><br><br><img src="https://habrastorage.org/files/857/f71/974/857f7197474b4048a1ddcdccec2da62f.jpg"><br><br>  If you analyze the contents of a binary file, you can easily find in it two IP addresses: 192.168.1.88 and 192.168.1.22, which are present as strings.  Given that the program obviously works with sockets, and the executable file is small, you can make two assumptions: <br><br><ol><li>  Both addresses are the addresses of the servers accessed by the application; </li><li>  One address is the address of the host computer, and the second is the server address. </li></ol><br>  In addition, both addresses belong to the local network, which means that they cannot be used in their original form, they must be replaced with some other ones. <br>  The second file, image.img, is clearly similar to a hard disk due to its size.  At the beginning of the file there is the QFI signature, which, with fast googling, gives us information that this is the <a href="http://en.wikipedia.org/wiki/Qcow">QCOW</a> format used for dynamic hard disk images. <br><br>  In particular, this format is used in the qemu emulator.  If you rummage through the image in a hex editor (or use a utility like strings), you can quickly find strings like ‚ÄúSolaris_2.6‚Äù, in addition, there is a string ‚Äúgetlaunchkey‚Äù. <br><br>  From the above, we can conclude that we got the image of the installed Solaris version 2.6, and, apparently, the version of sparc, and the program for this operating system.  With the program we have to figure it out.  Now there are two ways: try to run the Solaris image in qemu, or try to write an analogue of the getlaunchkey program for Windows. <br><br><h4>  <b>Run Solaris 2.6 on Windows 8.1</b> </h4><br>  First, let's start Solaris.  If you download and install <a href="http://qemu.weilnetz.de/w32/">qemu for Windows</a> , then it will include a version that emulates sparc.  We try to run the image: <br><br><pre><code class="hljs tex">"c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Program</span></span></span></span> Files (x86)<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu</span></span></span></span>-system-sparc.exe" ‚Äìhda .<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span></span>.img</code> </pre> <br><br>  And make sure it doesn't work.  Now we try to google and find a couple of interesting articles (the <a href="http://tyom.blogspot.ru/2009/12/solaris-under-qemu-how-to.html">first</a> and the <a href="http://brezular.com/2012/02/12/installation-solaris-sparc-2-6-sunos-5-6-on-qemu-part-1-qemu-installation/">second</a> ), which tells you how to run Solaris 2.6 under qemu: <br><br>  As a result of studying these articles, you can form the following launch line: <br><br><pre> <code class="hljs css"> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">c</span></span>:\<span class="hljs-selector-tag"><span class="hljs-selector-tag">Program</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Files</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">x86</span></span>)\<span class="hljs-selector-tag"><span class="hljs-selector-tag">qemu</span></span>\<span class="hljs-selector-tag"><span class="hljs-selector-tag">qemu-system-sparc</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">-bios</span></span> .\<span class="hljs-selector-tag"><span class="hljs-selector-tag">ss5-1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-L</span></span> .\ ‚Äì<span class="hljs-selector-tag"><span class="hljs-selector-tag">hda</span></span> .\<span class="hljs-selector-tag"><span class="hljs-selector-tag">image</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.img</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-m</span></span> 256 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-M</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SS-5</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-nographic</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-serial</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mon</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:telnet</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:127.0.0.1</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:4444</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">server</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">nowait</span></span></code> </pre><br><br>  Let us analyze these options in more detail: <br><br><ul><li>  bios. \ ss5-1.bin - requires qemu to use the specified BIOS image.  It turns out that the standard BIOS image for sparc from qemu is not suitable for Solaris 2.6 sparc.  The image itself can be downloaded <a href="">here.</a> </li><li>  hda. \ image.img - specify the disk image from which to boot.  By the way, you need to remember to remove the Read Only bit from the image file, otherwise qemu will not work (usually in Windows it will not even tell about the error) </li><li>  m 256 - set the size of the RAM (256 megabytes for the version of OS 1995 is enough) </li><li>  M SS-5 - for qemu we specify the type of the emulated sparc architecture </li><li>  nographic is a very important option.  In qemu, it turns out, the graphics adapter is emulated with errors, as a result of Solaris 2.6, trying to use graphics, hangs when loading </li><li>  serial mon: telnet: 127.0.0.1: 4444, server, nowait - since we turned off the graphics adapter, qemu cannot display anything on the screen, instead it can display a simple COM terminal to the network using the telnet protocol.  The option enables the redirection of the COM emulator to the specified device. </li></ul><br>  If you do not use the last two options, then qemu will launch a graphical window: <br><br><img src="https://habrastorage.org/files/6dd/865/5a3/6dd8655a304f4fd59c2a503cecd3cb76.jpg"><br><br>  But after a long download, it will first hang for a few minutes, and then reboot on a screen like this: <br><br><img src="https://habrastorage.org/files/c2e/eb2/ae7/c2eeb2ae7b144caf87d6bb11f048b8ec.jpg"><br><br>  So, we run the command, and we make sure that everything is stuck on the command line - it means that the virtual machine has started.  Now, to see the running OS, you need to connect to telnet: 127.0.0.1: 4444 using <a href="http://www.putty.org/">putty</a> .  As a result, in the putty console we will see the following text (just in case, you need to press Enter in the console, otherwise the screen will not update): <br><br><pre> <code class="hljs kotlin">Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Probing Memory Bank #<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> Megabytes Incorrect configuration checksum; Setting NVRAM parameters to <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> values. Setting diag-switch? NVRAM parameter to <span class="hljs-literal"><span class="hljs-literal">true</span></span> Probing CPU FMI,MB86904 Probing /<span class="hljs-symbol"><span class="hljs-symbol">iommu@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10000000</span></span>/<span class="hljs-symbol"><span class="hljs-symbol">sbus@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10001000</span></span> at <span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> espdma esp sd st SUNW,bpp ledma le Probing /<span class="hljs-symbol"><span class="hljs-symbol">iommu@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10000000</span></span>/<span class="hljs-symbol"><span class="hljs-symbol">sbus@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10001000</span></span> at <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> SUNW,CS4231 power-management Probing /<span class="hljs-symbol"><span class="hljs-symbol">iommu@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10000000</span></span>/<span class="hljs-symbol"><span class="hljs-symbol">sbus@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10001000</span></span> at <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Nothing</span></span> there Probing /<span class="hljs-symbol"><span class="hljs-symbol">iommu@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10000000</span></span>/<span class="hljs-symbol"><span class="hljs-symbol">sbus@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10001000</span></span> at <span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Nothing</span></span> there Probing /<span class="hljs-symbol"><span class="hljs-symbol">iommu@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10000000</span></span>/<span class="hljs-symbol"><span class="hljs-symbol">sbus@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10001000</span></span> at <span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> SUNW,tcx Probing /<span class="hljs-symbol"><span class="hljs-symbol">iommu@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10000000</span></span>/<span class="hljs-symbol"><span class="hljs-symbol">sbus@</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10001000</span></span> at <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Nothing</span></span> there SPARCstation <span class="hljs-number"><span class="hljs-number">5</span></span>, No Keyboard ROM Rev. <span class="hljs-number"><span class="hljs-number">2.15</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span> MB memory installed, Serial #<span class="hljs-number"><span class="hljs-number">1193046</span></span>. Ethernet address <span class="hljs-number"><span class="hljs-number">52</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span>, Host ID: <span class="hljs-number"><span class="hljs-number">80123456</span></span>. Boot device: /iommu/sbus/<span class="hljs-symbol"><span class="hljs-symbol">ledma@</span></span><span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">8400010</span></span>/<span class="hljs-symbol"><span class="hljs-symbol">le@</span></span><span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>c00000 File and args: Internal loopback test -- Wrong packet length; expected <span class="hljs-number"><span class="hljs-number">36</span></span>, observed <span class="hljs-number"><span class="hljs-number">64</span></span> Can<span class="hljs-string"><span class="hljs-string">'t open boot device Type help for more information ok</span></span></code> </pre><br><br>  And now what i can do?  From the same articles we learn that we need to type a command for the BIOS: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">boot</span></span> disk0:</code> </pre><br><br>  Now we are waiting for Solaris 2.6 to load.  This may take a few minutes ... We look forward to and believe in the operating system of 1995! <br>  As a result, the download will be asked to login and password.  By a simple search, we find out that the login is: root, and the password is 123456. Not everything is very securely configured, is it? <br><br><pre> <code class="hljs pgsql">zvezda console <span class="hljs-keyword"><span class="hljs-keyword">login</span></span>: root <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span>: Last <span class="hljs-keyword"><span class="hljs-keyword">login</span></span>: Thu Jun <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>:<span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> console Sun Microsystems Inc. SunOS <span class="hljs-number"><span class="hljs-number">5.6</span></span> Generic August <span class="hljs-number"><span class="hljs-number">1997</span></span> # ls bin devices kernel opt tmp cdrom etc lib platform usr core export lost+<span class="hljs-built_in"><span class="hljs-built_in">found</span></span> proc var dev home mnt sbin vol #</code> </pre><br><br><h4>  <b>Only the getlaunchkey program is found on Solaris.</b> </h4><br>  We are convinced that the usual commands ls, ps, ... work. If you delve into the system (Solaris), you can find a lot of interesting things, for example: <br><br><pre> <code class="hljs pgsql">GCC <span class="hljs-number"><span class="hljs-number">3.4</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span>: # /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/bin/gcc -v Reading specs <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/lib/gcc/sparc-sun-solaris2<span class="hljs-number"><span class="hljs-number">.6</span></span>/<span class="hljs-number"><span class="hljs-number">3.4</span></span><span class="hljs-number"><span class="hljs-number">.6</span></span>/specs Configured <span class="hljs-keyword"><span class="hljs-keyword">with</span></span>: ../configure <span class="hljs-comment"><span class="hljs-comment">--with-as=/usr/ccs/bin/as --with-ld=/usr/ccs/bin/ld --enable-shared --enable-languages=c,c++,f77 Thread model: posix gcc version 3.4.6 MC: # /usr/local/bin/mc Left File Command Options Right +&lt;-~---------------------------------v&gt;++&lt;-~---------------------------------v&gt;+ | Name | Size | MTime || Name | Size | MTime | |/.mc | 512|Jun 13 2014||/.mc | 512|Jun 13 2014| |~bin | 9|Jun 13 1998||~bin | 9|Jun 13 1998| |/cdrom | 512|Jun 19 2014||/cdrom | 512|Jun 19 2014| |/dev | 3072|Mar 30 07:43||/dev | 3072|Mar 30 07:43| |/devices | 512|Jun 13 1998||/devices | 512|Jun 13 1998| |/etc | 3072|Mar 30 08:04||/etc | 3072|Mar 30 08:04| |/export | 512|Jun 13 1998||/export | 512|Jun 13 1998| |/home | 512|Jun 19 2014||/home | 512|Jun 19 2014| |/kernel | 512|Jun 13 1998||/kernel | 512|Jun 13 1998| |~lib | 9|Jun 13 1998||~lib | 9|Jun 13 1998| |/lost+found | 8192|Jun 13 1998||/lost+found | 8192|Jun 13 1998| |/mnt | 512|Jun 13 1998||/mnt | 512|Jun 13 1998| |/opt | 512|Jun 13 1998||/opt | 512|Jun 13 1998| |/platform | 512|Jun 13 1998||/platform | 512|Jun 13 1998| |/proc | 65216|Mar 30 08:13||/proc | 65216|Mar 30 08:13| +--------------------------------------++--------------------------------------+ |/.mc ||/.mc | +--------------------------------------++--------------------------------------+ Hint: If you want to see your .* files, say so in the Configuration dialog. # WARNING: processor level 12 onboard interrupt not serviced 1Help 2Menu 3View 4Edit 5Copy 6RenMov 7Mkdir 8Del</span></span></code> </pre><br><br>  Looking through the various directories, you can find the file / home / solaris / getlaunchkey.  We try to run the program.  She asks us to enter a username and password.  Simple search does not give anything. <br><br><pre> <code class="hljs pgsql"># /home/solaris/getlaunchkey <span class="hljs-keyword"><span class="hljs-keyword">Login</span></span>: root <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span>: <span class="hljs-number"><span class="hljs-number">123456</span></span> Wrong <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>!# /home/solaris/getlaunchkey <span class="hljs-keyword"><span class="hljs-keyword">Login</span></span>: ivanov <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span>: <span class="hljs-number"><span class="hljs-number">123456</span></span> Wrong <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>!#</code> </pre><br><br><h4>  <b>Getlaunchkey preview reversal</b> </h4><br>  Let's try to hack the program: let's reverse the getlaunchkey program.  When parsing this program in IDA, everything looks simple.  At the beginning, the program collects the password and username: <br><br><img src="https://habrastorage.org/files/89d/da9/45e/89dda945eb0b4cd996010f5a4f769810.jpg"><br><br>  It is then considered SHA from the password and compared with the hard-coded value.  If the value of the SHA hash is the same, then the program works further, otherwise it terminates: <br><br><img src="https://habrastorage.org/files/c95/cf4/2e8/c95cf42e88ea4cf38355ae8072a02760.jpg"><br><br>  Then comes the typical setup of sockets, which contains the send address (host with Solaris 2.6) <br><br><img src="https://habrastorage.org/files/b2d/46e/6cf/b2d46e6cf1884b5f9105cfaed8296f98.jpg"><br><br>  and the address of the recipient (some server): <br><br><img src="https://habrastorage.org/files/bd8/886/ba6/bd8886ba6cf14565b5225ff480726a80.jpg"><br><br>  This uses port 9930: <br><br><img src="https://habrastorage.org/files/277/cff/6ab/277cff6ab8ab402d8e33ef2bed1a376c.jpg"><br><br>  Further, you will notice that the program performs a series of operations and performs several calls to the server and receives answers, and then prints the answer to the screen. <br>  Now that the approximate algorithm of the program is known, there are two ways to solve it: <br><ol><li>  Write a similar C program under Windows / Linux and try to run it. </li><li>  Correct the two IP addresses and the decision about the hash of the entered password, then execute the corrected program in Solaris 2.6 and see the result. </li></ol><br><br><h4>  <b>Method number 1.</b>  <b>Full reverse of the application and writing your program that works similarly</b> </h4><br>  If you act in the first way, you need to analyze the application algorithm in detail and try to write a program that duplicates this functionality.  Let's try to do it. <br><br><h5>  <b>Analysis of the program operation getlaunchkey</b> </h5><br>  In case of successful network initialization, the program performs a series of calculations with a string with the user name: <br><br><img src="https://habrastorage.org/files/d18/c64/1d7/d18c641d71a546689c0ed9af96af1196.jpg"><br><br>  The diagram shows the following: <br><ul><li>  first, a kind of ‚Äúscary‚Äù string falls into the local variable buf (1); </li><li>  then a cycle is performed according to the length of the username (2) within which some calculations (3) take place; </li><li>  as a result of the change, buf is sent to the network at the specified address (5). </li></ul><br><br>  Consider the block (3) in more detail. <br><br><img src="https://habrastorage.org/files/d8d/6f7/15c/d8d6f715cd5c4ff7b5ebfc1408d3941e.jpg"><br><br>  The essence of the calculations in the block is as follows: at the beginning there are three identical blocks with instructions (1, 2, 3) that load data from memory into registers (ld), and two additions (add) that calculate the index in the array relative to char_number .  As a result, the same indices are formed in the registers o3, o4 and g1, most likely equal to the current element number in the array relative to fp (Frame Pointer is the pointer of the current stack frame). <br><br>  The index number is equal to the iteration of the outer loop.  Then the registers o5 and g1 are written to the values ‚Äã‚Äãfrom the memory at offsets 0x1F0 and 0x40 (4).  The indicated offsets correspond to two local arrays.  These arrays correspond to the username read and the buffer to which the scary string was copied.  Next, the code executes the btog (5) instruction.  After this, the result of the operation btog (register g1) is written back to the memory of the array 0x1F0 (instruction stb) (6).  Then the value of the variable char_number is increased by 1 (inc) (7).  The last part of the block simply goes to the next iteration of the loop (8). <br><br>  It remains to find out what the instruction btog?  Let's use Google and find a list of Sparc instructions (for example, <a href="https://www.cs.tufts.edu/~nr/toolkit/specs/sparc.html">here</a> ).  It says the following: <br><br><pre> <code class="hljs dos">btog reg_or_imm, <span class="hljs-built_in"><span class="hljs-built_in">rd</span></span> is XOR (<span class="hljs-built_in"><span class="hljs-built_in">rd</span></span>, reg_or_imm, <span class="hljs-built_in"><span class="hljs-built_in">rd</span></span>)</code> </pre><br><br>  The essence of the remaining instructions can also be read in the specified source.  Thus, the code block (3) corresponds approximately to the following code: buf [char_number] ^ = user_name [char_number]. <br>  The rest of the program is waiting for a response from the server: <br><br><img src="https://habrastorage.org/files/b22/65f/695/b2265f6950af4e63907f132a4ef8039c.jpg"><br><br>  Then, for the received response, it performs again the XOR (2) with the username (1), as a result of which the key (3) is obtained: <br><br><img src="https://habrastorage.org/files/973/3a0/7d8/9733a07d82da4b0fac511352af765ec1.jpg"><br><br>  So the program repeats several times by the number of attempts.  As a result, completes its work. <br><br><img src="https://habrastorage.org/files/8e6/bd0/7fb/8e6bd07fb6a5431899d3ca93c40f90ea.jpg"><br><br><h5>  <b>Program code written following the getlaunchkey reverse</b> </h5><br>  As a result of the work done on the reverse, you get something like this code: <br><br><pre> <code class="hljs lua">#define SRV_IP <span class="hljs-string"><span class="hljs-string">"79.175.2.82"</span></span> #define CLIENT_IP <span class="hljs-string"><span class="hljs-string">"192.168.1.2"</span></span> int main() { <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> login_buf[<span class="hljs-number"><span class="hljs-number">64</span></span>]; int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; memset(login_buf, <span class="hljs-number"><span class="hljs-number">0</span></span>, sizeof(login_buf)); printf(<span class="hljs-string"><span class="hljs-string">"\nLogin: "</span></span>); scanf(<span class="hljs-string"><span class="hljs-string">"%s"</span></span>, login_buf); printf(<span class="hljs-string"><span class="hljs-string">"\nTry to get Key for %s..."</span></span>, login_buf); int <span class="hljs-built_in"><span class="hljs-built_in">len</span></span> = sizeof(struct sockaddr_in); struct sockaddr_in si_other, si_my; int s, i, slen = sizeof(si_other); <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> buf[<span class="hljs-number"><span class="hljs-number">128</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((s = socket(AF_INET, SOCK_DGRAM, <span class="hljs-number"><span class="hljs-number">0</span></span>)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { printf(<span class="hljs-string"><span class="hljs-string">"\nError 1"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>); } memset((<span class="hljs-built_in"><span class="hljs-built_in">char</span></span> *) &amp;si_other, <span class="hljs-number"><span class="hljs-number">0</span></span>, sizeof(si_other)); si_other.sin_family = AF_INET; si_other.sin_port = htons(<span class="hljs-number"><span class="hljs-number">9930</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inet_aton(SRV_IP, &amp;si_other.sin_addr) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { fprintf(<span class="hljs-built_in"><span class="hljs-built_in">stderr</span></span>, <span class="hljs-string"><span class="hljs-string">"inet_aton() failed\n"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); } memset((<span class="hljs-built_in"><span class="hljs-built_in">char</span></span> *) &amp;si_my, <span class="hljs-number"><span class="hljs-number">0</span></span>, sizeof(si_my)); si_my.sin_family = AF_INET; si_my.sin_port = htons(<span class="hljs-number"><span class="hljs-number">9930</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inet_aton(CLIENT_IP, &amp;si_my.sin_addr) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { fprintf(<span class="hljs-built_in"><span class="hljs-built_in">stderr</span></span>, <span class="hljs-string"><span class="hljs-string">"inet_aton() failed\n"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bind(s, &amp;si_my, <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>)&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>) { printf(<span class="hljs-string"><span class="hljs-string">"bind failed\n"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); } int j = <span class="hljs-number"><span class="hljs-number">0</span></span>; printf(<span class="hljs-string"><span class="hljs-string">"\nSending request for key #%d"</span></span>, i); sprintf(buf, <span class="hljs-string"><span class="hljs-string">"yugJHyGUgtygjgftTVHftyfHgETKeY"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; strlen(login_buf); j++) { buf[j] ^= (<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>)login_buf[j]; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sendto(s, buf, <span class="hljs-number"><span class="hljs-number">128</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, &amp;si_other, slen)==<span class="hljs-number"><span class="hljs-number">-1</span></span>) { printf(<span class="hljs-string"><span class="hljs-string">"\nError 2: sendto"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>); } slen = sizeof(si_other); printf(<span class="hljs-string"><span class="hljs-string">"\nWaiting for answer..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (recvfrom(s, buf, <span class="hljs-number"><span class="hljs-number">128</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, &amp;si_other, &amp;slen)==<span class="hljs-number"><span class="hljs-number">-1</span></span>) { printf(<span class="hljs-string"><span class="hljs-string">"Error 3: recvfrom"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; strlen(login_buf); j++) { buf[j] ^= (<span class="hljs-built_in"><span class="hljs-built_in">char</span></span>)login_buf[j]; } printf(<span class="hljs-string"><span class="hljs-string">"\nLaunch Key Received: %s\n\n"</span></span>, buf); <span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(s); }</code> </pre><br><br>  The specified code can now be compiled in Windows or Linux and run.  After the launch, the user name (ivanov) is entered, after the data exchange with the server, the program will print the response key. <br><br>  Such a path takes a lot of time to study the code on the relatively exotic architecture of sparc. <br><br><h4>  <b>Method number 2.</b>  <b>Fixing the program and running it in Solaris 2.6.</b> </h4><br>  Let's try to go through the second path.  First, you need to solve two questions: how to upload the corrected file on Solaris 2.6 and how then to ensure the operation of the network so that the program works fine?  As a result of a short study, we learn that in addition to all programs, there is an ftp client on Solaris 2.6, with which you can share Windows files with Solaris.  Now it's up to you: configure network access for a virtual machine. <br><br><h5>  <b>Configuring Network Access for a Virtual Machine</b> </h5><br>  To do this, we study another <a href="http://en.wikibooks.org/wiki/QEMU/Networking">article</a> in the section ‚ÄúStarting QEMU with a TAP interface‚Äù and try to configure everything via the vpn bridge.  Probably, it can be somehow simpler, but, as indicated further, the network works.  The action algorithm for Windows is as follows: <br><br><ol><li>  Download <a href="https://openvpn.net/index.php/open-source/downloads.html">openvpn</a> program.  We tested on the version: openvpn-install-2.3.4-I002-x86_64.exe </li><li>  Rename the adapter with the ‚ÄúTAP-Windows Adapter V9‚Äù type to something short like tap1. </li><li>  We create a bridge in ‚ÄúControl Panel \ Network and Internet \ Network Connections‚Äù between the network adapter that is connected to the Internet and the new virtual network adapter ‚ÄúTAP-Windows Adapter V9‚Äù. <br><br><img src="//habrastorage.org/files/be4/910/edc/be4910edc40749cc8343f2217a34353e.jpg"></li><li>  We supplement the qemu startup line with arguments: <b>-net nic -net tap, ifname = tap1,</b> and start the qemu virtual machine again with the line: </li></ol><br><pre> <code class="hljs tex">"c:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Program</span></span></span></span> Files (x86)<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qemu</span></span></span></span>-system-sparc.exe" -bios .<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ss</span></span></span></span>5-1.bin -L .<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>‚Äìhda .<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span></span>.img -m 256 -M SS-5 -nographic -serial mon:telnet:127.0.0.1:4444,server,nowait -net nic -net tap,ifname=tap1</code> </pre><br><br>  Now again we load Solaris through putty, login and configure the network.  The name of the network interface could be seen at boot time: <br><br><pre> <code class="hljs xml">Copyright (c) 1983-1997, Sun Microsystems, Inc. configuring network interfaces: le0. Hostname: zvezda <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\source</span></span></span><span class="hljs-tag">&gt;</span></span>     ifconfig le0: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c"</span></span></span><span class="hljs-tag">&gt;</span></span> # ifconfig le0 le0: flags=863<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UP,BROADCAST,NOTRAILERS,RUNNING,MULTICAST</span></span></span><span class="hljs-tag">&gt;</span></span> mtu 1500 inet 192.168.1.88 netmask ffffff00 broadcast 192.168.1.255 ether 52:54:0:12:34:56</code> </pre><br><br>  Pay attention to the network configuration: the static IP address is set to 192.168.1.88, which is also present in the program, as it was found out earlier.  Therefore, one address in the program corresponds to the local address, and it must be replaced with the new local address, after ARP has been processed.  The second address (192.168.1.22) corresponds to the address of the server to which the request is sent, therefore, it must be replaced with the address 79.175.2.82 given to us in the condition. <br><br>  If necessary, set the correct IP address and gateway address for your local network.  For example, you can configure it automatically ( <a href="http://thegeekdiary.com/examples-of-adding-static-routes-in-solaris/">this article</a> will be useful here): <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">ifconfig</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">le0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">auto-dhcp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">route</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">default</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span></code> </pre><br><br>  Check the settings again with the ifconfig le0 command: <br><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta"># ifconfig le0 le0: flags=863</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;UP,BROADCAST,NOTRAILERS,RUNNING,MULTICAST&gt;</span></span></span><span class="hljs-meta"> mtu 1500 inet 192.168.1.12 netmask ffffff00 broadcast 192.168.1.255 ether 52:54:0:12:34:56</span></span></code> </pre><br><br>  Now check ping 8.8.8.8 and ping 79.175.2.82.  If everything is set up normally, we get the following result: <br><br><pre> <code class="hljs css"># <span class="hljs-selector-tag"><span class="hljs-selector-tag">ping</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">is</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">alive</span></span> # <span class="hljs-selector-tag"><span class="hljs-selector-tag">ping</span></span> 79<span class="hljs-selector-class"><span class="hljs-selector-class">.175</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.82</span></span> 79<span class="hljs-selector-class"><span class="hljs-selector-class">.175</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.82</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">is</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">alive</span></span></code> </pre><br><br>  To provide communication with Windows, it is possible to put on the Windows FTP server.  Then, using the ftp client on Solaris 2.6, you can exchange data. <br><br><h5>  <b>Modification of the getlaunchkey program</b> </h5><br>  Let's get back to the getlaunchkey program.  If you do not study in detail the algorithm of the program, then for its normal operation it is required to perform only three modifications of the binary file of the getlaunchkey program: <br><ol><li>  change the line with the host address ‚Äú192.168.1.88‚Äù -&gt; ‚Äú192.168.1.12‚Äù </li><li>  change the line with the host address ‚Äú192.168.1.22‚Äù -&gt; ‚Äú79.175.2.82‚Äù </li><li>  change the result of the solution after checking the password. </li></ol><br>  The first replacements are trivial, using a hex editor.  The last replacement must be done by modifying the code for the sparc instruction.  If you pay attention, the transition after checking cmp is carried out by the instruction be (branch equal), which means that this instruction should be replaced with the instruction bne (branch not equal).  The opcode of the required instruction can be seen through IDA further along the code: <br><br><img src="//habrastorage.org/files/00c/4b0/a4d/00c4b0a4dc6f4b0690f3f87eeb2956f6.jpg"><br><br>  Thus, you just need to change byte 0x02 to byte 0x12 at offset 0x1084 (0x11084 - 0x10000): <br><br><img src="//habrastorage.org/files/d7d/54b/421/d7d54b421f814fa4bfe47a7fdb008132.jpg"><br><br>  Now it is time to copy the modified getlaunchkey2.bin back to Solaris via ftp and execute it.  A Windows host has an IP address of 192.168.1.3.  For normal ftp operation, you need to remember to enable the binary type of the transmitted data, otherwise everything is done quite simply: <br><br><pre> <code class="hljs pgsql"># ifconfig le0 le0: flags=<span class="hljs-number"><span class="hljs-number">4863</span></span>&lt;UP,BROADCAST,NOTRAILERS,RUNNING,MULTICAST,DHCP&gt; mtu <span class="hljs-number"><span class="hljs-number">1500</span></span> <span class="hljs-type"><span class="hljs-type">inet</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.12</span></span> netmask ffffff00 broadcast <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span> ether <span class="hljs-number"><span class="hljs-number">52</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">56</span></span> # ftp <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span> Connected <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>. <span class="hljs-number"><span class="hljs-number">220</span></span>-FileZilla <span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-keyword"><span class="hljs-keyword">version</span></span> <span class="hljs-number"><span class="hljs-number">0.9</span></span><span class="hljs-number"><span class="hljs-number">.45</span></span> beta <span class="hljs-number"><span class="hljs-number">220</span></span>-written <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> Tim Kosse (tim.kosse@filezilla-project.org) <span class="hljs-number"><span class="hljs-number">220</span></span> Please visit http://sourceforge.net/projects/filezilla/ <span class="hljs-type"><span class="hljs-type">Name</span></span> (<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>:root): guest <span class="hljs-number"><span class="hljs-number">331</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span> required <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> guest <span class="hljs-keyword"><span class="hljs-keyword">Password</span></span>: <span class="hljs-number"><span class="hljs-number">230</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Logged</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ftp&gt; binary <span class="hljs-number"><span class="hljs-number">200</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> I ftp&gt; <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> getlaunchkey2.bin <span class="hljs-number"><span class="hljs-number">200</span></span> Port command successful <span class="hljs-number"><span class="hljs-number">150</span></span> Opening data channel <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> file download <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> "/getlaunchkey2.bin" <span class="hljs-number"><span class="hljs-number">226</span></span> Successfully transferred "/getlaunchkey2.bin" <span class="hljs-keyword"><span class="hljs-keyword">local</span></span>: getlaunchkey2.bin remote: getlaunchkey2.bin <span class="hljs-number"><span class="hljs-number">25228</span></span> bytes received <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.0039</span></span> seconds (<span class="hljs-number"><span class="hljs-number">6389.19</span></span> Kbytes/s) ftp&gt; quit <span class="hljs-number"><span class="hljs-number">221</span></span> Goodbye # ls -l total <span class="hljs-number"><span class="hljs-number">100</span></span> -rwxr-xr-x <span class="hljs-number"><span class="hljs-number">1</span></span> root other <span class="hljs-number"><span class="hljs-number">25228</span></span> Jun <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">2014</span></span> getkey -rw-r<span class="hljs-comment"><span class="hljs-comment">--r-- 1 root other 25228 Apr 1 06:25 getlaunchkey2.bin # chmod 777 ./getlaunchkey2.bin # ls -l total 100 -rwxr-xr-x 1 root other 25228 Jun 19 2014 getkey -rwxrwxrwx 1 root other 25228 Apr 1 06:25 getlaunchkey2.bin # ./getlaunchkey2.bin Login: ivanov Password:123 Try to get Key for ivanov... Sending request for key #0 Waiting for answer... Launch Key Received: a24214rf143sdfsf</span></span></code> </pre><br><br>  As you can see, the program displayed the key, which was needed for the passage of the task! <br><br><h4>  <b>Solaris 2.6 Installation Tips</b> </h4><br>  When preparing the job, Solaris 2.6 was completely installed from scratch, gcc was installed on it (it is not included in the standard package), then the program was developed and compiled.  How to run Solaris 2.6 and how to set up a network on it was already covered in this article.  To complete the picture, a few more tips for installing Solaris: <br><br><ol><li>  About 10 different distributions have been tried, however, it was normally possible to install and run after installation only a distribution kit, whose file is named like this: SOL_2_6_598_SPARC_SMCC_SVR.iso. </li><li>  Detailed installation instructions can be found <a href="http://brezular.com/2012/02/17/installation-solaris-2-6-sparc-on-qemu-part2-solaris-installation/">here.</a> </li><li>  When installing, it is advisable to manually fix the partition table so that at least 400 Mb is allocated to / usr. </li><li>  After installation on the Solaris OS, you can optionally install packages that can be downloaded <a href="http://sunfreeware.tiscali.nl/sparc/2.6/">here.</a> </li><li>  To create a virtual disk, you can use the command: qemu-img.exe create -f qcow2 D: \ qemu \ sparc_36.img 36G </li><li>  To install the package, you can use the following commands: <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">gzip</span></span> -d package_name sudo pkgadd -d unzipped_package_name</code> </pre><br></li></ol></div><p>Source: <a href="https://habr.com/ru/post/255079/">https://habr.com/ru/post/255079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255069/index.html">Krovi: Big Data - as dream. 4th series. Brain revolution</a></li>
<li><a href="../255071/index.html">Again about reputation, or how not to become a mediator in spamming</a></li>
<li><a href="../255073/index.html">Analysis of the natural language: grammatical notation</a></li>
<li><a href="../255075/index.html">30 new free courses virtual academy Microsoft Virtual Academy, April 2015</a></li>
<li><a href="../255077/index.html">Digest of April hackathons, mitaps and other technological events in Moscow and not only</a></li>
<li><a href="../255081/index.html">Secrets of the Madrid court Or the device of the main business processes of the company Ultima. Part 1</a></li>
<li><a href="../255083/index.html">How to promote mobile applications before the release. Part 1</a></li>
<li><a href="../255085/index.html">5 differences of data centers of the future from modern DC</a></li>
<li><a href="../255095/index.html">What to do IT in the army - a guide to action</a></li>
<li><a href="../255099/index.html">Dear web designer, let's stop violating the ability to scroll</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>