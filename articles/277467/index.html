<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The new locker "Locky"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Information security researchers discovered a new type of ransomwave, a malicious program that encrypts user files and requires a ransom in bitcoin. T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The new locker "Locky"</h1><div class="post__text post__text-html js-mediator-article">  Information security researchers discovered a new type of ransomwave, a malicious program that encrypts user files and requires a ransom in bitcoin.  The new cryptographer, which the creators themselves have called ‚Äúlocky,‚Äù is distributed in an unusual way for this kind of software ‚Äî using a macro in Word documents. <br><br>  According to information security specialist <a href="http://www.bleepingcomputer.com/news/security/the-locky-ransomware-encrypts-local-files-and-unmapped-network-shares/">Lawrence Abrams</a> , the cryptographer disguises himself as an invoice to the user and arrives by mail to the victim: <br><br> <a href=""><img src="https://habrastorage.org/files/510/e8f/7e6/510e8f7e6ee2432396dfb5d6d38f9d5f.png"></a> <br>  <i>Clickable</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The attached file has a name of the form invoice_J-17105013.doc, and when opening it, the user will see only the stuffing of the characters and the message that ‚Äúif the text is not readable, turn on the macros‚Äù. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/7cf/66d/a9e/7cf66da9ee6919054aaed7b7ca4d6f52.png" alt="image"><br><br>  When macros are enabled, the download of the malware executable file starts from the remote server and is installed on the victim‚Äôs computer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ba/fd7/fa6/5bafd7fa65a405b6a548db5490961ea0.png" alt="image"><br>  <i>This is a malicious macro.</i> <br><br>  The initially downloaded file, from which Locky is further installed, is stored in the% Temp% folder, however, after the start of encryption of user data, it is deleted. <br><br>  At the beginning of his work, Locky assigns a unique hexadecimal number to the victim and then starts scanning all local drives, as well as hidden and network folders.  To encrypt user data, the malware uses AES encryption.  Files of the following extensions (and only they) are affected: <br><br><pre><code class="bash hljs">.mid, .wma, .flv, .mkv, .mov, .avi, .asf, .mpeg, .vob, .mpg, .wmv, .fla, .swf, .wav, .qcow2, .vdi, .vmdk, .vmx, .gpg, .aes, .ARC, .PAQ, .tar.bz2, .tbk, .bak, .tar, .tgz, .rar, .zip, .djv, .djvu, .svg, .bmp, .png, .gif, .raw, .cgm, .jpeg, .jpg, .tif, .tiff, .NEF, .psd, .cmd, .bat, .class, .jar, .java, .asp, .brd, .sch, .dch, .dip, .vbs, .asm, .pas, .cpp, .php, .ldf, .mdf, .ibd, .MYI, .MYD, .frm, .odb, .dbf, .mdb, .sql, .SQLITEDB, .SQLITE3, .asc, .lay6, .lay, .ms11 (Security copy), .sldm, .sldx, .ppsm, .ppsx, .ppam, .docb, .mml, .sxm, .otg, .odg, .uop, .potx, .potm, .pptx, .pptm, .std, .sxd, .pot, .pps, .sti, .sxi, .otp, .odp, .wks, .xltx, .xltm, .xlsx, .xlsm, .xlsb, .slk, .xlw, .xlt, .xlm, .xlc, .dif, .stc, .sxc, .ots, .ods, .hwp, .dotm, .dotx, .docm, .docx, .DOT, .max, .xml, .txt, .CSV, .uot, .RTF, .pdf, .XLS, .PPT, .stw, .sxw, .ott, .odt, .DOC, .pem, .csr, .crt, .key, wallet.dat</code> </pre> <br>  Locky ignores files whose path contains the following elements: <br><br><pre> <code class="bash hljs">tmp, winnt, Application Data, AppData, Program Files (x86), Program Files, temp, thumbs.db, <span class="hljs-variable"><span class="hljs-variable">$Recycle</span></span>.Bin, System Volume Information, Boot, Windows</code> </pre><br><br>  When encrypting data, the malware renames files on the principle of [unique_id] [id] .locky.  As a result, the file test.jpg was renamed to something like F67091F1D24A922B1A7FC27E19A9D9BC.locky. <br><br>  Separately, it should be noted that Locky encrypts and network drives, so all system administrators should pay attention to access policies and limit the ability of users to the maximum.  But that's not all.  Locky also deletes all shadow copies of files so that the user cannot even restore what he recently worked with.  This is implemented by the following command: <br><br><pre> <code class="bash hljs">vssadmin.exe Delete Shadows /All /Quiet</code> </pre><br><br>  After everything that the malware was able to reach, is encrypted, it creates a _Locky_recover_instructions.txt file on the desktop and in each folder, explaining what the user has become a victim of, as well as instructions for buying out his data. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c5/e10/2a7/2c5e102a7e9324c40a97c17e37ac97ac.png" alt="image"><br><br>  To make the user forget what happened to him, Locky kindly changes even the desktop wallpaper to an image with text duplicating the _Locky_recover_instructions.txt content: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de3/54e/f09/de354ef09745aa6c98fa13624f36a055.png" alt="image"><br><br>  The _Locky_recover_instructions.txt file contains a link to a site on the Tor network (6dtxgqam4crv6rr6.onion) called Locky Decrypter Page. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f1/b79/b02/9f1b79b02df73e7564a08fe847f48c78.png" alt="image"><br><br>  They give clear instructions on how, how much and where to buy and transfer Bitcoins.  After paying for the ‚Äúservices‚Äù, the user is provided with a link to the decoder, which will recover all the data. <br><br>  Another information security specialist, <a href="https://medium.com/%40networksecurity/you-your-endpoints-and-the-locky-virus-b49ef8241bea">Kevin Beumont</a> , also conducted a study on Locky.  According to him, the malware has already received a serious spread, and this may be the beginning of an "epidemic": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/530/e29/50e/530e2950eeca9d5edfc6c2ae48b6f58f.png" alt="image"><br><br>  For clarity, Kevin visualized Locky's network activity (each point is an infected machine): <br><br><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;"></twitter-widget><blockquote class="twitter-tweet" data-lang="ru" data-twitter-extracted-i1553516699831603616="true"><p lang="en" dir="ltr">  Live <a href="https://twitter.com/hashtag/Locky%3Fsrc%3Dhash">#Locky</a> visualization.  <a href="https://t.co/tVRULtidNT">pic.twitter.com/tVRULtidNT</a> </p>  - Kevin Beaumont (@GossiTheDog) <a href="https://twitter.com/GossiTheDog/status/700034174997172224">February 17, 2016</a> </blockquote><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script><br><blockquote>  Locky traffic ranges from 1 to 5 requests per second.  Thus, by the end of today, up to 100,000 computers worldwide can become victims of a cryptographer all over the world except those already infected, which makes Locky an unprecedented phenomenon in the field of cybersecurity. </blockquote><br>  Yesterday, according to Kevin, Locky infected up to 18,000 computers per hour, and today this figure may be much higher.  Even sadder is that while Locky is detected by only 5 antivirus out of 54 tested: <br><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;"></twitter-widget><blockquote class="twitter-tweet" data-lang="ru" data-twitter-extracted-i1553516699831603616="true"><p lang="en" dir="ltr">  Low VirusTotal detection rate for <a href="https://twitter.com/hashtag/Locky%3Fsrc%3Dhash">#Locky</a> Ransomware 5/54 <a href="https://t.co/HN19SqFZid">pic.twitter.com/HN19SqFZid</a> </p>  - PhysicalDrive0 (@ PhysicalDrive0) <a href="https://twitter.com/PhysicalDrive0/status/700100476688183297">February 17, 2016</a> </blockquote><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script><br>  As they say, the best contraception is abstinence, so for now the best way to protect yourself from Locky is to delete or ignore emails from unknown recipients and to ban the execution of macros in MS Office. </div><p>Source: <a href="https://habr.com/ru/post/277467/">https://habr.com/ru/post/277467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277457/index.html">We test the layout correctly</a></li>
<li><a href="../277459/index.html">Automating stock purchases: large transaction processing architecture</a></li>
<li><a href="../277461/index.html">Traits out of the box</a></li>
<li><a href="../277463/index.html">Xeon Phi: Why do coprocessors use to create trading applications</a></li>
<li><a href="../277465/index.html">Initialized controllers in symfony and working with annotations</a></li>
<li><a href="../277471/index.html">What's new in Windows Server 2016 RDS. Part 2</a></li>
<li><a href="../277473/index.html">Zabbix 3.0: Problem Prediction</a></li>
<li><a href="../277475/index.html">Gmailify: The best of Gmail‚Äôs features are now available without the @gmail mailbox.</a></li>
<li><a href="../277477/index.html">The problem of malware for PoS - terminals in the hotel industry</a></li>
<li><a href="../277479/index.html">A bit about Kotlin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>