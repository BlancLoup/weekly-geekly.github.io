<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Type Family and Pokemon</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 When I began to study Haskel, I was almost immediately amazed. To begin with, diving headlong into current work projects, discovered that m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Type Family and Pokemon</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  When I began to study Haskel, I was almost immediately amazed.  To begin with, diving headlong into current work projects, discovered that most of these libraries use language extensions that are present only in the GHC (Glasgow Haskell Compiler).  It jarred me slightly, primarily because someone who wants to use a language so weak that it will be necessary to use extensions that are present only from one supplier.  It is so? <br>  Well, I decided to master it again and learn all about these extensions, and I derived three hot topics for the Haskell society that solved similar problems: Generalized Algebraic Data Types, Type Families and Functional Dependencies.  Trying to find resources that teach about them, I could only find articles describing what it is and how to use it.  But no one, in fact, explained why they are needed! .. Therefore, I decided to write this article using a friendly example, trying to explain why the Type Types are still needed. <br><br><img src="https://habrastorage.org/storage2/989/946/059/9899460598e394cb692d0c1bd0051b10.jpg"><br><br>  Have you ever heard of Pokemon?  These are wonderful creatures that inhabit the World of Pokemon.  You can consider them as animals with extraordinary abilities.  All Pokemons own the element, and all their capabilities depend on this element.  For example, the fire element pokemon can breathe fire, while the water element pokemon can splash water. <br>  Pokemon belong to people, and their special abilities can be used to benefit productive activities, but some people just use their Pokemon to fight other Pokemon of other people.  These people call themselves Pokemon Trainers.  It may sound like animal abuse at first, but it's very fun and everyone seems happy, including Pokemon.  Keep in mind that in the Pok√©mon world, everything seems to be in order, even if 10-year-olds leave home to risk their lives in order to become the best Pok√©mon Trainers, as if no one ever became one. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We are going to use Haskell to present a limited (and even somewhat simplified, forgive me fans) part of the world of pokemon. <a name="habracut"></a>  Namely: <br><ul><li>  Pokemon has a type or element, in our case, stripped down to Fire, Water and Grass </li><li>  There are three pokemon each element: <br><ul><li>  Charmander, Charmeleon and Charizard - Fire Pokemon, </li><li>  Squirtle, Warthortle and Blestoyz - Water Element, </li><li>  Bulbasaurus, Ivizavr and Venozavr - Grass Element </li></ul></li><li>  Each element has its own abilities, called movements or strikes: water Pok√©mon perform water strikes, fire Pok√©mon - fire strikes, herbal - grass blows </li><li>  When fighting, a fire pokemon always defeats a grass pokemon, a grass pokemon always defeats a water pokemon, and a water pokemon always defeats a fire pokemon </li><li>  Pokemons of one element never fight, because it is impossible to determine which one will win </li><li>  Other people should be able to replenish the program with their pokemon in their modules. </li><li>  The Type Checker (part of the interpreter and compiler) should help us in complying with the rules. </li></ul><br><h4>  First try </h4><br>  To begin with, we will try to implement the rules without using type classes and type families. <br>  Let's start with a few pokemon elements and their movements.  We will implement separately, as this will help us to distinguish their movements from Pokemon types. <br>  For this purpose, we will determine the functions for each pokemon, choosing its movement. <br><br><pre><code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmander</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charizard</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Squirtle</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Wartortle</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Blastoise</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bulbasaur</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ivysaur</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Venusaur</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireMove</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ember</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlameThrower</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireBlast</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterMove</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bubble</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterGun</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GrassMove</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VineWhip</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> pickFireMove :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireMove</span></span></span><span class="hljs-class"> pickFireMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmander</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ember</span></span></span><span class="hljs-class"> pickFireMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlameThrower</span></span></span><span class="hljs-class"> pickFireMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charizard</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireBlast</span></span></span><span class="hljs-class"> pickWaterMove :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterMove</span></span></span><span class="hljs-class"> pickWaterMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Squirtle</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bubble</span></span></span><span class="hljs-class"> pickWaterMove _ = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterGun</span></span></span><span class="hljs-class"> pickGrassMove :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GrassMove</span></span></span><span class="hljs-class"> pickGrassMove _ = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VineWhip</span></span></span></span></code> </pre> <br>  While all is well, the type-checker helps to figure out where some pokemon use their element correctly. <br><br><img src="https://habrastorage.org/storage2/a7a/8ec/c08/a7a8ecc08256354e08709e842d06d7a6.jpg"><br>  <i>6 of 9 pok√©mon of all three elements described by us.</i>  <i>2 for each type</i> <br><br>  Now we have to realize the battle.  Fights will be a message output, where it is described how each Pokemon beats, then we indicate the winner, for example, like this: <br><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">printBattle</span></span> :: <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">IO</span></span> () printBattle pokemonOne moveOne pokemonTwo moveTwo winner = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> putStrLn $ pokemonOne ++ <span class="hljs-string"><span class="hljs-string">" used "</span></span> ++ moveOne putStrLn $ pokemonTwo ++ <span class="hljs-string"><span class="hljs-string">" used "</span></span> ++ moveTwo putStrLn $ <span class="hljs-string"><span class="hljs-string">"Winner is: "</span></span> ++ winner ++ <span class="hljs-string"><span class="hljs-string">"\n"</span></span></code> </pre><br>  This is just a display of movements, we ourselves must find the winner, based on the elements of the pokemon and his blows.  Here is an example of the function of the battle between the Fire and Water elements: <br><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">battleWaterVsFire</span></span> :: <span class="hljs-type"><span class="hljs-type">Water</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Fire</span></span> -&gt; <span class="hljs-type"><span class="hljs-type">IO</span></span> () battleWaterVsFire water fire = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> printBattle (show water) moveOne (show fire) moveTwo (show water) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> moveOne = show $ pickWaterMove water moveTwo = show $ pickFireMove fire battleFireVsWater = flip battleWaterVsFire <span class="hljs-comment"><span class="hljs-comment">--   ,   ,   ,   </span></span></code> </pre><br>  If we combine all this and add other functions of the fights, we will get the program. <br><br><h4>  Introduction to Type Classes </h4><br>  How much of this is repeated code: imagine that someone wanted to add Pokemon Electric Elements, for example Pikachu, then you have to add your own functions of <code>battleElectricVs(Grass|Fire|Water)</code> .  There are several templates that will help us to formalize and help people gain a greater understanding of what Pokemon is and how to add new ones. <br>  What we have: <br><ul><li>  pokemons use functions to select movement </li><li>  Battles find a winner and print a description of the battle. </li></ul><br>  We will define several types of types for formalization, and since we will rule, we will also rename the now unusual name scheme, where each function includes the element with which it operates. <br><br><h5>  Pokemon class </h5><br>  The Pok√©mon class displays knowledge that the Pok√©mon has chosen its movement.  This will allow us to define <code>pickMove</code> , re-using it so that the same function can operate on different elements for which the class is defined. <br><br>  In contrast to the ‚Äúvanilla‚Äù classes, our Pokemon class will need 2 types: the elements of the Pokemon and the type of damage they use, and later one will depend on the other.  We need to enable a language extension that allows 2 parameters in the class: <code>MultiParamTypeClasses</code> <br>  Notice that we need to add constraints, such that Pokemon and their strikes should be able to be displayed on the screen. <br>  Here is the definition, along with several instances for existing Pokemon elements. <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pokemon</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">move</span></span></span><span class="hljs-class">) =&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> pokemon move </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> pickMove :: pokemon -&gt; move <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Pokemon</span></span> <span class="hljs-type"><span class="hljs-type">Fire</span></span> <span class="hljs-type"><span class="hljs-type">FireMove</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> pickMove <span class="hljs-type"><span class="hljs-type">Charmander</span></span> = <span class="hljs-type"><span class="hljs-type">Ember</span></span> pickMove <span class="hljs-type"><span class="hljs-type">Charmeleon</span></span> = <span class="hljs-type"><span class="hljs-type">FlameThrower</span></span> pickMove <span class="hljs-type"><span class="hljs-type">Charizard</span></span> = <span class="hljs-type"><span class="hljs-type">FireBlast</span></span> <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Pokemon</span></span> <span class="hljs-type"><span class="hljs-type">Water</span></span> <span class="hljs-type"><span class="hljs-type">WaterMove</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> pickMove <span class="hljs-type"><span class="hljs-type">Squirtle</span></span> = <span class="hljs-type"><span class="hljs-type">Bubble</span></span> pickMove _ = <span class="hljs-type"><span class="hljs-type">WaterGun</span></span> <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Pokemon</span></span> <span class="hljs-type"><span class="hljs-type">Grass</span></span> <span class="hljs-type"><span class="hljs-type">GrassMove</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> pickMove _ = <span class="hljs-type"><span class="hljs-type">VineWhip</span></span></code> </pre><br>  and we can use the function like this <br><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">pickMove</span></span> <span class="hljs-type"><span class="hljs-type">Charmander</span></span> :: <span class="hljs-type"><span class="hljs-type">FireMove</span></span></code> </pre><br>  Notice how things start to look untidy.  Due to the fact that pokemon elements and movement types are processed independently by type classes.  Saying that we choose the Fire Strike, we give the type inspector all the information so that he would decide which class to use and the blow. <br><h5>  Battle class </h5><br>  We already have Pokemon who can choose their own blows, now we need an abstraction that will represent the battle of two Pokemons in order to get rid of functions like <code>battle*family*Vs*family</code> <br>  We would really like to write code like this: <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">move</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foe</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foeMove</span></span></span><span class="hljs-class">) =&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> pokemon move foe foeMove </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> battle :: pokemon -&gt; foe -&gt; <span class="hljs-type"><span class="hljs-type">IO</span></span> () battle pokemon foe = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> printBattle (show pokemon) (show move) (show foe) (show foeMove) (show pokemon) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> move = pickMove pokemon foeMove = pickMove foe <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Battle</span></span> <span class="hljs-type"><span class="hljs-type">Water</span></span> <span class="hljs-type"><span class="hljs-type">WaterMove</span></span> <span class="hljs-type"><span class="hljs-type">Fire</span></span> <span class="hljs-type"><span class="hljs-type">FireMove</span></span></code> </pre><br>  However, if we start, we will get an error from the type checker, since there is no more general instance taking into account all types of impacts. <br>  This problem is solved, however, the final code looks ugly, we actually need to change the type of the battle function to <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">battle</span></span> :: pokemon -&gt; foe -&gt; <span class="hljs-type"><span class="hljs-type">IO</span></span> (move, foeMove)</code> </pre><br><h4>  Introduction Families of types, finally! </h4><br>  Well, our program looks depressing.  We need to take care of all the type signatures, and we are even obliged to change the internal behavior of our functions ( <code>battle</code> ) only so that we can use type signatures in order to help the compiler.  I can go much further and say that our current program refactoring is only slightly more formal and less repetitive, not so much a great achievement, after we have entered so much disgrace in the code. <br>  Now we can look back at our definition of the Pok√©mon class.  He has the pokemon element and the type of strikes as two separate class variables.  The type checker does not know about the existence of a connection between the elements of Pokemon and the types of impacts.  It even allows you to identify a Pok√©mon instance when Water Pokemon creates Fire Strikes! <br>  It is here that the family of types comes into play: they allow the type-tester to say that the Fire Pokemon can only work with Fire Strikes and so on. <br><h5>  Pokemon class using family types </h5><br>  In order to use Family Types, we need to enable the <code>TypeFamilies</code> extension.  As soon as we connect, we can try to write our class in style: <br><br><pre> <code class="haskell hljs"><span class="hljs-meta"><span class="hljs-meta">{-# LANGUAGE TypeFamilies, FlexibleContexts #-}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> (<span class="hljs-type"><span class="hljs-type">Show</span></span> p, <span class="hljs-type"><span class="hljs-type">Show</span></span> (<span class="hljs-type"><span class="hljs-type">Move</span></span> p)) =&gt; <span class="hljs-type"><span class="hljs-type">Pokemon</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> p :: * pickMove :: p -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> p</span></span></code> </pre><br>  We have defined our Pokemon class in such a way that it has one argument and one associated type of movement.  Movement type becomes a ‚Äútype function‚Äù that returns the type of impact to be used.  This means that instead of <code>FireMove</code> we will use <code>Move Fire</code> , instead of <code>WaterMove</code> - <code>Move Water</code> , etc. <br>  Note that the dependency looks almost like in the previous case, only instead of <code>Show move</code> we use <code>Show (Move a))</code> .  We need to include another addition: <code>FlexibleContexts</code> , to work with this. <br>  Now Haskel provides us with excellent syntactic sugar, so we can determine the actual associated data constructor on the right when we define our instance. <br>  Let's redefine all our data types and create the necessary class instances using the type families. <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmander</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charizard</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ember</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlameThrower</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireBlast</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmander</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ember</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlameThrower</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charizard</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireBlast</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Squirtle</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Wartortle</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Blastoise</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bubble</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterGun</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Squirtle</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bubble</span></span></span><span class="hljs-class"> pickMove _ = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterGun</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bulbasaur</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ivysaur</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Venusaur</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VineWhip</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> pickMove _ = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VineWhip</span></span></span></span></code> </pre><br>  Now we can calmly write <br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">pickMove</span></span> <span class="hljs-type"><span class="hljs-type">Squirtle</span></span></code> </pre><br>  and get the result. <br>  It's beautiful, right?  No more need to write captions in order to choose a punch. <br>  However, it is too early to compare with the initial version.  It is better to compare the final result to get the full effect of what you see. <br><h5>  New Class Battle </h5><br>  Now there is no longer a need for a long signature, so you can remove the hideous crutch, and return almost the original value. <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pokemon</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foe</span></span></span><span class="hljs-class">) =&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> pokemon foe </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> battle :: pokemon -&gt; foe -&gt; <span class="hljs-type"><span class="hljs-type">IO</span></span> () battle pokemon foe = <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> printBattle (show pokemon) (show move) (show foe) (show foeMove) (show pokemon) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> foeMove = pickMove foe move = pickMove pokemon</code> </pre><br>  And note, now the Battle is no longer necessary to know anything about the attacks.  And the fighting pokemons look almost the same as the naive implementation. <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">instance</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">instance</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> battle = flip battle <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Battle</span></span> <span class="hljs-type"><span class="hljs-type">Grass</span></span> <span class="hljs-type"><span class="hljs-type">Water</span></span> <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Battle</span></span> <span class="hljs-type"><span class="hljs-type">Water</span></span> <span class="hljs-type"><span class="hljs-type">Grass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> battle = flip battle <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Battle</span></span> <span class="hljs-type"><span class="hljs-type">Fire</span></span> <span class="hljs-type"><span class="hljs-type">Grass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Battle</span></span> <span class="hljs-type"><span class="hljs-type">Grass</span></span> <span class="hljs-type"><span class="hljs-type">Fire</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> battle = flip battle</code> </pre><br>  Using is also easy: <br><pre> <code class="haskell hljs"> battle <span class="hljs-type"><span class="hljs-type">Squirtle</span></span> <span class="hljs-type"><span class="hljs-type">Charmander</span></span></code> </pre><br>  It's all!  Our program finally got a great look, we improved it, and the type checker checks more, repeats less and has a clean API to offer it to other developers. <br><br>  Cool!  We did it!  Hope you enjoyed it! <br>  OK OK.  I realized that you are having fun and you can‚Äôt believe that everything is already over, because your browser scrolling bar shows that there is still room for less than this phrase. <br><br>  Well, let's add one more thing to the World of Pokemon. <br>  Now we have defined our instances of the <code>Water</code> and <code>Fire</code> elements as <code>Battle Water Fire</code> , and then the <code>Battle Water Fire</code> is the same as the previous one, with the arguments reversed.  The first pokemon always wins, and the following is always displayed: <br><pre> <code class="haskell hljs"><span class="hljs-comment"><span class="hljs-comment">-- Winner Pokemon move -- Loser Pokemon move -- Winner pokemon Wins.</span></span></code> </pre><br>  Even when an instance has a loser first, the attacker of the winner will be displayed first. <br>  Let's replace it all the same, and let the copies decide who wins the fight, and we can get <br><pre> <code class="haskell hljs"><span class="hljs-comment"><span class="hljs-comment">-- Loser Pokemon move -- Winner Pokemon move -- Winner pokemon Wins</span></span></code> </pre><br><h4>  Associated Type Synonyms </h4><br>  When we decide to return the choice of two types, we usually use <code>Either ab</code> , but it is in the runtime, we want the type checker to be sure that when the elements Fire and Water will fight, Water will always be a winner. <br>  Therefore, we will add a new function to the Battle and call it a <i>winner</i> , which will receive 2 arguments in the same order that were obtained by the battle function, and decide who will win. <br>  However, to return one of several options causes the uncertainty of the choice of signature from the winner. <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> pokemon foe </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> .. winner :: pokemon -&gt; foe -&gt; ??? <span class="hljs-comment"><span class="hljs-comment">--   , 'pokemon'  'foe'? instance Battle Water Fire where winner :: Water -&gt; Fire -&gt; Water -- Water    : pokemon winner water _ = water instance Battle Fire Water where winner :: Fire -&gt; Water -&gt; Water -- Water   : foe winner _ water = water</span></span></code> </pre><br>  You see, for the <code>Battle Water Fire</code> instance, the winner type is the same as the <code>pokemon</code> , and the <code>Battle Fire Water</code> will already have a <code>foe</code> . <br><br>  Fortunately, type families also support associated type synonyms.  In the class of the Battle, we will have <code>Winner pokemon foo</code> , and in the instances we will determine who among them will be.  We use the type, not the data, because it is just a synonym for <code>pokemon</code> or <code>foe</code> . <br>  On its own, <code>Winner</code> is a type-signed type function <code>* -&gt; * -&gt; *</code> that receives both <code>pokemon</code> and <code>foo</code> and returns one of them. <br>  We will also define a default implementation that <code>pokemon</code> will choose <code>pokemon</code> <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foe</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> pokemon, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> foe) =&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> pokemon foe </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> pokemon foe :: * </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">--    type Winner pokemon foe = pokemon --      battle :: pokemon -&gt; foe -&gt; IO () battle pokemon foe = do printBattle (show pokemon) (show move) (show foe) (show foeMove) (show winner) where foeMove = pickMove foe move = pickMove pokemon winner = pickWinner pokemon foe pickWinner :: pokemon -&gt; foe -&gt; (Winner pokemon foe)</span></span></span></span></code> </pre><br>  Instances are created like this: <br><br><pre> <code class="haskell hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">instance</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">where</span></span></span></span> pickWinner pokemon foe = pokemon <span class="hljs-keyword"><span class="hljs-keyword">instance</span></span> <span class="hljs-type"><span class="hljs-type">Battle</span></span> <span class="hljs-type"><span class="hljs-type">Fire</span></span> <span class="hljs-type"><span class="hljs-type">Water</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> pickWinner = flip pickWinner</span></span></code> </pre><br>  Now that's for sure. <br>  The final version of the program is as follows: <br><div class="spoiler">  <b class="spoiler_title">The final version of the Pokemon battles</b> <div class="spoiler_text"><pre> <code class="haskell hljs"><span class="hljs-meta"><span class="hljs-meta">{-# LANGUAGE TypeFamilies, MultiParamTypeClasses, FlexibleContexts #-}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> (<span class="hljs-type"><span class="hljs-type">Show</span></span> pokemon, <span class="hljs-type"><span class="hljs-type">Show</span></span> (<span class="hljs-type"><span class="hljs-type">Move</span></span> pokemon)) =&gt; <span class="hljs-type"><span class="hljs-type">Pokemon</span></span> pokemon <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> pokemon :: * pickMove :: pokemon -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> pokemon </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmander</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charizard</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ember</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlameThrower</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireBlast</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmander</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ember</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FlameThrower</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charizard</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FireBlast</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Squirtle</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Wartortle</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Blastoise</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bubble</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterGun</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> pickMove </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Squirtle</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bubble</span></span></span><span class="hljs-class"> pickMove _ = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WaterGun</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bulbasaur</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ivysaur</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Venusaur</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Move</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VineWhip</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> pickMove _ = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VineWhip</span></span></span><span class="hljs-class"> printBattle :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">String</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IO</span></span></span><span class="hljs-class"> () printBattle pokemonOne moveOne pokemonTwo moveTwo winner = do putStrLn $ pokemonOne ++ " used " ++ moveOne putStrLn $ pokemonTwo ++ " used " ++ moveTwo putStrLn $ "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> is: " ++ winner ++ "\n" class (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foe</span></span></span><span class="hljs-class">), </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> pokemon, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pokemon</span></span></span><span class="hljs-class"> foe) =&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> pokemon foe where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> pokemon foe :: * </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> pokemon foe = pokemon battle :: pokemon -&gt; foe -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IO</span></span></span><span class="hljs-class"> () battle pokemon foe = do printBattle (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">show</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pokemon</span></span></span><span class="hljs-class">) (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">show</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">move</span></span></span><span class="hljs-class">) (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">show</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foe</span></span></span><span class="hljs-class">) (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">show</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foeMove</span></span></span><span class="hljs-class">) (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">show</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">winner</span></span></span><span class="hljs-class">) where foeMove = pickMove foe move = pickMove pokemon winner = pickWinner pokemon foe pickWinner :: pokemon -&gt; foe -&gt; (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pokemon</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foe</span></span></span><span class="hljs-class">) instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> where pickWinner pokemon foe = pokemon instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> pickWinner = flip pickWinner instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> where pickWinner pokemon foe = pokemon instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Water</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> pickWinner = flip pickWinner instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> where pickWinner pokemon foe = pokemon instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Battle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Winner</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Grass</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fire</span></span></span><span class="hljs-class"> pickWinner = flip pickWinner main :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">IO</span></span></span><span class="hljs-class"> () main = do battle </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Squirtle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmander</span></span></span><span class="hljs-class"> battle </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Wartortle</span></span></span><span class="hljs-class"> battle </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bulbasaur</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Blastoise</span></span></span><span class="hljs-class"> battle </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Wartortle</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ivysaur</span></span></span><span class="hljs-class"> battle </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charmeleon</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ivysaur</span></span></span><span class="hljs-class"> battle </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Venusaur</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Charizard</span></span></span></span></code> </pre><br></div></div><br>  Now you can add your own Electric Pokemon!  Try it! <br><br>  <i>PS Original article <a href="https://www.fpcomplete.com/user/nubis/type-families-and-pokemon">Type Families and Pokemon</a></i> <i><br></i>  <i>The article is printed with abbreviations, as it is intended for interactive interaction.</i> </div><p>Source: <a href="https://habr.com/ru/post/187272/">https://habr.com/ru/post/187272/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../187258/index.html">My version of the reader for Habra</a></li>
<li><a href="../187260/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ66 (July 14 - 20, 2013)</a></li>
<li><a href="../187264/index.html">PopulateJS: don't repeat yourself in HTML markup</a></li>
<li><a href="../187266/index.html">How I studied in Informzaschita</a></li>
<li><a href="../187270/index.html">WebRTC PeerConnection and DataChannel: Browser Data Exchange</a></li>
<li><a href="../187274/index.html">Danger! This mission to Mars will bore you to death!</a></li>
<li><a href="../187278/index.html">Computer generated efficient, but incomprehensible to man, TCP acceleration algorithms</a></li>
<li><a href="../187280/index.html">In Belarus, problems with access to Google</a></li>
<li><a href="../187282/index.html">The simplest implementation of cross-platform multiplayer on the example of the evolution of a single .NET game. Part two, more technical</a></li>
<li><a href="../187284/index.html">Ubuntu Phone, Core Applications. Inside view</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>