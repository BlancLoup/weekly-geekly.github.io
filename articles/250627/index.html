<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Technical report on the activities of a criminal group engaged in targeted attacks - Anunak</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the second half of 2014, we have repeatedly mentioned targeted attacks on large financial institutions as a new level of fraud. After all, now mone...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Technical report on the activities of a criminal group engaged in targeted attacks - Anunak</h1><div class="post__text post__text-html js-mediator-article">  In the second half of 2014, we have repeatedly mentioned targeted attacks on large financial institutions as a new level of fraud.  After all, now money is being stolen not from ‚Äúsmall legal entities‚Äù, but from large financial companies, in which, it would seem, security should be at the highest level and the complexity of the crime is approaching Hell.  However, taking into account the steady flow of similar crimes, as well as the special relevance against the background of the current financial condition of the country, we decided to update the post and add new details regarding the Anunak group, which uses the Trojan of the same name, also known as Carbanak.  The name Carbanak comes from the gluing together of two words Anunak + Carberp. <br><br><h3>  <font color="#4b87bf">Short excursion</font> </h3><br>  After the arrests of members of the Carberp group in Russia, some participants were left without work, however, the experience gained over many years of work allowed them to occupy a new niche.  One of the participants quickly realized that you could steal $ 2,000 a thousand times and earn $ 2 million, and you could steal only once and all at once. <br><br>  Since 2013  an organized criminal group has intensified, targeting banks and electronic payment systems in Russia and the post-Soviet space.  A special feature is that fraud occurs within the corporate network, using internal payment gateways and banking systems.  Thus, money is stolen not from customers, but from the banks and payment systems themselves.  If intruders gain access to a state-owned enterprise network, the target of the intruders is industrial espionage. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The backbone of the criminal group is made up of citizens of Russia and Ukraine, however there are individuals who provide them support from Belarus. <br><a name="habracut"></a><br>  The average amount of embezzlement in Russia and the post-Soviet space was $ 2 million at the fall 2014 exchange rate.  Since 2013, they have successfully obtained access to the network of more than 50 Russian banks and 5 payment systems, some of them were deprived of a banking license.  To date, the total amount of theft is more than 1 billion rubles, most of which falls on the second half of 2014. <br><br>  The average time from the moment of penetration into the internal network of a financial organization to the time of theft is 42 days. <br><br>  As a result of access to the internal networks of a financial organization, hackers managed to gain access to ATM management servers and infect them with their malicious programs, which allowed them to be emptied in the future.  Also, the result of network penetration was access to the management of payment gateways (in the case of payment systems) and bank accounts. <br><br>  Since 2014, members of a criminal group have begun to actively show interest in European retail companies. <br><br>  In order to penetrate the internal network, targeted mailings are used by e-mail, or through other botnets, for which contact with the owners of large botnets is constantly maintained.  From August 2014, they began to create their large botnet using mass mailings via email rather than Driveby. <br><br><h3>  <font color="#4b87bf">Attacks in Russia</font> </h3><br>  The first successful bank robbery was committed by them in January 2013.  In all the first cases, the attackers used the RDPdoor program for remote access to the bank‚Äôs network, and the MBR Eraser program to remove the traces and output Windows computers and servers.  Both programs were used by members of the Carberp criminal group, which was run by Germes.  To reduce the risks of losing access to the bank‚Äôs internal network, besides malicious programs, attackers also used legitimate remote access programs like Ammy Admin and Team Viewer.  Subsequently, the attacker completely refused to use RDPdoor and Team Viewer. <br><br>  In addition to the banking and payment systems themselves, hackers gained access to email servers to monitor all internal communications.  This allowed them to find out that anomalous activity was recorded in the bank‚Äôs network, how it was installed, and what measures will be taken by bank employees to solve the problem.  Mail control was successfully installed regardless of whether it was MS Exchange or Lotus.  This allowed them to take countermeasures, allowing employees of banks and payment systems to get the feeling that the problem was solved. <br><br>  The main stages of attack development: <br>  1. Primary infection of an ordinary employee‚Äôs computer. <br>  2. Getting a user password with administrative rights on some computers.  For example, a technical support specialist. <br>  3. Obtaining legitimate access to one of the servers. <br>  4. Compromise of the domain administrator password from the server. <br>  5. Getting access to the domain controller and the compromise of all domain active accounts. <br>  6. Accessing email and workflow servers. <br>  7. Getting access to workstations for server administrators and banking systems. <br>  8. Installing software to monitor the activity of operators of their systems of interest.  This is usually a photo and video fixation. <br>  9. Configuring remote access to servers of interest, including changes on firewalls. <br><br><h3>  <font color="#4b87bf">Instruments</font> </h3><br>  To carry out targeted attacks in 2014, attackers completed the development of their main malicious program, Anunak, which is used in conjunction with the following tools: <br><br>  Mimikatz - to get passwords from local and domain accounts <br>  MBR Eraser - for disabling the operating system <br>  SoftPerfect Network Scanner - to scan the local network <br>  Cain &amp; Abel - to get passwords <br>  SSHD backdoor - for getting passwords and remote access <br>  Ammy Admin - remote control <br>  Team Viewer - remote control <br><br>  The main malware is ‚ÄúAnunak‚Äù according to the classification of our laboratory.  This Trojan program is used only for targeted attacks, mainly on banks and payment systems.  Targeted use allows it to remain poorly understood, which ensures its good survivability within corporate networks.  When writing this malware, in some places the source code from the Carberp banking Trojan was used. <br><br>  Anunak has the following functionality. <br><br>  It integrates software called Mimikatz.  This is an open source software that allows you to get passwords for user accounts who logged on to Windows.  However, this software has been significantly changed: while maintaining the functionality for obtaining account passwords, the user interaction functionality, error information and the progress of the program were removed.  Thus, when you run a malicious program on the server, all domain and local accounts, including administrator accounts, will secretly be compromised.  In order to get passwords from accounts, it is enough to enter two commands in succession: ‚Äúprivilege :: debug‚Äù and ‚Äúsekurlsa :: logonpasswords‚Äù.  When this program hits a domain controller or an email server, almost all domain accounts, including administrators, are compromised. <br><br>  It is also possible to add the program file to the exceptions of the firewall by creating the appropriate rule through the ‚ÄúNetsh‚Äù utility. <br><br>  The program has implemented intercept key functionality and has the ability to create screenshots. <br><br>  There is a functional that interacts with the banking system iFOBS. <br><br>  Key information, screenshots and cab files are sent to the malware management server. <br><br>  The program is capable of secretly making changes to a number of system files, presumably to remove the restriction of the desktop versions of the Microsoft Windows operating systems to the number of users who can simultaneously connect to the computer managed by this operating system via RDP in order to implement their remote administration. <br><br>  It is possible to download and run arbitrary executable files from the management server.  One of these files is the ‚ÄúAmmyAdmin‚Äù program, which is able to start with the ‚Äú-service‚Äù and ‚Äú-nogui‚Äù arguments, which will start it as a service and without a user interface.  AmmyAdmin allows you to connect via an IP address and a unique identifier through a rl.ammyy.com server to another computer that has the same software.  As a result of the connection, the attacker gains remote access to the user's computer running AmmyAdmin bypassing firewalls.  A window shot is shown below: <br><br><img src="https://habrastorage.org/files/166/061/bac/166061bac6c246929ed7ceb4efceb554.jpg" alt="image"><br><br>  When gaining access to servers running Linux operating systems, attackers use an SSH backdoor to send attackers data to the server about logins / passwords used to access the server, and also provides remote access to attackers. <br><br>  To ensure access to servers of interest, rules on Microsoft TMG, CISCO, etc. firewalls  can be changed accordingly. <br><br>  When the attackers did not yet have a main malicious program that would perform the hidden installation of AmmyAdmin and would give the attackers a password for remote access, they used a third-party malicious program known as Barus.  This malware is used extremely rarely and was last seen by us in 2013.  The malware is a development of Russian-language authors.  In the control panel, you can see the Ammy ID field, the use of which allowed attackers to make a remote connection. <br><br><img src="https://habrastorage.org/files/275/4e2/ab1/2754e2ab18324b6bb64a88b3c028ad08.jpg"><br><br><h3>  <font color="#4b87bf">Malware propagation methods</font> </h3><br>  At the very beginning of its activities in 2013, due to the lack of a target Trojan, attackers began to spread Andromeda and Pony.  These malicious programs were spread by Driveby methods through the Neutrino Exploit Kit exploit pack, as shown in the figure below.  Interestingly, the source of traffic in the fall of 2013 was the <a href="http://php.net/">php.net</a> site for them.  They redirected traffic from this resource to bundles since July 2013, but this fact was discovered much later.  The name of one of the streams for the distribution of the malicious program ‚ÄúLOL BANK FUCKIUNG‚Äù, which corresponded to their activities. <br><br><img src="https://habrastorage.org/files/f28/791/19a/f2879119adec485b82b4fe8d2926a9ee.jpg"><br><br>  In parallel, they used another method of infection, which was one of the main ones.  The main method of distribution is sending letters with a malicious attachment on behalf of the Central Bank of the Russian Federation, a potential client, or a real-life counterparty (whose account is previously accessed, then it is sent to the contact list). <br><br>  The second method used is the installation of a special malicious program to conduct targeted attacks using another malicious program that could get into the local network at random.  To identify such malicious programs, the criminal group maintains contact with several owners of large botnets that are massively distributing their malicious programs.  When buying IP addresses from such botnet owners, where their malicious programs are installed, attackers check the IP addresses for financial and state structures.  If the malware is on the subnet that interests them, then the attackers pay the owner of a large botnet to install their targeted malware.  Similar partnerships were with the owners of the Zeus, Shiz Ranbyus botnets.  All of these Trojans are banking and are explained by past relationships.  At the end of 2013, the hacker, under the pseudonym Dinhold, began building its botnet on a modified Carberp, after posting its source codes to open access.  They were trying to establish a similar interaction, however, in 2014 he was arrested without having had time to develop his botnet to the required level. <br><br>  The following script was used to check the IP-address for the ownership of the desired network: <br><br>  #! / usr / bin / python <br>  # - * - coding: utf-8 - * - <br>  import os <br>  from bulkwhois.shadowserver import BulkWhoisShadowserver <br>  iplist_file = 'ip.txt' <br>  path = os.path.dirname (os.path.abspath (__ file__)) <br>  bulk_whois = BulkWhoisShadowserver () <br>  iplist = [] <br>  with open (os.path.join (path, iplist_file)) as f: <br>  for line in f: <br>  iplist.append (line.strip ()) <br>  result = bulk_whois.lookup_ips (iplist) <br>  with open (os.path.join (path, 'data.txt'), 'a') as f: <br>  for record in result: <br>  f.write ('IP:% s \ <br>  CC:% s \ <br>  Org.  Name:% s \ <br>  Register:% s \ <br>  AS Name:% s \ <br>  BGP Prefix:% s \ <br>  -------------------------------------------------- ----- \ <br>  '% (result [record] [' ip '], result [record] [' cc '], result [record] [' org_name '], result [record] [' register '], result [record] [' as_name '], result [record] [' bgp_prefix '])) <br><br>  The most dangerous are mailing on behalf of partners with whom financial and government institutions are constantly exchanging data by e-mail.  An example of such a mailing occurred on September 25, 2014, at 2:11 pm from the email address ‚ÄúElina Shchekina &lt;e.shekina@rbkmoney.com&gt;‚Äù, the subject of the letter is ‚ÄúThe Updated Version of the Agreement‚Äù.  Attachment "agreement.doc" exploits vulnerabilities CVE-2012-2539 and CVE-2012-0158.  The distribution was carried out to more than 70 addresses of various companies (moreover, there could be several recipients within one company). <br><br><img src="https://habrastorage.org/files/ae3/2df/4a6/ae32df4a61bb4c958ffaa18dc4d9ba68.jpg"><br><br>  A letter with a malicious attachment (md5: AA36BA9F4DE5892F1DD427B7B2100B06) in the archive with a password from a potential client sent to the bank manager after a preliminary telephone conversation with him.  The call was made from St. Petersburg. <br><br><img src="https://habrastorage.org/files/705/5db/204/7055db204fbf42c3933aac8ef3ca95b4.jpg"><br><br><img src="https://habrastorage.org/files/7e8/e9c/ff3/7e8e9cff354044a9b67949789bd66f91.jpg"><br><br>  The contents of a text file named "requisites.doc" <br><br>  <i>LLC "Company Our Century"</i> <i><br></i>  <i>109387, Russia, Moscow,</i> <i><br></i>  <i>st.</i>  <i>Anosova, 24, office 409</i> <i><br></i>  <i>Tel.</i>  <i>(495) 124-99-77 fax: (495) 124-99-77</i> <i><br></i>  <i>Tel.</i>  <i>honeycomb.</i>  <i>(962) 7135296</i> <i><br></i>  <i>E-mail: x60x@nxt.ru</i> <i><br></i>  <i>INN 7329001307 KPP 732901001</i> <i><br></i>  <i>s / 40702810613310001709</i> <i><br></i>  <i>Branch VTB 24 (CJSC) Moscow</i> <i><br></i>  <i>K \ s 30101810700000000955</i> <i><br></i>  <i>BIK 043602955</i> <br><br>  A letter on behalf of the Central Bank of Russia with a malicious attachment (md5: 8FA296EFAF87FF4D9179283D42372C52), which exploits the CVE-2012-2539 vulnerability to execute arbitrary code. <br><br>  There were also other examples of emails with malicious attachments, such as sending emails with the file ‚Äú001.  photo.exe ". <br><br><img src="https://habrastorage.org/files/e83/0ae/387/e830ae387892418cb006297ba929e363.jpg"><br><br><img src="https://habrastorage.org/files/d0d/cb1/d28/d0dcb1d281e7434d9fcfd0dee1434307.jpg"><br><br><img src="https://habrastorage.org/files/626/d1c/5af/626d1c5af5994bb6953c5862c7041863.jpg"><br><br><h3>  <font color="#4b87bf">ATM attacks</font> </h3><br>  Having access to the internal networks of banks opens up broad opportunities for hackers.  One of these opportunities was access to ATMs from special network segments that should have been isolated.  It is confirmed that this criminal group gained access to 52 ATMs.  The amount of damage exceeds 50 million rubles.  As a result of getting access to ATMs, depending on the ATM model, hackers used different schemes. <br><br><h6>  <font color="#4b87bf">Nominal change</font> </h6><br>  Upon gaining access, attackers downloaded malicious scripts and changed the denominations of the issued banknotes in the registry of the ATM operating system.  As a result, when requesting to receive 10 bills in denominations of 100 rubles, the attacker received 10 bills in denominations of 5000 rubles.  The malicious script and program they used was developed for the Wincor platform. <br><br>  <b>The malicious script contained the following commands:</b> <br>  Contents of the file "1.bat" <br><br>  <i>REG ADD "HKEY_LOCAL_MACHINE \ SOFTWARE \ Wincor Nixdorf \ ProTopas \ CurrentVersion \ LYNXPAR \ CASH_DISPENSER" / v VALUE_1 / t REG_SZ / d "5000" / f</i> <i><br></i>  <i>REG ADD "HKEY_LOCAL_MACHINE \ SOFTWARE \ Wincor Nixdorf \ ProTopas \ CurrentVersion \ LYNXPAR \ CASH_DISPENSER" / v VALUE_2 / t REG_SZ / d "1000" / f</i> <i><br></i>  <i>REG ADD "HKEY_LOCAL_MACHINE \ SOFTWARE \ Wincor Nixdorf \ ProTopas \ CurrentVersion \ LYNXPAR \ CASH_DISPENSER" / v VALUE_3 / t REG_SZ / d "500" / f</i> <i><br></i>  <i>REG ADD "HKEY_LOCAL_MACHINE \ SOFTWARE \ Wincor Nixdorf \ ProTopas \ CurrentVersion \ LYNXPAR \ CASH_DISPENSER" / v VALUE_4 / t REG_SZ / d "100" / f</i> <i><br></i>  <i>REG ADD "HKEY_LOCAL_MACHINE \ SOFTWARE \ Wincor Nixdorf \ ProTopas \ CurrentVersion \ LYNXPAR \ CASH_DISPENSER" / v VALUE_1 / t REG_SZ / d "100" / f</i> <i><br></i>  <i>REG ADD "HKEY_LOCAL_MACHINE \ SOFTWARE \ Wincor Nixdorf \ ProTopas \ CurrentVersion \ LYNXPAR \ CASH_DISPENSER" / v VALUE_4 / t REG_SZ / d "5000" / f</i> <i><br></i>  <i>shutdown -r -t 0 ‚Äìf</i> <br><br>  After the execution of this file, the registry keys, registry branches ‚ÄúHKEY_LOCAL_MACHINE \ SOFTWARE \ Wincor Nixdorf \ ProTopas \ CurrentVersion \ LYNXPAR \ CASH_DISPENSER‚Äù are changed, which are responsible for the value of the cassettes in the ATM.  As a result of the execution of this file, the registry key responsible for cassette number 1 (VALUE_1) is ‚Äú100‚Äù, and the registry key that is responsible for cassette number 4 (VALUE_4) is ‚Äú5000‚Äù.  Then the command is given to restart the computer. <br><br>  Reference value of registry keys: <br><br>  VALUE_1 - 5000 <br>  VALUE_2 - 1000 <br>  VALUE_3 - 500 <br>  VALUE_4 - 100 <br><br>  If the actual load of the ATM corresponds to the reference, then when the registry keys are changed when issuing banknotes from cassette No. 1, bills with the face value of ‚Äú5000‚Äù instead of ‚Äú100‚Äù will be issued. <br><br><h6>  <font color="#4b87bf">Empty Dispenser</font> </h6><br>  In addition, the attackers used a modified debugging program that allowed the team to issue money from the dispenser.  The original debugging program dispenses cash through the dispenser only with the ATM open and the safe door fixed.  To ensure the issuance of money with a closed ATM, attackers had to modify the original program ‚ÄúKDIAG32‚Äù (original file: size 1 128 960 MD5 4CC1A6E049942EBDA395244C74179EFF). <br><br><img src="https://habrastorage.org/files/243/44e/25b/24344e25b1d84ff1b62bd3693c4c1665.jpg"><br>  <i>Figure: Wincor ATM KDIAG32 service program</i> <br><br>  A comparison of the original version of the program with the modified version showed that the only difference is in ignoring the error ‚Äú‚Äú Door not opened or missing! ‚Äù‚Äù.  The figure below shows an error message that will never be shown to the user in the file being examined: <br><img src="https://habrastorage.org/files/c34/72b/888/c3472b888cce457c853f6d5c27888380.jpg"><br>  <i>Figure: Hidden window in the original KDIAG32 program</i> <br><br><h3>  <font color="#4b87bf">Andromeda</font> </h3><br>  Analyzing one of the incidents, all traces indicated that the same criminal group was working.  Ammy Admin was used for remote access, the same SSHD backdoor was installed on Unix servers, and moreover it was loaded from the same hacked server as in other cases using the Anunak Trojan.  However, in this incident, not Anunak was used as the main trojan, but Andromeda was used.  Management servers were located in Kazakhstan, Germany and Ukraine.  A check of management servers showed that it was Bulletproof hosting, which besides servers provides the service of proxying traffic through its infrastructure and using TOR and VPN, which was significantly different from the Anunak hosting scheme.  The cash out check showed that the same criminal group was used as it was for Anunak, which once again confirmed their relationship. <br><br>  The received copies of the Andromeda Trojan were distributed from August 2014 via email.  As the RC4 encryption key, the value 754037e7be8f61cbb1b85ab46c7da77d was used, which is an MD5 hash from the string ‚Äúgo fuck yourself‚Äù.  As a result of such mailings, from August to the end of October, the Andromeda botnet has grown to 260,000 bots.  Successful infection on the same subnet led to sending such letters to other bank employees based on the employee‚Äôs contact list.  An example of sending from the network of an infected bank to employees of another bank is shown below. <br><br><img src="https://habrastorage.org/files/3f0/d6e/7d7/3f0d6e7d7af44f43a78e7f284a954bdf.jpg"><br><br>  As a result of such fan mailing, many oil and gas companies, banks and government agencies were infected.  In Russia, at least 15 banks and 2 payment systems were infected in this way. <br><br>  Emails with similar attachments were distributed with the following topics: <br><br>  "My new photo" <br>  ‚ÄúAlert Transactions Report by users from 2014-09-28 to 2014-09-28‚Äù <br><br><h3>  <font color="#4b87bf">Outlines</font> </h3><br>  Previously, it is worth noting that the process of withdrawing stolen money (cash) was different, firstly, based on the method of theft, secondly of the type of victim (bank or payment system), thirdly of the total amount of theft. <br><br>  By type of sacrifice, they were rather divided on the basis of types of counterparties, work with which imposed certain restrictions.  For example, all payments were required to go through a specific pool of intermediaries.  Additionally, an ‚Äúabnormal‚Äù pool of counterparties could cause suspicion and unnecessary checks (manual processing of payment orders). <br><br><h6>  <font color="#4b87bf">Bank (amounts up to 100 million rubles):</font> </h6><br>  In the case of obtaining (for the purpose of intruders) control over the AWS of the CBD, the scheme was basically a classic tree, when the funds from the bank account were sent to several legal entities, then from each legal entity.  faces into smaller legal entities.  individuals (there could be several such iterations), then to the cards of individuals (from 600 to 7000 tranzac). <br><br>  In the case of obtaining (for the purpose of the attackers) control over the ATM management service, the funds were received directly from the ATM at the attacker's command.  In this case, the entire process of exposure was that the drop was at the ATM at the specified hour and was in contact with the attacker who had access to the ATM management server, with the bag, in which the dispenser was empty. <br><br><h6>  <font color="#4b87bf">Bank (amounts over 100 million rubles):</font> </h6><br>  The funds were sent to the accounts of other banks, and often ‚Äúhacked‚Äù banks were used, in which accounts and plastic cards were prepared in advance. <br><br><h6>  <font color="#4b87bf">Payment system:</font> </h6><br>  In addition to all of the above methods, channels for sending money through payment systems, electronic wallets and payment systems such as web money, Yandex money, QIWI (1500-2000 transactions) were also involved.  Receipts of large amounts (up to 50 million) on individual cards of individuals were recorded, which later were engaged in the purchase of expensive oversized goods on this card, such as jewelry, watches and other attributes.  A huge part of the money was sent to mobile operators (1500-2000 SIM cards prepared in advance). <br><br>  In the spring of 2014 (the heyday of this type of fraud), 2 groups of cashiers working to support targeted attacks were known; by the fall of 2014, their number increased to 5. In general, this increase was also related to the number of thefts (number of victims + average amount of theft by 1 sacrifice).  Groups work in different cities for better distribution of obla.  Also, these groups include people from neighboring countries who, if necessary (a large ‚Äúproject‚Äù), arrived in the specified city.  Each group was controlled by a separate person.  The group includes about 15-20 people. <br><br>  Part of the money went to Ukraine and Belarus. <br><br><h3>  <font color="#4b87bf">Malicious samples</font> </h3><br><h5>  <b>Anunak</b> </h5><br><img src="https://habrastorage.org/files/544/3e4/958/5443e49580c442a1a77dd6a6f43149ea.jpg"><br><br><h5>  <b>Mimikatz</b> </h5><br><img src="https://habrastorage.org/files/141/7ec/026/1417ec0266ba45d295c572f2ebc67cfd.jpg"><br><br><h5>  <b>Andromeda</b> </h5><br><img src="https://habrastorage.org/files/37f/857/0d3/37f8570d3e60412bac09b126b73f64eb.jpg"><br><br><h5>  <b>MBR_Eraser</b> </h5><br><img src="https://habrastorage.org/files/e83/619/39e/e8361939e718408b98490ef74e9f3a2e.jpg"><br><br><h5>  <b>Email attachments</b> </h5><br><img src="https://habrastorage.org/files/9f0/26a/687/9f026a6873f54696ad1e146bcf740353.jpg"><br><br><h3>  <font color="#4b87bf">Attacks in Europe and the USA</font> </h3><br>  While attacks on Russian banks and payment systems have lasted for the last two years, retail attacks only began in the second quarter of 2014.  So far there is confirmed information about three data card leaks and more than ten cases of access to local networks of retail companies, which is becoming a serious threat. <br><br>  In addition to retail organizations, it is also known about the successful attacks on media and PR companies in 2014.  It is not known for certain what was the purpose of penetration into the networks of such companies, but it can be assumed that they were looking for insider information, a kind of industrial espionage, allowing them to gain an advantage in the stock market.  Since these companies have lost nothing, and the result of fraud is difficult to compare with something specific, such incidents are usually never linked into a single whole. <br><br><h4>  <font color="#4b87bf">Ways of infection</font> </h4><br>  Regarding attacks on retail companies, the first infections in 2014 by Anunak were made using a widespread malware mining mining cryptocurrency based on the banking Trojan Gozi / ISFB.        2014         500 000    ,            .                   Microsoft Windows    Windows. <br><br>    Gozi/ISFB         ,    Metasploit/Meterpreter    Anunak.   Anunak       -      2014 . <br><br>       ,      , - Andromeda   SQL-    . <br><br><h4> <font color="#4b87bf"> POS-</font> </h4><br>     Anunak  POS      Epicor/NSB.     Anunak         ,                       .        2014 ,  ,     . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More recent attacks were made with the help of a tailor-made program for POS terminals, which is simpler, but it reliably collected data from memory cards. </font><font style="vertical-align: inherit;">Since the beginning of the fall of 2014, the original version used a simple blacklist, ripped out every process and dumped the data in clear text. </font><font style="vertical-align: inherit;">Later versions scan only certain processes and use the RC4 algorithm to encrypt the extracted card data on disk.</font></font><br><br><h4> <font color="#4b87bf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Additional goals</font></font></font> </h4><br>          -     ,      ,   , ,             .          ,         . <br><br>             ,       2014 .     ‚Äì   ,      VPN-     ,      . ,   -      ,    ,             . <br><br><h4> <font color="#4b87bf"> </font> </h4><br>   Metasploit       .          ,   , ,  CVE-2014- 4113,          . Metasploit  -     ,  ,       . <br><br>                 ,  ,    Metasploit, , Meterpreter,        .       SSL   443,    DNS  53.   BITS   ,       Windows PowerShell     .             Anunak. <br><br> Anunak       ,  PHP-   HTTP  HTTPS,   Windows-    . </div><p>Source: <a href="https://habr.com/ru/post/250627/">https://habr.com/ru/post/250627/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250613/index.html">Review of the most interesting materials on data analysis and machine learning ‚Ññ35 (February 9 - 15, 2015)</a></li>
<li><a href="../250617/index.html">Survey: how do you solve the problem of synchronizing parallel PHP queries?</a></li>
<li><a href="../250621/index.html">300 amazing free services</a></li>
<li><a href="../250623/index.html">Flourishing neocartography</a></li>
<li><a href="../250625/index.html">How does the brain work?</a></li>
<li><a href="../250629/index.html">The second version of the glove to determine the position of the hand</a></li>
<li><a href="../250631/index.html">The digest of interesting materials from the world of web development and IT for the last week No. 147 (February 9 - 15, 2015)</a></li>
<li><a href="../250633/index.html">Machine learning - 1. Correlation and regression. Example: site visitors conversion</a></li>
<li><a href="../250637/index.html">Details about the internal kitchen AngularJS</a></li>
<li><a href="../250641/index.html">Solution: Adobe AIR does not find a connected iOS device from under Windows 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>