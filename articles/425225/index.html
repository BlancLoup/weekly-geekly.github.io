<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to see the links inside your PowerShell module</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, colleagues. A hundred years ago, somewhere I described a quick and dirty way to see the call graph inside your PowerShell script. Now, it‚Äôs ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to see the links inside your PowerShell module</h1><div class="post__text post__text-html js-mediator-article"><p>  Good day, colleagues.  A hundred years ago, somewhere I described a quick and dirty way to see the call graph inside your PowerShell script.  Now, it‚Äôs time, so to speak, to pull the owl on the globe and look at the dependency graph inside the module. </p><a name="habracut"></a><br><p>  First of all, you need to install the <a href="">PSQuickGraph module</a> from the Powershell Gallery.  And after that run the script, the base of which can be taken <a href="https://gist.github.com/eosfor/e66b1bb2c4d7fa5279dc1ffbcfd6f205">here</a> .  Honestly, I did not quite understand how to insert the code from the gist into the post on the habr.  If someone tells you in comments, I will be very grateful. </p><br><p>  So let's continue.  First of all, in two words about the module itself.  It is built on the <a href="https://archive.codeplex.com/%3Fp%3Dquickgraph">QuickGraph</a> library.  In essence, this is a PowerShell wrapper over a library that is designed for quick and rough tests with graphs.  One of these tests can be a piece that parses your PowerShell code, generates a link graph from it, and presents it visually. </p><br><p>  In addition, the script itself uses the built-in PowerShell access mechanism to its <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST,</a> which, in fact, greatly simplifies our analysis of the code.  In the end, by combining one and the other, we get a graph. </p><br><p>  As a result, the script itself consists of two parts.  A piece of "parser" working with AST, and the part that connects AST and the graph.  This part is described in the following example. </p><br><pre><code class="hljs mel">#    ( PSQuickGraph) $g = New-Graph -Type BidirectionalGraph #  PS1 ,  AST        $f = dir <span class="hljs-string"><span class="hljs-string">"C:\Repo\Work\Tools\*.ps1"</span></span> -Recurse | Find-Function $f.name | % { Add-Vertex -Vertex $_ -Graph $g} #   ,    ,         ,      $f | % { $fName = $_.name $tmpFile = New-TemporaryFile $_.line &gt;&gt; ($tmpFile.fullname) $expr = Find-Expression -Fullname $tmpFile.fullname $expr.name | ? {$_} | ? {$_ -notin <span class="hljs-string"><span class="hljs-string">"%"</span></span>,<span class="hljs-string"><span class="hljs-string">"where"</span></span>,<span class="hljs-string"><span class="hljs-string">"?"</span></span>,<span class="hljs-string"><span class="hljs-string">"select"</span></span>,<span class="hljs-string"><span class="hljs-string">"out-null"</span></span>,<span class="hljs-string"><span class="hljs-string">"sort"</span></span>,<span class="hljs-string"><span class="hljs-string">"ft"</span></span>,<span class="hljs-string"><span class="hljs-string">"fl"</span></span>,<span class="hljs-string"><span class="hljs-string">"Write-Verbose"</span></span> } | % { Add-Edge -From $fName -to $_ -Graph $g} } #   Show-GraphLayout -Graph $g #     DOT Export-Graph -Format Graphviz -Graph $g -Path C:\Temp\g.gv</code> </pre> <br><p>  Well, something like this: </p><br><p><img src="https://habrastorage.org/webt/my/5j/p5/my5jp5jvx4p9988bwxj9qbdtvqg.png" alt="moduleStructure"></p><br><p>  In addition, the last command exports the graph to the DOT format, which allows you to torment it even in the <a href="https://www.graphviz.org/">graphviz</a> application </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/425225/">https://habr.com/ru/post/425225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425215/index.html">4 tips for optimizing a webpack application</a></li>
<li><a href="../425217/index.html">Resiliency of the application when updating the cluster Cubernetes</a></li>
<li><a href="../425219/index.html">What is mental health: a view from the psychology / psychotherapy</a></li>
<li><a href="../425221/index.html">How to produce plastic for 3D printing</a></li>
<li><a href="../425223/index.html">Android applications on JPHP</a></li>
<li><a href="../425227/index.html">Researchers have found a way to detect and circumvent Honeytoken keys in a number of Amazon services.</a></li>
<li><a href="../425229/index.html">How we helped CDN MegaFon.TV not to fall on the 2018 World Cup</a></li>
<li><a href="../425231/index.html">FAQ about the work of the stewardess</a></li>
<li><a href="../425233/index.html">Python 3 to facebook</a></li>
<li><a href="../425235/index.html">A little more about graphs, or how to detect dependencies between your applications.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>