<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ethernet + PCIe + FPGA = LOVE</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ethernet access is not possible without network cards (NIC). At low speeds (up to 1G), NICs are embedded in motherboards, and at high speeds (10G / 40...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ethernet + PCIe + FPGA = LOVE</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/797/dad/f5e/797dadf5e0505fd926585b2511301309.jpg" alt="image"><br><br>  Ethernet access is not possible without network cards (NIC).  At low speeds (up to 1G), NICs are embedded in motherboards, and at high speeds (10G / 40G), the NIC is placed on a separate PCIe card.  The main core of such a board is an integrated chip (ASIC), which is engaged in receiving / sending packets at the lowest level.  For most tasks, the capabilities of this chip are more than enough. <br><br>  What to do if there are not enough network card capabilities?  Or does the task require as close as possible access to a low level?  Then boards with reprogrammable logic - FPGA (FPGA) come onto the scene. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What tasks on them decide what is being placed, as well as the most interesting representatives you will see under the cut! <br><br>  <b>Carefully</b> , there will be pictures! <br><a name="habracut"></a><br>  Plan: <br><br><ul><li>  <a href="https://habr.com/ru/post/267183/">Spheres of application</a> </li><li>  <a href="https://habr.com/ru/post/267183/">Filling</a> </li><li>  <a href="https://habr.com/ru/post/267183/">Overview</a> </li></ul><br><a name="use"></a><br><h2>  FPGA Applications </h2><br><h3>  DPI, filtering and firewall </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/2ae/06c/0c1/2ae06c0c1566b2ab415a059efad59f76.png" alt="image" width="500" height="555"><br><br>  A server with such a board can get into a ‚Äúgap‚Äù and monitor all packets passing through it.  Intellectual DPI is implemented on the basis of the processor, and packet forwarding and simple filtering (for example, many 5-tuple rules) are implemented on the basis of the FPGA. <br><br>  How can I do that: <br><br><ul><li>  The streams that we trust, or the decision on them is already in the table for FPGA, pass through the chip with a slight delay, the rest are copied to the CPU and processing is done there. </li><li>  FPGA can remove some of the load from the CPU and look for suspicious signatures in itself, for example, using <a href="http://habrahabr.ru/post/112069/">the Bloom algorithm</a> .  This algorithm has the probability of a false positive response, so if there was a line in the package that Bloom responded to, then such a package is copied to the CPU for additional analysis. </li><li>  The processor processes only the traffic that is interesting - FPGA selects packets according to specified criteria (for example, HTTP requests or SIP traffic) and copies them to the CPU, everything else (torrents, video, etc.) pass through FPGA without significant delay. </li></ul><br>  All these three options can be combined in different variations.  The FPGA can also do some other dirty work, for example, act as a shaper / polisher, or collect statistics on streams. <br><br>  In the illustration above, green packets are processed on the CPU, burgundy and yellow went through filters in the FPGA, and pink packets were dropped (also in the FPGA). <br><br><h3>  Traffic Analysis and Capture </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/261/8c2/103/2618c210330a5e7e329bc457b8a0b2e5.png" alt="image" width="600" height="489"><br><br>  Sometimes these cards are used for capturing traffic and further post-processing on the CPU (write to pcap, delay analysis, etc.).  In this case, the splitter is inserted into the links (or traffic is taken from the port mirror).  It turns out non-intrusive connection, similar to how we did <a href="http://habrahabr.ru/company/metrotek/blog/266561/">in the project of monitoring RTP flows</a> . <br><br>  Here from FPGA is required: <br><br><ul><li>  Filtering by fields (like 5-tuple): to select only the traffic that is interesting. </li><li>  Synchronization via PTP, for hardware timestamping of packets: the time when the packet arrived is snapped up, and this label is placed at the end of the packet.  Then on the CPU you can count, for example, the response time to the request. </li><li>  Slicing is cutting off only the required piece of data (most often it is the first N bytes from the packet - in order to copy only the headers, because very often the data is not very interesting,). </li><li>  Packet buffering: <br><ul><li>  if the CPU does not have time to write in case of some bursts, then you can smooth it out by placing the packets in external memory for a couple of gigabytes </li><li>  if we want to ensure that packets are recorded for a short time (for example, after triggering), it is most often applicable for high speeds (40G / 100G). </li></ul></li><li>  Spreading packets in queues and CPU cores. </li></ul><br>  Having access to the lowest level (well, almost), you can support any protocol or tunneling, and not wait for Intel to do this in their cards. <br><br>  In the above illustration, the FPGA accepts all packets after the traffic is branched out, but only those that interest us (rosy) are copied to the CPU. <br><br><h3>  Network card </h3><br>  Cards with FPGA can be used as a normal NIC, but there is not much point in this: <br><br><ul><li>  At the moment, at all Ethernet speeds (up to 100G inclusive) there are network cards based on ASICs.  For the price they will be cheaper than solutions on FPGA. </li><li>  If you write the card yourself, then for more or less serious performance, you need to wrap a huge number of buns (RSS, LSO, LRO) in such a card. </li></ul><br>  Meaning appears only when it is necessary to provide a unique chip, which will never be on Intel's chip.  For example, hardware encryption according to <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%259E%25D0%25A1%25D0%25A2_28147-89">GOST</a> or <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D1%2583%25D0%25B7%25D0%25BD%25D0%25B5%25D1%2587%25D0%25B8%25D0%25BA_%2528%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%2529">Grasshopper</a> . <br><br><h3>  Network accelerator </h3><br><h4>  Load reduction with CPU </h4><br>  When high speeds appear, the processor does not have time to do everything: I want to remove some of the tasks from it.  For example, what happens when you copy a large amount of data over a network? <br><br>  The processor should: <br><br><ul><li>  take some piece of data </li><li>  put in TCP, split into several packets, according to MTU </li><li>  substitute header (MAC / IP-addresses) </li><li>  calculate cheksummy IP and TCP (although most NIC already take on it) </li><li>  pass the handle to the NIC </li></ul><br>  It is also necessary: <br><br><ul><li>  follow the answers </li><li>  resend packets if the packet is lost </li><li>  reduce / increase tcp-window and so on </li></ul><br><br>  The TCP stack can be implemented on the FPGA: the CPU only needs to provide a pointer to the raw data and the recipient's IP + port, and the piece of hardware will do all the low-level work (setting up the connection, re-sending, etc.). <br><br>  There are ready-made IP-cores that do all this: for example, implementations of <a href="https://www.plda.com/products/fpga-ip/altera/fpga-ip-tcpip/quicktcp-altera">TCP</a> and <a href="https://www.plda.com/products/fpga-ip/altera/fpga-ip-udp/quickudp-altera">UDP</a> stacks from the company <a href="https://www.plda.com/">PLDA</a> . <br><br>  They have standard interfaces (Avalon or AXI), which makes them easy to connect to other IP cores. <br><img src="https://habrastorage.org/getpro/habr/post_images/f96/cfe/e30/f96cfee30394968743e02a09c08d3511.png" alt="image"><br><br><h4>  Speed ‚Äã‚Äãup response </h4><br>  There is a class of tasks where money is brought not by processors, but by the speed of reaction.  Of course, I'm about <a href="https://en.wikipedia.org/wiki/High-frequency_trading">High Frequency Trading</a> .  You can read about the role of FPGA in HFT in <a href="http://habrahabr.ru/post/163371/">this</a> article. <br><br>  The PLDA website provides a video and an example of how this is done.  Using hardware TCP and UDP cores allows you to reduce letensy on purchases / sales. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/OzV4iL3p8JQ%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhG44YHYXG3DVFDttbVErVSuYFDZQ" frameborder="0" allowfullscreen=""></iframe><br><br><img src="https://habrastorage.org/getpro/habr/post_images/def/63f/cae/def63fcaecc2e730ccb64bd8e6345dcc.png" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  <i>I apologize for the red underscores - the picture was taken from the PLDA site, and they have it in the original ...</i> <br></div></div><br>  There are special <a href="http://www.accelize.com/products/fpga-platform-components/finance-ip/market-data-decoders.html">IP cores</a> that decode data from the markets and are ready for pairing with hardware TCP and UDP stacks. <br><br>  Of course, the use of standard kernels or approaches will not give a competitive advantage: exclusive solutions are being developed, since  <a href="http://electronix.ru/forum/index.php%3Fs%3D%26showtopic%3D127147%26view%3Dfindpost%26p%3D1343746">"They want even less delay</a> . <a href="http://electronix.ru/forum/index.php%3Fs%3D%26showtopic%3D127147%26view%3Dfindpost%26p%3D1343746">"</a> <br><br><h3>  Measuring equipment </h3><br><h4>  Network emulators </h4><br>  It often happens that you need to check the engineering solution in the laboratory, because  in combat it can be very expensive. <br>  Recently there was <a href="http://habrahabr.ru/company/croc/blog/267883/">an article</a> from CROC, about optimizing traffic in the North and a large RTT.  To check the quality of services in real conditions, you first need to create these conditions in your laboratory.  For this, you can use the usual Linux machine, but there are <a href="http://www.ixiacom.com/products/gem-xgem-ethernet-network-emulators">special pieces of hardware</a> that are engaged in network emulation. <br><br>  Most often it is necessary to be able to set parameters such as delay / jitter, packet loss (error).  We cannot do without hardware support (read, FPGA), but we also need a smart processor to emulate various protocols (user sessions).  In order not to develop hardware from scratch, you can take the server and insert a PCIe card with FPGA. <br><br><h3>  Acceleration Calculations </h3><br>  Such cards can also be used to speed up some calculations or simulations, for example, for biology or chemistry.  An example of such a simulation told <a href="https://habrahabr.ru/users/algeronflowers/" class="user_link">Algeronflowers</a> in <a href="http://habrahabr.ru/post/266897/">this</a> article.  In this case, the Ethernet ports may not be necessary, but on the other hand they can be useful if you want to make a farm from the boards: transfer input or output data for the calculation via Ethernet. <br><br><h4>  Opencl </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/bcb/54c/ead/bcb54ceadba6e1cb29e796d82a1a501d.png" alt="image"><br><br>  Sometimes there is no need to squeeze out all the juice from the iron: very often time-to-market is important.  Many developers refuse to use FPGA, because  they are frightened by the low-level optimization to the cycles (plus you need to know the new language (s) and tool).  I would like to write code at the ‚Äúhigh‚Äù level, and the compiler will already decompose everything into triggers / memory blocks.  One such option is <a href="https://ru.wikipedia.org/wiki/OpenCL">OpenCL</a> .  <a href="https://www.altera.com/products/design-software/embedded-software-developers/opencl/overview.html">Altera</a> and <a href="http://www.xilinx.com/products/design-tools/software-zone/sdaccel.html">Xilinx</a> support. <br><br>  OpenCL on FPGA is the topic of a separate article (and not one).  I recommend to familiarize with the <a href="http://omega.sp.susu.ac.ru/books/conference/PaVT2014/talks/Vystorovsky.pdf">presentation</a> from Alter about the technology review and the route of development for FPGA. <br><br><h4>  Highload </h4><br>  On the Internet you can find a lot of news, that the giants are looking at the FPGA for processing big data in data centers. <br><br>  So, there was a <a href="http://habrahabr.ru/post/226665/">note</a> that Microsoft used FPGA to speed up the search engine Bing.  Technical details can be found in <a href="http://research.microsoft.com/pubs/212001/Catapult_ISCA_2014.pdf"><b>A Reconfigurable Fabric for Accelerating Large-Scale Datacenter Services</b></a> . <br><br>  Unfortunately, there is no good technical article in Russian about this, although the topic is very interesting.  Can <a href="https://habrahabr.ru/users/olgakuznet_ms/" class="user_link">olgakuznet_ms</a> or her colleagues fix this flaw? <br><br>  I hope that the <a href="http://habrahabr.ru/company/nordavind/blog/227057/">release</a> of CPU + FPGA chips will spur developers of highly loaded systems to transfer part of the calculations to FPGA.  Yes, development under FPGA is ‚Äúmore difficult‚Äù than under CPU, but on specific tasks it can give a remarkable result. <br><br><h3>  Development / debugging of IP-cores and software </h3><br>  Such cards can still be used by ASIC / FPGA developers to verify their IP cores, which can then be run on completely different hardware. <br><br>  It often happens that the software is written at the same time as the piece of hardware is being developed / manufactured, and it is already necessary to debug the software somewhere.  In this context, software is like FPGA + firmware, various drivers and user programs.  In the <a href="http://metrotek.spb.ru/b100.html">100G</a> project of the <a href="http://metrotek.spb.ru/b100.html">analyzer and balancer</a> , problems arose that we never solved: <br><br><ul><li>  FPGA tuning (CSR: status control registers) must occur via PCIe </li><li>  for linux'a FPGA with a bunch of interfaces should look like a network card: you need to write the driver (s), and transfer packages from / to the host </li></ul><br>  Of course, there were other tasks in parallel (such as the generation / filtering of 100G traffic), but they were easily solved in the simulator, but these two tasks in the simulator are not particularly chasing.  What have we done?  It turned out that we have a <a href="https://www.altera.com/products/boards_and_kits/dev-kits/altera/kit-pciexpress_s2gx.html">devbord</a> from Altera.  Despite the fact that there is a completely different chip, another PCIe, etc., we debugged a bunch of FPGA + drivers on it, and when the production department handed us the board for b100, then after raising the iron, the whole bunch worked without problems. <br><br><a name="scheme"></a><h2>  General scheme </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/8b9/9e7/16b/8b99e716b7dfe6564e31c222c3d1ffc3.png" alt="image"><br>  Before reviewing the cards, consider the general scheme of such PCIe cards. <br><br><h3>  Ethernet </h3><br>  The boards are equipped with standard Ethernet connectors: <br><ul><li>  SFP - 1G </li><li>  SFP + - 10G </li><li>  QSFP - 40G </li><li>  CFP / CFP2 / CFP4 - 100G </li></ul><br>  The most common combinations are: <br><ul><li>  4 x SFP / SFP + </li><li>  2 x QSFP </li><li>  1 x CFP </li></ul><br>  About what is happening at a low level and how the connection to 10G to integrated circuits takes place can be found, for example, <a href="http://habrahabr.ru/company/metrotek/blog/234369/">here</a> . <br><br><h3>  PCIe </h3><br>  A standard connector that can be plugged into a computer with an ordinary motherboard.  Currently, top FPGAs support Gen3 x8 hardware IP cores, but this bandwidth (~ 63 Gbps) is not enough for all tasks.  On some boards, there is a PCIe switch that combines 2 Gen3 x8 channels into one Gen3 x16. <br><br>  On future chips, Altera and Xilinx announce hardware support for Gen3 x16, and even Gen4. <br><br><h3>  Connectors </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/80a/7f0/77c80a7f0d57473744f4457a13c9a756.png" alt="image"><br><br>  Sometimes place the connector (s) for connecting expansion cards, but there is no single de facto standard (such as USB).  The most common are <a href="http://www.vita.com/Specifications">VITA</a> ( <a href="https://en.wikipedia.org/wiki/FPGA_Mezzanine_Card">FMC</a> ) and <a href="https://www.altera.com/content/dam/altera-www/global/en_US/pdfs/literature/ds/hsmc_spec.pdf">HSMC</a> . <br><br><h4>  Avago MiniPod </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/40e/621/bbe/40e621bbe2a1282c7cf8544d82fa9f1b.jpg" alt="image" width="500" height="413"><br><br>  The above connectors have a slight drawback - they are metallic and at high frequencies / long distances the attenuation can be significant. <br><br>  In response to this problem, Avago developed <a href="http://www.avagotech.com/products/fiber-optics/embedded-optical-module/minipod-embedded-optical-modules/">Avago Minipod</a> : optical transceivers.  They are ready to transfer 12 Lane 10-12.5GBd.  The size of the connector is comparable to the coin.  With this connector, you can connect not only nearby boards, but also make connections in supercomputers or in racks between servers. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/HvFmJhQOIgw%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhaTwg5-VwNjYUABdLst3UDDrtSVg" frameborder="0" allowfullscreen=""></iframe><br><br>  When our colleagues showed the MiniPod demo on such a <a href="http://www.enterpoint.co.uk/products/arria-v-development-boards/hsoptic-1/">board</a> , they said that no additional IP cores or Verilog-code should be inserted - these modules are simply connected to the I / O of the FPGA transceivers, and everything works. <br><br><h3>  External memory </h3><br>  There are not so many memories in FPGAs - in the top 50-100 Mbit chips.  To handle big data, external memory is connected to the chip. <br>  There are two types of memory: <br><br><ul><li>  DRAM: DDR, <a href="https://en.wikipedia.org/wiki/RLDRAM">RLDRAM</a> </li><li>  SRAM: <a href="https://en.wikipedia.org/wiki/Quad_Data_Rate_SRAM">QDR</a> </li></ul><br>  The selection takes into account such parameters as price, volume, delays for sequential / random reading, throughput, power consumption, availability of memory controllers, easy wiring / replacement, and so on. <br><br>  Altera has an <b>External Memory Interface Handbook</b> , which, as it is not difficult to guess, is dedicated to external memory.  The interested reader in the chapter <b>Selecting Your Memory</b> will find comparison tables for various types of memory and tips for choosing.  The guide itself is available <a href="https://www.altera.com/content/dam/altera-www/global/en_US/pdfs/literature/hb/external-memory/emi.pdf">here</a> (carefully, the file is large). <br><br>  If you look at the use of memory in communication networks, the tips are something like this: <br><br><ul><li>  DRAM is used to create large buffers (for packets). </li><li>  SRAM: <br><ul><li>  decision tables / structures where to send the packet </li><li>  queue management structures </li><li>  packet statistics calculation (RMON, etc.) </li></ul></li><li>  hybrid approach is possible - DRAM is used to store the payload of the packet, and only the header is placed in SRAM </li></ul><br>  If you open the presentation of <a href="http://www.cisco.com/web/HR/ciscoconnect/2013/pdfs/Anatomy_of_Core_Network_Elements_Josef_Ungerman.pdf">Anatomy of Internet Routers</a> from Cisco, you can see that they use RLDRAM as DRAM in some routers. <br><br><h4>  HMC </h4><br>  <a href="http://www.micron.com/products/hybrid-memory-cube">HMC</a> (Hybrid Memory Cube) is a new type of RAM memory, which in some applications can displace DDR / QDR memory: they promise a significant acceleration of bandwidth and lower power consumption.  On Habr√© you can find news: <a href="http://habrahabr.ru/company/intel/blog/130179/">one</a> and <a href="http://habrahabr.ru/post/175521/">two</a> .  In the comments to them you can find fears that this is still far away and so on. <br><br>  I assure you that everything is not so bad.  So, six months (!) Ago, our colleagues from EBV showed a working <a href="https://www.altera.com/solutions/technology/serial-memory/hybrid-memory-cubes.html">demoboard</a> of four Stratix V (on the sides) and HMC (in the center). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5fa/740/811/5fa74081188d7e38f6664a2f6a147d17.jpg" alt="image"><br><br>  Commercial samples (for mass production) are expected to be available in 2015. <br><br><a name="overview"></a><h2>  Review of PCIe cards </h2><br>  The review is probably too loud a word - I will try to show the most interesting representatives from different companies.  There will be no comparison or unpacking tables.  In fact, there will not be much variety between the boards, they all fit into the ‚Äúpattern‚Äù that was described earlier.  I am sure that you can find about five or seven companies that produce such cards, and about a dozen more boards. <br><br><h3>  <a href="http://netfpga.org/site/"><font color="#00bfff"><u>NetFPGA 10G</u></font></a> </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/797/dad/f5e/797dadf5e0505fd926585b2511301309.jpg" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  FPGA: <br><br><ul><li>  Xilinx Virtex-5 TX240T </li><li>  240K logic cells </li><li>  11,664 Kbit block RAM </li></ul><br>  10-Gigabit Ethernet networking ports <br><ul><li>  4 SFP + connectors </li></ul><br>  Quad Data Rate Static Random Access Memory (QDRII SRAM) <br><ul><li>  300MHz Quad data rate (1.2 Giga transactions every second), synchronous with the logic </li><li>  Three parallel banks of 72 MBit QDRII + memories </li><li>  Total capacity: 27 MBytes </li><li>  Cypress: CY7C1515KV18 </li></ul><br>  Reduced Latency Random Access Memory (RLDRAM II) <br><ul><li>  Four x36 RLDRAMII on-board device </li><li>  400MHz clock (800MT / s) </li><li>  115.2 Gbps peak memory throughput </li><li>  Total Capacity: 288MByte </li><li>  Micron: MT49H16M36HT-25 </li></ul><br></div></div><br>  This is not the top card, but I could not tell about it: <br><br><ul><li>  NetFPGA boards are positioned as ‚Äúopen platforms for research‚Äù: they are used throughout the world (in more than 150 institutions).  Students / researchers can do various labs / projects for them. </li><li>  the project is positioned as opensource: there is an <a href="https://github.com/NetFPGA">organization of the</a> same name on github.  On the githaba in the private repository there are various reference designs (network card, switch, router, etc.), which are written in Verilog and distributed under the LGPL.  They will be available after a <a href="http://netfpga.org/site/">simple registration</a> . </li></ul><br><h3>  <a href="http://www.advancedio.com/products/function/programmable-network-interface-solutions/v5031/"><font color="#00bfff"><u>Advanced IO V5031</u></font></a> </h3><br><br><img src="https://habrastorage.org/getpro/habr/post_images/af2/37c/966/af237c966975e10d3de2c3b41647e6ed.jpg" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ul><li>  Altera Stratix V </li><li>  Quad 10 Gigabit Ethernet SFP + optical ports </li><li>  2 banks of 1GB to 8GB 72-bit 1066MHz DDR3 SDRAM </li><li>  4 banks of 36Mbit to 144Mbit 18-bit 350MHz QDRII + SRAM </li><li>  x8 PCI Express Gen 3 </li><li>  PPS Interface for time synchronization with microsecond resolution </li></ul><br></div></div><br>  This board has a twin brother: <a href="http://www.advancedio.com/products/form-factor/pci-express/capturexg%25E2%2584%25A2-1000-quad-10-gigabit-ethernet-capture-pci-express-card/">captureXG 1000</a> , but it is already positioned as a card for recording data streams: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ul><li>  Time Synchronization: IRIG-A, B and G time synchronization </li><li>  Filters: 128 programmable 5-tuple filters (IPv4, TCP, UDP, ICMP, ARP) </li><li>  Packet Capture: PCAP Next Generation format or raw data format </li></ul><br></div></div><br>  In fact, the card that was shown above, wrote the firmware for the FPGA, as well as the driver.  And it already turns out another product that is ready to work out of the box.  I wonder what the difference in money between the two products. <br><br><h3>  <a href="http://www.napatech.com/products/nt40e3-4-ptp"><font color="#00bfff"><u>Napatech NT40E3-4-PTP</u></font></a> </h3><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d53/3ab/046/d533ab0469e7cc3b58c81875ea9cba3f.jpg" alt="image"><br><br>  Another card for recording and analyzing traffic: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ul><li>  FPGA: Xilinx Virtex-7 </li><li>  Quad 10 Gigabit Ethernet SFP + optical ports </li><li>  4 GB DDR3 </li><li>  PCIe x8 Gen 3 </li></ul><br>  Alas, it was not possible to squeeze more technical details from the marketing brochure. <br><br></div></div><br><br>  In this case, it looks very pretty.  Fundamentally, this card is not very different from the others, but Napatech considers it as a finished product and screwed in a bunch of features that are implemented on the FPGA: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ul><li>  Hardware Time Stamp </li><li>  Full line-rate packet capture </li><li>  Frame buffering </li><li>  Frame and protocol information </li><li>  Time stamp injection </li><li>  Buffer size configuration </li><li>  Onboard IEEE 1588-2008 (PTP v2) support </li><li>  Inter-Frame Gap Control </li><li>  Frame Classification </li><li>  HW Time Synchronization </li><li>  Extended RMON1 port statistics </li><li>  Advanced statistics </li><li>  Synchronized statistics delivery </li><li>  Flow identification based on hash keys </li><li>  Dynamic hash key selection </li><li>  Frame and flow filtering </li><li>  Deduplication </li><li>  Slicing </li><li>  Intelligent multi-CPU distribution </li><li>  Cache pre-fetch optimization </li><li>  Coloring </li><li>  IP fragment handling </li><li>  Checksum verification </li><li>  Checksum generation </li><li>  GTP tunneling support </li><li>  IP-in-IP tunneling support </li><li>  Filtering inside tunnels </li><li>  Slicing inside tunnels </li></ul><br></div></div><br>  All this can be done on other cards.  Just need to spend time on it. <br><br><h3>  <a href="https://www.invea.com/en/products-and-services/fpga-cards/combo-80g"><font color="#00bfff"><u>COMBO-80G</u></font></a> </h3><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a2d/ce5/a72/a2dce5a7243be3a8ebcd21b37acf9406.jpg" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ul><li>  Virtex-7 FPGA chip manufactured by Xilinx company </li><li>  2 √ó QSFP + cage multi / single mode, CWDM or copper </li><li>  4 √ó 10G to 40G fanout modules for 10G Ethernet technology </li><li>  PCI Express 3.0 x8, throughput up to 50Gb / s to software </li><li>  2 √ó 72Mbits QDRII + SRAM memory </li><li>  2 √ó 1152Mbits RLDRAM III memory </li><li>  2 √ó 4GB DDR3 memory </li><li>  External PPS (Pulse per second) synchronization </li><li>  Unique on-the-fly FPGA boot system (no need for host computer reboot) </li></ul><br></div></div><br><h3>  <a href="http://www.nallatech.com/store/pcie-accelerator-cards/nallatech-385a-arria10-1150-fpga/"><font color="#00bfff"><u>Nallatech 385A</u></font></a> and <a href="http://www.nallatech.com/store/pcie-accelerator-cards/385c-with-arria-10-gt1150-fpga/"><font color="#00bfff"><u>Nallatech 385C</u></font></a> </h3><br><br><img src="https://habrastorage.org/files/2e3/34b/fe7/2e334bfe77154990ab4a2480269c169e.png" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  385A: <br><br><ul><li>  Arria 10 1150 GX FPGA with up to 1.5 TFlops </li><li>  Network Enabled with (2) QSFP 10/40 GbE Support </li></ul><br>  385C: <br><br><ul><li>  Altera Arria 10 GT FPGA with up to 1.5 TFlops </li><li>  Network Enabled with (2) QSFP28 100 GbE support </li></ul><br>  General: <br><br><ul><li>  Low Profile PCIe form factor </li><li>  8 GB DDR3 on-card memory </li><li>  PCIe Gen3 x8 Host Interface </li><li>  OpenCL tool flow </li></ul><br></div></div><br>  As you can see, these are two twin brothers: the 385A has a more budget FPGA (GX) with 17.4 Gbps transceivers, which is enough for 10 / 40G, while the 385C already uses the Arria 10 GT, since  need 28 Gpbs transceivers to support 100G, which come in 4x25G performance. <br><br>  I note that Nallatech provides OpenCL <abbr title="Board Support Package">BSP</abbr> for these cards. <br><br><h3>  <a href="http://www.hitechglobal.com/Boards/x16PCIExpress-Gen3.htm"><font color="#00bfff"><u>HiTech Global 100G NIC</u></font></a> </h3><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a6/ff7/f06/2a6ff7f06b40ad010ae5054222548364.png" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ul><li>  x1 Xilinx Virtex-7 H580T </li><li>  x16 PCI Express Gen3 (16x8Gbps) </li><li>  x1 CFP2 (4x25Gbps) </li><li>  x1 CFP4 (4x25Gbps) </li><li>  x1 Cypress QDR IV SRAM </li><li>  x2 DDR3 SODIMMs (with support up to 16GB) </li><li>  x4 Avago MiniPod (24 Tx and 24 Rx) for board-to-board high-speed communications </li><li>  x1 FMC with 8 GTH transceivers and 34 LVDS pairs (LA0-LA33) </li></ul><br></div></div><br>  Here we are seeing both the FMC connector for connecting other boards, and the Avago MiniPod, which we talked about earlier. <br><br><h3>  <b>Bonus:</b> </h3><br><h3>  <a href="http://www.nallatech.com/store/fpga-accelerated-computing/pcie-accelerator-cards/nallatech-510t-fpga-computing-acceleration-card/"><font color="#00bfff"><u>Nallatech 510T</u></font></a> </h3><br><br><img src="https://habrastorage.org/getpro/habr/post_images/087/ab6/871/087ab68713a065337b29a8b7b6711cad.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/757/724/002/7577240022b7e1f0825c7f7e73ca84a7.jpg" alt="image"><br><br>  There is no Ethernet in this card, but this is a real <b>bomb</b> . <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><ul><li>  GPU Form Factor Card with (2) Arria 10 10A1150GX FPGAs </li><li>  Dual Slot Standard Configuration </li><li>  Single Slot width possible, if user design fits within ~ 100W power footprint </li><li>  PCIe Gen3 x 16 Host Interface </li><li>  290 GBytes / s Peak Aggregate Memory Bandwidth: <br><ul><li>  85GB / s Peak DDR4 Memory Bandwidth Per FPGA (4 Banks per FPGA) </li><li>  30GB / s Write + 30GB / s Read Peak HMC Bandwidth per FPGA </li></ul></li></ul><br></div></div><br>  Here and two fatty top-end chips, which are riveted on 20-nm technology, and DDR4, and HMC.  Performance promises up to 3 TFlops! <br><br>  Judging by the render, it‚Äôs still far from a real piece of iron, but it is felt that it will be gold (for the price), but it will take its niche: it is positioned as a coprocessor for data centers.  They promise support for OpenCL, which means that no one will be babysitting to the beat with this board: they will drive ready-made algorithms and burn watts.  Who knows, maybe on this board Youtube, Facebook, VK will convert the video, replacing dozens of servers?  Or maybe special effects for a new Avatar will be rendered on such farms? <br><br><h2>  Conclusion </h2><br>  Having looked at all this variety of boards, my colleagues and I thought: why don't we also make such a card? <br>  According to the complexity of the printed circuit board, it will not be more complicated than the <a href="http://metrotek.spb.ru/b100.html">B100</a> , we seem to be able to write software for FPGA and Linux, and there is a demand for certain companies and departments for such hardware. <br><br>  My colleagues and I argued a little about which card to make, and we are interested in what you think about this. <br><br>  Thanks for attention!  Ready to answer questions in the comments or in PM. </div><p>Source: <a href="https://habr.com/ru/post/267183/">https://habr.com/ru/post/267183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267173/index.html">Algorithm for schoolchildren: from beginner to Olympic medalist</a></li>
<li><a href="../267175/index.html">As we did ABC analysis for retail, or ‚Äúwithout half a liter you will not understand‚Äù</a></li>
<li><a href="../267177/index.html">Secure login with PHPixie 3</a></li>
<li><a href="../267179/index.html">Game for Railways: complete story</a></li>
<li><a href="../267181/index.html">Using CSS4 features today with cssnext</a></li>
<li><a href="../267185/index.html">The course "Basics of effective work with Wolfram technologies". Lesson 2.2: Defining Functions, Working with Lists, Template Expressions, and Associations</a></li>
<li><a href="../267187/index.html">How I became a programmer. The path from St. Petersburg homeless to Senior Developer for 6 years</a></li>
<li><a href="../267189/index.html">IP monitoring in blacklists using Zabbix</a></li>
<li><a href="../267191/index.html">jQuery Autocomplete: passing parameters from one field to another</a></li>
<li><a href="../267193/index.html">News from the front about licensing products JetBrains</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>