<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Design pattern "Fitter" / "Flyweight"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Read the description of other patterns. 

 Problem 
 Designing objects of the lowest levels of the system can provide optimal flexibility, however, is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Design pattern "Fitter" / "Flyweight"</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://spiff.habrahabr.ru/blog/84706/">Read the</a> description of other patterns. <br><br><h4>  Problem </h4><br>  Designing objects of the lowest levels of the system can provide optimal flexibility, however, is accompanied by unacceptable memory and performance. <br><br><h4>  Description </h4><br>  As already noted, there are a large number of software systems, the purpose of which is to construct complex composite objects from a large number of smaller and simple objects.  At the same time, the flexibility and versatility of such systems is achieved by providing the user with a complete set of tools and primitives.  It is important to understand that the primitives in this context are elementary objects from which composite are subsequently constructed.  Moreover, the level at which the object is considered primitive, in fact, determines the applicability and effectiveness of this system.  However, it is not always possible to design a system down to the lowest levels of abstraction.  The cost of memory and low system performance, with the direct approach, do not allow this.  Therefore, when designing such systems, the ‚ÄúFitter‚Äù pattern is often used. <br><a name="habracut"></a><br><blockquote>  Adaptive uses separation to effectively support many small objects. </blockquote><br>  The main idea of ‚Äã‚Äãthe pattern is the difference between the internal and external state of the object.  The external state is transmitted by the client using the opportunist in some context.  The internal state is stored directly in the opportunist and allows you to separate them.  Under the division refers to the possibility of simultaneous work of several clients with the same opportunist.  Thus, there are two types of opportunists - shared and not shared.  It is obvious that a client working with adapters does not make assumptions about their nature, but only uses them in a given context.  Therefore, the client should be provided with a transparent mechanism for separating adapters. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Adaptive can be simultaneously used in different contexts.  He seems to be "adapting" to the context of his use.  At the client, at the same time, it seems that he works with different objects.  Although, in fact, it is one and the same opportunist. <br><br>  Summing up, all of the above, it is worth noting that opportunists model entities of the subject area, the number of which is too large to represent them as real objects. <br><br><h4>  Practical task </h4><br>  Consider the problem of designing a vector editor.  Moreover, for maximum flexibility of the editor, it is necessary to design it down to the lowest levels - to the elementary primitive - point.  Obviously, with the direct approach in one drawing there can be a huge number of points, working with which and storing them in the memory of the editor will not be easy.  Therefore, we will design the editor using the ‚ÄúFitter‚Äù pattern. <br><br>  Let the vector editor know how to work with a limited set of primitives - Square (Square), Circle (Circle), Point (Point) and Picture (Picture).  All these primitives are adapters.  Moreover, only the image is not a divided adaptive, due to its composite nature.  It is worth noting that the image in this case is an example of the ‚ÄúLinker‚Äù pattern.  The rest of the primitives should be divided on the basis of their internal state.  For a square - the size of the sides (height, width), for a circle - the radius (radius).  The point, although it is a shared opportunist, does not have an internal state, in view of the fact that all the information necessary for its rendering is given by the client to the so-called.  context of drawing (Context). <br><br><h4>  Class diagram </h4><br>  In this example, a factory, PrimitiveFactory, was used to implement the mechanism for adapting the opportunists.  The factory is not the only mechanism for separating objects.  In some cases, you can get by with static class members. <br><img src="http://img197.imageshack.us/img197/6977/flayweight.png"><br><br><h4>  Java implementation </h4><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">/*</font> <br> <font color="#008000">*  </font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">interface</font> Primitive { <br> <font color="#008000">/*</font> <br> <font color="#008000">*        </font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> draw(Context context); <br> } <br> <br> <font color="#008000">/*</font> <br> <font color="#008000">*  -  .   - </font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Circle implements Primitive { <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> radius; <br> <br> <font color="#0000ff">public</font> Circle( <font color="#0000ff">int</font> radius) { <br> <font color="#0000ff">this</font> .radius = radius; <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> draw(Context context) { } <br> } <br> <br> <font color="#008000">/*</font> <br> <font color="#008000">*   - .</font> <br> <font color="#008000">*   - , .</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Square implements Primitive { <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> height, width; <br> <br> <font color="#0000ff">public</font> Square( <font color="#0000ff">int</font> height, <font color="#0000ff">int</font> width) { <br> <font color="#0000ff">this</font> .height = height; <br> <font color="#0000ff">this</font> .width = width; <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> draw(Context context) { } <br> } <br> <br> <font color="#008000">/*</font> <br> <font color="#008000">*   - </font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Point implements Primitive { <br> @Override <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> draw(Context context) { } <br> } <br> <br> import java.util.Arrays; <br> import java.util.LinkedList; <br> import java.util. <font color="#2B91AF">List</font> ; <br> <br> <font color="#008000">/*</font> <br> <font color="#008000">*    - .</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Picture implements Primitive { <br> <font color="#0000ff">private</font> <font color="#2B91AF">List</font> &lt;Primitive&gt; childrens; <br> <br> <font color="#0000ff">public</font> Picture(Primitive ...primitives) { <br> <font color="#0000ff">this</font> .childrens = <font color="#0000ff">new</font> LinkedList&lt;Primitive&gt;(); <br> <font color="#0000ff">this</font> .childrens.addAll(Arrays.asList(primitives)); <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> draw(Context context) { <br> <font color="#0000ff">for</font> (Primitive p: childrens) { <br> p.draw(context); <br> } <br> } <br> } <br> <br> import java.awt.Color; <br> <font color="#008000">/*</font> <br> <font color="#008000">*  ,      </font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> final <font color="#0000ff">class</font> Context { <br> <font color="#0000ff">public</font> final <font color="#0000ff">int</font> x; <br> <font color="#0000ff">public</font> final <font color="#0000ff">int</font> y; <br> <font color="#0000ff">public</font> final Color color; <br> <br> <font color="#0000ff">public</font> Context( <font color="#0000ff">int</font> x, <font color="#0000ff">int</font> y, Color collor) { <br> <font color="#0000ff">this</font> .x = x; <br> <font color="#0000ff">this</font> .y = y; <br> <font color="#0000ff">this</font> .color = collor; <br> } <br> } <br> <br> import java.util.HashMap; <br> import java.util.Map; <br> <br> <font color="#008000">/*</font> <br> <font color="#008000">*  .</font> <br> <font color="#008000">*        .</font> <br> <font color="#008000">*</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">abstract</font> <font color="#0000ff">class</font> PrimitiveFactory { <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> Point onePoint; <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> Map&lt;Integer, Circle&gt; circles; <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> Map&lt;Integer, Square&gt; squares; <br> <br> <font color="#0000ff">static</font> { <br> circles = <font color="#0000ff">new</font> HashMap&lt;Integer, Circle&gt;(); <br> squares = <font color="#0000ff">new</font> HashMap&lt;Integer, Square&gt;(); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> synchronized Picture createPicture(Primitive ... childrens) { <br> <font color="#0000ff">return</font> <font color="#0000ff">new</font> Picture(childrens); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> synchronized Circle createCircle( <font color="#0000ff">int</font> radius) { <br> <font color="#0000ff">if</font> (circles. <font color="#0000ff">get</font> (radius) == <font color="#0000ff">null</font> ) { <br> circles.put(radius, <font color="#0000ff">new</font> Circle(radius)); <br> } <br> <br> <font color="#0000ff">return</font> circles. <font color="#0000ff">get</font> (radius); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> synchronized Square createSquare( <font color="#0000ff">int</font> height, <font color="#0000ff">int</font> width) { <br> <font color="#0000ff">if</font> (squares. <font color="#0000ff">get</font> (height*10+width) == <font color="#0000ff">null</font> ) { <br> squares.put(height*10+width, <font color="#0000ff">new</font> Square(height, width)); <br> } <br> <br> <font color="#0000ff">return</font> squares. <font color="#0000ff">get</font> (height*10+width); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> synchronized Point createPoint() { <br> <font color="#0000ff">if</font> (onePoint == <font color="#0000ff">null</font> ) { <br> onePoint = <font color="#0000ff">new</font> Point(); <br> } <br> <br> <font color="#0000ff">return</font> onePoint; <br> } <br> } <br> <br> import java.awt.Color; <br> <br> <font color="#008000">// </font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Main { <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main( <font color="#2B91AF">String</font> [] args) { <br> <br> Primitive[] primitives = { <br> PrimitiveFactory.createPoint(), <br> PrimitiveFactory.createCircle(10), <br> PrimitiveFactory.createSquare(20, 30), <br> PrimitiveFactory.createCircle(20), <br> PrimitiveFactory.createCircle(20), <br> PrimitiveFactory.createPoint(), <br> PrimitiveFactory.createSquare(20, 40), <br> }; <br> <br> Picture picture = PrimitiveFactory.createPicture(primitives); <br> Context context = <font color="#0000ff">new</font> Context(10, 20, Color.BLUE); <br> picture.draw(context); <br> } <br> } <br> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  It is important to understand that the applicability of this pattern is determined, first of all, by how clearly the internal and external states of the system objects are identified. </div><p>Source: <a href="https://habr.com/ru/post/88393/">https://habr.com/ru/post/88393/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../88384/index.html">Personal finance management without the exhausting logging of every purchase</a></li>
<li><a href="../88385/index.html">Linux Data Encryption</a></li>
<li><a href="../88386/index.html">twitter2vk - from Twitter to VKontakte</a></li>
<li><a href="../88389/index.html">elFinder - file manager for the site. New taste</a></li>
<li><a href="../88392/index.html">Wow Mobile and other news from U'tel</a></li>
<li><a href="../88394/index.html">LINQ to SQL and concurrent access conflicts</a></li>
<li><a href="../88396/index.html">Use SQLCLR to improve performance</a></li>
<li><a href="../88398/index.html">Is placing SSH on a port other than 22 justified?</a></li>
<li><a href="../88399/index.html">Soyuz-Telecom mobile WiMAX will appear in forty-two settlements of the Moscow region. (Terms not yet named.)</a></li>
<li><a href="../88403/index.html">The epic of personal data continues</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>