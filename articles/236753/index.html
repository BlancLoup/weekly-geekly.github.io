<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Flask Mega-Tutorial, Part 13: Date and Time</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the thirteenth article in the series, where I describe my experience of writing a Python web application using the Flask mic framework. 

 The...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Flask Mega-Tutorial, Part 13: Date and Time</h1><div class="post__text post__text-html js-mediator-article">  This is the thirteenth article in the series, where I describe my experience of writing a Python web application using the Flask mic framework. <br><br>  The purpose of this guide is to develop a fairly functional microblog application, which I decided to call microblog, in the absence of originality. <br><br><div class="spoiler">  <b class="spoiler_title">Table of contents</b> <div class="spoiler_text">  <a href="http://habrahabr.ru/post/193242/">Part 1: Hello, World!</a> <br>  <a href="http://habrahabr.ru/post/193260/">Part 2: Templates</a> <br>  <a href="http://habrahabr.ru/post/194062/">Part 3: Forms</a> <br>  <a href="http://habrahabr.ru/post/196810/">Part 4: Database</a> <br>  <a href="http://habrahabr.ru/post/222983/">Part 5: User Login</a> <br>  <a href="http://habrahabr.ru/post/223375/">Part 6: Profile Page and Avatars</a> <br>  <a href="http://habrahabr.ru/post/223783/">Part 7: Unit Testing</a> <br>  <a href="http://habrahabr.ru/post/230643/">Part 8: Subscribers, Contacts and Friends</a> <br>  <a href="http://habrahabr.ru/post/230897/">Part 9: Pagination</a> <br>  <a href="http://habrahabr.ru/post/234613/">Part 10: Full Text Search</a> <br>  <a href="http://habrahabr.ru/post/234737/">Part 11: Email Support</a> <br>  <a href="http://habrahabr.ru/post/234785/">Part 12: Reconstruction</a> <br>  <a href="http://habrahabr.ru/post/236753/">Part 13: Date and Time (this article)</a> <br>  <a href="http://habrahabr.ru/post/236861/">Part 14: I18n and L10n</a> <br>  <a href="http://habrahabr.ru/post/237065/">Part 15: Ajax</a> <br>  <a href="http://habrahabr.ru/post/237317/">Part 16: Debugging, Testing, and Profiling</a> <br>  <a href="http://habrahabr.ru/post/237489/">Part 17: Deploying to Linux (even to Raspberry Pi!)</a> <br>  <a href="http://habrahabr.ru/post/237517/">Part 18: Deploying to Heroku Cloud</a> <br></div></div><br><a name="habracut"></a><br><blockquote><h5>  <b>GitHub note</b> </h5><br>  For those who have not noticed, I recently transferred the source codes of microblog to github.  The repository is located at the following address: <br>  <a href="https://github.com/miguelgrinberg/microblog">https://github.com/miguelgrinberg/microblog</a> <br>  For each step of this tutorial, appropriate tags have been added. </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Problem with timestamp</b> </h4><br>  One feature of our application that we have ignored for a long time is the display of date and time. <br><br>  Until now, we trusted python to display the timestamps stored in our User and Post objects in its sole discretion, which is not really a good solution. <br><br>  Consider the following example.  I write this at 15:54, December 31, 2012.  My time zone is PST (or UTC -8 if you prefer).  By running the python interpreter, I get the following results: <br><br><pre><code class="bash hljs">&gt;&gt;&gt; from datetime import datetime &gt;&gt;&gt; now = datetime.now() &gt;&gt;&gt; <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> now 2012-12-31 15:54:42.915204 &gt;&gt;&gt; now = datetime.utcnow() &gt;&gt;&gt; <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> now 2012-12-31 23:55:13.635874</code> </pre> <br>  A call now () returns the correct time for my time zone, while utcnow () displays GMT time. <br><br><h5>  <b>So which function is better to use?</b> </h5><br>  If we decide to use now (), then all the timestamps that we plan to save to our database will depend on the location of our server and this may cause some problems. <br><br>  One day it may be necessary to transfer the server to another time zone.  And in this case, all time stamps stored in the database will need to be corrected in accordance with the new local time before starting the server. <br><br>  But there is a more serious problem with this approach.  For users from different time zones, it will be difficult to determine exactly when the post was published, if they see it in the PST time zone.  To be defined, users should know also that time is specified concerning PST. <br><br>  Obviously, this is not the best option, and that is why when we created our database, it was decided to store the time stamps in GMT. <br><br>  However, having brought timestamps to a certain standard, we solved only the first problem (with transferring the server to a different time zone), while the second question remained without a solution - timestamps will be displayed to absolutely all Greenwich users. <br><br>  This can still confuse users.  Imagine a user from the PST time zone who posted a blog entry around 3:00 pm.  The record immediately appeared on the main page, but it indicated the creation time of 23:00. <br><br>  Thus, the purpose of today's article is to clarify the issues of displaying the date and time, so as not to confuse our users. <br><br><h4>  <b>User timestamps</b> </h4><br>  An obvious solution to the problem is an individual time conversion according to GMT to local time for each user.  This will allow us to continue using Greenwich Mean Time in our database, and the time converted for each user on the fly will make the time consistent for everyone. <br><br>  But how do we know the location of our users? <br><br>  Many sites have a settings page where the user can specify their time zone.  To do this, you need to add a new page with a form containing a drop-down list of existing time zones.  Part of the registration will be the answer to the question about the user's time zone. <br>  Despite the fact that this solution is fully functional and solves the task, it seems somewhat redundant - asking the user to enter information that has already been configured and stored in the OS.  It seems to be much more efficient, just get the time zone settings from the user's computer. <br><br>  However, for security reasons, browsers will not allow us to access the user's system and, therefore, to obtain the necessary information.  Even if it were technically possible, we would need to know exactly where to look for the current settings for time zones on Windows, Linux, Mac, iOS, and Android (and this is not counting the less common operating systems). <br><br>  It turns out that the browser knows the user's time zone and makes it available through the standard javascript interface.  In the modern Web 2.0 world, it‚Äôs quite possible to count on javascript enabled in the browser (in practice, no modern website will work correctly with javascript disabled), so this solution is worth considering. <br><br>  We have two options for using the javascript time zone information: <br><ol><li>  The traditional (oldschool) approach is to ask the browser to send us information about the user's time zone when the user first visits our site.  This can be done with Ajax or, much more simply, with a meta refresh tag.  As soon as the server recognizes the time zone, it can save this information in the user's session and adjust all the time stamps in the template during its drawing. </li><li>  The modern (new-school) approach is to not involve the server in this process and allow it to send timestamps to the browser of the user in GMT.  And the conversion of time in accordance with the user's time zone will occur on the client using javascript. </li></ol><br><br>  Both options are correct, but the second has an advantage.  The browser has more features in the correct date display in accordance with the settings of the user's system locale.  Details such as AM / PM (12-hour) or 24-hour time format are used, DD / MM / YY or MM / DD / YY date format is preferred and many others are available to the browser and are unknown to the server. <br><br>  And if these arguments in favor of the second option are not enough, then there is another advantage of this approach.  It turns out that all the work has already been done for us! <br><br><h4>  <b>Meet moment.js</b> </h4><br>  <a href="http://momentjs.com/">Moment.js</a> is a compact open source javascript library that takes date and time drawing to a new level.  It provides all sorts of formatting options, and one more thing. <br><br>  To use moment.js in our application, we will have to add quite a bit of javascript to our templates.  We start by creating the moment object from time in ISO 8601 format. For example, using GMT from the example above, we will create a moment object like this: <br><br><pre> <code class="javascript hljs">moment(<span class="hljs-string"><span class="hljs-string">"2012-12-31T23:55:13 Z"</span></span>)</code> </pre><br>  Once an object is created, it can be converted to a string with a huge variety of formats.  For example, a rather verbose display in accordance with the system settings of the locale might look like this: <br><br><pre> <code class="javascript hljs">moment(<span class="hljs-string"><span class="hljs-string">"2012-12-31T23:55:13 Z"</span></span>).format(<span class="hljs-string"><span class="hljs-string">'LLLL'</span></span>);</code> </pre><br>  And here is how the system will display this date: <br><br><pre> <code class="bash hljs">Tuesday, January 1 2013 1:55 AM</code> </pre><br>  Here are some more examples of the same timestamp displayed in various formats: <br><table><tbody><tr><th>  Format </th><th>  Result </th></tr><tr><td>  L </td><td>  01/01/2013 </td></tr><tr><td>  Ll </td><td>  January 1 2013 </td></tr><tr><td>  Lll </td><td>  January 1 2013 1:55 AM </td></tr><tr><td>  Llll </td><td>  Tuesday, January 1 2013 1:55 AM </td></tr><tr><td>  dddd </td><td>  Tuesday </td></tr></tbody></table><br>  Support by the library of various options does not end there.  In addition to format (), the library offers fromNow () and calendar (), with a much more friendly display of timestamps: <br><br><table><tbody><tr><th>  Format </th><th>  Result </th></tr><tr><td>  fromNow () </td><td>  2 years ago </td></tr><tr><td>  calendar () </td><td>  01/01/2013 </td></tr></tbody></table><br>  Note that in all the examples presented, the server gives the same GMT time, and the necessary conversions are made by the user's browser. <br><br>  And the last part of the javascript magic we missed is to make the string returned by the method of the moment object visible on the page.  The easiest way to achieve this is to use the javascript document.write function, as shown below: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(moment(<span class="hljs-string"><span class="hljs-string">"2012-12-31T23:55:13 Z"</span></span>).format(<span class="hljs-string"><span class="hljs-string">'LLLL'</span></span>));</code> </pre><br>  And although the use of document.write is very simple and straightforward as a way to generate a fragment of an HTML document using javascript, you should remember that this implementation has some limitations.  The most significant of these is that document.write can only be used during document loading and cannot be used to change a document after it has finished loading.  And, as a consequence of this limitation, this solution will not work when loading data via Ajax. <br><br><h4>  <b>Integration moment.js</b> </h4><br>  There are a few things we need to do to use moment.js in our application. <br><br>  First, you need to place the downloaded library moment.min.js in the folder / app / static / js, so that it will be given to clients as static (static file). <br><br>  Then, add this library to our base template (file app / templates / base.html): <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/js/moment.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now we can add &lt;script&gt; tags to the templates that display the time stamps and the job will be done.  But instead, we will create a wrapper for moment.js, which we can use in templates.  This will save us time in the future if we decide to change the code for displaying timestamps, because it will be enough to change just one file. <br><br>  Our wrapper will be a very simple python class (file app / momentjs.py): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jinja2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Markup <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">momentjs</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, timestamp)</span></span></span><span class="hljs-function">:</span></span> self.timestamp = timestamp <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, format)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Markup(<span class="hljs-string"><span class="hljs-string">"&lt;script&gt;\ndocument.write(moment(\"%s\").%s);\n&lt;/script&gt;"</span></span> % (self.timestamp.strftime(<span class="hljs-string"><span class="hljs-string">"%Y-%m-%dT%H:%M:%SZ"</span></span>), format)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, fmt)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.render(<span class="hljs-string"><span class="hljs-string">"format(\"%s\")"</span></span> % fmt) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calendar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.render(<span class="hljs-string"><span class="hljs-string">"calendar()"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromNow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.render(<span class="hljs-string"><span class="hljs-string">"fromNow()"</span></span>)</code> </pre><br><br>  Notice that the render method does not return a string directly; instead, it is an instance of the Markup class provided by Jinja2 by our template engine.  The point is that Jinja2 by default escapes all lines, so &lt;script&gt; can get to the client in this form &amp; lt; script &amp; gt ;.  By returning an instance of the Markup object instead of a string, we told Jinja2 that this line was not necessary to escape. <br><br>  Now that we have a wrapper, we need to add it to Jinja2 so that we can use it in our templates (file app / __ init__.py): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> momentjs <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> momentjs app.jinja_env.globals[<span class="hljs-string"><span class="hljs-string">'momentjs'</span></span>] = momentjs</code> </pre><br>  By this we allowed Jinja2 to provide our class as a global variable in all templates. <br><br>  Now we are ready to make changes to our templates.  There are two places in our application where we display the date and time.  The first is the user profile page, where we show the time of the last visit.  To display on this page, we will apply the calendar () formatting (file app / templates / user.html): <br><br><pre> <code class="html hljs xml">{% if user.last_seen %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">em</span></span></span><span class="hljs-tag">&gt;</span></span>Last seen: {{momentjs(user.last_seen).calendar()}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">em</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {% endif %}</code> </pre><br>  The second place is a post template that is used on the index, user and search pages.  In the post template, we apply the formatting fromNow (), since the exact time of post creation is not as important as the elapsed time after post creation.  Since  we selected post rendering to a separate template, now we only need to make changes in one place to change all pages displaying posts (file app / templates / post.html): <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{url_for('user', nickname = post.author.nickname)}}"</span></span></span><span class="hljs-tag">&gt;</span></span>{{post.author.nickname}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> said {{momentjs(post.timestamp).fromNow()}}:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span>{{post.body}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  And with this simple change, we solved all our problems with timestamps.  And, at the same time, no changes were required to the server code! <br><br><h4>  <b>Conclusion</b> </h4><br>  Without even noticing, today we have taken a significant step towards increasing the availability of our application for users from all over the Network, by changing the date display in accordance with the user's locale settings. <br><br>  In the next article of this series, we will try to please our foreign users even more, since we will include support for several languages. <br><br>  Download: <a href="">microblog-0.13.zip.</a> <br>  Or, if you like it better, you can find the source code on <a href="">GitHub</a> . <br><br>  Miguel </div><p>Source: <a href="https://habr.com/ru/post/236753/">https://habr.com/ru/post/236753/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236741/index.html">Bookmarklet: Analysis of Essential Moments, Part Three, Backup</a></li>
<li><a href="../236743/index.html">Development and debugging of UEFI-drivers on Intel Galileo, part one, introductory</a></li>
<li><a href="../236745/index.html">MugenMvvmToolkit - cross-platform MVVM framework</a></li>
<li><a href="../236747/index.html">Thoughts on the virtual-real game (survey)</a></li>
<li><a href="../236749/index.html">The Hive: A Little War, A Deep Strategy, A Strange GameDev</a></li>
<li><a href="../236755/index.html">Use of libraries in projects on Unity3D</a></li>
<li><a href="../236757/index.html">Overview of the most interesting materials on data analysis and machine learning ‚Ññ13 (September 8 - 14, 2014)</a></li>
<li><a href="../236759/index.html">Analysis of lost passwords Gmail, Yandex and Mail.Ru</a></li>
<li><a href="../236761/index.html">Superiority Mask. About the magic of "Merlin" put in a word</a></li>
<li><a href="../236763/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ125 (September 8 - 14, 2014)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>