<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New type of DDoS attack: TCP bug found in Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dear habour-readers, before going to the point I want to immediately say that the author is not any hacker or malicious programmer exploring with ever...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New type of DDoS attack: TCP bug found in Windows</h1><div class="post__text post__text-html js-mediator-article">  Dear habour-readers, before going to the point I want to immediately say that the author is not any hacker or malicious programmer exploring with every candle every dark corner of a driver or something else software, so if you already know about this vulnerability, Do not judge strictly, but better advise the patch. <br><br>  So, in the process of debugging the protocol stack for <a href="http://habrahabr.ru/post/197860/">MANET</a> networks, where a modified TCP connection of a radio network to a computer through an Ethernet gateway was tested, it was accidentally revealed that by incorrectly closing the connection by the client on the server side, socket resources could be held indefinitely! <br><br>  It all started with this: <br><img src="https://habrastorage.org/getpro/habr/post_images/306/553/49b/30655349b54283c8a356a8c4fe5626d6.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The screen shot shows a TCP connection between a 192.168.0.108 client (Ethernet gateway) and a 192.168.0.187 server (Windows Vista OS). <br><br>  As you can see, if you incorrectly specify the sequence number in the FIN ACK client, the Windows server did not close the socket and did not release the resources.  Attempting to connect again from the same client port (source port 40400) to the server port (destination port 31000) was unsuccessful.  The server persistently demanded an ACK in response to a new SYN from the client. <br><br>  At first, I decided that this was just some kind of bug on the side of the MANET stack (besides, of course, the wrong seqno in FIN ACK), but after analyzing the flow by sequence / acknowledgment numbers and repeating the same experiment for other ports, it turned out that yes, Windows ... <br><br>  An example of another server port (30000): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/455/9f5/bc1/4559f5bc1c380336d91823e961b51f07.jpg"><br><br>  Then, rebooting the computer and repeated it again.  This time the connection was closed by the client, and the server listened to port 32000. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41f/518/cb9/41f518cb9fe8c11d726332c7f023b8d0.jpg"><br><br>  The result is the same. <br><a name="habracut"></a><br>  Then the netstat command looked at the state of the sockets and was horrified ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b4/524/fae/7b4524fae4b9f58cdaae8e53d585fa72.jpg"><br>  The server keeps open sockets that are not in nature for many hours !!! <br>  And most likely, only forced killing of processes or rebooting will save the situation, since  obviously in the FIN_WAIT_2 state, Windows has no timer for the socket and it does not go to the TIME_WAIT state to clear resources. <br><br><h5>  Summary </h5><br>  1. Please urge that this vulnerability be known. <br>  If this is a newly discovered bug, then it threatens many network products on Windows OS. <br><br>  2. It would be interesting to investigate this problem on other servers and OS, primarily Linux. <br><br>  3. Learn the network protocols! <br><br>  PS <br>  a day has passed since the discovery of the problem - the resources have been allocated so far ... </div><p>Source: <a href="https://habr.com/ru/post/198164/">https://habr.com/ru/post/198164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198152/index.html">Bitcoin users may have discovered Ross Ulbricht‚Äôs personal wallet</a></li>
<li><a href="../198154/index.html">Localization of Node.js applications Part 2: Toolkit and Process</a></li>
<li><a href="../198158/index.html">Warp9 is another reactive js library. At this time composable and without leaks</a></li>
<li><a href="../198160/index.html">Google shares for the first time reached $ 1000</a></li>
<li><a href="../198162/index.html">Send Hyper-V Server 2012 R2 and Windows Server 2012 R2</a></li>
<li><a href="../198166/index.html">The mathematical model predicts the outcome of the Kickstarter campaign with 76% confidence 4 hours after its start.</a></li>
<li><a href="../198170/index.html">New US Navy Destroyer Running Linux</a></li>
<li><a href="../198172/index.html">Creating an active 3d mold (discussion of theoretical possibility)</a></li>
<li><a href="../198174/index.html">Fighting a thirty-year bug</a></li>
<li><a href="../198178/index.html">Display issues in MacBook Air 2013</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>