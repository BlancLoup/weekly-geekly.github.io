<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The Japanese presented a prototype processor for an ex-flop supercomputer: how does a chip work?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Earlier we talked about the most powerful Japanese supercomputer for research in the field of nuclear physics. Now Japan is creating an ex-flop superc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The Japanese presented a prototype processor for an ex-flop supercomputer: how does a chip work?</h1><div class="post__text post__text-html js-mediator-article">  Earlier we <a href="https://habr.com/company/it-grad/blog/351816/">talked</a> about the most powerful Japanese supercomputer for research in the field of nuclear physics.  Now Japan is creating an ex-flop supercomputer Post-K - the Japanese will be among the first to launch a machine with such computing power. <br><br>  Commissioning is scheduled for 2021. <br><br>  Last week, Fujitsu told about the technical characteristics of the A64FX chip, which will form the basis of the new ‚Äúmachine‚Äù.  Tell us more about the chip and its capabilities. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="https://habr.com/company/it-grad/blog/421439/"><img src="https://habrastorage.org/webt/fu/vc/wx/fuvcwxsv0fm4foljjr75p20s-ha.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ photo <a href="https://goo.gl/dBSGYQ">Toshihiro Matsui</a> <a href="">CC</a> / Japanese <a href="https://ru.wikipedia.org/wiki/K_computer">K computer</a> supercomputer</i></font> <br><br><h2>  Specifications A64FX </h2><br>  It is expected that the computing capabilities of Post-K will be almost ten times <a href="https://www.extremetech.com/computing/272558-japan-tests-silicon-for-exascale-computing-in-2021">higher than the</a> performance of the most powerful of the existing <a href="https://www.top500.org/lists/2018/06/">IBM Summit</a> supercomputers ( <a href="https://www.top500.org/lists/2018/06/">according to data for June 2018</a> ). <br><br>  Such performance supercomputer required chip A64FX architecture Arm.  This chip <a href="https://www.top500.org/news/fujitsu-reveals-details-of-processor-that-will-power-post-k-supercomputer/">consists</a> of 48 cores for computational operations and four cores for controlling them.  All of them are evenly divided into four groups - Core Memory Groups (CMG). <br><br>  Each group has 8 MB of L2 cache.  It is connected to the memory controller and the NoC interface (‚Äú <a href="https://en.wikipedia.org/wiki/Network_on_a_chip">network on chip</a> ‚Äù).  NoC connects various CMGs with PCIe and Tofu controllers.  The latter is responsible for the connection of the processor with the rest of the system.  The Tofu controller has ten ports with a bandwidth of 12.5 GB / s. <br><br>  The chip layout is as follows: <br><br><img src="https://habrastorage.org/webt/vg/cn/zy/vgcnzyvhj-g9-tbyflj8tkf1jdc.png"><br><br>  The total <a href="https://en.wikipedia.org/wiki/High_Bandwidth_Memory">HBM2</a> memory <a href="https://en.wikipedia.org/wiki/High_Bandwidth_Memory">capacity of</a> the processor is 32 gigabytes, and its bandwidth is 1024 GB / s.  Fujitsu says that processor performance on floating point operations reaches 2.7 teraflops for 64-bit operations, 5.4 teraflops for 32-bit operations and 10.8 teraflops for 16-bit operations. <br><br>  The creation of Post-K is monitored by Top500 resource editors, who make up the list of the most powerful computing systems.  According to them, more than 370 thousand A64FX processors are used in a supercomputer to achieve performance in one exaflops. <br><br>  The device will first use the technology of vector expansion called Scalable Vector Extension (SVE).  It differs from other <a href="https://ru.wikipedia.org/wiki/SIMD">SIMD architectures</a> in that it does not <a href="https://developer.arm.com/products/software-development-tools/hpc/documentation/introducing-scalable-vector-extension-sve">limit the</a> length of vector registers, but gives them a valid range.  SVE supports vectors from 128 to 2048 bits in length.  So any program can be run on other processors that support SVE, without the need for recompilation. <br><br>  With the help of SVE (since this is a SIMD function), the processor can simultaneously perform calculations with several data arrays.  Here is an example of one such instruction for the NEON function, which was used for vector computing in other Arm processor architectures: <br><br><pre><code class="cpp hljs">vadd.i32 q1, q2, q3</code> </pre> <br>  It adds four 32-bit integers from the 128-bit q2 register with the corresponding numbers in the 128-bit q3 register and writes the resulting array to q1.  The equivalent of this C operation looks like this: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; i++) a[i] = b[i] + c[i];</code> </pre> <br>  Additionally, SVE supports the auto-vectoring feature.  The automatic vectorizer analyzes loops in code and, if possible, uses vector registers itself to execute them.  This improves code performance. <br><br>  For example, a function on C: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vectorize_this</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *b, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; SIZE; i++) { a[i] = b[i] + c[i]; } }</code> </pre><br>  It will be compiled as follows (for a 32-bit Arm processor): <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">104</span></span>cc: ldr.w r3, [r4, #<span class="hljs-number"><span class="hljs-number">4</span></span>]! <span class="hljs-number"><span class="hljs-number">104</span></span>d0: ldr.w r1, [r2, #<span class="hljs-number"><span class="hljs-number">4</span></span>]! <span class="hljs-number"><span class="hljs-number">104</span></span>d4: cmp r4, r5 <span class="hljs-number"><span class="hljs-number">104</span></span>d6: add r3, r1 <span class="hljs-number"><span class="hljs-number">104</span></span>d8: str.w r3, [r0, #<span class="hljs-number"><span class="hljs-number">4</span></span>]! <span class="hljs-number"><span class="hljs-number">104</span></span>dc: bne.n <span class="hljs-number"><span class="hljs-number">104</span></span>cc &lt;vectorize_this+<span class="hljs-number"><span class="hljs-number">0xc</span></span>&gt;</code> </pre><br>  If you use auto-vectorization, then it will look like this: <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">10780</span></span>: vld1<span class="hljs-number"><span class="hljs-number">.64</span></span> {d18-d19}, [r5 :<span class="hljs-number"><span class="hljs-number">64</span></span>] <span class="hljs-number"><span class="hljs-number">10784</span></span>: adds r6, #<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">10786</span></span>: cmp r6, r7 <span class="hljs-number"><span class="hljs-number">10788</span></span>: add.w r5, r5, #<span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">1078</span></span>c: vld1<span class="hljs-number"><span class="hljs-number">.32</span></span> {d16-d17}, [r4] <span class="hljs-number"><span class="hljs-number">10790</span></span>: vadd.i32 q8, q8, q9 <span class="hljs-number"><span class="hljs-number">10794</span></span>: add.w r4, r4, #<span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">10798</span></span>: vst1<span class="hljs-number"><span class="hljs-number">.32</span></span> {d16-d17}, [r3] <span class="hljs-number"><span class="hljs-number">1079</span></span>c: add.w r3, r3, #<span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">107</span></span>a0: bcc.n <span class="hljs-number"><span class="hljs-number">10780</span></span> &lt;vectorize_this+<span class="hljs-number"><span class="hljs-number">0x70</span></span>&gt;</code> </pre><br>  Here, the SIMD registers q8 and q9 are loaded with data from the arrays pointed to by r5 and r4.  Then the vadd instruction adds four 32-bit integer values ‚Äã‚Äãat a time.  This increases the amount of code, but much more data is processed this way for each iteration of the loop. <br><br><h2>  Who else creates exaflops supercomputers </h2><br>  Creating exaflops supercomputers are engaged not only in Japan.  For example, work is also being done in China and the United States. <br><br>  In China, create Tianhe-3 (Tianhe-3).  Its prototype is already <a href="https://www.top500.org/news/prototypes-of-chinas-exascale-supercomputers-point-to-some-new-realities/">being tested</a> at the National Supercomputer Center in Tianjin.  The final version of the computer is scheduled for completion in 2020. <br><br><img src="https://habrastorage.org/webt/xu/lo/zs/xulozshlwidto-wsdxhxnjrguly.jpeg"><br>  <font color="#A9A9A9"><i>/ photo <a href="">O01326</a> <a href="">CC</a> / Supercomputer <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D1%258F%25D0%25BD%25D1%258C%25D1%2585%25D1%258D-2">Tianhe-2</a> - predecessor of Tianhe-3</i></font> <br><br>  At the heart of Tianhe-3 <a href="http://www.ejinsight.com/20180814-we-can-t-rely-on-foreign-chips-says-china-supercomputer-builder/">are</a> Chinese processors Phytium.  The device contains 64 cores, <a href="https://www.top500.org/news/chinese-chipmaker-unveils-speedy-64-core-arm-processor/">has a performance</a> of 512 gigaflops and a memory bandwidth of 204.8 GB / s. <br><br>  A working prototype was created for the car from the <a href="https://ru.wikipedia.org/wiki/Sunway_TaihuLight">Sunway</a> series.  It is being tested at the National Supercomputer Center in Jinan.  According to the developers, about 35 applications are currently operating on the computer - these are biomedical simulators, applications for processing big data, and programs for studying climate change.  It is expected that work on the computer will be completed in the first half of 2021. <br><br>  As for the United States, the Americans <a href="https://www.nextplatform.com/2018/08/16/argonne-leverages-hpc-and-machine-learning-to-accelerate-science/">are planning to create</a> their exaflops computer by 2021.  The project is called Aurora A21, and the <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D1%2580%25D0%25B3%25D0%25BE%25D0%25BD%25D0%25BD%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25BD%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BB%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2580%25D0%25B0%25D1%2582%25D0%25BE%25D1%2580%25D0%25B8%25D1%258F">Argonne National Laboratory of the US Department of Energy</a> , as well as Intel and Cray, are working on it. <br><br>  This year, researchers have already <a href="https://www.hpcwire.com/off-the-wire/alcf-selects-data-and-learning-projects-for-aurora-early-science-program/">selected</a> ten projects for the Aurora Early Science Program, whose participants will be the first to use the new high-performance system.  Among them were programs for creating a <a href="https://habr.com/company/it-grad/blog/338618/">map</a> of brain neurons, studying dark matter, and developing a particle accelerator simulator. <br><br>  Exaflops computers will make it possible to build complex models for research, so many scientific projects await the creation of such machines.  One of the most ambitious is the Human Brain Project (HBP), whose goal is to create a complete model of the human brain and study neuromorphic calculations.  As the HBP scientists <a href="https://www.humanbrainproject.eu/en/follow-hbp/news/an-algorithm-for-large-scale-brain-simulations/">say</a> , the use of new exaflops systems will be found from the very first days of their existence. <br><br><hr><br>  <i>What we do in IT-GRAD: ‚Ä¢ <a href="https://www.it-grad.ru/services/iaas/iaas-vmware-virtual-infrastructure/">IaaS</a> ‚Ä¢ <a href="https://www.it-grad.ru/services/iaas/pci-dss/">PCI DSS hosting</a> ‚Ä¢ <a href="https://www.it-grad.ru/services/iaas/fz-152/">Cloud FZ-152</a></i> <br><br><hr><br>  <i>Materials from our blog about corporate IaaS:</i> <i><br><br></i> <ul><li>  <i><a href="https://iaas-blog.it-grad.ru/tendencii/besservernye-vychisleniya-v-oblake-trend-sovremennosti-ili-neobxodimost/">Serverless computing in the cloud - a trend of modernity or necessity?</a></i> </li><li>  <i><a href="https://iaas-blog.it-grad.ru/blog/onlajn-uslugi-dlya-b2cb2b-iz-oblaka/">How to place 100% of the infrastructure in the cloud IaaS-provider and not regret it</a></i> </li><li>  <i><a href="https://iaas-blog.it-grad.ru/kejsy/oblachnye-texnologii-v-finansovoj-sfere-opyt-rossijskix-kompanij/">Cloud technologies in the financial sector: the experience of Russian companies</a></i> </li></ul> <i><br><br></i> </div><p>Source: <a href="https://habr.com/ru/post/421439/">https://habr.com/ru/post/421439/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../421425/index.html">Tame and Consolidate: The Story of Moving to the Oracle Supercluster</a></li>
<li><a href="../421429/index.html">Dynamic Pricing Based on LSTM - ANN in the Home Retail</a></li>
<li><a href="../421431/index.html">Time Management, or Effective Chaos Management</a></li>
<li><a href="../421433/index.html">There are exactly a day left before the server starts</a></li>
<li><a href="../421435/index.html">‚ÄúWhy are we doing all this?‚Äù - the creator of Prisma and the former leader of VK projects about his new secret project</a></li>
<li><a href="../421441/index.html">Embox begins climbing Elbrus</a></li>
<li><a href="../421443/index.html">New to our market: Snom D385 and D785 IP phones overview</a></li>
<li><a href="../421445/index.html">Writing a simple Lisp translator - II</a></li>
<li><a href="../421447/index.html">Redmadrobot iOS Meetup</a></li>
<li><a href="../421451/index.html">How to protect your child from garbage on YouTube and make a custom player with a white list of channels</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>