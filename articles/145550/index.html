<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automation of music management in the office, any song on order via ICQ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am an office employee. My workplace is an office in which besides me 6 more people are sitting. I have long been used to the fact that the backgroun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automation of music management in the office, any song on order via ICQ</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/aea/8e4/c7b/aea8e4c7be7a5bbbe02111b4e3a6f913.png"><br>  I am an office employee.  My workplace is an office in which besides me 6 more people are sitting.  I have long been used to the fact that the background is always playing music, with the exception of those workflows in which concentration is needed.  Listening to music in headphones is somehow uncomfortable, and the head starts to hurt soon.  Therefore, I always listened to her in such a way that it was impossible for my ‚Äúneighbors‚Äù not to hear her.  They scolded me ... but they scolded me not because I was disturbing them with the music itself, but because I was listening to the wrong music.  Then I had a desire to please everyone, so that everyone could, without rising from his seat, turn on any song, even the one that is not on the computer. <br><a name="habracut"></a><br><h5>  Scheme </h5><br>  At first glance, automation should include the following features: enabling any track from the online network, changing the track, adjusting the volume, being able to pause playback and, accordingly, remove the pause from the pause, and also be able to turn on the track located locally on the computer.  I am not really familiar with programming as such, except for reading the AutoIT manual (I always wanted to be able to automate any processes in Windows systems).  A scheme immediately appeared in my head: AutoIT + ICQ + Foobar + A plugin for Foobar that allows you to search and listen to music online from the social network VKontakte (its window is shown in the screenshot).  The point is simple: my colleagues send messages to a certain asya, the AutoIT script ‚Äúpicks up‚Äù them and, in accordance with the message, performs manipulations with Foobar. <br><br><h5>  Implementation </h5><br>  Since during AutoIT, all script manipulations are visible on the screen: opening windows, selecting a track, and so on, I initially planned to use a virtual machine for it, but turning around, I saw the idle computer of the recently retired employee and decided that the ‚Äúmedia center‚Äù would be he. <br><img src="https://habrastorage.org/storage2/117/eab/88d/117eab88d04e056f9ee9e1912dcb6f2b.png" alt="image" align="right"><br>  First of all, I registered a new ICQ account for the bot.  Coming up with a nickname for him did not take long - "Remote".  Then I installed QIP 8095 on the selected computer - I chose this client because the messages in it are stored as txt files.  I set it up in the following way: I turned off saving the history of service messages (that someone from the contact list entered the network or went out, etc.), also turned off all sounds so that they would not distract from the work of colleagues.  Then I installed Foobar with the necessary plug-in and configured it to work with hot keys.  And at the end I brought the bot and myself into the contact list of all the employees sitting with me in the office. <br><br>  After completing all the preparatory work began to write the script itself.  The principle of its operation is simple: every 2 seconds it must check the folder in which QIP stores the history of correspondence, the presence of a txt file, if the file is located, it reads the message from it, deletes the history file itself and, in accordance with what was written in the message makes manipulations with Foobar'om. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  What happened in the end </h5><br>  Script: <br><br><blockquote>  <font color="#0000FF">Func</font> Terminate <font color="#FF0000">(</font> <font color="#FF0000">)</font> <font>;</font>  <font>Script off function as it works in an infinite loop</font> <br>  <font color="#0000FF">Exit</font> <font color="#AC00A9">0</font> <br>  <font color="#0000FF">Endfunc</font> <br>  <font color="#000080">HotKeySet</font> <font color="#FF0000">(</font> <font>"{ESC}"</font> <font color="#FF0000">,</font> <font>"Terminate"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Binds off function to ESC key</font> <br><br>  <font color="#000080">FileChangeDir</font> <font color="#FF0000">(</font> <font>"C: Program FilesQIPUsersXXXXXXXXXXHistory"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Changes the working directory</font> <br><br>  <font color="#0000FF">while</font> <font color="#AC00A9">1</font> <font>;</font>  <font>Starts endless script loop</font> <br>  <font>$ Search</font> <font color="#FF0000">=</font> <font color="#000080">FileFindFirstFile</font> <font color="#FF0000">(</font> <font>"* .txt"</font> <font color="#FF0000">)</font> <font>;</font>  <font>It searches for txt files in the working directory and returns the search value to the $ Search variable</font> <br>  <font color="#0000FF">if</font> <font>$ Search</font> <font color="#FF0000">=</font> <font color="#FF0000">-</font> <font color="#AC00A9">1</font> <font color="#0000FF">then</font> <font>;</font>  <font>Checks the presence of files on the contents of the variable</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">1000</font> <font color="#FF0000">)</font> <font>;</font>  <font>If no files are found, wait a second and start the cycle again.</font> <br>  <font color="#0000FF">else</font> <font>;</font>  <font>If txt file is found, then ...</font> <br>  <font>$ File</font> <font color="#FF0000">=</font> <font color="#000080">FileFindNextFile</font> <font color="#FF0000">(</font> <font>$ Search</font> <font color="#FF0000">)</font> <font>;</font>  <font>Enter file name into $ File</font> <br>  <font>$ Log</font> <font color="#FF0000">=</font> <font color="#000080">FileRead</font> <font color="#FF0000">(</font> <font>$ File</font> <font color="#FF0000">)</font> <font>;</font>  <font>Filing file contents into $ log variable</font> <br>  <font>$ Log</font> <font color="#FF0000">=</font> <font color="#000080">StringSplit</font> <font color="#FF0000">(</font> <font>$ Log</font> <font color="#FF0000">,</font> <font>@LF</font> <font color="#FF0000">)</font> <font>;</font>  <font>Since in QIP one message consists of three lines (marking the message as incoming or outgoing, author‚Äôs name / date / time of sending the message and the message itself), it makes an array of variables in which each element is equal to one line</font> <br>  <font>$ Mess</font> <font color="#FF0000">=</font> <font>$ log</font> <font color="#FF0000">[</font> <font color="#AC00A9">3</font> <font color="#FF0000">]</font> <font>;</font>  <font>The message itself enters the $ Mess variable</font> <br>  <font color="#000080">FileDelete</font> <font color="#FF0000">(</font> <font>$ File</font> <font color="#FF0000">)</font> <font>;</font>  <font>Deletes history file</font> <br>  <font color="#000080">MsgBox</font> <font color="#FF0000">(</font> <font>"0"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font color="#AC00A9">1</font> <font color="#FF0000">)</font> <font>;</font>  <font>For a second, it displays a message with a command that the script will now execute - this is implemented for debugging</font> <br>  <font color="#000080">WinActivate</font> <font color="#FF0000">(</font> <font>'[REGEXPCLASS :(? I) {97E27FAA-C0B3-4b8e-A693-ED7881E99FC1}]'</font> <font color="#FF0000">)</font> <font>;</font>  <font>It makes the Foobar window active, implemented by referring to the class, since the title of the player changes depending on the composition being played.</font> <br>  <font color="#000080">WinWaitActive</font> <font color="#FF0000">(</font> <font>'[REGEXPCLASS :(? I) {97E27FAA-C0B3-4b8e-A693-ED7881E99FC1]]'</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for Foobar window to become active.</font> <br><br>  <font>$ Check</font> <font color="#FF0000">=</font> <font color="#000080">StringInStr</font> <font color="#FF0000">(</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font>"local"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Checks the entry of the word "local" in the message text</font> <br>  <font color="#0000FF">if</font> <font>$ Check</font> <font color="#FF0000">=</font> <font color="#AC00A9">1</font> <font color="#0000FF">then</font> <font>;</font>  <font>If "local" is at the beginning of the message, then ...</font> <br>  <font>$ Mess</font> <font color="#FF0000">=</font> <font color="#000080">StringTrimLeft</font> <font color="#FF0000">(</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font color="#AC00A9">6</font> <font color="#FF0000">)</font> <font>;</font>  <font>"Cuts off" the first 6 characters in the message (the word local followed by a space)</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"^ f"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Send CTRL + F keystroke</font> <br>  <font color="#000080">WinWaitActive</font> <font color="#FF0000">(</font> <font>'[REGEXPCLASS :(? I) {483DF8E3-09E3-40d2-BEB8-67284CE3559F}]]'</font> <font color="#FF0000">)</font> <font>;</font>  <font>We are waiting for the track search window to open.</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>$ mess</font> <font color="#FF0000">)</font> <font>;</font>  <font>Enters the request message content</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting half a second</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"{TAB}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Sends TAB keystroke</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"{TAB}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Sends keystroke TAB (makes an active element of the window in which the search result is displayed)</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"{DOWN}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Sends the DOWN keystroke (the first track found by the search is highlighted)</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"{ENTER}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Includes found track</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#000080">WinClose</font> <font color="#FF0000">(</font> <font>'[REGEXPCLASS :(? I) {483DF8E3-09E3-40d2-BEB8-67284CE3559F}]]'</font> <font color="#FF0000">)</font> <font>;</font>  <font>Close the search box</font> <br>  <font color="#0000FF">continueloop</font> <font>;</font>  <font>Returns to the beginning of the loopless while loop</font> <br>  <font color="#0000FF">endif</font> <font>;</font>  <font>If the word "local" is not at the beginning of the message, then the script continues reading from here ...</font> <br><br>  <font>$ Stop</font> <font color="#FF0000">=</font> <font color="#000080">StringRegExp</font> <font color="#FF0000">(</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font>"stop"</font> <font color="#FF0000">)</font> <font>;</font>  <font>... looking for the entry of the word "stop" in the message</font> <br>  <font>$ VolUp</font> <font color="#FF0000">=</font> <font color="#000080">StringRegExp</font> <font color="#FF0000">(</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font>"louder"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Looks for the entry of the word "louder" in the message</font> <br>  <font>$ VolDown</font> <font color="#FF0000">=</font> <font color="#000080">StringRegExp</font> <font color="#FF0000">(</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font>"quieter"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Looks for the entry of the word "quieter" in the message</font> <br>  <font>$ VolMax</font> <font color="#FF0000">=</font> <font color="#000080">StringRegExp</font> <font color="#FF0000">(</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font>"loud"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Looks for the entry of the word "loud" in the message</font> <br>  <font>$ VolMin</font> <font color="#FF0000">=</font> <font color="#000080">StringRegExp</font> <font color="#FF0000">(</font> <font>$ Mess</font> <font color="#FF0000">,</font> <font>"quiet"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Looks for the word "quiet" in the message</font> <br><br>  <font color="#0000FF">if</font> <font>$ Stop</font> <font color="#FF0000">=</font> <font color="#AC00A9">1</font> <font color="#0000FF">then</font> <font>;</font>  <font>If the word "stop" is sent, then ..</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! X"</font> <font color="#FF0000">)</font> <font>;</font>  <font>... send ALT + X, which pauses / continues playback</font> <br>  <font color="#0000FF">continueloop</font> <font>;</font>  <font>Returns to the beginning of the loopless while loop</font> <br>  <font color="#0000FF">endif</font> <br><br>  <font color="#0000FF">if</font> <font>$ VolUp</font> <font color="#FF0000">=</font> <font color="#AC00A9">1</font> <font color="#0000FF">then</font> <font>;</font>  <font>If the word "louder" is sent, then ...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {UP}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {UP}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {UP}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {UP}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {UP}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Press the ALT + UP key combination 5 times, which slightly increases the volume</font> <br>  <font color="#0000FF">continueloop</font> <font>;</font>  <font>Returns to the beginning of the loopless while loop</font> <br>  <font color="#0000FF">endif</font> <br><br>  <font color="#0000FF">if</font> <font>$ VolDown</font> <font color="#FF0000">=</font> <font color="#AC00A9">1</font> <font color="#0000FF">then</font> <font>;</font>  <font>If the word "louder" is sent, then ...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {DOWN}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {DOWN}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {DOWN}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {DOWN}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! {DOWN}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Press the ALT + DOWN key combination 5 times, which slightly decreases the volume</font> <br>  <font color="#0000FF">continueloop</font> <font>;</font>  <font>Returns to the beginning of the loopless while loop</font> <br>  <font color="#0000FF">endif</font> <br><br>  <font color="#0000FF">if</font> <font>$ VolMax</font> <font color="#FF0000">=</font> <font color="#AC00A9">1</font> <font color="#0000FF">then</font> <font>;</font>  <font>If the word "loud" is sent, then ...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! C"</font> <font color="#FF0000">)</font> <font>;</font>  <font>... send the shortcut key ALT + C, which turns on the maximum volume</font> <br>  <font color="#0000FF">continueloop</font> <font>;</font>  <font>Returns to the beginning of the loopless while loop</font> <br>  <font color="#0000FF">endif</font> <br><br>  <font color="#0000FF">if</font> <font>$ VolMin</font> <font color="#FF0000">=</font> <font color="#AC00A9">1</font> <font color="#0000FF">then</font> <font>;</font>  <font>If the word "silent" is sent, then ...</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"! Z"</font> <font color="#FF0000">)</font> <font>;</font>  <font>... will send the key combination ALT + Z, which turns on the minimum volume (does not turn it off at all)</font> <br>  <font color="#0000FF">continueloop</font> <font>;</font>  <font>Returns to the beginning of the loopless while loop</font> <br>  <font color="#0000FF">endif</font> <br><br>  <font>;</font>  <font>If not one of the standing ups did not work, then ...</font> <br><br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"^ q"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Sends the CTRL + Q key combination, which is responsible for opening the Foobar plugin window, which searches for music on VKontakte</font> <br>  <font color="#000080">WinWaitActive</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting until the plugin window is active.</font> <br>  <font color="#000080">ControlCommand</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>"ComboBox1"</font> <font color="#FF0000">,</font> <font>"SetCurrentSelection"</font> <font color="#FF0000">,</font> <font color="#AC00A9">6</font> <font color="#FF0000">)</font> <font>;</font>  <font>From the drop-down list "What services to search for" selects vk.com (VKontakte)</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting half a second</font> <br>  <font color="#000080">ControlFocus</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>"Edit1"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Makes the query input line active.</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>$ mess</font> <font color="#FF0000">)</font> <font>;</font>  <font>Sends the contents of the message from QIP to the input line</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">5000</font> <font color="#FF0000">)</font> <font>;</font>  <font>Wait 5 seconds while the plugin is looking for a track</font> <br><br>  <font color="#0000FF">while</font> <font color="#AC00A9">1</font> <font>;</font>  <font>I do not know how else to implement what will happen next, except with the use of an infinite loop</font> <br>  <font>$ i</font> <font color="#FF0000">=</font> <font color="#000080">ControlListView</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>"SysListView321"</font> <font color="#FF0000">,</font> <font>"GetItemCount"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Pushes the number of tracks found into the variable $ i</font> <br>  <font color="#0000FF">if</font> <font>$ i</font> <font color="#FF0000">=</font> <font color="#AC00A9">0</font> <font color="#0000FF">then</font> <font>;</font>  <font>If no tracks are found (the plugin sometimes does not find results from the first time)</font> <br>  <font color="#000080">ControlClick</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>"Button1"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Clicks on the "Stop Search" button</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#000080">ControlClick</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>"Button1"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Click on the "Search" button</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">5000</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#0000FF">exitloop</font> <font>;</font>  <font>Exits from the inner infinite while loop (from the second time it always finds)</font> <br>  <font color="#0000FF">else</font> <br>  <font color="#0000FF">exitloop</font> <font>;</font>  <font>If you did not find it the first time, then, most likely, the name of the track was entered incorrectly and the script also leaves the internal while loop</font> <br>  <font color="#0000FF">endif</font> <br>  <font color="#0000FF">wend</font> <br><br>  <font color="#000080">ControlListView</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>"SysListView321"</font> <font color="#FF0000">,</font> <font>"Select"</font> <font color="#FF0000">,</font> <font color="#AC00A9">1</font> <font color="#FF0000">)</font> <font>;</font>  <font>Selects the second track from the search result (the first one is often for some reason 00:00 and does not play)</font> <br>  <font color="#000080">ControlClick</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">,</font> <font>""</font> <font color="#FF0000">,</font> <font>"Button3"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Adds a second track to the playlist.</font> <br>  <font color="#000080">WinClose</font> <font color="#FF0000">(</font> <font>"vk.com audio Search"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Closes the plugin window</font> <br>  <font color="#000080">WinWaitActive</font> <font color="#FF0000">(</font> <font>'[REGEXPCLASS :(? I) {97E27FAA-C0B3-4b8e-A693-ED7881E99FC1]]'</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for Foobar window to become active.</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting half a second</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"{END}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Sends</font> <br>  <font color="#000080">Sleep</font> <font color="#FF0000">(</font> <font color="#AC00A9">500</font> <font color="#FF0000">)</font> <font>;</font>  <font>Waiting for</font> <br>  <font color="#000080">Send</font> <font color="#FF0000">(</font> <font>"{ENTER}"</font> <font color="#FF0000">)</font> <font>;</font>  <font>Sends keystroke ENTER, which includes the track</font> <br>  <font color="#0000FF">endif</font> <br>  <font color="#0000FF">wend</font> <font>;</font>  <font>Returns to the beginning of the loopless loop</font> </blockquote><br><br><h5>  How it works </h5><br>  Before you start, you need to add a local music library to the Foobar playlist.  If someone writes simply: ‚Äúmetallica fade to black‚Äù, then the script ‚Äúfinds‚Äù this song on VKontakte and includes it.  If someone wrote: ‚Äúlocal joe satriani crowd chant‚Äù, then the script finds the track in its playlist, and then includes it.  Commands are also available: ‚Äúquiet‚Äù, ‚Äúloud‚Äù, ‚Äúquieter‚Äù, ‚Äúlouder‚Äù and ‚Äústop‚Äù. <br><br><h5>  Conclusion </h5><br>  I did this for several hours and I know that the script is far from ideal, there are many flaws in it, for example: you should somehow reduce the code (you can probably replay the command capture in a more correct way) or if a person with the word ‚Äúlocal‚Äù requests a track not in the playlist, then it should be searched online and so on.  I'm not a programmer at all, so if it's not difficult, write about code construction errors, I will be grateful. </div><p>Source: <a href="https://habr.com/ru/post/145550/">https://habr.com/ru/post/145550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145543/index.html">Luxoft Launches Technology Testing for the iviLink Software Platform</a></li>
<li><a href="../145546/index.html">Video of Meet Windows Azure event reports published</a></li>
<li><a href="../145547/index.html">WWDC and iOS 6: what are we waiting for?</a></li>
<li><a href="../145548/index.html">Creating a custom map control using the Yandex.Maps API 2.0</a></li>
<li><a href="../145549/index.html">Visual Studio Express 2012 for Windows Desktop</a></li>
<li><a href="../145551/index.html">Test task for the Connected FixedThreadPool on C #. What is wrong here? UPD</a></li>
<li><a href="../145552/index.html">Some OSM and OpenLayers for enterprise systems</a></li>
<li><a href="../145553/index.html">Effective role assignment through the RACI matrix (Updated)</a></li>
<li><a href="../145555/index.html">Optimize iOS application resources</a></li>
<li><a href="../145558/index.html">Mozilla Shumway - open source SWF to HTML5 converter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>