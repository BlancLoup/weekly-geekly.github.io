<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the KOMPAS-3D API ‚Üí Lesson 6 ‚Üí Construction of a circular arc</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue the cycle of articles on working with the CAD API KOMPAS-3D Sergey Norseev, an engineer-programmer of the All-Russian Scientific-Research ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the KOMPAS-3D API ‚Üí Lesson 6 ‚Üí Construction of a circular arc</h1><div class="post__text post__text-html js-mediator-article">  We continue the cycle of articles on working with the CAD API KOMPAS-3D Sergey Norseev, an engineer-programmer of the All-Russian Scientific-Research Institute ‚ÄúSignal‚Äù, the author of the book ‚ÄúDevelopment of applications for KOMPAS in Delphi‚Äù.  C ++ Builder is used as the medium.  In previous lessons on the API KOMPAS <a href="https://habrahabr.ru/company/ascon/blog/328088/">Basics</a> and <a href="https://habrahabr.ru/company/ascon/blog/330588/">Drawing Design,</a> we proceeded from the fact that KOMPAS is not running, in the Lesson <a href="https://habrahabr.ru/company/ascon/blog/332554/">Correct connection to KOMPAS</a> we checked for the presence of already running KOMPAS and connected to it.  In the lesson the <a href="https://habrahabr.ru/company/ascon/blog/337288/">Main inscription was</a> disassembled, how to fill the main inscription of the drawing.  In the last lesson, <a href="https://habrahabr.ru/company/ascon/blog/342030/">Graphic primitives,</a> we began to draw the first geometric shapes.  This article discusses various ways to build a circular arc.  In COMPASS, it can be built in three different ways.  We will cover them all. <br><br><img src="https://habrastorage.org/webt/9d/p5/0o/9dp50oqfcyf7lvzyqgafizhni_m.png"><br><a name="habracut"></a><br><h2>  <font color="#00B2FF">Formulation of the problem</font> </h2><br>  First, let's decide what we will build.  For example, I propose to take a semicircle with a radius of <i>10 mm</i> centered at the point with coordinates <i>(100, 100)</i> .  This arc is shown in the figure below. <br><br> <a href=""><img src="https://habrastorage.org/webt/97/3r/z_/973rz__iz-i9y7jvqddkf4cypf8.png"></a> <br>  <i>(The picture is clickable).</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>A, B and C</i> are auxiliary points that will be useful to us when describing various ways to construct an arc. <br><br><h2>  <font color="#00B2FF">By three points</font> </h2><br>  The first method is based on the fact that you know the coordinates of points <i>A, B and C</i> , but the coordinates of the center are unknown.  To build an arc on three points, use the <b>ksArcBy3Points</b> method of the <b>ksDocument2D</b> interface.  Below is its prototype. <br><br><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ksArcBy3Points</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x1, //   </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x2, //   </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x3, //   </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y3, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style</span></span></span><span class="hljs-function">)</span></span>;<span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre> <br>  Line styles were discussed in a <a href="https://habrahabr.ru/company/ascon/blog/342030/">previous article in the series</a> . <br>  In case of success, the method returns a pointer to the constructed arc, and in case of error, the value is <i>zero</i> . <br><br>  To build our arc you need to decide on the coordinates of the points.  So, point <i>A</i> has coordinates <i>(90, 100)</i> , point <i>B</i> <i>(100, 110)</i> , point <i>C</i> <i>(110, 100)</i> .  With such source data, the <b>ksArcBy3Points</b> method <b>call</b> should be made as shown below. <br><br><pre> <code class="hljs ruby">Document2D-&gt;ksArcBy3Points( <span class="hljs-number"><span class="hljs-number">90</span></span> , <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">110</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> B <span class="hljs-number"><span class="hljs-number">110</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> C <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>C </code> </pre><br>  How to get a pointer to the <b>ksDocument2D</b> interface was described in <a href="https://habrahabr.ru/company/ascon/blog/328088/">previous articles in the series</a> . <br><br><h2>  <font color="#00B2FF">Centered and corners</font> </h2><br>  This method is based on the fact that you know the coordinates of the center of the arc and the angles of its ends.  To construct an arc using this information, the <b>ksArcByAngle</b> method of the <b>ksDocument2D</b> interface is <b>used</b> .  Below is a prototype of this method. <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ksArcByAngle</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> xc, //  </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rad, // </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> f1, // </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> f2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> direction, //  </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre><br>  With the parameters <i>xc</i> , <i>yc</i> , <i>rad</i> and <i>style</i> , I think everything is clear.  There should be no questions with them. <br><br>  The parameters <i>f1</i> and <i>f2</i> define the angles ( <i>in degrees</i> ) between the straight lines passing through the center of the arc and its end points, and the horizontal line.  These angles are shown in the figure below. <br><br><img src="https://habrastorage.org/webt/-g/kw/dm/-gkwdmfkkq66aun4a9mp9tylpoe.png"><br><br>  Now about the <i>direction</i> parameter.  It sets the direction in which the arc should be drawn.  If it is equal to <i>1</i> , then the arc is built counterclockwise, if it is equal to <i>-1</i> , then the arc is built clockwise.  For example, the arc shown in the figure above is drawn counterclockwise, and the figure below shows an arc constructed with the same parameters, but clockwise. <br><br><img src="https://habrastorage.org/webt/li/bx/sl/libxslwcuauaciqsrj9pnsc7urc.png"><br><br>  If successful, the <b>ksArcByAngle</b> method returns a pointer to the constructed arc, and in case of error, the value is <i>zero</i> . <br><br>  Let us return to our task of constructing an arc.  To render it counterclockwise, the angles must be set as follows: <i>f1 = 0</i> , <i>f2 = 180</i> .  To draw the same arc clockwise, the angles need to be swapped <i>(f1 = 180, f2 = 0)</i> . <br>  The arc construction code is shown below. <br><br><pre> <code class="hljs ruby">Document2D-&gt;ksArcByAngle( <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">180</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>C </code> </pre><br><h2>  <font color="#00B2FF">Center and end points</font> </h2><br>  This method is based on the fact that you know the coordinates of the center of the arc and the coordinates of the end points of the arc.  To construct an arc using this information, the <b>ksDocument2D</b> interface's <b>ksArcByPoint</b> method is used.  Below is a prototype of this method. <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ksArcByPoint</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> xc, //  </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rad, // </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x1, //    </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x2, //    </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> direction, // </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> style</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre><br>  This method is very similar to the <b>ksArcByAngle</b> method discussed earlier.  The only difference is that the end points are not defined by angles, but by coordinates. <br><br>  If successful, the <b>ksArcByPoint</b> method returns a pointer to the arc, and in case of error, <i>zero</i> . <br><br>  Below is the code to call this method to build our arc. <br><br><pre> <code class="hljs ruby">Document2D-&gt;ksArcByPoint( <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">110</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> C <span class="hljs-number"><span class="hljs-number">90</span></span> , <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> A <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> </code> </pre><br>  The attentive reader probably noticed that the parameters of the <b>ksArcByPoint</b> method are redundant.  Why?  Is there really a bug creators API?  Not really.  You just need to correctly understand the purpose of the points <i>(x1, y1)</i> and <i>(x2, y2)</i> .  According to KOMPAS documentation: <br><br>  <i>x1, y1</i> - coordinates of the starting point of the arc, <br>  <i>x2, y2</i> - coordinates of the end point of the arc. <br><br>  Such an incorrect description creates confusion.  In fact, the points <i>(x1, y1)</i> and <i>(x2, y2)</i> may not belong to an arc.  They specify not the position of the end points, but the orientation of the vector on which they are located.  And the beginning of this vector is in the center of the arc.  The figure below explains this more clearly. <br><br><img src="https://habrastorage.org/webt/np/0f/el/np0fel3acpglafppdymgniivva4.png"><br><br>  On this basis, the arc we are considering can be constructed using the code below. <br><br><pre> <code class="hljs ruby">double xc = <span class="hljs-number"><span class="hljs-number">100</span></span>; double yc = <span class="hljs-number"><span class="hljs-number">100</span></span>; Document2D-&gt;ksArcByPoint( xc, yc, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> xc+<span class="hljs-number"><span class="hljs-number">1</span></span>, yc, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   xc-<span class="hljs-number"><span class="hljs-number">1</span></span>, yc, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> </code> </pre><br>  Note: the end points do not coincide with the points <i>A</i> and <i>C</i> , but the arc is still built correctly. <br><br>  <b>Conclusion</b> <br>  In this article, we looked at various ways to build a circular arc.  Which of them to use, decide for yourself.  But I think that your decision will be determined by the information about the arc that you have at a given time. <br><br>  <b>To be continued, stay tuned to the blog.</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, author of the book ‚ÄúDevelopment of applications for KOMPAS in Delphi‚Äù. </div><p>Source: <a href="https://habr.com/ru/post/342032/">https://habr.com/ru/post/342032/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342022/index.html">Clouds from an unknown country. Cloud FAQ</a></li>
<li><a href="../342024/index.html">Overview of the new version of Infobox hosting</a></li>
<li><a href="../342026/index.html">How black SEO-optimizers collect millions of visitors on highly relevant queries in Yandex</a></li>
<li><a href="../342028/index.html">Space photography of the Earth</a></li>
<li><a href="../342030/index.html">Work with API KOMPAS-3D ‚Üí Lesson 5 ‚Üí Graphic primitives</a></li>
<li><a href="../342036/index.html">How to build a community. Translation of the book "Social Architecture": Chapter 6. Living Systems</a></li>
<li><a href="../342038/index.html">Detecting dependencies of Android components</a></li>
<li><a href="../342040/index.html">What should be the size of a thread pool?</a></li>
<li><a href="../342042/index.html">Single channel splitter voices: on the way to the product (preview)</a></li>
<li><a href="../342044/index.html">Python code generation with Hy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>