<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Putting XGBoost under OS X</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="XGBoost - C ++ library that implements gradient boosting methods, which can be found more and more often in the descriptions of the winning algorithms...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Putting XGBoost under OS X</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://github.com/dmlc/xgboost">XGBoost</a> - C ++ library that implements gradient boosting methods, which can be found more and more often in the descriptions of the winning algorithms on Kaggle.  For use from R or Python, there is a corresponding binding, but the library itself must be assembled from source.  When I ran make, I saw a lot of errors reporting missing drivers and unsupported OpenMP.  Well, not the first time. <br><a name="habracut"></a><br>  Progress does not stand still, and the algorithm is somewhat simpler: <br><ol><li>  / usr / bin / ruby ‚Äã‚Äã-e "$ (curl -fsSL raw.githubusercontent.com/Homebrew/install/master/install)" </li><li>  brew install gcc --without-multilib </li><li>  pip install xgboost </li><li>  Conquer Leaderboard Tops on Kaggle </li></ol><br>  From the fields it is reported that when you start XGBoost, it can swear at the missing library /usr/local/lib/gcc/5/libgomp.1.dylib.  In this case, you should find it and put it on the specified path. <br><br>  Previously, it was necessary to do the following: <br><ol><li>  Download Xcode </li><li>  Install command line tools </li><li>  Build Clang with OpenMP support </li><li>  Build the Intel OpenMP library </li><li>  Register the path to the OpenMP library and the corresponding headers </li><li>  Build XGBoost </li><li>  Install Piping for Python </li><li>  Conquer Leaderboard Tops on Kaggle </li></ol><br>  1. <b>Download Xcode</b> <br>  XCode can be downloaded for free from the App Store.  After installation, typing gcc -v on the command line of the terminal, we should see something like the following on the screen: <br><pre><code class="bash hljs">Configured with: --prefix=/Applications/Xcode.app/Contents/Developer//usr --with-gxx-include-dir=/usr/include/c++/4.2.1 Apple LLVM version 6.1.0 (clang-602.0.53) (based on LLVM 3.6.0svn) Target: x86_64-apple-darwin14.3.0 Thread model: posix</code> </pre> <br>  2. <b>Install the command line tools</b> <br>  If you skip this step, the compiler will not be able to find the standard C and C ++ libraries.  In the terminal you need to run <br><pre> <code class="bash hljs">xcode-select --install</code> </pre><br>  and follow the instructions. <br><br>  3. <b>Build Clang with OpenMP Support</b> <br>  This version of the compiler supports OpenMP instructions for parallelization and is developed by Intel employees.  Hopefully, one day this branch will flow back into the trunk, and OpenMP will be available in the original Clang from the box.  Apparently, some time ago it was possible to install clang-omp with the help of brew, but this happy time has passed.  So, we compile the compiler: <br><pre> <code class="bash hljs">mkdir clang-omp &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> clang-omp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/clang-omp/llvm git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/clang-omp/compiler-rt llvm/projects/compiler-rt git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -b clang-omp https://github.com/clang-omp/clang llvm/tools/clang mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake ../llvm -DCMAKE_BUILD_TYPE=Release make -j 4</code> </pre><br>  If there are more than 4 cores on a machine, it makes sense to correct the figure in the last command. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      4. <b>Build the Intel OpenMP library</b> <br>  The library for supporting OpenMP is also built from source.  <a href="https://www.openmprtl.org/download">Download</a> , unpack, collect: <br><pre> <code class="bash hljs">mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake .. make -j 4</code> </pre><br>  5. <b>Register the path to the OpenMP library and the corresponding headers</b> <br>  In order for the compiler and linker to find the components they need when building XGBoost, you need to set the paths to them.  To do this, add the following lines to ~ / .bash_profile: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> C_INCLUDE_PATH=PATH_TO_LIBOMP/libomp/exports/common/include/:<span class="hljs-variable"><span class="hljs-variable">$C_INCLUDE_PATH</span></span> <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CPLUS_INCLUDE_PATH=PATH_TO_LIBOMP/libomp/exports/common/include/:<span class="hljs-variable"><span class="hljs-variable">$CPLUS_INCLUDE_PATH</span></span> <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> LIBRARY_PATH=PATH_TO_LIBOMP/libomp/exports/mac_32e/lib/:<span class="hljs-variable"><span class="hljs-variable">$LIBRARY_PATH</span></span> <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> DYLD_LIBRARY_PATH=PATH_TO_LIBOMP/libomp/exports/mac_32e/lib/:<span class="hljs-variable"><span class="hljs-variable">$DYLD_LIBRARY_PATH</span></span></code> </pre><br>  As you can guess, PATH_TO_LIBOMP is the path to the folder where the library is located.  For the changes to take effect, you must run the command <pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/.bash_profile</code> </pre><br>  You need to make sure that everything works correctly.  To do this, create a sample program <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;omp.h&gt; #include &lt;stdio.h&gt; #include &lt;iostream&gt; int main(int argc, char** argv) { std::cout &lt;&lt; "Hello!" &lt;&lt; std::endl; #pragma omp parallel printf("Hello from thread %d, nthreads %d\n", omp_get_thread_num(), omp_get_num_threads()); return 0; }</span></span></span></span></code> </pre><br>  and try to compile it: <br><pre> <code class="bash hljs">PATH_TO_CLANGOMP/clang-omp/build/bin/clang++ sample.cpp -o sample -fopenmp</code> </pre><br>  If everything is good, launching the program, we will see messages from several threads on the screen. <br><br>  6. <b>Build XGBoost</b> <br>  We are almost there.  In the xgboost folder is the Makefile, the first lines of which need to be edited as follows: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CC = PATH_TO_CLANGOMP/clang-omp/build/bin/clang <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CXX = PATH_TO_CLANGOMP/clang-omp/build/bin/clang++ <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> MPICXX = mpicxx <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> LDFLAGS= -pthread -lm <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CFLAGS = -Wall -O3 -msse2 -Wno-unknown-pragmas -funroll-loops -fopenmp</code> </pre><br>  We collect: <br><pre> <code class="bash hljs">make -j 4</code> </pre><br>  Victory. <br><br>  7. <b>Install Bundle for Python</b> <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> wrapper python setup.py install</code> </pre><br>  To ensure that the XGBoost binding is working properly, you can use the demo scripts in xgboost / demo. <br><br>  8. <b>Conquer Leaderboard Tops on Kaggle</b> <br>  The electricity suddenly went off, and this most important part, unfortunately, was lost and will be illuminated in the future. </div><p>Source: <a href="https://habr.com/ru/post/277189/">https://habr.com/ru/post/277189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277173/index.html">Critical Vulnerability in Cisco ASA</a></li>
<li><a href="../277177/index.html">Measuring performance using BenchmarkDotNet</a></li>
<li><a href="../277179/index.html">Combining video clips from multiple cameras and synchronizing them over time</a></li>
<li><a href="../277183/index.html">Example module for Magento 2 in a different way</a></li>
<li><a href="../277185/index.html">The digest of interesting materials for the mobile developer # 140 (on February 8-14)</a></li>
<li><a href="../277191/index.html">Ballad about SharePoint</a></li>
<li><a href="../277193/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ198 (February 7 - 14, 2016)</a></li>
<li><a href="../277195/index.html">Excellent data types in the language "Author"</a></li>
<li><a href="../277197/index.html">PHP Digest number 79 - interesting news, materials and tools (February 1 - 14, 2016)</a></li>
<li><a href="../277201/index.html">Yii 2.0.7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>