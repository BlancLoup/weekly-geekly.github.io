<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Flask-admin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good time of day. 

 I want to present a project I have been working on lately: Flask-Admin . In a nutshell, this is an extension for the Flask framew...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Flask-admin</h1><div class="post__text post__text-html js-mediator-article">  Good time of day. <br><br>  I want to present a project I have been working on lately: <a href="https://github.com/mrjoes/flask-admin">Flask-Admin</a> .  In a nutshell, this is an extension for the <a href="http://flask.pocoo.org/">Flask</a> framework, which allows you to quickly create an administrative interface in the style of Django. <br><a name="habracut"></a><br><h4>  Architecture </h4><br>  I will try to describe how it all works and what is the difference from the Django admin panel. <br><br>  The base brick of Flask-Admin is a class that has <a href="http://flask.pocoo.org/docs/tutorial/views/">view</a> methods.  There is a bit of basic code that collects the admin panel and draws the menu.  Everything. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How does this approach effectively build an administrative interface? <br><br>  Take, for example, a typical task - CRUD for models. <br><br>  You can do it in the forehead - write code that accepts a list of models at the entrance, creates forms and labels to display each one, etc.  This code will be monolithic, it will work with a specific type of ORM and in general it will be hard to expand. <br><br>  And you can make a class that can work with one model.  Creating an instance of this class and connecting it to the admin area, we get the management interface for this model.  Repeat for the rest of the models and the admin is almost ready. <br><br>  In addition, with this approach, you can easily extend the functionality.  Instead of monkey patching, it is enough to redefine the necessary methods and, as a result, we get a new behavior. <br><br>  This is the main difference from Django - the ability to quickly and painlessly expand or replace the admin functionality for specific tasks. <br><br><h4>  Flask-admin </h4><br>  What can Flask-Admin, out of the box: <br>  1. Generating a menu (up to two levels) of connected bricks based on access rules <br>  2. The ability to control access, without any assumptions about the authorization system used <br>  3. A set of base classes to create their "bricks" <br>  3. CRUD for <a href="http://flask-admin.readthedocs.org/en/latest/quickstart/">SQLAlchemy models</a> , including paging, sorting, filters, searching, and the like. <br>  4. <a href="http://flask-admin.readthedocs.org/en/latest/quickstart/">File Manager</a> <br>  5. Localization.  It works using a modified version of <a href="https://github.com/mrjoes/flask-babel">Flask-Babel</a> , the patch was sent to Armin, but has not yet been accepted.  You can temporarily install a version from my repository, it is backward compatible with the current stable from PyPI. <br><br>  The client side runs on top of <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a> .  The reason is very simple - an adequate appearance and a bunch of UI goodies for quickly creating a UI.  Anyway, the admin panel is usually not available to regular users, and writing a UI with bootstrap is still more convenient than without it. <br><br>  Here is the list of models for <a href="https://github.com/mrjoes/flask-admin/tree/master/examples/sqla">this example</a> : <br><img src="https://habrastorage.org/storage2/89c/48b/f3c/89c48bf3c4be718f265e239e34fed85e.png"><br><br>  And this is the built-in file manager: <br><img src="https://habrastorage.org/storage2/adc/7ee/d5e/adc7eed5e762d5af67ced3bae54b493a.png"><br><br><h4>  Closer to the code </h4><br>  And so, in order to connect the admin panel to the application, you need: <br>  1. Create an instance of the class <a href="http://flask-admin.readthedocs.org/en/latest/api/mod_base/">Admin</a> <br>  2. Add instances of the BaseView class (all the ‚Äúbricks‚Äù are inherited from it) <br><br>  For example, there are two models: User and Post, you need to create an admin panel.  The initialization code will look like this: <br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask.ext.admin <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Admin <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask.ext.admin.contrib.sqlamodel <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ModelView admin = Admin(app) admin.add_view(ModelView(User, db.session)) admin.add_view(ModelView(Post, db.session))</code> </pre> <br>  <i>db.session</i> is an <a href="http://docs.sqlalchemy.org/en/rel_0_5/session.html">alchemy session</a> . <br><br>  ModelView expands in the image and likeness of Django - there is a set of properties at the class / instance level that can be changed. <br><br>  For example, if you need to exclude the password field in the User model list, do this: <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyUserAdmin</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ModelView)</span></span></span><span class="hljs-class">:</span></span> excluded_list_columns = (<span class="hljs-string"><span class="hljs-string">'password'</span></span>,) admin = Admin(app) admin.add_view(MyUserAdmin(User, db.session))</code> </pre><br><br>  Nothing prevents changing the properties in the constructor before calling the ancestor: <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyUserAdmin</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ModelView)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, session, name, excluded=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> excluded: self.excluded_list_columns = excluded super(MyUserAdmin, self).__init__(User, session, name=name) admin = Admin(app) admin.add_view(MyUserAdmin(db.session, <span class="hljs-string"><span class="hljs-string">'View1'</span></span>, (<span class="hljs-string"><span class="hljs-string">'password'</span></span>,)) admin.add_view(MyUserAdmin(db.session, <span class="hljs-string"><span class="hljs-string">'View2'</span></span>, (<span class="hljs-string"><span class="hljs-string">'email'</span></span>,<span class="hljs-string"><span class="hljs-string">'password'</span></span>))</code> </pre><br><br>  If you want, you can add another ‚Äúview‚Äù and a button to the template, when clicked, it will show: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask.ext.admin <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> expose <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyUserAdmin</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ModelView)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#     list_template = 'myproject/admin/userlist.html' @expose('/report/&lt;int:id&gt;/') def report(self, id): #   return self.render('myproject/admin/userreport.html', id=id) def __init__(self, session): super(MyUserAdmin, self).__init__(User, session) admin = Admin(app) admin.add_view(MyUserAdmin(db.session))</span></span></code> </pre><br><br>  In order to get a ‚Äúnormal‚Äù look and feel, in templates you need to inherit from 'admin / master.html': <br><pre> <code class="django hljs"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">extends</span></span></span></span></span><span class="hljs-template-tag"> 'admin/master.html' %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">block</span></span></span></span></span><span class="hljs-template-tag"> body %}</span></span><span class="xml"><span class="xml"> Hello World from MyView! </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endblock</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="xml"></span></code> </pre><br>  The behavior of the templates and view methods is completely analogous to the standard one from Flask. <br><br><h3>  Expansion of functionality </h3><br>  The extension of the functional can be divided into two parts: <br>  1. Changing the behavior of the built-in "batteries" <br>  2. Writing something new <br><br><h6>  Batteries </h6><br>  Architecturally, scaffolding models consist of two layers: <br>  1. The level of access to data.  Here is the logic of interaction with a specific implementation of ORM - from model introspection to data access methods <br>  2. Level UI and the rest of logic <br><br>  Combining both levels (through inheritance), we get a ready-made "battery" for a particular ORM.  We need to support, say, mongo-alchemy - we write logic, inherit from the base class, we get CRUD for mongo. <br><br>  ModelView is able to configure itself through the properties of a class (or an instance, if it is prescribed in the constructor).  However, if there are not enough ready-made settings, you can always inherit, override the necessary methods and get a completely different behavior. <br><br>  Similarly, the file manager works.  For example, if you want to deny access to the reports directory for a Mike user, you can do something like this: <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyFileAdmin</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(FileAdmin)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is_accessible_path</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> path.startswith(<span class="hljs-string"><span class="hljs-string">'reports'</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> user.login != <span class="hljs-string"><span class="hljs-string">'mike'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre><br><br><h6>  New functionality </h6><br>  Now about adding a completely new functionality.  This is how a new ‚Äúbrick‚Äù is added: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask.ext.admin <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Admin, BaseView, expose <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseView)</span></span></span><span class="hljs-class">:</span></span> @expose(<span class="hljs-string"><span class="hljs-string">'/'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.render(<span class="hljs-string"><span class="hljs-string">'myproject/admin/index.html'</span></span>) admin = Admin(app) admin.add_view(MyView(name=<span class="hljs-string"><span class="hljs-string">'Hello'</span></span>))</code> </pre><br><br>  An item will appear in the menu and when opening the 'Hello' item, the index view will be called.  Looks like that: <br><img src="https://habrastorage.org/storage2/ce9/d57/67b/ce9d5767b59bb9dd7feb20b89244e1ba.png"><br><br>  To generate links between views, you can use the usual url_for with a dot at the beginning of the view name: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url_for <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseView)</span></span></span><span class="hljs-class">:</span></span> @expose(<span class="hljs-string"><span class="hljs-string">'/'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> url = url_for(<span class="hljs-string"><span class="hljs-string">'.help'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.render(<span class="hljs-string"><span class="hljs-string">'myproject/admin/index.html'</span></span>, url=url) @expose(<span class="hljs-string"><span class="hljs-string">'/help/'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">help</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.render(<span class="hljs-string"><span class="hljs-string">'myproject/admin/help.html'</span></span>, id=id)</code> </pre><br><br>  Further development is no different from writing normal code under Flask. <br><br><h4>  Total </h4><br>  Currently, the library's API has more or less stabilized and is being successfully used in several projects. <br><br>  Examples are here: <a href="https://github.com/mrjoes/flask-admin/tree/master/examples">github.com/mrjoes/flask-admin/tree/master/examples</a> <br>  Documentation here: <a href="http://flask-admin.readthedocs.org/en/latest/">flask-admin.readthedocs.org/en/latest</a> <br><br>  And, as usual, patches are always welcome. </div><p>Source: <a href="https://habr.com/ru/post/148765/">https://habr.com/ru/post/148765/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148758/index.html">Display of dependent data, for example, using two drop-down lists, using knockout</a></li>
<li><a href="../148759/index.html">Satellite monitoring. Part 1</a></li>
<li><a href="../148761/index.html">Yii 1.1.11</a></li>
<li><a href="../148762/index.html">Conclusions on SQL injection</a></li>
<li><a href="../148764/index.html">Effective webinar checklist</a></li>
<li><a href="../148767/index.html">New Digg will start on Wednesday: ‚Äúbeautiful, with pictures and without advertising‚Äù</a></li>
<li><a href="../148768/index.html">RailsClub'Moscow 2012 - September 15 in Moscow. Conference ruby ‚Äã‚Äã/ ruby ‚Äã‚Äãon rails developers</a></li>
<li><a href="../148769/index.html">Verified QuickSort on Agda</a></li>
<li><a href="../148770/index.html">Mikhalkov demanded $ 7.5 million from Russian Apple resellers</a></li>
<li><a href="../148773/index.html">Self-executable phar as a way to distribute web applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>