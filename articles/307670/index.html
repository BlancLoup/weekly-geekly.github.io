<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recommender systems in online education. Continuation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue to talk about the adaptive learning system at Stepic.org. The first introductory part of this series can be read here . 


 In this articl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recommender systems in online education. Continuation</h1><div class="post__text post__text-html js-mediator-article"><p>  We continue to talk about the adaptive learning system at Stepic.org.  The first introductory part of this series can be <a href="https://habrahabr.ru/company/stepic/blog/302702/">read here</a> . </p><br><p>  In this article we will talk about building a recommender system (which is the basis of adaptability).  We will tell about the collection and processing of user data, transition graphs, handlers, user response evaluation, generation of output. </p><br><p>  Recall the linear regression, regularization, and even understand why in our case it is better to use the ridge regression, and not some other one there. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/85f/550/7e6/85f5507e6ada32e72944026df09375c5.png"><br></p><a name="habracut"></a><br><h2>  Common words </h2><br><p>  The recommendation system on Stepic.org offers the user new lessons (educational content) based on what he was interested in earlier.  It uses for this various ways to find content that is somewhat similar to the one that the user has already studied, or not so similar, but generally interesting. </p><br><p>  Each of these methods is designed as a separate function ( <strong>handler</strong> ), which extracts the list of lessons according to the principle laid down in it and marks them with weights depending on how well they fit the user.  A detailed description of these handler functions will be provided below. </p><br><p>  The recommendation system can be used in different situations.  Two main cases: </p><br><ul><li>  <strong>the usual recommendation</strong> for a particular user, which is shown to him on the main page and in the tab ‚ÄúRecommended Lessons‚Äù, as well as from time to time is sent to the post office; </li><li>  <strong>contextual recommendation</strong> , which is shown to the user after passing the lesson outside the course (that is, a lesson for which there is no fixed following), as a hint what to look further. </li></ul><br><p>  Along with the recommendation, the user is also shown information about why this particular lesson was offered to him.  This information is easy to extract due to the fact that in each function, the handler has some kind of intuition, so that you can reconstruct the reason for the recommendation. </p><br><h2>  User Data </h2><br><p>  In the process of learning at Stepic.org, the user leaves a significant digital footprint.  In addition to information about his progress, information is also stored about when he visited different steps (step is an elementary unit of content; steps are combined into larger lessons), when he tried to solve problems and with what result, and even how he watched the video: which speed and the volume, where he stopped and where he rewound. </p><br><p>  The most interesting for the basic recommender system are the following information: tags (that is, areas of knowledge with which the lessons are traced) that the user was interested in, the lessons he visited, the lessons he learned, and, if the recommendation is contextual, the current lesson. </p><br><p>  In addition to information about a specific user, the stored data can be viewed as information about the interaction of users with content.  One of the ways to aggregate and use this information turned out to be transition graphs, which we will discuss in more detail. </p><br><h2>  Transition Graphs </h2><br><p>  It is often useful to find out how users explore content, what they watch more often, what less often, which materials skip, which ones they return to, and, most importantly, the order in which they are viewed.  Using logs about user actions, it is easy to provide answers to these questions.  We used for this <strong>transition graph</strong> ( <strong>process map</strong> ), that is, a directed graph in which the vertices will be the content units (for example, steps or lessons), and the weights of the arcs will show the number of transitions between these content units. </p><br><p>  Each user action in the log has a timestamp.  Actions also come in different types, for example, "viewed" (opened step), "succeeded attempt" (solved problem) or "commented" (left a comment).  We will be interested in the actions of the user in relation to the steps, which are then easy to summarize into the lessons to which the steps belong, and even to the tags that mark the lessons. </p><br><p>  Visually, the transition graph can be thought of as a series of vertex materials (for example, steps), between some of which there are arcs.  The presence of an arc between two steps means that there are users who have watched them one after another.  Each arc has a label containing the number of such users.  An example of a transition graph for the steps of one lesson within a course: </p><br><p> <a href=""><img src="https://habrastorage.org/files/b1c/d48/56e/b1cd4856e4854ef0a3d6e8fcc198a241.png"></a> </p><br><p>  The process of building a transition graph is trivial: for each user, we consider all his actions in relation to the steps, sort them by time, and then count for each pair of steps how many times he performed the action with one of them immediately after the action with the other.  Next, we summarize the frequencies for all users, and we get a general transition graph. </p><br><p> Initially, we introduced step-by-step graphs so that teachers could find out in which order students learn the materials of their courses.  For ease of analysis, we calculate the average frequency of transitions between the steps in the course and paint the edges in the final graph green if the transition is more often expected, or red if less expected, and throw out rare transitions. </p><br><p>  Fragment of the transition graph for one of the courses: </p><br><p> <a href=""><img src="https://habrastorage.org/files/12e/8c1/6c6/12e8c16c6d4b4b27b1a1533536aea70e.png"></a> </p><br><p>  From this fragment it can be seen that the step with the T4 theory is passed more often than usual and proceeds to the next one. </p><br><p>  Next, we began to build graphs of transitions, not only in steps, but also in lessons and tags, in order to use this in a recommender system.  The transition graph for lessons is based on the same principle as for steps, just actions on steps are considered as actions on lessons to which these steps belong.  For tags, the process is similar: actions with steps are translated into actions with their tags. </p><br><h2>  Handlers </h2><br><p>  Here we list the handler functions, each of which implements its own way of recommendations.  The handler takes as user parameters, and, if the recommendation is contextual, then the lesson on which the user is currently located.  Handler returns for user <img src="http:////tex.s2cms.ru/svg/%24j%24" alt="image">  a list of lessons, each of which corresponds to a weight from 0 to 1. The greater the weight, the better the recommendation: <img src="//tex.s2cms.ru/svg/%24%5B(i%2C%20weight_%7Bij%7D)%5D%24" alt="image">  . </p><br><p>  Suppose we want to recommend the user <img src="//tex.s2cms.ru/svg/%24j%24" alt="image">  lessons on a specific tag, for which the proportion of lessons the user has completed is <img src="//tex.s2cms.ru/svg/%24tag%5C_progress_j%24" alt="image">  .  In case there is no transition graph on it, all his lessons gain weight. <img src="//tex.s2cms.ru/svg/%24tw_%7Bij%7D%20%3D%24%20tag%5C_progress_j%24" alt="image">  .  If there is a graph, then for each lesson this weight is divided by the distance in the graph to the nearest previous lesson passed by the user. <img src="//tex.s2cms.ru/svg/%24j%24%3A%20%24tw_%7Bij%7D%20%3D%24%20%20tag%5C_progress_j%20%2F%20dist_%7Bij%7D%24" alt="image">  .  Thus, the idea is realized that the user may be interested in passing the materials located in the graph of transitions near the already studied them. </p><br><ul><li><p>  <strong>Lessons with interesting user tags</strong> - Handler recommends lessons marked with tags that the user has already learned.  To do this, use the above recommendation for tags, the weight of the lesson <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  for the user <img src="//tex.s2cms.ru/svg/%24j%24" alt="image">  will make up <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%20tw_%7Bij%7D%24" alt="image">  . </p><br></li><li><p>  <strong>Unfinished lessons</strong> - recommended lessons that the user started and did not finish, with the weight the greater, the more part of the lesson the user learned: <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%20lesson%5C_progress_%7Bij%7D%24" alt="image">  lesson share <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  passed by user <img src="//tex.s2cms.ru/svg/%24j%24" alt="image">  . </p><br></li><li><p>  <strong>Popular lessons</strong> - the handler does not use user information, but simply recommends the most popular lessons on the platform for the last week.  Weight is directly proportional to popularity: <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%201%20%2F%20n_i%24" alt="image">  where <img src="//tex.s2cms.ru/svg/%24n_i%24" alt="image">  - lesson number <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  in the list of popular lessons. </p><br></li><li><p>  <strong>Lesson paths</strong> ‚Äî paths that contain the lessons that the user has taken are used; lessons following the lessons are recommended, weighing the less the farther the lesson from those already passed: <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%201%20%2F%20dist_%7Bij%7D%24" alt="image">  where <img src="//tex.s2cms.ru/svg/%24dist_%7Bij%7D%24" alt="image">  - distance from the lesson <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  to the nearest previous lesson passed by the user <img src="//tex.s2cms.ru/svg/%24j%24" alt="image">  . </p><br></li><li><p>  <strong>Tag transition graph</strong> - recommended lessons with tags that are followed by tags that interest the user.  Weights depend on the user's progress on the tags, as well as on the relative frequency of transitions between the tags.  Let be <img src="//tex.s2cms.ru/svg/%24freq%24" alt="image">  - the frequency of the transition from the tag, the lessons of which the user has studied, to some tag <img src="//tex.s2cms.ru/svg/%24t%24" alt="image">  .  Then for the lesson <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  tagged <img src="//tex.s2cms.ru/svg/%24t%24" alt="image">  , weight recommendations to the user <img src="//tex.s2cms.ru/svg/%24j%24" alt="image">  will be <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%20freq%20%5Ccdot%20tw_%7Bij%7D%24" alt="image">  . </p><br></li><li><p>  <strong>Lessons on tags from similar users</strong> (collaborative filtering) - based on the tags of interest to the user, users with similar interests are identified and lessons with tags that they learn themselves are recommended.  Let the current user <img src="//tex.s2cms.ru/svg/%24j%24" alt="image">  found a user like him <img src="//tex.s2cms.ru/svg/%24k%24" alt="image">  , with a measure of similarity between them - <img src="//tex.s2cms.ru/svg/%24s%24" alt="image">  (lies between 0 and 1, the larger it is, the more similar users are).  Then the lesson <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  tagged with that studied <img src="//tex.s2cms.ru/svg/%24k%24" alt="image">  will be recommended with weight <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%20s%20%5Ccdot%20tw_%7Bij%7D%24" alt="image">  . </p><br></li><li><p>  <strong>Lesson transition graph</strong> (only with contextual recommendations) - the handler recommends lessons that follow the current one in the transition graph, the weight depends on the relative frequency of the transition between the current lesson and the recommended one.  If moving from current lesson to lesson <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  performed with relative frequency <img src="//tex.s2cms.ru/svg/%24freq_i%24" alt="image">  then <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%20freq_i%24" alt="image">  . </p><br></li><li>  <strong>Ways for lessons (only with contextual recommendations)</strong> - recommended lessons, following the current in any way, the weight is inversely proportional to the distance between the lessons: <img src="//tex.s2cms.ru/svg/%24weight_%7Bij%7D%20%3D%24%20%201%20%2F%20dist_%7Bi%7D%24" alt="image">  where <img src="//tex.s2cms.ru/svg/%24dist_i%24" alt="image">  - distance from the lesson <img src="//tex.s2cms.ru/svg/%24i%24" alt="image">  before the current lesson. </li><li>  If all previous handlers collectively recommended fewer lessons than needed, then random lessons are added to the recommendations, the weight of such lessons is 0. </li></ul><br><p>  Understood?  Great, go ahead. </p><br><p><img src="https://media.giphy.com/media/l0MYHEI0xktKCVjri/giphy.gif" alt="starters"></p><br><h2>  User reaction rating </h2><br><p>  In order to understand how successful the recommendation turned out, after its display we fix, whether the user followed the link, and also what part of the lesson the user eventually learned (value from 0 to 1).  At the same time, the user has the opportunity to find out why the lesson was advised (the options correspond to the handlers), and mark the recommendation as not interesting to him. </p><br><p>  As a result of each recommendation shown, we can match a number: <img src="//tex.s2cms.ru/svg/%24-1%24" alt="image">  corresponds to the rejection of the recommendations <img src="//tex.s2cms.ru/svg/%241%24" alt="image1">  - following the link without studying the lesson, <img src="//tex.s2cms.ru/svg/%242%24" alt="image2">  - following the link and learning the lesson completely; meaning from <img src="//tex.s2cms.ru/svg/%241%24" alt="image1">  before <img src="//tex.s2cms.ru/svg/%242%24" alt="image2">  - incomplete study of the lesson, and <img src="//tex.s2cms.ru/svg/%240%24" alt="image0">  - lack of reaction. </p><br><h2>  Formation issuance </h2><br><p>  So, we received lists of lessons from several handlers, in which each lesson is assigned a weight from 0 to 1. The more, the more successful the handler evaluates this recommendation.  The question is, how best to combine them? </p><br><p>  It would be easy for each lesson to add or multiply the weights of the handlers that advised him.  But that would mean that we think different handlers are equally useful, which, generally speaking, may not be the case.  I would like to evaluate each handler as a utility factor, using user reactions to the recommendations.  Simple linear regression satisfies these requirements. </p><br><p> <a href=""><img src="https://habrastorage.org/files/d2a/ce7/289/d2ace7289e6549afad0309d58af68c25.png"></a> </p><br><p>  The regression model is trained using the accumulated data on how the recommendations of different handlers were evaluated by the user.  Based on this, the model generates a weight vector for handlers.  Further, when we need to recommend something to the student, the regression model for each lesson multiplies the weights of the handlers that offered it with a trained vector of parameters and gives the resulting weight for each recommended lesson. </p><br><p>  Since we are so deep in the materiel, let's formally describe the regression model.  If you know well what linear regression is, feel free to skip the next section. </p><br><h2>  Linear regression </h2><br><p>  Suppose we have a matrix <img src="//tex.s2cms.ru/svg/%24X%20%3D%20%5C%7Bx_i%5Ej%5C%7D_%7Bi%20%5Cin%20%5C%7B1%2C%20...%2C%20n%5C%7D%20%5C%5C%20j%20%5Cin%20%5C%7B1%2C%20...%2C%20d%5C%7D%7D%24" alt="image">  whose strings <img src="//tex.s2cms.ru/svg/%24x_i%20%3D%20(x_i%5E1%2C%20...%20x_i%5Ed)%24" alt="image">  called <strong>observations</strong> , and columns as <strong>factors</strong> , and a column of values ‚Äã‚Äãof the <strong>target</strong> or <strong>dependent</strong> variable <img src="//tex.s2cms.ru/svg/%24y%20%3D%20%5C%7By_i%5C%7D_%7Bi%3D1%7D%5En%24" alt="image">  .  Regression model <img src="//tex.s2cms.ru/svg/%24y%20%3D%20f(X%2C%20b)%20%2B%20%5Cepsilon%24" alt="image">  where <img src="//tex.s2cms.ru/svg/%24b%24" alt="image">  - model parameters, and <img src="//tex.s2cms.ru/svg/%24%5Cepsilon%24" alt="image">  - random error, is called <strong>linear</strong> , if the dependence of the target variable on the factors is <strong>linear</strong> , that is, <img src="//tex.s2cms.ru/svg/%24f(x%2C%20b)%20%3D%20b_0%20%2B%20%5Csum_%7Bi%3D1%7D%5E%7Bd%7D%20b_i%20%5Ccdot%20x_i%24" alt="image">  . </p><br><p>  Usually for convenience <img src="//tex.s2cms.ru/svg/%24b_0%24" alt="image">  ( <strong>constant</strong> ) is inserted under the sum sign by adding a column of ones to the observation matrix: <img src="//tex.s2cms.ru/svg/%24x_i%5E0%20%3D%201%24" alt="image">  for all <img src="//tex.s2cms.ru/svg/%24i%20%5Cin%20%5C%7B1%2C%20...%2C%20n%5C%7D%24" alt="image">  . </p><br><p><img src="//tex.s2cms.ru/svg/%24%24X%20%3D%20%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20x_1%20%5C%5C%0A%20%20%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%20%20x_n%0A%20%20%20%20%5Cend%7Barray%7D%0A%20%20%5Cright)%20%0A%20%20%3D%20%0A%20%20%5Cbegin%7Bpmatrix%7D%20x_1%5E0%20%26%20x_1%5E1%20%26%20%5Ccdots%20%26%20x_1%5Ed%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x_2%5E0%20%26%20x_2%5E1%20%26%20%5Ccdots%20%26%20x_2%5Ed%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cddots%20%26%20%5Cvdots%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x_n%5E0%20%26%20x_n%5E1%20%26%20%5Ccdots%20%26%20x_n%5Ed%20%5Cend%7Bpmatrix%7D%0Ay%20%3D%20%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20y_1%20%5C%5C%0A%20%20%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%20%20y_n%0A%20%20%20%20%5Cend%7Barray%7D%0A%20%20%5Cright)%0A%5Cbeta%20%3D%20%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20b_0%20%5C%5C%0A%20%20%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%20%20b_d%0A%20%20%20%20%5Cend%7Barray%7D%0A%20%20%5Cright)%0A%5Cepsilon%20%3D%20%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20%5Cepsilon_1%20%5C%5C%0A%20%20%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%20%20%5Cepsilon_n%0A%20%20%20%20%5Cend%7Barray%7D%0A%20%20%5Cright)%24%24" alt="image"></p><br><p>  Using this notation, a linear regression model can be written as <img src="//tex.s2cms.ru/svg/%24y%20%3D%20X%20%5Cbeta%20%2B%20%5Cepsilon%24" alt="image">  .  The solution to this problem is the column <img src="//tex.s2cms.ru/svg/%5Chat%7B%5Cbeta%7D" alt="image">  which minimizes the sum of squared deviations of the predicted values ‚Äã‚Äãfrom the real ones, i.e. <img src="//tex.s2cms.ru/svg/%24%5Cdisplaystyle%20%5Chat%5Cbeta%20%3D%20%7B%5Crm%20arg%7D%5Cmin_%7B%5Cbeta%5Cin%5Cmathbb%7BR%7D%5E%7Bd%2B1%7D%7D%20%5Csum_%7Bi%3D1%7D%5En%20(y_i%20-%20x_i%20%5Cbeta)%5E2%24" alt="image">  . </p><br><p>  This method of approximation is called the <strong>method of least squares</strong> ( <strong>ordinary least squares</strong> ) and is the most widely applicable in the context of solving a linear regression problem. </p><br><p>  In our case, we can consider as observations, that is, rows of the matrix <img src="//tex.s2cms.ru/svg/%24X%24" alt="image">  , recommended lessons, as factors of these observations, the weight that the handlers assigned to the lesson, and the values ‚Äã‚Äãof the target variable ‚Äî the user's recommendation rating. </p><br><p>  So for lessons <img src="//tex.s2cms.ru/svg/%24i_1%2C%20%5Ccdots%2C%20i_n%24" alt="image">  advised users <img src="//tex.s2cms.ru/svg/%24j_1%2C%20%5Ccdots%2C%20j_n%24" alt="image">  respectively for handlers <img src="//tex.s2cms.ru/svg/%241%2C%20%5Ccdots%2C%209%24" alt="image">  observation matrix <img src="//tex.s2cms.ru/svg/%24X%24" alt="image">  and a column of target variable values ‚Äã‚Äã(user reaction) <img src="//tex.s2cms.ru/svg/%24y%24" alt="image">  will look like this: </p><br><p><img src="//tex.s2cms.ru/svg/%24%24X%20%3D%0A%20%20%5Cbegin%7Bpmatrix%7D%20weight_%7Bi_1%20j_1%7D%5E1%20%26%20weight_%7Bi_1%20j_1%7D%5E2%20%26%20%5Ccdots%20%26%20weight_%7Bi_1%20j_1%7D%5E9%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cvdots%20%26%20%5Cvdots%20%26%20%5Cddots%20%26%20%5Cvdots%20%5C%5C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20weight_%7Bi_n%20j_n%7D%5E1%20%26%20weight_%7Bi_n%20j_n%7D%5E2%20%26%20%5Ccdots%20%26%20weight_%7Bi_n%20j_n%7D%5E9%20%5Cend%7Bpmatrix%7D%0Ay%20%3D%20%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20r_%7Bj_1%7D%20%5C%5C%0A%20%20%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%20%20r_%7Bj_n%7D%0A%20%20%20%20%5Cend%7Barray%7D%0A%20%20%5Cright)%24%24" alt="image"></p><br><p>  Vector <img src="//tex.s2cms.ru/svg/%5Chat%7B%5Cbeta%7D" alt="image">  , which gives a minimal error in predicting the reaction of the user, contains an individual weight for each of the handlers, to which his recommendations should be multiplied.  If the weight of one of the handlers is relatively large, then this handler makes a positive contribution to the recommendations, and vice versa. </p><br><p>  For the work of the recommender system, the regression model is regularly retrained on data on user reactions to recommendations.  We use <a href="https://www.scipy.org/">the SciPy library</a> to solve this problem and find the column <img src="//tex.s2cms.ru/svg/%5Chat%7B%5Cbeta%7D" alt="image">  .  This library has already implemented a linear regression problem solution. </p><br><p>  Understood?  Great, just a little bit left. </p><br><p><img src="https://media.giphy.com/media/xT77XZrTKOxycjaYvK/giphy.gif" alt="seals"></p><br><h2>  Regularization </h2><br><p>  After the implementation of a linear regression recommender system that found a weights column for handlers <img src="//tex.s2cms.ru/svg/%5Chat%7B%5Cbeta%7D" alt="image">  minimizing the square of deviations of the user's real response from the predicted ( <img src="//tex.s2cms.ru/svg/%24%5Cdisplaystyle%20%5Chat%5Cbeta%20%3D%20%7B%5Crm%20arg%7D%5Cmin_%7B%5Cbeta%5Cin%5Cmathbb%7BR%7D%5E%7Bd%2B1%7D%7D%20%5Csum_%7Bi%3D1%7D%5En%20(y_i%20-%20x_i%20%5Cbeta)%5E2%24" alt="image">  ), we noticed that gradually the weight of one handler increases indefinitely, while the others decrease, which ultimately led to the formation of the issue almost exclusively from the results of this handler.  This effect is called <strong>positive feedback</strong> , and is characterized by the fact that the deviation in the results of the system affects its further work, and the further, the more the results are shifted in the direction of this deviation. </p><br><p>  In addition, since handlers can use very similar information about user activity, there may also be a problem of <strong>multicollinearity of</strong> factors in our data, which entails a weak isolation of the matrix <img src="//tex.s2cms.ru/svg/%24X%24" alt="image">  and, as a result, solution instability. </p><br><p>  As a result, we get a solution that gives a small error on the data on which it is trained, and a big one on real data.  This situation is called <strong>overfitting the</strong> model. </p><br><p>  As a solution to the problem of retraining, regularization can be considered.  According to the book <a href="https://books.google.ru/books%3Fid%3DVRzITwgNV2UC">The Elements of Statistical Learning</a> , the main methods of regularization are the <strong>lasso</strong> (LASSO, least absolute shrinkage and selection operator) and the <strong>ridge regression</strong> (Tikhonov's resolution, ridge regression).  Both of these methods change the expression that we minimize in the process of finding a regression solution, adding to it a penalty for the norm of the vector <img src="//tex.s2cms.ru/svg/%24%5Cbeta%24" alt="image">  . </p><br><p>  In the case of lasso regularization is used <img src="//tex.s2cms.ru/svg/%24l_1%24" alt="image">  -Norm and the solution is as </p><br><img src="https://habrastorage.org/getpro/habr/post_images/799/ab6/3a0/799ab63a0393adc34ca4963565920112.png"><br><p>  In the case of ridge regression, <img src="//tex.s2cms.ru/svg/%24l_2%24" alt="image">  -norm and the solution looks like </p><br><img src="https://habrastorage.org/getpro/habr/post_images/fa5/701/f8f/fa5701f8f001aaef2460c01b00ab8ef3.png"><br><p>  In both cases, the parameter <img src="//tex.s2cms.ru/svg/%24%5Clambda%24" alt="image">  is selected in the process of optimization. </p><br><p>  Using lasso regularization reduces all weights <img src="//tex.s2cms.ru/svg/%24%5Cbeta_i%24" alt="image">  and those that were already relatively small become equal to zero.  Thus, the lasso method is well suited for the selection of significant factors (feature selection). </p><br><p>  The ridge regression method also reduces the weights of the factors, but it never reduces them to zero, unless <img src="//tex.s2cms.ru/svg/%24%5Clambda%20%3D%20%5Cinfty%24" alt="image">  . </p><br><p>  According to <a href="http://dl.acm.org/citation.cfm%3Fid%3D1015435">Andrew Ng</a> , lasso regularization works better than combed one in a situation where the number of factors far exceeds the number of training observations.  In the reverse situation, the ridge regression is more appropriate. </p><br><p>  Accordingly, the ridge regression is better suited for our case.  Its implementation is also present in the SciPy library, which made us very pleased. </p><br><h2>  Conclusion </h2><br><p>  In this article, we have dealt with how the recommendatory system for educational content on Stepic.org is implemented.  Sometimes, probably, it was hard, but you succeeded!  <i>(If you, of course, do not just scroll to this place, then we advise you to go back and read)</i> </p><br><p>  See the recommendation system in action at <a href="https://stepic.org/explore/lessons">https://stepic.org/explore/lessons</a> ‚Äî it lists recommended lessons for you to learn.  But if you are logged on to the platform for the first time, then the recommendations may not be particularly relevant. </p><br><p>  In the next and final article in this series, we will look directly at the adaptive system at Stepic and discuss the results of the work done: prediction accuracy, user preferences, and evaluate the statistics. </p><br><p>  And finally, I would like to ask: <b>Do you believe in adaptive online education</b> ?  Will it force out traditional courses?  Can the most intelligent recommender system recommend educational content to a person as well and even <b>better than a live teacher</b> ? </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/307670/">https://habr.com/ru/post/307670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307658/index.html">Notes on reactive programming. Technological landscape</a></li>
<li><a href="../307660/index.html">How a failure in the data center can lead to the cancellation of thousands of flights of major airlines</a></li>
<li><a href="../307662/index.html">Security Week 32: Sauron project, iOS vulnerability, PLC worm</a></li>
<li><a href="../307666/index.html">The language problem of artificial intelligence</a></li>
<li><a href="../307668/index.html">Architecture Standards for Internet of Things</a></li>
<li><a href="../307672/index.html">Procedural generation of levels for puzzle games</a></li>
<li><a href="../307674/index.html">New user of your product - how to help him?</a></li>
<li><a href="../307680/index.html">Tim Cook's long game at Apple</a></li>
<li><a href="../307686/index.html">Refinement of Squid log parser for correct viewing of resources visited by HTTPS</a></li>
<li><a href="../307688/index.html">How different are sales directors and founders of IT companies?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>