<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ArcSight Forwarder Connector. Send wherever we want</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, habrasoobschestvo! 

 In this article, I will share my practical experience on uploading events from ArcSight ESM. I will review the functio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ArcSight Forwarder Connector. Send wherever we want</h1><div class="post__text post__text-html js-mediator-article">  Good day, habrasoobschestvo! <br><br>  In this article, I will share my practical experience on uploading events from ArcSight ESM.  I will review the functionality in detail and provide step by step instructions on how to configure the ArcSight Forwarder Connector, as well as describe the interesting life hacks. <br><br><img src="https://habrastorage.org/webt/hb/ak/cj/hbakcjrchgvgnjl3jhmfl8habey.jpeg"><br><a name="habracut"></a><br>  To begin with, let's see why events are generally sent from Arcsight ESM (after all, they live well in the database). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Your company has several ESM servers and the task is to send events to the central ArcSight ESM for global correlation. <br><br><img src="https://habrastorage.org/webt/1e/oc/zj/1eoczjn45nghi8k3xpmddq09txq.png"><br><br></li><li>  You have a third-party system (for example, ELK) to which you need to send events from ArcSight <br><br><img src="https://habrastorage.org/webt/cq/sh/bj/cqshbjlaproxj8a58j17y_y5ily.jpeg"><br><br></li><li>  Sending syslog events in CEF format </li><li>  Uploading events to a CSV file for further work </li></ul><br>  We can implement all these points using the ArcSight Forwarder Connector, but the initial configuration starts at the ArcSight ESM itself: <br><br><div class="spoiler">  <b class="spoiler_title">Initial Setup on Arcsight ESM</b> <div class="spoiler_text">  All work is done on the latest version of Arcsight ESM 6.11 (but this also applies to previous versions). <br>  To begin, create an account that will be used to upload events from ESM. <br>  In the navigation pane, go to the ‚ÄúUsers‚Äù section and in the ‚ÄúCustomer User Groups‚Äù directory, create your own ‚ÄúForwarder Events‚Äù directory <br><br><img src="https://habrastorage.org/webt/6_/xt/1g/6_xt1gv4irjj0-tv9qdx-sjwznm.png"><br><br>  Click on the newly created group ‚ÄúForwarder Event‚Äù and create a user, for example ‚Äúfwd‚Äù <br><br><img src="https://habrastorage.org/webt/uc/w2/de/ucw2deioxzck86fafjlcsv6e2b0.png"><br><br>  For a new user, you must specify the type of account and password. <br>  User Type = Forwarding Connector <br><br><img src="https://habrastorage.org/webt/eq/49/2b/eq492b1tvqgsh7dfxribx1dig9u.png"><br><br>  Now you need to create a filter for the events that we want to unload from Arcsight ESM.  To do this, select the section ‚ÄúFilters‚Äù in the navigation panel and create a filter with the conditions we need. <br>  For example, I plan to unload all correlation events from ESM, so my filter will look like this <br><br><img src="https://habrastorage.org/webt/d9/tu/td/d9tutdi9pneqfczwr-aq-2jcc9w.png"><br><br>  After the filter is created, it must be imposed on the group ‚ÄúForwarder Events‚Äù, which includes the user ‚Äúfwd‚Äù. <br>  Go to the navigation panel in the section "Users" and for the group "Forwarder Events" select "Edit Access Control" <br><br><img src="https://habrastorage.org/webt/39/7e/ui/397euijaf66e7ltlossmgtr0zes.png"><br><br>  Then in the "ACL Editor" go to the tab "Events" and click "Add" to add our previously created filter <br><br><img src="https://habrastorage.org/webt/rp/av/dz/rpavdzw_zgqd2zk37gqm8ytrxvm.png"><br><br>  This completes the settings from the side of Arcsight ESM. <br></div></div><br>  After creating the account and filtering on Arcsight ESM, we can proceed to the installation and configuration of the Arcsight Forwarder Connector <br><br><div class="spoiler">  <b class="spoiler_title">Install and configure ArcSight Forwarder Connector</b> <div class="spoiler_text"> To install the Arcsight Forwarder Connector, we need any server with Linux and the latest version (ArcSight-7.5.0.7986.0-SuperConnector-Linux64.bin) connector. <br>  First of all, we need to make our file executable: <br> <code>chmod +x ArcSight-7.5.0.7986.0-SuperConnector-Linux64.bin</code> <br>  Now let's proceed to the installation of the connector itself: <br> <code>./ArcSight-7.5.0.7986.0-SuperConnector-Linux64.bin</code> <br>  Let's get acquainted with the information, press "Enter" and specify the installation directory: <br> <code>/opt/arcsight/forwarder</code> <br> <br><img src="https://habrastorage.org/webt/d_/au/vf/d_auvf8e03a99yuyfdwbd9ln5vw.png"><br><br>  Next, we refuse to create links by selecting ‚Äú4‚Äù and confirm the installation <br><br><img src="https://habrastorage.org/webt/p_/kj/ng/p_kjngjzhjtrz0utsgkzse5mjbu.png"><br><br>  In the end, we will receive information about the successful installation and further instructions on launching the connector tuner. <br><br><img src="https://habrastorage.org/webt/x8/_e/yk/x8_eykazcal0-9mjcwrhdi2tz0k.png"><br><br>  Now we‚Äôll make a preliminary setup. <br>  Run ./runagentsetup.sh <br> <code>/opt/arcsight/forwarder/current/bin/runagentsetup.sh</code> <br>  Select the item ‚ÄúAdd a Connector‚Äù and type ‚ÄúArcSight Forwarding Connector (Enhanced)‚Äù <br><br><img src="https://habrastorage.org/webt/6q/ag/4w/6qag4wtxrtijnaobhk231zjhqto.png"><br><br>  Next, the connector will prompt you to hide the input of parameters (login / password) <br><br><img src="https://habrastorage.org/webt/vh/j5/gf/vhj5gfa9e-opxbmncgbtlua1_4a.png"><br><br>  Now we set the parameters of the ESM server from which we will collect events and indicate the parameters of the previously created account ‚Äúfwd‚Äù <br><br><img src="https://habrastorage.org/webt/oz/gy/4y/ozgy4yq0r-jh0tatkkmcbe9eyvg.png"><br><br>  Now you need to import the ArcSight ESM certificate to our connector. <br><br><img src="https://habrastorage.org/webt/kb/7q/el/kb7qelzsuhwfibjdi1341aw1euw.png"><br><br>  When integration with ESM is successful, the connector will offer you several options for sending events. <br><br><img src="https://habrastorage.org/webt/qr/x4/0e/qrx40eyeryg9w9bmjmvkz3_ddvs.png"><br><br>  Next, I will describe the setting for each of the options. <br></div></div><br>  Configure destination types: <br><br><div class="spoiler">  <b class="spoiler_title">Sending events to ArcSight ESM</b> <div class="spoiler_text">  Enter the data of the ESM server to which we will send events.  Here you will need to specify the login and password of the standard account. <br><br><img src="https://habrastorage.org/webt/ot/6o/kh/ot6okhfc4nipl52ujuoh42buhoc.png"><br><br>  Now we specify the name of the connector that will appear on the destination ESM server <br><br><img src="https://habrastorage.org/webt/ut/aq/3u/utaq3unn1zjjhm-nrx7lnznjqxe.png"><br><br>  Import certificate to connector <br><br><img src="https://habrastorage.org/webt/ys/wu/3n/yswu3nhvdzgflohjxqfufvbh7vc.png"><br><br>  At this setting is over.  It remains to determine only the launch parameter of the connector.  We can install the connector as a service with automatic start, or as an application that needs to be started manually <br> <code>/opt/arcsight/forwarder/current/bin/arcsight agents</code> <br> <br><img src="https://habrastorage.org/webt/9e/qp/qz/9eqpqzoyy6qc_thsbu2tk5tngfw.png"><br><br>  I usually choose to create an auto-start service. <br><br><img src="https://habrastorage.org/webt/cb/jp/dm/cbjpdmo729-msc-x0dt3vp_n3v0.png"><br><br>  On the destination server, check the registration of the connector and the arrival of events on it <br><br><img src="https://habrastorage.org/webt/x7/qf/hf/x7qfhfbb-qek4qkuntzayjcrdcy.png"><br><br><img src="https://habrastorage.org/webt/5i/02/1q/5i021qp7zlbgrbzkbnlxg73loyq.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Sending events to ArcSight Logger</b> <div class="spoiler_text">  The first step is to create a ‚ÄúReceiver‚Äù at the Arcsight Logger itself.  To do this, select the section ‚ÄúConfiguration‚Äù in the Logger, then ‚ÄúReceivers‚Äù and click Add. <br>  Give the name to our recipient and choose the type of events to be received. <br><br><img src="https://habrastorage.org/webt/3v/kp/gb/3vkpgbucbwqi-qgqdihogaiwdqi.png"><br><br>  Now go to the setting on the connector <br><br><img src="https://habrastorage.org/webt/s8/xk/br/s8xkbr4khosjhy7ocwhlmci7cvs.png"><br><br>  Set the parameters for connecting to the Logger and specify our created Receiver - FWD_ESM <br><br><img src="https://habrastorage.org/webt/zd/d7/mi/zdd7mixe2ac28oc4fvwkxfey5ca.png"><br><br>  Import certificate for connector <br><br><img src="https://habrastorage.org/webt/4w/pb/em/4wpbemrnw4fg-y_iyotyknim0jg.png"><br><br>  Checking the arrival of events on ArcSight Logger <br><br><img src="https://habrastorage.org/webt/w9/ph/o9/w9pho9vvoze6dy3ddlggfkwjt88.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Sending Syslog Events in CEF Format</b> <div class="spoiler_text">  It's all elementary.  Enter only the destination address, on which port we will send and specify the data transfer protocol <br><br><img src="https://habrastorage.org/webt/im/vc/u2/imvcu2bh9vzd0f3kch2gppmv04g.png"><br><br>  We check the arrival of events, for example in ELK <br><br><img src="https://habrastorage.org/webt/ix/g3/ro/ixg3ro2lftppc2vke-w6a4khyum.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Sending events by uploading to a CSV file</b> <div class="spoiler_text">  In this case, we need to specify only the directory where the csv file will be created, which fields to unload and the file rotation time <br><br><img src="https://habrastorage.org/webt/9f/7y/er/9f7yer3gekdqq4l1ea3nptvpac4.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Sending events to HPE Operations Manager</b> <div class="spoiler_text">  The transmission of events occurs via the SNMP protocol with the further display of events in IT Operations Management <br><br><img src="https://habrastorage.org/webt/dt/uf/rl/dtufrlfppv9nifq5rgyzmlrolmk.png"><br></div></div><br>  Tips and tricks for working with Arcsight Forwarder Connector <br><br><div class="spoiler">  <b class="spoiler_title">Uploading correlation events along with baseline</b> <div class="spoiler_text">  By default, the Arcsight Forwarder Connector unloads only correlation events.  But what to do if basic events are necessary, for example, for a detailed investigation of the incident. <br>  To do this, we need to specify the ID-connector and user-ID as a parameter, as well as register all this in the ESM configuration file. <br>  ID-connector can be found with the command <br> <code>cat /opt/arcsight/forwarder/current/user/agent/agent.properties | grep entityid</code> <br> <br><img src="https://habrastorage.org/webt/xh/ej/av/xhejavss5l7jqfmdoekfk1dety4.png"><br><br>  ID-user "fwd" can be viewed in his profile on ESM <br><br><img src="https://habrastorage.org/webt/ft/6-/xb/ft6-xbo4iv8g3fjsmqb1wicmtyu.png"><br><br>  Next, we need on the Arcsight ESM server itself to add an additional parameter to the server.properties file <br>  Stop the server <br> <code>/etc/init.d/arcsight_services stop all</code> <br>  Enter the parameters <br> <code>vi /opt/arcsight/manager/config/server.properties</code> <br> <code>eventstream.cfc=(connectro ID).(forwarder user ID)</code> <br> <br><img src="https://habrastorage.org/webt/i6/pw/m5/i6pwm50dkj1lpyzorc-mzzlfrms.png"><br><br>  We start the ESM server <br> <code>/etc/init.d/arcsight_services start all</code> <br>  Now the correlation events will be unloaded along with the base <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Additional event filtering on Forwarder Connector</b> <div class="spoiler_text">  After installing the Arcsight Forwarder Connector and connecting all the necessary destination nodes, run <br> <code>/opt/arcsight/forwarder/current/bin/runagentsetup.sh</code> <br>  Select ‚ÄúModify Connector‚Äù <br><br><img src="https://habrastorage.org/webt/dp/fu/sk/dpfuskdrazpdh_qxft_cbxdalfw.png"><br><br>  Next ‚ÄúAdd, modify, or remove destinations‚Äù <br><br><img src="https://habrastorage.org/webt/gc/za/_u/gcza_ukitw_xjpicvqemg6c_1rc.png"><br><br>  Next, select the source of the destination for filtering. <br><br><img src="https://habrastorage.org/webt/wd/dx/4v/wddx4vwp_aepw9vwqd0fep3b9km.png"><br><br>  Select "Modify destination settings" <br><br><img src="https://habrastorage.org/webt/gn/oy/bp/gnoybp9cgx1zhtth2aq3xzu6fgk.png"><br><br>  In this menu all settings of the connector are set.  In our case, point 10 is required - Filters <br><br><img src="https://habrastorage.org/webt/bi/ut/aw/biutaw8feynjagmlvyq1mzpfhqs.png"><br><br>  Assigning filtering: in my case, discard all events that are NOT EQUAL to the value in the deviceVendor field. <br><br><img src="https://habrastorage.org/webt/lg/6b/sq/lg6bsq-vxouasx6uztw0aqk_ez0.png"><br><br>  Thus, we can send a diverse stream of events to the Forwarder Connector and scatter events to the destination source we need. <br><br><img src="https://habrastorage.org/webt/su/gl/tl/sugltlbtxamh79zq4b89s18ncj4.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Setting coding of paged events</b> <div class="spoiler_text">  To correctly display events containing Russian characters, you need to set additional parameters in the agent.wrapper.conf file on the Forwarder Connector. <br> <code>vi /opt/arcsight/forwarder/current/user/agent/agent.wrapper.conf</code> <br>  We enter the following lines (make no mistake with the ordinal numbering of wrapper.java.additional) <br> <code>wrapper.java.additional.10=-Dfile.encoding=UTF8 <br> wrapper.java.additional.11=-Duser.language=ru <br> wrapper.java.additional.12=-Duser.region=RU</code> <br> <br><img src="https://habrastorage.org/webt/dq/yy/wc/dqyywcsd7wojqsyh5jdajepafim.png"><br></div></div><br>  As a result, we can observe that ArcSight has a lot of integration capabilities, both with its systems and with external sources.  But for the sake of truth, it is worth saying that the flow of events is gradually increasing, the same events must be sent to several sources, there must be a constant interaction of various systems ... and here the capabilities of a regular connector end. <br><br>  Therefore, Micro Focus engineers developed a new architecture called the ArcSight Data Platform.  A distinctive feature of this architecture is the ArcSight Event Broker product, which serves to route a huge stream of events to various systems (ESM, Logger, UEBA, Investigate, Hadoop, etc.) and is capable of processing <b>more than 500,000 EPS</b> !!! </div><p>Source: <a href="https://habr.com/ru/post/347642/">https://habr.com/ru/post/347642/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347632/index.html">What is in the name? Analysis of the names of 5820 games on Steam</a></li>
<li><a href="../347634/index.html">How to improve site performance by 8 times: our experience in integrating AWS services</a></li>
<li><a href="../347636/index.html">Issue # 8: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../347638/index.html">We expand bottlenecks Xamarin.Forms</a></li>
<li><a href="../347640/index.html">ZFS: Testing reliability on bad disks</a></li>
<li><a href="../347644/index.html">Facebook breaks into blockchain and cryptocurrency: forecast</a></li>
<li><a href="../347646/index.html">Leave all doubts: how to avoid the impostor syndrome</a></li>
<li><a href="../347648/index.html">Outside the office. We automate specialized processes in a medical manufacturing company.</a></li>
<li><a href="../347650/index.html">How the principles of the game "Playing Lean" help in the creation of products</a></li>
<li><a href="../347654/index.html">10 skills cool designer in 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>