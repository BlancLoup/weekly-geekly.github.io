<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Access to thousands of personal data of users of Beeline Wired Internet was obtained</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sorry for the pretentious title, but once such a booze has gone , then we will continue. I personally always liked such posts. 

 So, it goes about th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Access to thousands of personal data of users of Beeline Wired Internet was obtained</h1><div class="post__text post__text-html js-mediator-article">  Sorry for the pretentious title, but once <a href="http://habrahabr.ru/post/248727/">such a booze</a> has <a href="http://habrahabr.ru/post/248727/">gone</a> , then we will continue.  I personally always liked such posts. <br><br>  So, it goes about the vulnerability of the well-known in Moscow time (and not only) provider Beeline.  Many remember him by the name of Corbina.  Without a doubt, this is one of the foremost Internet service providers, with a long and good history.  At one time he was a rescue, thanks to high-quality and fast Internet, intranet networks, etc.  Currently, the provider‚Äôs employees are aware of vulnerabilities and the most critical ones are already closed.  However, I am sure that many will discover many new and interesting things.  Moreover, the technique is applicable to almost any provider. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/23a/f99/27a/23af9927aab792a4d6b8875ce34379aa.jpg" alt="image"></div><br><a name="habracut"></a><br>  By the will of fate, I ended up in a removable hruschevka.  I had a ‚ÄúMegaphone‚Äù whistle.  Since I had to stay there for a week, I was not bothered by the lack of a fixed Internet.  However, my stay there was delayed.  I decided that it did not matter, since I was armed with wardriving tools.  But I couldn‚Äôt pull anything off for a couple of days, except for the open network Yota (facepalm).  As you could guess from the name of the post, in the hallway of the apartment I found a painfully familiar orange wire.  Connect - it was "Beeline".  It would seem that this is just an orange wire.  Nevertheless, this is at least a 100mb channel (optimally) with access to the local network (possible).  In our case, whois said that this is a 10.0.0.0/8 subnet.  It is clear that not all ip will be available, but better than nothing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is where nmap comes into action.  I forgot about him in the early 2000s, because  like the era of open ports has passed.  However, in early 2010, I remembered about him again, because all sorts of nosql and other sub-services, which were often without authorization, became widely popular.  nosql saved on everything in pursuit of productivity, and heaps of sub-services, such as zabbiks, jenkins, etc.  often turned out to be either open, from the category ‚Äúyes, who knows that my port is 12345 open‚Äù, or full of holes.  The same zabbiks had a bunch of holes, including sqli without authorization.  In short, my goal was routers.  80th ports.  Previously, they were often open to ekzeku, now providers block ekzeku by default, just like the routers themselves.  But I was local to them. <br><br>  I started scanning with nmap, but quickly changed my mind as he suggested that I wait a couple of days.  <a href="https://zmap.io/">Zmap</a> was sent <a href="https://zmap.io/">into battle</a> .  You can read about him, but briefly, this is a very fast and narrow alternative to nmap.  zmap scanned the same subnet in 2 minutes. <br><br><blockquote>  <b>Vulnerability # 1</b> <br>  Not having a login / password from Beeline, simply by plugging a wire, I got access to all local resources and devices (routers, cameras, voip hardware, etc.) </blockquote><br>  The fact that the glands had default logins / passwords, I will not even consider the vulnerability.  Old as the world.  From the category "why should I put a complex password on my router, if it is local?"  Or, more often: "Oh, everything." <br><br>  However, further I was waiting for a more interesting detail.  80% of the routers that I found - dir300 with firmware from Beeline.  Without a doubt, this is one of the most reliable and affordable routers, which completely copes with its task.  When I ran into non-standard logins / passwords, I decided to see what went where and how.  Those.  opened the inspector in the browser and began to sniff requests.  Amazing near!  It turned out that the Beeline firmware returned to the attempt of incorrect authorization: <br><br><pre><code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">auth</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }</code> </pre> <br>  However, the firmware for some reason sent several requests for authorization.  At the same time.  And when the first just swore auth: false, the second gave something like: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">auth</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, ‚Ä¶ settings: { <span class="hljs-attr"><span class="hljs-attr">ssid</span></span>: <span class="hljs-string"><span class="hljs-string">"blablabla"</span></span>, <span class="hljs-attr"><span class="hljs-attr">wpakey</span></span>: <span class="hljs-string"><span class="hljs-string">"12345678"</span></span>, <span class="hljs-attr"><span class="hljs-attr">login</span></span>: <span class="hljs-number"><span class="hljs-number">089746254</span></span> password: <span class="hljs-string"><span class="hljs-string">"lovelove123"</span></span> ‚Ä¶ } }</code> </pre><br>  Those.  The firmware seemed to say that auth: false, sorry guy.  But at the same time, in passing, I gave all the settings of the router, including the login / pass from the personal account of Beeline and from wifi.  In some cases, it was generally ridiculous, the webmord swore at the wrong login / password, but she herself showed the login / password, but this was more likely an exception, I met a couple of such routers: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/82e/a4e/937/82ea4e937edb4cbfab8761f8be9e10b5.png"></div><br><br><blockquote>  <b>Vulnerability # 2</b> <br>  The Beeline firmware for routers itself gave all the settings of the router without knowing the login / password. </blockquote><br>  I admit, I did not even suspect that everything would come out that way.  Found it all by chance.  And indeed, if the firmware had not sent several requests at once (obviously by mistake of the developers), I would never have thought of checking its availability. <br><br>  Even having a login / pass from a personal account, we will not do anything with it.  First, as soon as the device has registered under a certain login / password in the Beeline network, no other device can register under this login / password.  Secondly, it is a hard fawn. <br><br>  We scan routers, collect wifi logins / passwords.  We look, what networks are within reach.  We connect to them and sit as partisans.  Even networks with a huge password will not stand, because  in the router it is stored in clear text.  Well, so as not to burn at all.  We take a marker and at the entrance we write the login / password from this wifi network somewhere in a remote place.  Under the stairs of the first floor, for example.  Those.  even if they come to you, you turn on the fool and say that you have found your username and password under the stairs: ‚ÄúUse everything, free wifi‚Äù. <br><br>  In my case, I did not have the patience to collect all the wifi accesses from all routers.  The only network that I quickly found and which was in the range of visibility of my laptop, had a good speed, but pings from 30ms to 7s.  With AlfaNetworks, I had a stable signal, but these external wifi cards all over the world have the reputation of being a ward driver, so sitting under them is also pale. <br><br>  I continued to collect access to wifi.  There were a lot of them and it bothered me.  I wanted a network right now.  A simple and ingenious idea came to mind.  Suppose I found a router with an open 80 port at 10.82.2.20.  Standard dir300.  Either anything else is not important.  Turn off DHCP, and write the network settings: <br><br>  gateway: 10.82.2.20 (router found) <br>  ip: 10.82.2.222 (from noodles on the same subnet) <br>  dns: 8.8.8.8 <br><br>  We connect the network, and, even without intrigue, we have high-quality Internet through the wire, and not through wifi.  We go to the router, we look - yes indeed, we are connected to it as if in a lan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/599/d94/468/599d944684e84bb5964a7622a9ba3748.png"></div><br><br>  Once again we read, slowly and penetrating into every word: <b>We prescribe ANY active IP network as a gateway and have a connection to it via LAN.</b> <br><br>  Fine?  In my opinion completely. <br><br>  It only remained for me to check several routers in my personal account for a normal tariff in order to choose ‚Äúwho to be today‚Äù. <br>  To be honest, this is rather a vulnerability not so much (and not only) of ‚ÄúBeeline‚Äù, as there are routers.  But nonetheless. <br><blockquote>  <b>Vulnerability # 3</b> <br>  Ability to connect / register locally on any router within the network and get from it the Internet. </blockquote><br>  Having received moral and aesthetic pleasure, I contacted the representatives of the provider and gave them all the best practices. <br>  At the exit, having only the Beeline wire, without knowing the logins / passwords, one could get fast internet for free.  Simple as 2 bytes to send. <br><br>  <b>Some details:</b> <br><br>  <b>1.</b> 99% of TrendNet routers have standard login / password.  For all the time, I found only 1 or 2 routers from TrendNet, to which default access did not fit. <br>  <b>2.</b> 0% of Zyxel routers have standard login / password.  Most likely, when setting up, they require changing this password. <br>  <b>3.</b> 50% of access to LC does not change.  Who is familiar with the biline knows that when concluding a contract, the installer makes the password from the LC either equal to the login, or adds 1 character to the beginning or the end of the login. <br><br>  And another thing, at the level of fiction.  Again, quite by chance, I came across a live router, registered it as a gateway and local 192.168.0.222 for myself.  I received the Internet, used it, and then went to the settings of the router (at 192.168.0.1).  I do not remember why.  Maybe something to check or something else.  Imagine my surprise when the login form of the ADSL router from MTS opened in front of me.  I rechecked the network, looked at checkip.dyndns.com, prokhizil external IP - yes indeed, it is MTS Internet. <br><br>  I stuck the wire "Beeline", and got the Internet from MTS.  I puzzled for a long time what is the point and how is this possible.  Connected to the process sysadmin from work and specialists from "Beeline".  The only possible option that I came up with: <br><br>  1. There is a dude who has both MTS and Beeline Internet, respectively, 2 routers. <br>  2. Both routers are contiguous to each other. <br>  3. "Beeline" router does not have an Internet and asks him from the MTS router. <br>  4. "Beeline" router is not in the network 192.168.0.0/24 <br>  5. MTS router is in the network 192.168.0.0/24 <br>  6. Knowing the local IP of the biline, inserting it as a gateway, I connect through it to the MTS router and have the Internet from it. <br><br>  Cool?  It is noteworthy that on the 1st of the next month the device disappeared.  Presumably, the man turned off Beeline. <br><br>  Thanks to the staff of "Beeline" for the quick response.  In particular, <a href="http://habrahabr.ru/users/geran_utran/" class="user_link">geran_utran</a> and <a href="http://habrahabr.ru/users/givtone/" class="user_link">givtone</a> .  In fact, you often have to communicate with the administrators and developers of this or that service about security and more often come across: ‚ÄúYes, we will put you, but this is a matter of jurisdiction!‚Äù And other inadequate.  The guys quickly corrected critical holes and attracted the right people.  I was sure that I would have another month or two freebies until the entire Beeline network was reconfigured, but no, everything was decided within 24 hours, as soon as they found the person in charge.  Well done, in one word. </div><p>Source: <a href="https://habr.com/ru/post/243997/">https://habr.com/ru/post/243997/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243983/index.html">Keystone NAP will transform steel plant in data center</a></li>
<li><a href="../243987/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ135 (November 17 - 23, 2014)</a></li>
<li><a href="../243989/index.html">PENTESTIT. Practical Information Security: The Results of 2014, Part II</a></li>
<li><a href="../243991/index.html">Principles of Business Application Monitoring</a></li>
<li><a href="../243993/index.html">The simplest cardiograph on the Arduino</a></li>
<li><a href="../243999/index.html">CTOcast # 3: Conversation with Sergey Chernyshev</a></li>
<li><a href="../244001/index.html">AngularJs $ parse hacks</a></li>
<li><a href="../244003/index.html">Information Project Management Methodologies</a></li>
<li><a href="../244007/index.html">Polyphasic sleep: reviews, "theory", personal experience</a></li>
<li><a href="../244009/index.html">How I tortured Selenium tests for GAE Django and what came to the end</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>