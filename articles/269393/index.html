<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 43: hard prime numbers, cryptography in HDD, Adobe and Oracle patches</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Opening the door to the world of cryptography, be careful! It may come out so that it will not work. Of course, this is a coincidence, but as soon as ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 43: hard prime numbers, cryptography in HDD, Adobe and Oracle patches</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/efd/435/686/efd435686e2d4358af32dc715b266222.jpg" align="right">  Opening the door to the world of cryptography, be careful!  It may come out so that it will not work.  Of course, this is a coincidence, but as soon as I recovered from the <a href="http://habrahabr.ru/company/kaspersky/blog/268907/">news of last week</a> about collisions in SHA-1, the topic of breaking encrypted traffic immediately arose with an attack on the Diffie-Hellman protocol.  Well, already by the name it is clear what is the matter, yes?  An expert in the field of cryptography, Bruce Schneier, in May of this year <a href="https://www.schneier.com/blog/archives/2015/05/amateurs_produc.html">published</a> an angry post about ‚Äúamateur encryption‚Äù.  In any other field of activity, statements like ‚Äúleave it to professionals, you still don‚Äôt understand anything‚Äù usually provoke a wave of criticism, but with regard to encryption, you can probably agree with this statement.  Moreover, the story around the Diffie-Hellman protocol, with the participation of mathematicians, programmers and even Edward Snowden, is good evidence of this.  This is a story about how a good, good algorithm was poorly implemented in practice. <br><br>  And here they also discovered that hard drives with built-in encryption protect your data not as well as we would like.  In general, this issue of the weekly security news digest is about cryptography.  And about patches.  Pro very, very many patches.  Bonus: a selection of the most hackneyed stock photographs on the topic of security. <br><br>  All episodes of the series can be found <a href="http://habrahabr.ru/search/%3Ftarget_type%3Dposts%26q%3D%255Bklsw%255D%2520%26order_by%3Ddate">here</a> . <br><a name="habracut"></a><br>  <b>Prime numbers are the weak point of the Diffie-Hellman protocol.</b> <br>  <a href="https://threatpost.ru/prime-diffie-hellman-weakness-may-be-key-to-breaking-crypto/12806/">News</a>  Research <a href="https://weakdh.org/imperfect-forward-secrecy-ccs15.pdf">work</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This time I will not even try to explain something in simple words.  Useless.  <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25BE%25D1%2582%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BB_%25D0%2594%25D0%25B8%25D1%2584%25D1%2584%25D0%25B8_%25E2%2580%2594_%25D0%25A5%25D0%25B5%25D0%25BB%25D0%25BB%25D0%25BC%25D0%25B0%25D0%25BD%25D0%25B0">Diffie-Hellman</a> is a secure key exchange protocol for setting up an encrypted connection, originally published in 1976.  Whitfield Diffie and Martin Hellman (as well as some other comrades) were among the first to propose a solution to an important problem ‚Äî how to exchange encryption keys so that the eavesdropping side could not intercept them. <br><br>  There are two participants who want to exchange data in encrypted form.  Each participant has their own private key, but if they simply exchange these keys, the eavesdropping party can intercept them, and here is the end of the story.  To avoid this, one side passes the other a large prime number (well, one that can be divided only into one and oneself), and the result of the calculation using this prime number and secret code.  Having exchanged such large numbers, the two sides can, independently of each other, calculate the same third number, which will become the key for the cipher.  At the same time, this key is never transmitted over the network, and it is impossible to calculate it, knowing only what was transmitted over an open channel, for some reasonable time. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2e4/e60/747/2e4e607478d64196ac5b9791e5874783.jpg"></div><br>  <i>Predictable username and unreliable password are floating in the ocean of numbers and letters.</i> <br><br>  So, in order for this algorithm to work, and it could not be hacked, the simplest number that is transmitted openly must be Large and Random.  If it is Random, but small (for example, a key length of 512 bits is used), then the probability of hacking increases.  This was shown in two attack methods published by researchers earlier this year - <a href="https://threatpost.ru/novaya-ataka-freak-ugrozhaet-mnogim-ssl-klientam/6585/">FREAK</a> and <a href="https://threatpost.ru/razrabotana-novaya-ataka-logjam-na-algoritm-diffi-hellmana/8394/">Logjam</a> .  It is necessary to understand that to know the key (that simple number) is not enough to immediately take everything and decrypt it.  But computational power, for example, for an attack, Logjam requires a small amount ‚Äî using the power of Amazon EC2, it took researchers only 7.5 hours to perform the necessary calculations, which greatly simplify further decryption of intercepted encrypted traffic. <br><br>  But those were the keys with a length of 512 bits, which had long been recognized as unreliable, and they appeared thanks to the US export restrictions on strong cryptography, introduced back in the 80s.  Keys with a length of 1024 bits were considered reliable, but, as a new study showed a group of 14 cryptographers, options are possible.  There is 7.5 hours on Amazon you can not manage, it takes a huge and very expensive computing system, and about a year time.  If the primes used in practice were really random, this would not help.  Unfortunately, in real implementations of the Diffie-Hellman protocol, they are not random enough.  That is, some very rich organization named A (or H, or B) can exploit this non-randomness, build a supercomputer for several hundred million dollars, drive it a year and get, no, not ciphers, but source data that is further Allow to crack specific traffic relatively quickly. <br><br>  As a result, such a powerful organization allows hacking up to 66% of IPSec VPN connections, 26% of connections via SSH and 18% of HTTPS connections.  Judging by the data from the documents stolen by Edward Snowden, the NSA budget for the exploitation of vulnerabilities in network communications is really huge - $ 1 billion annually.  This means that the probability that a supercomputer was actually built there and allowed it to analyze a large amount of intercepted encrypted traffic ‚Äî non-zero. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f19/c6f/6e4/f19c6f6e4d374865b29bef9624af8cc6.jpg"></div><br>  <i>A keyboard with a special ‚Äúmake me safe‚Äù button can be found, it seems, on all IT Security sites.</i>  <i>Well, that is, in general, at all.</i> <br><br>  And what to do?  Yes, nothing yet.  It is advisable to make sure that your browser does not use the very weak version of the DH protocol with 512-bit keys (you can do it <a href="https://weakdh.org/">here</a> ).  But there is no any ready-made solution for possible hacking of communications using a 1024-bit key.  Diffie-Hellman is used in a huge number of protocols, so right now it will not be possible to take and fix it.  According to Alex Halderman, one of the authors of the study, this will take years.  It is bad news.  The relatively good news is that this is still a Very Dear Hacking Method, and it will remain so for a very long time. <br><br>  <b>Embedded hard drive encryption multiple vulnerabilities</b> <br>  <a href="https://threatpost.ru/academics-find-critical-flaws-in-self-encrypting-hardware-drives/12868/">News</a>  <a href="http://eprint.iacr.org/2015/1002.pdf">Research</a> <br><br>  OK, the attack on the Diffie-Hellman protocol cannot be called trivial, but this news shows how to significantly weaken cryptography due to far simpler errors.  The authors of the new study immediately bought a lot of external hard drives with data encryption function.  A detailed study of encryption methods showed that there are many ways to crack the protection there, to put it mildly.  Let's start with the simplest: by default, in some WD models they don‚Äôt even ask for a password to access data.  That is, information, on the one hand, is encrypted, on the other - available to anyone. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d1a/511/dc7/d1a511dc779040b7ad4f9ff251ebb4e5.jpg"></div><br>  <i>A man presses a finger on an imaginary lock.</i>  <i>Number two in the list of the most hackneyed pictures, after the keyboard with the button.</i> <br><br>  We go further.  If the owner still has his own password, then it is stored in encrypted form either in the controller's memory or in hidden sectors of the disk.  It is easy enough to get it from there, and it is theoretically possible to decipher it by simple brute force.  But that's not all.  One of the controllers, the researchers managed to translate the firmware update mode, and thus get the encrypted password, although this method allows you to do many other bad things.  For example, write a malicious code in the firmware.  Finally, another type of controller uses keys generated by the vulnerable random number generator.  At the entrance, this generator uses the computer system time, which reduces the encryption strength from theoretical 256 bits to real 32 bits.  Finally, in one of the cases, the encryption key was stored in clear text, which made it possible to bypass the password set by users. <br><br>  In general, this is what happens.  You buy a hard drive, see inscriptions on the box like AES256, and are sure that your data is protected.  In fact, nuances are possible, and you won‚Äôt even know - which ones - because even in one series of hard drives, controllers (and iron in general) may differ.  The degree of trust in such ‚Äúready‚Äù encryption solutions depends on the level of paranoia.  The study did not have a single example of fast and simple hacking, all of them required either a soldering iron or brute force.  It is unlikely that this will deal with the one who found the hard drive, you accidentally forgotten in a taxi.  Probably law enforcement agencies can do this if they are suddenly interested in you.  At the same time, there are many ways to complicate their lives, and if you are considering <i>such scenarios</i> , then you should be aware of these methods. <br><br>  Finish the topic of cryptography with what we started.  In data encryption methods there is a huge amount of subtleties, because of which ‚Äúamateur‚Äù their implementations may indeed be less resistant than necessary.  Many things in cryptography must be proved ‚Äúon paper‚Äù, because a practical experiment cannot always be carried out, and when it becomes possible, it‚Äôs usually too late to change something.  Consumers of cryptography are now generally all people using the Internet, and this complex topic concerns everyone.  But the conclusion, for users and companies wishing to evaluate the reliability of the methods they use, is quite simple.  ‚ÄúEverything is encrypted with me‚Äù is not a reason to calm down and not use other data protection methods. <br><br>  <b>Another patch set for Adobe Flash (3 vulnerabilities, 1 critical) and Oracle Java (154 vulnerabilities (!), 84 serious)</b> <br>  <a href="https://threatpost.com/emergency-adobe-flash-zero-day-patch-arrives-ahead-of-schedule/115073/">News</a> about Adobe.  News about Oracle.  <a href="https://blogs.oracle.com/security/entry/october_2015_critical_patch_update">Post</a> on an Oracle blog. <br><br>  What happened to Oracle?  A big update has been released covering 154 vulnerabilities in 54 different products.  Of these, 84 vulnerabilities can be exploited remotely.  24 vulnerabilities in Java SE of different versions, 7 of them dangerous.  According to Eric Maurice, in Oracle for Security Assurance, they do not observe exploitation of in-the-wild vulnerabilities.  This number of found and closed bugs is due, in part, to the quarterly update release model.  That is, the next update is expected only in January 2016. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/58b/aa3/b8d/58baa3b8d7d440b7889867a6b6c70fec.jpg"></div><br>  <i>Credit card with lock, very cute.</i>  <i>Security is not affected in any way.</i> <br><br>  What happened with Adobe?  Three vulnerabilities in Flash Player are <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2015-7645">closed</a> , one of them is critical ( <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2015-7645">CVE-2015-7645</a> ), which allows running code on a computer with Flash installed.  The Adobe patch came out earlier than planned (they were going next week), and the rush is due to the fact that the vulnerability is already being exploited. <br><br>  Perhaps it would be interesting to talk about the different approaches of the two companies to the release of updates: Adobe sticks to the weekly schedule (like Microsoft), Oracle - quarterly.  But it is more interesting to look at this screenshot from the Adobe site: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e30/d2a/ef0/e30d2aef09c54231be42e358eca42cc6.png"></div><br><br>  Both in Oracle Java and in Adobe Flash there are many, many vulnerabilities.  This week's news again raised an old topic - that let us all stop using both.  So, on September 1, Google Chrome has already <a href="https://threatpost.ru/chrome-ostanovit-flash-s-1-sentyabrya/11236/">made the</a> launch of Flash objects only on demand, and even earlier, Java was actually <a href="https://threatpost.ru/google-otklyuchila-npapi-v-chrome/7741/">blocked there</a> by default.  Yes, in general, it is possible to consider both of them as a heavy inheritance from the Internet at the beginning of the 2000s, but the ‚Äúlet's ban it already‚Äù approach, of course, will not work.  The ‚Äúrun Java in an isolated browser, and better in a virtual machine‚Äù approach, if it works, for a very limited circle of people.  So, before Java and Flash are finally banned, it may be possible to make them more secure - and the news of this week, in general, gives hope for the best.  But in general, is there any point in trying to get the message about vulnerable Flash to the widest range of users?  After all, this is, in fact, technical details, and it‚Äôs better to talk about more understandable things, for example, about protecting payments using bank cards on the Internet. <br><br>  <b>What else happened:</b> <br>  For iOS 9, <a href="https://threatpost.ru/apple-patches-include-ios-9-1-update-pangu-jailbreak-fix/12901/">they did a</a> jailbreak, but they already <a href="https://threatpost.ru/apple-patches-include-ios-9-1-update-pangu-jailbreak-fix/12901/">closed</a> the update to 9.1.  And all because the jailbreak was public, and so far no one has received a million dollars <a href="https://threatpost.ru/zerodium-hosts-million-dollar-ios-9-bug-bounty/11993/">for a private exploit</a> . <br><br>  Next year, GMail <a href="https://threatpost.ru/google-moving-gmail-to-strict-dmarc-implementation/12899/">will switch</a> to the strict identification of mail messages using the DMARC protocol.  Other popular services are planning to do the same.  The DMARC protocol <a href="https://threatpost.com/google-facebook-and-others-join-write-new-email-authentication-spec-called-dmarc-013012/76150/">began to be</a> developed three years ago.  It works in conjunction with existing message identification systems, such as DKIM, and is mainly aimed at fighting phishing. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  "Hard-662" <br><br>  Very dangerous resident virus, standardly recorded in the .COM files that are run.  On Mondays at 6 p.m., it displays the text ‚ÄúIt's hard days days!‚Äù And erases 50 first sectors on all available disks.  Intercepts int 21h. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 69.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/269393/">https://habr.com/ru/post/269393/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269383/index.html">Embed JSON in Embedded? Easy peasy</a></li>
<li><a href="../269385/index.html">Cache in Drupal from A to Z</a></li>
<li><a href="../269387/index.html">Oracle regular expressions. Dangerous range</a></li>
<li><a href="../269389/index.html">Xamarin.UITest</a></li>
<li><a href="../269391/index.html">ShishNashKi</a></li>
<li><a href="../269395/index.html">Golden Site distributed elephants to the best Internet projects.</a></li>
<li><a href="../269397/index.html">Instant download of desktop and mobile sites: part 1</a></li>
<li><a href="../269399/index.html">Application Lifecycle in Windows 8.1 and UWP</a></li>
<li><a href="../269401/index.html">The three most significant innovations with the arrival of watchOS2</a></li>
<li><a href="../269407/index.html">This is not paranoia: sources of threats in the GSM system and protection from them.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>