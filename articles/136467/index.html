<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The play "Developing a multiplayer online game." Part 4: Moving into 3D</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1: Architecture 
 Part 2: Protocol 
 Part 3: Client-server communication 

 Recently I have been working with 11 flash using the example of the A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The play "Developing a multiplayer online game." Part 4: Moving into 3D</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://piccy.info/"><img src="https://habrastorage.org/getpro/habr/post_images/aaf/dd8/a33/aafdd8a33e83832fff1a8ab2ea3c6134.jpg" alt="Piccy.info - Free Image Hosting"></a> <br><br>  <a href="http://habrahabr.ru/blogs/gdev/123220/">Part 1: Architecture</a> <br>  <a href="http://habrahabr.ru/blogs/gdev/123748/">Part 2: Protocol</a> <br>  <a href="http://habrahabr.ru/blogs/gdev/124311/">Part 3: Client-server communication</a> <br><br>  Recently I have been working with 11 flash using the example of the AWAY3D 4 engine. There is very little information in Russian about this engine.  On Habr√© about him almost nothing.  So I decided to write a couple of articles about this very interesting product.  Writing about simple circles and cubes is not exactly interesting.  I do not like to discuss spherical horses in a vacuum. <br>  In general, I decided to make the description of the engine on a less real example.  Let's translate our game to the topdown 3D shooter.  And we will continue to develop, but with the use of 3D technology. <br>  Of course, I know that there is an Alternativa3D engine.  But I don't like their product for many reasons.  We will not discuss them in the article, if you have any questions, welcome to kamenty. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, we will make an alternative to the alternative ... <br><br><a name="habracut"></a><br><br>  So what do we want to get? <br><br>  Translate our 2D multiplayer game in 3D. <br><br>  Let's get started <br><br>  We will use the following technologies: <br><br>  Flash 11, as a platform <br>  AWAY3D 4, as a 3D engine <br>  FlashDevelop 4 as a development environment <br>  Blender 2.61 as an editor of game objects and the world as a whole. <br><br>  Why AWAY3D?  Quite simply, the source is available on <a href="https://github.com/away3d/away3d-core-fp11">Gihub</a> .  The library is actively developing (commits are very frequent) and you can always correct or supplement something.  Well, then send it to them for inclusion in the source.  The community will thank you.  Plus, quite large possibilities of the library itself.  Plus there are books on it. <br><br>  What is AWAY3D 4?  This is a 3D library for 11 flash, which means the display of objects through the graphics card GPU.  This gives us the opportunity to show on the stage complex objects with lighting, various effects ... and all this with decent speed. <br>  It should be noted that AWAY3D has a version for Flash10, in which the mapping is done using software rendering.  Since in this case all the calculations fall on the shoulders of the CPU, the speed drops many times over.  Well, the possibilities in the conclusion of various effects are repeatedly reduced.  But this version may be useful for simple projects.  For the 11th Flash just came out and not everyone has installed it yet.  And not all video cards support it. <br>  But the situation is improving every day, so we, being on the cutting edge of progress, will use the latest version for the 11th flash. <br>  For those interested, the details can be read here <a href="http://www.away3d.com/features/">features</a> <br><br>  With the architecture of the project we will not particularly bother.  The purpose of the article is not a manual on programming, but an introduction to technology.  In the future, if the articles find feedback from readers, it is possible to continue in the form of refactoring with improved architecture ... well, in general, the development of the project. <br><br>  To avoid problems, you need to make sure that you have the latest versions of flash and flashdevelop.  This ensures the correct compilation and launch of source. <br><br><h4>  AWAY3D base </h4><br><br>  Create an AS3 project in FlashDevelop and link the AWAY3D library to it.  Connecting the engine is extremely simple.  Download the AWAY3D sources from the GitHub project and copy them to the src folder of our project.  Everything. <br><br>  In order to further simplify the understanding of what is happening on the stage in AWAY3D, I‚Äôll give a picture that will help you to navigate the scene space. <br><br> <a href="http://piccy.info/"><img src="https://habrastorage.org/getpro/habr/post_images/f73/3fe/1d0/f733fe1d0942ca68f77cd30da137eb8b.jpg" alt="Piccy.info - Free Image Hosting"></a> <br><br>  It shows the coordinate axes, as they are presented in the AWAY3D engine.  Those.  by default, moving forward is in Z +, and up is Y +. <br><br>  The basic principle of working with the engine is very simple.  It is necessary to initialize the scene View3D.  Adjust the camera, while we indicate the position of the camera on the scene.  The camera is the object responsible for displaying our view of the scene.  Those.  what we will see on the screen, our eyes so to speak. <br>  Next you need to position the light source.  They are different, point, scattered, etc. We will use a point source (the light spreads evenly from one point in all directions), it will represent the sun.  In principle, you can do without it, but then there will be no shadows on the stage. <br>  To calculate and display the scene on the screen, use the view.render () command.  It must be called every frame.  You can then create objects on the stage and manipulate them. <br><br>  To begin with, we will write the elementary project which will show us a cube.  This is necessary to understand how it generally runs and works.  Well, to check that everything is connected and working correctly. <br><br>  Water is the class code that will display the cube.  All explanations are in the code.  It is very simple. <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sprite</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    private var view : View3D; //   public var light: PointLight; //   public var player: ObjectContainer3D; public function Main():void { if (stage) init(); else addEventListener(Event.ADDED_TO_STAGE, init); } private function init(e:Event = null):void { removeEventListener(Event.ADDED_TO_STAGE, init); // entry point //   view = new View3D(); view.camera.y = 140; view.camera.z = -120; view.camera.rotationX = 50; addChild(view); //  addChild(new AwayStats(view)); //     addPlayer(); stage.addEventListener( Event.ENTER_FRAME, onEnterFrame ); } public function addPlayer():void { //   player = new ObjectContainer3D(); //      var bitmapData: BitmapData = new BitmapData(512, 512, false, 0x000000); bitmapData.perlinNoise(64, 64, 5, 0, false, true, BitmapDataChannel.RED); //    var material: BitmapMaterial = new BitmapMaterial(bitmapData); //     var mesh:Mesh = new Cube(material, 50, 50, 50); player.addChild(mesh); view.scene.addChild(player); } public function onEnterFrame( e:Event ):void { player.rotationX += .11; player.rotationY += .15; player.rotationZ += .19; view.render(); } }</span></span></code> </pre> <br><br>  As a result, at startup you should see the following image. <br><br> <a href="http://piccy.info/view3/2498756/777e25c5b1e0c734e4b02a59fff5db3f/orig/"><img src="https://habrastorage.org/getpro/habr/post_images/c5f/1e5/713/c5f1e57134f6e8a40da07a58227690af.jpg" alt="Piccy.info - Free Image Hosting"></a> <br><br>  If this is not the case, check if you did everything right.  Check the versions installed by Flash and FlashDevelop. <br><br>  Now that we have verified that the project is starting up and running, we will make the second basic thing in our toy.  Namely, let's load the model created in blender into the game.  This will build the entire project. <br>  The Internet is full of lessons on working with blender, so we will not focus on it.  Just open the blender and make it a model consisting of a cube.  20 by 20 by 20. There is no point in making a full-fledged model now.  In further lessons we will take the finished model, which on the Internet is a car and a small truck.  And now we need to make sure that our whole environment works correctly and the models are loaded. <br>  In our project we will use the format of 3DS models.  After you have created a model, export it to 3DS format.  The resulting file while put in the folder bin project.  So it will be easier to get to it. <br><br>  Now we proceed to import. <br><br>  Loading objects into AWAY3D is very simple.  All you need is a Loader3D class.  It is universal and loads all formats.  It can be specified in which format the object will be loaded, but this is not necessary.  Parsers can be a team Parsers.enableAllBundled (), specify accept all formats.  Loader3D itself will understand what we ship. <br>  In principle, loading a model takes only 4 lines of code. <br><br><pre> <code class="java hljs">Parsers.enableAllBundled(); loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Loader3D(); loader.addEventListener(LoaderEvent.RESOURCE_COMPLETE, onResourceComplete); loader.load(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URLRequest(<span class="hljs-string"><span class="hljs-string">"model.3ds"</span></span>));</code> </pre><br><br>  Here we indicated that we accept all formats, created a Loader3D object and indicated to it exactly what to load.  The LoaderEvent.RESOURCE_COMPLETE event will tell us that the boot process is complete and you can work with the model. <br>  In the basic version, everything is simple.  But when loading errors may occur or when loading a model, she will need some sort of processing.  In general, in real projects everything is more complicated.  And for this, the engine has it all.  You can connect the event LoaderEvent.LOAD_ERROR, it will allow you to catch loading errors.  Or the event LoaderEvent.ASSERT_COMPLETE, which is triggered by processing every detail of the model.  We will discuss these nuances in the following lessons when we touch upon the details of working with models. <br><br>  Here is the working code that loads the model onto the scene. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlayerLoad</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// 3D private var view:View3D; private var main: Main; // loader private var loader:Loader3D; public function PlayerLoad( view_:View3D, main_: Main ) { main = main_; //     view = view_; // ,      Parsers.enableAllBundled(); loader = new Loader3D(); loader.addEventListener(LoaderEvent.RESOURCE_COMPLETE, onResourceComplete); //    loader.load(new URLRequest("model.3ds")); } private function onResourceComplete(e:Event):void { //     main.player = ObjectContainer3D(e.target); //     view.scene.addChild( main.player ); } }</span></span></code> </pre><br><br>  Also in the class main you need to replace the addPlayer () method with the following <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addPlayer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   var load: PlayerLoad = new PlayerLoad( view, this ); }</span></span></code> </pre><br><br>  If you did everything correctly, then at startup you will see a white rotating cube. <br><br> <a href="http://piccy.info/view3/2498761/e930021a6bb5747364b6a674dc47059b/orig/"><img src="https://habrastorage.org/getpro/habr/post_images/9f8/201/b21/9f8201b2110c06ebbb48b2d7d9776369.jpg" alt="Piccy.info - Free Image Hosting"></a> <br><br>  This was the introductory part.  In which we created the project, we connected the necessary libraries, checked the working environment and made sure that everything works. <br>  If the topic is interesting, in the next part I will describe in more detail, working with the camera, manipulating objects and working with materials. <br><br>  All sources are available on <a href="https://github.com/solverit">Gihub</a> <br><br>  PS Also in kamenta it will be useful to indicate the points of interest that you should focus on. </div><p>Source: <a href="https://habr.com/ru/post/136467/">https://habr.com/ru/post/136467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136461/index.html">Controller Hierarchy</a></li>
<li><a href="../136463/index.html">Application for drawing under the Android</a></li>
<li><a href="../136464/index.html">Details about the ReFS (Protogon) file system</a></li>
<li><a href="../136465/index.html">Microsoft and Skype</a></li>
<li><a href="../136466/index.html">JMock and EasyMock: comparison and howto in examples and not only</a></li>
<li><a href="../136468/index.html">Oracle on the way to decline</a></li>
<li><a href="../136469/index.html">Code Review and Probability Theory</a></li>
<li><a href="../136471/index.html">We create our own framework based on symfony2. (Part 3)</a></li>
<li><a href="../136472/index.html">Be a voice, not an echo</a></li>
<li><a href="../136475/index.html">CSS 3D effects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>