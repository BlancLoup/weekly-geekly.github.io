<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Part 2. HID device for camera rotation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a continuation of my article about a device for rotating a webcam (the previous article can be found here ). 

 In this part, I will talk abou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Part 2. HID device for camera rotation</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/0c9/ca0/8d1/0c9ca08d1af7d3c37f5e0f58e59c404b.jpg" alt="image"><br>  This is a continuation of my article about a device for rotating a webcam (the previous article can be found <a href="http://habrahabr.ru/sandbox/79829/">here</a> ). <br><br>  In this part, I will talk about creating the software part: the firmware for the ATtiny85 microcontroller and the computer program in order to be able to control the device. <br><a name="habracut"></a><br>  To create the firmware of the microcontroller and software, I used the finished project, reworking it for myself. ( <a href="http://we.easyelectronics.ru/electro-and-pc/usb-dlya-avr-chast-2-hid-class-na-v-usb.html">This</a> information is mandatory for reading, since I will not describe the details). <br><br><h5>  Microcontroller firmware </h5><br>  Depending on the control program command, the firmware installs legs 1, 3, 4, 5 into logical 1 or 0. Also, if no command arrives for 2 seconds, then all four legs are set to 0, this is done so that if there is a failure the work of the program on the PC, the device did not fixate on the execution of the last command (wrote the firmware on AVR Studio4, this environment is not friendly with Cyrillic, so check the addresses. You can also use PROTEUS to test the firmware): <br><pre><code class="hljs python"><span class="hljs-meta"><span class="hljs-meta">... </span></span><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(bytesRemaining == <span class="hljs-number"><span class="hljs-number">0</span></span>) //    { //    PORTB <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( pdata.b1 ) //   <span class="hljs-number"><span class="hljs-number">1</span></span>   PORTB |= _BV(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( pdata.b2 ) //   <span class="hljs-number"><span class="hljs-number">3</span></span>   PORTB |= _BV(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( pdata.b3 ) //   <span class="hljs-number"><span class="hljs-number">4</span></span>   PORTB |= _BV(<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( pdata.b4 ) //   <span class="hljs-number"><span class="hljs-number">5</span></span>   PORTB |= _BV(<span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">5</span></span>); } ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(i==<span class="hljs-number"><span class="hljs-number">200</span></span>) // <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>   <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">2</span></span> { PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">1</span></span>); PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">3</span></span>); PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">4</span></span>); PORTB &amp;= ~_BV(<span class="hljs-number"><span class="hljs-number">5</span></span>); } ...</code> </pre> <br><h5>  Leg shortage </h5><br>  Attiny85 has only 8 legs.  Two of them to power the microcontroller.  One to reset the data, and two more are used to use the USB interface.  It remains three free, but I need 4 legs to control two engines. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/ede/8b5/18e/ede8b518eae4bfad7699e60fec30d3b8.jpg" alt="image"><br><br>  There are two ways to get out of this situation: the first is a shift register (it can be used to increase the number of controlled outputs to the desired one, but at the same time you have to sacrifice speed and reliability. See <a href="http://avrproject.ru/publ/kak_podkljuchit/bascom_avr_74hc595/2-1-0-44">here</a> ); <br>  The other is to use a fuse bit to redefine the Reset leg to normal input / output.  (Read <a href="http://www.getchip.net/posts/068-kak-pravilno-proshit-avr-fyuzy-fuse-bit/">here</a> ). <br>  I used the second method and set RSTDISBL to 0. in fuses (I got an error when reading fuses with the help of SinaProg. I found the solution <a href="http://forum.easyelectronics.ru/viewtopic.php%3Ft%3D2975%26p%3D52301">here</a> ). <br>  When flashing a microcontroller with such fuses parameters, it can only be reflashed again by a high-voltage programmer, so you need to recheck the setting, especially in usbconfig.h.  (Contained settings for V-USB) <br>  In case of unsuccessful firmware, you need to manually remove the driver that installs the OS for your device in the ‚Äúdevice manager‚Äù.  Otherwise, the incorrectly installed driver will be used further for all subsequent firmware of the microcontroller. <br><br><h5>  Management program </h5><br>  I used ready-made code, so I didn‚Äôt have problems with setting up a connection.  This part of the code is responsible for the formation and sending of commands, as well as for receiving information about the state of the device (in this case, the state of the legs 1 3 4 5. I quote only the class): <br><br><pre> <code class="hljs lua">#define Max <span class="hljs-number"><span class="hljs-number">230</span></span> class Device{ class dataexchange_t //      { public: <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> b1; //      <span class="hljs-number"><span class="hljs-number">4</span></span> . <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> b2; //       PORTB.   <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> b3; //   (  <span class="hljs-number"><span class="hljs-number">4</span></span>  ). <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> b4; }data; class Position{ public: float x; float y; }positionTransform, cameraPosition; /* positionTransform -          cameraPosition -       */ HIDLibrary &lt;dataexchange_t&gt; hid; //        unsigned <span class="hljs-built_in"><span class="hljs-built_in">char</span></span> processTime; //        FILE *f; //       int SendData(dataexchange_t *); public: bool Connect(); void SetCameraPosition(short int *, short int *); bool MoveCamera(); bool StopMoveCamera(); Device() { processTime = <span class="hljs-number"><span class="hljs-number">10</span></span>; (int&amp;)data = positionTransform.x = positionTransform.y = <span class="hljs-number"><span class="hljs-number">0</span></span>; f = fopen(<span class="hljs-string"><span class="hljs-string">"CameraPosition.txt"</span></span>,<span class="hljs-string"><span class="hljs-string">"r+"</span></span>); fscanf(f,<span class="hljs-string"><span class="hljs-string">"%f %f"</span></span>, &amp;cameraPosition.x, &amp;cameraPosition.y); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(cameraPosition.x &lt; -Max || cameraPosition.y &lt; -Max || cameraPosition.y &gt; Max || cameraPosition.x &gt; Max) cameraPosition.x = cameraPosition.y = <span class="hljs-number"><span class="hljs-number">0</span></span>; } ~Device() { fclose(f); } }; ...</code> </pre><br><br>  Since I refused to rotate the camera 360 degrees, I had to programmatically introduce a limit of 230 degrees, that is, the camera rotates to the left (230 degrees) and to the right (-230 degrees) 230 degrees from the beginning.  (It should be noted that the software limitation is the worst solution to such a problem; it would be better to install mechanical switches that would turn off one of the motor power circuits). <br><br>  I also introduced a specific coordinate axis to control the rotation of the camera in order not to load the OS by sending commands continuously.  The user leads by how many degrees it is necessary to turn the camera relative to the current position.  Further, the entered degrees are converted into several commands, which with an interval of 2 seconds should be sent to the device. <br><pre> <code class="hljs markdown">... //       (    2) if(<span class="hljs-emphasis"><span class="hljs-emphasis">*x &gt; 0) positionTransform.x = (*</span></span>x <span class="hljs-bullet"><span class="hljs-bullet">* 0.20832); //         else positionTransform.x = (*</span></span>x <span class="hljs-bullet"><span class="hljs-bullet">* 0.225); //       (    2) if(*</span></span>y &gt; 0) positionTransform.y = (<span class="hljs-emphasis"><span class="hljs-emphasis">*y *</span></span> 0.20832); else positionTransform.y = (<span class="hljs-emphasis"><span class="hljs-emphasis">*y *</span></span> 0.225); ...</code> </pre><br><br>  The device first turns the camera horizontally, and then vertically, so as not to overload the USB port by simultaneously supplying two engines. <br><br>  The result is that the microcontroller is controlled by a program from a computer, which in turn controls the driver of the engine (I used L293), and it already controls two engines. <br><br><h5>  Video and audio transmission </h5><br>  I had to transfer the signal from the camera and control it from a distance.  I found a way out using the Skype API (The problem was only that the Skype API was no longer supported, so there are bugs).  To use the Skype API, you need to copy the Skype4COM.dll file to the disk where the OS is installed. <br><br>  My Skype program monitors chat with a client - a user who uses my device.  When the user enters the camera to start the camera operation (in this case, the ‚Äú0000‚Äù command), the program will make a video call and turn on the device.  After that, the user can control the camera by entering the following commands into the chat: <br><br>  ‚ÄúStopMove MoveTo ('X' @ 'Y') VideoOn VideoOff Wait'TimeInSec '‚Äù.  (Skype will first turn off the camera to the VideoOff team, and then immediately turn it on, if you manually turn on the video display in manual mode, this command works fine): <br><br><pre> <code class="hljs coffeescript">... char comandName[] = {<span class="hljs-string"><span class="hljs-string">"###"</span></span>}; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   char comandStart[] = {<span class="hljs-string"><span class="hljs-string">"0000"</span></span>}; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   int timeWait = <span class="hljs-number"><span class="hljs-number">500</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  COM  CoInitialize(NULL); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  Skype  SKYPE4COMLib::ISkypePtr pSkype(__uuidof(SKYPE4COMLib::Skype)); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   Skype API pSkype-&gt;Attach(<span class="hljs-number"><span class="hljs-number">6</span></span>,VARIANT_TRUE); _bstr_t comand; IChatMessagePtr curMessage, privMessage = NULL; COleDateTime startTime(time(NULL)); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(;;)<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      { curMessage = pSkype-&gt;GetMessages(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_bstr_t)</span></span></span><span class="hljs-function">comandName)-&gt;</span></span>GetItem(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      comand = curMessage-&gt;GetBody(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!strcmp(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(char*)</span></span></span><span class="hljs-function">comand,comandStart) &amp;&amp; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(privMessage == NULL || privMessage-&gt;GetId() != curMessage-&gt;GetId())</span></span></span><span class="hljs-function"> &amp;&amp; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(startTime.m_dt &lt; curMessage-&gt;GetTimestamp())</span></span></span><span class="hljs-function">) { privMessage = curMessage; curMessage-&gt;</span></span>PutSeen(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>      ControlDevice(pSkype, comandName, timeWait, privMessage); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Sleep(<span class="hljs-number"><span class="hljs-number">5000</span></span>); } ... _bstr_t comand; IChatMessagePtr curMessage; int timeToSendMessage = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timeWait</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/100)*80; Device device; ICallPtr call; /</span></span></span></span><span class="hljs-function"><span class="hljs-params">/  (  ,   ) </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params">(int i = pSkype-&gt;GetActiveCalls()-&gt;GetCount(); i != </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ; i--) { call = pSkype-&gt;GetActiveCalls()-&gt;GetItem(i); </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">    </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(!strcmp((char*)(call-&gt;GetPartnerHandle()),comandName)) { call-&gt;Finish(); </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">   Sleep(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2000</span></span></span></span><span class="hljs-function"><span class="hljs-params">); </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">break</span></span></span></span><span class="hljs-function"><span class="hljs-params">; } } call = pSkype-&gt;PlaceCall(_bstr_t(comandName), L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">, L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">, L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">); </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">   pSkype-&gt;SendMessage(_bstr_t(comandName), _bstr_t(L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"'—î "</span></span></span></span><span class="hljs-function"><span class="hljs-params">)); </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(!device.Connect()) </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">    pSkype-&gt;SendMessage(_bstr_t(comandName), _bstr_t(L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"—ñ —ñ  —ñ"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)); </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params">(int i = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">;i &lt; timeWait &amp;&amp; call-&gt;Status != clsInProgress;i++) </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">     Sleep(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">20</span></span></span></span><span class="hljs-function"><span class="hljs-params">); </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(call-&gt;Status == clsInProgress) { Sleep(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2000</span></span></span></span><span class="hljs-function"><span class="hljs-params">); call-&gt;StartVideoSend(); </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">  (  ) </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">for</span></span></span></span><span class="hljs-function"><span class="hljs-params">(int time = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">; call-&gt;Status == clsInProgress;time++) { </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(time &gt;= timeWait) </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">     -   { call-&gt;Finish(); </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">break</span></span></span></span><span class="hljs-function"><span class="hljs-params">; } curMessage = pSkype-&gt;GetMessages((_bstr_t)comandName)-&gt;GetItem(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">); </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(curMessage-&gt;GetId() != privMessage-&gt;GetId()) </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">     { privMessage = curMessage; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(time &gt; </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">) time = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(!ComandToDevice((char*)curMessage-&gt;GetBody(),&amp;device,pSkype,comandName,&amp;time,call))</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">//</span></span></span></span><span class="hljs-function"><span class="hljs-params">     pSkype-&gt;SendMessage(_bstr_t(comandName), _bstr_t(L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"  "</span></span></span></span><span class="hljs-function"><span class="hljs-params">)); curMessage-&gt;PutSeen(</span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span><span class="hljs-function"><span class="hljs-params">); } Sleep(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">200</span></span></span></span><span class="hljs-function"><span class="hljs-params">); </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(!device.MoveCamera()) { pSkype-&gt;SendMessage(_bstr_t(comandName), _bstr_t(L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"  —î —ñ"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)); device.StopMoveCamera(); } </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">if</span></span></span></span><span class="hljs-function"><span class="hljs-params">(timeToSendMessage == time) pSkype-&gt;SendMessage(_bstr_t(comandName), _bstr_t(L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">" —ñ  —î"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)); } } pSkype-&gt;SendMessage(_bstr_t(comandName), _bstr_t(L</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"'—î "</span></span></span></span><span class="hljs-function"><span class="hljs-params">)); } ...</span></span></span></span></code> </pre><br>  Video demonstration of the device. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/e8YDh1pZeuA%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhj1rd_mrRETQ_jytYH21Vc_kv0-cQ" frameborder="0" allowfullscreen=""></iframe><br><br>  Completely all project can be taken <a href="http://webfile.ru/file/b75212ba1ae191477d1ba822d27abcfb">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/215841/">https://habr.com/ru/post/215841/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../215829/index.html">How I took a little Instagram</a></li>
<li><a href="../215831/index.html">Pwn2Own 2014: results</a></li>
<li><a href="../215835/index.html">Compiling sources (cpp, cs) with Visual Studio compiler without running IDE on Windows</a></li>
<li><a href="../215837/index.html">Documentation in software development</a></li>
<li><a href="../215839/index.html">Adding HDD to the "moody" laptop</a></li>
<li><a href="../215843/index.html">Google Docs Add-on. Expanding Google Docs Editor</a></li>
<li><a href="../215845/index.html">Mysterious pCell, or DIDO under the microscope</a></li>
<li><a href="../215849/index.html">Site Lenta.ru has undergone a hacker attack</a></li>
<li><a href="../215851/index.html">A little bit of CeBIT 2014</a></li>
<li><a href="../215859/index.html">Rikor.IT is one of the first in the world to develop energy-efficient servers!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>