<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do you remember a wonderful moment?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="[The past Year of Literature is dedicated to] 


 It was another Friday in a quiet, cozy bar with best friends ... The conversation went as usual: new...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do you remember a wonderful moment?</h1><div class="post__text post__text-html js-mediator-article"><p>  <i>[The past Year of Literature is dedicated to]</i> </p><br><p>  It was another Friday in a quiet, cozy bar with best friends ... The conversation went as usual: news, work, jokes, and again in a circle.  In search of a topic of conversation, sipping from beer mugs, for some reason they remembered the verses :) And then everyone began to recall that he still remembers from those distant school years.  If I stumbled, the rest suggested, if anyone remembered, it was quite fun and interesting.  Returning home that evening, I thought: what if you make a simple web application so that everyone can remember these beautiful works of Russian poetic thought?  The design of the application is already spinning in my head, and I sat down to develop ... </p><br><p><img src="https://habrastorage.org/files/3df/20c/bac/3df20cbac2674a50b025d9645a71c5bb.jpg"><br></p><a name="habracut"></a><br><h4>  Formulation of the problem </h4><br><p>  It is necessary to write a web application where the user randomly drops a poem, which he must finish by appending the "missing" words as the story goes.  At the end, the user should be shown the result and the opportunity to open another poem. </p><br><p>  Additional application requirements: </p><br><ul><li>  simplicity and clarity </li><li>  responsive design and accessibility on mobile devices </li><li>  smooth animation and quality of the application </li><li>  display user prompts if he does not remember the missing word </li><li>  support for multilingual and a different set of poems / authors for different countries </li><li>  make a completely static application so that you can place it on GitHub Pages and not pay for hosting: P </li></ul><br><h4>  Design </h4><br><p>  For the design, the old editions of the poems were specially studied in order to draw on the style of the print editions of the time.  I wanted something printed, the feeling of "paper" and at the same time simple.  The current flat-design fascination makes things easier, especially for a programmer, because he is not a designer.  IMHO, it turned out tolerably: </p><br><p><img src="https://habrastorage.org/files/0f3/1a7/ed8/0f31a7ed8fd14ced9d8924c069fe1e18.jpg"><br></p><br><p>  A good project needs a good name.  After checking several domains, I quickly found a suitable name for the project - <a href="http://literator.io/">literator.io</a> .  It was only later that I found out how much a domain in the .io zone costs, but it was already too late to change something, "art requires sacrifice." </p><br><h4>  Development </h4><br><p>  <i>What can please a programmer at work more than the opportunity to write good code and not be bound by deadlines?</i> </p><br><p>  But the order is still needed, and I muddied a small Kanban in Trello.  I love order. </p><br><img src="https://habrastorage.org/files/770/a0e/fa3/770a0efa32ae4577b6a1ad1f5ac9e5c6.jpg"><br><p>  <i>Yes, I noticed that now on GitHub you can also create boards.</i>  <i>Perhaps I will move there.</i> </p><br><h5>  Technology </h5><br><p>  The choice of a framework for building an application fell on <b>AngularJS</b> , because  several projects from the main place of work used it.  It was a year ago, Angular 2 was still in deep <s>ass</s> beta, and React was unfamiliar to me.  I also wanted to hone my skills in AngularJS, so as not to lose my knack, because  at work I had to write more on vanilla JS under the Titanium SDK, and this is a completely different area. </p><br><h5>  Data and how to store them </h5><br><p>  Having considered the possible architecture and having estimated various options, I came to the following structure: </p><br><p><img src="https://habrastorage.org/files/a85/a0d/83c/a85a0d83c95d4c91a2b25c5ca580bc72.jpg"><br></p><br><p>  As you can see, two entities stand out: authors and poems.  Each of the entities is described by metadata, the files of which are located in the same directories.  Verses (verses) additionally have a content.txt file, where the verse is stored. </p><br><p>  Separately, the structure.json file is highlighted.  If you remember, one of the conditions of the task was to make an application for which no backend will be needed.  And since there is no backend, we cannot go through the available directories to find out the structure of our data.  Just for this you need the structure.json file, which stores all the structure and metadata.  In order not to change this file manually each time, a Node-utility was written, which goes through all the available directories and collects metadata (it‚Äôs not for nothing that we laid them out, besides it‚Äôs convenient). </p><br><p>  As the saying goes: "Divide and conquer."  A good developer will not store data (albeit static) along with the source code in the same repository, so a <a href="https://github.com/bobrosoft/literator.io-verses">separate repository</a> was created for the poems.  It also allows you to use all the power of pull requests so that anyone can add new poems and new authors.  This repository connects to the main repository via <b>Git Submodules</b> , which gives additional control over which data revision is currently used. </p><br><p> It remained to change the task <code>grunt build</code> , so that everything was collected and copied to their places. </p><br><h5>  Verses and auto complete words </h5><br><p>  Separately, I wanted to dwell on how the auto-completion of words was implemented and, in general, breaking a verse into <i>fragments</i> that need to be filled in by the user.  There was a choice between the algorithmic choice of blocks and the explicit indication of these blocks in the verse itself.  I also wanted to make the choice of difficulty in the future, so the blocks had to be chosen differently.  I chose the latter ‚Äî an explicit indication of these blocks in the verse itself.  This requires preliminary preparation of the text of the verse, but allows you to get the best result, because  allows you to choose [subjectively] the most successful <i>fragments</i> that will correspond to the rhyme / flow of the poem and the meaning of the story.  Also, the person who prepares the verse can estimate in advance how difficult / simple it will be to solve a specific fragment. </p><br><pre> <code class="hljs erlang">  {{}}.   {}   {},     {} ,   {}.</code> </pre> <br><p>  As you can see, the <i>fragments are</i> enclosed in braces.  Nesting is necessary to specify fragments of different complexity.  The brackets "open" from inner to outer, so the "innermost" brackets in the concrete selection correspond to the "easy" level of complexity.  A fragment of the form <code>{{}}</code> corresponds to the fact that it will be used only for "medium" complexity and skipped to "easy", since  nested brackets contain nothing.  Thus, you can add any complexity, in principle, but currently only two are used in the markup, and in the application so far only the ‚Äúlight‚Äù is available. </p><br><p>  When you select a poem, it is normalized for the selected complexity and the extra brackets are removed, after which it is broken into fragments.  If interested, the code below.  I tried to make the normalization regular, but I could not assemble a worker, although I think it is possible (it should work for any nesting, not only for two). </p><br><pre> <code class="javascript hljs">Verse.prototype = { <span class="hljs-comment"><span class="hljs-comment">// ‚Ä¶ /** * Returns string, which normalized to passed difficulty (removes other difficulties' markup) * @param {String} string * @param {String} difficulty * @returns {String} */ normalizeStringToDifficulty: function(string, difficulty) { var self = this; // Convert difficulty string into int of complexity var complexity = difficulty === self.DIFFICULTY_EASY ? 1 : 2; // Normalize verse content to passed difficulty by removing block separators for other difficulties // (if somebody know easier solution, drop me pull request :) var contentArray = string.split(''); var startCharPositions = []; var endCharPositions = []; contentArray.forEach(function(char, index){ // Count separators switch (char) { case self.BLOCK_SEPARATOR_START: startCharPositions.push(index); break; case self.BLOCK_SEPARATOR_END: endCharPositions.push(index); break; } // Check if we counted all separators for one block (Note: current algo is not working with mixed groups) if (startCharPositions.length &amp;&amp; startCharPositions.length === endCharPositions.length) { var blockComplexity = Math.min(startCharPositions.length, complexity); // if block has lower complexity, use its maximum // Cleanup unnecessary blocks' separators startCharPositions.reverse().forEach(cleanup); endCharPositions.forEach(cleanup); // Reset stored positions startCharPositions = []; endCharPositions = []; } }); return contentArray.join(''); function cleanup(position, index) { if (index + 1 !== blockComplexity) { delete contentArray[position]; } }; } // ‚Ä¶ /** * Returns content divided into pieces to display it later * @param options * @returns {Array} */ getPieces: function(options) { var self = this; options = angular.extend({ difficulty: 'easy', }, options); // Get normalized content var contentArray = self.normalizeStringToDifficulty(self.content, options.difficulty).split(''); // Divide into pieces var pieces = []; var isInBlock = false; var blockPiece = null; contentArray.forEach(function(char){ switch (char) { case self.BLOCK_SEPARATOR_START: isInBlock = true; blockPiece = ''; break; case self.BLOCK_SEPARATOR_END: isInBlock = false; if (blockPiece.length) { pieces.push(new VerseBlock(blockPiece)); } break; default: if (isInBlock) { blockPiece += char; } else { pieces.push(char); } } }); return pieces; }</span></span></code> </pre> <br><h4>  Testing </h4><br><p>  Special attention was paid to usability and compatibility with mobile platforms, because as you know, the user experience there is significantly different from the desktop one.  In addition, mobile web surfing has already overtaken the desktop. </p><br><h5>  Safari, what are you doing ... </h5><br><p>  Optimization for iOS Safari brought some pain, mainly due to the fact that <b>you cannot</b> programmatically <b>put the focus on the input field</b> if the user has not performed any touch actions.  Therefore, there was a need to add a special hint for the user to tap into any place on the screen - only then can we set the focus on the desired element, which slightly spoils usability.  If someone knows how to solve this problem - write!  My last attempt here is <a href="https://jsfiddle.net/6tfrh7qn/5/">https://jsfiddle.net/6tfrh7qn/5/</a> (open in iPhone Simulator).  Still <b>not found how to pull the carriage away</b> . </p><br><p><img src="https://habrastorage.org/files/50c/38e/94a/50c38e94a7ba4babbc97cb3bff1c4338.jpg"><br></p><br><p>  Still, there is some kind of bug with a cursor that may not be displayed after focusing on the field. </p><br><h5>  User Testing </h5><br><p>  In the process of development, User Testing was conducted regularly (mostly for relatives and friends) in order to identify errors in the UI, UX (user experience) and in general to check the correctness of the idea presentation.  The tests gave very good results, allowing a significant improvement in the UX. </p><br><p>  On one of the tests, it turned out that the user thought that in the place where the narration stopped, you need to write everything that you remember next.  Then the first clue was changed from "Start typing and finish the poem" to "Start typing the next word." </p><br><p>  It also turned out that the user did not understand whether he was typing correctly and how much he needed to type, because he was mostly looking at the keyboard.  Then I added a sound that is played with the correct completion of the fragment.  It turned out quite intuitively. </p><br><p>  In general, a very useful practice, do not neglect the user tests! </p><br><h5>  Unit / E2E testing </h5><br><p>  Also, all the code is covered by Unit-tests and E2E-tests; not every project can be carved out for this time.  Writing them was a pleasure, in some places the development was on TDD.  Yes, the E2E tests on the Protractor can be skipped, if the browser window launched by the test is in the background or invisible.  If anyone knows how to fix it, please report it. </p><br><h4>  Summing up </h4><br><p>  Web application: <a href="http://literator.io/">http://literator.io</a> <br>  Application repository: <a href="">https://github.com/bobrosoft/literator.io</a> <br>  Poems repository: <a href="https://github.com/bobrosoft/literator.io-verses">https://github.com/bobrosoft/literator.io-verses</a> </p><br><p>  The development went slowly, and more than a year has passed since its launch.  Although the main part was completed fairly quickly, it took time to polish and finish everything - the Pareto principle in action :) Sometimes there was a desire to continue, because  completely new ideas came to mind, but I made an effort, otherwise this gestalt would not give rest. </p><br><p>  I think that for the beginning I added all the verses that should be known to most of us.  I tried not to take long poems (although there is a "Borodino"), so as not to tire the user.  If you undeservedly missed something, write in the comments, add. </p><br><p>  Project development ideas (in order of importance): </p><br><ul><li>  add "I don't remember" button to skip an unfamiliar verse </li><li>  change the display of the result, make it more interesting, show how well you remember a specific poem / how good a memory is (wish from one of the user tests) </li><li>  multilanguage and a different set of poems / authors for different countries (not yet fully implemented, but there is a backlog) </li><li>  add verse list </li><li>  drawings on the margins that appear as the story goes (Pushkin liked to draw, different authors would have their own; there is a reserve for this in the file structure) </li><li>  add sound in the form of classical music to the mood of the poem (in the metadata of the verse there is a field "mood" just for this).  If someone knows a good source of Creative Commons music, where you can find the classics in good quality, please share. </li></ul><br><p>  Thanks for attention!  I hope someone will find this project interesting and will bring positive emotions :) </p><br><p>  UPD: anyone interested in further development of the project, join the group <a href="https://vk.com/literatorio">https://vk.com/literatorio</a> or <a href="https://www.facebook.com/LiteratorioApp/">https://www.facebook.com/LiteratorioApp/</a> so as not to miss the update announcement. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/311300/">https://habr.com/ru/post/311300/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311290/index.html">‚ÄúSmart‚Äù weapons - the child of the blockchain, clouds and IoT</a></li>
<li><a href="../311292/index.html">RMM-systems: remote monitoring and corporate network management (with an example of quick implementation)</a></li>
<li><a href="../311294/index.html">Prototyping iOS animations with Framer</a></li>
<li><a href="../311296/index.html">8 myths about deduplication</a></li>
<li><a href="../311298/index.html">The book "Graphic Design. Basic concepts "</a></li>
<li><a href="../311302/index.html">How Yahoo moved from Flash to HTML5 to video</a></li>
<li><a href="../311304/index.html">CSN-Ajax programming template</a></li>
<li><a href="../311306/index.html">We work in the cloud based on Hyper-V, Part 2: Deploying Exchange Server</a></li>
<li><a href="../311308/index.html">Dino Esposito: "Here, developers are more in demand, and their work is paid higher"</a></li>
<li><a href="../311310/index.html">Samsung Pay launched at its own risk in Russia - expert opinions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>