<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Darts, dice and coins: discrete sampling algorithms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once I asked on Stack Overflow a question about the data structure for the cheating dice . In particular, I was interested in the answer to this quest...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Darts, dice and coins: discrete sampling algorithms</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ui/vn/pu/uivnpunqotxuaiqrlnhbujd_tl4.gif"></div><br>  Once I asked on Stack Overflow a question about <a href="http://stackoverflow.com/q/5027757/501557">the data structure for the cheating dice</a> .  In particular, I was interested in the answer to this question: ‚ÄúIf we have an n-sided bone, the face of which i has the probability of falling out p <sub>i</sub> .  What is the most efficient data structure for simulating such a dice? ‚Äù <br><br>  This data structure can be used for many tasks.  For example, you can use it to simulate the throws of an honest hex bone, assigning the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-7"><span class="MJXp-mn" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mn" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-36" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ frac {1} {6} </script>  each side of the bone, or to simulate an honest coin by imitating a double-sided bone, the probability of each side falling out is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mtext" id="MJXp-Span-12">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-17"><span class="MJXp-mn" id="MJXp-Span-18"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mn" id="MJXp-Span-20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ frac {1} {2} </script>  .  You can also use this data structure to directly simulate the sum of two honest hexagonal bones by creating an 11-sided bone (with faces of 2, 3, 4, ..., 12), each face of which has a probability weight corresponding to the rolls of two honest bones.  However, you can also use this data structure to simulate cheat bones.  For example, if you play <a href="http://en.wikipedia.org/wiki/Craps">craps</a> with a bone that you know is not perfectly fair, then you can use this data structure to simulate a variety of bone rolls and analyze the optimal strategy.  You can also try to simulate a similarly imperfect <a href="http://en.wikipedia.org/wiki/Roulette">roulette wheel</a> . <br><br>  If you go beyond the limits of the games, you can apply this data structure in the simulation of robots, the sensors of which have known levels of failure.  For example, if the range sensor has a 95 percent probability of returning the correct value, a 4 percent probability of too small a value, and a 1 percent probability of a too large value, then you can use this data structure to simulate the reading of the sensor by generating a random result and simulating the reading of the sensor result. <br><a name="habracut"></a><br>  The response I received at Stack Overflow impressed me for two reasons.  First, in the decision I was advised to use a powerful technique called the <b>alias-method</b> , which, with certain reasonable assumptions about the model of the machine, is capable, after a simple preliminary preparation stage, to simulate rolls of the dice during <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-24"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.66ex" viewBox="0 -832 2043 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1653" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> O (1) </script>  .  Secondly, I was even more surprised by the fact that this algorithm has been known for decades, but I have never met it!  Given how much computational time is spent on the simulation, one would expect that this technique is known much more widely.  Several queries to Google gave me a lot of information about this technique, but I could not find a single site where the intuitive understanding and explanation of this technique would be connected. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This article is my attempt to make a brief overview of various approaches to the simulation of a cheat bone, from simple and very impractical techniques, to a very optimized and effective alias method.  I hope that I will be able to convey the different ways of the intuitive understanding of the task and the extent to which each of them emphasizes some new aspect of the simulation of the cheat bone.  My goal for each approach is to study the motivating idea, the basic algorithm, proof of correctness and analysis of the execution time (in terms of the required time, memory and randomness). <br><br><h2>  Introduction </h2><br>  Before proceeding to the specific details of various techniques, let's first standardize the terminology and notation. <br><br>  In the introduction to the article, I used the term ‚Äúcheat bone‚Äù to describe a generalized scenario in which there is a finite set of results, each of which has a probability, Formally, this is called a <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B2%25D0%25B5%25D1%2580%25D0%25BE%25D1%258F%25D1%2582%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B5%25D0%25B9">discrete probability distribution</a> , and the task of simulating a cheat bone is called a <b>sample from a discrete distribution</b> . <br><br>  To describe our discrete probability distribution (shuler's bone), we will assume that we have a set of n probabilities <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-41" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-43"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.229ex" height="1.937ex" viewBox="-38.5 -520.7 6556.8 834" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="712" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="957" y="0"></use><g transform="translate(1402,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="2359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="2805" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="3250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="3695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="4140" y="0"></use><g transform="translate(4585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1379" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-4"> p_0, p_1, ..., p_ {n - 1} </script>  related to results <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mn" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-48"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-56"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.926ex" height="2.298ex" viewBox="0 -728.2 5995.9 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="1446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="1891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="3226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="3671" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2212" x="4494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="5495" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> 0, 1, ..., n - 1 </script>  .  Although the results can be any (eagle / tails, numbers on bones, colors, etc.), for simplicity, I will consider the result to be some positive real number corresponding to a given index. <br><br>  Working with real numbers on a computer is a ‚Äúgray area‚Äù of computing.  There are many fast algorithms whose speed is provided solely by the ability to <a href="http://cstheory.stackexchange.com/a/3648/4354">calculate the floor function of an arbitrary real number</a> in constant time, and numerical inaccuracies in the representation of floating-point numbers can completely destroy some algorithms.  Therefore, before embarking on any discussion of algorithms that work with probabilities, that is, to enter into the dark world of real numbers, I must clarify what a computer can and cannot do. <br><br>  Hereinafter, I will assume that all of the following operations can be performed in constant time: <br><br><ul><li>  <b>Addition.</b>  <b>subtraction, multiplication, division and comparison of arbitrary real numbers</b> .  We will need to do this to manipulate probabilities.  It may seem that this is too bold an assumption, but if we assume that the accuracy of any real number is limited by a certain word-size polynomial of the machine (for example, 64-bit double on a 32-bit machine), but I do not think that this is too unreasonable. </li><li>  <b>Generation of a uniform real number in the interval [0, 1).</b>  To simulate randomness, we need some source of random values.  I assume that we can generate a real number of arbitrary precision in constant time.  This far exceeds the capabilities of a real computer, but it seems to me that this is acceptable for the purposes of this discussion.  If we agree to sacrifice a bit of precision, saying that an arbitrary <a href="http://en.wikipedia.org/wiki/IEEE_754-2008">IEEE-754 double</a> is in the interval [0, 1], then we really lose accuracy, but the result is likely to be accurate enough for most applications. </li><li>  <b>Calculating the integer floor (rounding down) of a real number.</b>  This is permissible if we assume that we are working with IEEE-754 double, but in general, such a requirement for a computer is impracticable. </li></ul><br>  It is worth asking whether it is reasonable to assume that we can perform all these operations efficiently.  In practice, we rarely use the probabilities specified to such a level of accuracy at which the inherent IEEE-754 double rounding error can cause serious problems, so we can fulfill all the above requirements simply by working exclusively with IEEE double.  However, if we are in an environment where probabilities are indicated <i>exactly</i> as rational numbers of high accuracy, then such restrictions may turn out to be unreasonable. <br><br><h2>  Simulation of honest bones </h2><br>  Before we move on to the more general case of throwing an arbitrary cheat bone, let's start with a simpler algorithm that serves as a building block for subsequent algorithms: with a simulation of an honest n-face bone.  For example, throws of an honest 6-faced dice can be useful to us when playing Monopoly or Risk, or throwing an honest coin (double-sided dice), etc. <br><br>  For this particular case, there is a simple, elegant, and efficient algorithm for simulating the result.  The algorithm is based on the following idea: Suppose that we can generate really random, uniformly distributed real numbers in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-59"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-61"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> [0, 1) </script>  .  To illustrate this interval as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bcc/c99/2ce/bccc992ce908551624910725255e4bad.png"></div><br>  Now if we want to quit <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> n </script>  -cut bone, one of the ways is to divide the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-67"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-69"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> [0, 1) </script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> n </script>  areas of equal size, each of which has a length <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mtext" id="MJXp-Span-74">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-79"><span class="MJXp-mn" id="MJXp-Span-80"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.702ex" height="2.419ex" viewBox="0 -780.1 3316 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> \ frac {1} {n} </script>  .  It looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e4/ddc/fb4/4e4ddcfb47aa1b90af1ca74b17edff15.png"></div><br>  Next, we generate a randomly selected real number in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-85"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-87"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> [0, 1) </script>  which exactly fits into one of these small areas.  From this we can count the result of the roll of the dice, looking at the area in which the number fell.  For example, if our randomly chosen value fell into this place: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24e/328/e5f/24e328e5f77279a8e44566f22e1c015c.png"></div><br>  then we can say that the bone has fallen 2 (if we assume that the edges of the bone are indexed from scratch). <br><br>  It is graphically easy to see which of the regions got a random value, but how do we encode it in the algorithm?  And here we take advantage of the fact that this is an honest bone.  Since all intervals are of equal size, namely <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-89"><span class="MJXp-mtext" id="MJXp-Span-90">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-95"><span class="MJXp-mn" id="MJXp-Span-96"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.702ex" height="2.419ex" viewBox="0 -780.1 3316 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> \ frac {1} {n} </script>  then we can see which is the greatest value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> i </script>  is such that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mtext" id="MJXp-Span-102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.342ex" height="2.419ex" viewBox="0 -780.1 3161 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="2560" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> \ frac {i} {n} </script>  no more randomly generated value (let's call this x value).  You may notice that if we want to find the maximum value, such that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mtext" id="MJXp-Span-112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">c</span><span class="MJXp-mrow" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">i</span></span><span class="MJXp-mrow" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">n</span></span><span class="MJXp-mtext" id="MJXp-Span-121">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.029ex" height="2.419ex" viewBox="0 -780.1 4748.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="2560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="3411" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-65" x="3709" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-78" x="4176" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> \ frac {i} {n} \ le x </script>  then this is similar to finding the maximum value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> n </script>  such that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">i</span><span class="MJXp-mtext" id="MJXp-Span-129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.884ex" height="2.057ex" viewBox="0 -780.1 2533.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="595" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-65" x="894" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-78" x="1360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="1933" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> i \ le xn </script>  .  But this by definition means that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">i</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-137">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">n</span><span class="MJXp-mtext" id="MJXp-Span-146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.08ex" height="2.419ex" viewBox="0 -780.1 8645.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-3D" x="623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="1929" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="2228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="2778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="3077" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="3562" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="4048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-78" x="4499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="5072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="5922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="6374" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="6924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="7223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="7708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="8194" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> i = \ lfloor xn \ rfloor </script>  , the greatest positive integer is not greater than xn.  Therefore, this leads us to the following (very simple) algorithm for simulating an honest n-face bone: <br><br><blockquote><h4>  Algorithm: honest bone simulation </h4><br><ol><li>  We generate a uniformly distributed random value. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> x </script>  in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-155"><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-157">0</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-159">1</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> [0, 1) </script>  . </li><li>  Return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-mtext" id="MJXp-Span-162">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">n</span><span class="MJXp-mtext" id="MJXp-Span-171">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.179ex" height="2.419ex" viewBox="0 -780.1 6966 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="1099" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="1397" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="1883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="2368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-78" x="2820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6E" x="3392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="4243" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="4694" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6C" x="5245" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="5543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6F" x="6029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="6514" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21"> \ lfloor xn \ rfloor </script>  . </li></ol><br>  Given our computational assumptions made above, this algorithm runs in time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">O</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-181">1</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.66ex" viewBox="0 -832 2043 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1653" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> O (1) </script>  . </blockquote><br>  Two conclusions can be drawn from this section.  First, we can divide the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-185">0</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-187">1</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23"> [0, 1) </script>  into parts so that a uniformly distributed random real number in this interval naturally reduces to one of the many discrete choices available to us.  In the rest of the article we will actively exploit this technique.  Secondly, it can be difficult to determine which specific interval a random value belongs to, but if we know something about the parts (in this case, that they are all the same size), then it can be mathematically simple to determine which part exactly point. <br><br><h2>  Simulation of a cheat bone using honest bone </h2><br>  Having an honest bone simulation algorithm, can we adapt it to simulate a cheat bone?  Interestingly, the answer is yes, but the solution will require more space. <br><br>  From the previous section, it is intuitively clear that in order to simulate the throw of a cheat bone, it suffices to divide the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-189"><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-191">0</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-193">1</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24"> [0, 1) </script>  into parts, and then determine which part we hit.  However, in general, this may be much more complicated than it seems.  Suppose we have a tetrahedral bone with face probabilities <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mtext" id="MJXp-Span-196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">c</span><span class="MJXp-mrow" id="MJXp-Span-201"><span class="MJXp-mn" id="MJXp-Span-202">1</span></span><span class="MJXp-mrow" id="MJXp-Span-203"><span class="MJXp-mn" id="MJXp-Span-204">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-25"> \ frac {1} {2} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-205"><span class="MJXp-mtext" id="MJXp-Span-206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">c</span><span class="MJXp-mrow" id="MJXp-Span-211"><span class="MJXp-mn" id="MJXp-Span-212">1</span></span><span class="MJXp-mrow" id="MJXp-Span-213"><span class="MJXp-mn" id="MJXp-Span-214">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-33" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26"> \ frac {1} {3} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-215"><span class="MJXp-mtext" id="MJXp-Span-216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">c</span><span class="MJXp-mrow" id="MJXp-Span-221"><span class="MJXp-mn" id="MJXp-Span-222">1</span></span><span class="MJXp-mrow" id="MJXp-Span-223"><span class="MJXp-mn" id="MJXp-Span-224">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-27"> \ frac {1} {12} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-225"><span class="MJXp-mtext" id="MJXp-Span-226">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">c</span><span class="MJXp-mrow" id="MJXp-Span-231"><span class="MJXp-mn" id="MJXp-Span-232">1</span></span><span class="MJXp-mrow" id="MJXp-Span-233"><span class="MJXp-mn" id="MJXp-Span-234">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-28"> \ frac {1} {12} </script>  (we can make sure that this is the correct probability distribution, because <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-235"><span class="MJXp-mtext" id="MJXp-Span-236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">c</span><span class="MJXp-mrow" id="MJXp-Span-241"><span class="MJXp-mn" id="MJXp-Span-242">1</span></span><span class="MJXp-mrow" id="MJXp-Span-243"><span class="MJXp-mn" id="MJXp-Span-244">2</span></span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-246">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">c</span><span class="MJXp-mrow" id="MJXp-Span-251"><span class="MJXp-mn" id="MJXp-Span-252">1</span></span><span class="MJXp-mrow" id="MJXp-Span-253"><span class="MJXp-mn" id="MJXp-Span-254">3</span></span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-256">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">c</span><span class="MJXp-mrow" id="MJXp-Span-261"><span class="MJXp-mn" id="MJXp-Span-262">1</span></span><span class="MJXp-mrow" id="MJXp-Span-263"><span class="MJXp-mn" id="MJXp-Span-264">12</span></span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-266">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">c</span><span class="MJXp-mrow" id="MJXp-Span-271"><span class="MJXp-mn" id="MJXp-Span-272">1</span></span><span class="MJXp-mrow" id="MJXp-Span-273"><span class="MJXp-mn" id="MJXp-Span-274">12</span></span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-276">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">c</span><span class="MJXp-mrow" id="MJXp-Span-281"><span class="MJXp-mn" id="MJXp-Span-282">6</span></span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mn" id="MJXp-Span-284">12</span></span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-286">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">c</span><span class="MJXp-mrow" id="MJXp-Span-291"><span class="MJXp-mn" id="MJXp-Span-292">4</span></span><span class="MJXp-mrow" id="MJXp-Span-293"><span class="MJXp-mn" id="MJXp-Span-294">12</span></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">c</span><span class="MJXp-mrow" id="MJXp-Span-301"><span class="MJXp-mn" id="MJXp-Span-302">1</span></span><span class="MJXp-mrow" id="MJXp-Span-303"><span class="MJXp-mn" id="MJXp-Span-304">12</span></span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-306">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">c</span><span class="MJXp-mrow" id="MJXp-Span-311"><span class="MJXp-mn" id="MJXp-Span-312">1</span></span><span class="MJXp-mrow" id="MJXp-Span-313"><span class="MJXp-mn" id="MJXp-Span-314">12</span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">c</span><span class="MJXp-mrow" id="MJXp-Span-321"><span class="MJXp-mn" id="MJXp-Span-322">12</span></span><span class="MJXp-mrow" id="MJXp-Span-323"><span class="MJXp-mn" id="MJXp-Span-324">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="99.764ex" height="2.419ex" viewBox="0 -780.1 42953.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2B" x="3438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="4688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="5239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="5690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="6220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="6653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-33" x="7154" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2B" x="7877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="9127" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="9678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="10129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="10659" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="11092" y="0"></use><g transform="translate(11593,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2B" x="12816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="14067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="14617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="15069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="15598" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="16032" y="0"></use><g transform="translate(16532,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-3D" x="17811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="19117" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="19668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="20119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="20649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-36" x="21082" y="0"></use><g transform="translate(21583,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2B" x="22806" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="24057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="24607" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="25059" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="25588" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-34" x="26022" y="0"></use><g transform="translate(26522,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2B" x="27746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="28996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="29547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="29998" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="30528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="30961" y="0"></use><g transform="translate(31462,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2B" x="32685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="33936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="34486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="34938" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="35467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="35901" y="0"></use><g transform="translate(36401,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-3D" x="37680" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="38986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="39537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="39988" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="40518" y="0"></use><g transform="translate(40951,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><g transform="translate(41952,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-29"> \ frac {1} {2} + \ frac {1} {3} + \ frac {1} {12} + \ frac {1} {12} = \ frac {6} {12} + \ frac {4 } {12} + \ frac {1} {12} + \ frac {1} {12} = \ frac {12} {12} </script>  ).  If we divide the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-327">0</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-329">1</span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-30"> [0, 1) </script>  into four pieces of these sizes, we get the following: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/765/3b8/0bb/7653b80bb6acb83fc99a9a0bdc470e9c.png"></div><br>  Unfortunately, at this step we will be stuck.  Even if we knew a random number in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-331"><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-333">0</span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-335">1</span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-31"> [0, 1) </script>  then there are no simple mathematical tricks to automatically determine which part of this number fell into.  I do not want to say that this is impossible - as you will see, we can use many excellent tricks - but none of them has the mathematical simplicity of an honest bone throw algorithm. <br><br>  However, we can adapt the technique used for honest bones so that it works in this case as well.  Let's take, for example, the bone discussed above.  The probability of falling faces is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-mtext" id="MJXp-Span-338">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">c</span><span class="MJXp-mrow" id="MJXp-Span-343"><span class="MJXp-mn" id="MJXp-Span-344">1</span></span><span class="MJXp-mrow" id="MJXp-Span-345"><span class="MJXp-mn" id="MJXp-Span-346">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-32"> \ frac {1} {2} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mtext" id="MJXp-Span-348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">c</span><span class="MJXp-mrow" id="MJXp-Span-353"><span class="MJXp-mn" id="MJXp-Span-354">1</span></span><span class="MJXp-mrow" id="MJXp-Span-355"><span class="MJXp-mn" id="MJXp-Span-356">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-33" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-33"> \ frac {1} {3} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-357"><span class="MJXp-mtext" id="MJXp-Span-358">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">c</span><span class="MJXp-mrow" id="MJXp-Span-363"><span class="MJXp-mn" id="MJXp-Span-364">1</span></span><span class="MJXp-mrow" id="MJXp-Span-365"><span class="MJXp-mn" id="MJXp-Span-366">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-34"> \ frac {1} {12} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-mtext" id="MJXp-Span-368">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">c</span><span class="MJXp-mrow" id="MJXp-Span-373"><span class="MJXp-mn" id="MJXp-Span-374">1</span></span><span class="MJXp-mrow" id="MJXp-Span-375"><span class="MJXp-mn" id="MJXp-Span-376">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-35"> \ frac {1} {12} </script>  .  If we rewrite it so that all members have a common divisor, we get the values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-mtext" id="MJXp-Span-378">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">c</span><span class="MJXp-mrow" id="MJXp-Span-383"><span class="MJXp-mn" id="MJXp-Span-384">6</span></span><span class="MJXp-mrow" id="MJXp-Span-385"><span class="MJXp-mn" id="MJXp-Span-386">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-36" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-36"> \ frac {6} {12} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-mtext" id="MJXp-Span-388">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">c</span><span class="MJXp-mrow" id="MJXp-Span-393"><span class="MJXp-mn" id="MJXp-Span-394">4</span></span><span class="MJXp-mrow" id="MJXp-Span-395"><span class="MJXp-mn" id="MJXp-Span-396">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-34" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-37"> \ frac {4} {12} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-mtext" id="MJXp-Span-398">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">c</span><span class="MJXp-mrow" id="MJXp-Span-403"><span class="MJXp-mn" id="MJXp-Span-404">1</span></span><span class="MJXp-mrow" id="MJXp-Span-405"><span class="MJXp-mn" id="MJXp-Span-406">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-38"> \ frac {1} {12} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-407"><span class="MJXp-mtext" id="MJXp-Span-408">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">c</span><span class="MJXp-mrow" id="MJXp-Span-413"><span class="MJXp-mn" id="MJXp-Span-414">1</span></span><span class="MJXp-mrow" id="MJXp-Span-415"><span class="MJXp-mn" id="MJXp-Span-416">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.632ex" height="2.419ex" viewBox="0 -780.1 3716.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-39"> \ frac {1} {12} </script> .  Therefore, we can perceive this task as follows: instead of throwing a tetrahedral bone with weighted probabilities, why not throw a 12-sided honest bone, on the edges of which there are repetitive values?  Since we know how to simulate honest bone, this will be analogous to dividing the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-417"><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-419">0</span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-421">1</span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.91ex" height="2.66ex" viewBox="0 -832 2114.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-29" x="1724" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-40"> [0, 1) </script>  on the part in this way: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed8/08e/09d/ed808e09dcb7a34b4518cba73cdb5ab7.png"></div><br>  Then we assign them to various results as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c37/621/28a/c3762128af82d86bc42a2a35455b2efb.png"></div><br>  Now, it will be very easy to simulate a roll of the dice - we just throw this new honest bone, and then we look at which side fell out and read its value.  This first step can be performed by the above algorithm, which will give us an integer number in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mn" id="MJXp-Span-424">0</span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-426">1</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-432">11</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.853ex" height="2.298ex" viewBox="0 -728.2 4673 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-30" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="1446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="1891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2E" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-2C" x="3226" y="0"></use><g transform="translate(3671,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-41"> 0, 1, ..., 11 </script>  .  To bind this integer to one of the faces of the original cheat bone, we will store an auxiliary array of twelve elements, connecting each of these numbers with the original result.  Graphically, this can be represented as: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f46/197/bb9/f46197bb9643b5db497a57fae3b3065d.png"></div><br>  In order to formalize this in the form of an algorithm, we will describe both the initialization stage (obtaining the table) and the generation stage (simulation of a random bone roll).  Both of these steps are important to consider in this and subsequent algorithms, because the preparation time should be excellent. <br><br>  At the initialization stage, we begin with the search for the <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B0%25D0%25B8%25D0%25BC%25D0%25B5%25D0%25BD%25D1%258C%25D1%2588%25D0%25B5%25D0%25B5_%25D0%25BE%25D0%25B1%25D1%2589%25D0%25B5%25D0%25B5_%25D0%25BA%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B5">smallest common multiple of</a> all the probabilities specified for the edges of the bone (in our example, the LCM is 12).  The NOC is useful here because it corresponds to the smallest common divisor that we can use for all fractions, and therefore the number of faces of the new honest dice that we will throw.  Having received this LCM (we denote it L), we must determine how many faces of the new bone will be distributed on each of the faces of the original cheat bone.  In our example, the edge with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-433"><span class="MJXp-mtext" id="MJXp-Span-434">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">c</span><span class="MJXp-mrow" id="MJXp-Span-439"><span class="MJXp-mn" id="MJXp-Span-440">1</span></span><span class="MJXp-mrow" id="MJXp-Span-441"><span class="MJXp-mn" id="MJXp-Span-442">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-42"> \ frac {1} {2} </script>  gets six sides of a new bone since <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mtext" id="MJXp-Span-444">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">c</span><span class="MJXp-mrow" id="MJXp-Span-449"><span class="MJXp-mn" id="MJXp-Span-450">1</span></span><span class="MJXp-mrow" id="MJXp-Span-451"><span class="MJXp-mn" id="MJXp-Span-452">2</span></span><span class="MJXp-mtext" id="MJXp-Span-453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">s</span><span class="MJXp-mn" id="MJXp-Span-459">12</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-461">6</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.492ex" height="2.419ex" viewBox="0 -780.1 8823.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-74" x="3466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="3827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6D" x="4173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-65" x="5051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-73" x="5518" y="0"></use><g transform="translate(5987,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-3D" x="7266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-36" x="8322" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-43"> \ frac {1} {2} \ times 12 = 6 </script>  .  Similarly, the side with the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-462"><span class="MJXp-mtext" id="MJXp-Span-463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">c</span><span class="MJXp-mrow" id="MJXp-Span-468"><span class="MJXp-mn" id="MJXp-Span-469">1</span></span><span class="MJXp-mrow" id="MJXp-Span-470"><span class="MJXp-mn" id="MJXp-Span-471">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.469ex" height="2.419ex" viewBox="0 -780.1 3216 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-33" x="2715" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-44"> \ frac {1} {3} </script>  gets 4 faces since <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-mtext" id="MJXp-Span-473">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">c</span><span class="MJXp-mrow" id="MJXp-Span-478"><span class="MJXp-mn" id="MJXp-Span-479">1</span></span><span class="MJXp-mrow" id="MJXp-Span-480"><span class="MJXp-mn" id="MJXp-Span-481">3</span></span><span class="MJXp-mtext" id="MJXp-Span-482">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">s</span><span class="MJXp-mn" id="MJXp-Span-488">12</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-490">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.492ex" height="2.419ex" viewBox="0 -780.1 8823.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-33" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-74" x="3466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="3827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-6D" x="4173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-65" x="5051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-73" x="5518" y="0"></use><g transform="translate(5987,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-3D" x="7266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMAIN-34" x="8322" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-45"> \ frac {1} {3} \ times 12 = 4 </script>  .  In a more generalized form, if L is the NOK of probabilities, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-491"><span class="MJXp-msubsup" id="MJXp-Span-492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-494" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.817ex" viewBox="-38.5 -520.7 886.3 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="712" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-46"> p_i </script>  is the probability of falling face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/419725/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiRZW34gMGaIohh4wSVLapsMEjMmw#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-47"> i </script>  bones then we will highlight the faces <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> i </script>  original cheat bone <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">L</span><span class="MJXp-mtext" id="MJXp-Span-501">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">t</span><span class="MJXp-msubsup" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-508" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> L \ cdot p_i </script>  facets of honest bone. <br><br>  Here is the pseudocode of the above algorithm: <br><br><blockquote><h4>  Algorithm: simulation of a cheat bone using honest bone </h4><br><ul><li>  <b>Initialization</b> : <br><ol><li>  Find the NOK denominators of probabilities <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-msubsup" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-512" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-516" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-524" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">n</span><span class="MJXp-mo" id="MJXp-Span-526">‚àí</span><span class="MJXp-mn" id="MJXp-Span-527">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> p_0, p_1, ..., p_ {n-1} </script>  ;  denote it <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> L </script></li><li>  Select the array <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> A </script>  size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> L </script>  for comparing the results of throwing an honest bone with the throws of the original bone. </li><li>  For each face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> i </script>  source bone perform in any order the following: <br><ol><li>  We assign the following <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">L</span><span class="MJXp-mtext" id="MJXp-Span-538">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">t</span><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> L \ cdot p_i </script>  elements <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">A</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> A </script>  value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> i </script>  . </li></ol></li></ol></li><li>  <b>Generation</b> : <br><ol><li>  We generate a roll of honest bones for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> L </script>  - bone;  call the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> S </script>  . </li><li>  Return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">A</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">s</span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> A [s] </script>  . </li></ol></li></ul></blockquote><br>  Perhaps this algorithm is simple, but how effective is it?  The very generation of throwing the dice is fast enough - each throw of the dice requires <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">O</span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-562">1</span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> O (1) </script>  work time to generate a random roll of the dice using the previous algorithm, plus another <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">O</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-567">1</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> O (1) </script>  work time on the search table.  This gives us a total work time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">O</span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-572">1</span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> O (1) </script>  . <br><br>  However, the initialization step can be extremely expensive.  To make this algorithm work, we need to allocate space for an array the size of the LCM denominators of all input fractions.  In our example ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-574"><span class="MJXp-mtext" id="MJXp-Span-575">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">c</span><span class="MJXp-mrow" id="MJXp-Span-580"><span class="MJXp-mn" id="MJXp-Span-581">1</span></span><span class="MJXp-mrow" id="MJXp-Span-582"><span class="MJXp-mn" id="MJXp-Span-583">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> \ frac {1} {2} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-mtext" id="MJXp-Span-585">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">c</span><span class="MJXp-mrow" id="MJXp-Span-590"><span class="MJXp-mn" id="MJXp-Span-591">1</span></span><span class="MJXp-mrow" id="MJXp-Span-592"><span class="MJXp-mn" id="MJXp-Span-593">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> \ frac {1} {3} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mtext" id="MJXp-Span-595">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">c</span><span class="MJXp-mrow" id="MJXp-Span-600"><span class="MJXp-mn" id="MJXp-Span-601">1</span></span><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mn" id="MJXp-Span-603">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> \ frac {1} {12} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-604"><span class="MJXp-mtext" id="MJXp-Span-605">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">c</span><span class="MJXp-mrow" id="MJXp-Span-610"><span class="MJXp-mn" id="MJXp-Span-611">1</span></span><span class="MJXp-mrow" id="MJXp-Span-612"><span class="MJXp-mn" id="MJXp-Span-613">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> \ frac {1} {12} </script>  ), it is equal to 12, for with other input values, the values ‚Äã‚Äãmay be pathologically bad.  For example, let's consider fractions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-614"><span class="MJXp-mtext" id="MJXp-Span-615">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">c</span><span class="MJXp-mrow" id="MJXp-Span-620"><span class="MJXp-mn" id="MJXp-Span-621">999999</span></span><span class="MJXp-mrow" id="MJXp-Span-622"><span class="MJXp-mn" id="MJXp-Span-623">1</span><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-625">000</span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-627">000</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> \ frac {999999} {1,000,000} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mtext" id="MJXp-Span-629">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">c</span><span class="MJXp-mrow" id="MJXp-Span-634"><span class="MJXp-mn" id="MJXp-Span-635">1</span></span><span class="MJXp-mrow" id="MJXp-Span-636"><span class="MJXp-mn" id="MJXp-Span-637">1000000</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> \ frac {1} {1000000} </script>  .  The LCM denominators are equal to one million, therefore there should be one million elements in our table! <br><br>  Unfortunately, things can be even worse.  In the previous example, we can at least ‚Äúexpect‚Äù that the algorithm will take a lot of memory, since both denominators of fractions are equal to one million.  However, we may have a lot of probabilities for which the NOC is much larger than each individual denominator.  For an example, let's look at probabilities. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-mtext" id="MJXp-Span-639">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">c</span><span class="MJXp-mrow" id="MJXp-Span-644"><span class="MJXp-mn" id="MJXp-Span-645">1</span></span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mn" id="MJXp-Span-647">15</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> \ frac {1} {15} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-648"><span class="MJXp-mtext" id="MJXp-Span-649">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">c</span><span class="MJXp-mrow" id="MJXp-Span-654"><span class="MJXp-mn" id="MJXp-Span-655">1</span></span><span class="MJXp-mrow" id="MJXp-Span-656"><span class="MJXp-mn" id="MJXp-Span-657">10</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> \ frac {1} {10} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-658"><span class="MJXp-mtext" id="MJXp-Span-659">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">c</span><span class="MJXp-mrow" id="MJXp-Span-664"><span class="MJXp-mn" id="MJXp-Span-665">5</span></span><span class="MJXp-mrow" id="MJXp-Span-666"><span class="MJXp-mn" id="MJXp-Span-667">6</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> \ frac {5} {6} </script>  .  Here the NOC denominators are 30, which is more than any of the denominators.  The design works here because <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-mn" id="MJXp-Span-669">15</span><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-671">3</span><span class="MJXp-mtext" id="MJXp-Span-672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">s</span><span class="MJXp-mn" id="MJXp-Span-678">5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> 15 = 3 \ times 5 </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-679"><span class="MJXp-mn" id="MJXp-Span-680">10</span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-682">2</span><span class="MJXp-mtext" id="MJXp-Span-683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">s</span><span class="MJXp-mn" id="MJXp-Span-689">5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> 10 = 2 \ times 5 </script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-690"><span class="MJXp-mn" id="MJXp-Span-691">6</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-693">2</span><span class="MJXp-mtext" id="MJXp-Span-694">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">s</span><span class="MJXp-mn" id="MJXp-Span-700">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> 6 = 2 \ times 3 </script>  ;  in other words, each denominator is a product of two primes selected from a pool of three values.  Therefore, their LCM is the product of all these primes, since each denominator must be a divisor of LCM.  If we generalize this construction and consider any set of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> k </script>  primes and take one fraction for each of the pairwise products of these primes, the LCM will be much larger than each individual denominator.  In fact, one of the best upper bounds we can get for an NOC will be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">O</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">o</span><span class="MJXp-msubsup" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">i</span><span class="MJXp-mo" id="MJXp-Span-714">=</span><span class="MJXp-mn" id="MJXp-Span-715">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-717"><span class="MJXp-msubsup" id="MJXp-Span-718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-720" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> O (\ prod_ {i = 0} ^ n {d_i}) </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-725" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> d_i </script>  - this is the denominator <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79"> i </script>  -This probability.  This does not allow the use of such an algorithm in real conditions, when the probabilities are unknown in advance, since the memory required to store the size table <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">O</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-731">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">o</span><span class="MJXp-msubsup" id="MJXp-Span-735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">i</span><span class="MJXp-mo" id="MJXp-Span-739">=</span><span class="MJXp-mn" id="MJXp-Span-740">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-742"><span class="MJXp-msubsup" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-745" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> O (\ prod_ {i = 0} ^ n {d_i}) </script>  , can easily be more volume that can fit in RAM. <br><br>  In other words, in many cases this algorithm behaves well.  If all probabilities are the same, then all probabilities obtained at the input are equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-mtext" id="MJXp-Span-748">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">c</span><span class="MJXp-mrow" id="MJXp-Span-753"><span class="MJXp-mn" id="MJXp-Span-754">1</span></span><span class="MJXp-mrow" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> \ frac {1} {n} </script>  for some <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> n </script>  .  Then the LCM denominators are <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> n </script>  that is, as a result, an honest bone being thrown will have <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> n </script>  faces, and each face of the original bone will correspond to one facet of honest bone.  Therefore, the initialization time is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">O</span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">n</span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> O (n) </script>  .  Graphically, this can be represented as: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/62a/f58/021/62af580213584e27b0eba55a14155a4e.png"></div><br>  This gives us the following information about the algorithm: <br><br><table><tbody><tr><th>  Algorithm </th><th colspan="2">  Initialization time </th><th colspan="2">  Generation time </th><th colspan="2">  Occupied memory </th></tr><tr><th></th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th></tr><tr><td>  Honest bone cheat bone </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mtext" id="MJXp-Span-769">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">a</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">n</span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">O</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-781">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">o</span><span class="MJXp-msubsup" id="MJXp-Span-785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">i</span><span class="MJXp-mo" id="MJXp-Span-789">=</span><span class="MJXp-mn" id="MJXp-Span-790">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-792"><span class="MJXp-msubsup" id="MJXp-Span-793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-795" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-797"><span class="MJXp-mtext" id="MJXp-Span-798">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">a</span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-805">1</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-807"><span class="MJXp-mtext" id="MJXp-Span-808">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">a</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">n</span><span class="MJXp-mo" id="MJXp-Span-816" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">O</span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-820">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">o</span><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">i</span><span class="MJXp-mo" id="MJXp-Span-828">=</span><span class="MJXp-mn" id="MJXp-Span-829">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-831"><span class="MJXp-msubsup" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-834" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td></tr></tbody></table><br>  Another important detail about this algorithm: it assumes that we will get convenient probabilities in the form of fractions with good denominators.  If the probabilities are set as IEEE-754 double, then this approach is most likely waiting for a catastrophe because of small rounding errors;  Imagine that we have probabilities of 0.25 and 0.250000000001!  Therefore, it is probably better not to use such an approach, except for special cases when the probabilities behave well and are indicated in a format corresponding to operations with rational numbers. <br><br><h2>  Simulation Asymmetric Coin </h2><br>  Our explanation of a simple random primitive (honest bone) led to a simple, but potentially terribly inefficient algorithm for simulating a cheat bone.  Perhaps the study of other simple random primitives will shed some light on other approaches to solving this problem. <br><br>  A simple but surprisingly useful task is to simulate an asymmetric coin using a random number generator.  If we have a coin with the probability of falling eagle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-836"><span class="MJXp-msubsup" id="MJXp-Span-837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-839" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">s</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91"> p_ {heads} </script>  , how can we simulate the throw of such an asymmetric coin? <br><br>  Earlier, we developed one intuitive approach: splitting the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-845"><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-847">0</span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-849">1</span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-92"> [0, 1) </script>  on the sequence of such areas that, when choosing a random value in the interval, it turns out to be in some area with a probability equal to the size of the area.  To simulate an asymmetric coin using a uniformly distributed random value in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-853">0</span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-855">1</span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93"> [0, 1) </script>  we have to split the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-857"><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-859">0</span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-861">1</span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94"> [0, 1) </script>  in the following way: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a13/c40/04d/a13c4004d212ec582211efd2c190b78a.png"></div><br>  And then generate a uniformly distributed random value in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-863"><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-865">0</span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-867">1</span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-95"> [0, 1) </script>  to see in which area it is contained.  Fortunately, we have only one split point, so it is very easy to determine in which area the point is located;  if the value is less <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-869"><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-872" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">s</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-96"> p_ {heads} </script>  then the eagle fell on the coin, otherwise tails.  Pseudocode: <br><br><blockquote><h4>  Algorithm: Asymmetric Coin Simulation </h4><br><ol><li>  We generate a uniformly distributed random value in the interval. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-880">0</span><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-882">1</span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-97"> [0, 1) </script>  . </li><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">x</span><span class="MJXp-mo" id="MJXp-Span-886" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-889" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">s</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-98"> x <p_ {heads} </script>  , return the "eagle". </li><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">x</span><span class="MJXp-mtext" id="MJXp-Span-897">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">e</span><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-902" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">s</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99"> x \ ge p_ {heads} </script>  , return "tails." </li></ol></blockquote><br>  Since we can generate a uniformly distributed random value in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-910">0</span><span class="MJXp-mo" id="MJXp-Span-911" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-912">1</span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100"> [0, 1) </script>  during <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">O</span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-917">1</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-101"> O (1) </script>  and we can also make a comparison of real numbers for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">O</span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-922">1</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102"> O (1) </script>  then this algorithm runs in time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">O</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-927">1</span><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103"> O (1) </script>  . <br><br><h2>  Honest bone simulation using asymmetrical coins </h2><br>  From the previous discussion, we know that you can simulate a cheat bone with the help of an honest bone, if we assume that we are ready to spend extra space in memory.  Since we can perceive an asymmetric coin as a cheating two-sided bone, this means that we can simulate an asymmetric coin with the help of an honest bone.  Interestingly, the opposite can be done - to simulate an honest bone with the help of an asymmetric coin.  The design is simple, elegant, and can be easily generalized to simulate a cheat bone using a variety of asymmetric coins. <br><br>  The design for simulating an asymmetric coin breaks the spacing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mo" id="MJXp-Span-930" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-931">0</span><span class="MJXp-mo" id="MJXp-Span-932" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-933">1</span><span class="MJXp-mo" id="MJXp-Span-934" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104"> [0, 1) </script>  on two areas - the area of ‚Äã‚Äã"eagles" and the area of ‚Äã‚Äã"tails" based on the probability of eagles falling on the bones.  We have already seen a similar trick used to simulate an honest <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105"> n </script>  - face bone: spacing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-937"><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-939">0</span><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-941">1</span><span class="MJXp-mo" id="MJXp-Span-942" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106"> [0, 1) </script>  divided into <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-107"> n </script>  equal areas.  For example, when throwing a tetrahedral bone, we had the following separation: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e4/ddc/fb4/4e4ddcfb47aa1b90af1ca74b17edff15.png"></div><br>  Now suppose that we are interested in simulating the throw of this honest bone using a set of asymmetric coins.  One solution is as follows: Imagine that we are going around these areas from left to right, asking each time if we want to stop in the current area, or we will move on.  For example, let's assume that we want to randomly select one of these areas.  Starting from the leftmost area, we will flip an asymmetrical coin that tells us whether we should stop in this area or continue on.  Since we need to choose from all these areas evenly with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-945"><span class="MJXp-mtext" id="MJXp-Span-946">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">c</span><span class="MJXp-mrow" id="MJXp-Span-951"><span class="MJXp-mn" id="MJXp-Span-952">1</span></span><span class="MJXp-mrow" id="MJXp-Span-953"><span class="MJXp-mn" id="MJXp-Span-954">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-108"> \ frac {1} {4} </script>  , then we can do this by throwing an asymmetrical coin, the eagles on which fall out with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-955"><span class="MJXp-mtext" id="MJXp-Span-956">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">c</span><span class="MJXp-mrow" id="MJXp-Span-961"><span class="MJXp-mn" id="MJXp-Span-962">1</span></span><span class="MJXp-mrow" id="MJXp-Span-963"><span class="MJXp-mn" id="MJXp-Span-964">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109"> \ frac {1} {4} </script>  .  If an eagle falls, then we stop in the current area.  Otherwise we move to the next area. <br><br>  If coins fall flat up, then we find ourselves in the second area and again ask if we should again select this area or continue moving.  You might think that for this we need to throw another coin with the probability of a falling eagle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-965"><span class="MJXp-mtext" id="MJXp-Span-966">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">c</span><span class="MJXp-mrow" id="MJXp-Span-971"><span class="MJXp-mn" id="MJXp-Span-972">1</span></span><span class="MJXp-mrow" id="MJXp-Span-973"><span class="MJXp-mn" id="MJXp-Span-974">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110"> \ frac {1} {4} </script>  but in fact this is not true!  To see a flaw in this reasoning, we have to go to an extreme situation - if in each area we throw a coin, on which an eagle falls, with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-975"><span class="MJXp-mtext" id="MJXp-Span-976">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">c</span><span class="MJXp-mrow" id="MJXp-Span-981"><span class="MJXp-mn" id="MJXp-Span-982">1</span></span><span class="MJXp-mrow" id="MJXp-Span-983"><span class="MJXp-mn" id="MJXp-Span-984">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111"> \ frac {1} {4} </script>  , that is, there is a small probability that in each area the coin will fall out of the tail, that is, we will have to abandon all areas.  When moving through the regions, we somehow need to continue to increase the likelihood of an eagle falling on a coin.  In an extreme situation, if we are in the last area, then the coin must have an eagle with a probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-985"><span class="MJXp-mn" id="MJXp-Span-986">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112"> 1 </script>  because if we rejected all previous areas, then the correct solution would be to stop at the last area. <br><br>  In order to determine the probability with which our asymmetrical coin must eject an eagle after the first region is skipped, we need to note that after the first region skips, there are only three of them left.  As we roll honest bone, we need each of these three areas to be selected with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-987"><span class="MJXp-mtext" id="MJXp-Span-988">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">c</span><span class="MJXp-mrow" id="MJXp-Span-993"><span class="MJXp-mn" id="MJXp-Span-994">1</span></span><span class="MJXp-mrow" id="MJXp-Span-995"><span class="MJXp-mn" id="MJXp-Span-996">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113"> \ frac {1} {3} </script>  .  Therefore, it seems intuitively that we should have a second bone, on which an eagle falls on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-mtext" id="MJXp-Span-998">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">c</span><span class="MJXp-mrow" id="MJXp-Span-1003"><span class="MJXp-mn" id="MJXp-Span-1004">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1005"><span class="MJXp-mn" id="MJXp-Span-1006">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114"> \ frac {1} {3} </script>  .  Using similar reasoning, it can be understood that when a tails out in the third region in the third region, the coin should fall out with an eagle with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1007"><span class="MJXp-mtext" id="MJXp-Span-1008">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">c</span><span class="MJXp-mrow" id="MJXp-Span-1013"><span class="MJXp-mn" id="MJXp-Span-1014">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1015"><span class="MJXp-mn" id="MJXp-Span-1016">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115"> \ frac {1} {2} </script>  , and in the latter area - with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1017"><span class="MJXp-mn" id="MJXp-Span-1018">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116"> 1 </script>  . <br><br>  Such an intuitive understanding leads us to the following algorithm.  Note that we <b>did not</b> discuss the correctness or error of this algorithm;  Soon we will do it. <br><br><blockquote><h4>  Algorithm: simulation of honest bone using asymmetric coins </h4><br><ol><li>  For <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">i</span><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1022">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117"> i = 0 </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">n</span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1026">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118"> n - 1 </script>  : <br><ol><li>  Throw asymmetrical coin with the probability of ejection <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1027"><span class="MJXp-mtext" id="MJXp-Span-1028">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">c</span><span class="MJXp-mrow" id="MJXp-Span-1033"><span class="MJXp-mn" id="MJXp-Span-1034">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">n</span><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119"> \ frac {1} {n - i} </script>  . </li><li>  If the eagle falls, then return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120"> i </script>  . </li></ol></li></ol></blockquote><br>  This algorithm is simple and in the worst case it is executed in time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">O</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">n</span><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121"> O (n) </script>  .  But how do we check if it is correct?  To find out, we need the following theorem: <br><br><blockquote>  <b>Theorem: the</b> above algorithm returns the side <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122"> i </script>  with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mtext" id="MJXp-Span-1049">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">c</span><span class="MJXp-mrow" id="MJXp-Span-1054"><span class="MJXp-mn" id="MJXp-Span-1055">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123"> \ frac {1} {n} </script>  for any selected <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124"> i </script>  . <br><br>  <b>Proof:</b> consider any constant <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">n</span><span class="MJXp-mtext" id="MJXp-Span-1062">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">e</span><span class="MJXp-mn" id="MJXp-Span-1065">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125"> n \ ge 0 </script>  .  We prove by strong induction that each of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126"> n </script>  faces has a probability of choice <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1068"><span class="MJXp-mtext" id="MJXp-Span-1069">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">c</span><span class="MJXp-mrow" id="MJXp-Span-1074"><span class="MJXp-mn" id="MJXp-Span-1075">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-127"> \ frac {1} {n} </script>  . <br><br>  For our example, we show that the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mn" id="MJXp-Span-1079">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128"> 0 </script>  bones have a chance of choosing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mtext" id="MJXp-Span-1081">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">c</span><span class="MJXp-mrow" id="MJXp-Span-1086"><span class="MJXp-mn" id="MJXp-Span-1087">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-129"> \ frac {1} {n} </script>  .  But it directly follows from the algorithm itself - we choose the face 0, if on an asymmetric coin with the probability of falling out of an eagle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1090"><span class="MJXp-mtext" id="MJXp-Span-1091">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">c</span><span class="MJXp-mrow" id="MJXp-Span-1096"><span class="MJXp-mn" id="MJXp-Span-1097">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130"> \ frac {1} {n} </script>  an eagle falls, that is, we chose it with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1100"><span class="MJXp-mtext" id="MJXp-Span-1101">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">c</span><span class="MJXp-mrow" id="MJXp-Span-1106"><span class="MJXp-mn" id="MJXp-Span-1107">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131"> \ frac {1} {n} </script>  . <br><br>  For the induction phase, assume for the faces <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1110"><span class="MJXp-mn" id="MJXp-Span-1111">0</span><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1113">1</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1115">2</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">k</span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1123">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132"> 0, 1, 2, ..., k - 1 </script>  that these edges are chosen with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1124"><span class="MJXp-mtext" id="MJXp-Span-1125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">c</span><span class="MJXp-mrow" id="MJXp-Span-1130"><span class="MJXp-mn" id="MJXp-Span-1131">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133"> \ frac {1} {n} </script>  and consider the probability of choosing a face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-134"> k </script>  .  The brink <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-135"> k </script>  will be selected if and only if <b>not</b> selected first <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136"> k </script>  faces, and on the coin with the probability of falling eagle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-mtext" id="MJXp-Span-1141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">c</span><span class="MJXp-mrow" id="MJXp-Span-1146"><span class="MJXp-mn" id="MJXp-Span-1147">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">n</span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137"> \ frac {1} {n - k} </script>  fell eagle.  Since each of the first <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138"> k </script>  faces has a probability of choice <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1154"><span class="MJXp-mtext" id="MJXp-Span-1155">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">c</span><span class="MJXp-mrow" id="MJXp-Span-1160"><span class="MJXp-mn" id="MJXp-Span-1161">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-139"> \ frac {1} {n} </script>  , and since only one face is selected, the probability of choosing one of the first faces <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-140"> k </script>  set as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-mtext" id="MJXp-Span-1167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">c</span><span class="MJXp-mrow" id="MJXp-Span-1172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">k</span></span><span class="MJXp-mrow" id="MJXp-Span-1174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141"> \ frac {k} {n} </script>  .  This means that the probability that the algorithm does not choose one of the first <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-142"> k </script>  faces equals <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1178"><span class="MJXp-mn" id="MJXp-Span-1179">1</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">c</span><span class="MJXp-mrow" id="MJXp-Span-1186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">k</span></span><span class="MJXp-mrow" id="MJXp-Span-1188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">n</span></span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1191">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">c</span><span class="MJXp-mrow" id="MJXp-Span-1196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">n</span></span><span class="MJXp-mrow" id="MJXp-Span-1198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">n</span></span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">c</span><span class="MJXp-mrow" id="MJXp-Span-1206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">k</span></span><span class="MJXp-mrow" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">n</span></span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">c</span><span class="MJXp-mrow" id="MJXp-Span-1216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">n</span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">k</span></span><span class="MJXp-mrow" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143"> 1 - \ frac {k} {n} = \ frac {n} {n} - \ frac {k} {n} = \ frac {n - k} {n} </script>  .  That is, the probability of choosing a face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144"> k </script>  set as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1224"><span class="MJXp-mtext" id="MJXp-Span-1225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">c</span><span class="MJXp-mrow" id="MJXp-Span-1230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">n</span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">k</span></span><span class="MJXp-mrow" id="MJXp-Span-1234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">c</span><span class="MJXp-mrow" id="MJXp-Span-1241"><span class="MJXp-mn" id="MJXp-Span-1242">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">n</span><span class="MJXp-mo" id="MJXp-Span-1245" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">k</span></span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">c</span><span class="MJXp-mrow" id="MJXp-Span-1253"><span class="MJXp-mn" id="MJXp-Span-1254">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145"> \ frac {n - k} {n} \ frac {1} {n - k} = \ frac {1} {n} </script>  what is required to show.  Thus, each face of the bone is selected evenly and randomly. </blockquote><br>  Of course, the algorithm is rather inefficient - with the help of the first technique, we can simulate a throw of an honest bone in time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">O</span><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1260">1</span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146"> O (1) </script>  !  But this algorithm can be used as a stepping stone to a fairly efficient algorithm for simulating a cheat bone using asymmetric coins. <br><br><h2>  Simulation of the cheat bone using asymmetric coins </h2><br>  The above algorithm is interesting because it gives us a simple framework for simulating a bone using a set of coins.  We start by throwing a coin to determine whether to choose the first face of the dice or move to the remaining ones.  In this process, we need to carefully handle the rescaling of the remaining probabilities. <br><br>  Let's see how this technique can be used to simulate the throw of a cheat bone.  Let's use our example with probabilities. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-mtext" id="MJXp-Span-1263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">c</span><span class="MJXp-mrow" id="MJXp-Span-1268"><span class="MJXp-mn" id="MJXp-Span-1269">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1270"><span class="MJXp-mn" id="MJXp-Span-1271">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147"> \ frac {1} {2} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1272"><span class="MJXp-mtext" id="MJXp-Span-1273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">c</span><span class="MJXp-mrow" id="MJXp-Span-1278"><span class="MJXp-mn" id="MJXp-Span-1279">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1280"><span class="MJXp-mn" id="MJXp-Span-1281">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148"> \ frac {1} {3} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1282"><span class="MJXp-mtext" id="MJXp-Span-1283">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">c</span><span class="MJXp-mrow" id="MJXp-Span-1288"><span class="MJXp-mn" id="MJXp-Span-1289">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1290"><span class="MJXp-mn" id="MJXp-Span-1291">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149"> \ frac {1} {12} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mtext" id="MJXp-Span-1293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">c</span><span class="MJXp-mrow" id="MJXp-Span-1298"><span class="MJXp-mn" id="MJXp-Span-1299">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1300"><span class="MJXp-mn" id="MJXp-Span-1301">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-150"> \ frac {1} {12} </script>  .  He, if you do not remember, divides the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1302"><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1304">0</span><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1306">1</span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-151"> [0, 1) </script>  in the following way: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/765/3b8/0bb/7653b80bb6acb83fc99a9a0bdc470e9c.png"></div><br>  Now let's think about how you can simulate such a cheat bone using asymmetric coins.  We can start by throwing a coin with the probability of a falling eagle. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mtext" id="MJXp-Span-1309">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">c</span><span class="MJXp-mrow" id="MJXp-Span-1314"><span class="MJXp-mn" id="MJXp-Span-1315">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1316"><span class="MJXp-mn" id="MJXp-Span-1317">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152"> \ frac {1} {2} </script>  to determine whether we should return the verge 0. If an eagle falls on this coin, then great!  We are done.  Otherwise, we need to throw another coin to decide whether to choose the next facet.  As before, despite the fact that the next facet has the probability of choosing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1318"><span class="MJXp-mtext" id="MJXp-Span-1319">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">c</span><span class="MJXp-mrow" id="MJXp-Span-1324"><span class="MJXp-mn" id="MJXp-Span-1325">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1326"><span class="MJXp-mn" id="MJXp-Span-1327">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-153"> \ frac {1} {3} </script>  we do not want to throw a coin on which the eagle falls with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1328"><span class="MJXp-mtext" id="MJXp-Span-1329">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">c</span><span class="MJXp-mrow" id="MJXp-Span-1334"><span class="MJXp-mn" id="MJXp-Span-1335">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1336"><span class="MJXp-mn" id="MJXp-Span-1337">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-154"> \ frac {1} {3} </script>  because half of the ‚Äúmass‚Äù of probabilities was dropped when we did not choose the line with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1338"><span class="MJXp-mtext" id="MJXp-Span-1339">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">c</span><span class="MJXp-mrow" id="MJXp-Span-1344"><span class="MJXp-mn" id="MJXp-Span-1345">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1346"><span class="MJXp-mn" id="MJXp-Span-1347">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-155"> \ frac {1} {2} </script>  .  In fact, since half of the mass of probabilities has disappeared, then if we normalize the remaining probabilities anew, we will get updated probabilities: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1348"><span class="MJXp-mtext" id="MJXp-Span-1349">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">c</span><span class="MJXp-mrow" id="MJXp-Span-1354"><span class="MJXp-mn" id="MJXp-Span-1355">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1356"><span class="MJXp-mn" id="MJXp-Span-1357">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-156"> \ frac {2} {3} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1358"><span class="MJXp-mtext" id="MJXp-Span-1359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">c</span><span class="MJXp-mrow" id="MJXp-Span-1364"><span class="MJXp-mn" id="MJXp-Span-1365">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1366"><span class="MJXp-mn" id="MJXp-Span-1367">6</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157"> \ frac {1} {6} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1368"><span class="MJXp-mtext" id="MJXp-Span-1369">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">c</span><span class="MJXp-mrow" id="MJXp-Span-1374"><span class="MJXp-mn" id="MJXp-Span-1375">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1376"><span class="MJXp-mn" id="MJXp-Span-1377">6</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158"> \ frac {1} {6} </script>  .  Consequently, the second coin must be thrown with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1378"><span class="MJXp-mtext" id="MJXp-Span-1379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">c</span><span class="MJXp-mrow" id="MJXp-Span-1384"><span class="MJXp-mn" id="MJXp-Span-1385">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1386"><span class="MJXp-mn" id="MJXp-Span-1387">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-159"> \ frac {2} {3} </script>  .  If this coin also falls out of the tail, we will have to choose between the two sides. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1388"><span class="MJXp-mtext" id="MJXp-Span-1389">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">c</span><span class="MJXp-mrow" id="MJXp-Span-1394"><span class="MJXp-mn" id="MJXp-Span-1395">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1396"><span class="MJXp-mn" id="MJXp-Span-1397">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-160"> \ frac {1} {12} </script>  .  Since at this stage we will get rid of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1398"><span class="MJXp-mtext" id="MJXp-Span-1399">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">c</span><span class="MJXp-mrow" id="MJXp-Span-1404"><span class="MJXp-mn" id="MJXp-Span-1405">5</span></span><span class="MJXp-mrow" id="MJXp-Span-1406"><span class="MJXp-mn" id="MJXp-Span-1407">6</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-161"> \ frac {5} {6} </script>  probability masses, then we can normalize the probabilities of the sides <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1408"><span class="MJXp-mtext" id="MJXp-Span-1409">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">c</span><span class="MJXp-mrow" id="MJXp-Span-1414"><span class="MJXp-mn" id="MJXp-Span-1415">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1416"><span class="MJXp-mn" id="MJXp-Span-1417">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-162"> \ frac {1} {12} </script>  so that each had a chance <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mtext" id="MJXp-Span-1419">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">c</span><span class="MJXp-mrow" id="MJXp-Span-1424"><span class="MJXp-mn" id="MJXp-Span-1425">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1426"><span class="MJXp-mn" id="MJXp-Span-1427">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163"> \ frac {1} {2} </script>  the falling of the eagle, that is, the third coin will have the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1428"><span class="MJXp-mtext" id="MJXp-Span-1429">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">c</span><span class="MJXp-mrow" id="MJXp-Span-1434"><span class="MJXp-mn" id="MJXp-Span-1435">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1436"><span class="MJXp-mn" id="MJXp-Span-1437">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164"> \ frac {1} {2} </script>  .  The last coin, if it ever comes down to it, should throw out the eagle with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-mn" id="MJXp-Span-1439">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-165"> 1 </script>  since this is the latest area. <br><br>  To summarize, the probabilities of the coins will be as follows: <br><br><ol><li>  First shot: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-mtext" id="MJXp-Span-1441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">c</span><span class="MJXp-mrow" id="MJXp-Span-1446"><span class="MJXp-mn" id="MJXp-Span-1447">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1448"><span class="MJXp-mn" id="MJXp-Span-1449">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-166"> \ frac {1} {2} </script></li><li>  Second shot: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1450"><span class="MJXp-mtext" id="MJXp-Span-1451">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">c</span><span class="MJXp-mrow" id="MJXp-Span-1456"><span class="MJXp-mn" id="MJXp-Span-1457">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1458"><span class="MJXp-mn" id="MJXp-Span-1459">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167"> \ frac {2} {3} </script></li><li>  The third shot: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-mtext" id="MJXp-Span-1461">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">c</span><span class="MJXp-mrow" id="MJXp-Span-1466"><span class="MJXp-mn" id="MJXp-Span-1467">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1468"><span class="MJXp-mn" id="MJXp-Span-1469">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-168"> \ frac {1} {2} </script></li><li>  Fourth Shot: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1470"><span class="MJXp-mn" id="MJXp-Span-1471">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169"> 1 </script></li></ol><br>  It may be intuitively clear where these numbers come from, but in order to turn selection into an algorithm, we will have to create a formal construction of the choice of probabilities.  The idea will be as follows - at each stage we remember the rest of the mass of probabilities.  In the beginning, before the roll of the first coin, it is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1472"><span class="MJXp-mn" id="MJXp-Span-1473">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170"> 1 </script>  .  After throwing the first coin <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1474"><span class="MJXp-mn" id="MJXp-Span-1475">1</span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1479" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171"> 1 - p_0 </script>  .  After throwing the second coin <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1480"><span class="MJXp-mn" id="MJXp-Span-1481">1</span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1485" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1489" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172"> 1 - p_0 - p_1 </script>  .  More generally after the throw <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-173"> k </script>  the remaining mass of the probability is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1492"><span class="MJXp-mn" id="MJXp-Span-1493">1</span><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1495">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">u</span><span class="MJXp-msubsup" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">k</span><span class="MJXp-mo" id="MJXp-Span-1506">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1507">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">i</span><span class="MJXp-mo" id="MJXp-Span-1502">=</span><span class="MJXp-mn" id="MJXp-Span-1503">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1508"><span class="MJXp-msubsup" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1511" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174"> 1 - \ sum_ {i = 0} ^ {k - 1} {p_i} </script>  .  Every time we throw a coin to determine whether or not to choose a region <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175"> k </script>  , we as a result throw a coin, the probability of falling of an eagle on which is equal to the fraction of the remaining probability occupied by the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-msubsup" id="MJXp-Span-1515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1517" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176"> p_k </script>  what is given as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1518"><span class="MJXp-mtext" id="MJXp-Span-1519">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">c</span><span class="MJXp-mrow" id="MJXp-Span-1524"><span class="MJXp-msubsup" id="MJXp-Span-1525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1527" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1528"><span class="MJXp-mn" id="MJXp-Span-1529">1</span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1531">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">u</span><span class="MJXp-msubsup" id="MJXp-Span-1534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">k</span><span class="MJXp-mo" id="MJXp-Span-1542">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1543">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">i</span><span class="MJXp-mo" id="MJXp-Span-1538">=</span><span class="MJXp-mn" id="MJXp-Span-1539">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1544"><span class="MJXp-msubsup" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1547" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177"> \ frac {p_k} {1 - \ sum_ {i = 0} ^ {k - 1} {p_i}} </script>  .  This gives us the following algorithm for simulating a cheat bone with a set of asymmetric coins (we will prove its correctness and execution time just below): <br><br><blockquote><h4>  Algorithm: cheat bone from asymmetric coins </h4><br><ul><li>  <b>Initialization</b> : <br><ol><li>  Save probabilities <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1548"><span class="MJXp-msubsup" id="MJXp-Span-1549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1551" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-178"> p_i </script>  for future use. </li></ol></li><li>  <b>Generation</b> : <br>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">s</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1558">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-179"> mass = 1 </script><br>  For <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">i</span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1562">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180"> i = 0 </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">n</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1566">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-181"> n - 1 </script>  : <br><ol><li>  We throw an asymmetrical coin with the probability of a falling eagle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1567"><span class="MJXp-mtext" id="MJXp-Span-1568">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">c</span><span class="MJXp-mrow" id="MJXp-Span-1573"><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1576" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">s</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182"> \ frac {p_i} {mass} </script>  . </li><li>  If the eagle fell, then return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-183"> i </script>  . </li><li>  Otherwise, ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">s</span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">s</span><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1597" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-184"> mass = mass - p_i </script></li></ol></li></ul></blockquote><br>  From an intuitive point of view, this is logical, but is it true mathematically?  Fortunately, the answer is positive due to the generalization of the above proof: <br><br><blockquote>  <b>Theorem:</b> the algorithm shown above returns the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-185"> i </script>  with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1600"><span class="MJXp-msubsup" id="MJXp-Span-1601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1603" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-186"> p_i </script>  for any chosen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-187-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-187"> i </script>  . <br><br>  <b>Proof:</b> consider any constant <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">n</span><span class="MJXp-mtext" id="MJXp-Span-1608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">e</span><span class="MJXp-mn" id="MJXp-Span-1611">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-188-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-188"> n \ ge 0 </script>  .  With strong induction, we prove that each of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-189-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-189"> n </script>  faces has a probability of choice <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1614"><span class="MJXp-msubsup" id="MJXp-Span-1615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1617" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-190-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-190"> p_i </script>  . <br><br>  As a base case, we prove that the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1618"><span class="MJXp-mn" id="MJXp-Span-1619">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-191-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-191"> 0 </script>  bones have a chance of choosing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1620"><span class="MJXp-msubsup" id="MJXp-Span-1621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1623" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-192-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-192"> p_0 </script>  .  We choose the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1624"><span class="MJXp-mn" id="MJXp-Span-1625">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-193-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-193"> 0 </script>  , if at the roll of the very first coin we get an eagle, what happens with the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1626"><span class="MJXp-mfrac" id="MJXp-Span-1627" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1630" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">s</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-194-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-194">\frac{p_0}{mass}</script>  .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-195-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-195">mass</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1640"><span class="MJXp-mn" id="MJXp-Span-1641">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-196-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-196"> 1 </script> ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-mfrac" id="MJXp-Span-1643" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1646" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1647">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1651" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-197-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-197">\frac{p_0}{1} = p_0</script> ,    0    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1652"><span class="MJXp-msubsup" id="MJXp-Span-1653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1655" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-198-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-198">p_0</script> ,   . <br><br>    ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1656"><span class="MJXp-mn" id="MJXp-Span-1657">0</span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1659">1</span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1664" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">k</span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1667">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-199-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-199">0, 1, ..., k - 1</script>    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1668"><span class="MJXp-msubsup" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1671" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1675" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1679" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1683" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">k</span><span class="MJXp-mo" id="MJXp-Span-1685">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1686">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-200-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-200">p_0, p_1, ..., p_{k-1}</script>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-201-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-201"> k </script>  .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-202-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-202"> k </script>      ,  <b></b>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-203-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-203"> k </script> ,         <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1693"><span class="MJXp-mfrac" id="MJXp-Span-1694" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1697" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">s</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-204-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-204">\frac{p_k}{mass}</script>  .     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-205-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-205"> k </script>      ,      ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-206-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-206"> k </script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1706"><span class="MJXp-msubsup" id="MJXp-Span-1707"><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">k</span><span class="MJXp-mo" id="MJXp-Span-1715">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1716">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">i</span><span class="MJXp-mo" id="MJXp-Span-1711">=</span><span class="MJXp-mn" id="MJXp-Span-1712">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1717"><span class="MJXp-msubsup" id="MJXp-Span-1718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1720" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-207-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-207">\sum_{i = 0}^{k - 1}{p_i}</script>  .  ,         <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-208-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-208"> k </script>    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1723"><span class="MJXp-mn" id="MJXp-Span-1724">1</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1726"><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">k</span><span class="MJXp-mo" id="MJXp-Span-1734">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1735">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">i</span><span class="MJXp-mo" id="MJXp-Span-1730">=</span><span class="MJXp-mn" id="MJXp-Span-1731">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1736"><span class="MJXp-msubsup" id="MJXp-Span-1737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1739" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-209-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-209">1 - \sum_{i = 0}^{k - 1}{p_i}</script>  .  ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-210-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-210"> k </script>  ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1742"><span class="MJXp-mfrac" id="MJXp-Span-1743" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1746" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">s</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-211-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-211">\frac{p_k}{mass}</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-212-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-212"> k </script>        ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">s</span><span class="MJXp-mo" id="MJXp-Span-1758" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1759">1</span><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1761"><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">k</span><span class="MJXp-mo" id="MJXp-Span-1769">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1770">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">i</span><span class="MJXp-mo" id="MJXp-Span-1765">=</span><span class="MJXp-mn" id="MJXp-Span-1766">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1771"><span class="MJXp-msubsup" id="MJXp-Span-1772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1774" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-213-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-213">mass = 1 - \sum_{i = 0}^{k - 1}{p_i}</script>  .  ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-214-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-214"> k </script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1777"><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-1779"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1781"><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0.111em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mo" id="MJXp-Span-1789"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-1790"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1785"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1786"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1791"><span class="MJXp-msubsup" id="MJXp-Span-1792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1794" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1795" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1796" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1799" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1800"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1801"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1802"><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mo" id="MJXp-Span-1810"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-1811"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1806"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1807"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1812"><span class="MJXp-msubsup" id="MJXp-Span-1813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1815" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1817"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1819" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-215-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-215">(1 - \sum_{i = 0}^{k - 1}{p_i})\frac{p_k}{1 - \sum_{i = 0}^{k - 1}{p_i}} = p_k</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as required.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let's estimate the time complexity of this algorithm. </font><font style="vertical-align: inherit;">We know that the initialization time can be</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1820"><span class="MJXp-mi" id="MJXp-Span-1821"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-1823"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-216-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-216">\Theta(1)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> if we save a surface copy of the input probability array, but it may be</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1825"><span class="MJXp-mi" id="MJXp-Span-1826"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-217-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-217">\Theta(n)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> so that we can save our own version of the array (in case the calling function wants to change it later). The very generation of the result of throwing the dice may require at worst</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1830"><span class="MJXp-mi" id="MJXp-Span-1831"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-1832" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-1834" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-218-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-218">\Theta(n)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> throws, and only one throw at best.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, after thinking it becomes clear that the number of required coin tosses is strongly influenced by the incoming distribution. In the best case, we will have a probability distribution, in which the entire mass of probabilities is concentrated on the first face of the bone, and all other probabilities are zero. In this case, one throw of a coin is enough for us. In the worst case, the entire probability mass is concentrated at the very last face of the bone, and is zero on all other faces. In this case, we will have to throw to get the result.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-219-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-219"> n </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coins. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can clearly and mathematically characterize the expected number of coin flips in this algorithm. </font><font style="vertical-align: inherit;">Let's imagine a random variable</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-220-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-220"> X </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , denoting the number of coin flips for any execution of this algorithm for a particular distribution.</font></font> I.e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1839"><span class="MJXp-mrow" id="MJXp-Span-1840"><span class="MJXp-mi undefined" id="MJXp-Span-1841"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1845"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-221-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-221">\mathbb{P}[X = 1]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the probability that to complete the algorithm it is enough to throw one coin,</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1847"><span class="MJXp-mrow" id="MJXp-Span-1848"><span class="MJXp-mi undefined" id="MJXp-Span-1849"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1850" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1853"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1854" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-222-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-222">\mathbb{P}[X = 2]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the probability that the algorithm will throw two coins, etc. </font><font style="vertical-align: inherit;">In this case, the expected number of coin flips for our algorithm is determined by the</font></font><a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D0%25BE%25D0%25B6%25D0%25B8%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">expectation</font></font></a> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-223-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-223"> X </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , denoted as</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1857"><span class="MJXp-mrow" id="MJXp-Span-1858"><span class="MJXp-mi undefined" id="MJXp-Span-1859"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1860" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-224-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-224">\mathbb{E}[X]</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> By definition, we get that </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1863"><span class="MJXp-mrow" id="MJXp-Span-1864"><span class="MJXp-mi undefined" id="MJXp-Span-1865"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1866" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-1868" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] </font></font></span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-munderover" id="MJXp-Span-1870"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876" style="margin-right: 0px; margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ£</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1872" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1874"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1875"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1877"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ãÖ </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1880"><span class="MJXp-mi undefined" id="MJXp-Span-1881"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-225-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-225">\mathbb{E}[X] = \sum_{i = 1}^n{i \cdot \mathbb{P}[X = i]}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What is the meaning </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1887"><span class="MJXp-mrow" id="MJXp-Span-1888"><span class="MJXp-mi undefined" id="MJXp-Span-1889"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1894" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-226-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-226">\mathbb{P}[X = i]</script>  ?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The algorithm terminates after selecting a facet of a bone. </font><font style="vertical-align: inherit;">If he chooses a face</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1895"><span class="MJXp-mn" id="MJXp-Span-1896"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-227-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-227"> 0 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then throw one coin. </font><font style="vertical-align: inherit;">If he chooses a face</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-mn" id="MJXp-Span-1898"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-228-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-228"> 1 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then will throw two coins - one to understand that he does not want to choose the face</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1899"><span class="MJXp-mn" id="MJXp-Span-1900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-229-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-229"> 0 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , another to understand that he wants to choose the face</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1901"><span class="MJXp-mn" id="MJXp-Span-1902"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-230-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-230"> 1 </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If more generally, then if the algorithm chooses a face </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-231-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-231"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will throw</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mn" id="MJXp-Span-1908"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-232-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-232">i + 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coins:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-233-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-233"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coins to decide he doesn't want to pick previous ones</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1913" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-1914"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-234-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-234">i - 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> facet, and one to decide what face to choose</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-235-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-235"> i </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Combined with the fact that we know about choosing a face </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-236-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-236"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with probability</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1919"><span class="MJXp-msubsup" id="MJXp-Span-1920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1922" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-237-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-237">p_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it means that</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1923"><span class="MJXp-mrow" id="MJXp-Span-1924"><span class="MJXp-mi undefined" id="MJXp-Span-1925">E</span></span><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">X</span><span class="MJXp-mo" id="MJXp-Span-1928" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1929" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1930"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1931" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1932" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">i</span><span class="MJXp-mo" id="MJXp-Span-1934">=</span><span class="MJXp-mn" id="MJXp-Span-1935">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">i</span><span class="MJXp-mo" id="MJXp-Span-1939" style="margin-left: 0.267em; margin-right: 0.267em;">‚ãÖ</span><span class="MJXp-mrow" id="MJXp-Span-1940"><span class="MJXp-mi undefined" id="MJXp-Span-1941">P</span></span><span class="MJXp-mo" id="MJXp-Span-1942" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">X</span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">i</span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1948"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1950" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">i</span><span class="MJXp-mo" id="MJXp-Span-1952">=</span><span class="MJXp-mn" id="MJXp-Span-1953">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">i</span><span class="MJXp-mo" id="MJXp-Span-1957" style="margin-left: 0.267em; margin-right: 0.267em;">‚ãÖ</span><span class="MJXp-msubsup" id="MJXp-Span-1958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1960" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">i</span><span class="MJXp-mo" id="MJXp-Span-1962">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1963">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1964" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1965"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1966" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1967" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">i</span><span class="MJXp-mo" id="MJXp-Span-1969">=</span><span class="MJXp-mn" id="MJXp-Span-1970">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1972"><span class="MJXp-mo" id="MJXp-Span-1973" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1974" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">i</span><span class="MJXp-mo" id="MJXp-Span-1976" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1977">1</span><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1981" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">i</span><span class="MJXp-mo" id="MJXp-Span-1983">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1984">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1985" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1988" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">i</span><span class="MJXp-mo" id="MJXp-Span-1990">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1991">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1994"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1996" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">i</span><span class="MJXp-mo" id="MJXp-Span-1998">=</span><span class="MJXp-mn" id="MJXp-Span-1999">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2001"><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">i</span><span class="MJXp-mo" id="MJXp-Span-2005" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2006"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2010" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2012"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2013"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2014" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2015" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-munderover" id="MJXp-Span-2016"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022" style="margin-right: 0px; margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2017" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2018" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2020"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2021"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2023"><span class="MJXp-msubsup" id="MJXp-Span-2024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2026" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2028"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2029"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-238-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-238">\mathbb{E}[X] = \sum_{i = 1}^n{i \cdot \mathbb{P}[X = i]} = \sum_{i = 1}^n{i \cdot p_{i - 1}} = \sum_{i = 1}^n{((i - 1) p_{i - 1} + p_{i - 1})} = \sum_{i = 1}^n{((i - 1) p_{i - 1})} + \sum_{i = 1}^n{p_{i - 1}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Note that in the last simplification, the first term is equivalent to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2030"><span class="MJXp-msubsup" id="MJXp-Span-2031"><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0.111em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2039"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2040"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2035"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2036"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2043" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ãÖ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2046" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-239-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-239">\sum_{i = 0}^{n-1}{i \cdot p_i}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is equivalent</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2047"><span class="MJXp-mrow" id="MJXp-Span-2048"><span class="MJXp-mi undefined" id="MJXp-Span-2049"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2050" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-240-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-240">\mathbb{E}[p]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the expected outcome of a dice roll! </font><font style="vertical-align: inherit;">Moreover, the second term is</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2053"><span class="MJXp-mn" id="MJXp-Span-2054"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-241-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-241"> 1 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , since this is the sum of all probabilities. </font><font style="vertical-align: inherit;">It means that</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2055"><span class="MJXp-mrow" id="MJXp-Span-2056"><span class="MJXp-mi undefined" id="MJXp-Span-2057"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2058" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mo" id="MJXp-Span-2060" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] </font></font></span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2062"><span class="MJXp-mi undefined" id="MJXp-Span-2063"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2064" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> [ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] </font></font></span><span class="MJXp-mo" id="MJXp-Span-2067" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2068"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-242-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-242">\mathbb{E}[X] = \mathbb{E}[p] + 1</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> That is, the expected number of throws of coins is equal to one plus the expected expectation of a dice roll! </font></font><br><br><table><tbody><tr><th>  Algorithm </th><th colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Initialization time </font></font></th><th colspan="2">  Generation time </th><th colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Busy memory </font></font></th></tr><tr><th></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The best </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Worst </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The best </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Worst </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The best </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Worst </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Honest bone cheat bone </font></font></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2069"><span class="MJXp-mi" id="MJXp-Span-2070"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2071" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2073" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-243-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-243">\Theta(n)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2076" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2077"><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0.111em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àè </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2081"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2082"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2084"><span class="MJXp-msubsup" id="MJXp-Span-2085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2087" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-244-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-244">O(\prod_{i = 0}^n{d_i})</script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2089"><span class="MJXp-mi" id="MJXp-Span-2090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2091" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2092"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2093" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-245-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-245">\Theta(1)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2094"><span class="MJXp-mi" id="MJXp-Span-2095"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2098" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-246-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-246">\Theta(n)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2102"><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0.111em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àè </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2108"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2106"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2107"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2109"><span class="MJXp-msubsup" id="MJXp-Span-2110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2112" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2113" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-247-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-247">O(\prod_{i = 0}^n{d_i})</script></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shuler bone from asymmetrical coins </font></font></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2114"><span class="MJXp-mi" id="MJXp-Span-2115"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2116" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2118" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-248-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-248">\Theta(n)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2119"><span class="MJXp-mi" id="MJXp-Span-2120"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2121" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2122"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2123" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-249-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-249">\Theta(1)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2124"><span class="MJXp-mi" id="MJXp-Span-2125"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2126" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2128" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-250-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-250">\Theta(n)</script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2129"><span class="MJXp-mi" id="MJXp-Span-2130"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2131" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2133" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-251-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-251">\Theta(n)</script></td></tr></tbody></table><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Generalization of asymmetrical coins: simulation of a cheat bone </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the example shown above, we were able to effectively simulate an asymmetric coin, since we only had to take into account one split point. How can we effectively generalize this idea to a cheat bone, in which the number of faces can be arbitrary? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, an asymmetric coin is a cheat bone, with only two faces. Consequently, we can perceive an asymmetric coin simply as a special case of a more general problem that we want to solve. In solving the problem of an asymmetric coin, we divide the interval</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2134"><span class="MJXp-mo" id="MJXp-Span-2135" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2136"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2138"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-252-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-252">[0, 1)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> into two areas - one for the eagle, the second for tails - and then to find the area we use the fact that there is only one splitting point. </font><font style="vertical-align: inherit;">If we have an n-sided bone, then there will be more areas, and therefore several dividing points. </font><font style="vertical-align: inherit;">Suppose, for example, that we have a seven-sided bone with probabilities</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2140"><span class="MJXp-mfrac" id="MJXp-Span-2141" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2142"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2143"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">four</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-253-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-253">\frac{1}{4}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2144"><span class="MJXp-mfrac" id="MJXp-Span-2145" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2146"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2147"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">five</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-254-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-254">\frac{1}{5}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2148"><span class="MJXp-mfrac" id="MJXp-Span-2149" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2150"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2151"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eight</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-255-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-255">\frac{1}{8}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2152"><span class="MJXp-mfrac" id="MJXp-Span-2153" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2154"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2155"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eight</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-256-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-256">\frac{1}{8}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2156"><span class="MJXp-mfrac" id="MJXp-Span-2157" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2158"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2159"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ten</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-257-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-257">\frac{1}{10}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2160"><span class="MJXp-mfrac" id="MJXp-Span-2161" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2162"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2163"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ten</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-258-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-258">\frac{1}{10}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2164"><span class="MJXp-mfrac" id="MJXp-Span-2165" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2166"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2167"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ten</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-259-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-259">\frac{1}{10}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If we want to divide the interval </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2168"><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2170"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2171" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2172"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2173" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-260-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-260">[0, 1)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> into seven parts, then do it as follows:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d46/f44/493/d46f444936037dc4093e2f2405400fb8.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notice where these areas are located. </font><font style="vertical-align: inherit;">The first area starts with</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2174"><span class="MJXp-mn" id="MJXp-Span-2175"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-261-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-261"> 0 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and ends</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2176"><span class="MJXp-mfrac" id="MJXp-Span-2177" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2178"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2179"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">four</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-262-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-262">\frac{1}{4}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The second area begins with </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2180"><span class="MJXp-mfrac" id="MJXp-Span-2181" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2182"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2183"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-263-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-263">\frac{1}{4}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and ends at</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2184"><span class="MJXp-mfrac" id="MJXp-Span-2185" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2186"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2187"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2188" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-2189" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2190"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2191"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2192" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-2193" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2194"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2195"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-264-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-264">\frac{1}{4} + \frac{1}{5} = \frac{9}{20}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> More generally, if the probabilities are equal </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2196"><span class="MJXp-msubsup" id="MJXp-Span-2197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2199" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2200" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2203" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2204" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mo" id="MJXp-Span-2205" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-2206" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-2207" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-mo" id="MJXp-Span-2208" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2211" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2213"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2214"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-265-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-265">p_0, p_1, ..., p_{n - 1}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then the regions will be intervals</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2215"><span class="MJXp-mo" id="MJXp-Span-2216" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2217"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2218" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2221" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2222" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-266-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-266">[0, p_0)</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2223"><span class="MJXp-mo" id="MJXp-Span-2224" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2227" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2231" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2235" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2236" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-267-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-267">[p_0, p_0 + p_1)</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2237"><span class="MJXp-mo" id="MJXp-Span-2238" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2241" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2245" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2246" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2249" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2250" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2253" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2257" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2258" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-268-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-268">[p_0 + p_1, p_0 + p_1 + p_2)</script>  etc.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> That is the area </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i is</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-269-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-269"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limited by the interval</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2261"><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-munderover" id="MJXp-Span-2263"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2269" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2271"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2272"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2265" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j </font></font></span><span class="MJXp-mo" id="MJXp-Span-2267"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2268"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2273"><span class="MJXp-msubsup" id="MJXp-Span-2274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2276" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2277" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-munderover" id="MJXp-Span-2278"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2284" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2280" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j </font></font></span><span class="MJXp-mo" id="MJXp-Span-2282"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2283"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2286"><span class="MJXp-msubsup" id="MJXp-Span-2287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2289" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2290" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-270-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-270">[\sum_{j = 0}^{i - 1}{p_j}, \sum_{j = 0}^{i}{p_j})</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Notice that the difference between these two values ‚Äã‚Äãis </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2291"><span class="MJXp-msubsup" id="MJXp-Span-2292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2294" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-271-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-271">p_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, the total area of ‚Äã‚Äãthe region is equal to</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2295"><span class="MJXp-msubsup" id="MJXp-Span-2296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2298" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-272-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-272">p_i</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as required. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we know where the regions are. </font><font style="vertical-align: inherit;">If we want to choose a uniformly distributed random value</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-273-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-273"> x </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the interval</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2301"><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2303"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2305"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-274-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-274">[0, 1)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then how do we determine at what interval it falls? </font><font style="vertical-align: inherit;">If we use our asymmetric coin algorithm as a starting point, the idea will be as follows: starting from the end point of the first area, constantly move upwards through all areas until we find the end point whose value is greater than</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2308"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-275-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-275"> x </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If we do this, we will find the first area containing the point </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-276-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-276"> x </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which means our value. </font><font style="vertical-align: inherit;">For example, if we selected a random value</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-2313" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-2314" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2315"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">27</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2316"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-277-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-277">x = \frac{27}{40}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then perform the following search:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/874/19f/7d1/87419f7d15b770f8a4598ed8ae471dd7.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From what we can conclude that the edge 3 fell on the bone indexed from scratch. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Such a linear scanning algorithm will give us an algorithm of time</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2319" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2321" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-278-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-278"> O (n) </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to find the discarded face of the bone. </font><font style="vertical-align: inherit;">However, we can significantly improve its execution time using the following observation: a series of endpoints of regions form an increasing sequence (since we always add more and more probabilities, none of which can be less than zero). </font><font style="vertical-align: inherit;">Therefore, we want to answer the following question: having an increasing sequence of values ‚Äã‚Äãand a certain check point, we need to find the first value in the interval that is strictly greater than the check point. </font><font style="vertical-align: inherit;">This is the perfect moment to use</font></font><a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B2%25D0%25BE%25D0%25B8%25D1%2587%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BF%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">binary search</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">! </font><font style="vertical-align: inherit;">For example, here's a binary search on the above array to find the area to which</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-2324" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-2325" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2326"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2327"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-279-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-279">x = \frac{39}{40}</script>  : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc6/ce2/be3/fc6ce2be378ebe3da4bb9c92d30b3b3c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This gives us an algorithm with time. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2328"><span class="MJXp-mi" id="MJXp-Span-2329"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi" id="MJXp-Span-2331"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-2334" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2334" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-280-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-280">\Theta(\log n)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to bind a uniformly distributed random value in the interval</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2335"><span class="MJXp-mo" id="MJXp-Span-2336" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2337"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2338" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2339"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-281-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-281">[0, 1)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the verge of an abandoned bone. </font><font style="vertical-align: inherit;">Moreover, there is enough preprocessing time to build the endpoint table.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2341"><span class="MJXp-mi" id="MJXp-Span-2342"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œò </font></font></span><span class="MJXp-mo" id="MJXp-Span-2343" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2345" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-282-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-282">\Theta(n)</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we simply calculate partial sums of probabilities as we move up. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This algorithm is sometimes called the </font></font><a href="http://en.wikipedia.org/wiki/Fitness_proportionate_selection"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">roulette wheel selection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algorithm </font><font style="vertical-align: inherit;">, because it selects a random area using a roulette wheel-like technique ‚Äî throwing the ball at intervals and observing where it stops. </font><font style="vertical-align: inherit;">In pseudocode, the algorithm looks like this:</font></font><br><br><blockquote><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algorithm: selection by the roulette wheel </font></font></h4><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Initialization</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Select the array </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-283-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-283"> A </script>  size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-284-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-284"> n </script></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ask </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2353"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] </font></font></span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2358" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-285-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-285">A[0] = p_0</script>  . </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For each probability </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-286-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-286"> i </script>  from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2361"><span class="MJXp-mn" id="MJXp-Span-2362"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-287-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-287"> 1 </script>  before <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2366"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-288-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-288">n - 1</script>  : <br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ask </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2368"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-2369" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] </font></font></span><span class="MJXp-mo" id="MJXp-Span-2372" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-2374" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2376" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2377"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2378" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] </font></font></span><span class="MJXp-mo" id="MJXp-Span-2379" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2382" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-289-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-289">A[i] = A[i - 1] + p_i</script></li></ol></li></ol><br></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We generate a uniformly distributed random value. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-290-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-290"> x </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the interval</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2385"><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2387"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2388" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2389"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-291-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-291">[0, 1)</script></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Using binary search we find the index </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i of the</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-292-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-292"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> smallest element</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-293-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-293"> A </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> which is less</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-294-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-294"> x </script>  . </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Return </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-295-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-295"> i </script>  . </li></ol></li></ul></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The comparison between this algorithm and the one mentioned earlier looks quite impressive: </font></font><br><br><table><tbody><tr><th>  Algorithm </th><th colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Initialization time </font></font></th><th colspan="2">  Generation time </th><th colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Busy memory </font></font></th></tr><tr><th></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The best </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Worst </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The best </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Worst </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The best </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Worst </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Honest bone cheat bone </font></font></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2399"><span class="MJXp-mi" id="MJXp-Span-2400">Œò</span><span class="MJXp-mo" id="MJXp-Span-2401" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2402">n</span><span class="MJXp-mo" id="MJXp-Span-2403" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-296-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-296">\Theta(n)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2405">O</span><span class="MJXp-mo" id="MJXp-Span-2406" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2407"><span class="MJXp-mo" id="MJXp-Span-2408" style="margin-left: 0.111em; margin-right: 0.05em;">‚àè</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">i</span><span class="MJXp-mo" id="MJXp-Span-2411">=</span><span class="MJXp-mn" id="MJXp-Span-2412">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2414"><span class="MJXp-msubsup" id="MJXp-Span-2415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2417" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2418" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-297-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-297">O(\prod_{i = 0}^n{d_i})</script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2419"><span class="MJXp-mi" id="MJXp-Span-2420">Œò</span><span class="MJXp-mo" id="MJXp-Span-2421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2422">1</span><span class="MJXp-mo" id="MJXp-Span-2423" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-298-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-298">\Theta(1)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2424"><span class="MJXp-mi" id="MJXp-Span-2425">Œò</span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2427">n</span><span class="MJXp-mo" id="MJXp-Span-2428" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-299-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-299">\Theta(n)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430">O</span><span class="MJXp-mo" id="MJXp-Span-2431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2432"><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0.111em; margin-right: 0.05em;">‚àè</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">i</span><span class="MJXp-mo" id="MJXp-Span-2436">=</span><span class="MJXp-mn" id="MJXp-Span-2437">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2439"><span class="MJXp-msubsup" id="MJXp-Span-2440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2442" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-300-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-300">O(\prod_{i = 0}^n{d_i})</script></td></tr><tr><td>      </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2444"><span class="MJXp-mi" id="MJXp-Span-2445">Œò</span><span class="MJXp-mo" id="MJXp-Span-2446" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2447">n</span><span class="MJXp-mo" id="MJXp-Span-2448" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-301-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-301">\Theta(n)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2449"><span class="MJXp-mi" id="MJXp-Span-2450">Œò</span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2452">1</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-302-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-302">\Theta(1)</script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2454"><span class="MJXp-mi" id="MJXp-Span-2455">Œò</span><span class="MJXp-mo" id="MJXp-Span-2456" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457">n</span><span class="MJXp-mo" id="MJXp-Span-2458" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-303-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-303">\Theta(n)</script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2459"><span class="MJXp-mi" id="MJXp-Span-2460">Œò</span><span class="MJXp-mo" id="MJXp-Span-2461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">n</span><span class="MJXp-mo" id="MJXp-Span-2463" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-304-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-304">\Theta(n)</script></td></tr><tr><td>    </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2464"><span class="MJXp-mi" id="MJXp-Span-2465">Œò</span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467">n</span><span class="MJXp-mo" id="MJXp-Span-2468" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-305-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-305">\Theta(n)</script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2469"><span class="MJXp-mi" id="MJXp-Span-2470">Œò</span><span class="MJXp-mo" id="MJXp-Span-2471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-2472">log</span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474">n</span><span class="MJXp-mo" id="MJXp-Span-2475" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-306-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-306">\Theta(\log n)</script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2476"><span class="MJXp-mi" id="MJXp-Span-2477">Œò</span><span class="MJXp-mo" id="MJXp-Span-2478" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2479">n</span><span class="MJXp-mo" id="MJXp-Span-2480" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-307-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-307">\Theta(n)</script></td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviously, now we have a much better algorithm than the original one. </font><font style="vertical-align: inherit;">Discretization of probabilities only seemed promising at first, but this new approach based on continuous value and binary search looks much better. </font><font style="vertical-align: inherit;">However, it is still possible to improve these indicators through the clever use of a set of hybrid techniques that we will discuss below. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An interesting detail of this algorithm is that although the use of a binary search ensures the worst time for generating random numbers</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2483" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi" id="MJXp-Span-2484"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-2487" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mo" id="MJXp-Span-2485" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2487" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-308-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-308">O(\log n)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it also does not allow a faster search; </font><font style="vertical-align: inherit;">that is, the generation time will also be equal</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2488"><span class="MJXp-mi" id="MJXp-Span-2489"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ© </font></font></span><span class="MJXp-mo" id="MJXp-Span-2490" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi" id="MJXp-Span-2491"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-2494" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mo" id="MJXp-Span-2492" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2494" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-309-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-309">\Omega(\log n)</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Can it be improved? </font><font style="vertical-align: inherit;">It turns out that you can. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose we move from a binary search through a list of accumulated probabilities to using a </font></font><a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B2%25D0%25BE%25D0%25B8%25D1%2587%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE_%25D0%25BF%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA%25D0%25B0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">binary search tree</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">For example, having the above set of probabilities, we can build the following binary search tree for their accumulated distribution:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/152/873/77b/15287377bf2c7714a1c0bfcc07cdc789.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now, if we want to simulate a dice roll, we can generate a uniformly distributed number in the interval. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2495"><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2497"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2499"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-310-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-310">[0, 1)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and then see in what interval it lies in this binary search tree (BST). </font><font style="vertical-align: inherit;">Since this is a balanced binary search tree, the best search time is</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2504"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2505" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-311-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-311">O(1)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the worst -</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2507"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2508" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi" id="MJXp-Span-2509"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">log </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-312-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-312">O(\log n)</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, if we assume that we know more about the probability distribution, then we can do much better. </font><font style="vertical-align: inherit;">For example, suppose our probabilities are equal</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2513"><span class="MJXp-mfrac" id="MJXp-Span-2514" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2515"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2516"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-313-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-313">\frac{99}{100}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2517"><span class="MJXp-mfrac" id="MJXp-Span-2518" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2519"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2520"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">600</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-314-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-314">\frac{1}{600}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2521"><span class="MJXp-mfrac" id="MJXp-Span-2522" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2523"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2524"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">600</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-315-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-315">\frac{1}{600}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2525"><span class="MJXp-mfrac" id="MJXp-Span-2526" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2527"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2528"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">600</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-316-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-316">\frac{1}{600}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2529"><span class="MJXp-mfrac" id="MJXp-Span-2530" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2531"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2532"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">600</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-317-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-317">\frac{1}{600}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2533"><span class="MJXp-mfrac" id="MJXp-Span-2534" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2535"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2536"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">600</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-318-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-318">\frac{1}{600}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2537"><span class="MJXp-mfrac" id="MJXp-Span-2538" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2539"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2540"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">600</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-319-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-319">\frac{1}{600}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That is, the probability distribution is extremely skewed, and almost the entire mass of probabilities is concentrated on one face. </font><font style="vertical-align: inherit;">We can build a balanced BST for these probabilities:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4fc/063/096/4fc0630960c0a18ad6c887a944fd65d0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although this binary search tree is perfectly balanced, it is not very suitable for our tasks. </font><font style="vertical-align: inherit;">Since we know that in 99 out of 100 cases a random value will be in the range</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2541"><span class="MJXp-mo" id="MJXp-Span-2542" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2543"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-2545" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2546"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2547"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2548" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-320-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-320">[0, \frac{99}{100})</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then there is no point in keeping the node for this interval where it is located now. </font><font style="vertical-align: inherit;">In fact, this will mean that almost all the time we will be performing two unnecessary comparisons with the blue and yellow areas. </font><font style="vertical-align: inherit;">Since, with a very high probability, we should first check the largest interval, it would be logical to unbalance the tree so as to make the average case much better at the expense of the rest. </font><font style="vertical-align: inherit;">This is shown here:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b36/88a/fc9/b3688afc9d7cc1fa79c63b1b654121f0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we are likely to complete the search, immediately finding the desired area after the first attempt. </font><font style="vertical-align: inherit;">In the very unlikely event that the desired area is in the remaining</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2549"><span class="MJXp-mo" id="MJXp-Span-2550" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-2551" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2552"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2553"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2554" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mn" id="MJXp-Span-2555"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span><span class="MJXp-mo" id="MJXp-Span-2556" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-321-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-321">(\frac{99}{100}, 1]</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we will quietly descend to the end of the tree, which is actually well balanced. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In a generalized form, we want to solve the following problem:</font></font><br><br><blockquote> Given a given set of probabilities, find the binary search tree of these probabilities, which minimizes the expected search time. </blockquote><br>  Fortunately, this problem is very well studied and is called the <a href="http://en.wikipedia.org/wiki/Binary_search_tree">optimal binary search tree problem</a> .  There are many algorithms to solve this problem;  It is known that the exact solution can be found in time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2559" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2561" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2562" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2563" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-322-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-322"> O (n ^ 2) </script>  using <a href="http://en.wikipedia.org/wiki/Dynamic_programming">dynamic programming</a> , and that there are good linear time algorithms that can find approximate solutions.  In addition, the <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D1%2588%25D0%25B8%25D1%2580%25D1%258F%25D1%258E%25D1%2589%25D0%25B5%25D0%25B5%25D1%2581%25D1%258F_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">splay tree</a> data structure <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D1%2588%25D0%25B8%25D1%2580%25D1%258F%25D1%258E%25D1%2589%25D0%25B5%25D0%25B5%25D1%2581%25D1%258F_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">(expanding tree)</a> (self-balancing binary search <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D1%2588%25D0%25B8%25D1%2580%25D1%258F%25D1%258E%25D1%2589%25D0%25B5%25D0%25B5%25D1%2581%25D1%258F_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">tree)</a> can be used to obtain a constant multiplier for the optimal solution. <br><br>  It is interesting that the best case behavior of such optimized binary search trees occurs when probability distributions are extremely skewed, since we can simply move nodes containing the vast majority of probabilities to the root of the tree, and the worst case is when the distribution is balanced, because then the tree should be wide and shallow.  This is contrary to the behavior of the previous algorithm, in which honest was used to simulate the cheat bone! <br><br>  In the best case, we have a cheat bone, in which one face always falls out (that is, it has probability 1, and all other faces have probability 0).  This is an extreme exaggeration of our previous example, but in this case the search will always be completed after the first attempt.  In the worst case, all probabilities are equal, and we get a standard search for BST.  We come to the following: <br><br><table><tbody><tr><th>  Algorithm </th><th colspan="2">  Initialization time </th><th colspan="2">  Generation time </th><th colspan="2">  Busy memory </th></tr><tr><th></th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th></tr><tr><td>  Honest bone cheat bone </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2564"><span class="MJXp-mtext" id="MJXp-Span-2565">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2568"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2569"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2573" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-323-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-323"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2575"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-msubsup" id="MJXp-Span-2581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">d </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-2581"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2587"><font style="vertical-align: inherit;">n </font></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2581"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584"><font style="vertical-align: inherit;">i </font></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2581"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2583"><span class="MJXp-mo" id="MJXp-Span-2585"><font style="vertical-align: inherit;">= </font></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2581"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2583"><span class="MJXp-mn" id="MJXp-Span-2586"><font style="vertical-align: inherit;">0</font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2588"><span class="MJXp-msubsup" id="MJXp-Span-2589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"> d </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2588"><span class="MJXp-msubsup" id="MJXp-Span-2589"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2591" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> )</font></span></font><span class="MJXp-mtext" id="MJXp-Span-2577">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2579"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-2581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2587"><font style="vertical-align: inherit;"></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2585"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-2586"><font style="vertical-align: inherit;"></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2588"><span class="MJXp-msubsup" id="MJXp-Span-2589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2591" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-324-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-324"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2593"><span class="MJXp-mtext" id="MJXp-Span-2594">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2599"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2600" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2601"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2602" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-325-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-325"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2603"><span class="MJXp-mtext" id="MJXp-Span-2604">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2607"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2608"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2611"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2612" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-326-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-326"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2615" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2617"><font style="vertical-align: inherit;">p </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">d </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2626"><font style="vertical-align: inherit;">n </font></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623"><font style="vertical-align: inherit;">i </font></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2622"><span class="MJXp-mo" id="MJXp-Span-2624"><font style="vertical-align: inherit;">= </font></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2622"><span class="MJXp-mn" id="MJXp-Span-2625"><font style="vertical-align: inherit;">0</font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2627"><span class="MJXp-msubsup" id="MJXp-Span-2628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2629" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"> d </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2627"><span class="MJXp-msubsup" id="MJXp-Span-2628"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2630" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> )</font></span></font><span class="MJXp-mtext" id="MJXp-Span-2616">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2617"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2619"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2626"><font style="vertical-align: inherit;"></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2624"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-2625"><font style="vertical-align: inherit;"></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2627"><span class="MJXp-msubsup" id="MJXp-Span-2628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2629" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2630" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-327-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-327"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td></tr><tr><td>  Shuler bone from asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2632"><span class="MJXp-mtext" id="MJXp-Span-2633">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2634"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2635"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2636"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2639" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2640"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-328-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-328"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2642"><span class="MJXp-mtext" id="MJXp-Span-2643">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2645"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2649" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2650"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2651" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-329-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-329"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2652"><span class="MJXp-mtext" id="MJXp-Span-2653">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2654"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2655"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2656"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2659" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2661" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-330-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-330"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2662"><span class="MJXp-mtext" id="MJXp-Span-2663">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2664"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2666"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2668"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2669" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2671" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-331-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-331"> \ Theta (n) </script></td></tr><tr><td>  Selection by the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2672"><span class="MJXp-mtext" id="MJXp-Span-2673">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2674"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2675"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2678"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2679" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2680"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2681" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-332-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-332"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2682"><span class="MJXp-mtext" id="MJXp-Span-2683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2684"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2686"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2688"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2689" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2692"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-2695" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-2690">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2692"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2694"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2695" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-333-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-333"> \ Theta (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2696"><span class="MJXp-mtext" id="MJXp-Span-2697">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2699"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2700"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2703" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2705" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-334-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-334"> \ Theta (n) </script></td></tr><tr><td>  The optimal choice of the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2708" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2710" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2711" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-335-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-335"> O (n ^ 2) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2713"><span class="MJXp-mtext" id="MJXp-Span-2714">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2715"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2716"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2719"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2721"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2722" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-336-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-336"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2725" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2727"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728"><font style="vertical-align: inherit;">o </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730"><font style="vertical-align: inherit;">n </font></span><span class="MJXp-mo" id="MJXp-Span-2731" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mtext" id="MJXp-Span-2726">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2727"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-2731" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-337-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-337"> O (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2732"><span class="MJXp-mtext" id="MJXp-Span-2733">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2734"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2736"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2738"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2739" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2741" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-338-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-338"> \ Theta (n) </script></td></tr></tbody></table><br><h2>  Throwing darts </h2><br>  So far we have considered two primitives that helped us build algorithms for simulating a cheat bone: an honest bone and an asymmetric coin.  When using only honest bone, we come to the (alas, impractical) algorithm for simulating a cheat bone, and starting with asymmetrical coins, we were able to invent a fast algorithm for simulating a cheat bone.  Is it possible to combine these two approaches to create an algorithm based on both honest bones and asymmetrical coins?  It turns out that yes, and in fact the resulting algorithm is better than both of these approaches. <br><br>  Up to this point, we have visualized the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2742"><span class="MJXp-mo" id="MJXp-Span-2743" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2744">0</span><span class="MJXp-mo" id="MJXp-Span-2745" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2746">1</span><span class="MJXp-mo" id="MJXp-Span-2747" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-339-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-339"> [0, 1) </script>  and the probability of the bone edges as a one-dimensional interval.  Both of these algorithms select a point in the interval. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2748"><span class="MJXp-mo" id="MJXp-Span-2749" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2750">0</span><span class="MJXp-mo" id="MJXp-Span-2751" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2752">1</span><span class="MJXp-mo" id="MJXp-Span-2753" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-340-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-340"> [0, 1) </script>  and impose it on a line segment, the length of which corresponds to a certain probability.  The longer the segments we create, the greater the likelihood of choosing this segment.  But what if you try to think not in one, but in two dimensions?  What if we take the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2754"><span class="MJXp-msubsup" id="MJXp-Span-2755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2756" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2757" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-341-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-341"> p_i </script>  not the length of a straight line, but an area of ‚Äã‚Äãa rectangle? <br><br>  Let's start by returning to our previous example with probabilities. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2758"><span class="MJXp-mtext" id="MJXp-Span-2759">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2760">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2761">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2763">c</span><span class="MJXp-mrow" id="MJXp-Span-2764"><span class="MJXp-mn" id="MJXp-Span-2765">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2766"><span class="MJXp-mn" id="MJXp-Span-2767">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-342-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-342"> \ frac {1} {2} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2768"><span class="MJXp-mtext" id="MJXp-Span-2769">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2770">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2771">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2772">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2773">c</span><span class="MJXp-mrow" id="MJXp-Span-2774"><span class="MJXp-mn" id="MJXp-Span-2775">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2776"><span class="MJXp-mn" id="MJXp-Span-2777">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-343-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-343"> \ frac {1} {3} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2778"><span class="MJXp-mtext" id="MJXp-Span-2779">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2781">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2783">c</span><span class="MJXp-mrow" id="MJXp-Span-2784"><span class="MJXp-mn" id="MJXp-Span-2785">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2786"><span class="MJXp-mn" id="MJXp-Span-2787">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-344-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-344"> \ frac {1} {12} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2788"><span class="MJXp-mtext" id="MJXp-Span-2789">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2791">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2793">c</span><span class="MJXp-mrow" id="MJXp-Span-2794"><span class="MJXp-mn" id="MJXp-Span-2795">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2796"><span class="MJXp-mn" id="MJXp-Span-2797">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-345-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-345"> \ frac {1} {12} </script>  .  Draw these probabilities as rectangles of width <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-346-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-346"> w </script>  (with some arbitrary <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2801">w</span><span class="MJXp-mo" id="MJXp-Span-2802" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-2803">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-347-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-347"> w> 0 </script>  ) and tall <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2804"><span class="MJXp-msubsup" id="MJXp-Span-2805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2807" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-348-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-348"> p_i </script>  (thus, the area of ‚Äã‚Äãthe rectangle will be equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2809">w</span><span class="MJXp-mtext" id="MJXp-Span-2810">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2811">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2812">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2813">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">t</span><span class="MJXp-msubsup" id="MJXp-Span-2815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2816" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2817" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-349-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-349"> w \ cdot p_i </script>  ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a11/0b6/648/a110b6648be46272ac6ec21462de4265.png"></div><br>  Note that the total area of ‚Äã‚Äãthese rectangles is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-350-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-350"> w </script>  since the area <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2820"><span class="MJXp-mtext" id="MJXp-Span-2821">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2822">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2823">u</span><span class="MJXp-msubsup" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2831">n</span><span class="MJXp-mo" id="MJXp-Span-2832">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2833">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2827">i</span><span class="MJXp-mo" id="MJXp-Span-2828">=</span><span class="MJXp-mn" id="MJXp-Span-2829">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2835">w</span><span class="MJXp-msubsup" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2838" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840">w</span><span class="MJXp-mtext" id="MJXp-Span-2841">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2842">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843">u</span><span class="MJXp-msubsup" id="MJXp-Span-2844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2851">n</span><span class="MJXp-mo" id="MJXp-Span-2852">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2853">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847">i</span><span class="MJXp-mo" id="MJXp-Span-2848">=</span><span class="MJXp-mn" id="MJXp-Span-2849">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2854"><span class="MJXp-msubsup" id="MJXp-Span-2855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2856" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2857" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2858" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">w</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-351-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-351"> \ sum_ {i = 0} ^ {n - 1} {w p_i} = w \ sum_ {i = 0} ^ {n - 1} {p_i} = w </script></p><br>  Now suppose that we draw around these rectangles a bounding rectangle whose width is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2860"><span class="MJXp-mn" id="MJXp-Span-2861">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-352-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-352"> 4w </script>  (since there are four quadrilaterals), and the height is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2863"><span class="MJXp-mtext" id="MJXp-Span-2864">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2865">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2867">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">c</span><span class="MJXp-mrow" id="MJXp-Span-2869"><span class="MJXp-mn" id="MJXp-Span-2870">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2871"><span class="MJXp-mn" id="MJXp-Span-2872">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-353-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-353"> \ frac {1} {2} </script>  (since the highest rectangle has a height <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2873"><span class="MJXp-mtext" id="MJXp-Span-2874">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2877">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2878">c</span><span class="MJXp-mrow" id="MJXp-Span-2879"><span class="MJXp-mn" id="MJXp-Span-2880">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2881"><span class="MJXp-mn" id="MJXp-Span-2882">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-354-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-354"> \ frac {1} {2} </script>  ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/00c/e88/87d/00ce8887d6ba4cfaf9e1330a5752911e.png"></div><br>  We can imagine that this rectangle is divided into five areas - four areas correspond to different probabilities, and one area is the unused space.  Taking this split, we can think of an algorithm for simulating random dice rolls as a game of darts.  Suppose we throw a dart (ideally equally distributed) at this target.  If he gets into the unused space, then we take a dart and throw it again, repeating the process until we get into one of the rectangles.  Since the greater the probability, the larger the rectangle, the greater the probability of ejection of the face of the bone, the higher the probability of falling into its rectangle.  In fact, if we set a condition that we have already fallen into <i>a</i> rectangle, then we will have the following: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2883"><span class="noError" id="MJXp-Span-2884" style="display: inline-block;">\&nbsp;mathbb&nbsp;{P}&nbsp;[\&nbsp;mbox&nbsp;{hit&nbsp;rectangle&nbsp;for&nbsp;side&nbsp;i}&nbsp;|&nbsp;\&nbsp;mbox&nbsp;{hit&nbsp;some&nbsp;rectangle}]&nbsp;=&nbsp;\&nbsp;frac&nbsp;{\&nbsp;mbox&nbsp;{area&nbsp;of&nbsp;‚Äã‚Äãrectangle&nbsp;for&nbsp;i}}&nbsp;{\&nbsp;mbox&nbsp;{total&nbsp;rectangle&nbsp;area}&nbsp;=&nbsp;\&nbsp;frac&nbsp;{w&nbsp;p_i}&nbsp;{w}&nbsp;=&nbsp;p_i</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-355-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-355"> \ mathbb {P} [\ mbox {hit rectangle for side i} | \ mbox {hit some rectangle}] = \ frac {\ mbox {area of ‚Äã‚Äãrectangle for i}} {\ mbox {total rectangle area} = \ frac {w p_i} {w} = p_i </script></p><br>  In other words, when we finally fall into some rectangle with our uniformly distributed dart, we select the face rectangle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2886">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-356-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-356"> i </script>  cheat bone with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2887"><span class="MJXp-msubsup" id="MJXp-Span-2888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2889" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2890" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-357-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-357"> p_i </script>  , that is precisely with the probability that we need!  That is, if we can find some effective way of simulating the throws of random darts into this rectangle, then we will have an effective way of simulating the throw of a random bone. <br><br>  One way to simulate the throws of a dart into this rectangle is to select two equally distributed values ‚Äã‚Äãin the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2891"><span class="MJXp-mo" id="MJXp-Span-2892" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2893">0</span><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2895">1</span><span class="MJXp-mo" id="MJXp-Span-2896" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-358-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-358"> [0, 1) </script>  , scaling them to the appropriate width and height, followed by checking the area under the dart.  However, this causes the same problem that we had when we tried to determine a one-dimensional region in which there is a random value.  However, there is a truly excellent series of observations, thanks to which determining the place of entry can be a simple, if not trivial, task. <br><br>  The first observation: we showed that the width of these rectangles can be chosen arbitrarily, because they all have an equal width.  The heights, of course, depend on the probabilities of the edges of the bones.  However, if we uniformly scale all heights by some positive real number <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2898">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-359-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-359"> h </script>  , then the relative areas of all the rectangles will be the same.  In fact, for any positive real number <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2900">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-360-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-360"> h </script>  the total area of ‚Äã‚Äãall rectangles after scaling their heights on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-361-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-361"> h </script>  calculated as <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2903"><span class="MJXp-mtext" id="MJXp-Span-2904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2905">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2906">u</span><span class="MJXp-msubsup" id="MJXp-Span-2907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2908" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2914">n</span><span class="MJXp-mo" id="MJXp-Span-2915">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2916">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910">i</span><span class="MJXp-mo" id="MJXp-Span-2911">=</span><span class="MJXp-mn" id="MJXp-Span-2912">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2919">h</span><span class="MJXp-msubsup" id="MJXp-Span-2920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2922" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2923" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925">h</span><span class="MJXp-mtext" id="MJXp-Span-2926">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2927">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2928">u</span><span class="MJXp-msubsup" id="MJXp-Span-2929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2930" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2936">n</span><span class="MJXp-mo" id="MJXp-Span-2937">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2938">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2932">i</span><span class="MJXp-mo" id="MJXp-Span-2933">=</span><span class="MJXp-mn" id="MJXp-Span-2934">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2939"><span class="MJXp-msubsup" id="MJXp-Span-2940"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2941" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2942" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2943" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2944">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2945">h</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-362-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-362"> \ sum_ {i = 0} ^ {n - 1} {w h p_i} = w h \ sum_ {i = 0} ^ {n - 1} {p_i} = w h </script></p><br>  Now consider the probability of choosing any individual rectangle, limiting the condition that we just got into some kind of a rectangle.  Using the same calculations, we get the following: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2946"><span class="noError" id="MJXp-Span-2947" style="display: inline-block;">\&nbsp;mathbb&nbsp;{P}&nbsp;[\&nbsp;mbox&nbsp;{hit&nbsp;rectangle&nbsp;for&nbsp;side&nbsp;i}&nbsp;|&nbsp;\&nbsp;mbox&nbsp;{hit&nbsp;some&nbsp;rectangle}]&nbsp;=&nbsp;\&nbsp;frac&nbsp;{\&nbsp;mbox&nbsp;{area&nbsp;of&nbsp;‚Äã‚Äãrectangle&nbsp;for&nbsp;i}}&nbsp;{\&nbsp;mbox&nbsp;{total&nbsp;rectangle&nbsp;area}&nbsp;=&nbsp;\&nbsp;frac&nbsp;{w&nbsp;h&nbsp;p_i}&nbsp;{w&nbsp;h}&nbsp;=&nbsp;p_i</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-363-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-363"> \ mathbb {P} [\ mbox {hit rectangle for side i} | \ mbox {hit some rectangle}] = \ frac {\ mbox {area of ‚Äã‚Äãrectangle for i}} {\ mbox {total rectangle area} = \ frac {w h p_i} {w h} = p_i </script></p><br>  That is, in fact, the probability of choosing any particular rectangle does not change if we scale them linearly and evenly. <br><br>  Since we can choose any suitable scaling factor, why don't we scale these rectangles so that the height of the bounding rectangle is always 1?  Since the height of the bounding box is determined by the maximum value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2948"><span class="MJXp-msubsup" id="MJXp-Span-2949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2951" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-364-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-364"> p_i </script>  input probabilities, then we can start by scaling each of the rectangles by a factor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2952"><span class="MJXp-mtext" id="MJXp-Span-2953">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2957">c</span><span class="MJXp-mrow" id="MJXp-Span-2958"><span class="MJXp-mn" id="MJXp-Span-2959">1</span></span><span class="MJXp-mrow" id="MJXp-Span-2960"><span class="MJXp-msubsup" id="MJXp-Span-2961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2962" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2963" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2964">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2965">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2966">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-365-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-365"> \ frac {1} {p_ {max}} </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2967"><span class="MJXp-msubsup" id="MJXp-Span-2968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2969" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2970" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2971">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2972">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-366-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-366"> p_ {max} </script>  - is the maximum probability of all input probabilities.  Due to this, we get the height of the rectangle 1. In a similar way, since we can choose any arbitrary width for the rectangles, let's take the width 1. This means that when <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-367-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-367"> n </script>  probabilities, the total width of the bounding box is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2977">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-368-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-368"> n </script>  and the total height is 1. This is shown in the figure: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a4e/ccb/330/a4eccb3300060dd1c0bfa23c8239d2d7.png"></div><br>  Now we are ready to think about how we can throw a random dart into a rectangle and determine what it hit.  The most important thing is that we can split the rectangle so that it does not consist of several smaller rectangles and an empty space of strange shape.  Instead, the area is cut into a set of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2978"><span class="MJXp-mn" id="MJXp-Span-2979">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-369-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-369"> 2n </script>  rectangles, two for each of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2982">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-370-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-370"> n </script>  input probabilities.  This is shown here: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/868/f5f/5bf/868f5f5bfed1f741ba733585d0645561.png"></div><br>  Notice how this rectangle is formed.  For each face of the cheat bone, we have one column of width 1 and height 1, divided into two spaces ‚Äî a half space ‚Äúyes‚Äù, corresponding to a rectangle of this size, and a half space ‚Äúno‚Äù, corresponding to the remaining part of the column. <br><br>  Now let's think about how we can throw a dart.  A perfectly uniform dart thrown into this rectangle will have components. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2984">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-371-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-371"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2986">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-372-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-372"> y </script>  .  Here is the component <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2988">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-373-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-373"> x </script>  which must be in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2989"><span class="MJXp-mo" id="MJXp-Span-2990" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2991">0</span><span class="MJXp-mo" id="MJXp-Span-2992" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2993">1</span><span class="MJXp-mo" id="MJXp-Span-2994" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-374-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-374"> [0, 1) </script>  , corresponds to which column the dart falls into.  Component <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2996">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-375-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-375"> y </script>  which must be in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2997"><span class="MJXp-mo" id="MJXp-Span-2998" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2999">0</span><span class="MJXp-mo" id="MJXp-Span-3000" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-3001">1</span><span class="MJXp-mo" id="MJXp-Span-3002" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-376-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-376"> [0, 1) </script>  , corresponds to how high we are in the column.  Component selection <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3004">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-377-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-377"> x </script>  influences which side of the cheat bone we are considering, and the choice of the component <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3006">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-378-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-378"> y </script>  corresponds to whether we chose this line or not.  But wait, we already know these two ideas!  Coordinate selection <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3008">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-379-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-379"> x </script>  corresponding to the column, similar to throwing an honest dice to decide on the choice of a column.  Coordinate selection <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3010">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-380-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-380"> y </script>  matches an asymmetric coin toss to determine whether to select a face or throw again!  This observation is so important that we make it absolutely clear: <br><br><blockquote>  <strong>Choosing a random point in this interval is similar to throwing an honest bone and throwing an asymmetrical coin.</strong> </blockquote><br>  In fact, this result can be perceived as a much more powerful feature.  To simulate a cheat bone, we build a set of asymmetric coins, one for each face of the bone, and then we throw an honest bone to determine which coin to throw to us.  Based on the roll of the dice, if an eagle has fallen on the appropriate coin, then we select the appropriate face, and if tails fell, then roll the dice again and repeat the process. <br><br>  Let's repeat these important points.  First, these rectangles have the following dimensions - for each face, the height of the ‚Äúyes‚Äù rectangle is given as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3011"><span class="MJXp-mtext" id="MJXp-Span-3012">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3013">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3014">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3015">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3016">c</span><span class="MJXp-mrow" id="MJXp-Span-3017"><span class="MJXp-msubsup" id="MJXp-Span-3018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3019" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3020" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3021"><span class="MJXp-msubsup" id="MJXp-Span-3022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3023" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3024" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3025">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3026">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3027">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-381-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-381"> \ frac {p_i} {p_ {max}} </script>  and the height of the ‚Äúno‚Äù rectangle is given as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3028"><span class="MJXp-mtext" id="MJXp-Span-3029">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3030">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3031">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3033">c</span><span class="MJXp-mrow" id="MJXp-Span-3034"><span class="MJXp-msubsup" id="MJXp-Span-3035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3036" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3037" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3038">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3040">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-3041" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-3042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3043" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3044" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3045"><span class="MJXp-msubsup" id="MJXp-Span-3046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3047" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3048" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3049">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3051">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-382-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-382"> \ frac {p_ {max} - p_i} {p_ {max}} </script>  .  So we perform normalization so that the total heights of the rectangles are equal to 1. Secondly, each rectangle has a width <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3052"><span class="MJXp-mn" id="MJXp-Span-3053">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-383-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-383"> 1 </script>  but in reality this value is not important.  Finally, the algorithm has the following form: until we have chosen some result, we throw an honest bone to determine which column we are in (in other words, which asymmetric coin we need to throw).  Next, throw the appropriate coin.  If the eagle falls, then select the result corresponding to the selected column.  Otherwise, repeat this process. <br><br><blockquote><h4>  Algorithm: cheat bone of honest bones / asymmetric coins </h4><br><ul><li>  <b>Initialization</b> : <br><ol><li>  Find the maximum value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3054"><span class="MJXp-msubsup" id="MJXp-Span-3055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3056" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3057" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-384-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-384"> p_i </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3058"><span class="MJXp-msubsup" id="MJXp-Span-3059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3060" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3061" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3062">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3063">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3064">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-385-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-385"> p_ {max} </script>  . </li><li>  Select the array <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3066">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3068">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3069">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3070">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-386-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-386"> Coins </script>  long <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3072">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-387-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-387"> n </script>  corresponding to the heights of the ‚Äúyes‚Äù rectangles in each row. </li><li>  For each probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3074">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-388-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-388"> i </script>  from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3075"><span class="MJXp-mn" id="MJXp-Span-3076">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-389-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-389"> 0 </script>  before <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3078">n</span><span class="MJXp-mo" id="MJXp-Span-3079" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3080">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-390-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-390"> n - 1 </script>  : <br><ol><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3082">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3083">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3084">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3085">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3086">s</span><span class="MJXp-mo" id="MJXp-Span-3087" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3088">i</span><span class="MJXp-mo" id="MJXp-Span-3089" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3090" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3091">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3092">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3093">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3094">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3095">c</span><span class="MJXp-mrow" id="MJXp-Span-3096"><span class="MJXp-msubsup" id="MJXp-Span-3097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3098" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3099" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3100"><span class="MJXp-msubsup" id="MJXp-Span-3101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3103" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3104">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3106">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-391-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-391"> Coins [i] = \ frac {p_i} {p_ {max}} </script></li></ol></li></ol><br></li><li>  <b>Generation</b> : <br><ol><li>  No value found yet: <br><ol><li>  Throw an honest n-sided bone and get the index <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3108">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-392-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-392"> i </script>  in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3109"><span class="MJXp-mo" id="MJXp-Span-3110" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-3111">0</span><span class="MJXp-mo" id="MJXp-Span-3112" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3113">n</span><span class="MJXp-mo" id="MJXp-Span-3114" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-393-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-393"> [0, n) </script>  . </li><li>  We throw an asymmetrical coin, on which an eagle falls on it with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3116">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3117">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3118">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3120">s</span><span class="MJXp-mo" id="MJXp-Span-3121" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3122">i</span><span class="MJXp-mo" id="MJXp-Span-3123" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-394-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-394"> Coins [i] </script>  . </li><li>  If an eagle falls on a coin, then we return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3125">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-395-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-395"> i </script>  . </li></ol></li></ol></li></ul></blockquote><br>  Let's analyze the complexity of this algorithm.  At the initialization stage, the search for the maximum probability takes time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127">O</span><span class="MJXp-mo" id="MJXp-Span-3128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">n</span><span class="MJXp-mo" id="MJXp-Span-3130" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-396-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-396"> O (n) </script>  and then extra time is needed <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3132">O</span><span class="MJXp-mo" id="MJXp-Span-3133" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3134">n</span><span class="MJXp-mo" id="MJXp-Span-3135" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-397-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-397"> O (n) </script>  on the selection and filling of the array <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3139">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3141">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-398-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-398"> Coins </script>  that is, the total initialization time is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3143">O</span><span class="MJXp-mo" id="MJXp-Span-3144" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145">n</span><span class="MJXp-mo" id="MJXp-Span-3146" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-399-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-399"> O (n) </script>  .  At the generation stage, in the best case, we will drop the eagle on the very first coin, ending in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3148">O</span><span class="MJXp-mo" id="MJXp-Span-3149" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3150">1</span><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-400-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-400"> O (1) </script>  .  But how many iterations are required to wait?  To find this value, let's calculate the probability that we will choose some edge after the first iteration.  Since the coins have a different likelihood of throwing an eagle, this will depend on the chosen coin.  Fortunately, since we select each coin with equal probability (namely <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3152"><span class="MJXp-mtext" id="MJXp-Span-3153">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3154">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3155">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3156">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3157">c</span><span class="MJXp-mrow" id="MJXp-Span-3158"><span class="MJXp-mn" id="MJXp-Span-3159">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3161">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-401-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-401"> \ frac {1} {n} </script>  ), calculations become much easier.  Moreover, since as a result we throw only one coin, then the events of selecting each coin and ejecting the eagle exclude each other, that is, the total probability that a coin is chosen is thrown and gives us an eagle calculated as the sum of the probabilities of choosing each individual coins and throwing an eagle on each of these coins.  Since we know that the probability of choosing a face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3163">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-402-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-402"> i </script>  set as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3164"><span class="MJXp-mtext" id="MJXp-Span-3165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3166">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3167">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3168">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3169">c</span><span class="MJXp-mrow" id="MJXp-Span-3170"><span class="MJXp-msubsup" id="MJXp-Span-3171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3172" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3173" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3174"><span class="MJXp-msubsup" id="MJXp-Span-3175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3176" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3177" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3178">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3179">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3180">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-403-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-403"> \ frac {p_i} {p_ {max}} </script>  , then the total probability of choosing one side is given as <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3181"><span class="MJXp-mtext" id="MJXp-Span-3182">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3183">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3184">u</span><span class="MJXp-msubsup" id="MJXp-Span-3185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3192">n</span><span class="MJXp-mo" id="MJXp-Span-3193">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3194">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3188">i</span><span class="MJXp-mo" id="MJXp-Span-3189">=</span><span class="MJXp-mn" id="MJXp-Span-3190">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3195"><span class="MJXp-mo" id="MJXp-Span-3196" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3198">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3199">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3200">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3201">c</span><span class="MJXp-mrow" id="MJXp-Span-3202"><span class="MJXp-mn" id="MJXp-Span-3203">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3205">n</span></span><span class="MJXp-mtext" id="MJXp-Span-3206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3207">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3209">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">c</span><span class="MJXp-mrow" id="MJXp-Span-3211"><span class="MJXp-msubsup" id="MJXp-Span-3212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3213" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3214" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3215"><span class="MJXp-msubsup" id="MJXp-Span-3216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3217" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3218" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3219">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3220">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3221">x</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3222" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-3223" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3225">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3226">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3227">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3228">c</span><span class="MJXp-mrow" id="MJXp-Span-3229"><span class="MJXp-mn" id="MJXp-Span-3230">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3232">n</span></span><span class="MJXp-mtext" id="MJXp-Span-3233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3234">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3235">u</span><span class="MJXp-msubsup" id="MJXp-Span-3236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3237" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3243">n</span><span class="MJXp-mo" id="MJXp-Span-3244">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3245">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3239">i</span><span class="MJXp-mo" id="MJXp-Span-3240">=</span><span class="MJXp-mn" id="MJXp-Span-3241">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3246"><span class="MJXp-mtext" id="MJXp-Span-3247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3248">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3249">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3250">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3251">c</span><span class="MJXp-mrow" id="MJXp-Span-3252"><span class="MJXp-msubsup" id="MJXp-Span-3253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3254" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3255" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3256"><span class="MJXp-msubsup" id="MJXp-Span-3257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3258" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3259" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3260">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3261">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3262">x</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3263" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3265">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3266">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3267">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268">c</span><span class="MJXp-mrow" id="MJXp-Span-3269"><span class="MJXp-mn" id="MJXp-Span-3270">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272">n</span><span class="MJXp-mtext" id="MJXp-Span-3273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3274">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3275">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3276">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3277">t</span><span class="MJXp-msubsup" id="MJXp-Span-3278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3279" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3280" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3281">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3282">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3283">x</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-3284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3285">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3286">u</span><span class="MJXp-msubsup" id="MJXp-Span-3287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3288" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3294">n</span><span class="MJXp-mo" id="MJXp-Span-3295">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3296">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3290">i</span><span class="MJXp-mo" id="MJXp-Span-3291">=</span><span class="MJXp-mn" id="MJXp-Span-3292">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3297"><span class="MJXp-msubsup" id="MJXp-Span-3298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3299" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3300" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-3301" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3302">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3303">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3304">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3305">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3306">c</span><span class="MJXp-mrow" id="MJXp-Span-3307"><span class="MJXp-mn" id="MJXp-Span-3308">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3310">n</span><span class="MJXp-mtext" id="MJXp-Span-3311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3312">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3313">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3314">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3315">t</span><span class="MJXp-msubsup" id="MJXp-Span-3316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3317" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3318" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3319">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3320">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3321">x</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-404-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-404"> \ sum_ {i = 0} ^ {n - 1} {(\ frac {1} {n} \ frac {p_i} {p_ {max}})} = \ frac {1} {n} \ sum_ {i = 0} ^ {n - 1} {\ frac {p_i} {p_ {max}}} = \ frac {1} {n \ cdot p_ {max}} \ sum_ {i = 0} ^ {n - 1} {p_i} = \ frac {1} {n \ cdot p_ {max}} </script></p><br>  If this is the probability of choosing a coin in any one iteration, then the expected number of iterations that can occur is given by the reciprocal of this fraction, that is, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3323">n</span><span class="MJXp-mtext" id="MJXp-Span-3324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3325">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3326">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3327">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3328">t</span><span class="MJXp-msubsup" id="MJXp-Span-3329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3330" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3331" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3332">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3333">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3334">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-405-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-405"> n \ cdot p_ {max} </script>  .  But what does this mean?  It very much depends on the choice <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3335"><span class="MJXp-msubsup" id="MJXp-Span-3336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3337" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3338" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3339">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3340">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3341">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-406-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-406"> p_ {max} </script>  .  In one limiting case <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3342"><span class="MJXp-msubsup" id="MJXp-Span-3343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3344" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3345" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3346">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3347">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3348">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-407-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-407"> p_ {max} </script>  may be equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3349"><span class="MJXp-mn" id="MJXp-Span-3350">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-408-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-408"> 1 </script>  (i.e., the bone always falls in one facet).  In this case, the expected number of iterations is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3352">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-409-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-409"> n </script>  that is, to get what we expected, we have to throw an honest bone <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3354">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-410-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-410"> n </script>  time.  This is logical, because the only way to select a face is that we take an asymmetrical coin for one face, which always falls upwards with an eagle, since for every other side the coin never drops out as an eagle.  On the other hand, in the opposite limit case the minimum value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3355"><span class="MJXp-msubsup" id="MJXp-Span-3356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3357" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3358" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3359">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3360">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3361">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-411-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-411"> p_ {max} </script>  equally <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3362"><span class="MJXp-mtext" id="MJXp-Span-3363">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3364">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3365">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3366">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3367">c</span><span class="MJXp-mrow" id="MJXp-Span-3368"><span class="MJXp-mn" id="MJXp-Span-3369">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3371">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-412-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-412"> \ frac {1} {n} </script>  , because if it were at least a little less than this value, then the total probability of all sides would be less than one.  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3372"><span class="MJXp-msubsup" id="MJXp-Span-3373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3374" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3375" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3376">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3377">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3378">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-3379" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3380">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3381">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3382">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3383">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3384">c</span><span class="MJXp-mrow" id="MJXp-Span-3385"><span class="MJXp-mn" id="MJXp-Span-3386">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3388">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-413-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-413"> p_ {max} = \ frac {1} {n} </script>  then the expected number of coin flips is 1. This is also logical.  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3389"><span class="MJXp-msubsup" id="MJXp-Span-3390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3391" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3392" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3393">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3394">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3395">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-3396" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-3397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3398">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3399">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3400">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3401">c</span><span class="MJXp-mrow" id="MJXp-Span-3402"><span class="MJXp-mn" id="MJXp-Span-3403">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3405">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-414-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-414"> p_ {max} = \ frac {1} {n} </script>  , then each side has the same probability of being selected (namely <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3406"><span class="MJXp-mtext" id="MJXp-Span-3407">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3408">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3409">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3410">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3411">c</span><span class="MJXp-mrow" id="MJXp-Span-3412"><span class="MJXp-mn" id="MJXp-Span-3413">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3415">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-415-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-415"> \ frac {1} {n} </script>  ), so when we normalize the probabilities of each face to 1, then each face will have a probability of being chosen equal to 1. Therefore, throwing a dice to select a coin will in fact determine the result, since the coin always drops out as an eagle and we will never have to repeat. <br><br>  Interestingly, the expected number of coin flips depends solely on the value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3416"><span class="MJXp-msubsup" id="MJXp-Span-3417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3418" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3419" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3420">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3421">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3422">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-416-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-416"> p_ {max} </script>  , and not from the other probabilities involved, but if we return to our graphical representation, it makes sense.  The total area of ‚Äã‚Äãthe rectangle we shoot with darts is always equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3424">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-417-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-417"> n </script>  , because we normalized the heights, making them equal to 1. Moreover, the total area occupied by the ‚Äúyes‚Äù rectangles is given as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3425"><span class="MJXp-mtext" id="MJXp-Span-3426">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3427">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3428">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3429">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3430">c</span><span class="MJXp-mrow" id="MJXp-Span-3431"><span class="MJXp-mn" id="MJXp-Span-3432">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3433"><span class="MJXp-msubsup" id="MJXp-Span-3434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3435" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3436" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3437">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3438">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3439">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-418-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-418"> \ frac {1} {p_ {max}} </script>  , since each rectangle has a width of 1, and the height is normalized by multiplying by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3440"><span class="MJXp-mtext" id="MJXp-Span-3441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3442">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3443">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3444">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3445">c</span><span class="MJXp-mrow" id="MJXp-Span-3446"><span class="MJXp-mn" id="MJXp-Span-3447">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3448"><span class="MJXp-msubsup" id="MJXp-Span-3449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3450" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3451" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3452">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3453">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3454">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-419-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-419"> \ frac {1} {p_ {max}} </script>  .  This means that the ratio of the total area of ‚Äã‚Äãrectangles "yes" to the total area of ‚Äã‚Äãthe entire rectangle is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3455"><span class="MJXp-mtext" id="MJXp-Span-3456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3457">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3458">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3459">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3460">c</span><span class="MJXp-mrow" id="MJXp-Span-3461"><span class="MJXp-mn" id="MJXp-Span-3462">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3464">n</span><span class="MJXp-mtext" id="MJXp-Span-3465">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3466">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3467">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3468">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3469">t</span><span class="MJXp-msubsup" id="MJXp-Span-3470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3471" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3472" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3473">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3474">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3475">x</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-420-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-420"> \ frac {1} {n \ cdot p_ {max}} </script>  .  In other words, the space occupied by the ‚Äúno‚Äù rectangles depends only on the value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3476"><span class="MJXp-msubsup" id="MJXp-Span-3477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3478" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3479" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3480">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3481">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3482">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-421-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-421"> p_ {max} </script>  .  It can be moved or distributed as you please, but as a result, the area always remains the same, and the chances of a dart hitting it are independent of position. <br><br>  Comparing this algorithm with others gives us the following information: <br><br><table><tbody><tr><th>  Algorithm </th><th colspan="2">  Initialization time </th><th colspan="2">  Generation time </th><th colspan="2">  Busy memory </th></tr><tr><th></th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th></tr><tr><td>  Honest bone cheat bone </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3483"><span class="MJXp-mtext" id="MJXp-Span-3484">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3485">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3486">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3487">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3488">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3489">a</span><span class="MJXp-mo" id="MJXp-Span-3490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3491">n</span><span class="MJXp-mo" id="MJXp-Span-3492" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-422-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-422"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3494">O</span><span class="MJXp-mo" id="MJXp-Span-3495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3496">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3497">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3498">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3499">o</span><span class="MJXp-msubsup" id="MJXp-Span-3500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3501" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3506">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3503">i</span><span class="MJXp-mo" id="MJXp-Span-3504">=</span><span class="MJXp-mn" id="MJXp-Span-3505">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3507"><span class="MJXp-msubsup" id="MJXp-Span-3508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3509" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3510" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-3511" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-423-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-423"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3512"><span class="MJXp-mtext" id="MJXp-Span-3513">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3514">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3515">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3516">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3517">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3518">a</span><span class="MJXp-mo" id="MJXp-Span-3519" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3520">1</span><span class="MJXp-mo" id="MJXp-Span-3521" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-424-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-424"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3522"><span class="MJXp-mtext" id="MJXp-Span-3523">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3524">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3525">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3526">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3527">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3528">a</span><span class="MJXp-mo" id="MJXp-Span-3529" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3530">n</span><span class="MJXp-mo" id="MJXp-Span-3531" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-425-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-425"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3533">O</span><span class="MJXp-mo" id="MJXp-Span-3534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3535">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3536">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3537">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3538">o</span><span class="MJXp-msubsup" id="MJXp-Span-3539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3540" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3545">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3542">i</span><span class="MJXp-mo" id="MJXp-Span-3543">=</span><span class="MJXp-mn" id="MJXp-Span-3544">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3546"><span class="MJXp-msubsup" id="MJXp-Span-3547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3548" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3549" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-3550" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-426-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-426"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td></tr><tr><td>  Shuler bone from asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3551"><span class="MJXp-mtext" id="MJXp-Span-3552">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3553">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3554">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3555">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3556">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3557">a</span><span class="MJXp-mo" id="MJXp-Span-3558" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3559">n</span><span class="MJXp-mo" id="MJXp-Span-3560" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-427-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-427"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3561"><span class="MJXp-mtext" id="MJXp-Span-3562">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3563">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3564">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3565">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3566">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3567">a</span><span class="MJXp-mo" id="MJXp-Span-3568" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3569">1</span><span class="MJXp-mo" id="MJXp-Span-3570" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-428-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-428"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3571"><span class="MJXp-mtext" id="MJXp-Span-3572">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3573">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3574">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3575">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3576">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3577">a</span><span class="MJXp-mo" id="MJXp-Span-3578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3579">n</span><span class="MJXp-mo" id="MJXp-Span-3580" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-429-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-429"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3581"><span class="MJXp-mtext" id="MJXp-Span-3582">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3583">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3584">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3585">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3586">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3587">a</span><span class="MJXp-mo" id="MJXp-Span-3588" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3589">n</span><span class="MJXp-mo" id="MJXp-Span-3590" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-430-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-430"> \ Theta (n) </script></td></tr><tr><td>  Choosing a roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3591"><span class="MJXp-mtext" id="MJXp-Span-3592">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3593">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3594">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3595">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3596">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3597">a</span><span class="MJXp-mo" id="MJXp-Span-3598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3599">n</span><span class="MJXp-mo" id="MJXp-Span-3600" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-431-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-431"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3601"><span class="MJXp-mtext" id="MJXp-Span-3602">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3603">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3604">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3605">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3606">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3607">a</span><span class="MJXp-mo" id="MJXp-Span-3608" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3609">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3610">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3611">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3612">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3613">n</span><span class="MJXp-mo" id="MJXp-Span-3614" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-432-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-432"> \ Theta (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3615"><span class="MJXp-mtext" id="MJXp-Span-3616">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3617">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3618">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3619">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3620">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3621">a</span><span class="MJXp-mo" id="MJXp-Span-3622" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3623">n</span><span class="MJXp-mo" id="MJXp-Span-3624" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-433-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-433"> \ Theta (n) </script></td></tr><tr><td>  The optimal choice of the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3626">O</span><span class="MJXp-mo" id="MJXp-Span-3627" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3629" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3630" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3631" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-434-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-434"> O (n ^ 2) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3632"><span class="MJXp-mtext" id="MJXp-Span-3633">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3634">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3635">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3636">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3637">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3638">a</span><span class="MJXp-mo" id="MJXp-Span-3639" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3640">1</span><span class="MJXp-mo" id="MJXp-Span-3641" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-435-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-435"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3643">O</span><span class="MJXp-mo" id="MJXp-Span-3644" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-3645">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3646">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3647">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3648">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3649">n</span><span class="MJXp-mo" id="MJXp-Span-3650" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-436-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-436"> O (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3651"><span class="MJXp-mtext" id="MJXp-Span-3652">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3653">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3654">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3655">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3656">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3657">a</span><span class="MJXp-mo" id="MJXp-Span-3658" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3659">n</span><span class="MJXp-mo" id="MJXp-Span-3660" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-437-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-437"> \ Theta (n) </script></td></tr><tr><td>  Cheat bone of honest bones / asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3661"><span class="MJXp-mtext" id="MJXp-Span-3662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3663">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3664">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3665">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3666">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3667">a</span><span class="MJXp-mo" id="MJXp-Span-3668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3669">n</span><span class="MJXp-mo" id="MJXp-Span-3670" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-438-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-438"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3671"><span class="MJXp-mtext" id="MJXp-Span-3672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3673">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3674">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3676">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3677">a</span><span class="MJXp-mo" id="MJXp-Span-3678" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3679">1</span><span class="MJXp-mo" id="MJXp-Span-3680" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-439-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-439"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3681"><span class="MJXp-mtext" id="MJXp-Span-3682">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3683">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3684">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3685">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3686">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3687">a</span><span class="MJXp-mo" id="MJXp-Span-3688" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3689">n</span><span class="MJXp-mo" id="MJXp-Span-3690" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-440-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-440"> \ Theta (n) </script>  (expected) </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3691"><span class="MJXp-mtext" id="MJXp-Span-3692">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3693">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3694">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3695">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3696">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3697">a</span><span class="MJXp-mo" id="MJXp-Span-3698" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3699">n</span><span class="MJXp-mo" id="MJXp-Span-3700" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-441-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-441"> \ Theta (n) </script></td></tr></tbody></table><br>  In the best case, this algorithm is better than the binary search algorithm shown above, because it requires only one coin toss.  However, the worst case is exponentially worse.  Is it possible to eliminate this worst case? <br><br><h2>  Alias ‚Äã‚Äãmethod </h2><br>  The previous technique perfectly shows itself in the best case, generating a random roll of the dice with just one honest dice and one coin.  But the expected worst behavior is much worse, and potentially requires a linear number of dice and coin rolls.  The reason is that, unlike previous techniques, the algorithm can ‚Äúovershoot‚Äù and has to repeat iterations until it chooses a solution.  Graphically, it can be represented in such a way that we throw darts at a target in which there is a large amount of empty space not tied to any result.  If there was any way to eliminate all this empty space in such a way that each part of the target was covered with a rectangle corresponding to some face of the cheat bone, then we would simply throw a single dart and consider the result. <br><br>  We can make a tricky move by adjusting the height of the rectangle so that it corresponds not to the greatest probability, but to the <i>average</i> .  Let's go back to our example.  Probabilities are equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3701"><span class="MJXp-mtext" id="MJXp-Span-3702">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3703">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3704">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3705">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3706">c</span><span class="MJXp-mrow" id="MJXp-Span-3707"><span class="MJXp-mn" id="MJXp-Span-3708">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3709"><span class="MJXp-mn" id="MJXp-Span-3710">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-442-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-442"> \ frac {1} {2} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3711"><span class="MJXp-mtext" id="MJXp-Span-3712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3713">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3714">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3715">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3716">c</span><span class="MJXp-mrow" id="MJXp-Span-3717"><span class="MJXp-mn" id="MJXp-Span-3718">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3719"><span class="MJXp-mn" id="MJXp-Span-3720">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-443-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-443"> \ frac {1} {3} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3721"><span class="MJXp-mtext" id="MJXp-Span-3722">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3723">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3724">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3725">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3726">c</span><span class="MJXp-mrow" id="MJXp-Span-3727"><span class="MJXp-mn" id="MJXp-Span-3728">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3729"><span class="MJXp-mn" id="MJXp-Span-3730">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-444-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-444"> \ frac {1} {12} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3731"><span class="MJXp-mtext" id="MJXp-Span-3732">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3733">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3734">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3735">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3736">c</span><span class="MJXp-mrow" id="MJXp-Span-3737"><span class="MJXp-mn" id="MJXp-Span-3738">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3739"><span class="MJXp-mn" id="MJXp-Span-3740">12</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-445-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-445"> \ frac {1} {12} </script>  .  Since we have four probabilities, the average probability must be equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3741"><span class="MJXp-mtext" id="MJXp-Span-3742">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3743">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3744">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3745">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3746">c</span><span class="MJXp-mrow" id="MJXp-Span-3747"><span class="MJXp-mn" id="MJXp-Span-3748">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3749"><span class="MJXp-mn" id="MJXp-Span-3750">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-446-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-446"> \ frac {1} {4} </script>  .  What happens if we try to normalize the height of the rectangle according to the average probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3751"><span class="MJXp-mtext" id="MJXp-Span-3752">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3753">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3754">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3755">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3756">c</span><span class="MJXp-mrow" id="MJXp-Span-3757"><span class="MJXp-mn" id="MJXp-Span-3758">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3759"><span class="MJXp-mn" id="MJXp-Span-3760">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-447-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-447"> \ frac {1} {4} </script>  rather than the maximum <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3761"><span class="MJXp-mtext" id="MJXp-Span-3762">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3763">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3764">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3765">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3766">c</span><span class="MJXp-mrow" id="MJXp-Span-3767"><span class="MJXp-mn" id="MJXp-Span-3768">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3769"><span class="MJXp-mn" id="MJXp-Span-3770">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-448-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-448"> \ frac {1} {2} </script>  ?  Let's see what happens.  We start with rectangles wide <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3771"><span class="MJXp-mn" id="MJXp-Span-3772">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-449-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-449"> 1 </script>  whose heights are equal to the initial probabilities: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d8a/c5b/b3d/d8ac5bb3dfced8408e0020c77d268728.png"></div><br>  Now we will scale all these rectangles so that the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3773"><span class="MJXp-mtext" id="MJXp-Span-3774">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3775">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3776">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3777">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3778">c</span><span class="MJXp-mrow" id="MJXp-Span-3779"><span class="MJXp-mn" id="MJXp-Span-3780">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3781"><span class="MJXp-mn" id="MJXp-Span-3782">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-450-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-450"> \ frac {1} {4} </script>  had a height of 1. This can be achieved by multiplying each probability by four, which will give us the following scheme: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c6c/1e7/89a/c6c1e789ad90e2329cf33c81e9e2597d.png"></div><br>  At this point, let's draw a rectangle on top of this image. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3783"><span class="MJXp-mn" id="MJXp-Span-3784">1</span><span class="MJXp-mtext" id="MJXp-Span-3785">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3786">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3787">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3788">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3789">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3790">s</span><span class="MJXp-mn" id="MJXp-Span-3791">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-451-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-451"> 1 \ times 4 </script>  .  It will indicate the target we are shooting at: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/214/b8f/9d6/214b8f9d67a58ad6ede1c96016ba1b91.png"></div><br>  As you can see, this is not entirely correct, because the rectangles for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3792"><span class="MJXp-mtext" id="MJXp-Span-3793">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3794">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3795">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3796">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3797">c</span><span class="MJXp-mrow" id="MJXp-Span-3798"><span class="MJXp-mn" id="MJXp-Span-3799">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3800"><span class="MJXp-mn" id="MJXp-Span-3801">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-452-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-452"> \ frac {1} {2} </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3802"><span class="MJXp-mtext" id="MJXp-Span-3803">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3804">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3805">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3806">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3807">c</span><span class="MJXp-mrow" id="MJXp-Span-3808"><span class="MJXp-mn" id="MJXp-Span-3809">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3810"><span class="MJXp-mn" id="MJXp-Span-3811">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-453-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-453"> \ frac {1} {3} </script>  do not fit perfectly into the bounding box.  But what if we allow ourselves to cut the rectangles into smaller pieces?  That is, what will happen if we cut off part of the space of the rectangle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3812"><span class="MJXp-mtext" id="MJXp-Span-3813">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3814">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3815">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3817">c</span><span class="MJXp-mrow" id="MJXp-Span-3818"><span class="MJXp-mn" id="MJXp-Span-3819">1</span></span><span class="MJXp-mrow" id="MJXp-Span-3820"><span class="MJXp-mn" id="MJXp-Span-3821">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-454-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-454"> \ frac {1} {2} </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and move it to the empty space above the space of one of the rectangles </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3822"><span class="MJXp-mfrac" id="MJXp-Span-3823" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3824">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3825">12</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-455-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-455">\frac{1}{12}</script>  ?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We will get the following scheme, in which there are still vertical stripes hanging from above, but now there are not so many of them: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed7/b60/69d/ed7b6069dab9381d30ca8acb7392f123.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, we still have extra bands, but not many of them. </font><font style="vertical-align: inherit;">We could completely eliminate the excess by moving the parts out of the bands.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3826"><span class="MJXp-mfrac" id="MJXp-Span-3827" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3828">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3829">2</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-456-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-456">\frac{1}{2}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3830"><span class="MJXp-mfrac" id="MJXp-Span-3831" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3832">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3833">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-457-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-457">\frac{1}{3}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">into the empty space, but in reality there is a better solution. </font><font style="vertical-align: inherit;">Let's start by moving</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3834"><span class="MJXp-mfrac" id="MJXp-Span-3835" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3836">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3837">2</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-458-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-458">\frac{1}{2}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the bars from the first column to the third to fill the remaining space. </font><font style="vertical-align: inherit;">We will have a small space in the first column, but we will close another space:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/304/e5a/5cc/304e5a5cc2ae026789b02f3996292797.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Finally, we will drag the excess from the second column to the first, getting a ready-made rectangle: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/038/711/6a0/0387116a0a92cfa458a97fdce960278d.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The resulting circuit has remarkable properties. Firstly, the total area of ‚Äã‚Äãthe rectangles. denoting each face of the shulerskoy bone, have not changed compared with the original scheme; we just cut these rectangles into pieces and move them. This means that as long as the areas of the original rectangles are proportionally distributed according to the initial probability distribution, the total area of ‚Äã‚Äãeach face of the bone remains the same. Secondly, notice that there is no free space in this new rectangle, that is, with any dart throw we are guaranteed to get somewhere and get the final answer, and not empty space that requires another throw. This means that a single dart throw will be enough to generate our random value. Last and foremost, notice that each column contains</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no more than</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> two different rectangles. This means that you can use the previous invention - we throw a bone to choose an asymmetrical coin, and then we throw a coin. The difference this time is in what the throw of the coin means. A dropped eagle means that we choose one face of the bone, and a dropped tails now means that we must choose some other face of the bone (and not throw the bone again).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At a high level, the alias method works as follows. First, we create rectangles that denote each of the different probabilities of the edges of the bone. Next, we cut these rectangles into pieces and redistribute them so that they completely fill the rectangular target so that each column has a constant width and contains rectangles of a maximum of two different sides of the cheat bone. Finally, we simulate the dice rolls, randomly throwing a dart at the target, which can be achieved by combining honest dice and asymmetrical coins.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But how do we know if it is possible to cut the source rectangles at all so that each column contains at most two different probabilities? This does not seem obvious, but it is surprising that this can always be achieved. Moreover, we not only can cut the rectangles into parts so that each column contains no more than two different rectangles, but also make one of the rectangles in each column be the rectangle originally located in this column. You can see that in the rectangle diagram shown above, we always cut out a part of the rectangle and move it to another column and never remove the rectangle of their original column completely. This means that each column in the finished circuit will consist of some kind of rectangle corresponding to the probabilityoriginally assigned to this column, plus (not necessarily) from the second rectangle dragged from some other column. This second rectangle is often called</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with the alias of the</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> column, because the remaining probability of the column is used as the ‚Äúalias‚Äù of some other probability. </font><font style="vertical-align: inherit;">Due to the use of the term ‚Äúalias‚Äù, this method is called the ‚Äúalias method‚Äù. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Before we get to the proof that you can always distribute probabilities in this way, let's briefly describe the essence of the algorithm. </font><font style="vertical-align: inherit;">Since each column of the finished scheme always contains some part of the source rectangle from this column (potentially with a zero height!), Then to store (potentially) two different rectangles occupying the column, the implementation of the alias method usually stores two different tables: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a probability table</font></font></b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3839">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3840">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3841">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3842">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-459-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-459">Prob</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alias table</font></font></b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3844">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3845">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3846">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3847">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3848">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-460-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-460">Alias</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Both of these tables are sized. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3850">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-461-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-461"> n </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The probability table for each column stores the probability of selecting the source rectangle inside this column, and the identifier of the second rectangle contained in this column (if any) is stored in the alias table. </font><font style="vertical-align: inherit;">Thus, the generation of a random roll of the bone can be implemented as follows. </font><font style="vertical-align: inherit;">First, with the help of honest bones, we randomly choose a column</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3852">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-462-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-462"> i </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Next, we throw a random coin with the probability of a falling eagle. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3854">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3855">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3856">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3857">b</span><span class="MJXp-mo" id="MJXp-Span-3858" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3859">i</span><span class="MJXp-mo" id="MJXp-Span-3860" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-463-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-463">Prob[i]</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If an eagle has fallen on the coin, then we return that the edge has fallen to the bone. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3862">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-464-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-464"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , otherwise we return that the edge fell on the bone </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3864">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3865">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3866">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3867">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3868">s</span><span class="MJXp-mo" id="MJXp-Span-3869" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3870">i</span><span class="MJXp-mo" id="MJXp-Span-3871" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-465-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-465">Alias[i]</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is an example of probability tables and alias for the configuration used above: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b08/ab0/c5f/b08ab0c5f5297aab73e4b3a01b13e7af.png"></div><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Proof of the existence of Alias ‚Äã‚Äãtables </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now we need to formally prove that the ability to create tables </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3873">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3874">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3875">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3876">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3877">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-466-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-466">Alias</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3879">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3880">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3881">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3882">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-467-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-467">Prob</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">there is always. </font><font style="vertical-align: inherit;">To prove that this is always possible, we need to show that it is always possible to do the following:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Create Rectangles </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3883"><span class="MJXp-mo" id="MJXp-Span-3884" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3885">n</span><span class="MJXp-mo" id="MJXp-Span-3886" style="margin-left: 0.267em; margin-right: 0.267em;">‚ãÖ</span><span class="MJXp-msubsup" id="MJXp-Span-3887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3888" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3889" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3890" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3891" style="margin-left: 0.267em; margin-right: 0.267em;">√ó</span><span class="MJXp-mn" id="MJXp-Span-3892">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-468-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-468">(n \cdot p_i) \times 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for each of the probabilities </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3893"><span class="MJXp-msubsup" id="MJXp-Span-3894"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3895" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3896" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-469-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-469">p_i</script>  , </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cut them horizontally into smaller pieces and </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> distribute them on </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3898">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-470-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-470"> n </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> columns </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> so that the height of each column is equal </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3899"><span class="MJXp-mn" id="MJXp-Span-3900">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-471-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-471"> 1 </script>  , </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> there are no more than two rectangles in one column and </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> face rectangle </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3902">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-472-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-472"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is located in the column </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3904">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-473-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-473"> i </script>  . </li></ul></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Before turning to the evidence that this is always possible, let's look at an example. </font><font style="vertical-align: inherit;">Let's say we have four probabilities</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3905"><span class="MJXp-mfrac" id="MJXp-Span-3906" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3907">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3908">2</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-474-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-474">\frac{1}{2}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3909"><span class="MJXp-mfrac" id="MJXp-Span-3910" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3911">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3912">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-475-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-475">\frac{1}{3}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3913"><span class="MJXp-mfrac" id="MJXp-Span-3914" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3915">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3916">12</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-476-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-476">\frac{1}{12}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3917"><span class="MJXp-mfrac" id="MJXp-Span-3918" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3919">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3920">12</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-477-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-477">\frac{1}{12}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This is a set of four probabilities ( </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3922">k</span><span class="MJXp-mo" id="MJXp-Span-3923" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3924">n</span><span class="MJXp-mo" id="MJXp-Span-3925" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3926">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-478-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-478">k = n = 4</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), the sum of which is equal to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3927"><span class="MJXp-mn" id="MJXp-Span-3928">1</span><span class="MJXp-mo" id="MJXp-Span-3929" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3930" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3931">4</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3932">4</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-479-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-479">1 = \frac{4}{4}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although we experimentally showed above how to fill in the alias table, now let's consider its creation in more detail and start with a completely empty table, and then begin to fill it. </font><font style="vertical-align: inherit;">We begin by scaling all these probabilities by a factor of 4, which gives us such probabilities and such an empty table:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/858/da5/1e1/858da51e13c745d79b9ade6faf75bd89.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Notice that two of the four rectangles that we need to distribute ( </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3933"><span class="MJXp-mfrac" id="MJXp-Span-3934" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3935">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3936">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-480-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-480">\frac{1}{3}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3937"><span class="MJXp-mfrac" id="MJXp-Span-3938" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3939">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3940">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-481-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-481">\frac{1}{3}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) less than 1. This means that they will not be able to completely fill the column and we need some other probability to fill the rest. </font><font style="vertical-align: inherit;">Let's take one of the two (let's say yellow) and put it in the appropriate column:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/76f/fd3/3df/76ffd33dff2e03fda8aee94a660aadb7.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we need to somehow cover the difference at the top of the column. </font><font style="vertical-align: inherit;">To do this, we note that two rectangles that are not yet distributed have a height greater than 1 (namely</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3941"><span class="MJXp-mn" id="MJXp-Span-3942">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-482-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-482">2</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3943"><span class="MJXp-mfrac" id="MJXp-Span-3944" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3945">4</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3946">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-483-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-483">\frac{4}{3}</script>  ).<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's choose one of them arbitrarily; </font><font style="vertical-align: inherit;">let it be</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3947"><span class="MJXp-mfrac" id="MJXp-Span-3948" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3949">4</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3950">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-484-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-484">\frac{4}{3}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then we distribute enough of the </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3951"><span class="MJXp-mfrac" id="MJXp-Span-3952" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3953">4</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3954">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-485-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-485">\frac{4}{3}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in a column to fill it completely; </font><font style="vertical-align: inherit;">as a result we will engage</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3955"><span class="MJXp-mfrac" id="MJXp-Span-3956" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3957">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3958">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-486-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-486">\frac{2}{3}</script>  of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3959"><span class="MJXp-mfrac" id="MJXp-Span-3960" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3961">4</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3962">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-487-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-487">\frac{4}{3}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as shown below: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36f/449/bcd/36f449bcd597466068133d6925c9a6e0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let's see what our scheme looks like. </font><font style="vertical-align: inherit;">We have three rectangles whose total area is equal to</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3963"><span class="MJXp-mn" id="MJXp-Span-3964">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-488-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-488">3</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and three free columns, that is, it seems that these rectangles can be distributed among these three columns. </font><font style="vertical-align: inherit;">To do this, we use the same trick as before. </font><font style="vertical-align: inherit;">Note that there is at least one rectangle whose height is less than</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3965"><span class="MJXp-mn" id="MJXp-Span-3966">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-489-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-489"> 1 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> so we will choose one of an arbitrary way (say, a rectangle </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3967"><span class="MJXp-mfrac" id="MJXp-Span-3968" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3969">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3970">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-490-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-490">\frac{2}{3}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) and put it in your column: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ee/600/13c/4ee60013c33f295c4632c540341453cc.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we need to fill the column to the end, so we take some probability that is not less than 1, and use it to supplement the rest of the column. </font><font style="vertical-align: inherit;">Here we only have one option (use</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3971"><span class="MJXp-mn" id="MJXp-Span-3972">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-491-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-491">2</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), so we take </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3973"><span class="MJXp-mfrac" id="MJXp-Span-3974" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3975">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3976">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-492-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-492">\frac{1}{3}</script>  of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3977"><span class="MJXp-mn" id="MJXp-Span-3978">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-493-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-493">2</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and put it in the upper part of the column: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02f/e49/48e/02fe4948ea264063563e891f6766aa81.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now everything has been reduced to two rectangles, the total area of ‚Äã‚Äãwhich is two. </font><font style="vertical-align: inherit;">We repeat this process by finding some rectangle whose height is no more than 1 (here it is</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3979"><span class="MJXp-mfrac" id="MJXp-Span-3980" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3981">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3982">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-494-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-494">\frac{1}{3}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), and placing it in this column: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dd8/4d8/cce/dd84d8cced28b8c5bdc4b6ca777aef95.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now we will find some rectangle no less than </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3983"><span class="MJXp-mn" id="MJXp-Span-3984">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-495-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-495"> 1 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to complete the column. </font><font style="vertical-align: inherit;">The only option for us is</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3985"><span class="MJXp-mfrac" id="MJXp-Span-3986" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3987">5</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3988">3</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-496-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-496">\frac{5}{3}</script>  : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a63/baa/46f/a63baa46ff38d1caa32373725d9c0489.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now we have only one rectangle left, and its area is 1. Therefore, we can simply complete the creation by placing this rectangle in its own column: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/add/c81/70c/addc8170c52dec7f548b51bf80a4273c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And voila! </font><font style="vertical-align: inherit;">We have filled the table. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note that the general pattern underlies the design of this table:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Find some rectangle whose height is not greater than 1, and place it in its own column, specifying in the table </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3990">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3991">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3992">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3993">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-497-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-497">Prob</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the height of this rectangle. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Find some rectangle whose height is not less than 1, use it to fill the column, setting the table </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3995">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3996">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3997">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3998">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3999">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-498-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-498">Alias</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> matching the face of the bone that this rectangle represents. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is it possible to prove that such a construction is always possible in the general case? </font><font style="vertical-align: inherit;">That is, that we are not ‚Äústuck‚Äù by distributing probabilities in this way? </font><font style="vertical-align: inherit;">Fortunately, there is evidence. </font><font style="vertical-align: inherit;">This can be explained as follows: we scaled all probabilities so that the average value of the new probabilities is 1 (since initially it was equal to</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4000"><span class="MJXp-mfrac" id="MJXp-Span-4001" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-4002">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4003">n</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-499-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-499">\frac{1}{n}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and we multiplied by </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4005">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-500-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-500"> n </script>  ).<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We know that the minimum of all scaled probabilities should be no more than an average, and that the maximum of all scaled probabilities should be no less than an average, so when we first start from here, we should always have at least one element not more than 1 (namely the smallest of all scaled probabilities) and one element not less than 1 (namely, the largest of scaled probabilities). Therefore, we can pair these elements together. But what happens if we remove them both? When we do this, as a result, we will remove one probability from the total and reduce the total amount of scaled probabilities by one. This means that the new average has not changed, because the average scaled probability is equal. We can repeat this procedure again and again,until we finally pair up all the elements.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We can formalize this reasoning in the following theorem: </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Theorem:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> if available</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4007">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-501-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-501"> k </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> unit width rectangles with heights </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4008"><span class="MJXp-msubsup" id="MJXp-Span-4009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4010" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4011" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-502-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-502">h_0</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4012"><span class="MJXp-msubsup" id="MJXp-Span-4013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4014" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4015" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-503-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-503">h_1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ..., </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4016"><span class="MJXp-msubsup" id="MJXp-Span-4017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4018" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4019" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4020">k</span><span class="MJXp-mo" id="MJXp-Span-4021">‚àí</span><span class="MJXp-mn" id="MJXp-Span-4022">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-504-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-504">h_{k-1}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> such that </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4023"><span class="MJXp-msubsup" id="MJXp-Span-4024"><span class="MJXp-mo" id="MJXp-Span-4025" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4031">k</span><span class="MJXp-mo" id="MJXp-Span-4032">‚àí</span><span class="MJXp-mn" id="MJXp-Span-4033">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4027">i</span><span class="MJXp-mo" id="MJXp-Span-4028">=</span><span class="MJXp-mn" id="MJXp-Span-4029">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4034"><span class="MJXp-msubsup" id="MJXp-Span-4035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4036" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4037" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-4038" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4039">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-505-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-505">\sum_{i=0}^{k-1}{h_i} = k</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> there is always a way to separate the rectangles and distribute them in </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4041">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-506-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-506"> k </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> columns, each of which has a height of 1, so that each column will contain no more than two different rectangles, and in </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4043">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-507-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-507"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - this column will contain at least one part </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4045">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-508-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-508"> i </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of that rectangle. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proof:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by induction. </font><font style="vertical-align: inherit;">In the base case, if</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4047">k</span><span class="MJXp-mo" id="MJXp-Span-4048" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4049">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-509-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-509">k = 1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then we have only one rectangle and its height should be equal to 1. Therefore, we can put it in </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4050"><span class="MJXp-mn" id="MJXp-Span-4051">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-510-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-510"> 0 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">th column. </font><font style="vertical-align: inherit;">Consequently, each column has a height of 1, contains no more than two rectangles, and in</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4052"><span class="MJXp-mn" id="MJXp-Span-4053">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-511-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-511"> 0 </script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - this column contains at least one part </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4054"><span class="MJXp-mn" id="MJXp-Span-4055">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-512-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-512"> 0 </script> - . <br><br>    ,   -   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4057">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-513-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-513"> k </script>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4059">k</span><span class="MJXp-mo" id="MJXp-Span-4060" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4061">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-514-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-514">k + 1</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4062"><span class="MJXp-mn" id="MJXp-Span-4063">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-515-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-515"> 1 </script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4064"><span class="MJXp-msubsup" id="MJXp-Span-4065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4066" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4067" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-516-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-516">h_0</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4068"><span class="MJXp-msubsup" id="MJXp-Span-4069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4070" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4071" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-517-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-517">h_1</script> , ..., <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4072"><span class="MJXp-msubsup" id="MJXp-Span-4073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4074" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-4075" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4076">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-518-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-518">h_{k}</script> , ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4077"><span class="MJXp-msubsup" id="MJXp-Span-4078"><span class="MJXp-mo" id="MJXp-Span-4079" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4085">k</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4081">i</span><span class="MJXp-mo" id="MJXp-Span-4082">=</span><span class="MJXp-mn" id="MJXp-Span-4083">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4086"><span class="MJXp-msubsup" id="MJXp-Span-4087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4088" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4089" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-4090" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4091">k</span><span class="MJXp-mo" id="MJXp-Span-4092" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4093">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-519-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-519">\sum_{i = 0}^{k}{h_i} = k + 1</script>  .   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4094"><span class="MJXp-msubsup" id="MJXp-Span-4095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4096" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4097" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-520-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-520">h_l</script> , ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4098"><span class="MJXp-msubsup" id="MJXp-Span-4099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4100" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4101" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-4102" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mn" id="MJXp-Span-4103">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-521-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-521">h_l \le 1</script> ,  -   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4104"><span class="MJXp-msubsup" id="MJXp-Span-4105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4106" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4107" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-522-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-522">h_g</script> (,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4109">l</span><span class="MJXp-mo" id="MJXp-Span-4110" style="margin-left: 0.333em; margin-right: 0.333em;">‚â†</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4111">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-523-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-523">l \ne g</script> ), ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4112"><span class="MJXp-msubsup" id="MJXp-Span-4113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4114" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4115" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4116" style="margin-left: 0.333em; margin-right: 0.333em;">‚â•</span><span class="MJXp-mn" id="MJXp-Span-4117">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-524-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-524">h_g \ge 1</script>  .    ,     ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4118"><span class="MJXp-msubsup" id="MJXp-Span-4119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4120" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4121" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-525-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-525">h_l</script>  with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4122"><span class="MJXp-msubsup" id="MJXp-Span-4123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4124" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4125" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-4126" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mn" id="MJXp-Span-4127">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-526-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-526">h_l \le 1</script>  ;   ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4128"><span class="MJXp-msubsup" id="MJXp-Span-4129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4130" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4131" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-4132" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-4133">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-527-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-527">h_i > 1</script>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4135">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-528-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-528"> i </script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4136"><span class="MJXp-mn" id="MJXp-Span-4137">0</span><span class="MJXp-mo" id="MJXp-Span-4138" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4139">i</span><span class="MJXp-mo" id="MJXp-Span-4140" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4141">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-529-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-529">0 \le i \le k</script>  .     ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4143">k</span><span class="MJXp-mo" id="MJXp-Span-4144" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4145">1</span><span class="MJXp-mo" id="MJXp-Span-4146" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4147"><span class="MJXp-mo" id="MJXp-Span-4148" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4153">k</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4150">i</span><span class="MJXp-mo" id="MJXp-Span-4151">=</span><span class="MJXp-mn" id="MJXp-Span-4152">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4154"><span class="MJXp-msubsup" id="MJXp-Span-4155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4156" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4157" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-4158" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-4159"><span class="MJXp-mo" id="MJXp-Span-4160" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4165">k</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4162">i</span><span class="MJXp-mo" id="MJXp-Span-4163">=</span><span class="MJXp-mn" id="MJXp-Span-4164">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4166"><span class="MJXp-mn" id="MJXp-Span-4167">1</span></span><span class="MJXp-mo" id="MJXp-Span-4168" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4169">k</span><span class="MJXp-mo" id="MJXp-Span-4170" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4171">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-530-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-530">k + 1 = \sum_{i = 0}^k{h_i} > \sum_{i=0}^k{1} = k + 1</script> ,   . ,  -  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4173">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-531-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-531"> l </script> , ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4174"><span class="MJXp-msubsup" id="MJXp-Span-4175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4176" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4177" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-4178" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mn" id="MJXp-Span-4179">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-532-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-532">h_l \le 1</script>  .       ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4180"><span class="MJXp-msubsup" id="MJXp-Span-4181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4182" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4183" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-533-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-533">h_g</script> ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4185">l</span><span class="MJXp-mo" id="MJXp-Span-4186" style="margin-left: 0.333em; margin-right: 0.333em;">‚â†</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4187">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-534-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-534">l \ne g</script> ), ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4188"><span class="MJXp-msubsup" id="MJXp-Span-4189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4190" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4191" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4192" style="margin-left: 0.333em; margin-right: 0.333em;">‚â•</span><span class="MJXp-mn" id="MJXp-Span-4193">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-535-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-535">h_g \ge 1</script>  .    ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4194"><span class="MJXp-msubsup" id="MJXp-Span-4195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4196" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4197" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4198" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-4199">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-536-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-536">h_g < 1</script> ,   (  ) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4200"><span class="MJXp-msubsup" id="MJXp-Span-4201"><span class="MJXp-mo" id="MJXp-Span-4202" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-4207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4208">k</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4204">i</span><span class="MJXp-mo" id="MJXp-Span-4205">=</span><span class="MJXp-mn" id="MJXp-Span-4206">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4209"><span class="MJXp-msubsup" id="MJXp-Span-4210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4211" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4212" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-4213" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4214">k</span><span class="MJXp-mo" id="MJXp-Span-4215" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4216">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-537-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-537">\sum_{i=0}^{k}{h_i} < k + 1</script>     . , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4217"><span class="MJXp-msubsup" id="MJXp-Span-4218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4219" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4220" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-4221" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mn" id="MJXp-Span-4222">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-538-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-538">h_l \le 1</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4223"><span class="MJXp-msubsup" id="MJXp-Span-4224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4225" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4226" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4227" style="margin-left: 0.333em; margin-right: 0.333em;">‚â•</span><span class="MJXp-mn" id="MJXp-Span-4228">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-539-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-539">h_g \ge 1</script>  . <br><br>    .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4229"><span class="MJXp-msubsup" id="MJXp-Span-4230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4231" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4232" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-540-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-540">h_l</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4234">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-541-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-541"> l </script>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4235"><span class="MJXp-mn" id="MJXp-Span-4236">1</span><span class="MJXp-mo" id="MJXp-Span-4237" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-4238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4239" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4240" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-542-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-542">1 - h_l</script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4242">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-543-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-543"> l </script> -    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4243"><span class="MJXp-msubsup" id="MJXp-Span-4244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4245" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4246" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-544-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-544">h_g</script> (   ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4247"><span class="MJXp-mn" id="MJXp-Span-4248">0</span><span class="MJXp-mo" id="MJXp-Span-4249" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mn" id="MJXp-Span-4250">1</span><span class="MJXp-mo" id="MJXp-Span-4251" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-4252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4253" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4254" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-4255" style="margin-left: 0.333em; margin-right: 0.333em;">‚â§</span><span class="MJXp-mn" id="MJXp-Span-4256">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-545-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-545">0 \le 1 - h_l \le 1</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4257"><span class="MJXp-msubsup" id="MJXp-Span-4258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4259" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4260" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4261" style="margin-left: 0.333em; margin-right: 0.333em;">‚â•</span><span class="MJXp-mn" id="MJXp-Span-4262">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-546-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-546">h_g \ge 1</script>  ).     .       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4264">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-547-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-547"> k </script>   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4266">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-548-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-548"> k </script> ,        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4267"><span class="MJXp-mn" id="MJXp-Span-4268">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-549-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-549"> 1 </script> ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4270">k</span><span class="MJXp-mo" id="MJXp-Span-4271" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-4272">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-550-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-550">k + 1</script>  .  ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4274">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-551-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-551"> l </script> ,           . ,   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4276">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-552-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-552"> k </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4278">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-553-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-553"> k </script>  ,      .     ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4280">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-554-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-554"> l </script> ,  ,        ,    .    . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a proof of the possibility of construction, which states that not only can we always build the alias table, but also that the above search algorithm of height is not greater than one and its combination with a rectangle not less than one is always successful. </font><font style="vertical-align: inherit;">From this we can begin to derive more and more complex algorithms for computing alias tables.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Generating Alias ‚Äã‚ÄãTables </font></font></h2><br>  Using the above, we can get a fairly good algorithm for simulating throws of a cheat bone using the alias method.  Initialization consists in a repeated scanning of incoming probabilities to find a value of no more than 1 and a value of no less than 1, followed by combining them into a pair to fill the column: <br><br><blockquote><h4>  Algorithm: the naive Alias-method </h4><br><ul><li>  <b>Initialization</b> : <br><ol><li>  Multiply each probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4281"><span class="MJXp-msubsup" id="MJXp-Span-4282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4283" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4284" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-555-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-555"> p_i </script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4286">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-556-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-556"> n </script>  . </li><li>  Create arrays <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4288">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4289">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4290">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4291">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4292">s</span><span class="MJXp-mo" id="MJXp-Span-4293" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4294" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-557-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-557"> Alias ‚Äã‚Äã</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4296">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4297">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4298">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4299">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-558-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-558"> Prob </script>  each having a size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4301">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-559-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-559"> n </script>  . </li><li>  For <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4303">j</span><span class="MJXp-mo" id="MJXp-Span-4304" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4305">1</span><span class="MJXp-mtext" id="MJXp-Span-4306">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4307">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4308">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4309">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4310">x</span><span class="MJXp-mrow" id="MJXp-Span-4311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4312">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4313">o</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4314">n</span><span class="MJXp-mo" id="MJXp-Span-4315" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-4316">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-560-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-560"> j = 1 \ mbox {to} n - 1 </script>  : <br><ol><li>  Find the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4317"><span class="MJXp-msubsup" id="MJXp-Span-4318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4319" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4320" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-561-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-561"> p_l </script>  satisfying the condition <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4321"><span class="MJXp-msubsup" id="MJXp-Span-4322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4323" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4324" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mtext" id="MJXp-Span-4325">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4326">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4327">e</span><span class="MJXp-mn" id="MJXp-Span-4328">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-562-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-562"> p_l \ le 1 </script>  . </li><li>  Find the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4329"><span class="MJXp-msubsup" id="MJXp-Span-4330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4331" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4332" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-563-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-563"> p_g </script>  (with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4334">l</span><span class="MJXp-mtext" id="MJXp-Span-4335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4336">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4337">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4338">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-564-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-564"> l \ ne g </script>  ) satisfying the condition <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4339"><span class="MJXp-msubsup" id="MJXp-Span-4340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4341" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4342" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mtext" id="MJXp-Span-4343">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4344">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4345">e</span><span class="MJXp-mn" id="MJXp-Span-4346">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-565-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-565"> p_g \ ge 1 </script></li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4348">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4349">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4350">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4351">b</span><span class="MJXp-mo" id="MJXp-Span-4352" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4353">l</span><span class="MJXp-mo" id="MJXp-Span-4354" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-4355" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4357" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4358" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-566-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-566"> Prob [l] = p_l </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4360">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4361">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4362">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4363">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4364">s</span><span class="MJXp-mo" id="MJXp-Span-4365" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4366" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4367" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4368">l</span><span class="MJXp-mo" id="MJXp-Span-4369" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-4370" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4371">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-567-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-567"> Alias ‚Äã‚Äã[l] = g </script>  . </li><li>  Delete <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4372"><span class="MJXp-msubsup" id="MJXp-Span-4373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4374" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4375" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-568-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-568"> p_l </script>  from the list of initial probabilities. </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4376"><span class="MJXp-msubsup" id="MJXp-Span-4377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4378" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4379" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4380" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-4381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4382" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4383" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4384" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-4385" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4386">1</span><span class="MJXp-mo" id="MJXp-Span-4387" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-4388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4389" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4390" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-4391" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-569-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-569"> p_g: = p_g - (1 - p_l) </script>  . </li></ol><br></li><li>  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4393">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-570-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-570"> i </script>  will be the last remaining probability, which should have a height of 1. </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4395">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4396">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4397">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4398">b</span><span class="MJXp-mo" id="MJXp-Span-4399" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4400">i</span><span class="MJXp-mo" id="MJXp-Span-4401" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-4402" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4403">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-571-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-571"> Prob [i] = 1 </script>  . </li></ol><br></li><li>  <b>Generation</b> : <br><ol><li>  We generate a roll of honest bones from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4405">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-572-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-572"> n </script>  - bone;  call the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4407">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-573-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-573"> i </script>  . </li><li>  We throw an asymmetrical coin, dropped by an eagle with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4409">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4410">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4411">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4412">b</span><span class="MJXp-mo" id="MJXp-Span-4413" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4414">i</span><span class="MJXp-mo" id="MJXp-Span-4415" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-574-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-574"> Prob [i] </script>  . </li><li>  If an eagle falls on a coin, we return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4417">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-575-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-575"> i </script>  . </li><li>  Otherwise, return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4419">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4420">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4421">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4422">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4423">s</span><span class="MJXp-mo" id="MJXp-Span-4424" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4425" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4426" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4427">i</span><span class="MJXp-mo" id="MJXp-Span-4428" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-576-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-576"> Alias ‚Äã‚Äã[i] </script>  . </li></ol></li></ul></blockquote><br>  The step of generating this algorithm is exactly the same as the method described above, and is performed in time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4429"><span class="MJXp-mtext" id="MJXp-Span-4430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4431">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4432">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4433">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4434">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4435">a</span><span class="MJXp-mo" id="MJXp-Span-4436" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4437">1</span><span class="MJXp-mo" id="MJXp-Span-4438" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-577-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-577"> \ Theta (1) </script>  .  The initialization step requires the multiple iterations described above.  First, we need to spend time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4439"><span class="MJXp-mtext" id="MJXp-Span-4440">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4441">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4442">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4443">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4444">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4445">a</span><span class="MJXp-mo" id="MJXp-Span-4446" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4447">n</span><span class="MJXp-mo" id="MJXp-Span-4448" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-578-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-578"> \ Theta (n) </script>  to scale each probability by a factor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4450">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-579-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-579"> n </script>  and spend time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4452">O</span><span class="MJXp-mo" id="MJXp-Span-4453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4454">n</span><span class="MJXp-mo" id="MJXp-Span-4455" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-580-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-580"> O (n) </script>  on the allocation of two arrays.  The inner loop is running <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4456"><span class="MJXp-mtext" id="MJXp-Span-4457">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4458">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4459">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4460">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4461">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4462">a</span><span class="MJXp-mo" id="MJXp-Span-4463" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4464">n</span><span class="MJXp-mo" id="MJXp-Span-4465" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-581-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-581"> \ Theta (n) </script>  times, and with each iteration does the work <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4467">O</span><span class="MJXp-mo" id="MJXp-Span-4468" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4469">n</span><span class="MJXp-mo" id="MJXp-Span-4470" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-582-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-582"> O (n) </script>  by scanning the array, removing one of the elements of the array and updating the probabilities.  It gives us time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4472">O</span><span class="MJXp-mo" id="MJXp-Span-4473" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4475" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4476" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4477" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-583-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-583"> O (n ^ 2) </script>  common initialization.  If we consider this algorithm in context, then we get the following: <br><br><table><tbody><tr><th>  Algorithm </th><th colspan="2">  Initialization time </th><th colspan="2">  Generation time </th><th colspan="2">  Busy memory </th></tr><tr><th></th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th></tr><tr><td>  Honest bone cheat bone </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4478"><span class="MJXp-mtext" id="MJXp-Span-4479">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4480">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4481">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4482">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4483">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4484">a</span><span class="MJXp-mo" id="MJXp-Span-4485" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4486">n</span><span class="MJXp-mo" id="MJXp-Span-4487" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-584-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-584"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4489">O</span><span class="MJXp-mo" id="MJXp-Span-4490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4491">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4492">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4493">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4494">o</span><span class="MJXp-msubsup" id="MJXp-Span-4495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4496" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4501">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4498">i</span><span class="MJXp-mo" id="MJXp-Span-4499">=</span><span class="MJXp-mn" id="MJXp-Span-4500">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4502"><span class="MJXp-msubsup" id="MJXp-Span-4503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4504" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4505" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-4506" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-585-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-585"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4507"><span class="MJXp-mtext" id="MJXp-Span-4508">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4509">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4510">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4511">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4512">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4513">a</span><span class="MJXp-mo" id="MJXp-Span-4514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4515">1</span><span class="MJXp-mo" id="MJXp-Span-4516" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-586-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-586"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4517"><span class="MJXp-mtext" id="MJXp-Span-4518">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4519">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4520">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4521">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4522">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4523">a</span><span class="MJXp-mo" id="MJXp-Span-4524" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4525">n</span><span class="MJXp-mo" id="MJXp-Span-4526" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-587-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-587"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4528">O</span><span class="MJXp-mo" id="MJXp-Span-4529" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4531">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4532">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4533">o</span><span class="MJXp-msubsup" id="MJXp-Span-4534"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4535" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4540">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-4536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4537">i</span><span class="MJXp-mo" id="MJXp-Span-4538">=</span><span class="MJXp-mn" id="MJXp-Span-4539">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-4541"><span class="MJXp-msubsup" id="MJXp-Span-4542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4543" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4544" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-4545" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-588-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-588"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td></tr><tr><td>  Shuler bone from asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4546"><span class="MJXp-mtext" id="MJXp-Span-4547">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4548">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4549">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4550">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4551">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4552">a</span><span class="MJXp-mo" id="MJXp-Span-4553" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4554">n</span><span class="MJXp-mo" id="MJXp-Span-4555" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-589-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-589"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4556"><span class="MJXp-mtext" id="MJXp-Span-4557">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4558">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4559">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4560">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4561">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4562">a</span><span class="MJXp-mo" id="MJXp-Span-4563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4564">1</span><span class="MJXp-mo" id="MJXp-Span-4565" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-590-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-590"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4566"><span class="MJXp-mtext" id="MJXp-Span-4567">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4568">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4569">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4570">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4571">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4572">a</span><span class="MJXp-mo" id="MJXp-Span-4573" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4574">n</span><span class="MJXp-mo" id="MJXp-Span-4575" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-591-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-591"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4576"><span class="MJXp-mtext" id="MJXp-Span-4577">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4578">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4579">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4580">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4581">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4582">a</span><span class="MJXp-mo" id="MJXp-Span-4583" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4584">n</span><span class="MJXp-mo" id="MJXp-Span-4585" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-592-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-592"> \ Theta (n) </script></td></tr><tr><td>  Selection by the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4586"><span class="MJXp-mtext" id="MJXp-Span-4587">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4588">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4589">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4590">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4591">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4592">a</span><span class="MJXp-mo" id="MJXp-Span-4593" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4594">n</span><span class="MJXp-mo" id="MJXp-Span-4595" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-593-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-593"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4596"><span class="MJXp-mtext" id="MJXp-Span-4597">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4598">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4599">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4600">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4601">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4602">a</span><span class="MJXp-mo" id="MJXp-Span-4603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4604">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4605">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4606">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4607">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4608">n</span><span class="MJXp-mo" id="MJXp-Span-4609" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-594-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-594"> \ Theta (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4610"><span class="MJXp-mtext" id="MJXp-Span-4611">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4612">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4613">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4614">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4615">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4616">a</span><span class="MJXp-mo" id="MJXp-Span-4617" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4618">n</span><span class="MJXp-mo" id="MJXp-Span-4619" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-595-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-595"> \ Theta (n) </script></td></tr><tr><td>  The optimal choice of the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4621">O</span><span class="MJXp-mo" id="MJXp-Span-4622" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4624" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4625" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4626" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-596-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-596"> O (n ^ 2) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4627"><span class="MJXp-mtext" id="MJXp-Span-4628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4629">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4630">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4631">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4632">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4633">a</span><span class="MJXp-mo" id="MJXp-Span-4634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4635">1</span><span class="MJXp-mo" id="MJXp-Span-4636" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-597-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-597"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4638">O</span><span class="MJXp-mo" id="MJXp-Span-4639" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4640">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4641">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4642">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4643">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4644">n</span><span class="MJXp-mo" id="MJXp-Span-4645" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-598-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-598"> O (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4646"><span class="MJXp-mtext" id="MJXp-Span-4647">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4648">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4649">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4650">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4651">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4652">a</span><span class="MJXp-mo" id="MJXp-Span-4653" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4654">n</span><span class="MJXp-mo" id="MJXp-Span-4655" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-599-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-599"> \ Theta (n) </script></td></tr><tr><td>  Cheat bone of honest bones / asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4656"><span class="MJXp-mtext" id="MJXp-Span-4657">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4658">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4659">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4660">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4661">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4662">a</span><span class="MJXp-mo" id="MJXp-Span-4663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4664">n</span><span class="MJXp-mo" id="MJXp-Span-4665" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-600-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-600"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4666"><span class="MJXp-mtext" id="MJXp-Span-4667">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4668">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4669">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4670">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4671">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4672">a</span><span class="MJXp-mo" id="MJXp-Span-4673" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4674">1</span><span class="MJXp-mo" id="MJXp-Span-4675" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-601-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-601"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4676"><span class="MJXp-mtext" id="MJXp-Span-4677">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4678">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4679">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4680">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4681">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4682">a</span><span class="MJXp-mo" id="MJXp-Span-4683" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4684">n</span><span class="MJXp-mo" id="MJXp-Span-4685" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-602-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-602"> \ Theta (n) </script>  (expected) </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4686"><span class="MJXp-mtext" id="MJXp-Span-4687">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4688">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4689">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4690">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4691">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4692">a</span><span class="MJXp-mo" id="MJXp-Span-4693" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4694">n</span><span class="MJXp-mo" id="MJXp-Span-4695" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-603-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-603"> \ Theta (n) </script></td></tr><tr><td>  Naive Alias ‚Äã‚ÄãMethod </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4697">O</span><span class="MJXp-mo" id="MJXp-Span-4698" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-4699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4700" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-4701" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-4702" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-604-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-604"> O (n ^ 2) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4703"><span class="MJXp-mtext" id="MJXp-Span-4704">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4705">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4706">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4707">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4708">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4709">a</span><span class="MJXp-mo" id="MJXp-Span-4710" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4711">1</span><span class="MJXp-mo" id="MJXp-Span-4712" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-605-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-605"> \ Theta (1) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4713"><span class="MJXp-mtext" id="MJXp-Span-4714">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4715">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4716">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4717">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4718">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4719">a</span><span class="MJXp-mo" id="MJXp-Span-4720" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4721">n</span><span class="MJXp-mo" id="MJXp-Span-4722" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-606-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-606"> \ Theta (n) </script></td></tr></tbody></table><br>  Compared to other effective simulation methods, this naive alias method has high initialization costs, but then can simulate bone rolls extremely effectively.  If we could somehow reduce the cost of initialization (say, up to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4724">O</span><span class="MJXp-mo" id="MJXp-Span-4725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4726">n</span><span class="MJXp-mo" id="MJXp-Span-4727" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-607-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-607"> O (n) </script>  ), then this method would definitely be better than all the techniques used here. <br><br>  One simple way to reduce initialization costs is to use a more appropriate data structure to maintain heights during execution.  In the naive version, we use an unsorted array to store all probabilities, that is, it takes time to find the two probabilities we need. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4729">O</span><span class="MJXp-mo" id="MJXp-Span-4730" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4731">n</span><span class="MJXp-mo" id="MJXp-Span-4732" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-608-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-608"> O (n) </script>  .  A more suitable alternative for storing values ‚Äã‚Äãwould be a balanced binary search tree.  In this case, we can find the values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4733"><span class="MJXp-msubsup" id="MJXp-Span-4734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4735" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4736" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-609-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-609"> p_g </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4737"><span class="MJXp-msubsup" id="MJXp-Span-4738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4739" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4740" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-610-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-610"> p_l </script>  during <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4742">O</span><span class="MJXp-mo" id="MJXp-Span-4743" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4744">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4745">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4746">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4747">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4748">n</span><span class="MJXp-mo" id="MJXp-Span-4749" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-611-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-611"> O (\ log n) </script>  by searching for the maximum and minimum values ‚Äã‚Äãof the tree.  Deletion <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4750"><span class="MJXp-msubsup" id="MJXp-Span-4751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4752" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4753" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-612-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-612"> p_l </script>  can be done in time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4755">O</span><span class="MJXp-mo" id="MJXp-Span-4756" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4757">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4758">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4759">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4760">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4761">n</span><span class="MJXp-mo" id="MJXp-Span-4762" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-613-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-613"> O (\ log n) </script>  , and the probability update <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4763"><span class="MJXp-msubsup" id="MJXp-Span-4764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4765" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4766" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-614-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-614"> p_g </script>  can also be run for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4768">O</span><span class="MJXp-mo" id="MJXp-Span-4769" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4770">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4771">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4772">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4773">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4774">n</span><span class="MJXp-mo" id="MJXp-Span-4775" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-615-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-615"> O (\ log n) </script>  thanks to its simple removal from the tree, followed by re-insertion.  This gives us the following algorithm: <br><br><blockquote><h4>  Algorithm: Alias-method </h4><br><ul><li>  <b>Initialization</b> : <br><ol><li>  Create arrays <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4777">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4778">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4779">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4780">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4781">s</span><span class="MJXp-mo" id="MJXp-Span-4782" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4783" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-616-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-616"> Alias ‚Äã‚Äã</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4785">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4786">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4787">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4788">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-617-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-617"> Prob </script>  each size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4790">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-618-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-618"> n </script>  . </li><li>  Create a balanced binary search tree <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4792">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-619-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-619"> T </script>  . </li><li>  We insert <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4794">n</span><span class="MJXp-mtext" id="MJXp-Span-4795">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4796">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4797">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4798">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4799">t</span><span class="MJXp-msubsup" id="MJXp-Span-4800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4801" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4802" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-620-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-620"> n \ cdot p_i </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4804">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-621-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-621"> T </script>  for every probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4806">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-622-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-622"> i </script>  . </li><li>  For <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4808">j</span><span class="MJXp-mo" id="MJXp-Span-4809" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4810">1</span><span class="MJXp-mtext" id="MJXp-Span-4811">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4812">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4813">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4814">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4815">x</span><span class="MJXp-mrow" id="MJXp-Span-4816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4817">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4818">o</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4819">n</span><span class="MJXp-mo" id="MJXp-Span-4820" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-4821">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-623-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-623"> j = 1 \ mbox {to} n - 1 </script>  : <br><ol><li>  Find and delete the smallest value in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4823">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-624-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-624"> T </script>  ;  let's call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4824"><span class="MJXp-msubsup" id="MJXp-Span-4825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4826" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4827" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-625-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-625"> p_l </script>  . </li><li>  Find and delete the highest value in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4829">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-626-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-626"> T </script>  ;  let's call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4830"><span class="MJXp-msubsup" id="MJXp-Span-4831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4832" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4833" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-627-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-627"> p_g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4835">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4836">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4837">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4838">b</span><span class="MJXp-mo" id="MJXp-Span-4839" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4840">l</span><span class="MJXp-mo" id="MJXp-Span-4841" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-4842" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-4843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4844" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4845" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-628-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-628"> Prob [l] = p_l </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4847">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4848">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4849">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4850">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4851">s</span><span class="MJXp-mo" id="MJXp-Span-4852" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4853" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4854" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4855">l</span><span class="MJXp-mo" id="MJXp-Span-4856" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-4857" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4858">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-629-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-629"> Alias ‚Äã‚Äã[l] = g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4859"><span class="MJXp-msubsup" id="MJXp-Span-4860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4861" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4862" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4863" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-4864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4865" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4866" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-4867" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-4868" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-4869">1</span><span class="MJXp-mo" id="MJXp-Span-4870" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-4871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4872" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4873" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-4874" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-630-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-630"> p_g: = p_g - (1 - p_l) </script>  . </li><li>  Add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4875"><span class="MJXp-msubsup" id="MJXp-Span-4876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4877" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4878" style="vertical-align: -0.4em;">g</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-631-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-631"> p_g </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4880">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-632-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-632"> T </script>  . </li></ol><br></li><li>  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4882">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-633-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-633"> i </script>  will be the last remaining probability, which should have a weight of 1. </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4884">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4885">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4886">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4887">b</span><span class="MJXp-mo" id="MJXp-Span-4888" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4889">i</span><span class="MJXp-mo" id="MJXp-Span-4890" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-4891" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-4892">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-634-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-634"> Prob [i] = 1 </script>  . </li></ol><br></li><li>  <b>Generation</b> : <br><ol><li>  We generate a roll of honest bones from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4894">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-635-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-635"> n </script>  - bone;  call the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4896">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-636-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-636"> i </script>  . </li><li>  We throw an asymmetrical coin, on which an eagle falls on it with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4898">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4899">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4900">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4901">b</span><span class="MJXp-mo" id="MJXp-Span-4902" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4903">i</span><span class="MJXp-mo" id="MJXp-Span-4904" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-637-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-637"> Prob [i] </script>  . </li><li>  If an eagle falls on a coin, we return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4906">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-638-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-638"> i </script>  . </li><li>  Otherwise, return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4908">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4909">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4910">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4911">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4912">s</span><span class="MJXp-mo" id="MJXp-Span-4913" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4914" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4915" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4916">i</span><span class="MJXp-mo" id="MJXp-Span-4917" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-639-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-639"> Alias ‚Äã‚Äã[i] </script>  . </li></ol></li></ul></blockquote><br>  Now the initialization of our algorithm is much faster.  Creature <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4919">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4920">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4921">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4922">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4923">s</span><span class="MJXp-mo" id="MJXp-Span-4924" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-4925" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-640-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-640"> Alias ‚Äã‚Äã</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4926"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4927">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4928">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4929">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4930">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-641-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-641"> Prob </script>  still takes time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4932">O</span><span class="MJXp-mo" id="MJXp-Span-4933" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4934">n</span><span class="MJXp-mo" id="MJXp-Span-4935" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-642-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-642"> O (n) </script>  on each table, and adding probabilities to BST <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4937">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-643-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-643"> T </script>  takes time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4938"><span class="MJXp-mtext" id="MJXp-Span-4939">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4940">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4941">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4942">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4943">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4944">a</span><span class="MJXp-mo" id="MJXp-Span-4945" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4946">n</span><span class="MJXp-mtext" id="MJXp-Span-4947">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4948">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4949">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4950">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4951">n</span><span class="MJXp-mo" id="MJXp-Span-4952" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-644-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-644"> \ Theta (n \ log n) </script>  .  Next we perform <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4953"><span class="MJXp-mtext" id="MJXp-Span-4954">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4955">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4956">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4957">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4958">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4959">a</span><span class="MJXp-mo" id="MJXp-Span-4960" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4961">n</span><span class="MJXp-mo" id="MJXp-Span-4962" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-645-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-645"> \ Theta (n) </script>  iterations to fill the table, each of which takes time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4964">O</span><span class="MJXp-mo" id="MJXp-Span-4965" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4966">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4967">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4968">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4969">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4970">n</span><span class="MJXp-mo" id="MJXp-Span-4971" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-646-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-646"> O (\ log n) </script>  .  This gives us a total initialization time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4973">O</span><span class="MJXp-mo" id="MJXp-Span-4974" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4975">n</span><span class="MJXp-mtext" id="MJXp-Span-4976">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4977">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4978">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4979">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4980">n</span><span class="MJXp-mo" id="MJXp-Span-4981" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-647-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-647"> O (n \ log n) </script>  : <br><br><table><tbody><tr><th>  Algorithm </th><th colspan="2">  Initialization time </th><th colspan="2">  Generation time </th><th colspan="2">  Busy memory </th></tr><tr><th></th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th></tr><tr><td>  Honest bone cheat bone </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4982"><span class="MJXp-mtext" id="MJXp-Span-4983">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4984">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4985">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4986">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4987">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4988">a</span><span class="MJXp-mo" id="MJXp-Span-4989" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4990">n</span><span class="MJXp-mo" id="MJXp-Span-4991" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-648-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-648"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-4992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4993">O</span><span class="MJXp-mo" id="MJXp-Span-4994" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-4995">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4996">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4997">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4998">o</span><span class="MJXp-msubsup" id="MJXp-Span-4999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5000" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5005">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5002">i</span><span class="MJXp-mo" id="MJXp-Span-5003">=</span><span class="MJXp-mn" id="MJXp-Span-5004">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5006"><span class="MJXp-msubsup" id="MJXp-Span-5007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5008" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5009" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-5010" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-649-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-649"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5011"><span class="MJXp-mtext" id="MJXp-Span-5012">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5013">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5014">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5015">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5016">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5017">a</span><span class="MJXp-mo" id="MJXp-Span-5018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-5019">1</span><span class="MJXp-mo" id="MJXp-Span-5020" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-650-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-650"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5021"><span class="MJXp-mtext" id="MJXp-Span-5022">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5023">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5024">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5025">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5026">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5027">a</span><span class="MJXp-mo" id="MJXp-Span-5028" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5029">n</span><span class="MJXp-mo" id="MJXp-Span-5030" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-651-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-651"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5032">O</span><span class="MJXp-mo" id="MJXp-Span-5033" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-5034">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5035">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5036">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5037">o</span><span class="MJXp-msubsup" id="MJXp-Span-5038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5039" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5044">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-5040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5041">i</span><span class="MJXp-mo" id="MJXp-Span-5042">=</span><span class="MJXp-mn" id="MJXp-Span-5043">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-5045"><span class="MJXp-msubsup" id="MJXp-Span-5046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5047" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5048" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-5049" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-652-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-652"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td></tr><tr><td>  Shuler bone from asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5050"><span class="MJXp-mtext" id="MJXp-Span-5051">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5052">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5053">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5054">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5055">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5056">a</span><span class="MJXp-mo" id="MJXp-Span-5057" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5058">n</span><span class="MJXp-mo" id="MJXp-Span-5059" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-653-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-653"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5060"><span class="MJXp-mtext" id="MJXp-Span-5061">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5062">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5063">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5064">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5065">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5066">a</span><span class="MJXp-mo" id="MJXp-Span-5067" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-5068">1</span><span class="MJXp-mo" id="MJXp-Span-5069" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-654-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-654"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5070"><span class="MJXp-mtext" id="MJXp-Span-5071">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5072">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5073">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5074">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5075">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5076">a</span><span class="MJXp-mo" id="MJXp-Span-5077" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5078">n</span><span class="MJXp-mo" id="MJXp-Span-5079" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-655-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-655"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5080"><span class="MJXp-mtext" id="MJXp-Span-5081">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5082">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5083">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5084">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5085">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5086">a</span><span class="MJXp-mo" id="MJXp-Span-5087" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5088">n</span><span class="MJXp-mo" id="MJXp-Span-5089" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-656-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-656"> \ Theta (n) </script></td></tr><tr><td>  Selection by the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5090"><span class="MJXp-mtext" id="MJXp-Span-5091">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5092">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5093">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5094">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5095">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5096">a</span><span class="MJXp-mo" id="MJXp-Span-5097" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5098">n</span><span class="MJXp-mo" id="MJXp-Span-5099" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-657-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-657"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5100"><span class="MJXp-mtext" id="MJXp-Span-5101">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5102">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5103">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5104">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5105">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5106">a</span><span class="MJXp-mo" id="MJXp-Span-5107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-5108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5109">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5110">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5111">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5112">n</span><span class="MJXp-mo" id="MJXp-Span-5113" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-658-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-658"> \ Theta (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5114"><span class="MJXp-mtext" id="MJXp-Span-5115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5116">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5117">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5118">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5119">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5120">a</span><span class="MJXp-mo" id="MJXp-Span-5121" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5122">n</span><span class="MJXp-mo" id="MJXp-Span-5123" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-659-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-659"> \ Theta (n) </script></td></tr><tr><td>  The optimal choice of the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5125">O</span><span class="MJXp-mo" id="MJXp-Span-5126" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5128" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5129" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-5130" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-660-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-660"> O (n ^ 2) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5131"><span class="MJXp-mtext" id="MJXp-Span-5132">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5133">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5134">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5135">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5136">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5137">a</span><span class="MJXp-mo" id="MJXp-Span-5138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-5139">1</span><span class="MJXp-mo" id="MJXp-Span-5140" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-661-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-661"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5142">O</span><span class="MJXp-mo" id="MJXp-Span-5143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-5144">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5145">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5146">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5147">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5148">n</span><span class="MJXp-mo" id="MJXp-Span-5149" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-662-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-662"> O (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5150"><span class="MJXp-mtext" id="MJXp-Span-5151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5152">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5153">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5154">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5155">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5156">a</span><span class="MJXp-mo" id="MJXp-Span-5157" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5158">n</span><span class="MJXp-mo" id="MJXp-Span-5159" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-663-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-663"> \ Theta (n) </script></td></tr><tr><td>  Cheat bone of honest bones / asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5160"><span class="MJXp-mtext" id="MJXp-Span-5161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5162">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5163">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5164">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5165">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5166">a</span><span class="MJXp-mo" id="MJXp-Span-5167" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5168">n</span><span class="MJXp-mo" id="MJXp-Span-5169" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-664-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-664"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5170"><span class="MJXp-mtext" id="MJXp-Span-5171">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5172">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5173">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5174">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5175">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5176">a</span><span class="MJXp-mo" id="MJXp-Span-5177" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-5178">1</span><span class="MJXp-mo" id="MJXp-Span-5179" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-665-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-665"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5180"><span class="MJXp-mtext" id="MJXp-Span-5181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5182">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5183">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5184">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5185">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5186">a</span><span class="MJXp-mo" id="MJXp-Span-5187" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5188">n</span><span class="MJXp-mo" id="MJXp-Span-5189" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-666-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-666"> \ Theta (n) </script>  (expected) </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5190"><span class="MJXp-mtext" id="MJXp-Span-5191">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5192">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5193">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5194">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5195">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5196">a</span><span class="MJXp-mo" id="MJXp-Span-5197" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5198">n</span><span class="MJXp-mo" id="MJXp-Span-5199" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-667-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-667"> \ Theta (n) </script></td></tr><tr><td>  Naive Alias ‚Äã‚ÄãMethod </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5201">O</span><span class="MJXp-mo" id="MJXp-Span-5202" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5204" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-5205" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-5206" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-668-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-668"> O (n ^ 2) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5207"><span class="MJXp-mtext" id="MJXp-Span-5208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5209">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5210">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5211">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5212">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5213">a</span><span class="MJXp-mo" id="MJXp-Span-5214" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-5215">1</span><span class="MJXp-mo" id="MJXp-Span-5216" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-669-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-669"> \ Theta (1) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5217"><span class="MJXp-mtext" id="MJXp-Span-5218">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5219">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5220">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5221">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5222">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5223">a</span><span class="MJXp-mo" id="MJXp-Span-5224" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5225">n</span><span class="MJXp-mo" id="MJXp-Span-5226" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-670-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-670"> \ Theta (n) </script></td></tr><tr><td>  Alias ‚Äã‚Äãmethod </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5228">O</span><span class="MJXp-mo" id="MJXp-Span-5229" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5230">n</span><span class="MJXp-mtext" id="MJXp-Span-5231">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5232">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5233">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5234">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5235">n</span><span class="MJXp-mo" id="MJXp-Span-5236" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-671-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-671"> O (n \ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5237"><span class="MJXp-mtext" id="MJXp-Span-5238">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5239">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5240">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5241">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5242">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5243">a</span><span class="MJXp-mo" id="MJXp-Span-5244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-5245">1</span><span class="MJXp-mo" id="MJXp-Span-5246" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-672-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-672"> \ Theta (1) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5247"><span class="MJXp-mtext" id="MJXp-Span-5248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5249">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5250">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5251">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5252">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5253">a</span><span class="MJXp-mo" id="MJXp-Span-5254" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5255">n</span><span class="MJXp-mo" id="MJXp-Span-5256" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-673-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-673"> \ Theta (n) </script></td></tr></tbody></table><br>  However, there is an algorithm that works even faster.  It is surprisingly simple, and is probably the purest of the alias-method implementation algorithms.  This algorithm was first described in the article <a href="http://web.eecs.utk.edu/~vose/Publications/random.pdf">"A Linear Algorithm For Generating Random Numbers With a Given Distribution" by</a> Michael Vouse, and became the standard algorithm for implementing the alias method. <br><br>  The basis of the Vouz algorithm is the use of two worklists: one contains elements with a height less than 1, the other contains elements with a height not less than 1. The algorithm constantly connects the first elements of each worklist in pairs.  At each iteration, we consume an element from the list of ‚Äúsmall‚Äù values, and potentially move the rest of the element from the list of ‚Äúlarge‚Äù values ‚Äã‚Äãto the list of ‚Äúsmall‚Äù.  This algorithm uses several invariants: <br><br><ul><li>  All items in the small work list are less than 1. </li><li>  All items in the ‚Äúlarge‚Äù worklist are at least 1. </li><li>  The sum of the items in the worklist is always equal to the total number of items. </li></ul><br>  For simplicity, each list stores not the probability itself, but a pointer to a list of initial probabilities, indicating which edge of the cheat bone is being referenced.  Having these invariants, we get the following algorithm: <br><br><blockquote><h4>  Algorithm: (unstable) Alias-vous method </h4><br><h4>  Warning: this algorithm is subject to numerical inaccuracies.  A more numerically stable algorithm is presented below. </h4><br><ul><li>  <b>Initialization</b> : <br><ol><li>  Create arrays <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5258">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5259">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5260">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5261">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5262">s</span><span class="MJXp-mo" id="MJXp-Span-5263" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5264" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-674-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-674"> Alias ‚Äã‚Äã</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5266">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5267">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5268">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5269">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-675-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-675"> Prob </script>  each size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5271">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-676-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-676"> n </script>  . </li><li>  Create two worklists, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5273">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5274">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5275">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5276">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5277">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-677-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-677"> Small </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5279">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5280">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5281">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5282">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5283">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-678-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-678"> Large </script>  . </li><li>  Multiply each probability by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5285">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-679-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-679"> n </script>  . </li><li>  For each scaled probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5286"><span class="MJXp-msubsup" id="MJXp-Span-5287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5288" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5289" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-680-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-680"> p_i </script>  : <br><ol><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5290"><span class="MJXp-msubsup" id="MJXp-Span-5291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5292" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5293" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-5294" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-5295">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-681-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-681"> p_i <1 </script>  add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5297">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-682-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-682"> i </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5299">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5300">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5301">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5302">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5303">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-683-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-683"> Small </script>  . </li><li>  Otherwise ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5304"><span class="MJXp-msubsup" id="MJXp-Span-5305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5306" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5307" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-5308">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5309">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5310">e</span><span class="MJXp-mn" id="MJXp-Span-5311">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-684-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-684"> p_i \ ge 1 </script>  ) add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5313">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-685-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-685"> i </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5315">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5317">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5318">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5319">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-686-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-686"> Large </script>  . </li></ol><br></li><li>  Bye list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5321">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5322">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5323">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5324">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5325">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-687-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-687"> Small </script>  not empty: <br><ol><li>  Remove the first item from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5327">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5328">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5329">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5330">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5331">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-688-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-688"> Small </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5333">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-689-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-689"> l </script>  . </li><li>  Remove the first item from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5335">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5336">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5337">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5338">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5339">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-690-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-690"> Large </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5341">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-691-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-691"> g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5343">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5344">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5345">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5346">b</span><span class="MJXp-mo" id="MJXp-Span-5347" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5348">l</span><span class="MJXp-mo" id="MJXp-Span-5349" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-5350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5352" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5353" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-692-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-692"> Prob [l] = p_l </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5355">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5356">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5357">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5358">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5359">s</span><span class="MJXp-mo" id="MJXp-Span-5360" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5361" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5362" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5363">l</span><span class="MJXp-mo" id="MJXp-Span-5364" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-5365" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5366">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-693-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-693"> Alias ‚Äã‚Äã[l] = g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5367"><span class="MJXp-msubsup" id="MJXp-Span-5368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5369" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5370" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5371" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-5372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5373" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5374" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5375" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-5376" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-5377">1</span><span class="MJXp-mo" id="MJXp-Span-5378" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-5379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5380" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5381" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-5382" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-694-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-694"> p_g: = p_g - (1 - p_l) </script>  . </li><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5383"><span class="MJXp-msubsup" id="MJXp-Span-5384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5385" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5386" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5387" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-5388">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-695-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-695"> p_g <1 </script>  add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5390">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-696-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-696"> g </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5392">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5393">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5394">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5395">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5396">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-697-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-697"> Small </script>  . </li><li>  Otherwise ($ p_g \ ge 1 $) add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5398">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-698-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-698"> g </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5400">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5401">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5402">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5403">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5404">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-699-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-699"> Large </script>  . </li></ol><br></li><li>  Bye list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5406">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5407">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5408">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5409">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5410">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-700-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-700"> Large </script>  not empty: <br><ol><li>  Remove the first item from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5412">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5413">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5414">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5415">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5416">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-701-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-701"> Large </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5418">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-702-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-702"> g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5420">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5421">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5422">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5423">b</span><span class="MJXp-mo" id="MJXp-Span-5424" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5425">g</span><span class="MJXp-mo" id="MJXp-Span-5426" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-5427" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-5428">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-703-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-703"> Prob [g] = 1 </script>  . </li></ol><br></li></ol><br></li><li>  <b>Generation</b> : <br><ol><li>  We generate a roll of honest bones from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5430">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-704-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-704"> n </script>  - bone;  call the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5432">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-705-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-705"> i </script>  . </li><li>  We throw an asymmetrical coin, on which an eagle falls on it with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5434">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5435">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5436">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5437">b</span><span class="MJXp-mo" id="MJXp-Span-5438" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5439">i</span><span class="MJXp-mo" id="MJXp-Span-5440" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-706-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-706"> Prob [i] </script>  . </li><li>  If an eagle falls on a coin, we return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5442">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-707-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-707"> i </script>  . </li><li>  Otherwise, return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5444">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5445">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5446">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5447">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5448">s</span><span class="MJXp-mo" id="MJXp-Span-5449" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5450" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5451" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5452">i</span><span class="MJXp-mo" id="MJXp-Span-5453" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-708-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-708"> Alias ‚Äã‚Äã[i] </script>  . </li></ol></li></ul></blockquote><br>  Taking into account the three invariants presented above, the first part of the algorithm (everything except the last cycle) should be fairly clear: we constantly pair in pairs some small element from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5455">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5456">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5457">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5458">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5459">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-709-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-709"> Small </script>  with a large element of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5461">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5462">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5463">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5464">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5465">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-710-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-710"> Large </script>  and then add the rest of the large item to the appropriate worklist.  The last loop of the algorithm requires an explanation.  After exhausting all the elements in the list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5467">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5468">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5469">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5470">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5471">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-711-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-711"> Small </script>  on the list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5473">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5474">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5475">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5476">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5477">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-712-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-712"> Large </script>  there will be at least one element (since if each element was <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5479">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5480">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5481">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5482">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5483">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-713-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-713"> Small </script>  , then the sum of the elements should have been less than the number of remaining elements, which violates the conditions of the last invariant).  Because each elment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5485">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5486">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5487">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5488">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5489">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-714-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-714"> Large </script>  not less than 1, and the amount <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5491">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-715-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-715"> k </script>  items in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5493">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5494">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5495">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5496">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5497">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-716-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-716"> Large </script>  must be equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5499">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-717-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-717"> k </script>  then every element in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5501">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5502">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5503">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5504">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5505">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-718-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-718"> Large </script>  must be equal to 1, because otherwise the total amount will be too large.  Therefore, this last loop sets the probabilities of each large element to 1, so that all columns containing a large element are 1. <br><br>  In this algorithm, the type of work list is not important.  In the original article, Vaugha uses stacks as a worklist because they can be efficiently implemented using arrays, but if we want, we can use a queue.  However, for simplicity, we will use the stack. <br><br>  Before proceeding to the analysis of the algorithm, let's analyze its work by example.  Consider an example using seven probabilities. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5506"><span class="MJXp-mtext" id="MJXp-Span-5507">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5508">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5509">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5510">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5511">c</span><span class="MJXp-mrow" id="MJXp-Span-5512"><span class="MJXp-mn" id="MJXp-Span-5513">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5514"><span class="MJXp-mn" id="MJXp-Span-5515">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-719-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-719"> \ frac {1} {4} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5516"><span class="MJXp-mtext" id="MJXp-Span-5517">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5518">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5519">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5520">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5521">c</span><span class="MJXp-mrow" id="MJXp-Span-5522"><span class="MJXp-mn" id="MJXp-Span-5523">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5524"><span class="MJXp-mn" id="MJXp-Span-5525">5</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-720-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-720"> \ frac {1} {5} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5526"><span class="MJXp-mtext" id="MJXp-Span-5527">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5528">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5529">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5530">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5531">c</span><span class="MJXp-mrow" id="MJXp-Span-5532"><span class="MJXp-mn" id="MJXp-Span-5533">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5534"><span class="MJXp-mn" id="MJXp-Span-5535">8</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-721-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-721"> \ frac {1} {8} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5536"><span class="MJXp-mtext" id="MJXp-Span-5537">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5538">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5539">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5540">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5541">c</span><span class="MJXp-mrow" id="MJXp-Span-5542"><span class="MJXp-mn" id="MJXp-Span-5543">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5544"><span class="MJXp-mn" id="MJXp-Span-5545">8</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-722-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-722"> \ frac {1} {8} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5546"><span class="MJXp-mtext" id="MJXp-Span-5547">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5548">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5549">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5550">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5551">c</span><span class="MJXp-mrow" id="MJXp-Span-5552"><span class="MJXp-mn" id="MJXp-Span-5553">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5554"><span class="MJXp-mn" id="MJXp-Span-5555">10</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-723-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-723"> \ frac {1} {10} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5556"><span class="MJXp-mtext" id="MJXp-Span-5557">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5558">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5559">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5560">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5561">c</span><span class="MJXp-mrow" id="MJXp-Span-5562"><span class="MJXp-mn" id="MJXp-Span-5563">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5564"><span class="MJXp-mn" id="MJXp-Span-5565">10</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-724-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-724"> \ frac {1} {10} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5566"><span class="MJXp-mtext" id="MJXp-Span-5567">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5568">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5569">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5570">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5571">c</span><span class="MJXp-mrow" id="MJXp-Span-5572"><span class="MJXp-mn" id="MJXp-Span-5573">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5574"><span class="MJXp-mn" id="MJXp-Span-5575">10</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-725-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-725"> \ frac {1} {10} </script>  .  To emphasize the fact that the algorithm does not sort probabilities and does not require them to be sorted, let's arrange them in arbitrary order. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5576"><span class="MJXp-mtext" id="MJXp-Span-5577">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5578">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5579">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5580">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5581">c</span><span class="MJXp-mrow" id="MJXp-Span-5582"><span class="MJXp-mn" id="MJXp-Span-5583">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5584"><span class="MJXp-mn" id="MJXp-Span-5585">8</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-726-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-726"> \ frac {1} {8} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5586"><span class="MJXp-mtext" id="MJXp-Span-5587">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5588">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5589">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5590">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5591">c</span><span class="MJXp-mrow" id="MJXp-Span-5592"><span class="MJXp-mn" id="MJXp-Span-5593">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5594"><span class="MJXp-mn" id="MJXp-Span-5595">5</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-727-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-727"> \ frac {1} {5} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5596"><span class="MJXp-mtext" id="MJXp-Span-5597">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5598">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5599">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5600">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5601">c</span><span class="MJXp-mrow" id="MJXp-Span-5602"><span class="MJXp-mn" id="MJXp-Span-5603">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5604"><span class="MJXp-mn" id="MJXp-Span-5605">10</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-728-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-728"> \ frac {1} {10} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5606"><span class="MJXp-mtext" id="MJXp-Span-5607">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5608">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5609">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5610">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5611">c</span><span class="MJXp-mrow" id="MJXp-Span-5612"><span class="MJXp-mn" id="MJXp-Span-5613">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5614"><span class="MJXp-mn" id="MJXp-Span-5615">4</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-729-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-729"> \ frac {1} {4} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5616"><span class="MJXp-mtext" id="MJXp-Span-5617">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5618">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5619">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5620">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5621">c</span><span class="MJXp-mrow" id="MJXp-Span-5622"><span class="MJXp-mn" id="MJXp-Span-5623">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5624"><span class="MJXp-mn" id="MJXp-Span-5625">10</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-730-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-730"> \ frac {1} {10} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5626"><span class="MJXp-mtext" id="MJXp-Span-5627">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5628">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5629">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5630">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5631">c</span><span class="MJXp-mrow" id="MJXp-Span-5632"><span class="MJXp-mn" id="MJXp-Span-5633">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5634"><span class="MJXp-mn" id="MJXp-Span-5635">10</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-731-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-731"> \ frac {1} {10} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5636"><span class="MJXp-mtext" id="MJXp-Span-5637">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5638">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5639">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5640">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5641">c</span><span class="MJXp-mrow" id="MJXp-Span-5642"><span class="MJXp-mn" id="MJXp-Span-5643">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5644"><span class="MJXp-mn" id="MJXp-Span-5645">8</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-732-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-732"> \ frac {1} {8} </script>  .  The algorithm begins with the addition of these elements in two working stacks: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e75/b32/2b3/e75b322b3f9ff1783c474bd89342980f.png"></div><br>  Now we will place the top of the stack <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5647">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5648">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5649">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5650">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5651">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-733-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-733"> Small </script>  in its position by moving the lilac rectangle to its final position: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/362/835/a0a/362835a0a829f990dd9f14846103372f.png"></div><br>  Now we use the top of the stack <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5653">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5654">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5655">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5656">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5657">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-734-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-734"> Large </script>  (cyan rectangle) to fill the rest of the column.  Insofar as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5658"><span class="MJXp-mtext" id="MJXp-Span-5659">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5660">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5661">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5662">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5663">c</span><span class="MJXp-mrow" id="MJXp-Span-5664"><span class="MJXp-mn" id="MJXp-Span-5665">7</span></span><span class="MJXp-mrow" id="MJXp-Span-5666"><span class="MJXp-mn" id="MJXp-Span-5667">4</span></span><span class="MJXp-mo" id="MJXp-Span-5668" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-5669">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5670">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5671">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5672">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5673">c</span><span class="MJXp-mrow" id="MJXp-Span-5674"><span class="MJXp-mn" id="MJXp-Span-5675">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5676"><span class="MJXp-mn" id="MJXp-Span-5677">8</span></span><span class="MJXp-mo" id="MJXp-Span-5678" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-5679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5680">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5681">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5682">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5683">c</span><span class="MJXp-mrow" id="MJXp-Span-5684"><span class="MJXp-mn" id="MJXp-Span-5685">13</span></span><span class="MJXp-mrow" id="MJXp-Span-5686"><span class="MJXp-mn" id="MJXp-Span-5687">8</span></span><span class="MJXp-mtext" id="MJXp-Span-5688">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5689">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5690">e</span><span class="MJXp-mn" id="MJXp-Span-5691">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-735-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-735"> \ frac {7} {4} - \ frac {1} {8} = \ frac {13} {8} \ ge 1 </script>  we leave the turquoise block on top of the stack <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5693">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5694">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5695">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5696">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5697">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-736-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-736"> Large </script>  : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ecc/629/ce3/ecc629ce33a845404a879be8b974af18.png"></div><br>  Then we repeat this process.  Move the rectangle from the top of the stack <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5699">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5700">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5701">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5702">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5703">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-737-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-737"> Small </script>  in its column, and then we add the missing top of the stack <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5705">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5706">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5707">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5708">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5709">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-738-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-738"> Large </script>  : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ca4/ccf/493/ca4ccf4931a27ff2c7ea9a4cdc6e31cc.png"></div><br>  Once again: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/08d/d43/adc/08dd43adceb3089699b853cdc4d8cc92.png"></div><br>  When we repeat this process next time, we find that although we can use the turquoise block to fill in the empty space in the table, but as a result, the height of the turquoise block will become less than one.  Therefore, we will need to move the turquoise block to the top of a stack of small values: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/01a/dce/40a/01adce40a609a01dc44a16281dd9c852.png"></div><br>  Now when processing the list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5711">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5712">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5713">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5714">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5715">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-739-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-739"> Small </script>  we put a turquoise block in its place, and then use the yellow block to fill the stack: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/47b/eb1/e18/47beb1e18e79af03d028ebf17fbace2c.png"></div><br>  Then we handle the stack <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5717">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5718">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5719">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5720">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5721">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-740-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-740"> Small </script>  To move the orange block to its position, filling the remnants of the yellow block: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e1/590/d54/6e1590d5439520cf2392259bc29feca6.png"></div><br>  Finally, since the stack <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5723">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5724">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5725">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5726">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5727">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-741-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-741"> Small </script>  empty, we put the yellow block in its column and end it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b0/723/1a6/2b07231a63d3f19b788eb3beb35b1031.png"></div><br>  And we have a well-formed alias table for these probabilities. <br><br><h2>  Practical version of the algorithm of Vouse </h2><br>  Unfortunately, the above algorithm in this form is numerically unstable.  It is quite accurate on an idealized machine capable of performing calculations with real numbers of arbitrary precision, but if you try to execute it with the help of IEEE-754 double, then it can be completely erroneous as a result.  Here are two sources of inaccuracies that we need to sort out before moving on: <br><br><ol><li>  Calculating whether probability belongs to a worklist <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5729">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5730">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5731">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5732">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5733">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-742-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-742"> Small </script>  or to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5735">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5736">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5737">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5738">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5739">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-743-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-743"> Large </script>  may be inaccurate.  In particular, a situation may arise in which the scaling of probabilities by a factor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5741">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-744-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-744"> n </script>  leads to the fact that probabilities equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5742"><span class="MJXp-mtext" id="MJXp-Span-5743">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5744">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5745">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5746">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5747">c</span><span class="MJXp-mrow" id="MJXp-Span-5748"><span class="MJXp-mn" id="MJXp-Span-5749">1</span></span><span class="MJXp-mrow" id="MJXp-Span-5750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5751">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-745-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-745"> \ frac {1} {n} </script>  , the result is a little less <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5752"><span class="MJXp-mn" id="MJXp-Span-5753">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-746-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-746"> 1 </script>  (i.e. get listed <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5755">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5756">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5757">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5758">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5759">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-747-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-747"> Small </script>  and not <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5761">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5762">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5763">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5764">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5765">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-748-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-748"> Large </script>  ). </li><li>  A calculation that subtracts the appropriate probability mass from a higher probability is numerically unstable and can introduce significant rounding errors.  This may result in the probability that should be listed <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5767">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5768">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5769">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5770">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5771">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-749-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-749"> Large </script>  appears on the list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5773">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5774">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5775">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5776">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5777">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-750-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-750"> Small </script>  . </li></ol><br>  The combination of these two factors means that as a result, the algorithm can randomly place all probabilities in the list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5779">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5780">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5781">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5782">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5783">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-751-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-751"> Small </script>  instead of a list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5785">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5786">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5787">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5788">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5789">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-752-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-752"> Large </script>  .  Therefore, the algorithm may fail, because he expects that when the list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5791">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5792">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5793">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5794">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5795">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-753-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-753"> Small </script>  not empty, then the list <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5797">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5798">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5799">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5800">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5801">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-754-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-754"> Large </script>  not empty <br><br>  Fortunately, this is not so difficult to fix.  We will change the internal loop of the algorithm so that it ends when any of the lists is empty, so that we do not accidentally have to search for non-existent elements in the list. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5803">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5804">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5805">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5806">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5807">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-755-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-755"> Large </script>  .  Second, when one list is empty, we will assign the remaining probabilities of the elements of the other list to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5808"><span class="MJXp-mn" id="MJXp-Span-5809">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-756-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-756"> 1 </script>  , because from a mathematical point of view, this can only happen when all remaining probabilities are exactly equal <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5810"><span class="MJXp-mn" id="MJXp-Span-5811">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-757-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-757"> 1 </script>  .  Finally, we will replace the higher probability update calculation with a slightly more stable calculation.  Then we get the following: <br><br><blockquote><h4>  Algorithm: Alias-Vouse method </h4><br><ul><li>  <b>Initialization</b> : <br><ol><li>  Create arrays <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5813">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5814">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5815">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5816">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5817">s</span><span class="MJXp-mo" id="MJXp-Span-5818" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5819" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-758-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-758"> Alias ‚Äã‚Äã</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5821">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5822">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5823">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5824">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-759-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-759"> Prob </script>  each size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5826">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-760-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-760"> n </script>  . </li><li>  Create two worklists, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5828">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5829">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5830">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5831">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5832">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-761-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-761"> Small </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5834">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5835">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5836">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5837">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5838">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-762-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-762"> Large </script>  . </li><li>  Multiply each probability by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5840">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-763-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-763"> n </script>  . </li><li>  For each scaled probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5841"><span class="MJXp-msubsup" id="MJXp-Span-5842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5843" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5844" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-764-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-764"> p_i </script>  : <br><ol><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5845"><span class="MJXp-msubsup" id="MJXp-Span-5846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5847" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5848" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-5849" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-5850">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-765-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-765"> p_i <1 </script>  add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5852">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-766-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-766"> i </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5854">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5855">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5856">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5857">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5858">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-767-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-767"> Small </script>  . </li><li>  Otherwise ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5859"><span class="MJXp-msubsup" id="MJXp-Span-5860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5861" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5862" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-5863">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5864">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5865">e</span><span class="MJXp-mn" id="MJXp-Span-5866">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-768-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-768"> p_i \ ge 1 </script>  ) add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5868">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-769-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-769"> i </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5870">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5871">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5872">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5873">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5874">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-770-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-770"> Large </script>  . </li></ol><br></li><li>  Until <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5876">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5877">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5878">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5879">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5880">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-771-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-771"> Small </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5882">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5883">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5884">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5885">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5886">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-772-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-772"> Large </script>  not empty: <i>(</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5888">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5889">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5890">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5891">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5892">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-773-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-773"> Large </script></i>   <i>may be devastated first)</i> <br><ol><li>  Remove the first item from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5894">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5895">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5896">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5897">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5898">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-774-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-774"> Small </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5900">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-775-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-775"> l </script>  . </li><li>  Remove the first item from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5902">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5903">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5904">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5905">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5906">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-776-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-776"> Large </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5908">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-777-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-777"> g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5910">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5911">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5912">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5913">b</span><span class="MJXp-mo" id="MJXp-Span-5914" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5915">l</span><span class="MJXp-mo" id="MJXp-Span-5916" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-5917" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-5918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5919" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5920" style="vertical-align: -0.4em;">l</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-778-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-778"> Prob [l] = p_l </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5922">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5923">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5924">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5925">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5926">s</span><span class="MJXp-mo" id="MJXp-Span-5927" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5928" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-5929" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5930">l</span><span class="MJXp-mo" id="MJXp-Span-5931" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-5932" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5933">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-779-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-779"> Alias ‚Äã‚Äã[l] = g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5934"><span class="MJXp-msubsup" id="MJXp-Span-5935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5936" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5937" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5938" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mo" id="MJXp-Span-5939" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-5940"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5941" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5942" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5943" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-5944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5945" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5946" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-5947" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-5948" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-5949">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-780-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-780"> p_g: = (p_g + p_l) - 1 </script>  .  <i>(This is a more numerically stable option.</i> ) </li><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5950"><span class="MJXp-msubsup" id="MJXp-Span-5951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5952" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5953" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-5954" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-5955">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-781-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-781"> p_g <1 </script>  add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5957">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-782-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-782"> g </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5959">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5960">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5961">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5962">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5963">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-783-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-783"> Small </script>  . </li><li>  Otherwise ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5964"><span class="MJXp-msubsup" id="MJXp-Span-5965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5966" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-5967" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mtext" id="MJXp-Span-5968">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5969">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5970">e</span><span class="MJXp-mn" id="MJXp-Span-5971">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-784-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-784"> p_g \ ge 1 </script>  ) add <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5973">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-785-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-785"> g </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5975">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5976">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5977">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5978">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5979">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-786-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-786"> Large </script>  . </li></ol><br></li><li>  Until <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5981">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5982">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5983">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5984">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5985">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-787-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-787"> Large </script>  not empty: <br><ol><li>  Remove the first item from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5987">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5988">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5989">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5990">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5991">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-788-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-788"> Large </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5993">g</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-789-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-789"> g </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5995">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5996">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5997">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5998">b</span><span class="MJXp-mo" id="MJXp-Span-5999" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6000">g</span><span class="MJXp-mo" id="MJXp-Span-6001" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-6002" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-6003">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-790-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-790"> Prob [g] = 1 </script>  . </li></ol><br></li><li>  Until <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6005">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6006">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6007">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6008">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6009">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-791-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-791"> Small </script>  not empty: <i>This is only possible due to numerical instability.</i> <br><ol><li>  Remove the first item from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6011">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6012">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6013">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6014">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6015">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-792-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-792"> Small </script>  ;  call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6017">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-793-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-793"> l </script>  . </li><li>  Ask <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6019">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6020">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6021">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6022">b</span><span class="MJXp-mo" id="MJXp-Span-6023" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6024">l</span><span class="MJXp-mo" id="MJXp-Span-6025" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-6026" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-6027">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-794-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-794"> Prob [l] = 1 </script>  . </li></ol><br></li></ol><br></li><li>  <b>Generation</b> : <br><ol><li>  We generate a roll of honest bones from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6029">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-795-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-795"> n </script>  - bone;  call the face <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6031">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-796-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-796"> i </script>  . </li><li>  We throw an asymmetrical coin, on which an eagle falls on it with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6032"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6033">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6034">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6035">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6036">b</span><span class="MJXp-mo" id="MJXp-Span-6037" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6038">i</span><span class="MJXp-mo" id="MJXp-Span-6039" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-797-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-797"> Prob [i] </script>  . </li><li>  If an eagle falls on a coin, we return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6041">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-798-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-798"> i </script>  . </li><li>  Otherwise, return <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6043">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6044">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6045">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6046">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6047">s</span><span class="MJXp-mo" id="MJXp-Span-6048" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-6049" style="margin-left: 0em; margin-right: 0.222em;">‚Äã</span><span class="MJXp-mo" id="MJXp-Span-6050" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6051">i</span><span class="MJXp-mo" id="MJXp-Span-6052" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-799-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-799"> Alias ‚Äã‚Äã[i] </script>  . </li></ol></li></ul></blockquote><br>  The only thing left for us is to analyze the complexity of the algorithm.  Creating worklists in general takes time <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6053"><span class="MJXp-mtext" id="MJXp-Span-6054">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6055">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6056">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6057">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6058">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6059">a</span><span class="MJXp-mo" id="MJXp-Span-6060" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6061">n</span><span class="MJXp-mo" id="MJXp-Span-6062" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-800-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-800"> \ Theta (n) </script>  as we add each item to exactly one of the lists.  The internal loop runs in time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6063"><span class="MJXp-mtext" id="MJXp-Span-6064">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6065">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6066">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6067">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6068">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6069">a</span><span class="MJXp-mo" id="MJXp-Span-6070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6071">1</span><span class="MJXp-mo" id="MJXp-Span-6072" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-801-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-801"> \ Theta (1) </script>  , because it needs to remove two items from the worklist, update two arrays and add one item back to the list.  It can not run anymore. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6074">O</span><span class="MJXp-mo" id="MJXp-Span-6075" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6076">n</span><span class="MJXp-mo" id="MJXp-Span-6077" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-802-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-802"> O (n) </script>  times, since each iteration reduces the number of elements (total) in the lists by one, eliminating a small probability.  Each of the last two cycles can run no more than <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6079">O</span><span class="MJXp-mo" id="MJXp-Span-6080" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6081">n</span><span class="MJXp-mo" id="MJXp-Span-6082" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-803-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-803"> O (n) </script>  because lists <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6084">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6085">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6086">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6087">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6088">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-804-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-804"> Large </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6090">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6091">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6092">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6093">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6094">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-805-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-805"> Small </script>  contains no more <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6096">O</span><span class="MJXp-mo" id="MJXp-Span-6097" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6098">n</span><span class="MJXp-mo" id="MJXp-Span-6099" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-806-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-806"> O (n) </script>  items.  This gives us a total lead time. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6100"><span class="MJXp-mtext" id="MJXp-Span-6101">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6102">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6103">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6104">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6105">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6106">a</span><span class="MJXp-mo" id="MJXp-Span-6107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6108">n</span><span class="MJXp-mo" id="MJXp-Span-6109" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-807-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-807"> \ Theta (n) </script>  that (as can be seen) is the best result: <br><table><tbody><tr><th>  Algorithm </th><th colspan="2">  Initialization time </th><th colspan="2">  Generation time </th><th colspan="2">  Busy memory </th></tr><tr><th></th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th><th>  The best </th><th>  Worst </th></tr><tr><td>  Honest bone cheat bone </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6110"><span class="MJXp-mtext" id="MJXp-Span-6111">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6112">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6113">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6114">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6115">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6116">a</span><span class="MJXp-mo" id="MJXp-Span-6117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6118">n</span><span class="MJXp-mo" id="MJXp-Span-6119" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-808-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-808"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6121">O</span><span class="MJXp-mo" id="MJXp-Span-6122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6123">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6124">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6125">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6126">o</span><span class="MJXp-msubsup" id="MJXp-Span-6127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6128" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6133">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-6129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6130">i</span><span class="MJXp-mo" id="MJXp-Span-6131">=</span><span class="MJXp-mn" id="MJXp-Span-6132">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-6134"><span class="MJXp-msubsup" id="MJXp-Span-6135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6136" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-6137" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-6138" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-809-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-809"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6139"><span class="MJXp-mtext" id="MJXp-Span-6140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6141">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6142">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6143">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6144">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6145">a</span><span class="MJXp-mo" id="MJXp-Span-6146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6147">1</span><span class="MJXp-mo" id="MJXp-Span-6148" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-810-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-810"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6149"><span class="MJXp-mtext" id="MJXp-Span-6150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6151">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6152">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6153">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6154">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6155">a</span><span class="MJXp-mo" id="MJXp-Span-6156" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6157">n</span><span class="MJXp-mo" id="MJXp-Span-6158" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-811-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-811"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6160">O</span><span class="MJXp-mo" id="MJXp-Span-6161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6162">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6163">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6164">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6165">o</span><span class="MJXp-msubsup" id="MJXp-Span-6166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6167" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6172">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-6168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6169">i</span><span class="MJXp-mo" id="MJXp-Span-6170">=</span><span class="MJXp-mn" id="MJXp-Span-6171">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-6173"><span class="MJXp-msubsup" id="MJXp-Span-6174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6175" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-6176" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-6177" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-812-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-812"> O (\ prod_ {i = 0} ^ n {d_i}) </script></td></tr><tr><td>  Shuler bone from asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6178"><span class="MJXp-mtext" id="MJXp-Span-6179">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6180">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6181">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6182">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6183">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6184">a</span><span class="MJXp-mo" id="MJXp-Span-6185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6186">n</span><span class="MJXp-mo" id="MJXp-Span-6187" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-813-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-813"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6188"><span class="MJXp-mtext" id="MJXp-Span-6189">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6190">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6191">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6192">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6193">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6194">a</span><span class="MJXp-mo" id="MJXp-Span-6195" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6196">1</span><span class="MJXp-mo" id="MJXp-Span-6197" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-814-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-814"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6198"><span class="MJXp-mtext" id="MJXp-Span-6199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6200">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6201">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6202">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6203">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6204">a</span><span class="MJXp-mo" id="MJXp-Span-6205" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6206">n</span><span class="MJXp-mo" id="MJXp-Span-6207" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-815-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-815"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6208"><span class="MJXp-mtext" id="MJXp-Span-6209">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6210">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6211">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6212">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6213">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6214">a</span><span class="MJXp-mo" id="MJXp-Span-6215" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6216">n</span><span class="MJXp-mo" id="MJXp-Span-6217" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-816-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-816"> \ Theta (n) </script></td></tr><tr><td>  Selection by the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6218"><span class="MJXp-mtext" id="MJXp-Span-6219">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6220">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6221">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6222">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6223">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6224">a</span><span class="MJXp-mo" id="MJXp-Span-6225" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6226">n</span><span class="MJXp-mo" id="MJXp-Span-6227" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-817-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-817"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6228"><span class="MJXp-mtext" id="MJXp-Span-6229">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6230">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6231">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6232">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6233">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6234">a</span><span class="MJXp-mo" id="MJXp-Span-6235" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6237">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6238">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6239">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6240">n</span><span class="MJXp-mo" id="MJXp-Span-6241" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-818-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-818"> \ Theta (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6242"><span class="MJXp-mtext" id="MJXp-Span-6243">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6244">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6245">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6246">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6247">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6248">a</span><span class="MJXp-mo" id="MJXp-Span-6249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6250">n</span><span class="MJXp-mo" id="MJXp-Span-6251" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-819-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-819"> \ Theta (n) </script></td></tr><tr><td>  The optimal choice of the roulette wheel </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6253">O</span><span class="MJXp-mo" id="MJXp-Span-6254" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-6255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6256" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6257" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6258" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-820-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-820"> O (n ^ 2) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6259"><span class="MJXp-mtext" id="MJXp-Span-6260">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6261">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6262">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6263">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6264">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6265">a</span><span class="MJXp-mo" id="MJXp-Span-6266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6267">1</span><span class="MJXp-mo" id="MJXp-Span-6268" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-821-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-821"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6270">O</span><span class="MJXp-mo" id="MJXp-Span-6271" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-6272">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6273">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6274">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6275">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6276">n</span><span class="MJXp-mo" id="MJXp-Span-6277" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-822-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-822"> O (\ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6278"><span class="MJXp-mtext" id="MJXp-Span-6279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6280">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6281">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6282">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6283">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6284">a</span><span class="MJXp-mo" id="MJXp-Span-6285" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6286">n</span><span class="MJXp-mo" id="MJXp-Span-6287" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-823-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-823"> \ Theta (n) </script></td></tr><tr><td>  Cheat bone of honest bones / asymmetrical coins </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6288"><span class="MJXp-mtext" id="MJXp-Span-6289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6290">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6291">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6292">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6293">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6294">a</span><span class="MJXp-mo" id="MJXp-Span-6295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6296">n</span><span class="MJXp-mo" id="MJXp-Span-6297" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-824-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-824"> \ Theta (n) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6298"><span class="MJXp-mtext" id="MJXp-Span-6299">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6300">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6301">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6302">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6303">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6304">a</span><span class="MJXp-mo" id="MJXp-Span-6305" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6306">1</span><span class="MJXp-mo" id="MJXp-Span-6307" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-825-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-825"> \ Theta (1) </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6308"><span class="MJXp-mtext" id="MJXp-Span-6309">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6310">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6311">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6312">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6313">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6314">a</span><span class="MJXp-mo" id="MJXp-Span-6315" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6316">n</span><span class="MJXp-mo" id="MJXp-Span-6317" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-826-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-826"> \ Theta (n) </script>  (expected) </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6318"><span class="MJXp-mtext" id="MJXp-Span-6319">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6320">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6321">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6322">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6323">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6324">a</span><span class="MJXp-mo" id="MJXp-Span-6325" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6326">n</span><span class="MJXp-mo" id="MJXp-Span-6327" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-827-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-827"> \ Theta (n) </script></td></tr><tr><td>  Naive Alias ‚Äã‚ÄãMethod </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6329">O</span><span class="MJXp-mo" id="MJXp-Span-6330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-6331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6332" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-6333" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-6334" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-828-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-828"> O (n ^ 2) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6335"><span class="MJXp-mtext" id="MJXp-Span-6336">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6337">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6338">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6339">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6340">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6341">a</span><span class="MJXp-mo" id="MJXp-Span-6342" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6343">1</span><span class="MJXp-mo" id="MJXp-Span-6344" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-829-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-829"> \ Theta (1) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6345"><span class="MJXp-mtext" id="MJXp-Span-6346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6347">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6348">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6349">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6350">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6351">a</span><span class="MJXp-mo" id="MJXp-Span-6352" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6353">n</span><span class="MJXp-mo" id="MJXp-Span-6354" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-830-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-830"> \ Theta (n) </script></td></tr><tr><td>  Alias ‚Äã‚Äãmethod </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6356">O</span><span class="MJXp-mo" id="MJXp-Span-6357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6358">n</span><span class="MJXp-mtext" id="MJXp-Span-6359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6360">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6361">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6362">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6363">n</span><span class="MJXp-mo" id="MJXp-Span-6364" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-831-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-831"> O (n \ log n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6365"><span class="MJXp-mtext" id="MJXp-Span-6366">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6367">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6368">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6369">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6370">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6371">a</span><span class="MJXp-mo" id="MJXp-Span-6372" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6373">1</span><span class="MJXp-mo" id="MJXp-Span-6374" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-832-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-832"> \ Theta (1) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6375"><span class="MJXp-mtext" id="MJXp-Span-6376">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6377">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6378">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6379">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6380">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6381">a</span><span class="MJXp-mo" id="MJXp-Span-6382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6383">n</span><span class="MJXp-mo" id="MJXp-Span-6384" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-833-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-833"> \ Theta (n) </script></td></tr><tr><td>  Alias-vous method </td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6385"><span class="MJXp-mtext" id="MJXp-Span-6386">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6387">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6388">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6389">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6390">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6391">a</span><span class="MJXp-mo" id="MJXp-Span-6392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6393">n</span><span class="MJXp-mo" id="MJXp-Span-6394" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-834-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-834"> \ Theta (n) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6395"><span class="MJXp-mtext" id="MJXp-Span-6396">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6397">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6398">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6399">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6400">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6401">a</span><span class="MJXp-mo" id="MJXp-Span-6402" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-6403">1</span><span class="MJXp-mo" id="MJXp-Span-6404" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-835-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-835"> \ Theta (1) </script></td><td colspan="2"><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6405"><span class="MJXp-mtext" id="MJXp-Span-6406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6407">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6408">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6409">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6410">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6411">a</span><span class="MJXp-mo" id="MJXp-Span-6412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6413">n</span><span class="MJXp-mo" id="MJXp-Span-6414" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-836-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-836"> \ Theta (n) </script></td></tr></tbody></table><br><h2>  Thoughts in conclusion </h2><br>  Wow!  We did a great job!  They explored various methods of simulating a cheat bone, starting with the simplest set of techniques and ending with extremely fast and efficient algorithms.  Each method demonstrates its own set of techniques, and I consider the final version (the Vouse alias method) to be one of the most interesting and elegant algorithms I have ever encountered. <br><br>  If you are interested in seeing the code of the alias-method of vous, including a brief description of the difficulties arising in practice due to numerical inaccuracy, then i have an <b><a href="http://www.keithschwarz.com/interesting/code/%3Fdir%3Dalias-method">implementation of the alias-method in java</a></b> , laid out in the <a href="http://www.keithschwarz.com/interesting/">archive of interesting code</a> . <br><br>  I hope the article was useful to you! </div><p>Source: <a href="https://habr.com/ru/post/419725/">https://habr.com/ru/post/419725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../419711/index.html">The first IT Bike Quest in St. Petersburg. How it was</a></li>
<li><a href="../419715/index.html">You do not know how to work with transactions.</a></li>
<li><a href="../419717/index.html">Embedded architecture design</a></li>
<li><a href="../419719/index.html">[bookmark] 23 recommendations for the protection of Node.js applications</a></li>
<li><a href="../419721/index.html">Biomarkers of aging. Frailty panel. Part 1</a></li>
<li><a href="../419727/index.html">Harbor - Registry for Docker Containers with Out-of-Box Security</a></li>
<li><a href="../419729/index.html">Charity event ‚ÄúGive wings to children‚Äù</a></li>
<li><a href="../419731/index.html">Mini-review of a dental photopolymer 3D-printer MoonRay S</a></li>
<li><a href="../419733/index.html">Git happens! 6 typical git errors and how to fix them</a></li>
<li><a href="../419735/index.html">I / Q Signal Study with SDR using Adobe Audition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>