<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We understand the development of Windows 8 applications on XAML / –° #, implementing a simple RSS Reader. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After the post Introduction to the development of WinRT applications in HTML / JavaScript. From the template to the data application, you already know...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We understand the development of Windows 8 applications on XAML / –° #, implementing a simple RSS Reader. Part 1</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/168/542/667/168542667c983c147fe8218be9926067.png"><br><br>  After the post <a href="http://habrahabr.ru/company/microsoft/blog/163443/">Introduction to the development of WinRT applications in HTML / JavaScript.</a>  <a href="http://habrahabr.ru/company/microsoft/blog/163443/">From the template to the data application,</a> you already know how to develop an RSS reader for Windows 8 using HTML and JavaScript.  It's time to try to do about the same thing, but using XAML / C #.  This is the first part, but we will make it beautifully! <br><a name="habracut"></a><br><h2>  Creating an application from a template </h2><br>  Let's start development from the Grid template of the application as well, choosing XAML / C # development <br>  From the <strong>File</strong> menu, select <strong>New Project,</strong> then <strong>Visual C #</strong> , then <strong>Windows Store</strong> , in the central part of the <strong>New Project</strong> window select a template called the <strong>Grid</strong> <strong>App (XAML)</strong> .  Enter the name of the application in the <strong>Name</strong> field, for example, MyReader, if necessary, in the <strong>Location</strong> field the folder where the application project will be located and click the <strong>OK</strong> button. <br><img title="habr-templ-xaml-1" alt="habr-templ-xaml-1" src="https://habrastorage.org/getpro/habr/post_images/264/563/5f0/2645635f00fe160abfb6307905cced52.png" width="625" height="387"><br>  As a result, we get an application that is almost fully functional in navigation and data display, which displays an example of data. <br>  Let's see how it works by pressing <b>F5</b> , the green arrow or selecting <b>Debug</b> -&gt; <b>Start Debugging</b> <br><img title="habr-templ-xaml-2" alt="habr-templ-xaml-2" src="https://habrastorage.org/getpro/habr/post_images/fb1/3f9/89d/fb13f989dbbc9beff65efa0f6a270202.png" width="634" height="359"><br>  You can make sure that this is almost a full-featured application: <br><ul><li>  click on any single gray tile or group title; </li><li>  use the <strong>back</strong> button on the internal pages of the application; </li><li>  put the application in snapped mode. </li></ul><br>  Return to Visual Studio and stop debugging the application ( <b>Shift + F5</b> , red square, or select <b>Debug</b> -&gt; <b>Stop Debugging</b> from the menu). <br>  Let's look at the main files of our solution: <br><ul><li>  <strong>* .xaml</strong> - markup page application in XAML. </li><li>  <strong>* .xaml.cs</strong> is a code-behind file in the C # page language. </li><li>  <strong>App.xaml</strong> - the initialization of the Windows Store-application object in the XAML language, has no visual presentation and is not an application page. </li><li>  <strong>App.xaml.cs</strong> is the <strong>C</strong> -code code-behind file for App.xaml.  This file handles application-level events, such as launch, activation, including activation by search query, and deactivation of the application.  In addition, in App.xaml.cs, you can catch unhandled exceptions and catch navigation errors between pages. </li><li>  <strong>Common</strong> folder <strong>,</strong> <strong>StandardStyles.xaml</strong> file - style resource file for graphical controls, is connected in App.xaml and its styles are available in all pages of the application. </li><li>  <strong>Package.appxmanifest</strong> is an application manifest, an XML file, containing a variety of application settings.  There is a graphic editor that can be opened by double-clicking on the Package.appxmanifest file name in the Solution Explorer window. </li><li>  <strong>AssemblyInfo.cs</strong> is a configuration file that defines some metadata for the main <i>assembly of the</i> application. </li><li>  <strong>MyReader_TemporaryKey.pfx</strong> is a cryptographic certificate with a private key that signs the application. </li><li>  <strong>Asset</strong> folder, <strong>Logo.png, SmallLogo.png, StoreLogo.png files</strong> - logos for large and small tiles of an application, as well as an icon for a list of all applications. </li><li>  <strong>SplashScreen.png</strong> - a picture for the screen saver, which is displayed during the application download. </li></ul><br>  Also in the Common folder, there are also files with common code that is used in the application, in the DataModel folder there is a file with the application data model - <strong>SampleDataSource.cs</strong> . <br><br><h2>  Change data to display </h2>  So, the application is already running and it has a sample data source implemented.  Therefore, task number one is to replace an example of a data source with a real data source. <br>  We start by removing the default constructor of the SampleDataSource class, in which initialization occurs with static data. <pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SampleDataSource</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span></code> </pre> <br>  Next, we use the refactoring capabilities built into Visual Studio and rename SampleDataSource to RSSDataSource, SampleDataGroup to RSSDataGroup, SampleDataItem to RSSDataItem and SampleDataCommon to RSSDataCommon. <br><img src="https://habrastorage.org/storage2/3c1/209/06b/3c120906b4c2b281209031ad9074c86c.png"><br>  To create a holistic picture of the world, you can rename the file SampleDataSource.cs to RSSDataSource.cs. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To simplify working with the data class in this example, let's simplify it.  To do this, replace the following piece of the class RSSDataSource <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RSSDataSource _sampleDataSource = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RSSDataSource(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ObservableCollection&lt;RSSDataGroup&gt; _allGroups = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObservableCollection&lt;RSSDataGroup&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ObservableCollection&lt;RSSDataGroup&gt; AllGroups { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._allGroups; } }</code> </pre><br><br>  A similar code that simplifies the perception and further development of the example. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ObservableCollection&lt;RSSDataGroup&gt; AllGroups = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObservableCollection&lt;RSSDataGroup&gt;();</code> </pre><br>  Finally, remove the unnecessary local variable _sampleDataSource from the class code. <br><br>  So, we are prepared to add real data. <br><br>  We add a simple method that will take an RSS or ATOM data stream and submit it for further display in the application interface. <br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddGroupForFeedAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> feedUrl</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> clearedContent = String.Empty; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RSSDataSource.GetGroup(feedUrl) != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> feed = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SyndicationClient().RetrieveFeedAsync(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(feedUrl)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> feedGroup = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RSSDataGroup( uniqueId: feedUrl, title: feed.Title != <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? feed.Title.Text : <span class="hljs-literal"><span class="hljs-literal">null</span></span>, subtitle: feed.Subtitle != <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? feed.Subtitle.Text : <span class="hljs-literal"><span class="hljs-literal">null</span></span>, imagePath: feed.ImageUri != <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? feed.ImageUri.ToString() : <span class="hljs-literal"><span class="hljs-literal">null</span></span>, description: <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> feed.Items) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> imagePath = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i.Summary != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) clearedContent = Windows.Data.Html.HtmlUtilities.ConvertToText(i.Summary.Text); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i.Content != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) clearedContent = Windows.Data.Html.HtmlUtilities.ConvertToText(i.Content.Text); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imagePath != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; feedGroup.Image == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) feedGroup.SetImage(imagePath); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imagePath == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) imagePath = <span class="hljs-string"><span class="hljs-string">"ms-appx:///Assets/DarkGray.png"</span></span>; feedGroup.Items.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RSSDataItem( uniqueId: i.Id, title: i.Title.Text, subtitle: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, imagePath: imagePath, description: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, content: clearedContent, @<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>: feedGroup)); } AllGroups.Add(feedGroup); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  The code is quite simple.  Using SyndicationClient, we receive and parse data from RSS / ATOM, after which we create a group and add entries to it.  Along the way, we clear the contents of the HTML tags, just to make it look better, and also provide for the addition of a picture, than we will do later. <br><br>  Do not forget to add the following directive to the using block: <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.Web.Syndication; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks;</code> </pre> <br>  To check how it works right away, double-click the GroupedItemsPage.xaml.cs file and go to the LoadState method, which initializes the data and replace the sampleDataGroups data source with RSSDataSource.AllGroups, as well as remove the initialization of sampleDataGroups now unnecessary.  Now, the LoadState code consists of one line: <pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Object navigationParameter, Dictionary&lt;String, Object&gt; pageState</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.DefaultViewModel[<span class="hljs-string"><span class="hljs-string">"Groups"</span></span>] = RSSDataSource.AllGroups; }</code> </pre><br>  Now, to make it work, you need to add some RSS.  We use the newly created function AddGroupForFeedAsync and add two lines to the LoadState function: <br><pre> <code class="cs hljs">RSSDataSource.AddGroupForFeedAsync(<span class="hljs-string"><span class="hljs-string">"http://blogs.msdn.com/b/stasus/rss.aspx"</span></span>); RSSDataSource.AddGroupForFeedAsync(<span class="hljs-string"><span class="hljs-string">"http://www.spugachev.com/feed"</span></span>);</code> </pre><br>  We collect the project and we start. <br><img src="https://habrastorage.org/storage2/182/3a8/c96/1823a8c960237c0132432e2d9bec9ef7.png"><br>  Hooray - it works! <br><br>  But somehow everything is not very beautiful ... Well, let's make it beautiful! <br><br><h2>  Make beautiful </h2>  The first thing to start with is pictures in posts and on tiles in a grouped display. <br>  Go back to RSSDataSource.cs and add a magic method that extracts images from RSS posts: <pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetImageFromPostContents</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SyndicationItem item</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> text2search = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.Content != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) text2search += item.Content.Text; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.Summary != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) text2search += item.Summary.Text; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Regex.Matches(text2search, <span class="hljs-string"><span class="hljs-string">@"(?&lt;=&lt;img\s+[^&gt;]*?src=(?&lt;q&gt;['""]))(?&lt;url&gt;.+?)(?=\k&lt;q&gt;)"</span></span>, RegexOptions.IgnoreCase) .Cast&lt;Match&gt;() .Where(m =&gt; { Uri url; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Uri.TryCreate(m.Groups[<span class="hljs-number"><span class="hljs-number">0</span></span>].Value, UriKind.Absolute, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> url)) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ext = Path.GetExtension(url.AbsolutePath).ToLower(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ext == <span class="hljs-string"><span class="hljs-string">".png"</span></span> || ext == <span class="hljs-string"><span class="hljs-string">".jpg"</span></span> || ext == <span class="hljs-string"><span class="hljs-string">".bmp"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }) .Select(m =&gt; m.Groups[<span class="hljs-number"><span class="hljs-number">0</span></span>].Value) .FirstOrDefault(); }</code> </pre><br>  In the method, we, using regular expressions, try to find pictures (with extensions png, jpg and bmp) in the text of the post or its summary. <br>  Do not forget to add the following directive to the using block: <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text.RegularExpressions; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO;</code> </pre> <br>  Now we will add the calls of this method to the stub carefully left in the AddGroupForFeedAsync method.  Change <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> imagePath = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;</code> </pre>  on <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> imagePath = GetImageFromPostContents(i);</code> </pre> <br>  Reassemble and run the application. <br><img src="https://habrastorage.org/storage2/bd9/7b0/558/bd97b0558e6d8abd55d4edc0c288d151.png"><br>  Everything has become much better, but why are all the topics displayed in tiles of the same size?  Perhaps you need to do as in the Windows Store! <br><br>  This is a slightly more difficult task than all that we have done before.  But we do not stop in front of difficulties! <br><br>  In order to implement this functionality, we will have to create our own class, the successor of the GridView.  Add a new class file named: VariableSizeGridView.cs to the project.  In the new file, add the following directive to the block: <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.UI.Xaml.Controls;</code> </pre>  , indicate that the class is inherited from the GridView and override its class method: PrepareContainerForItemOverride.  The result should be something like this: <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.UI.Xaml.Controls; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">MyReader</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">VariableSizeGridView</span></span>: <span class="hljs-title"><span class="hljs-title">GridView</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrepareContainerForItemOverride</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Windows.UI.Xaml.DependencyObject element, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> item</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.PrepareContainerForItemOverride(element, item); } } }</code> </pre> <br>  The PrepareContainerForItemOverride method itself will determine the logic by which tiles of different sizes will be displayed in a grouped view.  Now you need to prepare the markup in the GroupedItemsPage.xaml file. <br><br>  First we replace the GridView with our class - local: VariableSizeGridView.  Next in the ItemPanelTemplate, we complement the properties of the VariableSizedWrapGrid by specifying the size of the Item and the maximum number of terms and columns so that it will look like this: <pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VariableSizedWrapGrid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,0,80,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"200"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"125"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MaximumRowsOrColumns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"9"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><br>  Add your own Item template to the page resources: <pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DataTemplate</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CustomItemTemplate"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">HorizontalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Left"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Border</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource ListViewItemPlaceholderBackgroundThemeBrush}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Image</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Image}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Stretch</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UniformToFill"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AutomationProperties.Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Title}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Border</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource ListViewItemOverlayBackgroundThemeBrush}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">VerticalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Bottom"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Title}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Foreground</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource ListViewItemOverlayForegroundThemeBrush}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"90"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15,0,15,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">FontSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"30"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DataTemplate</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  And specify it as the Item template, instead of the standard in local: VariableSizeGridView :: <pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">local:VariableSizeGridView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"itemGridView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AutomationProperties.AutomationId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ItemGridView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AutomationProperties.Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Grouped Items"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.RowSpan</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Padding</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"116,137,40,46"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemsSource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Source={StaticResource groupedItemsViewSource}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemTemplate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{StaticResource CustomItemTemplate}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">SelectionMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"None"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IsSwipeEnabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IsItemClickEnabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"True"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ItemView_ItemClick"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Launch the application. <br><img src="https://habrastorage.org/storage2/afe/9ff/963/afe9ff9631830d496705d00851f08d7e.png"><br>  Looks not very nice.  But this is until we add our code with logic to PrepareContainerForItemOverride. <br><br>  So, add the code: <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">VariableSizeGridView</span></span>: <span class="hljs-title"><span class="hljs-title">GridView</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowVal; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> colVal; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrepareContainerForItemOverride</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Windows.UI.Xaml.DependencyObject element, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> item</span></span></span><span class="hljs-function">)</span></span> { RSSDataItem dataItem = item <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RSSDataItem; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dataItem != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { index = dataItem.Group.Items.IndexOf(dataItem); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index == <span class="hljs-number"><span class="hljs-number">1</span></span>) { colVal = <span class="hljs-number"><span class="hljs-number">2</span></span>; rowVal = <span class="hljs-number"><span class="hljs-number">4</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { colVal = <span class="hljs-number"><span class="hljs-number">2</span></span>; rowVal = <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index == <span class="hljs-number"><span class="hljs-number">2</span></span>) { colVal = <span class="hljs-number"><span class="hljs-number">2</span></span>; rowVal = <span class="hljs-number"><span class="hljs-number">4</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index == <span class="hljs-number"><span class="hljs-number">5</span></span>) { colVal = <span class="hljs-number"><span class="hljs-number">4</span></span>; rowVal = <span class="hljs-number"><span class="hljs-number">4</span></span>; } VariableSizedWrapGrid.SetRowSpan(element <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> UIElement, rowVal); VariableSizedWrapGrid.SetColumnSpan(element <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> UIElement, colVal); <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.PrepareContainerForItemOverride(element, item); }</code> </pre> <br>  As you can see, we simply indicate with our hands which tiles in order, how to display them. <br><br>  Run again. <br><img src="https://habrastorage.org/storage2/367/e8b/ffb/367e8bffb4bf3a01d6e17ccbd847501c.png"><br>  It looks much better, and by implementing the templates for the Item and the logic of the PrepareContainerForItemOverride, we can achieve almost any view within the GridView. <br><br>  On this I, perhaps, will complete the first part.  In the second part, we will continue to do beautifully: we will add live tiles, search contracts and share contracts, and also add RSS feeds to the settings. <br><br>  <b>UPD</b> : Yes, and we will also make a style for Title, so that it is displayed on human tiles in a grouped display on a human basis, as in the screenshot at the beginning of the article. <br><br>  The resulting application as a project on SkyDrive (short link): <a href="http://aka.ms/w8RSSp1">aka.ms/w8RSSp1</a> <br><br>  Happy New Year! <br><br>  <b>UPD:</b> <br>  <a href="http://habrahabr.ru/company/microsoft/blog/163837/">Part 2 of the cycle</a> <br>  <a href="http://habrahabr.ru/company/microsoft/blog/166421/">Part of the 3rd cycle</a> </div><p>Source: <a href="https://habr.com/ru/post/163711/">https://habr.com/ru/post/163711/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163693/index.html">EU is going to reform copyright</a></li>
<li><a href="../163695/index.html">"Do not tell me where to go" - your user</a></li>
<li><a href="../163699/index.html">The history of one mBaaS (cloud backend) service on the example of QuickBlox</a></li>
<li><a href="../163703/index.html">The story of one habraspor</a></li>
<li><a href="../163707/index.html">Using CDN for Windows Azure</a></li>
<li><a href="../163713/index.html">Apocalypse</a></li>
<li><a href="../163719/index.html">Admins of the Great Chinese firewall seriously took up the VPN</a></li>
<li><a href="../163721/index.html">The four-legged military robot AlphaDog grows and develops</a></li>
<li><a href="../163723/index.html">Be happy in 2013!</a></li>
<li><a href="../163725/index.html">Multicore JIT compilation in .NET 4.5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>