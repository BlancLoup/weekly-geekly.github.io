<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Single Line Diagrams in Revit</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Revit is a software package that implements the principle of building information modeling. Initially the program was intended for architects. Now mor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Single Line Diagrams in Revit</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/f9b/75e/03e/f9b75e03eaf64dd6b9e9c11b9efa5f11.PNG" alt="image" align="left" width="350"><br>  Revit is a software package that implements the principle of building information modeling.  Initially the program was intended for architects.  Now more and more companies, when applying for a job, require engineers to work in Revit.  Autodesk Revit provides a powerful .NET API that allows you to develop your own applications to solve various problems.  In this article I want to share the experience of creating single-line diagrams in Revit. <br><br clear="left"><a name="habracut"></a><br>  The main advantages of Revit for the engineer are: <br><br>  - work with current planning; <br>  - joint work of several engineers in one file; <br>  - control of the intersection of engineering communications; <br>  - exchange of tasks; <br>  - the creation of automatically updated specifications. <br><br>  Revit also allows you to design power supply systems and load calculations in a tabular form.  The disadvantage is that it is impossible to conduct calculations, select equipment and draw up schemes in accordance with the regulatory documents in force in the territory of the Russian Federation.  Creating single-line diagrams is a fairly time-consuming procedure that takes a lot of time. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When I was working in Autocad, I used an Excel spreadsheet to calculate: put the power of the connected equipment, the name, location, type, length, and many more parameters, did the calculation, and then plotted the diagrams using <a href="http://www.bimelectro.ru/p/sld-avtocad.html">the Autocad plug-in</a> . <br><br>  Now, when working with Revit, all this data can be obtained from the BIM model.  For example, this plugin receives the following information: <br><br>  - Switch number; <br>  - Electrical loads; <br>  - voltage; <br>  - The number of poles; <br>  - Power factor; <br>  - cable type; <br>  - Classification of electrical loads; <br>  - Neutral conductor cross section; <br>  - The length of the cable line. <br><br>  The remaining information is calculated based on the parameters received and entered by the user. <br><br>  The work of the plugin consists of three stages: <br><br>  1) Getting the necessary data from the BIM-model and loading into the form for editing; <br>  2) User editing parameters; <br>  3) Creating a schema. <br><br>  The plugin can be downloaded by <a href="http://www.bimelectro.ru/p/sld-revit.html">reference</a> . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/KOypfCsKdeA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  To retrieve the parameters of electrical systems, we access the active document: <br><br><pre><code class="cs hljs">UIApplication uiapp = commandData.Application; UIDocument uidoc = uiapp.ActiveUIDocument; Application app = uiapp.Application; Document doc = doc.Document;</code> </pre> <br>  Next, we extract the necessary parameters from the BIM model.  In this example, we consider how to obtain the circuit parameters (number, power factor, cable type), as well as the cable core material from the cable line settings.  The search for the required parameters is carried out by ID using the list of <a href="http://www.revitapidocs.com/2017.1/fb011c91-be7e-f737-28c7-3f1e1917a0e0.htm">BuiltInParameters</a> .  This method of searching for a parameter will not depend on the localization of Revit. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,    "" ParameterValueProvider provider = new ParameterValueProvider(new ElementId((int)BuiltInParameter.RBS_ELEC_CIRCUIT_PANEL_PARAM)); FilterStringRule rule = new FilterStringRule(provider, new FilterStringEquals(), "", true); ElementParameterFilter filter = new ElementParameterFilter(rule); ICollection&lt;Element&gt; docCircuits = (new FilteredElementCollector(doc)) .OfCategory(BuiltInCategory.OST_ElectricalCircuit) .WherePasses(filter) .ToArray(); foreach (Element docCircuit in docCircuits) { //  num = docCircuit.get_Parameter(BuiltInParameter.RBS_ELEC_CIRCUIT_NUMBER)? .Element.Name; //  powerFactor = docCircuit.get_Parameter(BuiltInParameter.RBS_ELEC_POWER_FACTOR)? .AsValueString(); //  cableType = docCircuit.get_Parameter(BuiltInParameter.RBS_ELEC_CIRCUIT_WIRE_TYPE_PARAM)? .AsValueString(); //  Element wireType = new FilteredElementCollector(doc) .OfClass(typeof(WireType)) .FirstOrDefault&lt;Element&gt;( e =&gt; e.Name.Equals(cableType)); string coreMaterial = wireType.get_Parameter(BuiltInParameter.RBS_WIRE_MATERIAL_PARAM) .AsValueString(); }</span></span></code> </pre><br>  After obtaining the necessary parameters, you can proceed to the creation of the scheme.  We create transaction and we insert elements of the scheme into the file.  By the way, the units of measurement are feet, so when inserting elements you need not to forget about it. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (Transaction tx = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Transaction(doc)) { tx.Start(<span class="hljs-string"><span class="hljs-string">"  "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> xCoord = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    foreach (Circuit circuit in panel.circuits) { //      . FamilySymbol lineSymbol = FilteredElementCollector(doc) .OfClass(typeof(FamilySymbol)) .Where(q =&gt; q.Name == "SLD_") .First() as FamilySymbol; //        XYZ coords = new XYZ(xCoord, 0, 0).ToFeets(); //    SLD_ FamilyInstance line = doc.Create.NewFamilyInstance(coords, lineSymbol, uidoc.ActiveView); //    ParameterSet parametersLineOut = line.Parameters; //     foreach (Parameter param in parametersLineOut) { switch (param.Definition.Name) { case " ": param.Set(circuit.number); break; case " ": param.Set(circuit.cableType); break; case " ": param.Set(circuit.powerFactor); break; } } xCoord = xCoord + 25; } tx.Commit(); }</span></span></code> </pre><br>  Everything, the scheme is ready! </div><p>Source: <a href="https://habr.com/ru/post/330128/">https://habr.com/ru/post/330128/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330118/index.html">British satellite imagery 2: how it was in reality</a></li>
<li><a href="../330120/index.html">Data recovery from an external hard drive Seagate FreeAgent Go</a></li>
<li><a href="../330122/index.html">‚ÄúAn interesting topic for discussion is the relativity of test coverage‚Äù: T-Systems about testing</a></li>
<li><a href="../330124/index.html">Orange Pi on car wash part 3</a></li>
<li><a href="../330126/index.html">Electronic signature in Bitrix24. Theory and experience of implementation</a></li>
<li><a href="../330130/index.html">Task: find a triangle with a smaller perimeter</a></li>
<li><a href="../330134/index.html">Synchronize database structure between applications</a></li>
<li><a href="../330140/index.html">Blockchain + distributed storage = Sia</a></li>
<li><a href="../330142/index.html">3 Ways to Break Single Responsibility Principle</a></li>
<li><a href="../330144/index.html">Teamwork. How to reconcile the designer and coder</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>