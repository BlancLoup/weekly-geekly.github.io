<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Commercial self-extracting archives: security, principles of operation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the major existing problems in the development and dissemination of information technologies is the protection of copyright on such intellectua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Commercial self-extracting archives: security, principles of operation</h1><div class="post__text post__text-html js-mediator-article">  One of the major existing problems in the development and dissemination of information technologies is the protection of copyright on such intellectual property as software, audio, video materials and any other information that can be presented in electronic form.  The owners of such objects have to resort to various means of protection against copying and unauthorized distribution, which often have sometimes more value than the objects of protection themselves. <br><a name="habracut"></a><br>  However, in some cases there is a problem of commercial distribution of digital content, which has a fairly low cost, and therefore it is not economically feasible to use expensive remedies.  In connection with this situation in the intellectual property market, relatively recently appeared affordable (in fact, free) for any user, including without any special skills, content protection tools that make it possible to profit from the distribution of intellectual property.  The principle of operation of such tools is based on the creation of a self-extracting archive [1] (hereinafter CPA) (self-extracting archive, abbreviated as ‚ÄúSFX archive‚Äù), which requires payment for the extraction of files and subsequent input of a keyword (code).  CPA is created using a special client program that uses the features of the format of executable files [2] (in fact, steganographic insertion of data). <br>  The progenitor of the commercial CPA service was a program from the ZipCoin service, and it appeared in 2009.  The projects following it picked up the idea and began to develop this direction. <br><br>  <b>CPA General Information</b> <br><br>  It should be noted that CPA is still not a means of protection against unauthorized distribution and copying of information, since, after a one-time payment and unpacking of intellectual property, packaged intellectual property items do not contain and, therefore, can be distributed uncontrollably.  Therefore, when it comes to paid CPAs, first of all we mean a convenient, simple, practically free way of commercial information dissemination without the use of expensive security tools. <br>  Payment for unpacking a commercial CPA can be made using all sorts of available ways for the user, such as transferring to electronic money (Webmoney, Yandex.Money, RBK-money, PayPal, Dengi@Mail.ru, Moneymail RUR, EasyPay, etc. [3]), payment by SMS, transfer to a bank card.  Opportunities A variety of payment methods directly depends on the capabilities of the ‚Äúintermediary‚Äù acting as an arbitrator in the calculations between the ‚Äúowner of information‚Äù and the end user.  As a rule, some commission is charged for mediation. <br>  Often, such ‚Äúintermediaries‚Äù use the services of services ‚Äî payment systems [4], which provide their services for receiving and paying payments in virtually any electronic currency, using SMS messages, through various money transfer systems, payment terminals, and bank cards.  An example of such services is Robokassa (http://robokassa.ru/), LiqPAY (http://liqpay.com), AvisoSMS (http://avisosms.ru/), a1pay (http: // a1pay. ru /). <br>  Currently on the market there are the following services that provide services for CPA: <br><ol><li>  WebZipMoney (http://webzipmoney.ru/, 2010). </li><li>  ZipMonster (http://zipmonster.ru/, 2010). </li><li>  CashMagnat (http://cashmagnat.ru/, 2010). </li><li>  FILECASH (http://filecash.su/, 2009). </li><li>  ZIPS (http://zipseller.ru/, 2010). </li><li>  ZipCoin (http://zipcoin.ru/, 2009). </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Functional diagram of the service of commercial self-extracting archives</b> <br><br>  Typical service support commercial CPA, as a rule, consists of the following elements: <br><ol><li>  Client program. </li><li>  Web service for service partners. </li><li>  Database. </li><li>  Payment service. </li><li>  Web directory (file storage). </li></ol><br>  The client program provides the ability to pack files of any format in the CPA, which later on, when unpacking, the mechanism for extracting the packed data after payment and entering the keyword. <br>  The web service is necessary for registering partners who use a client program for packing files and their further commercial distribution.  The web service should have the following functions: <br><ul><li>  provide detailed information about the rules, current rates, features of the system </li><li>  provide partner registration </li><li>  keep a statistical record of the number of requests / purchases of archives, their cost </li><li>  provide the client program with the necessary data for working with archives (information about a partner, archive, keywords, etc.) </li><li>  provide administrative functions such as adding, editing, deleting, locking archives and / or partners, </li><li>  to ensure the payment of money for the payment of archives, the accounting of settlement operations. </li></ul><br>  The database of the service, as a rule, stores detailed information about the packaged archives, partner data, statistical and billing information. <br>  The payment service performs using the payment system a set of procedures that ensure the transfer of money from the user to the web service with the subsequent redistribution of funds between the web services as a commission-fee for mediation and paying for the purchase of content to the partner. <br>  A web directory is used to advertise and distribute relevant content.  This may be a program catalog, a catalog of audio or video materials, file storages, etc. <br><br>  Below, in Figure 1, a typical functional diagram of a commercial CPA service is presented: <br><br>  The service operation algorithm can be divided into the following stages: <br><ol><li>  Registration partner. </li><li>  Download partner program. </li><li>  Creating archives. </li><li>  Publish archives. </li><li>  Download user archive. </li><li>  Initialization of the payment process. </li><li>  Support of the transfer of funds. </li><li>  Keyword Formation. </li><li>  Getting, entering a keyword and unpacking the archive. </li></ol><br><br><img src="https://habrastorage.org/getpro/habr/post_images/856/653/bbb/856653bbb770d2f19b11825051abca43.gif" alt="image"><br><br>  Fig.1 Functional diagram of the service commercial <br><br>  At the stage of registering a partner on the web service, personal data and payment information about the partner are recorded and entered into the database.  The partner is provided with a unique number and registration data for accessing the ‚Äúpersonal account‚Äù on the web service. <br>  After registration by a partner, steps 2-4 are carried out independently or through third parties.  At the same time, at the stage of creating the archive, the partner specifies its cost, name, as well as additional information about the archive. <br>  After a potential user downloads an archive, if he agrees to purchase content that is attached to the archive, the payment process is initiated.  At this stage, the client program built into the archive sends a request to the web service indicated in Figure 1. The request specifies the unique characteristics of the archive. <br>  The web service together with the payment service provides for the transfer and redistribution of funds: <br><ul><li>  reward web service in the amount of the stated commission; </li><li>  commission payment service; </li><li>  commission payment systems; </li><li>  partnership rewards for digital content. </li></ul><br>  After a successful transfer of money, the web service generates a keyword (code) and sends it to the client program.  Purchase information is entered into the database and is subsequently displayed in the form of partner sales statistics and web service statistics. <br>  The client program receives the code, checks its correctness and then initiates the process of unpacking the content, after which the user gets access to it. <br><br>  <b>Description of the approach to the protection of digital content in self-extracting archives.</b> <br><br>  A self-extracting archive is a file (computer program) that combines the archive and the executable code to unpack it.  Such archives, unlike the usual ones, do not require a separate program for unpacking them (obtaining the source files from which they were created), if the executable code can be executed in the specified operating system. <br>  As a rule, commercial CPAs use the features of PE format [5] - the format of executable files, object code and dynamic libraries used in 32-bit and 64-bit versions of the Microsoft Windows operating system, which allow embedding data at the end of the file.  The generalized structure of a PE file presented in Figure 2. For example, the format of an executable EXE file allows you to write absolutely any data to the end of the program file, while the program will work as before.  In fact, the possibilities of computer steganography and steganographic concealment of data in the format of an executable file are used [6].  These features are PE format and are used by some CPA services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c4/cd4/466/4c4cd44663b014510a029171da134ddc.gif" alt="image"><br><br>  Fig.  2 Generalized PE File Format <br><br>  Figure 3 shows a possible layout of the CPA. <br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e80/800/232/e808002325e875acd9d2fae79f4af331.gif" alt="image"><br><br>  Fig.  3. Layout option CPA <br><br>  Thus, the technology of the CPA boils down to the following stages: <br>  1. Run the program and enter the partner's credentials for access via the client program to the CPA web service. <br>  2. Select the required files with their parameters. <br>  3. Packing selected in files in CPA. <br>  3.1.  Writing the source program code to the CPA target file. <br>  3.2.  Web service request for unique archive parameters (archive identifier, keyword). <br>  3.3.  Record in CPA of the marker of the beginning of the header of the embedded data after the code of the source program. <br>  3.4.  Generation and recording of embedded data header. <br>  3.5.  Digital content archiving. <br>  3.6.  Digital Content Encryption. <br>  3.7.  Record received data to the target file. <br><br>  It should be noted that the selected encryption algorithm, the key length and the key generation algorithm significantly affect the cracking resistance of CPA.  In addition, CPA is not without such a disadvantage as storing the key in the clear to the archive in the header of the archive. <br>  As a rule, the simplest addition modulo 2 "" operation is used as encryption, the key length does not exceed 256 bits, and the encryption algorithm is reduced to calculating the hash sum on the web server using the MD5 algorithm depending on the unique characteristics of the CPA.  Based on this, we can conclude that the use of commercial CPA is impractical for digital content with high value and cost and can be used only in limited cases when hacking does not lead to serious losses. <br>  Publicly available sources already contain references to the hacking of similar commercial CPAs, (for example, ‚ÄúHacking paid ZipCoin archives‚Äù - <a href="http://www.it-world.kz/%3Fp%3D999">www.it-world.kz/?p=999</a> - the date of circulation February 23, <a href="http://www.it-world.kz/%3Fp%3D999">2011</a> ), which causes serious damage to the partners of these systems. <br><br>  BIBLIOGRAPHY <br><br>  1. Self-extracting archive.  [Electronic resource].  URL: <a href="http://ru.wikipedia.org/wiki/SFX">ru.wikipedia.org/wiki/SFX</a> (appeal date 02/23/2011) ... <br>  2. Electronic money [Electronic resource.] URL: <a href="http://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B5_%25D0%25B4%25D0%25B5%25D0%25BD%25D1%258C%25D0%25B3%25D0%25B8">ru.wikipedia.org/wiki/Electronic_money</a> (appeal date 02/23/2011) ... <br>  3. The format of executable files.  [Electronic resource].  URL: <a href="http://www.intuit.ru/department/pl/cil/3/">www.intuit.ru/department/pl/cil/3</a> (appeal date 02/23/2011) ... <br>  4. Payment system.  [Electronic resource].  URL: <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BB%25D0%25B0%25D1%2582%25D0%25B5%25D0%25B6%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0">ru.wikipedia.org/wiki/Payment_System</a> (appeal date 23.02.2011) ... <br>  5. Micheal J. O'Leary, The Portable Executable Format.  Microsoft [Electronic resource].  URL: <a href="http://www.nikse.dk/petxt.html">www.nikse.dk/petxt.html</a> (appeal date 23.02.2011). <br>  6. I. V. Nechta, Steganography in Portable Executable Format Files, SibSUTI Bulletin.  2009. ‚Ññ 1. </div><p>Source: <a href="https://habr.com/ru/post/203494/">https://habr.com/ru/post/203494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203482/index.html">The digest of interesting news and materials from the world of PHP No. 30 (November 10‚Äî24, 2013)</a></li>
<li><a href="../203484/index.html">Query optimization. Basics of EXPLAIN in PostgreSQL (part 3)</a></li>
<li><a href="../203488/index.html">Desktop in a home server or all-in-one</a></li>
<li><a href="../203490/index.html">Why 98% of the texts on your sites do not work. At all. And how to fix it</a></li>
<li><a href="../203492/index.html">Do not trust "people of the people"</a></li>
<li><a href="../203496/index.html">New domains for brands: make.believe</a></li>
<li><a href="../203500/index.html">ABCat: New version of the application for downloading and cataloging audiobooks</a></li>
<li><a href="../203502/index.html">Installing Ansible AWX on Debian 7.1</a></li>
<li><a href="../203504/index.html">How I hung up hotkeys on the Unity sound indicator</a></li>
<li><a href="../203506/index.html">TDD for Responsive Design. Or how to automate site display testing for different devices using the Galen Framework</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>