<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mongoose: a tool for testing the performance of storage</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, Habr. It will be a question of the performance testing tool for storage systems (data storage systems), which was originally developed in th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mongoose: a tool for testing the performance of storage</h1><div class="post__text post__text-html js-mediator-article">  Good day, Habr.  It will be a question of the performance testing tool for storage systems (data storage systems), which was originally developed in the depths of EMC for internal needs, but which has the ability to grow smoothly.  By the way, literally ‚Äúyesterday‚Äù the <a href="http://emc-mongoose.github.io/mongoose/">mongoose</a> received the status of the <a href="https://github.com/emc-mongoose/mongoose">OpenSource project</a> .  And this means that the time has come to tell a little about him.  So, what is this beast? <br><br><img width="400" src="http://i.piccy.info/i9/3bc7204e84ed50cd659431d5544642fd/1469568252/79428/722110/tumblr_nd9z5a4UWK1qbg9oio5_500.jpg" alt="image"><br><a name="habracut"></a><br><h4>  Key Features </h4><br><ol><li>  <b>Distributed mode</b> <br>  It is a way to perform load tasks simultaneously from many network nodes with centralized control and collection of metrics.  A simplified illustration of the documentation: <br><img width="400" src="https://habrastorage.org/getpro/habr/post_images/14b/eb7/95b/14beb795b0a0c06ffa7a8251e0f41487.png"><br>  Allows you to significantly increase the load on distributed storage systems, emulating the requests of a large number of users. <br><br></li><li>  <b>Reporting</b> <br><ul><li>  Output files with lists of processed objects (files, ...) that can be reused as input </li><li>  Availability of high resolution time stamps (ms) for each individual operation </li></ul><br></li><li>  <b>CRUD</b> ( <b>C</b> reate / <b>R</b> ead / <b>U</b> pdate / <b>D</b> elete) - available types of I / O operations to create load <br></li><li>  <b>Support for various storage types:</b> <br><ul><li>  Amazon S3 REST API </li><li>  EMC Atmos REST API </li><li>  OpenStack Swift REST API </li><li>  File system (local, NFS mount, ...) </li></ul><br></li><li>  <b>Supported object types:</b> <br><ul><li>  Containers (they are also directories in the case of FS, they are also buckets in case of S3) </li><li>  Data (files in the case of working with the file system) </li></ul><br></li><li>  <b>Verification of data</b> when performing a read operation </li><li>  <b>Generate arbitrary data</b> (incompressible uniform noise, text, or identical bytes) </li><li>  <b>Scripting language</b> </li><li>  <b>"Stub"</b> : HTTP-server that implements the functions of cloud storage, which does not store data, but is able to give them back when reading.  In fact, the storage mock to test the functionality and performance of the mongoose itself.  To soon become a distributed stub, as well as the FS driver. <br></li><li>  <b>Web GUI</b> </li><li>  And many other wonderful things, the transfer of which will take too much space. </li></ol><br><h4>  Known analogues </h4><br><ul><li>  <a href="http://jmeter.apache.org/">Apache jmeter</a> <br>  The analog is very conditional and has so little in common with the mongoose that the comparison is almost impossible. <br></li><li>  <a href="https://github.com/intel-cloud/cosbench">COSBench</a> (Intel) <br>  More similar in functionality than JMeter. <br>  Advantages: has a longer development history and more active developers, supports a wider range of storage systems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Disadvantages: is inferior in a number of functional points (generation of arbitrary data, for example) and performance (does not solve the so-called problem ‚ÄúS10K‚Äù). <br><br></li></ul><br><h4>  A few words about the high load </h4><br>  Since the performance testing tool must create a high I / O load, this tool itself must be very productive, and it must be very efficient in using the resources of the environment. <br><ol><li>  <b>Problem Solving <a href="https://en.wikipedia.org/wiki/C10k_problem">C10K</a></b> <br>  In earlier versions of the Mongoose, execution threads were tied to the appropriate connections.  It quickly became clear that such an approach was flawed.  When working with large objects with a large number of threads, the performance indicators were especially bad.  However, after applying event-oriented asynchronous I / O, the results began to impress.  The tool demonstrated performance even with 1 million simultaneously open connections, even without the use of <i>distributed mode</i> , which allows to multiply this number. <br><br><img width="400" src="http://i.piccy.info/i9/fb69f733184c966ad4fbdd109235d722/1469534080/55227/732090/818343149_4347189.jpg"><br><br></li><li>  <b><a href="https://ru.wikipedia.org/wiki/Zero-copy">Zero Copy</a></b> wherever possible </li><li>  Automatic configuration of I / O buffer sizes based on known sizes of transmitted data.  Small objects - less buffer, large objects - more buffer.  Write - more output buffer, read - more input buffer.  Actually, the buffers are located in Direct Memory to ensure Zero Copy </li></ol><br><h4>  How it looks in practice </h4><br>  Once you have downloaded the tarball with the latest version and unpacked it, launching the mongoose happens to disgrace is simple: <br><pre><code class="bash hljs">java -jar mongoose-&lt;VERSION&gt;/mongoose.jar</code> </pre> <br>  This will lead to the Mongoose trying to do everything by default: <br><ul><li>  Create new objects (create) forever (until the user interrupts) </li><li>  Use S3 API (i.e. generate HTTP requests) </li><li>  Use 1 connection to the default address (127.0.0.1:9020) </li></ul><br>  To see something other than errors in this case, you can try running a stub on the same machine (which will serve as the storage mock): <br><pre> <code class="bash hljs">java -jar mongoose-&lt;VERSION&gt;/mongoose.jar wsmock</code> </pre><br><br>  For those who want to use the GUI, you will need to run the following command: <br><pre> <code class="bash hljs">java -jar mongoose-&lt;VERSION&gt;/mongoose.jar webui</code> </pre><br>  And go to the browser at 127.0.0.1:8080. <br><img src="https://habrastorage.org/getpro/habr/post_images/85f/339/473/85f33947305319c57562349f0fc06563.gif"><br><br>  Another important feature is custom scripts.  The script is recorded in JSON format and can be specified at startup as follows. <br><pre> <code class="bash hljs">java -jar mongoose-&lt;VERSION&gt;/mongoose.jar -f &lt;PATH_TO_SCENARIO_FILE&gt;.json</code> </pre><br>  One of the simplest scenarios is as follows: <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"load"</span></span> }</code> </pre><br>  This script is used by the mongoose by default when no other script file is specified explicitly.  Slightly more complex script example: <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"for"</span></span>, <span class="hljs-string"><span class="hljs-string">"value"</span></span> : <span class="hljs-string"><span class="hljs-string">"threads"</span></span>, <span class="hljs-string"><span class="hljs-string">"in"</span></span> : [ <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">10000</span></span>, <span class="hljs-number"><span class="hljs-number">100000</span></span> ], <span class="hljs-string"><span class="hljs-string">"config"</span></span> : { <span class="hljs-string"><span class="hljs-string">"load"</span></span> : { <span class="hljs-string"><span class="hljs-string">"threads"</span></span> : <span class="hljs-string"><span class="hljs-string">"${threads}"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"jobs"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"type"</span></span> : <span class="hljs-string"><span class="hljs-string">"load"</span></span> } ] }</code> </pre><br><br>  More detailed information on the use is available in the ‚ÄúDocumentation‚Äù section of <a href="http://emc-mongoose.github.io/mongoose/">the Mongoose website</a> . <br><br><h4>  What's next? </h4><br>  By the time this article was written, the last stable version is 2.4.1.  Currently, an active development of version 3 is underway, in which a new architecture will be applied (monitor - generator - driver - monitor), which opens up new possibilities for distributed operation and scenarios such as "weighted load". <br><br><img width="400" src="https://habrastorage.org/getpro/habr/post_images/190/958/fe2/190958fe2f1e1ef2134fd8d458de6a1a.jpg"><br><br>  Future plans also include the following: <br><ul><li>  Extending Web GUI </li><li>  Implementation of operations of incomplete (partial) data reading </li><li>  Expanding the range of supported storage types (Google Cloud Storage, EMC Centera, ...) </li><li>  DBMS Support (?) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/306448/">https://habr.com/ru/post/306448/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306434/index.html">Automation of laboratory measurements</a></li>
<li><a href="../306436/index.html">Simple, versatile and reliable IDOL printer control language</a></li>
<li><a href="../306440/index.html">Mobile App Reputation Management</a></li>
<li><a href="../306442/index.html">Choosing the best online CSS compression service</a></li>
<li><a href="../306446/index.html">Drupal Critical Vulnerabilities: Details and Exploits</a></li>
<li><a href="../306450/index.html">Part 2. DSS Universal Algorithms - Support Service Algorithm</a></li>
<li><a href="../306452/index.html">Keep data under control</a></li>
<li><a href="../306454/index.html">AI 101: An Introduction to Automation and Artificial Intelligence in Outsourcing</a></li>
<li><a href="../306456/index.html">The history of one diploma or how to make a sharabota</a></li>
<li><a href="../306458/index.html">AMOcrm and Hive: high-tech business model for online stores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>