<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HD FPV on Raspberry Pi</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Crimson HD FPV foam 

 After reviewing in detail the article of the article Iron samples for HD FPV , it was decided to repeat the feat based on the R...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HD FPV on Raspberry Pi</h1><div class="post__text post__text-html js-mediator-article"><h4>  Crimson HD FPV foam </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/4c1/f57/a56/4c1f57a56712f20828531f3a99adfc6d.jpg"><br>  After reviewing in detail the article of the article <a href="http://habrahabr.ru/company/virt2real/blog/218611/">Iron samples for HD FPV</a> , it was decided to repeat the feat based on the Raspberry Pi + Pi Camera. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  With the main idea of ‚Äã‚Äãthe habrauser <a href="https://habrahabr.ru/users/gol/" class="user_link">Gol</a> about analog FPV, I completely agree!  In the digital age, enjoy the PAL signal, akin to breathing in the scent of flowers in a gas mask (IMHO).  Armed with a crimson set, it was decided to remove the <s>gas mask of a</s> high-resolution video, broadcast it in real-time to the ground, and on the ground <s>enjoy the scent of flowers to</s> fly looking at the monitor, and in perspective in HD glasses. <br><table><tbody><tr><td>  Raspberry pi <br><img src="https://habrastorage.org/getpro/habr/post_images/426/50c/ee0/42650cee02e267765057cf5d121622ae.jpg"></td><td>  Pi Camera <br><img src="https://habrastorage.org/getpro/habr/post_images/94f/05f/909/94f05f909daa4854ba17e11978722c11.jpg"></td></tr></tbody></table><br>  For Wi-Fi bridge used proven <b><a href="http://www.ubnt.com/airmax">ubiquiti bullet m2 hp</a></b> . <br><img src="https://habrastorage.org/getpro/habr/post_images/a06/8f5/19c/a068f519cd612c460a09a7662ddc5be1.jpg"><br>  This Wi-Fi module is great for mobile platforms.  easily powered by POE from an onboard battery; it is enough to supply power to two pairs (7-24V, blue pair <b>+</b> , brown pair <b>-</b> ), has small dimensions, has good power and industrial performance.  Also a nice bonus is the <a href="http://www.ubnt.com/airmax">model</a> at 5.8 GHz in a similar form factor, which allows, without changing the design of the platform, to switch to a different frequency range, simply replacing the Wi-Fi module and antenna. <br><br>  As an experimental carrier of <s>insane ideas</s> of the equipment under test, we have long used <a href="http://www.hobbyking.com/hobbyking/store/__14465__EPP_FPV_1_8M_X_Large_EPP_Carbon_Fiber_R_C_Plane.html">foam</a> (flying foam) acquired in hobbiking.  On this unit, all emerging ideas related to the UAV are practically being worked out. <br><img src="https://habrastorage.org/getpro/habr/post_images/830/e9b/ea7/830e9bea718dec1d3246877b4800cddd.jpg"><br>  The advantages of this unit is the ease of installation of the necessary equipment, ease of piloting, carrying capacity and enormous maintainability.  The latter feature rescued more than once after the crash, everything is assembled on epoxy glue and our <s>armored train</s> Penolet is again ready for the <s>crash</s> test. <br><br><h4>  Foam payload </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/35e/e32/b05/35ee32b0586380ea6dc3aa3446412b75.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/1d6/777/c97/1d6777c9733c07db890c7b4e1ff3d929.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Camera </li><li>  Raspberry running raspbian </li><li>  Wi-Fi module with antenna </li><li>  Voltage indicator </li><li>  Main toggle switch </li><li>  Raspberry power supply </li><li>  Battery connector </li></ul><br>  A homemade 2.4 GHz clover from an analog FPV and an ordinary Wi-Fi pin were used as antennas. <br><br><h4>  Land </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/fdf/d52/13f/fdfd5213f21b63d58698128e05939172.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/867/ea5/e0d/867ea5e0d45bcdef29b9874228d7fcde.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/5c3/63d/a48/5c363da489d50c952faeef2661add7b3.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/c4f/ace/be6/c4facebe66b962e6876fabaefb1e4dee.jpg"><br><br><ul><li>  Laptop running Ubuntu 12.04 LTS with a sun visor </li><li>  Athena <a href="http://www.dlink.ru/ru/products/2/228_b.html">D-Link ANT24-0801</a> </li><li>  Wi-Fi module </li><li>  Battery power module </li></ul><br>  <a href="http://www.dlink.ru/ru/products/2/228_b.html">The antenna</a> was selected on the basis of a wide radiation pattern of 70 degrees vertically, 70 degrees horizontally. <br><br><h4>  Soft </h4><br>  Broadcast was carried out using <a href="http://gstreamer.freedesktop.org/">Gstreamer</a> . <br><br>  The first important point.  My colleague set up the software, for which he thanks.  I will simply give the used scripts to run the broadcast on raspberries and receive the video stream on the laptop. <br><br><h5>  Board </h5><br> <code>raspivid -n -w 1280 -h 720 -b 4500000 -fps 30 -vf -hf -t 0 -o - | \ <br> gst-launch-1.0 -v fdsrc ! h264parse ! rtph264pay config-interval=10 pt=96 ! \ <br> udpsink host=192.168.4.204 port=9000</code> <br> <br><h5>  Land </h5><br> <code>gst-launch-1.0 -v udpsrc port=9000 caps='application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)H264' ! rtph264depay ! avdec_h264 ! videoconvert ! autovideosink sync=false</code> <br> <br><h4>  Go... </h4><br>  The second important point.  I am not a pilot.  An experienced pilot controlled the foam, for which a special thanks to him.  We fly for a long time and successfully on different devices.  At this stage, I acted as a starting upper stage. <br><img src="https://habrastorage.org/getpro/habr/post_images/baf/71e/ff1/baf71eff1201f598353d234033d60572.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/79a/11b/766/79a11b7667e7351b749224610f5351c8.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/365/680/829/365680829d49bdc920f9d41e008961e1.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/330/057/7ff/3300577ffa26c558920f81ebb8971629.jpg"><br><br><h4>  ... arrived </h4><br>  With flights it happened exactly three times, because  all the same, we overloaded the plane, shoving a very large battery into it, hoping to fly very long.  Because of this, and so the low-speed machine has become quite cumbersome.  When landing, it was not possible to overcome the lateral gust of wind, the device fell on the wing and stuck its nose to the ground.  A large and heavy battery decided to break out and finally broke free, slightly breaking the foam fuselage (I wrote about maintainability, the epoxy had already dried up, the <s>armored train</s> had been ready for flight).  In general, the equipment is not affected.  But every cloud has a silver lining ... HD FPV WAS! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2fd/214/2b8/2fd2142b8bc4211efcace41c84964d8b.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/85a/67f/d58/85a67fd581f92cc9792cfcaef9368bed.jpg"><br><br>  That's why everything was started! <br><img src="https://habrastorage.org/getpro/habr/post_images/31f/3e7/014/31f3e70148037c4afb6484023a9c340a.jpg"><br><br>  HD FPV was ... just not far away.  It was really possible to get a video without lags on a very small part of the field. <br><img src="https://habrastorage.org/getpro/habr/post_images/66e/ff8/df0/66eff8df0a274abfafd025022659e43c.jpg"><br><br>  The whip antenna according to its radiation pattern (horizontal donut) behaves ... like a whip antenna, i.e.  at the height and with strong inclinations / turns, when the petal misses the receiving antenna, lags begin. <br>  Video from the whip antenna, wrote from the monitor screen 15 fps ... gives some picture of what is happening. <br><iframe width="560" height="315" src="https://www.youtube.com/embed/FJKnFJG_a0M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  In the future, direct recording of the received stream will be configured. <br><br>  The antenna "clover" has a spherical radiation pattern, but not a very high range for our channel, therefore, with the "long-distance" spans, a rake also appeared on the image.  Video unfortunately not. <br><br>  After the crash, two hikes were conducted on foot across the field with different antennas and as they say, the result is a bit predictable: the range leaves much to be desired, the whip antenna works a little further than 300-400 meters if the plane of the petal (donut) falls into the receiving antenna, the ‚Äúclover‚Äù can twirl as you like, but because  it broadcasts in all directions the same range even less than the ‚Äúpin‚Äù to 300 meters. <br><br><h4>  findings </h4><br>  FPV HD flights are a reality!  WORKS! <br><br>  Otherwise, the conclusions are the same as for <a href="https://habrahabr.ru/users/gol/" class="user_link">Gol</a> .  The weak point of the Wi-Fi, or rather the on-board antenna, if on the ground you can deploy a rotary station tracking the UAV with a narrow antenna, then you need to reinvent something else with the board.  To optimize the work of the wifi channel, the modules used have many settings, you need to dig in more detail there.  Optimize (minimize) the flow from the board.  And it is natural to think of a solution with an onboard antenna. <br><br>  <b>PS I</b> found in the settings of the Earth module wifi that the low signal power was set to 10dBm instead of the prescribed 28dBm.  <s>This is a failure</s> to work on. <br><br><h4>  Plans for the near future </h4><br><ul><li>  Put on board the <a href="http://store.3drobotics.com/products/apm-2-6-kit-1">Ardupilot 2.0</a> highbrow brains (link to a slightly later model), since they already have been run in on this foam well - this will allow the <s>pilot not</s> to <s>be nervous and</s> fly away, because  the brains, on command, return the foyer to the launch site on autopilot and, importantly, stabilize the glider in the horizontal plane even during turns - this will allow more efficient testing of the whip antenna. </li><li>  Install (already on the way from China) and test the 2.4 GHz ceiling antenna.  She has a hemisphere facing downward pattern, as we say, we will see. </li><li>  Test modules at 5.8 GHz. </li><li>  To organize on earth the recording of a stream to a file, otherwise it is somehow not human. </li><li>  <b>PS</b> And still turn on the <s>brain</s> radiator at full capacity! </li></ul><br><br>  The third important point and gratitude to my wife for moral support and skillful possession of the camera, without which there would have been no great pictures of the whole process. <br><br>  <a href="http://habrahabr.ru/post/220953/">Next part</a> </div><p>Source: <a href="https://habr.com/ru/post/220019/">https://habr.com/ru/post/220019/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220009/index.html">Warm lamp light</a></li>
<li><a href="../220011/index.html">Making a spherical panorama by Google</a></li>
<li><a href="../220013/index.html">Neutralizing the effects of Heartbleed in Drupal 7</a></li>
<li><a href="../220015/index.html">Organizing web-based interaction with the Spring application</a></li>
<li><a href="../220017/index.html">Hope Microelectronics 24-bit I2C Pressure Sensors HP203B and HP206C</a></li>
<li><a href="../220021/index.html">From the IT preacher to the designer of medical robots: future professions in IT and robotics</a></li>
<li><a href="../220023/index.html">Use of encryption in Russian companies</a></li>
<li><a href="../220025/index.html">Secure payment card do it yourself</a></li>
<li><a href="../220027/index.html">Who does BillGates attack?</a></li>
<li><a href="../220031/index.html">Writing Penguin Daycare Simulator on Go (Google App Engine) and Lua (Corona SDK)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>