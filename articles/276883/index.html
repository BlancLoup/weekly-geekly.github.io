<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Nuget ++ for the poor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you regularly write in C ++ using third-party libraries (okromya boost) and you are tired of constantly setting the paths to folders with headers a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Nuget ++ for the poor</h1><div class="post__text post__text-html js-mediator-article">  If you regularly write in C ++ using third-party libraries (okromya boost) and you are tired of constantly setting the paths to folders with headers and libs, then under the cat you will find one way to automate this somewhat. <br><br>  Every time starting a small ConsoleApplication project in VisualStudio, in order to try out the idea that came to mind, I feel pain.  The pain of constant settings in the sections <b>Properties-&gt; C / C ++ -&gt; General-&gt; Additional Include Directories</b> and <b>Properties-&gt; Linker-&gt; General-&gt; Additional Library Directories</b> . <br><br>  If there are 1-3 projects and a couple of third-party libraries in the Solution-e, then it is still tolerable, but for&gt; 10 projects and&gt; 5 libraries everything looks different.  And when one day my patience broke, I decided to automate this business somehow.  Taking the system for boost, I began to cut out my bike.  What I wanted to get from the solution: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Connecting third-party libraries by prescribing a 2-level include-a, including the name of the library, for example <pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;gtest/gtest.h&gt; #include &lt;vsqlite/connection.hpp&gt;</span></span></span></span></code> </pre> <br></li><li>  Automatic linking of the corresponding * .lib files when connecting a * .hpp file </li><li>  X86 / x64, Debug / Release, Static / Dynamic Runtime support </li><li>  The ability to quickly transfer to another machine </li></ol><a name="habracut"></a><br>  First of all, you should decide on the folder in which our repository will be stored. I have C: / nuget ++.  Inside, folders <b>include</b> , <b>lib / x86</b> , <b>lib / x64</b> , <b>projects</b> .  With the first 3, everything is clear, and in the third folder I store projects for building these same libraries. <br><br>  For example, take the <a href="https://github.com/google/googletest/tree/master/googletest">gtest</a> library, unzip it in the projects folder and open gtest-md.sln from the msvc folder. <br><br><img align="right" width="320" src="https://habrastorage.org/files/a69/ec6/790/a69ec679061d46d19dce7aa74a2a7aae">  Next, we copy all the headers from <b>projects / gtest / include / gtest</b> to <b>include / gtest /</b> .  To execute the first item, simply add a reference to nuget ++ / include to the global settings of c ++ projects.  In Visual Studio 2015 (and, as I recall, in 2013 too) it does this by opening the Property Manager window ( <b>View-&gt; Property Manager</b> ), and editing the <b>Microsoft.Cpp.Win32.user</b> and <b>Microsoft.Cpp.x64.user</b> files in any from configurations of any C ++ project.  Namely, we are interested in the section <b>Common Properties-&gt; C / C ++ -&gt; General-&gt; Additional Include Directories ‚Äî we</b> simply add a stupid path to the include folder of our nuget, for example <b>C: \ nuget ++ \ include;% (AdditionalIncludeDirectories)</b> . <br><br>  To perform the 2nd and 3rd paragraph will have a little tricky.  To begin with we will create for our library 4 configurations for x86 / x64 and Static / Dynamic Runtime.  In the project properties, we change the name of the output file and the linking variant of the runtime library for each of the configurations in the sections <b>Properties-&gt; Configuration Properties-&gt; General-&gt; Target Name</b> and <b>Properties-&gt; Configuration Properties-&gt; C / C ++ -&gt; Code Generation,</b> respectively. <br><table><tbody><tr><td>  <b>Configuration</b> </td><td>  <b>Output file name</b> </td><td>  <b>Runtime library</b> </td></tr><tr><td>  Release Static Runtime </td><td>  $ (ProjectName) -vc $ (PlatformToolsetVersion) -mt-s </td><td>  Multi-threaded (/ MT) </td></tr><tr><td>  Release Dynamic Runtime </td><td>  $ (ProjectName) -vc $ (PlatformToolsetVersion) -mt </td><td>  Multi-threaded DLL (/ MD) </td></tr><tr><td>  Debug Static Runtime </td><td>  $ (ProjectName) -vc $ (PlatformToolsetVersion) -mt-sgd </td><td>  Multi-threaded Debug (/ MTd) </td></tr><tr><td>  Debug Dynamic Runtime </td><td>  $ (ProjectName) -vc $ (PlatformToolsetVersion) -mt-gd </td><td>  Multi-threaded Debug DLL (/ MDd) </td></tr></tbody></table><br>  Having done batch-build, we will get 2 groups (x86 and x64) with 4 lib-files that need to be transferred to the <b>lib / x86</b> and <b>lib / x64</b> folders. <br>  For automatic linking of the specified files, you will have to shuffle a little over the library itself. First of all, add the auto_link.hpp file to the project and, for them, include it from all other headers.  By digging into MSDN on the topic of / MT, / MD, / MTd, / MDd keys, you can create a table with a unique set of macros for each configuration.  A bit of magic with macros and auto_link.hpp ready: <br><br><div class="spoiler">  <b class="spoiler_title">auto_link.hpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> _MSC_VER == 1500 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_TOOLSET </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"vc90"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> _MSC_VER == 1600 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_TOOLSET </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"vc100"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> _MSC_VER == 1700 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_TOOLSET </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"vc110"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> _MSC_VER == 1800 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_TOOLSET </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"vc120"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">elif</span></span></span><span class="hljs-meta"> _MSC_VER == 1900 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_TOOLSET </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"vc140"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(_MT) || defined(__MT__) # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_THREAD_OPT </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"mt"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_THREAD_OPT #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(_DEBUG) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(_DLL) # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_RT_OPT </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"-gd"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_RT_OPT </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"-sgd"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> defined(_DLL) # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_RT_OPT </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_RT_OPT </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"-s"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> GTEST_LIB #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GTEST_LIB_FULL_NAME </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"gtest-"</span></span></span><span class="hljs-meta"> GTEST_LIB_TOOLSET </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"-"</span></span></span><span class="hljs-meta"> GTEST_LIB_THREAD_OPT GTEST_LIB_RT_OPT </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">".lib"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> comment(lib, GTEST_LIB_FULL_NAME) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> message(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"linking to gtest:"</span></span></span><span class="hljs-meta"> GTEST_LIB_FULL_NAME) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre><br></div></div><br>  Create a test project, a few lines of code: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;gtest/gtest.h&gt; int main(int argc, char** argv) { ::testing::InitGoogleTest(&amp;argc, argv); return RUN_ALL_TESTS(); } TEST(autolink_tests, can_autolink_gtests){}</span></span></span></span></code> </pre><br>  Build and voila: <br><br><img src="https://habrastorage.org/files/552/2b9/20e/5522b920e6d448a1a74485e16bd9642f"><br><br>  To transfer the resulting repository (4 point), just copy it to another machine and set the paths to the include, lib / x86 and lib / x64 folders. <br><br>  As a bonus, we get compatibility with the boost; simply copy the hpp, lib and dll files to the appropriate directories.  As a result, having spent 1 working day on organizing my <i>own nuget ++ for the poor</i> , I got rid of a headache when using running third-party libraries.  Now in my arsenal of boost, cryptopp, gmock, gtest, jsoncpp, pugixml, vsqlite and this list is constantly expanding.  Plans to create a single Solution and set up Build events for automatically copying the necessary files to target directories. </div><p>Source: <a href="https://habr.com/ru/post/276883/">https://habr.com/ru/post/276883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276871/index.html">Tuples in programming languages. Part 1</a></li>
<li><a href="../276873/index.html">43 useful project management services. No epithets</a></li>
<li><a href="../276877/index.html">PCs, laptops and everything.</a></li>
<li><a href="../276879/index.html">Wifi-radio with a warm lamp display. Part 1. Display</a></li>
<li><a href="../276881/index.html">Meet Jack and Jill on x86</a></li>
<li><a href="../276885/index.html">Removing embedded Windows 10 applications after a failed Get-AppXPackage command</a></li>
<li><a href="../276889/index.html">Trojan Remtasu is a tool for hacking Facebook</a></li>
<li><a href="../276891/index.html">Online course "Introduction to theoretical computer science" by Alexander Hanievich Shen</a></li>
<li><a href="../276893/index.html">Rocker Gestures and other new items in the weekly assembly Vivaldi 1.0.390.3</a></li>
<li><a href="../276895/index.html">Schizoid programming language of self-learning algorithms "Author"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>