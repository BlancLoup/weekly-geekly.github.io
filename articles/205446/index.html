<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Variable number of arguments: problems and solutions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It will be about writing JavaScript functions with a variable number of arguments, problems arising in the process and ways to solve these problems. 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Variable number of arguments: problems and solutions</h1><div class="post__text post__text-html js-mediator-article">  It will be about writing JavaScript functions with a variable number of arguments, problems arising in the process and ways to solve these problems. <br><a name="habracut"></a><br><h4>  Problem </h4><br>  From time to time there is a need to write a function with a variable number of arguments.  This is especially true for libraries: there is an easy way to call a function that is appropriate in ninety percent of cases, and there is a complex one, needed in the remaining ten percent, when you need to transfer some additional settings or data. <br><br>  An example is jQuery.get, which can be called as $ .get (url, callback), or as $ .get (url, data, callback). <br><br>  JavaScript is not particularly rich in argument handling tools (unlike, for example, <a href="http://ru.diveintopython.net/apihelper_optional.html">Python</a> ), so in order to implement functions with an interface like jQuery.get, you have to write something like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openTheDoor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">door, options, callback</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> options === <span class="hljs-string"><span class="hljs-string">'function'</span></span>) { callback = options options = {} } <span class="hljs-comment"><span class="hljs-comment">//      var handlePosition = door.getHandlePosition() // ... }</span></span></code> </pre> <br>  What's wrong with this code? <br><br>  First, the beginning of the function does not carry a semantic load, it is just a superstructure above the method of passing arguments.  To see what the function does, you need to ‚Äúsquander‚Äù four lines of code in your head. <br><br>  Secondly, there is a temptation to combine juggling with parameters and assigning default values, and this can be sideways - the initialization will simply be ‚Äúsquandered‚Äù like a standard boilerplate next time. <br><br>  A similar approach can be found in the code of many libraries that work asynchronously.  This problem must have a solution. <br><br><h4>  Bad decisions </h4><br>  There are <a href="https://npmjs.org/search%3Fq%3Darguments">quite a few modules in the</a> npm registry that solve the problem by processing the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/arguments">arguments</a> object.  The code looks like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> somehowParse = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'some-fancy-args'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openTheDoor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = somehowParse(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>) <span class="hljs-comment"><span class="hljs-comment">//      //       var handlePosition = args.first.getHandlePosition() // ... }</span></span></code> </pre><br>  Some libraries provide a small ‚Äúparameter definition language‚Äù: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parseArgs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'another-fancy-args'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openTheDoor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = parseArgs([<span class="hljs-string"><span class="hljs-string">'door|obj'</span></span>, <span class="hljs-string"><span class="hljs-string">'options||obj'</span></span>, <span class="hljs-string"><span class="hljs-string">'callback||func'</span></span>], <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>) <span class="hljs-comment"><span class="hljs-comment">//      //   ,     var handlePosition = args.door.getHandlePosition() // ... }</span></span></code> </pre><br>  There are also magic libraries that call the original function twice in order to set the arguments correctly, and for this reason they force you to write code inside the anonymous function and pass it to the library call this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> magicArgs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'oh-so-magic-args'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openTheDoor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">door, options, callback</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> magicArgs(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, [<span class="hljs-string"><span class="hljs-string">'obj'</span></span>, <span class="hljs-string"><span class="hljs-string">'|obj'</span></span>, <span class="hljs-string"><span class="hljs-string">'|func'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      //     var handlePosition = door.getHandlePosition() // ... }) }</span></span></code> </pre><br>  What is bad about these decisions?  Yes, almost everything. <br><br>  The beginning of the function in any case remains a template that you need to ‚Äúsquander‚Äù to get to the code.  This template introduces an additional level of abstraction, and sometimes magic, in which you need to understand separately. <br><br>  "Nonmagic" libraries also spoil the code of the function itself a little - the parameters do not come in the form of separate variables, as is usually the case, but as an object, and the parameters do not always have names. <br><br><h4>  Towards a good decision </h4><br>  Let's talk about the functions. <br><br>  First, a well-written function should not have too many parameters.  If the function has more than three parameters, most likely it needs refactoring.  A complex function can be divided into several separate ones, it is possible to group part of the parameters into one parameter object, or to simplify and rewrite it in some way (a good book on the topic is <a href="http://www.ozon.ru/context/detail/id/1308678/">Refactoring. Improving the existing</a> Martin Fowler <a href="http://www.ozon.ru/context/detail/id/1308678/">code</a> ). <br><br>  Secondly, JavaScript uses a simple and logical scheme for working with missing parameters.  If the value for the parameter is not passed when the function is called, it becomes undefined.  To specify the default parameter values, it is convenient to use constructions of the form options = options ||  {}.  <sup>[one]</sup> <br><br>  Thirdly, there is the last callback agreement, which simplifies asynchronous programming.  In most cases, it is this agreement that makes it necessary to juggle with parameters ‚Äî since callback must always go last, the optional parameters are forced to be in the middle of the list. <br><br>  Taking into account all three points, we get a fairly simple solution: the only thing that should be done is to <i>add the list of arguments with undefined values ‚Äã‚Äãso that the callback takes its last place</i> .  This is what the <a href="https://npmjs.org/package/vargs-callback">vargs-callback</a> module <a href="https://npmjs.org/package/vargs-callback">does</a> , which I wrote to implement the solution I found. <br><br><h4>  Vargs-callback module </h4><br>  The module exports a single function that should be used as a decorator. <br><br>  Common (Named) Functions: <sup>[2]</sup> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vargs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'vargs-callback'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openTheDoor</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">door, options, callback</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     // options    undefined,      door  callback var handlePosition = door.getHandlePosition() // ... } openTheDoor = vargs(openTheDoor) //   </span></span></code> </pre><br>  Expression Functions: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vargs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'vargs-callback'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> openTheDoor = vargs(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">door, options, callback</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  - //     // options    undefined,      door  callback var handlePosition = door.getHandlePosition() // ... })</span></span></code> </pre><br>  The vargs decorator is triggered when the decorated function is called and performs the following: <br><br><ol><li>  If the number of passed arguments is less than the declared number of parameters and the last argument passed is of type ‚Äúfunction‚Äù, put the values ‚Äã‚Äãundefined before the last argument until the number of arguments and the number of parameters match. </li><li>  Call the decorated function with modified arguments. </li><li>  If enough arguments are passed or the last argument is not a function, do nothing. </li></ol><br><br><h4>  Conclusion </h4><br>  In the solution found, I can note the following advantages: <br><br>  No additional level of abstraction is used to define the parameters of the function.  There is no need for magic or ‚Äúparameter definition language‚Äù, only what is in JavaScript itself is used. <br><br>  The code becomes cleaner - the declared parameters are used, there is no need to ‚Äúflip through‚Äù the beginning of the function, and to set the default values ‚Äã‚Äãof the parameters, you can use the appropriate method for each case. <br><br>  How do you like the idea, colleagues? <br><br>  <a href="">Github source code</a> <br><br><h4>  Notes </h4><br><ol><li>  This method is not safe to use for parameters that can take falsy values.  You can use type checking for them: options = typeof options! == 'undefined'?  options: {} </li><li>  Meaning a <a href="http://learn.javascript.ru/function-declaration-expression">function declaration</a> . </li></ol></div><p>Source: <a href="https://habr.com/ru/post/205446/">https://habr.com/ru/post/205446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../205434/index.html">Unsealed - to jail</a></li>
<li><a href="../205436/index.html">Freelance engineering freelance or through the eyes of a design engineer</a></li>
<li><a href="../205440/index.html">Curiosity 2013: lake, geology, radiation</a></li>
<li><a href="../205442/index.html">Distribution of servers: sum up</a></li>
<li><a href="../205444/index.html">2GIS Dialer</a></li>
<li><a href="../205448/index.html">Interface Digest, October-November 2013</a></li>
<li><a href="../205450/index.html">Axure Interactive Prototype in 20 Minutes</a></li>
<li><a href="../205452/index.html">20 years DOOM</a></li>
<li><a href="../205454/index.html">Data replication. Attunity Replicate and Greenplum</a></li>
<li><a href="../205456/index.html">How to make friends with the Yandex API and AJAX captcha</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>