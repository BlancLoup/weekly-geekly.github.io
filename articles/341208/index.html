<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Barnes-Hut t-SNE and LargeVis: visualization of large amounts of data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With data sets of millions of instances in machine learning problems, you‚Äôll not surprise anyone for a long time. However, few people wonder how to vi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Barnes-Hut t-SNE and LargeVis: visualization of large amounts of data</h1><div class="post__text post__text-html js-mediator-article">  With data sets of millions of instances in machine learning problems, you‚Äôll not surprise anyone for a long time.  However, few people wonder how to visualize these titanic layers of information.  When the dataset size exceeds one million, it becomes rather sad to use the standard t-SNE;  It remains to be played with <a href="https://habrahabr.ru/post/340360/">downsampling</a> or even limited to coarse statistical tools.  But for each task there is a tool.  In my article, I would like to consider two algorithms that overcome the barrier of quadratic complexity: the already well-known Barnes-Hut t-SNE and the new contender for the ‚Äúgolden hammer infovis'a‚Äù LargeVis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hd/wx/pe/hdwxpexceqkd-q9fnoj0cgusmdo.png"></div><br>  <i>(This is not a picture of an abstract artist, but a visualization of LiveJournal dataset from a bird's-eye view)</i> <br><a name="habracut"></a><br><h3>  t-SNE with modifications </h3><br>  Although t-SNE is about ten years old, you can safely say that it has already been tested by time.  He is popular not only among experienced adepts of data science, but also among authors <a href="https://pudding.cool/2017/09/hip-hop-words/">of popular science articles</a> .  About him already <a href="https://habrahabr.ru/post/267041/">wrote</a> on Habr√©;  also about this visualization algorithm there are <a href="https://distill.pub/2016/misread-tsne/">many</a> <a href="https://lvdmaaten.github.io/tsne/">good</a> articles on the Internet. <br><br>  However, almost all of these articles talk about <i>standard</i> t-SNE.  I will remind him in brief: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Calculate a pair of data points for each pair. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-8" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-9">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.161ex" height="2.66ex" viewBox="0 -780.1 4374.7 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2C" x="916" y="0"></use><g transform="translate(1361,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="2576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6E" x="2921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-58" x="3522" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> x_i, x_j \ in X </script>  Their similarity to each other in the original space using the Gaussian kernel: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-13"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-16" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">j</span><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mo" id="MJXp-Span-19">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-22">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">c</span><span class="MJXp-mrow" id="MJXp-Span-27"><span class="MJXp-mtext" id="MJXp-Span-28">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">p</span><span class="MJXp-mrow" id="MJXp-Span-32"><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">t</span><span class="MJXp-mtext" id="MJXp-Span-40">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-45" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-50">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">t</span><span class="MJXp-mtext" id="MJXp-Span-56">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-57"><span class="MJXp-mrow" id="MJXp-Span-58" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-60" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-64">2</span><span class="MJXp-mtext" id="MJXp-Span-65">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">m</span><span class="MJXp-msubsup" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-73">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-75"><span class="MJXp-mtext" id="MJXp-Span-76">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">u</span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">k</span><span class="MJXp-mtext" id="MJXp-Span-83">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-89">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">p</span><span class="MJXp-mrow" id="MJXp-Span-93"><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-96">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">t</span><span class="MJXp-mtext" id="MJXp-Span-101">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-102"><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-110" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-111">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">t</span><span class="MJXp-mtext" id="MJXp-Span-117">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-118"><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-123">2</span><span class="MJXp-mtext" id="MJXp-Span-124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">m</span><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-132">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="101.846ex" height="3.503ex" viewBox="-38.5 -1039.5 43850.3 1508.3" role="img" focusable="false" style="vertical-align: -1.089ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="691" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-3D" x="1614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="2920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="3470" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="3922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-63" x="4451" y="0"></use><g transform="translate(4885,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="1289" y="0"></use><g transform="translate(1792,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="1418" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="1716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="2183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="2733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="3345" y="0"></use><g transform="translate(3623,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="4762" y="0"></use><g transform="translate(5763,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="6977" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="7428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="7774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-68" x="8254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="8831" y="0"></use><g transform="translate(9442,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="393" y="675"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2F" x="10175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="10675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="11065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="11815" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="12285" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="12630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="13111" y="0"></use><g transform="translate(13989,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="748" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="748" y="-430"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="14973" y="0"></use></g></g><g transform="translate(22040,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6E" x="875" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="1475" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="1942" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="2402" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="4213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="4853" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="5319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="5892" y="0"></use><g transform="translate(6395,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="1418" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="1716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="2183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="2733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="3345" y="0"></use><g transform="translate(3623,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="4762" y="0"></use><g transform="translate(5763,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6B" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="7054" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="7506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="7851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-68" x="8332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="8908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="9520" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2F" x="9798" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="10299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="10688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="11439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="11908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="12254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="12734" y="0"></use><g transform="translate(13613,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="748" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="748" y="-430"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="14596" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="21381" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> p_ {j | i} = \ frac {\ exp {(- \ left \ | x_i - x_j \ right \ | ^ 2 / (2 \ sigma ^ 2_i)}} {\ sum_ {k \ neq i} (\ exp {(- \ left \ | x_i - x_k \ right \ | / (2 \ sigma ^ 2_i)})} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-135"><span class="MJXp-msubsup" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-138" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-142">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">c</span><span class="MJXp-mrow" id="MJXp-Span-147"><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-150" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">j</span><span class="MJXp-mrow" id="MJXp-Span-152"><span class="MJXp-mo" id="MJXp-Span-153">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">i</span><span class="MJXp-mrow" id="MJXp-Span-160"><span class="MJXp-mo" id="MJXp-Span-161">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mn" id="MJXp-Span-164">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.19ex" height="2.901ex" viewBox="-38.5 -780.1 9123.3 1249" role="img" focusable="false" style="vertical-align: -1.089ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-3D" x="1417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="2723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="3274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="3725" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-63" x="4255" y="0"></use><g transform="translate(4688,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="691" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2B" x="1558" y="0"></use><g transform="translate(2559,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="624" y="0"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="8584" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> p_ {ij} = \ frac {p_ {j | i} + p_ {i | j}} {2} </script></p></li><li>  For each pair of display points, express their similarity in the visualization space using the t-distribution core <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-165"><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-172">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">c</span><span class="MJXp-mrow" id="MJXp-Span-177"><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-179">1</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">t</span><span class="MJXp-mtext" id="MJXp-Span-186">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-187"><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-191" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-195" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">t</span><span class="MJXp-mtext" id="MJXp-Span-202">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-203"><span class="MJXp-mrow" id="MJXp-Span-204" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-206" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-209" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-210">‚àí</span><span class="MJXp-mn" id="MJXp-Span-211">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-212"><span class="MJXp-mtext" id="MJXp-Span-213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">u</span><span class="MJXp-msubsup" id="MJXp-Span-216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-218" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">k</span><span class="MJXp-mtext" id="MJXp-Span-220">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-226">1</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-228">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">t</span><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-234"><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-238" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-242" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mtext" id="MJXp-Span-243">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span><span class="MJXp-mtext" id="MJXp-Span-249">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-250"><span class="MJXp-mrow" id="MJXp-Span-251" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-253" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-254"><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-256" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-257">‚àí</span><span class="MJXp-mn" id="MJXp-Span-258">1</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="79.842ex" height="3.262ex" viewBox="0 -1039.5 34376.4 1404.6" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="0" y="0"></use><g transform="translate(446,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-3D" x="1360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="2666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="3217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="3668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-63" x="4198" y="0"></use><g transform="translate(4631,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2B" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="2362" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="2661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="3127" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="3678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="4289" y="0"></use><g transform="translate(4568,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="5625" y="0"></use><g transform="translate(6626,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="7758" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="8209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="8555" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-68" x="9035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="9612" y="0"></use><g transform="translate(10223,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="393" y="675"></use></g><g transform="translate(10956,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="0" y="0"></use><g transform="translate(389,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-31" x="778" y="0"></use></g></g></g><g transform="translate(16981,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6E" x="875" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="1475" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="1942" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="2402" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="4590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-31" x="4980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2B" x="5702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="6953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="7251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="7718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="8880" y="0"></use><g transform="translate(9158,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6B" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="10340" y="0"></use><g transform="translate(11341,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="12802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="13254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="13599" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-68" x="14080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="14656" y="0"></use><g transform="translate(15268,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="393" y="675"></use></g><g transform="translate(16000,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="0" y="0"></use><g transform="translate(389,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-31" x="778" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> q_ {ij} = \ frac {(1 + \ left \ | y_i - y_j \ right \ | ^ 2) ^ {- 1}} {\ sum_ {k \ neq m} (1 + \ left \ | y_k - y_m \ right \ | ^ 2) ^ {- 1}} </script></p></li><li>  Build the objective function and minimize it relative to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> y </script>  using gradient descent <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">C</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">y</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">L</span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">P</span><span class="MJXp-mrow" id="MJXp-Span-271"><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-273"><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">Q</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">u</span><span class="MJXp-msubsup" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-283" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">i</span><span class="MJXp-mtext" id="MJXp-Span-285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-290"><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-293" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">g</span><span class="MJXp-mrow" id="MJXp-Span-300"><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">c</span><span class="MJXp-mrow" id="MJXp-Span-306"><span class="MJXp-msubsup" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-309" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-312"><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-315" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">j</span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="47.341ex" height="2.78ex" viewBox="0 -832 20382.7 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="1150" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="1647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-3D" x="2314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4B" x="3371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4C" x="4260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="4942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-50" x="5331" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="6083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="6361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-51" x="6640" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="7431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-3D" x="8098" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="9405" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-75" x="9874" y="0"></use><g transform="translate(10447,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6E" x="699" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="1299" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="1766" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="2226" y="0"></use></g></g><g transform="translate(13291,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="1389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6F" x="1687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="2173" y="0"></use><g transform="translate(2653,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g></g><g transform="translate(3354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="0" y="0"></use><g transform="translate(446,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> C (y) = KL (P || Q) = \ sum_ {i \ neq j} {p_ {ij} \ log {\ frac {p_ {ij}} {q_ {ij}}}} </script></p></li></ol><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">L</span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">P</span><span class="MJXp-mrow" id="MJXp-Span-323"><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-325"><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">Q</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.336ex" height="2.66ex" viewBox="0 -832 4450 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4C" x="889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="1571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-50" x="1960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="2712" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-7C" x="2990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-51" x="3269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="4060" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> KL (P || Q) </script>  - Kullback-Leibler divergence. <br><br>  Intuitively for a three-dimensional case, this can be represented as follows.  You have <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> N </script>  billiard balls.  You label them and hang them by the threads to the ceiling.  Threads of different sizes, so now in the three-dimensional space of your room dataset hanging from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> N </script>  elements with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">d</span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-336">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.477ex" height="2.057ex" viewBox="0 -780.1 2358.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-3D" x="801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-33" x="1857" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> d = 3 </script>  .  You connect each pair of balls with an ideal spring so that the springs are exactly the same length that you need (they do not sag, but they are not too tight).  The stiffness of the springs is chosen as follows: if there are no other balls next to a ball, all the springs are more or less weak.  If exactly one ball is a neighbor, and all the others are far away, then this neighbor will have a very rigid spring, and all the others will be weak.  If there are two neighbors, before the neighbors there will be hard springs (but weaker than in the previous case), and to all the others - even weaker.  And so on. <br><br>  Now you take the resulting structure and try to place it on the table.  Even if a three-dimensional object consists of freely moving nodes, in general it cannot be placed on a plane (imagine how you are pressing a tetrahedron to the table), so you simply position it so that the tension or tension of the springs is as low as possible.  We do not forget to make a correction for the fact that in a two-dimensional space each ball will have fewer neighbors, but more neighbors at an average distance (remember the cube-square law).  Most of the springs are so weak that they can not be taken into account at all, but the elements connected by strong springs are better placed side by side.  You move in small steps, moving from an arbitrary initial configuration, slowly reducing the tension of the springs.  <i>The better you can restore the original tension of the springs at their current tension, the better.</i> <br><br>  (forgot for a second that we know that the initial tension of the springs is zero) <br>  (Did I mention that these are magic balls and springs that pass through each other?) <br>  (why bother with such nonsense at all? - left as an exercise for the reader) <br><br>  So, modern <a href="http://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html">data science packages</a> do not quite realize this.  Standard t-SNE is complex <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">O</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-342" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.76ex" height="2.901ex" viewBox="0 -935.7 2910.5 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="1292" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="2520" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> O (N ^ 2) </script>  .  As a result of <a href="https://lvdmaaten.github.io/publications/papers/JMLR_2014.pdf">recent studies</a> , it turned out that this is redundant, and almost the same result can be achieved in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">O</span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">N</span><span class="MJXp-mtext" id="MJXp-Span-348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">g</span><span class="MJXp-mrow" id="MJXp-Span-352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">N</span></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.227ex" height="2.66ex" viewBox="0 -832 4834 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="2291" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6F" x="2590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="3075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="3556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="4444" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> O (N \ log {N}) </script>  operations. <br><br>  First, count everything in the first step. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-355"><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-358" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.736ex" height="2.057ex" viewBox="-38.5 -520.7 1178 885.9" role="img" focusable="false" style="vertical-align: -0.848ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-13"> p_ {ij} </script>  it seems obviously redundant.  Most of them will still be zero.  Limit this number: find the k nearest neighbors of each data instance, and calculate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-361"><span class="MJXp-msubsup" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-364" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.736ex" height="2.057ex" viewBox="-38.5 -520.7 1178 885.9" role="img" focusable="false" style="vertical-align: -0.848ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-14"> p_ {ij} </script>  honestly only for them;  for the rest we set zero.  Accordingly, the sum in the denominator of the corresponding formula will be calculated only by these elements.  The question is: how to choose this number of neighbors?  The answer is surprisingly simple: we already have a parameter responsible for the relationship between the global and the local structure of the algorithm - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-75" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> u </script>  perplexity!  Its characteristic values ‚Äã‚Äãlie in the range from 5 to 50, and, the more dataset, the more perplexity.  Just what you need.  With the help of the <a href="https://ru.wikipedia.org/wiki/VP-%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">VP-tree,</a> you can find a sufficient number of neighbors for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">O</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">N</span><span class="MJXp-mtext" id="MJXp-Span-375">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">g</span><span class="MJXp-mrow" id="MJXp-Span-379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">N</span></span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.952ex" height="2.66ex" viewBox="0 -832 6007 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-75" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6E" x="1725" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="2326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="3464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6F" x="3763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-67" x="4248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="4729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="5617" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> O (unN \ log {N}) </script>  of time.  If we continue the analogy with springs, it‚Äôs not like connecting all the balls in pairs, but for each ball to hang the springs up to, say, its five nearest neighbors. <br><br>  Secondly‚Ä¶ <br><br><h4>  Barnes-Hut algorithm </h4><br>  Let's digress a bit to discuss Barnes-Hut.  About this algorithm there was no separate article on Habr√©, and here is just an excellent reason to tell about it. <br><br>  Probably everyone is familiar with the classical gravitational problem of N bodies: based on given masses and initial coordinates of N cosmic bodies and the well-known law of their interaction, construct functions that show the coordinates of objects at all subsequent points in time.  Its solution is not expressed in terms of algebraic functions that are familiar to us, but can only be found numerically, for example, using the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25A0%25D1%2583%25D0%25BD%25D0%25B3%25D0%25B5_%25E2%2580%2594_%25D0%259A%25D1%2583%25D1%2582%25D1%2582%25D1%258B">Runge-Kutta method</a> .  Unfortunately, such numerical methods for solving differential equations have difficulty <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">O</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-387" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.76ex" height="2.901ex" viewBox="0 -935.7 2910.5 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-32" x="1292" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="2520" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> O (N ^ 2) </script>  , and even on modern computers are not very well considered when the number of objects exceeds <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mn" id="MJXp-Span-391" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-392" style="vertical-align: 0.5em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mn" id="MJXp-Span-395" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-396" style="vertical-align: 0.5em;">6</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.599ex" height="2.539ex" viewBox="0 -935.7 4132.8 1093.4" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-35" x="1415" y="557"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="1677" y="0"></use><g transform="translate(2677,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-36" x="1415" y="557"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-18"> 10 ^ 5-10 ^ 6 </script>  . <br><br>  For simulations with such a huge number of bodies one has to go for some simplifications.  Note that for the three bodies A, B and C, the sum of the forces acting on A from B and C is equal to the force that a single body (BC) would have if placed at the center of mass point of B and C. This alone is not enough for optimization, therefore one more trick.  We divide the space into cells.  If the distance from body A to the cell is large and there is more than one body in the cell, we will assume that an object with the total mass of objects inside is placed exactly in the center of this cell.  Its position will deviate slightly from the present center of mass of the cell contents, but the farther the cell, the more insignificant will be the error in the angle of force. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5m/rq/70/5mrq70e-8ngde8r7wmwkeesgeyu.png"></div><br>  In the picture below, green indicates the area of ‚Äã‚Äãproximity of body A. Blue indicates the direction of action of the forces.  The bodies B, C and D exert force on A separately.  Although C and D are in the same cell, they are in the area of ‚Äã‚Äãaccuracy.  E also has power alone - it is one in a cage.  But the objects F, G and H are far enough from A and close enough to each other, that the interaction can be brought closer.  The center of the cell will not always coincide well with the real position of the center of gravity (see K, L, M, N), but on average, with a large distance and a large number of bodies, the error will be negligible. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nl/kr/ah/nlkrahxnmcfma1rhuhnc_dm8or8.png"></div><br>  It became better: we reduced the effective number of objects several times.  But how to choose the optimal size of the partition?  If the partition is too small, there will be no sense from it, and if it is too large, the error will increase and you will have to set a very large distance at which we will be ready to sacrifice accuracy.  Let's take another step forward: instead of a grid with a fixed step, we divide the plane's rectangle into a <i>hierarchy of</i> cells.  Large cells contain small ones, even smaller ones, and so on.  The resulting data structure is a tree, where each non-leaf node spawns four child nodes.  This construction is called a <a href="https://en.wikipedia.org/wiki/Quadtree">quadtree</a> .  For the three-dimensional case, respectively, the octree (octotree) is used.  Now, when calculating the force acting on a certain body, it is possible to bypass the tree until a cell with a sufficient level of fineness is encountered, after which an approximation is used. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gx/vw/ht/gxvwhtql_22ttf2mrwu7waktsda.png"></div><br>  Node that does not fall into any object makes no sense to shrink further, so this structure is not as heavy as it may seem at first glance.  On the other hand, there is definitely an overhead, so I would say that as long as there are less than a hundred simulated objects, such a tricky data structure can be a bit harmful (depends on the implementation). <br><br>  Now more formally: <br><br>  Algorithm 1: <br>  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.216ex" height="2.057ex" viewBox="0 -780.1 523.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-64" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> d </script>  - the distance from the body to the center of the considered cell, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.455ex" viewBox="0 -520.7 469.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> s </script>  - the side of this cell, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-mtext" id="MJXp-Span-402">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21"> \ theta </script>  - predetermined threshold of fineness.  To determine the force exerted on an object <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-62" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> b </script>  , we bypass the quadtree, starting from the root. <br><br><ol><li>  If there is no element in the current cell, skip it. </li><li>  Otherwise, if there is only one element in the node and it is not <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-62" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23"> b </script>  , directly add its effect to the total force </li><li>  Otherwise, if <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">s</span><span class="MJXp-mrow" id="MJXp-Span-414"><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">d</span><span class="MJXp-mtext" id="MJXp-Span-417">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">q</span><span class="MJXp-mtext" id="MJXp-Span-421">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.808ex" height="2.66ex" viewBox="0 -832 5514.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2F" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-64" x="970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="1743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="2042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="2508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="3219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-68" x="3580" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="4157" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="4623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="4985" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24"> s / d \ leq \ theta </script>  , we consider this node as a single whole object, and add its total force, as described above. </li><li>  Otherwise, we recursively run this procedure for all daughter cells of the current cell. </li></ol><br>  <a href="http://arborjs.org/docs/barnes-hut">Here is a</a> more detailed execution of the algorithm in steps.  A beautiful <a href="https://www.youtube.com/watch%3Fv%3Dfit1uX1HIlc">animation of the</a> Barnes-Hut galaxy simulation.  Various implementations of Barnes-Hut can be found on the githab. <br><br>  Obviously, such an interesting idea could not go unnoticed in other areas of science.  Barnes-Hut is used wherever there are systems with a large number of objects, each of which acts on the others according to a simple law, which varies slightly in space: a swarm simulation, computer games.  So the analysis of the data was no exception either.  Let us write in more detail the stage of gradient descent (3) in t-SNE: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-427"><span class="MJXp-mtext" id="MJXp-Span-428">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">c</span><span class="MJXp-mrow" id="MJXp-Span-433"><span class="MJXp-mtext" id="MJXp-Span-434">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">C</span></span><span class="MJXp-mrow" id="MJXp-Span-441"><span class="MJXp-mtext" id="MJXp-Span-442">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">y</span></span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-450">4</span><span class="MJXp-mtext" id="MJXp-Span-451">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">u</span><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-456" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">j</span><span class="MJXp-mtext" id="MJXp-Span-458">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-463"><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-467" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-479" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">j</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">Z</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-486" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-490" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="55.863ex" height="2.78ex" viewBox="0 -832 24052 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="1538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="1900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-43" x="2429" y="0"></use></g><g transform="translate(5405,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-64" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6C" x="1240" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-74" x="1538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-61" x="1900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="2429" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-3D" x="8609" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-34" x="9666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-73" x="10416" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-75" x="10886" y="0"></use><g transform="translate(11458,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6E" x="766" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-65" x="1366" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="1833" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="2293" y="0"></use></g></g><g transform="translate(14303,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="1751" y="0"></use><g transform="translate(2751,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="0" y="0"></use><g transform="translate(446,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="3834" y="0"></use><g transform="translate(4223,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-71" x="0" y="0"></use><g transform="translate(446,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-5A" x="5306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-28" x="6029" y="0"></use><g transform="translate(6419,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-2212" x="7476" y="0"></use><g transform="translate(8477,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMATHI-6A" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/341208/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAR8UOUjUXjjWVxl8g7f21Jf1IlA#MJMAIN-29" x="9359" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-25"> \ frac {\ delta C} {\ delta y} = 4 \ sum_ {j \ neq i} {(p_ {ij} - q_ {ij}) q_ {ij} Z (y_i - y_j)} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-492"><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-494">4</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-496">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">u</span><span class="MJXp-msubsup" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-501" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">j</span><span class="MJXp-mtext" id="MJXp-Span-503">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-508"><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-516" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">j</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">Z</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-523" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-527" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">u</span><span class="MJXp-msubsup" id="MJXp-Span-533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-535" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">j</span><span class="MJXp-mtext" id="MJXp-Span-537">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-542"><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">q</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-548">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">j</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">Z</span><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-553" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-557" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> = 4 (\ sum_ {j \ neq i} {p_ {ij} q_ {ij} Z (y_i - y_j)} - \ sum_ {j \ neq i} {q_ {ij} ^ 2Z (y_i - y_j)) } </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-560"><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-562">4</span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-574" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> = 4 (F_ {attr} + F_ {rep}) </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-579"><span class="MJXp-msubsup" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-582" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> F_ {attr} </script>  indicated attracting forces <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">q</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> F_ {req} </script>  - repulsive, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">Z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> Z </script>  - the normalizing factor.  Thanks to previous optimization <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-msubsup" id="MJXp-Span-597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-599" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> F_ {attr} </script>  considered to be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">O</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">N</span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> O (uN) </script>  but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-610"><span class="MJXp-msubsup" id="MJXp-Span-611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-613" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">q</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> F_ {req} </script>  - yet <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">O</span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-622" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> O (N ^ 2) </script>  .  This is where the quadtree and Barens-Hut trick described above comes in handy, but instead of Newton's law <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">F</span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628" style="margin-right: 0.05em;">q</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-632">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">j</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">Z</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-637" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-641" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> F = q_ {ij} ^ 2Z (y_i - y_j) </script>  .  This simplification allows you to calculate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-643"><span class="MJXp-msubsup" id="MJXp-Span-644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645" style="margin-right: 0.05em;">F</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-646" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">q</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> F_ {req} </script>  behind <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">O</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">N</span><span class="MJXp-mtext" id="MJXp-Span-654">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">g</span><span class="MJXp-mrow" id="MJXp-Span-658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">N</span></span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> O (N \ log {N}) </script>  average.  The disadvantage is obvious: errors due to the discretization of space.  Laurens van der Maaten in the article above states that for the time being it is not even clear whether they are limited at all (there are links to relevant articles).  Be that as it may, the results obtained with t-SNE Barens-Hut with normally matched <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-mtext" id="MJXp-Span-662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> \ theta </script>  look wealthy and consistent.  Usually you can put <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-mtext" id="MJXp-Span-669">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">a</span><span class="MJXp-mo" id="MJXp-Span-675" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-676"><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0em; margin-right: 0em;">$</span></span><span class="MJXp-mn" id="MJXp-Span-678">0.2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> \ theta = $ 0.2</script>  or <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-679"><span class="MJXp-mn" id="MJXp-Span-680">0.1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> 0.1 </script>  and forget about it. <br><br>  Is it even faster?  <a href="http://www.cs.cmu.edu/~agray/nips-final.pdf">Yes</a>  Why stop at the point-cell approximation, when you can simplify the situation even more: if two <i>cells</i> are far enough apart, you can bring more than just the final one <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> y </script>  , but also initial (cell-cell approximation).  This is called the dual-tree algorithm (there is no Russian name yet).  We do not run recursion above for each data instance, but begin to bypass the quadtree and when the fineness reaches the desired value, <i>we begin to bypass the same quadtree</i> and apply the total force from the second bypass cell to each instance inside the selected first bypass cell.  This approach allows you to squeeze a little more speed, but the error starts to accumulate much faster, and you have to put less <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-683"><span class="MJXp-mtext" id="MJXp-Span-684">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> \ theta </script>  .  Yes, and implemented such a detour is not so much where. <br><br><h3>  LargeVis </h3><br>  Good, but is it <i>even</i> faster?  Jian Tang and company, say yes! <br>  Since we have already sacrificed accuracy, why not sacrifice determinism to the <s>virgin</s> .  We will use random algorithms to get the result for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">O</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">N</span><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> O (N) </script>  of time.  First, instead of searching for the nearest neighbors using the vantage point tree, we use random projection trees (RT-trees).  Secondly, instead of honestly calculating the gradient with simplifications through Barnes-Hut, we will simply sample the terms in the negative part <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">C</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">y</span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> C (y) </script>  . <br><br><h4>  RT-trees </h4><br>  The idea of ‚Äã‚Äãsplitting the plane using a quadtree was not bad.  Now we will try to split the plane into sectors using something more simple.  What about <a href="https://habrahabr.ru/post/312882/">kd tree</a> ? <br><br>  Algorithm 2: <br>  Options: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> M </script>  - minimum size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> X </script>  - data set <br>  MakeTree ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> X </script>  ) <br><br><ol><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-mrow" id="MJXp-Span-707"><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">X</span><span class="MJXp-mrow" id="MJXp-Span-710"><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> | X | \ leq M </script>  return current <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> X </script>  as a leaf node </li><li>  Otherwise <br><ol><li>  Randomly select the variable number <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">i</span><span class="MJXp-mtext" id="MJXp-Span-721">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">n</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-725">0</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">d</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-729">1</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> i \ in [0, d-1] </script></li><li>  Rule (x): = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-msubsup" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-734" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-735">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> x_j \ leq </script>  median ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-msubsup" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-742" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-747" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-748">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> z_ {i}: z_i \ in X </script>  ) // Predicate dividing the data subspace by a hyperplane perpendicular to the coordinate axis <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> i </script>  and passing through the median values <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> i </script>  -th variable of elements <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> X </script>  . </li><li>  LeftTree: = MakeTree ({x <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-758"><span class="MJXp-mtext" id="MJXp-Span-759">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ in </script>  X: Rule (x) = true}) </li><li>  RightTree: = MakeTree ({x <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-mtext" id="MJXp-Span-763">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ in </script>  X: Rule (x) = false}) </li><li>  Redo [Rule, LeftTree, RightTree] </li></ol></li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8s/n6/jl/8sn6jl8kmhyclt3zin1glu4i1es.png"></div><br>  Somehow too primitive.  The perpendicularity of the plane of splitting of some axis of coordinates looks suspicious.  There is a more advanced version: random projection trees (RT-trees).  We will recursively divide the space, each time choosing a random unit vector perpendicular to which the plane will go.  For easy asymmetry of the tree, also add a little noise to the anchor point of the plane. <br><br>  Algorithm 3: <br>  ChooseRule (X) // Meta-function, which returns a predicate by which we will break the space <br><br><ol><li>  Choose a random unit vector from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">v</span><span class="MJXp-mtext" id="MJXp-Span-768">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">n</span><span class="MJXp-mtext" id="MJXp-Span-771">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">l</span><span class="MJXp-msubsup" id="MJXp-Span-779"><span class="MJXp-mrow" id="MJXp-Span-780" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-782" style="vertical-align: 0.5em;">d</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> v \ in \ mathcal {R} ^ d </script></li><li>  Choose random <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">y</span><span class="MJXp-mtext" id="MJXp-Span-785">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> y \ in X </script></li><li>  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">z</span><span class="MJXp-mtext" id="MJXp-Span-791">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> z \ in X </script>  - the furthest data point from it <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> X </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-797"><span class="MJXp-mtext" id="MJXp-Span-798">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> \ delta </script>  : = random number in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-804"><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-807">6</span><span class="MJXp-mtext" id="MJXp-Span-808">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">t</span><span class="MJXp-mtext" id="MJXp-Span-813">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">t</span><span class="MJXp-mtext" id="MJXp-Span-818">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-819"><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">y</span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">z</span><span class="MJXp-mtext" id="MJXp-Span-824">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">t</span><span class="MJXp-mtext" id="MJXp-Span-830">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-831"><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-833"><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mtext" id="MJXp-Span-835">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">t</span><span class="MJXp-mrow" id="MJXp-Span-840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">d</span></span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-843">6</span><span class="MJXp-mtext" id="MJXp-Span-844">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">t</span><span class="MJXp-mtext" id="MJXp-Span-849">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">t</span><span class="MJXp-mtext" id="MJXp-Span-854">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-855"><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">y</span><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">z</span><span class="MJXp-mtext" id="MJXp-Span-860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">t</span><span class="MJXp-mtext" id="MJXp-Span-866">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-867"><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-869"><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mtext" id="MJXp-Span-871">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">t</span><span class="MJXp-mrow" id="MJXp-Span-876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">d</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> [- 6 \ cdot \ left \ | y - z \ right \ | / \ sqrt {d}, 6 \ cdot \ left \ | y - z \ right \ | / \ sqrt {d}] </script></li><li>  Return Rule (x): = <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">x</span><span class="MJXp-mtext" id="MJXp-Span-881">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">v</span><span class="MJXp-mtext" id="MJXp-Span-887">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> x \ cdot v \ leq </script>  (median ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">z</span><span class="MJXp-mtext" id="MJXp-Span-893">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">v</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">z</span><span class="MJXp-mtext" id="MJXp-Span-901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> z \ cdot v: z \ in X </script>  ) + <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-905"><span class="MJXp-mtext" id="MJXp-Span-906">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> \ delta </script>  ) </li></ol><br>  MakeRPTree ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> X </script>  ) <br><br><ol><li>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mrow" id="MJXp-Span-915"><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">X</span><span class="MJXp-mrow" id="MJXp-Span-918"><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-920">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> | X | \ leq M </script>  return current <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> X </script>  as a leaf node </li><li>  Otherwise <br><ol><li>  Rule (x): = ChooseRule (X) </li><li>  LeftTree: = MakeTree ({x <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mtext" id="MJXp-Span-928">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> \ in </script>  X: Rule (x) = true}) </li><li>  RightTree: = MakeTree ({x <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-931"><span class="MJXp-mtext" id="MJXp-Span-932">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> \ in </script>  X: Rule (x) = false}) </li><li>  Redo [Rule, LeftTree, RightTree] </li></ol></li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4-/0j/2g/4-0j2gvlb9xihsczd2pqhlyn58q.png"></div><br>  Is such a rough and chaotic partition able to give at least some results?  <a href="http://cseweb.ucsd.edu/~dasgupta/papers/rptree-stoc.pdf">It turns out</a> that yes!  In the case when multidimensional data actually lie near a not very multidimensional hyperfolder, RT-trees behave quite decently (see the proofs on the first link <a href="https://arxiv.org/pdf/1602.00370.pdf">here</a> ).  Even in the case when the data does indeed have an effective dimension comparable to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> d </script>  , knowledge of projections carries a lot of information. <br><br>  Hmm, complexity: calculate the median is still <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">O</span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-940"><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">X</span><span class="MJXp-mrow" id="MJXp-Span-943"><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> O (| X |) </script>  and we do it on each of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-946"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">O</span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-949">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">g</span><span class="MJXp-mrow" id="MJXp-Span-953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">N</span></span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> O (\ log {N}) </script>  steps.  Simplify the choice of the hyperplane even more: in general, we abandon the anchor point.  At each recursion step, we will simply choose two random points from the next <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> X </script>  and draw a plane equidistant from them. <br><br>  It seems that we have thrown out from the algorithm everything that at least somehow reminds of mathematical rigor or precision.  How can the resulting trees help us find our closest neighbors?  Obviously, the neighbors of the data points on the graph sheet are the first candidates for his kNN.  But this is not certain: if the point lies next to the hyperplane of the partition, the real neighbors may be on a completely different sheet.  The resulting approximation can be improved by building several RP-trees.  The intersection of sheets of the resulting graphs for each <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> x </script>  is a much better area to look for. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ij/0z/3a/ij0z3ahghuegaluvjkxrwi6rjd8.png"></div><br>  You don't need too many trees, it undermines the speed.  The resulting approximation is brought to mind with the help of the heuristics of ‚Äúthe neighbor of my neighbor - most likely my neighbor‚Äù.  It is argued that quite a few iterations are enough to get a decent result. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tt/rj/zy/ttrjzy5a54lmwxqfqj4uiusmgsy.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/op/kz/6p/opkz6pk8dhliybnh0g2wtgdbdf0.png"></div><br>  The authors of the article claim that the effective implementation of all this works for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">O</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">N</span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> O (N) </script>  of time.  There is, however, one thing but they don‚Äôt mention: O-big swallows a gigantic constant, which is influenced <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-965"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> M </script>  , the number of RP-trees, and the number of stages of the heuristic adjustment. <br><br><h4>  Sampling </h4><br>  After calculating kNN, Jian Tang and KO consider the similarity of data in the original space using the same formula as in t-SNE. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-967"><span class="MJXp-msubsup" id="MJXp-Span-968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-970" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">j</span><span class="MJXp-mrow" id="MJXp-Span-972"><span class="MJXp-mo" id="MJXp-Span-973">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-976">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">c</span><span class="MJXp-mrow" id="MJXp-Span-981"><span class="MJXp-mtext" id="MJXp-Span-982">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">p</span><span class="MJXp-mrow" id="MJXp-Span-986"><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-989">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">t</span><span class="MJXp-mtext" id="MJXp-Span-994">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-995"><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-999" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1003" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-1004">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">t</span><span class="MJXp-mtext" id="MJXp-Span-1010">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1011"><span class="MJXp-mrow" id="MJXp-Span-1012" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1014" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-1015"><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1018">2</span><span class="MJXp-mtext" id="MJXp-Span-1019">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">m</span><span class="MJXp-msubsup" id="MJXp-Span-1024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1027">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1029"><span class="MJXp-mtext" id="MJXp-Span-1030">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">u</span><span class="MJXp-msubsup" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1035" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1036">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">i</span><span class="MJXp-mo" id="MJXp-Span-1038">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">k</span><span class="MJXp-mo" id="MJXp-Span-1040">)</span><span class="MJXp-mtext" id="MJXp-Span-1041">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">h</span></span></span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1050">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">p</span><span class="MJXp-mrow" id="MJXp-Span-1054"><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1057">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">t</span><span class="MJXp-mtext" id="MJXp-Span-1062">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1063"><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1067" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1071" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-1072">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">t</span><span class="MJXp-mtext" id="MJXp-Span-1078">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1079"><span class="MJXp-mo" id="MJXp-Span-1080" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1081"><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1084">2</span><span class="MJXp-mtext" id="MJXp-Span-1085">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">m</span><span class="MJXp-msubsup" id="MJXp-Span-1090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1093">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-79"> p_ {j | i} = \ frac {\ exp {(- \ left \ | x_i - x_j \ right \ | ^ 2 / (2 \ sigma ^ 2_i)}} {\ sum _ {(i, k) \ in Neigh} (\ exp {(- \ left \ | x_i - x_k \ right \ | / (2 \ sigma ^ 2_i)})} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1096"><span class="MJXp-msubsup" id="MJXp-Span-1097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1099" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1103">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">c</span><span class="MJXp-mrow" id="MJXp-Span-1108"><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1111" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">j</span><span class="MJXp-mrow" id="MJXp-Span-1113"><span class="MJXp-mo" id="MJXp-Span-1114">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1119" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">i</span><span class="MJXp-mrow" id="MJXp-Span-1121"><span class="MJXp-mo" id="MJXp-Span-1122">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1124"><span class="MJXp-mn" id="MJXp-Span-1125">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-80"> p_ {ij} = \ frac {p_ {j | i} + p_ {i | j}} {2} </script></p><br>  Please note that the denominator amount is calculated only for kNN, the rest <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-msubsup" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1129" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">j</span><span class="MJXp-mrow" id="MJXp-Span-1131"><span class="MJXp-mo" id="MJXp-Span-1132">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> p_ {j | i} </script>  equal to 0;  also <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1134"><span class="MJXp-msubsup" id="MJXp-Span-1135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1137" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1141">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> p_ {ii} = 0 </script>  . <br><br>  After that, a clever theoretical maneuver is proposed: now we are looking at the resulting <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1142"><span class="MJXp-msubsup" id="MJXp-Span-1143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1145" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1148">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">v</span><span class="MJXp-msubsup" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1156" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> w_ {ij} \ equiv p_ {ij} </script>  , as on the weights of edges of some graph, where nodes are elements <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> X </script>  .  Encode information about the weights of this graph using a set of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> y </script>  in display space.  Let the probability of observing a binary unweighted edge <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1163"><span class="MJXp-msubsup" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1166" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> e_ {ij} </script>  equals <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">P</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1172">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">s</span><span class="MJXp-msubsup" id="MJXp-Span-1179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1181" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1186">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">c</span><span class="MJXp-mrow" id="MJXp-Span-1191"><span class="MJXp-mn" id="MJXp-Span-1192">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1193"><span class="MJXp-mn" id="MJXp-Span-1194">1</span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">t</span><span class="MJXp-mtext" id="MJXp-Span-1201">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1202"><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1206" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1207" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1210" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mtext" id="MJXp-Span-1211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">t</span><span class="MJXp-mtext" id="MJXp-Span-1217">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1218"><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-87"> P (\ exists e_ {ij}) = \ frac {1} {1 + \ left \ | y_k - y_m \ right \ |} </script></p><br>  The t-distribution is again used, only slightly differently;  still remember the different number of neighbors in different layers in spaces with different <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> d </script>  .  The probability that the original graph had an edge with a weight in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1222"><span class="MJXp-msubsup" id="MJXp-Span-1223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1225" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> w_ {ij} </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">P</span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1231">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">s</span><span class="MJXp-msubsup" id="MJXp-Span-1238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1240" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">P</span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">s</span><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mo" id="MJXp-Span-1260" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1261" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1264" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">j</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-90"> P (\ exists w_ {ij}) = P (\ exists e_ {ij}) ^ {w_ {ij}} </script></p><br>  Multiply the probabilities for all edges and get the location <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91"> y </script>  maximum likelihood method: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">O</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1272">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">o</span><span class="MJXp-msubsup" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1278" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1279">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">i</span><span class="MJXp-mo" id="MJXp-Span-1281">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">j</span><span class="MJXp-mo" id="MJXp-Span-1283">)</span><span class="MJXp-mtext" id="MJXp-Span-1284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">E</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">P</span><span class="MJXp-mo" id="MJXp-Span-1289" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1290">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">s</span><span class="MJXp-msubsup" id="MJXp-Span-1297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1299" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1302"><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1304" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1307" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">j</span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1310">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">o</span><span class="MJXp-msubsup" id="MJXp-Span-1314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1316" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1317">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">i</span><span class="MJXp-mo" id="MJXp-Span-1319">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">j</span><span class="MJXp-mo" id="MJXp-Span-1321">)</span><span class="MJXp-mtext" id="MJXp-Span-1322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">n</span><span class="MJXp-mtext" id="MJXp-Span-1325">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">c</span><span class="MJXp-mrow" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">E</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1332">1</span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">P</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1336">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">s</span><span class="MJXp-msubsup" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1345" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1348"><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1350" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-1351">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">a</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-92"> O = \ prod _ {(i, j) \ in E} P (\ exists e_ {ij}) ^ {w_ {ij}} \ prod _ {(i, j) \ in \ vec {E}} (1 - P (\ exists e_ {ij}) ^ {\ gamma} </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1357"><span class="MJXp-mtext" id="MJXp-Span-1358">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">c</span><span class="MJXp-mrow" id="MJXp-Span-1362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">E</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93"> \ vec {E} </script>  - the set of all pairs that are not included in the list of nearest neighbors, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1364"><span class="MJXp-mtext" id="MJXp-Span-1365">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94"> \ gamma </script>  - a hyperparameter showing the influence of non-existent edges.  We logarithmically: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1371"><span class="MJXp-mtext" id="MJXp-Span-1372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">g</span><span class="MJXp-mrow" id="MJXp-Span-1376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">O</span></span><span class="MJXp-mtext" id="MJXp-Span-1378">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">o</span><span class="MJXp-mtext" id="MJXp-Span-1385">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">u</span><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1390" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1391">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">i</span><span class="MJXp-mo" id="MJXp-Span-1393">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">j</span><span class="MJXp-mo" id="MJXp-Span-1395">)</span><span class="MJXp-mtext" id="MJXp-Span-1396">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">E</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1400"><span class="MJXp-msubsup" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1403" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">g</span><span class="MJXp-mrow" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">P</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">s</span><span class="MJXp-msubsup" id="MJXp-Span-1420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1422" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1427">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">u</span><span class="MJXp-msubsup" id="MJXp-Span-1430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1432" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1433">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">i</span><span class="MJXp-mo" id="MJXp-Span-1435">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">j</span><span class="MJXp-mo" id="MJXp-Span-1437">)</span><span class="MJXp-mtext" id="MJXp-Span-1438">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">n</span><span class="MJXp-mtext" id="MJXp-Span-1441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">c</span><span class="MJXp-mrow" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">E</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1447"><span class="MJXp-mtext" id="MJXp-Span-1448">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">a</span><span class="MJXp-mtext" id="MJXp-Span-1454">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">g</span><span class="MJXp-mrow" id="MJXp-Span-1458"><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1460">1</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">P</span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1464">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">s</span><span class="MJXp-msubsup" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">w</span><span class="MJXp-mtext" id="MJXp-Span-1489">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-95"> \ log {O} \ propto \ sum _ {(i, j) \ in E} {w_ {ij} \ log {P (\ exists e_ {ij})}} + \ sum _ {(i, j) \ in \ vec {E}} {\ gamma \ log {(1 - P (\ exists e_ {ij}))}} \ rightarrow \ max </script></p><br>  Again received a sum consisting of two parts: one attracts to each other <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-96"> y </script>  close to each other <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-97"> x </script>  the other pushes away <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-98"> y </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99"> x </script>  which were not neighbors of each other, they only look different.  Again, we got the problem that the exact calculation of the second sub-volume will take <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">O</span><span class="MJXp-mrow" id="MJXp-Span-1503"><span class="MJXp-mo" id="MJXp-Span-1504" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1507" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100"> O {(N ^ 2)} </script>  , as there are a lot of missing arcs in our column.  This time, instead of using a quadtree, it is proposed to <i>sample the</i> nodes of the graph, to which there are no arcs.  This technique <a href="">came</a> from word processing.  There for faster learning context for each word <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-101"> j </script>  which is in the text next to the word <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102"> i </script>  , take not all the words from the dictionary, which are next to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103"> i </script>  they do not occur, but only a few arbitrary words, with a probability proportional to 3/4 of the degree of their frequency (the 3/4 indicator is chosen empirically, more <a href="http://mccormickml.com/2017/01/11/word2vec-tutorial-part-2-negative-sampling/">here</a> ).  We are for each node <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104"> j </script>  to which there is a rib from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105"> i </script>  with weight in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1519"><span class="MJXp-msubsup" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1522" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106"> w_ {ij} </script>  , we will sample several arbitrary nodes, to which there are no edges, in proportion to the 3/4 degree of the number of arcs emanating from those nodes. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1525"><span class="MJXp-mtext" id="MJXp-Span-1526">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">g</span><span class="MJXp-mrow" id="MJXp-Span-1530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">O</span></span><span class="MJXp-mtext" id="MJXp-Span-1532">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">x</span><span class="MJXp-mtext" id="MJXp-Span-1539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">u</span><span class="MJXp-msubsup" id="MJXp-Span-1542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1544" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1545">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">i</span><span class="MJXp-mo" id="MJXp-Span-1547">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">j</span><span class="MJXp-mo" id="MJXp-Span-1549">)</span><span class="MJXp-mtext" id="MJXp-Span-1550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">E</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1554"><span class="MJXp-msubsup" id="MJXp-Span-1555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1557" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">g</span><span class="MJXp-mrow" id="MJXp-Span-1565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">P</span><span class="MJXp-mo" id="MJXp-Span-1567" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1568">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">s</span><span class="MJXp-msubsup" id="MJXp-Span-1575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1577" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1582">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">u</span><span class="MJXp-msubsup" id="MJXp-Span-1585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">M</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">k</span><span class="MJXp-mo" id="MJXp-Span-1589">=</span><span class="MJXp-mn" id="MJXp-Span-1590">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1592"><span class="MJXp-msubsup" id="MJXp-Span-1593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1595" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597" style="margin-right: 0.05em;">j</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1598" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-1599">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">m</span><span class="MJXp-msubsup" id="MJXp-Span-1603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1605" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1606">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">j</span><span class="MJXp-mo" id="MJXp-Span-1608">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1609">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">a</span><span class="MJXp-mtext" id="MJXp-Span-1615">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">g</span><span class="MJXp-mrow" id="MJXp-Span-1619"><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1621">1</span><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">P</span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1625">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">s</span><span class="MJXp-msubsup" id="MJXp-Span-1632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1634" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">i</span><span class="MJXp-msubsup" id="MJXp-Span-1636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637" style="margin-right: 0.05em;">j</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1638" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1642">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">w</span><span class="MJXp-mtext" id="MJXp-Span-1653">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-107"> \ log {O} \ approx \ sum _ {(i, j) \ in E} {w_ {ij} (\ log {P (\ exists e_ {ij})}} + \ sum_ {k = 1} ^ M {E_ {j_k \ sim P_n (j)} \ gamma \ log {(1 - P (\ exists e_ {ij_k})))}} \ rightarrow \ max </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-108"> M </script>  - the number of negative edges per node, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1659"><span class="MJXp-msubsup" id="MJXp-Span-1660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1662" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">j</span><span class="MJXp-mo" id="MJXp-Span-1665" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1666">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">m</span><span class="MJXp-msubsup" id="MJXp-Span-1670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1673"><span class="MJXp-mn" id="MJXp-Span-1674">3</span><span class="MJXp-mrow" id="MJXp-Span-1675"><span class="MJXp-mo" id="MJXp-Span-1676">/</span></span><span class="MJXp-mn" id="MJXp-Span-1677">4</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">j</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109"> P_n (j) \ sim d_j ^ {3/4} </script>  . <br><br>  Because <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1678"><span class="MJXp-msubsup" id="MJXp-Span-1679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1681" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110"> w_ {ij} </script>  can vary within rather wide limits; an advanced version of the sampling technique should be used to stabilize the gradient.  Instead of fingering <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111"> j </script>  with the same frequency, we will take them by the probability proportional <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1686"><span class="MJXp-msubsup" id="MJXp-Span-1687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1689" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112"> w_ {ij} </script>  and pretend to be a single edge. <br><br>  Wow  What gives us all these tricks?  Approximately fivefold increase in speed on moderately large datasets compared with Barnes-Hut t-SNE! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3l/a8/76/3la876qiyixwkertajozy1xw9dm.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ui/be/jd/uibejdlig1rlpar5sm6ciy9wvfm.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rz/cu/lx/rzculx6-rxmxtdbyerb7zmnz9di.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nm/5y/28/nm5y28zjmdcr9f1qwezeodf3lu8.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/c0/sg/_h/c0sg_hlclhy9ioufuxerm1dfahw.png"></div><br>  (Pictures taken from the <a href="https://arxiv.org/pdf/1602.00370.pdf">article</a> ) <br><br>  The quality of visualization is about the same.  An attentive reader will notice that 20 Newsgroups ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1692"><span class="MJXp-mrow" id="MJXp-Span-1693"><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1696"><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚âà </font></font></span><span class="MJXp-mn" id="MJXp-Span-1699"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20000</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) LargeVis loses t-SNE. </font><font style="vertical-align: inherit;">This is the effect of the insidious constant, which remained behind the scenes. </font><font style="vertical-align: inherit;">Students, remember, mindless use of algorithms with a lesser degree under the O-big hurts your health! </font><font style="vertical-align: inherit;">Finally, a couple of practical moments. </font><font style="vertical-align: inherit;">There is the official</font><a href="https://github.com/lferry007/LargeVis"><font style="vertical-align: inherit;">implementation of</font></a><font style="vertical-align: inherit;">LargeVis, but in my opinion the code is slightly ugly there, use at your own risk. </font><font style="vertical-align: inherit;">Number of negative samples per node</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113"> | X | \approx 20000</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><a href="https://github.com/lferry007/LargeVis"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M is</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usually taken equal to 5 (came from computer word processing). </font><font style="vertical-align: inherit;">Experiments have shown a very slight increase in quality while increasing</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114"> M </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from 3 to 7. The number of trees should be taken the larger, the larger the data set, but not too much. </font><font style="vertical-align: inherit;">Focus on the minimum value of 10 for</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115"> M </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-mrow" id="MJXp-Span-1705"><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1708"><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1710" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt; </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1711"><span class="MJXp-mn" id="MJXp-Span-1712" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1713" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and close to the excess 100</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116">|X| < 10^5</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1714"><span class="MJXp-mrow" id="MJXp-Span-1715"><span class="MJXp-mo" id="MJXp-Span-1716" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1718"><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1721"><span class="MJXp-mn" id="MJXp-Span-1722" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1723" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117">|X| > 10^7</script>  . <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1724"><span class="MJXp-mtext" id="MJXp-Span-1725">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a the</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> creators of the algorithm take a value of 7, without explaining why. </font><font style="vertical-align: inherit;">Most importantly: LargeVis perfectly parallel at all stages of work. </font><font style="vertical-align: inherit;">Due to the sparseness of the weights matrix, asynchronous sparse gradient descent on different streams is unlikely to touch each other.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118"> \ gamma </script><font style="vertical-align: inherit;"></font><br><br><h3>  Conclusion </h3><br>  Thanks for attention.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I hope, now it has become clearer to you that this is the mysterious method = 'barnes_hut' and angle in the parameters of the sklearn'ovskogo TSNE, and you will not be lost when you need to visualize from ten million records. </font><font style="vertical-align: inherit;">If you are working with a large amount of data, maybe you can find your own use of Barens-Hut or decide to implement LargeVis. </font><font style="vertical-align: inherit;">Just in case, here are </font></font><a href="https://gist.github.com/shagunsodhani/6c267cf6122399e9be36491a2f510641"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brief notes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on the work of the latter.</font></font> Have a nice day! <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aq/me/mg/aqmemgqyhiibaxmfqxc2_9aaaky.png" width="70%" height="70%"></div></div><p>Source: <a href="https://habr.com/ru/post/341208/">https://habr.com/ru/post/341208/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341196/index.html">Transfer of tasks and schedules from one instance of MS SQL Server to another using T-SQL</a></li>
<li><a href="../341198/index.html">Some features of programming time events in games</a></li>
<li><a href="../341200/index.html">2.Check Point to the maximum. HTTPS Inspection</a></li>
<li><a href="../341202/index.html">MockK - library for mocking in Kotlin</a></li>
<li><a href="../341206/index.html">The digest of interesting materials for the mobile developer # 227 (October 23 - October 29)</a></li>
<li><a href="../341212/index.html">Hacking Bitcoin on TV: obfuskuy, not obfuskuy, still get QR</a></li>
<li><a href="../341216/index.html">How to create multiple VMFS datastores on a single disk device</a></li>
<li><a href="../341218/index.html">Android and custom fonts or ‚ÄúLong live API 26‚Äù</a></li>
<li><a href="../341220/index.html">Improving the quality of staff selection based on data</a></li>
<li><a href="../341226/index.html">Broo - lossless compression algorithm. Improvements</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>