<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reinforced.Typings is a library for automatically generating TypeScript-taipings and not only</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I wrote a small but useful library for TypeScript and ASP.NET MVC lovers. I would very much like to tell you about it - maybe some developer on the af...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reinforced.Typings is a library for automatically generating TypeScript-taipings and not only</h1><div class="post__text post__text-html js-mediator-article">  I wrote a small but useful library for TypeScript and ASP.NET MVC lovers.  I would very much like to tell you about it - maybe some developer on the aforementioned combination of technologies (and possibly the whole team) will make life much easier.  There is no time to write full documentation in English.  It generally needs to be approached intelligently, with feeling, plainly and constellation.  So I decided to write an article on Habrahabr, and right now, under the cut, I will do a brief overview and show you what magic you can do with this thing.  Welcome. <br><a name="habracut"></a><br><h4>  Lyrical introduction </h4><br>  In general, the idea of ‚Äã‚Äãtight integration of the Back-End and Front-End on the .NET stack, which in turn even resulted in an attempt to write a whole translator from C # in JavaScript, has long and firmly aggravated me.  I won't say that no results were achieved - my translator successfully translated several C # classes into JavaScript and eventually went into hibernation and rethinking the architecture.  Someday I will come back to him.  Required. <br><br>  But, nevertheless, the current tasks in the projects had to somehow be solved.  And the current tasks in almost any web project are, on the whole, quite typical and, I‚Äôm not afraid of that word, boring.  Now, I, with your permission, abstract from any complicated, but long-understood matters, such as using Automapper, picking up an IoC container and rustling in the database using EF / NH / something, and switch closer to the frontend.  So - at the junction of the backend and the frontend, there are also many boring and typical tasks (sarcasm).  Specifically, server requests for JSON with data, their display and the performance of all sorts of different AJAX operations.  Reinforced.Typings (and that is how I called my little help) will bring a bit of fun to this realm of dejection, simplifying typical tasks, getting rid of the template code and a bit more consistency. <br><br>  Since Microsoft gave us TypeScript, writing client-side JavaScript has become much more comfortable.  TypeScript brought a sense of typability and precompilability to where it was missing.  If you have not tried it yet, be sure to try it (this is not an advertisement, no).  You can, of course, argue a lot on the question of ‚Äúto be or not to be‚Äù TypeScript in your particular project, but let's skip the discussion and move on ‚Äú- Closer to the body! - as Guy de Maupassant said‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Practical example </h4><br>  So, let's consider a simple but fairly common example - you need to make a request to the server, get information about the order and display it in some way on a page in the browser. <br><br>  What do we usually do to solve this problem?  Right.  We make the POCO order model and the controller method, which will return its instance wrapped in JSON.  Here they are, our heroes (as you understand, I will remove the extra code to save space): <br><br><div class="spoiler">  <b class="spoiler_title">Modelka</b> <div class="spoiler_text"><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OrderViewModel</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ItemName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Quantity { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> Subtotal { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsPaid { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ClientName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Address { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Controller method</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetOrder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> orderId</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> orderVm = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderViewModel() { <span class="hljs-comment"><span class="hljs-comment">// ...   ... }; return Json(orderVm, JsonRequestBehavior.AllowGet); }</span></span></code> </pre><br></div></div><br>  Here everything is more or less clear and comments, I think, are superfluous.  Let's switch to the client.  To be extremely clear, I will use jQuery for ajax requests, but if necessary, you can replace it with something of your own.  As before, I omit the unnecessary glue code, as well as creating a view, a TypeScript file, connecting it to the village, installing jQuery from NuGet - you can do this without me.  I emphasize the very essence (once again I remind you that this code is in TypeScript): <br><br><div class="spoiler">  <b class="spoiler_title">TypeScript code</b> <div class="spoiler_text"><pre> <code class="javascript hljs">private btnRequest_click() { $.ajax({ <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/Home/GetOrder?orderId=10'</span></span>, <span class="hljs-attr"><span class="hljs-attr">success</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleResponse }); } private handleResponse(data: any) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text = <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.ClientName}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.Address}</span></span></span><span class="hljs-string"> (</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.ItemName}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.Quantity}</span></span></span><span class="hljs-string">)`</span></span>; $(<span class="hljs-string"><span class="hljs-string">'#divInfo'</span></span>).text(text); }</code> </pre><br></div></div><br>  Everything is beautiful here.  Except that fundamentally from JavaScript, this construct is no different.  We get a piece of JSON from the server, in which some object and we, counting on the fact that it has the fields ClientName, Address and others - output it to a div.  It does not sound very stable.  If any unfortunate junior removes from the ViewModel and C # code, say, the ClientName field (or renames it for junior refactoring), then all the places on the frontend that use this design will turn into detonators and wait the arrival of the tester.  Well, or end user-a - here it is someone as lucky.  What to do?  The answer is obvious - since we use TypeScript, then we can write the tapping for this particular ViewModel and rewrite the code like this: <br><br><pre> <code class="javascript hljs">private handleResponse(data: IOrderViewModel) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text = <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.ClientName}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.Address}</span></span></span><span class="hljs-string"> (</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.ItemName}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${data.Quantity}</span></span></span><span class="hljs-string">)`</span></span>; $(<span class="hljs-string"><span class="hljs-string">'#divInfo'</span></span>).text(text); }</code> </pre><br>  Yes, now it has become somewhat more comfortable for us - we have insured against access to an undeclared field.  But the situation with the junior renaming the field personally does not allow me to sleep.  Yes, and writing taiping for all ViewModel-her ... hands ... at night ... And if there are hundreds of them in the project?  And if thousands?  Perspective, frankly, so-so. <br><br>  This is where Reinforced.Typings comes into play and the solution of the problem begins radically in a different way.  So, open the PM-console (well, or anyone is comfortable - you can do it through the graphical interface) and set: <br><br><pre> <code class="bash hljs">PM &gt; Install-Package Reinforced.Typings</code> </pre><br>  We notice in the project root a new Reinforced.Typings.settings.xml file.  It is documented in sufficient detail and I do not see any point in rewriting everything stated in it here (unless of course <s>someone from the audience</s> is not so bad with English), giving it to the habra people.  I will change just one parameter - this is the path to the file where the generated tapping will go.  In my project, he is like this: <br><br><pre> <code class="hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RtTargetFile</span></span></span><span class="hljs-tag">&gt;</span></span>$(ProjectDir)Scripts\app\Server.ts<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RtTargetFile</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  After that, I go to the code of the model and add just two lines of code - using Reinforced.Typings.Attributes and the <b>[TsInterface]</b> attribute over the model itself.  Like this: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Reinforced.Typings.Attributes; [TsInterface] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OrderViewModel</span></span> { <span class="hljs-comment"><span class="hljs-comment">//        }</span></span></code> </pre><br>  After that, I rebuild the project (I rebuild it) and manually add it to Scripts \ app \ generated according to the Server.ts configuration.  He is already in the specified folder - just not added to the project.  Let's open Server.ts and see what is in it: <br><br><div class="spoiler">  <b class="spoiler_title">Content Server.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// This code was generated by a Reinforced.Typings tool. // Changes to this file may cause incorrect behavior and will be lost if // the code is regenerated. module Reinforced.Typings.Samples.Simple.Quickstart.Models { export interface IOrderViewModel { ItemName: string; Quantity: number; Subtotal: number; IsPaid: boolean; ClientName: string; Address: string; } }</span></span></code> </pre><br></div></div><br>  You see?  Wonderful.  Now the task of writing taipings for the ViewModel to her entire project does not seem such a terrible thing, does it?  And the deletion-renaming of properties ViewModel is no longer a tragedy: at the next build of the project, the typings will be regenerated and the TypeScript code, which is tied to them, will simply cease to be assembled, which you can see for yourself. <br><br>  I think that a practical demonstration of the main possibility can be completed on this, leaving more complicated examples for the following articles and moving on to a dramatic conclusion. <br><br><h4>  Dramatic conclusion and a little bit about this and that </h4><br>  Reinforced.Typings actually supports a lot of things.  Here is a short list: <br><ul><li>  Automatic taiping of delegates, heirs of IEnumerable and IDictionary (if you use them as properties) </li><li>  Taipings for enums and classes (although it cannot automatically translate the body of methods into TypeScript. But this can be done independently - see below) </li><li>  Tiping with complex types - Reinforced.Typings understands that you are using a different exported type in the class and automatically puts in the place the full-qualified type name used.  Otherwise, tactfully use any </li><li>  You can scatter the generated code across different files (class-per-file) using the appropriate configuration parameter </li><li>  You can add /// &lt;reference ...&gt; to the generated files using the [TsReference] assembly attribute.  And in the case of class-per-file, reference is automatically added to neighboring files. </li><li>  You can generate .d.ts-files instead of the usual .ts-code (there are some differences in the syntax) </li><li>  Cherry on the cake - each attribute has a CodeGeneratorType property, in which you can specify the heir type from Reinforced.Typings.Generators.ITsCodeGenerator &lt;&gt; (alternatively, inherit from the existing generator) and make your own generation of template TypeScript-code for everything, anything .  In this way, you can get to the automatic creation of knockout ViewModels for it directly from the server ViewModel code.  In the project at my current place of work, I overloaded the code generator for the controller actions and thus generated js-ny glue code for many methods, calling the corresponding controller method with the specified parameters.  These methods return q-shny promise (just because I love Q.js).  This is what I will tell in the next post. </li></ul><br>  Of the minuses: <b>Automatically generate the body methods of classes Reinforced.Typings can not - it works through Reflection</b> .  Well, I would also like to note some problems in the situation when server entities represent the correct TypeScript code, but the already generated code contains a semantic error (for example, a field has been deleted).  Due to the features of TypeScript assembly (it is going to be the very first in the entire project), you will not be able to rebuild the project and generate correct taipings that will correct the error until you correct the error manually.  But I'm working on it.  The magic of MSBuild works wonders. <br><br>  Also, according to the project, as mentioned above, there is very little documentation (this article, yes readme on github).  BUT!  XMLDOC is very detailed and the settings file is commented.  So, I think for the first time should be enough.  And there I‚Äôm already enrolling a student technician and doing a normal <s>book Reinforced.Typings Best Practices</s> documentation in a wiki format. <br><br>  In general, that's all for today.  If there are any questions - write in the comments.  I will try to answer. <br><br>  Reference to the project: <br>  <a href="https://github.com/reinforced/Reinforced.Typings">Reinforced.Typings on Github</a> <br>  <a href="https://www.nuget.org/packages/Reinforced.Typings/">Reinforced.Typings on NuGet</a> <br>  <a href="https://github.com/reinforced/Reinforced.Typings/tree/master/Samples/Simple/Reinforced.Typings.Samples.Simple.Quickstart">Full code of the considered example</a> <br><br>  <b>UPD</b> : <a href="http://habrahabr.ru/post/267003/">The second article on Reinforced.Typings, which provides much more details</a> </div><p>Source: <a href="https://habr.com/ru/post/266899/">https://habr.com/ru/post/266899/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266885/index.html">Google's Faces API Example</a></li>
<li><a href="../266891/index.html">Inoventica Services on Habr√©</a></li>
<li><a href="../266893/index.html">Creating a native iOS plugin for Unity3d. Undocumented features</a></li>
<li><a href="../266895/index.html">HTML5 customization customization element</a></li>
<li><a href="../266897/index.html">Implementing a pseudo-random number generator on a FPGA using Vivado HLS 2014.4</a></li>
<li><a href="../266901/index.html">Using handle and intrusive reference counter-s in multi-threaded environments in the C language</a></li>
<li><a href="../266903/index.html">PSR-2, the analysis of one item of the standard. Spaces or tabs</a></li>
<li><a href="../266905/index.html">FP on Scala: What is a functor?</a></li>
<li><a href="../266907/index.html">HP TippingPoint ATA Network and HP TippingPoint ATA Mail</a></li>
<li><a href="../266909/index.html">PHP and realpath_cache</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>