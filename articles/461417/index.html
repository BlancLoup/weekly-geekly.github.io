<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I refused db4o in an industrial system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are a large company department developing an important system in Java SE / MS SQL / db4o. For several years, the project switched from a prototype ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I refused db4o in an industrial system</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/ql/p2/ye/qlp2yevkdo5rbywpveackt_fm7s.jpeg" alt="image"></p><br><p>  We are a large company department developing an important system in Java SE / MS SQL / db4o.  For several years, the project switched from a prototype to industrial operation and db4o turned into a calculation brake, I wanted to switch from db4o to modern noSQL technology.  Trial and error led far from the original plan - db4o was successfully abandoned, but at the cost of a compromise.  Under the cat reflections and implementation details. </p><a name="habracut"></a><br><h2 id="tehnologiya-db4o-umerla">  Is db4o technology dead? </h2><br><p>  On Habr√© it is possible to find not so many <a href="https://habr.com/ru/post/56399/">publications</a> about db4o.  On Stackoverflow, there‚Äôs some residual activity like a <a href="https://stackoverflow.com/questions/18291480/using-an-object-oriented-database-db4o-for-a-medium-scale-application/56042994">fresh comment on an old question</a> or a <a href="https://stackoverflow.com/questions/53375277/db4o-native-query-in-c-how-to-find-by-first-number">fresh unanswered question</a> .  Wiki generally <a href="https://en.wikipedia.org/wiki/Comparison_of_object_database_management_systems">believes</a> that the current stable version is dated 2011. </p><br><p>  This forms a general impression: the technology is irrelevant.  There was even <a href="https://supportservices.actian.com/versant/default.html">official confirmation</a> : Actian decided not to actively pursue and promote the commercial db4o product offering for new customers any longer. </p><br><h2 id="kak-db4o-popala-v-raschet">  How did db4o get calculated </h2><br><p>  The article <a href="https://habr.com/ru/post/56399/">Introduction to Object Oriented Databases</a> talks about the main feature of db4o - the complete absence of a data scheme.  You can create any object </p><br><pre><code class="plaintext hljs">User user1 = new User("Vasya", "123456", 25);</code> </pre> <br><p>  and then just write it to the database file </p><br><pre> <code class="plaintext hljs">db.Store(user1)</code> </pre> <br><p>  The recorded object can then be retrieved using the Query.execute () method in the form in which it was saved. </p><br><p>  At the start of the project, this made it possible to quickly ensure the display of the audit trail with all the submitted data, without bothering with the structure of relational tables.  This helped the project survive.  Then there were few resources in the sandbox, and immediately after the end of today's calculation, data for tomorrow began to load in MS SQL.  Everything was constantly changing - go figure out what exactly was automatically served at night.  And the db4o file can be accessed <br>  in debugging, extract a snapshot of the desired day and answer the question "we submitted all the data, but you did not order anything." </p><br><p>  Over time, the problem of survival disappeared, the project took off, the work with user requests has changed.  Open a db4o file in debugging and parse a difficult question can a developer who is always busy.  Instead, there is a crowd of analysts armed with a description of the order logic and able to use only the user-visible piece of data.  Soon db4o began to be used only to display the history of the calculation.  Just like <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BD_%25D0%259F%25D0%25B0%25D1%2580%25D0%25B5%25D1%2582%25D0%25BE">Pareto</a> - a small part of the capabilities provides the main load. </p><br><p>  In combat operation, the history file takes ~ 35 GB / day, unloading takes about an hour.  The file itself compresses well (1:10), but for some reason the com.db4o.ObjectContainer library does not perform compression.  In the north of CentOS, the com.db4o.query.Query library writes / reads a file exclusively to one stream.  Speed ‚Äã‚Äãis a bottleneck. </p><br><h1 id="principialnaya-shema-ustroystva">  Schematic diagram of the device </h1><br><p>  The information model of the system is the hierarchy of objects A, B, C and D. The hierarchy is not a tree; links C1 -&gt; B1 are required for operation. </p><br><pre> <code class="plaintext hljs">ROOT || | ==&gt;A1 | || | | ==&gt; B1 &lt;------ | | || | | | | ======&gt; C1 | | | | | | | ===&gt; C1.$D | | =======&gt; C2 | | | | ==&gt; B2 ==&gt; C2.$D | | ===&gt;A2 =======&gt; C3 | | ==&gt; B3 ===&gt; C3.$D | ======&gt; C4 | ===&gt; C4.$D</code> </pre> <br><p>  The user interacts with the server through the user interface (GUI), which is provided by com.sun.net.httpserver.HttpsServer, the client and server exchange XML documents.  At the first display, the server assigns an identifier to the user level, which does not change further.  If the user needs a history of some level, the GUI sends the server an XML-wrapped identifier.  The server determines the key values ‚Äã‚Äãfor the search in the database, scans the db4o file for the desired day and retrieves the requested object in memory plus all the objects to which it refers.  Builds an XML presentation of the extracted level and returns it to the client. </p><br><p>  When scanning a file, db40 by default reads all child objects to a certain depth, extracting a rather large hierarchy together with the desired object.  Reading time can be reduced by setting the minimum activation depth for the unnecessary Foo class with conf.common (). ObjectClass (Foo.class) .maximumActivationDepth (1). </p><br><p>  Using anonymous classes leads to the creation of implicit references to the enclosing class <a href="https://stackoverflow.com/questions/27145010/whats-the-meaning-of-this-this0">this $ 0</a> .  Db4o processes and restores such links correctly (but slowly). </p><br><h1 id="0-ideya">  0. Idea </h1><br><p>  So, admins have a strange expression on their faces when it comes to supporting or administering db4o.  Data extraction is slow, the technology is not very lively.  Task: instead of db4o, apply the current NoSQL technology.  A pair of Spring Data + MongoDB caught my eye. </p><br><h1 id="1-lobovoy-podhod">  1. Frontal approach </h1><br><p>  My first <a href="https://www.baeldung.com/spring-data-mongodb-tutorial">thought</a> was to use org.springframework.data.mongodb.core.MongoOperations and the save () method, because it looks like com.db4o.ObjectContainer.db.Store (user1).  The MongoDB documentation says that documents are stored in collections, it is logical to present the necessary system objects as documents of the corresponding collections.  There are also <a href="https://docs.mongodb.com/manual/reference/database-references/">@ DBRef annotations</a> that allow you to implement relationships between documents in general in the spirit of <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D1%2580%25D0%25B5%25D1%2582%25D1%258C%25D1%258F_%25D0%25BD%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0">3NF</a> .  Go. </p><br><h2 id="11-vygruzka-ssylochnyy-tip-klyucha">  1.1.  Unloading.  Key Reference Type </h2><br><p>  The system consists of POJO classes designed long ago and without taking into account all these new technologies.  Fields of type Map &lt;POJO, POJO&gt; are used, there is a branched logic of working with them.  I save this field, I get an error </p><br><pre> <code class="plaintext hljs">org.springframework.data.mapping.MappingException: Cannot use a complex object as a key value.</code> </pre> <br><p>  On this occasion, only <a href="https://jira.spring.io/browse/DATAMONGO-242">correspondence in 2011 was found</a> , in which it was proposed to develop non-standard MappingMongoConverter.  Noted so far the problem fields @ Transient, I‚Äôm going on.  It turned out to save, studying the result. </p><br><p>  Saving occurs in the collection, the name of which coincides with the name of the saved class.  I haven‚Äôt used @DBRef annotations yet, so there is only one collection, JSON documents are quite large and branched.  I notice that when you save the object, MongoOperations goes through all (including inherited) non-empty links and writes them as an attached document. </p><br><h2 id="12-vygruzka-imenovannoe-pole-ili-massiv">  1.2.  Unloading.  Named field or array? </h2><br><p>  The system model is such that class C may contain a reference to the same class D several times.  In a separate defaultMode field and among other links in ArrayList, something like this <br></p><pre> <code class="plaintext hljs">public class C { private D defaultMode; private List&lt;D&gt; listOfD = new ArrayList&lt;D&gt;(); public class D { .. } public C(){ this.defaultMode = new D(); listOfD.add(defaultMode); } }</code> </pre> <br><p>  After unloading, the JSON document will have two copies of it: an attached document named defaultMode and an unnamed element of the document array.  In the first case, the document can be accessed by name, in the second - by the name of the array with an index.  You can search MongoDB collections in both cases.  Working only with Spring Data and MongoDB, I came to the conclusion that you can use ArrayList, if carefully;  I did not notice any restrictions on the use of arrays.  Features appeared later, at the MongoDB Connector for BI level. </p><br><h2 id="13-zagruzka-argumenty-konstruktora">  1.3.  Loading.  Constructor arguments </h2><br><p>  I am trying to read a saved document using the MongoOperations.findOne () method.  Loading object A from the database throws an exception </p><br><pre> <code class="plaintext hljs">"No property name found on entity class A to bind constructor parameter to!"</code> </pre> <br><p>  It turned out that the class has a corpName field, and the constructor has the String name parameter, and this.corpName = name is assigned in the constructor body.  MongoOperations requires that the field names in the classes match the names of the constructor arguments.  If there are several constructors, you need to select one with the @PersistenceConstructor annotation.  I bring the names of the fields and parameters into correspondence. </p><br><h2 id="14-zagruzka-sd-i-this0">  1.4.  Loading.  With $ D and this $ 0 </h2><br><p>  The inner nested class D encapsulates the default class C behavior and does not make sense separately from class C.  An instance D is created for each instance of C and vice versa - for each instance of D there is an instance of C that generated it. The class D still has descendants that implement alternative behaviors and can be stored in listOfD.  The constructor of the descendant classes of D requires the presence of an already existing object C. </p><br><p>  In addition to nested inner classes, the system uses <a href="https://juja.com.ua/java/inner-and-nested-classes/">anonymous</a> inner classes.  As you <a href="https://stackoverflow.com/questions/27145010/whats-the-meaning-of-this-this0">know</a> , both of them contain an implicit reference to an instance of an enclosing class.  That is, as part of each instance of the CD object, the compiler creates a link this $ 0, which points to the parent object C. </p><br><p>  Again I try to read a saved document from the collection and get an exception </p><br><pre> <code class="plaintext hljs">"No property this$0 found on entity class $D to bind constructor parameter to!"</code> </pre> <br><p>  I recall that the methods of class D use the full force of C.this.fieldOfClassC references, and the descendants of class D require the constructor to have an instantiated C instance as an argument.  That is, I need to provide a certain order of creating objects in MongoOperations so that the parent object C can be specified in the D constructor. Again, non-standard MappingMongoConverter? </p><br><p>  Maybe not using anonymous classes and making inner classes normal?  Refining, or rather refining the architecture of an already implemented system is a wow task ... </p><br><h1 id="2-podhod-so-storony-3nfdbref">  2. Approach from 3NF / @ DBRef </h1><br><p>  I try to go on the other hand, save each class in my collection and make connections between them in the spirit of 3NF. </p><br><h2 id="21-vygruzka-dbref---eto-krasivo">  2.1.  Unloading.  @DBRef is beautiful </h2><br><p>  Class C contains several references to D. If the defaultMode and ArrayList links are marked as @DBRef, the document size will decrease, instead of huge attached documents there will be neat links.  In field json document of collection C field appears <br></p><pre> <code class="plaintext hljs">"defaultMode" : DBRef("D", ObjectId("5c496eed2c9c212614bb8176"))</code> </pre> <br><p>  In the MongoDB database, a collection D is automatically created and a document with a field in it </p><br><pre> <code class="plaintext hljs">"_id" : ObjectId("5c496eed2c9c212614bb8176")</code> </pre> <br><p>  Everything is simple and beautiful. </p><br><h2 id="22-zagruzka-konstuktor-klassa-d">  2.2.  Loading.  Class D constructor </h2><br><p>  When working with links, the C object knows that the default D object is created exactly once.  If you need to bypass all D objects except the default one, just compare the links: </p><br><pre> <code class="plaintext hljs">private D defaultMode; private ArrayList&lt;D&gt; listOfD; for (D currentD: listOfD){ if (currentD == defaultMode) continue; doSomething(currentD); }</code> </pre> <br><p>  I call findOne (), I study my class C. It turns out that MongoOperations reads a json document and calls the D constructor for each @DBRef annotation it encounters, each time creating a new object.  I get a strange construct - two different references to D in the defaultMode field and in the listOfD array, where the link should be the same. </p><br><p>  Learning from the <a href="https://stackoverflow.com/questions/9412341/mongodb-is-dbref-necessary">community</a> : "Dbref in my opinion should be avoided when work with mongodb."  Another <a href="https://docs.mongodb.com/manual/reference/database-references/">consideration</a> in the same vein from the official documentation: the denormalized data model where related data is stored within a single document will be optimal to resolve DBRefs, your application must perform additional queries to return the referenced documents. </p><br><p>  The mentioned documentation page says at the very beginning: "For many use cases in MongoDB, the denormalized data model where related data is stored within a single document will be optimal."  Is it written for me? </p><br><p>  Focus with the designer suggests that you don‚Äôt need to think like in a relational DBMS.  The choice is: </p><br><ul><li>  if you specify @DBRef: <br><ul><li>  the constructor for each annotation will be called and several identical objects will be created; </li><li>  MongoOperations will find and read all documents from all related collections.  There will be a request to the index by ObjectId and then reading from many collections of a (large) database; </li></ul></li><li>  if not specified, then "abnormalized" json will be saved with repetitions of the same data. </li></ul><br><p>  I note for myself: you can not rely on @DBRef, but use a field of type ObjectId, filling it manually.  In this case, instead of </p><br><pre> <code class="plaintext hljs">"defaultMode" : DBRef("D", ObjectId("5c496eed2c9c212614bb8176"))</code> </pre> <br><p>  json document will contain </p><br><pre> <code class="plaintext hljs">"defaultMode" : ObjectId("5c496eed2c9c212614bb8176")</code> </pre> <br><p>  There will be no automatic loading - MongoOperations does not know in which collection to search for a document.  The document will need to be loaded in a separate (lazy) request indicating the collection and ObjectId.  A single query should return the result quickly, in addition, an automatic index is created for each collection by ObjectId. </p><br><h2 id="23-nu-i-chto-teper">  2.3.  So what now? </h2><br><p>  Subtotals.  It was not possible to quickly and easily implement the db4o functionality on MongoDB: </p><br><ul><li>  It is unclear how to use a custom POJO as a Key - Value list key; </li><li>  it is unclear how to set the order of creating objects in MappingMongoConverter; </li><li>  it is unclear whether to upload an ‚Äúabnormalized‚Äù document without DBRef and whether it is necessary to invent its own mechanism for lazy initialization. </li></ul><br><p>  You can add lazy loading.  You can try to do MappingMongoConverter.  You can modify existing constructors / fields / lists.  But there are many years of layering of business logic - not a weak alteration and the risk of never being tested. </p><br><p>  Compromise solution: to make a new mechanism for saving data for the problem being solved, while retaining the mechanism for interacting with the GUI. </p><br><h1 id="3-popytka-tretya-opyt-pervyh-dvuh">  3. The third attempt, the experience of the first two </h1><br><p>  Pareto suggests that solving problems with the speed of users will mean the success of the whole task.  The task is this: you need to learn how to quickly save and restore user presentation data without db4o. </p><br><p>  This will lose the ability to examine the saved object in debugging.  On the one hand, this is bad.  On the other hand, such tasks rarely occur, and in git all combat deliveries are tagged.  For fault tolerance, each time before unloading, the system serializes the calculation to a file.  If you need to examine an object in debugging, you can take serialization, clone the corresponding system assembly and restore the calculation. </p><br><h2 id="31-dannye-polzovatelskih-prezentaciy">  3.1.  Custom Presentation Data </h2><br><p>  To build presentations of user levels, the system has a special Viewer class.  The Viewer.getXML () method receives a level as an input, extracts the necessary numeric and string values ‚Äã‚Äãfrom it, and generates XML. </p><br><p>  If the user asked to show the level of today's calculation, then the level will be found in RAM.  To show a calculation from the past, the com.db4o.query.Query.execute () method will find the level in the file.  The level from the file is almost no different from the level just created and Viewer will build the presentation without noticing the substitution. </p><br><p>  To solve my problem, I need an intermediary between the calculation level and its presentation - the presentation framework (Frame), which will store data and build on the available XML data.  The chain of actions for building the presentation will become longer, each time a frame will be generated and the frame will generate XML: </p><br><pre> <code class="plaintext hljs"> : &lt; &gt; -&gt; Viewer.getXML() : &lt; &gt; -&gt; Viewer.getFrame() -&gt; Frame.getXML()</code> </pre> <br><p>  When saving the story, you will need to build frames of all levels and write to the database. </p><br><h2 id="32-vygruzka">  3.2.  Unloading </h2><br><p>  The task turned out to be relatively simple and there were no problems with it.  Repeating the structure of the XML presentation, the frame received a recursive device in the form of a hierarchy of elements with the fields String, Integer and Double.  The frame requests getXML () from all its elements, collects it into a single document, and returns.  MongoOperations did a great job with the recursive nature of the frame and did not ask new questions as it progressed. </p><br><p>  Finally, everything took off!  The WiredTiger engine by default <a href="https://www.mongodb.com/blog/post/new-compression-options-mongodb-30">compresses</a> MongoDB document collections; on the file system, unloading took ~ 3.5 GB per day.  A tenfold decrease over db4o is not bad. </p><br><p>  At first, the unloading was arranged simply - a recursive traversal of the level tree, MongoOperations.save () for each.  Such unloading took 5.5 hours, and this despite the fact that building presentations involves only reading objects.  I add multithreading: recursively traverse the level tree, split all available levels into packages of a certain size, create Callable.call () implementations according to the number of packages, transfer each package to our own package and do it all through ExecutorService.invokeAll (). </p><br><p>  MongoOperations again asked no questions and did a great job with multi-threaded mode.  Empirically selected the size of the package, giving the best speed of unloading.  It turned out 15 minutes for a package of 1000 levels. </p><br><h2 id="33-mongo-bi-connector-ili-kak-lyudyam-s-etim-rabotat">  3.3.  Mongo BI Connector, or how people work with it </h2><br><p>  The MongoDB <a href="https://habr.com/ru/post/134590/">query</a> language is large and powerful, I inevitably gained experience working with it, reaching this place.  The console <a href="https://docs.mongodb.com/manual/reference/method/">supports</a> JavaScript, you can write beautiful and powerful designs.  This is one side.  On the other hand, I can break the brains of a good half of fellow analysts with a request </p><br><pre> <code class="plaintext hljs">db.users.find( { numbers: { $in: [ 390, 754, 454 ] } } );</code> </pre> <br><p>  instead of the usual </p><br><pre> <code class="plaintext hljs">SELECT * FROM users WHERE numbers IN (390, 754, 454)</code> </pre> <br><p>  <a href="https://docs.mongodb.com/bi-connector/v2.0/">MongoDB Connector for BI</a> comes to the rescue, through which you can present collection documents in tabular form.  The MongoDB database is called a document-based database, it does not know how to present a hierarchy of fields / documents in a tabular form.  For the connector to work, it is necessary to describe the structure of the future table in a separate .drdl file, the format of which is very similar to yaml.  The file must contain the correspondence between the field of the relational table at the output and the path to the field of the JSON document at the input. </p><br><h2 id="34--osobennosti-ispolzovanie-massivov">  3.4.  Features using arrays </h2><br><p>  It was said above that for MongoDB itself there is no special difference between an array and a field.  From a connector perspective, an array is very different from a named field;  I even had to refactor the finished Frame class.  An array of documents should be used only when it is necessary to place part of the information in a linked table. </p><br><p>  If the JSON document is a hierarchy of named fields, then any field can be accessed by specifying the path from the document root through a dot, for example xy. If the correspondence xy =&gt; fieldXY is specified in the DRDL file, then the output table will have as many rows as there are documents in the collection at the entrance.  If there is no xy field in any document, NULL will be in the corresponding row of the table. </p><br><p>  Suppose we have a MongoDB database called Frames, there is a collection A in the database, and MongoOperations has written two instances of class A to this collection. The following documents have turned out: first </p><br><pre> <code class="plaintext hljs">{ "_id": ObjectId("5cdd51e2394faf88a01bd456"), "x": { "y": "xy string value 1"}, "days": [{ "k": "0", "v": 0.0 }, { "k": "1", "v": 0.1 }], "_class": "A" }</code> </pre> <br><p>  and second (ObjectId differs by the last digit): </p><br><pre> <code class="plaintext hljs">{ "_id": ObjectId("5cdd51e2394faf88a01bd457"), "x": { "y": "xy string value 2"}, "days": [{ "k": "0", "v": 0.3 }, { "k": "1", "v": 0.4 }], "_class": "A" }</code> </pre> <br><p>  The BI connector is not able to access the elements of the array by index, and it is simply impossible to extract, for example, the days [1] .v field from the array into the table.  Instead, the connector can represent each element of the days array as a row in a separate table using the <a href="https://docs.mongodb.com/v4.0/reference/operator/aggregation/unwind/">$ unwind</a> operator.  This separate table will be associated with the original one-to-many relationship through the row identifier.  In our example, tables tableA are defined for collection documents and tableA_days for documents of the days array.  The .drdl file looks like this: </p><br><pre> <code class="plaintext hljs">schema: - db: Frames tables: - table: tableA collection: A pipeline: [] columns: - Name: _id MongoType: bson.ObjectId SqlName: _id SqlType: objectid - Name: xy MongoType: string SqlName: fieldXY SqlType: varchar - table: tableA_days collection: A pipeline: - $unwind: path: $days columns: - Name: _id #   MongoType: bson.ObjectId SqlName: tableA_id SqlType: objectid - Name: days.k MongoType: string SqlName: tableA_dayNo SqlType: varchar - Name: days.v MongoType: string SqlName: tableA_dayVal SqlType: varchar</code> </pre> <br><p>  The contents of the tables will be: table tableA </p><br><div class="scrollable-table"><table><thead><tr><th>  _id </th><th>  fieldXY </th></tr></thead><tbody><tr><td>  5cdd51e2394faf88a01bd456 </td><td>  xy string value 1 </td></tr><tr><td>  5cdd51e2394faf88a01bd457 </td><td>  xy string value 2 </td></tr></tbody></table></div><br><p>  and table tableA_days </p><br><div class="scrollable-table"><table><thead><tr><th>  tableA_id </th><th>  tableA_dayNo </th><th>  tableA_dayVal </th></tr></thead><tbody><tr><td>  5cdd51e2394faf88a01bd456 </td><td>  0 </td><td>  0.0 </td></tr><tr><td>  5cdd51e2394faf88a01bd456 </td><td>  one </td><td>  0.1 </td></tr><tr><td>  5cdd51e2394faf88a01bd457 </td><td>  0 </td><td>  0.3 </td></tr><tr><td>  5cdd51e2394faf88a01bd457 </td><td>  one </td><td>  0.4 </td></tr></tbody></table></div><br><h1 id="itogo">  Total </h1><br><p>  It was not possible to implement the task in the original formulation; you cannot just take and replace db4o with MongoDB.  MongoOperations is not able to automatically restore any object like db4o.  You can probably do this, but labor costs will not be comparable to calling the store / query methods of the db4o library. </p><br><p>  Audit trail.  Db4o is a very useful tool at the start of a project.  You can simply write the object, then restore it and at the same time no worries and tables.  All this with an important caveat: if you need to change the hierarchy of classes (add class E between A and B), then all previously stored information becomes unreadable.  But for starting a project this is not very important, as long as there is no large accumulated array of old files. </p><br><p>  When there was enough experience with MongoOperations, writing the upload did not cause problems.  Writing a new code for the framework is much easier than redoing the old one, which is also put on production. </p><p></p><p></p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/461417/">https://habr.com/ru/post/461417/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../46140/index.html">Platform 2009 conference has begun</a></li>
<li><a href="../461401/index.html">What are you, Event Loop? Or how the event loop works in the Chrome browser</a></li>
<li><a href="../461403/index.html">How to write music using OOP</a></li>
<li><a href="../461405/index.html">How I took CFA Level 1</a></li>
<li><a href="../461413/index.html">Not only Wi-Fi 6: how Huawei will develop network technologies</a></li>
<li><a href="../461419/index.html">Medium Weekly Digest # 2 (19 - 26 Jul 2019)</a></li>
<li><a href="../46142/index.html">Help with information about the keyboard</a></li>
<li><a href="../461421/index.html">How to insure yourself against possible losses when investing on the exchange: structural products</a></li>
<li><a href="../461425/index.html">How to become a product manager and grow further</a></li>
<li><a href="../46143/index.html">Python 3.0 released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>