<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn OpenGL. Part 2.3. - Materials</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A couple of days ago I came across the first article in this series of lessons. Unfortunately, only the initial lessons have been translated, and the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn OpenGL. Part 2.3. - Materials</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/c9e/9b2/a3b/c9e9b2a3baf749ab8e2b385c6d93d966.png" alt="image" align="left" width="300"></p><br><p>  A couple of days ago I came across the first article in this series of lessons.  Unfortunately, only the initial lessons have been translated, and the most interesting (SSAO, PBR, shadows) are only ahead.  This course was translated by three people (now four), and I hope that someone from the readers will help with the translation of the remaining parts.  Unfortunately, I am not a professional translator; for this, the text may contain errors of a different nature.  I would be glad if you report them.  Enjoy reading! </p><a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">Content</b> <div class="spoiler_text">  Part 1. Start <br><br><ol><li>  <a href="https://habrahabr.ru/post/310790/">Opengl</a> </li><li>  <a href="https://habrahabr.ru/post/311198/">Creating a window</a> </li><li>  <a href="https://habrahabr.ru/post/311234/">Hello window</a> </li><li>  <a href="https://habrahabr.ru/post/311808/">Hello triangle</a> </li><li>  <a href="https://habrahabr.ru/post/313380/">Shaders</a> </li><li>  <a href="https://habrahabr.ru/post/315294/">Textures</a> </li><li>  <a href="https://habrahabr.ru/post/319144/">Transformations</a> </li><li>  <a href="https://habrahabr.ru/post/324968/">Coordinate systems</a> </li><li>  <a href="https://habrahabr.ru/post/327604/">Camera</a> </li></ol><br>  Part 2. Basic lighting 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  <a href="https://habrahabr.ru/post/329592/">Colors</a> </li><li>  <a href="https://habrahabr.ru/post/333932/">Lighting Basics</a> </li><li>  <a href="https://habrahabr.ru/post/336166/">Materials</a> </li><li>  <a href="https://habrahabr.ru/post/337550/">Texture Cards</a> </li><li>  <a href="https://habrahabr.ru/post/337642/">Sources of light</a> </li><li>  <a href="https://habrahabr.ru/post/338254/">Multiple light sources</a> </li></ol><br>  Part 3. Loading 3D Models <br><br><ol><li>  <a href="https://habrahabr.ru/post/338436/">Assimp library</a> </li><li>  <a href="https://habrahabr.ru/post/338436/">Mesh mesh class</a> </li><li>  <a href="https://habrahabr.ru/post/338998/">Model class</a> </li></ol><br>  Part 4. OpenGL advanced features <br><br><ol><li>  <a href="https://habrahabr.ru/post/342610/">Depth test</a> </li><li>  <a href="https://habrahabr.ru/post/344238/">Stencil test</a> </li><li>  <a href="https://habrahabr.ru/post/343096/">Mixing colors</a> </li><li>  <a href="https://habrahabr.ru/post/346964/">Face clipping</a> </li></ol></div></div><br><br><h1>  Materials </h1><br><p>  In the real world, each object responds differently to light.  Iron objects usually sparkle stronger than, for example, a clay vase.  A wooden container does not react to light in the same way as a steel one.  Each object has a different reflectivity.  Some objects reflect light without strong scattering, while others have a fairly large reflection radius.  If we want to imitate different types of objects in OpenGL, then we need to define material properties specific to each object. </p><br><p>  In the previous lesson, we set the color of the light to determine the appearance of the object, combined with the background and reflective components.  Describing objects, we can set the color of the material for all three lighting components: <em>ambient</em> , <em>diffuse</em> and <em>specular</em> .  After that we will get detailed control over the resulting color of the object.  Now add the <em>power of shine</em> ( <em>shininess</em> ) to our three colors and get all the material properties that we need: </p><br><pre><code class="hljs swift">#version <span class="hljs-number"><span class="hljs-number">330</span></span> core <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Material</span></span></span><span class="hljs-class"> </span></span>{ vec3 ambient; vec3 diffuse; vec3 specular; float shininess; }; uniform <span class="hljs-type"><span class="hljs-type">Material</span></span> material;</code> </pre> <br><p>  In the fragment shader, we create a structure that stores the material properties of the object.  Of course, we can store out as independent <em>uniform variables</em> , but this is less organized.  First we define the structure, and then simply declare a <em>unifrom variable</em> with the type of the newly created structure. </p><br><p>  As you can see, we define a color vector for each component of <em>lighting by Phong</em> .  The <code>ambient</code> vector determines what color an object reflects under background lighting.  This is usually the color of the object itself.  The <code>diffuse</code> vector defines the color of the object under ambient lighting.  As well as the background, it determines the desired color of the object.  The <code>specular</code> vector sets the color of the flare on the object, and the <code>shininess</code> variable <code>shininess</code> radius of this flare. </p><br><p>  Using these four components, we can simulate a variety of real materials.  The table on the <a href="http://devernay.free.fr/cours/opengl/materials.html">devernay.free.fr</a> website contains properties of some materials that we can see in real life.  The following image shows our cube, with different materials: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/aa8/18c/1a3/aa818c1a3d5d20448582a619cf6afbd4.png"></p><br><p>  As you can see, the correctly selected material properties completely transform our cube.  Of course, it can be seen with the naked eye, but for greater realism, we still need a more interesting figure.  In the next section of lessons we will discuss the loading of 3d-models of any complexity. </p><br><p>  Picking the right materials for an object is a complex art that requires a lot of experience and experimentation.  Therefore, it is not uncommon for the visual quality of an object to be completely lost, if it was chosen that material was not suitable. </p><br><p>  Let's try to implement a system of materials in the shaders. </p><br><h2>  Setting up materials </h2><br><p>  We created the structure of the material in the fragment shader, for this we need to take this into account in further calculations of the lighting.  Since all material variables are stored in the structure, we can access them through a <em>uniform</em> <code>material</code> <em>variable</em> : </p><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> main() { // ambient vec3 ambient = lightColor * material.ambient; // diffuse vec3 norm = normalize(Normal); vec3 lightDir = normalize(lightPos - FragPos); <span class="hljs-type"><span class="hljs-type">float</span></span> diff = max(dot(norm, lightDir), <span class="hljs-number"><span class="hljs-number">0.0</span></span>); vec3 diffuse = lightColor * (diff * material.diffuse); // specular vec3 viewDir = normalize(viewPos - FragPos); vec3 reflectDir = reflect(-lightDir, norm); <span class="hljs-type"><span class="hljs-type">float</span></span> spec = pow(max(dot(viewDir, reflectDir), <span class="hljs-number"><span class="hljs-number">0.0</span></span>), material.shininess); vec3 specular = lightColor * (spec * material.specular); vec3 result = ambient + diffuse + specular; FragColor = vec4(result, <span class="hljs-number"><span class="hljs-number">1.0</span></span>); }</code> </pre><br><p>  As you can see, now when calculating the lighting, we use the properties of the <code>material</code> structure, so this time, the resulting color depends on the material we defined.  Each component of the material of an object is multiplied by its corresponding component of light. </p><br><p>  We can customize the material of the object in the application by setting the value of suitable <em>uniform variables</em> .  However, there is no particular way in GLSL to assign values ‚Äã‚Äãto structures.  The structure only encapsulates <em>uniform variables</em> .  Therefore, if we want to fill it, we must set the value of each <em>uniform variable</em> in the same way as we did before, but this time with the prefix of the structure name: </p><br><pre> <code class="cpp hljs">lightingShader.setVec3(<span class="hljs-string"><span class="hljs-string">"material.ambient"</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.31f</span></span>); lightingShader.setVec3(<span class="hljs-string"><span class="hljs-string">"material.diffuse"</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.31f</span></span>); lightingShader.setVec3(<span class="hljs-string"><span class="hljs-string">"material.specular"</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>); lightingShader.setFloat(<span class="hljs-string"><span class="hljs-string">"material.shininess"</span></span>, <span class="hljs-number"><span class="hljs-number">32.0f</span></span>);</code> </pre><br><p>  We set the <em>background</em> and <em>diffuse</em> components to the color of the object itself, and the <em>glare</em> was moderately bright.  We do not need him to stand out.  Also, we left <em>the brilliance force</em> equal to 32. Now we can easily influence the material of an object from the application. </p><br><p>  Running the program will produce the following results: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6cb/e13/b56/6cbe13b56db2c6e5dcbd2f05338f1f76.png"></p><br><p>  So far, it doesn't look very realistic, right? </p><br><h2>  Light properties </h2><br><p>  Now our object is too bright.  The reason for this lies in the fact that the background, diffuse and glare colors with full force are reflected from any light source.  However, light sources can also have different intensities.  In the previous lesson, we solved this problem by replacing the background and diffuse components with constant values.  Now we need to do something similar, but now for <strong>each</strong> component of the light.  If we represent <code>lightColor</code> as <code>vec3(1.0)</code> , then the code will be as follows: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vec3</span></span> ambient = vec3(<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>) * material.ambient; <span class="hljs-attribute"><span class="hljs-attribute">vec3</span></span> diffuse = vec3(<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>) * (diff * material.diffuse); <span class="hljs-attribute"><span class="hljs-attribute">vec3</span></span> specular = vec3(<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>) * (spec * material.specular);</code> </pre><br><p>  These values ‚Äã‚Äã( <code>vec3(1.0)</code> ) can be changed individually for each light source, and this is exactly what we need.  Now the color of the background component affects the color of the cube completely, but the background component should not affect the final color so much, so let's make it a bit smaller: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vec3</span></span> ambient = vec3(<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>) * material.ambient;</code> </pre><br><p>  We can influence the diffuse and glare component of light in the same way.  This is closely related to what we did in the previous lesson.  Now we need to create something similar to the structure of the material, but now for the light: </p><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Light</span></span></span><span class="hljs-class"> </span></span>{ vec3 position; vec3 ambient; vec3 diffuse; vec3 specular; }; uniform <span class="hljs-type"><span class="hljs-type">Light</span></span> light;</code> </pre><br><p>  The light source has different intensity for the <em>background</em> , <em>diffuse</em> and <em>glare</em> light.  Usually the intensity of the background light is quite low, because we do not want it to dominate too?  The color of the diffuse component is the color of the light source itself;  often it is bright white.  The mirror component is usually left equal to <code>vec3(1.0)</code> .  I note that we also added a vector of the <em>position of the light</em> in the structure. </p><br><p>  Now we update the lighting calculations in the fragment shader: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vec3</span></span> ambient = light.ambient * material.ambient; <span class="hljs-attribute"><span class="hljs-attribute">vec3</span></span> diffuse = light.diffuse * (diff * material.diffuse); <span class="hljs-attribute"><span class="hljs-attribute">vec3</span></span> specular = light.specular * (spec * material.specular);</code> </pre><br><p>  We also need to set the light intensity in the application itself: </p><br><pre> <code class="cpp hljs">lightingShader.setVec3(<span class="hljs-string"><span class="hljs-string">"light.ambient"</span></span>, <span class="hljs-number"><span class="hljs-number">0.2f</span></span>, <span class="hljs-number"><span class="hljs-number">0.2f</span></span>, <span class="hljs-number"><span class="hljs-number">0.2f</span></span>); lightingShader.setVec3(<span class="hljs-string"><span class="hljs-string">"light.diffuse"</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>); <span class="hljs-comment"><span class="hljs-comment">// darken the light a bit to fit the scene lightingShader.setVec3("light.specular", 1.0f, 1.0f, 1.0f);</span></span></code> </pre><br><p>  Now we have modeled the effect of light on the material of the object and obtained a result similar to the result of the previous lesson.  However, now we have complete control over the lighting and material of the object: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/031/464/86b/03146486bc09d10a1ae0fea047127c4e.png"></p><br><p>  Now it is relatively easy to change the appearance of the object. </p><br><h2>  Different colors of light </h2><br><p>  Until now, the color of our light source ranged from white to black, so we could not change the color of the object itself (only its intensity).  However, from this point on, we have easy access to the properties of light, so we can change it over time to get such cool results: </p><br><p></p><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://learnopengl.com/video/lighting/materials.mp4" type="video/mp4"></video></div></div></div><br><p>  As you can see, the change in light affects the colors an object can reflect (you probably remember from the color lesson), and this, in turn, significantly affects the result. </p><br><p>  We can easily vary the light from time to time, changing the background and diffuse colors through <code>sin</code> and <code>glfwGetTime</code> : </p><br><pre> <code class="cpp hljs">glm::vec3 lightColor; lightColor.x = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(glfwGetTime() * <span class="hljs-number"><span class="hljs-number">2.0f</span></span>); lightColor.y = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(glfwGetTime() * <span class="hljs-number"><span class="hljs-number">0.7f</span></span>); lightColor.z = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(glfwGetTime() * <span class="hljs-number"><span class="hljs-number">1.3f</span></span>); glm::vec3 diffuseColor = lightColor * glm::vec3(<span class="hljs-number"><span class="hljs-number">0.5f</span></span>); <span class="hljs-comment"><span class="hljs-comment">// decrease the influence glm::vec3 ambientColor = diffuseColor * glm::vec3(0.2f); // low influence lightingShader.setVec3("light.ambient", ambientColor); lightingShader.setVec3("light.diffuse", diffuseColor);</span></span></code> </pre><br><p>  Try and experiment with lighting and materials and you will see how they influence the result.  You can find the source code of the application <a href="https://learnopengl.com/code_viewer_gh.php%3Fcode%3Dsrc/2.lighting/3.1.materials/materials.cpp">here</a> . </p><br><h2>  Exercises </h2><br><ul><li>  Will you be able to simulate some real objects, endowing them with the relevant materials that we saw at the beginning of this lesson?  Note that the <a href="http://devernay.free.fr/cours/opengl/materials.html">tabular</a> values ‚Äã‚Äãof the background light do not coincide with the diffuse - they do not take into account the intensity of light.  To get the right results, you need to set the intensity of each component of the light to <code>vec3(1.0)</code> .  <a href="https://learnopengl.com/code_viewer_gh.php%3Fcode%3Dsrc/2.lighting/3.2.materials_exercise1/materials_exercise1.cpp">Solution</a> for blue-green plastic container. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/336166/">https://habr.com/ru/post/336166/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336156/index.html">Python memory management</a></li>
<li><a href="../336158/index.html">How to remove ads from Android apps</a></li>
<li><a href="../336160/index.html">Some functional programming techniques in Python</a></li>
<li><a href="../336162/index.html">Nginx in the work of DevOps / Administrator. Dark side of power</a></li>
<li><a href="../336164/index.html">Pentestit Corporate Laboratories: Practical Information Security Skills</a></li>
<li><a href="../336168/index.html">Kaggle Mercedes and cross-validation</a></li>
<li><a href="../336170/index.html">Practice with dapp. Part 2. Deploying Docker images in Kubernetes using Helm</a></li>
<li><a href="../336172/index.html">Mobile browsers and their fluffy legs</a></li>
<li><a href="../336174/index.html">4 ways to stand out in the coffee market</a></li>
<li><a href="../336180/index.html">How to enjoy work</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>