<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We program for Windows 7. The progress indicator on the taskbar</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The official release of Windows 7 is not far off, so the study of new features of the operating system for C # programmers becomes relevant. New trend...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We program for Windows 7. The progress indicator on the taskbar</h1><div class="post__text post__text-html js-mediator-article">  The official release of Windows 7 is not far off, so the study of new features of the operating system for C # programmers becomes relevant.  New trends and rules for programmers have already appeared with the release of Windows Vista with the advent of UAC.  But Vista was not widely used by users, so programmers were not very actively studying the new.  With the release of Windows 7, the situation may change for the better.  I decided to create on my website a <a href="http://developer.alexanderklimov.ru/win7.php">separate section</a> dedicated specifically to programming for Window 7. <br><a name="habracut"></a><br>  On Habr√© there was already a cycle of examples devoted to programming for Windows 7. But these examples came out at the time when Win7 was still in beta.  Therefore, I bookmarked articles to return to them later.  I did not want to install the beta version on a working machine.  But recently, I still <a href="http://blog.alexanderklimov.ru/post/Ustanovka-Windows-7.aspx">set myself Windows 7</a> and am very pleased with it. <br><br>  Now that I already had Win7, I could start exploring the materials that I bookmarked.  But it turned out that the examples are a bit out of date.  There are new libraries with other classes and namespaces.  Therefore, we had to learn new products from scratch.  In addition, the published examples were designed for quite experienced programmers, so some minor details were omitted as a matter of course. <br><br>  And we begin with an example of creating a progress indicator (ProgressBar) on the taskbar.  An old topic on this topic can be found <a href="http://habrahabr.ru/blogs/windows7/59856/">here</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But first you need to prepare.  Download <a href="http://code.msdn.microsoft.com/WindowsAPICodePack">Windows API Code Pack for Microsoft .NET Framework</a> .  This is a powerful package designed to help developers create applications for Windows 7 (and partly Windows Vista) using .NET.  A package is a library of source codes used to access some of the new Windows features through managed code. <br><br>  Unpack the archive with the files and run the solution <b>WindowsAPICodePack.sln</b> .  By default, the <b>Shell</b> project will be used as the StartUp project.  We are quite satisfied with this, since it is here that the classes we need to work with the taskbar are located.  Choose in the menu <b>Build |</b>  <b>Build Shell</b> and get in the folder <b>.. \ WindowsAPICodePack \ Shell \ bin \ Debug</b> file <b>Microsoft.WindowsAPICodePack.Shell.dll</b> .  This is our library, which we will use in our projects. <br>  Now we start Visual Studio and create a new project Windows7TaskBarProgressBarDemo.  In Solution Explorer, right-click on the <b>References</b> folder and select <b>Add Reference</b> .  In the dialog box, switch to the <b>Browse</b> tab and find the <b>Microsoft.WindowsAPICodePack.Shell.dll</b> library that we created.  Switch to the code editing mode and set the line <br>  <b>using Microsoft.WindowsAPICodePack.Taskbar;</b> <br><br>  On this first preparations are completed. <br><br>  Add a timer to the form and a button that will start the timer.  It's time to talk about the purpose of our application.  Suppose we put milk on the stove for heating.  But we do not want to stand at the stove, but want to read a new article on Habr√©.  You convince yourself that in a minute nothing terrible will happen and the milk will not run away.  But, reading an interesting article, you do not notice the time.  The result is pitiable.  We will try to establish control over time. <br>  So, set the timer interval to 1000 (1 second) and write the code: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">TaskbarManager instanceTaskBar = TaskbarManager.Instance; <br> <font color="#0000ff">static</font> <font color="#0000ff">int</font> counter = 0; <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> butStartTimer_Click( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e) <br> { <br> instanceTaskBar.SetOverlayIcon( <font color="#0000ff">null</font> , <font color="#A31515">""</font> ); <br> timerCook.Enabled = <font color="#0000ff">true</font> ; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> timerCook_Tick( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e) <br> { <br> counter += 1; <br> instanceTaskBar.SetProgressValue(counter, 60); <br> <br> <font color="#0000ff">if</font> (counter &gt;= 60) <br> { <br> timerCook.Enabled = <font color="#0000ff">false</font> ; <br> <br> counter = 0; <br> instanceTaskBar.SetProgressValue(0, 60); <br> instanceTaskBar.SetOverlayIcon(Windows7TaskBarProgressBarDemo.Properties.Resources.Ready, <font color="#A31515">""</font> ); <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now explanations to the code.  The <b>SetProgressValue</b> method is responsible for coloring the application button on the taskbar as a progress indicator.  Starting the timer, we increase the counter value every second and bring it to the maximum value (in our case up to 60).  When the counter reaches its ceiling, you need to somehow visually show the user that the operation is completed.  For this purpose, I decided to use the <b>SetOverlayIcon</b> method, which I will talk about another time. <br>  So, what it looks like in practice.  You put the milk on the stove, sit down at the computer and press the button that starts the timer.  Now you can switch to the browser and read the article on Habr√©.  You can always control how much time is left to read from the corner of your eye on the indicator. <br><img src="https://habrastorage.org/getpro/habr/post_images/78c/2e8/153/78c2e8153f9e9901b96c81fae360eddd.png"><br>  After the end of a minute, an icon appears on the taskbar to indicate the end of the process. <br><img src="http://s19.radikal.ru/i192/0909/f2/4443f82f35a2.png"><br>  As you can see, everything is very simple. <br>  In our example, the standard progress indicator is green (Normal mode).  There are other options: NoProgress, Indeterminate, Error, Paused.  You can see how they look on the already mentioned page. We <a href="http://habrahabr.ru/blogs/windows7/59856/">program Windows 7: Taskbar.</a>  <a href="http://habrahabr.ru/blogs/windows7/59856/">Part 1 - Progress Bar / Windows 7 / Habrahabr</a> <br><br>  The given example is a little far-fetched.  In real life, such functionality may be needed for a variety of tasks: displaying the copy process, generating data, generating images, etc.  Some third-party applications already use this feature, not counting native applications in Windows 7. <br><br>  If someone has difficulties with an example, then a little later I will post the source code on the website in the <a href="http://developer.alexanderklimov.ru/win7.php">Windows 7</a> section.  Good luck in mastering Window 7! <br><br></div><p>Source: <a href="https://habr.com/ru/post/68867/">https://habr.com/ru/post/68867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68854/index.html">Budget petabytes: How to build a cheap cloud storage. part 2</a></li>
<li><a href="../68856/index.html">Build Ruby, RubyGems and Ruby on Rails in the new Snow Leopard</a></li>
<li><a href="../68857/index.html">Steering Wheel for iPhone and iPod Touch</a></li>
<li><a href="../68860/index.html">Snow Leopard: About Licenses and Pricing</a></li>
<li><a href="../68861/index.html">We wanted the best, but it turned out as always</a></li>
<li><a href="../68870/index.html">Image recognition. Algorithm Eigenface</a></li>
<li><a href="../68871/index.html">Do we really need a photo-realistic picture in games?</a></li>
<li><a href="../68877/index.html">ATL - UserJS script for habrakhabra</a></li>
<li><a href="../68879/index.html">Android Market Update</a></li>
<li><a href="../68880/index.html">Kings and cabbage, but rather music and mobile phones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>