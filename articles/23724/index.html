<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SVG introduction and example pie chart</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SVG ( scalable vector graphics) is a vector graphics format similar to EPS, animation, and user interaction developed in the W3C. Inside the file is n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SVG introduction and example pie chart</h1><div class="post__text post__text-html js-mediator-article"><habracut>  <a href="http://www.w3.org/TR/SVG/index.html">SVG</a> ( <em>scalable vector graphics)</em> is a vector graphics format similar to EPS, animation, and user interaction developed in the W3C.  Inside the file is not binary but plain XML, describing objects, their effects and behavior.  Vector graphics are generally needed when resizing an image without losing quality, for example in printing.  In the web, I see it in rubber sites, where the block sizes are set in%, the font size in em, and the logo in SVG.  We moved to a better monitor - everything changed in proportion.  Practical examples are <strong>icons, graphics, maps, logos, interfaces</strong> .  Below I give an example of such a pie-chart. <br><br><br><h2>  Integration </h2><h5>  HTML - Inline </h5> Since SVG is essentially XML, it can be immediately described in inline-style in the XHTML structure.  However, as I have already seen, XHTML1.1 doctype implies that the MIME of the document is no longer text-plain.  And the IE6 donkey doesn't understand XHTML in principle, on the other hand, Firefox uses two parsers, and if MIME is not application / xhtml + xml, then inline SVG will not be recognized.  This is a double-edged stick - IE and FF. <code><br> /&gt; <br></code>  The second method and the most practical one is to refer to an existing file via an object tag.  For <br>  to reduce traffic, the file can be compressed and get the SVGZ archive. <h5>  CSS and Javascipt </h5>  As you will see below - since SVG is very closely related to HTML / XML, it‚Äôs natural that graphic objects can not only be described using CSS, but also write Javascript functions on all sorts of onclick and so on.  event'y (hence the interactivity). <code>/&gt;</code> <h5>  Conversion and Editors </h5>  You can convert SVG to png / jpeg, but for this you actually need to do the work of the handler.  In PHP, this is the <a href="http://pear.php.net/package/XML_svg2image/">PEAR XML_svg2image</a> library.  There is also a <a href="http://vectormagic.com/">service for converting a</a> raster image into a vector (although there is EPS).  From the editors - there is <a href="http://www.inkscape.org/">Inkscape</a> and Adobe Illustrator, Corel Draw. <br><h2>  Graphics </h2><h4>  Primitives </h4>  Any drawing begins with the definition of space (two-dimensional), the division into coordinates (in floating-point or percentage units) and the introduction of primitive structures: <ul><li>  line - straight line.  <em>x1, y1, x2, y2</em> - coordinates </li><li>  polyline - broken line.  <em>points</em> - enumeration of coordinates of points </li><li>  rect is a rectangle.  <em>x, y, width, height, rx, ry</em> - upper left corner, dimensions, radii of corners </li><li>  polygone is a polygon.  Looks like a polyline.  <em>points</em> - coordinates of points <br></li><li>  circle is a circle.  <em>cx, cy, r</em> - coordinates of the center and radius <em><br></em> </li><li>  ellipse.  <em>cx, cy, rx, ry</em> - coordinates of the center and radii </li><li>  text - text inscription.  Very inconvenient, because without line breaks and with absolute positioning.  <em>x, y, font-family, font-size</em> </li><li>  tspan - can describe words inside a text element.  For example move or color </li><li>  tref - reuse of the text element with the specified id <br> <code>  <br> &lt;tref xlink:href="#myText" x="50" y="50"&gt;</code> </li> </ul>  textPath - text on the path-curve, linked by id <code>/&gt; <br> &lt;textPath xlink:href="#myPath" startOffset="50%"&gt; Vinogradoff</code> <code>/&gt; <br> &lt;textPath xlink:href="#myPath" startOffset="50%"&gt; Vinogradoff</code>  <code>/&gt; <br> &lt;textPath xlink:href="#myPath" startOffset="50%"&gt; Vinogradoff</code> image - raster image <br> <code>&lt;image image-rendering="optimizeSpeed" xlink:href"background.jpg" width="100%" height="100%" preserveAspectRatio="xMidYMid slice" filter="url(#blurpane)"/&gt;</code> <h5>  Parameters and styles </h5>  As in html, some lines are not needed very much - they need to be painted over, colors are indicated, and all this is done by parameters <ul><li>  <em>fill, fill-rule</em> - fill.  For example "none", blue, indigo. </li><li>  <em>stroke, stroke-linecap, stroke-linejoin, stroke-dasharray, stroke-dashoffset, stroke-width</em> - border, analogue of the border.  Together stroke-width. </li><li>  <em>font-family, font-size, font-style, font-weight</em> - fonts for text-elements </li><li>  text-anchor </li></ul>  For filling tags are used: <br><ul><li>  pattern </li><li>  linearGradient </li><li>  radialGradient </li></ul>  These parameters can all be combined into one analog CSS and write in inline-style: <br> <code>style="stroke-width:1; stroke:blue; fill:none"</code> <h5>  Groups and Bezier curves </h5>  Elements can and should be grouped into each other.  In addition to the fact that <em>tspan is</em> set <em>inside the</em> <em>text</em> element, the grouping takes place thanks to the element. Bezier curves are smooth transition lines, defined by points.  In SVG, there is a path element for this, where coordinates are specified like a broken line.  Near the coordinates there may be letters indicating the properties of the line.  Large letters indicate absolute positioning, small letters indicate relative <ul><li>  M - the beginning of the curve (x, y) <br></li><li>  Z - the end of the curve (without coordinates) <br></li><li>  L-line (x, y) </li><li>  H - horizontal line </li><li>  V - vertical line </li><li>  Q - quadratic curve on one point </li><li>  T - continuation of the curve with the reflection of the previous point - simplifies drawing repetitive rhythms </li><li>  C is the third-order Bezier curve itself at two points <br></li><li>  S - simplified version of C </li><li>  A - elliptic curve (radii, rotation) </li></ul><h4>  Transformations and opportunities <br></h4>  Objects in SVG can be distorted, twisted and moved using filters that are specified as parameters: <ul><li>  translate - object transfer </li><li>  rotate rotation </li><li>  scale - scaling </li><li>  scewX, scewY - distortion </li><li>  matrix - mixed transformation <br></li></ul>  SVG supports filters with lighting effects.  And besides static images there is the possibility of animation and interactivity with the user.  For example, <a href="">Tetris</a> or the acclaimed Microsoft Table and Silverlight are implemented <a href="">programmatically in SVG</a> , and with a strong desire, the video ( <a href="http://www.theora.org/news/">Ogg Theora</a> = SVGT format) also worked.  Of course, the latest features are not yet implemented in all browsers, but there are <a href="http://people.opera.com/howcome/2007/video/">Opera discoverers</a> . <br><br><br><h3>  Cake schedule on SVG and PHP / DB </h3>  Undoubtedly, the <a href="http://code.google.com/apis/chart/">Google API</a> is a very handy thing.  But do not forget that after all this is an external service, even if it is reliable.  Commercial development do not like to take risks, so the generation of graphs still has to be local (if they are not static). I will generate the image using php, based on <br>  Database data to display poll results (poll).  Since the GD library, although it understands the size of the SWF, <br>  generates only binary files.  Therefore, XML will have to be generated: <code>header("Content-Type: image/svg+xml");</code>  Let's see what we should strive for (for now without <a href="http://kulish.ru/stat/">cool animation</a> ) ... <img src="http://chart.apis.google.com/chart?cht=p3&amp;amp;chd=t:30,20,15,10,5,1,1,1,1&amp;amp;chs=600x200&amp;amp;chl=1|2|Google%20Api%20example|4|5|6|7|8|9|10|11">  Let's start with the rubber arrangement of the two ellipses?  Sectors apparently go in descending order in a clockwise direction, in order to reduce the number of gradients in small areas.  The color of the sector is apparently calculated in proportion to the number of pieces - this is where the problem arises.  As it turns out, the sector cannot simply be filled in with two lines and an existing ellipse - the figure must be precisely delineated, so you need <a href="http://www.codestore.net/store.nsf/unid/EPSD-5DTT4L">to draw everything separately</a> with the help of <em>path</em> , and we will not need <em>ellipse</em> . <h5>  Color trigonometry </h5>  To calculate the coordinates of a path-element in a cycle, it is necessary to recall a bit of mathematics.  Since the <a href="http://wiki.scribus.net/index.php/Making_a_Pie_Chart">circle is a special case of an ellipse,</a> there is much in common in the formulas, which is very useful to us: <code>x=cos(angle)*radius; y=sin(angle)*radius; //circle <br> x=cos(angle)*rx; y=sin(angle)*ry; //ellipse</code> <code>x=cos(angle)*radius; y=sin(angle)*radius; //circle <br> x=cos(angle)*rx; y=sin(angle)*ry; //ellipse</code> <br>  For an ellipse, the radius is simply replaced by the major and minor semi-axis, respectively.  Next, create a loop, where we calculate the percentage distribution of data, the degree for the sector with <em>path</em> .  We include the coordinates for the arch, for this we use a ‚Äúdegree shift‚Äù to draw all sectors closely. RGB cube, you can cut, make projections and enter your systems in different ways <br>  coordinates like CMYK and HSL.  Different shades of the selected orange fill are obtained by dividing the segment between the selected point-color and the top of white (255,255,255). <code>if ($intTotalValue) //            <br> foreach((array) $Data as $key=&gt;$recEntry){ <br> $Data[$key]-&gt;percent=$recEntry-&gt;value/$intTotalValue; <br> $Data[$key]-&gt;color[0]=round($graph-&gt;fill[0]+($key/count($Data)*(255-$graph-&gt;fill[0]))); <br> $Data[$key]-&gt;color[1]=round($graph-&gt;fill[1]+($key/count($Data)*(255-$graph-&gt;fill[1]))); <br> $Data[$key]-&gt;color[2]=round($graph-&gt;fill[2]+($key/count($Data)*(255-$graph-&gt;fill[2]))); <br> <br> $Data[$key]-&gt;degree=360*$Data[$key]-&gt;percent; <br> $Data[$key]-&gt;start['x']=$graph-&gt;cx+round(cos(deg2rad($intDegreeShift)) * $graph-&gt;rx,3); <br> $Data[$key]-&gt;start['y']=$graph-&gt;cy+round(sin(deg2rad($intDegreeShift)) * $graph-&gt;ry,3); <br> $Data[$key]-&gt;end['x']=$graph-&gt;cx+round(cos(deg2rad($intDegreeShift+$Data[$key]-&gt;degree)) * $graph-&gt;rx,3); <br> $Data[$key]-&gt;end['y']=$graph-&gt;cy+round(sin(deg2rad($intDegreeShift+$Data[$key]-&gt;degree)) * $graph-&gt;ry,3); <br> $intDegreeShift+=$Data[$key]-&gt;degree; //increase degree shift <br> <br> $boolIsLargeArc=$Data[$key]-&gt;degrees&gt;180? 1 : 0; <br> echo "\n".'/&gt;'; <br> } <br></code>  If you look at the chart closely, you can see that the volume is done <br>  using a gradient, which in SVG we first fill in as a background, <br>  and on top we will impose specific colors of the sector with transparency: <code><br> <br> /&gt; <br> /&gt; <br> /&gt; <br> <br></code> <h4>  Main problems </h4>  But the problem remains with painting over the border sectors - it is necessary to paint over the front area over the gradient only in those areas that go up to half of the cake.  To this stage, the picture looks like this: <img alt="graph_limit_problem_416" height="183" src="http://www.kurapov.name/resource/editor/graph_limit_problem_416.png" title="graph_limit_problem_416" width="416"><h5>  Absolute text </h5>  In addition, the question arises how to locate text descriptions of sectors?  Google simply leads lines from the middle of the sectors, even if the text does not fit in one line.  In SVG, text should be positioned from the upper left corner - which is already a problem, since we don‚Äôt know the widths.  Two ways out - to abandon the relative positioning of the text and make the callouts in color, or use text with a fixed width (monospace, Courier) and on this basis <a href="http://www.princexml.com/bb/viewtopic.php%3Fp%3D3067%26amp%3Bsid%3Df3bc79d7f8a4bccd47c5a772208ccfc5">calculate the length in pixels</a> and position on the fly.  Fortunately, I <a href="http://www.zvon.org/HowTo/Output/howto_jj_svg_4.html%3Fat%3Dtext-anchor">stumbled upon</a> the parameter <em>text-anchor: end</em> , which strangely unfolded the text as it should. <h4>  Interactivity and Future </h4>  Thanks to the integration with javascript, you can <a href="http://cristian.nexcess.net/ajax/svg_chart/">update the image</a> in real time using AJAX, respectively.  In my case, this is necessary when the user votes and you need to update the distribution of votes on the chart. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      See also: <ul><li>  <a href="http://www.opera.com/docs/specs/svg/">Opera supported</a> objects and parameters </li><li>  Kariev CH.A.  - <a href="http://www.intuit.ru/department/graphics/svg/">detailed tutorial</a> <br></li><li>  <a href="http://clipart.nicubunu.ro/%3Fgallery%3Drpg_map">Collection of SVG images</a> for RPG games </li><li>  <a href="http://dev.opera.com/articles/view/how-to-do-photoshop-like-effects-in-svg/">Photoshop effects</a> <br></li><li>  Reviews and <a href="http://www.adobe.com/svg/overview/svg.html">plugins for IE</a> from Adobe <br></li></ul><br><br>  <a href="http://kurapov.name/article/svg_pie_chart/">Original article with illustrations</a> and <a href="http://kurapov.name/survey/2496/">example of use</a> </habracut></div><p>Source: <a href="https://habr.com/ru/post/23724/">https://habr.com/ru/post/23724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../237231/index.html">Recommendations for the application for the App Store, strict rules on IDFA and $ 2.5 billion for Minecraft are the main mobile news for the week</a></li>
<li><a href="../237233/index.html">Why people do not grow: the more growth options, the worse</a></li>
<li><a href="../237235/index.html">How we had to learn how to manage poppies in the corporate network</a></li>
<li><a href="../237237/index.html">C ++ meetings in Russia</a></li>
<li><a href="../237239/index.html">Philae / Rosetta landing probe: what will happen when the probe lands on Churyumov-Gerasimenko comet?</a></li>
<li><a href="../237241/index.html">The first tests in the open education project in the "Polytech 2.0" format</a></li>
<li><a href="../237243/index.html">The photo. Create great shots</a></li>
<li><a href="../237245/index.html">Fujitsu Fast Track for Microsoft Private Cloud</a></li>
<li><a href="../237247/index.html">5 lessons that we learned at Tolstoy Startup Camp</a></li>
<li><a href="../237249/index.html">Smart Matter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>