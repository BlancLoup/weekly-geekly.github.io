<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hg Init: Part 2. The Basics of Mercurial</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the second part of the Hg Init Series : A Mercurial Study Guide by Joel Spolsky . You may also want to read the first part, ‚ÄúRe-education for ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hg Init: Part 2. The Basics of Mercurial</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/eebea7f1/5482efc4/01467053/55589e0f.png" align="left">  This is the second part of the <b>Hg Init</b> Series <b>: A Mercurial Study Guide by</b> <a href="http://www.joelonsoftware.com/">Joel Spolsky</a> .  You may also want to read the first part, <a href="http://habrahabr.ru/blogs/development_tools/108443/">‚ÄúRe-education for Subversion Users</a> . <a href="http://habrahabr.ru/blogs/development_tools/108443/">‚Äù</a> <br><br>  Even if you are working alone, you should use Mercurial.  So you can get all the delights of version control.  This part will show how easy it is to add a directory to Mercurial to easily track down previous versions. <br><br><h4>  Part 2. Mercurial Basics </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage/a2dc0ced/1ebe349c/adafba84/cf7127dd.png" align="left">  Mercurial is a <i>version control system</i> .  Developers use it to administer source code.  She has two main purposes: <br><ol><li>  It stores all previous versions of each file. </li><li>  It can merge different versions of your code, that is, employees can independently work on the code and then merge their changes. </li></ol><br><br><a name="habracut"></a><br><br>  Without Mercurial, you could try to keep previous versions by simply creating many copies of the directory with code: <br><br><img src="https://habrastorage.org/storage/c204c8c2/8cbde270/f057de30/d4010d6d.png"><br><br>  It is a chore, requires a lot of disk space and creates confusion.  Better to use a version control system. <br><br>  Most people work with Mercurial through the command line interface.  So you can work on Windows, Unix, and Mac.  The command for Mercurial is <code>hg</code> : <br><br><img src="https://habrastorage.org/storage/d1a7ded2/0e111d9f/ff11aa6a/06d714d8.png"><br><br>  If you run <code>hg</code> without parameters, you will get a list of the most frequently used commands.  You can also try <code>hg help</code> for a complete list of commands. <br><br>  In order to take advantage of version control, you need a <i>repository</i> .  The repository stores all previous versions of all your files.  In fact, to save disk space, all previous versions will not be stored - only a compact list of changes will be stored. <br><br>  In the old days, getting a repository was a big deal.  You needed to have a central server and you had to install software on it.  Mercurial is a <i>distributed</i> system, so you can use it without a fancy central server.  You can use Mercurial using your computer alone.  And getting a repository is super easy: you just go to the directory with your code ... <br><br><img src="https://habrastorage.org/storage/df024955/0a7c68ad/4d8a48b9/032e8174.png"><br><br>  ... and run the <code>hg init</code> command: <br><br><img src="https://habrastorage.org/storage/6d17bad7/1023e58b/cbf778f1/de0f8775.png"><br><br><blockquote> <code>hg init</code> <br>  creates a repository. <br></blockquote><br><br>  Wait a minute, did something happen?  It looks like nothing has changed.  No, if you look better, you will see that a new <code>.hg</code> directory has <code>.hg</code> : <br><br><img src="https://habrastorage.org/storage/8f6b4eec/b4aa6daf/c822a60f/ea555032.png"><br><br>  This is the repository!  This is a directory with everything Mercurial needs to work.  Settings, previous versions of files, tags, an extra pair of socks in case of rain, and so on.  <i>Do not climb there.</i>  You almost always don't have to mess with this directory yourself. <br><br>  Well, well, since we now have a freshly baked repository, then we will want to add all the source files to it.  This is also simple: you just need to do <code>hg add</code> . <br><br><img src="https://habrastorage.org/storage/0deb8fc5/d3543931/6114cd9a/f166b892.png"><br><br><blockquote> <code>hg add</code> <br>  marks files as scheduled to be added to the repository.  Files will not actually be added until you commit the changes. <br></blockquote><br><br>  There is one more step left ... you need to <i>commit your changes</i> .  Which changes?  The fact of adding all these files. <br><br>  Why do you have to commit changes?  When working with Mercurial, recording changes means: ‚ÄúHey, this is how the files look now, so please remember them.‚Äù  It's like making a copy of the entire directory ... every time you have something changed and you like it, you commit changes. <br><br><blockquote> <code>hg commit</code> <br>  saves the current state of all files in the repository. <br></blockquote><br><br><img src="https://habrastorage.org/storage/1b0b9bd3/265a2c06/84473f38/64028691.png"><br><br>  Mercurial will launch an editor so that you can type a comment for the changes.  You just need to write something that reminds you of the changes made. <br><br><img src="https://habrastorage.org/storage/d47213d9/eab868b9/894d01ae/68290364.png"><br><br>  After you save and exit the editor, your changes will be recorded. <br><br>  You can run <code>hg log</code> to view the change history.  This is like a blog for your repository: <br><br><img src="https://habrastorage.org/storage/63c37c68/7c4b9074/79365c85/9158e135.png"><br><br><blockquote> <code>hg log</code> <br>  displays the history of changes recorded in the repository. <br></blockquote><br><br>  Let's change the file and see what happens. <br><br><img src="https://habrastorage.org/storage/a4976b63/e1120125/f2d75af8/175793cf.png"><br><br>  Since we made the change, we can fix it with <code>hg commit</code> : <br><br><img src="https://habrastorage.org/storage/1b0b9bd3/265a2c06/84473f38/64028691.png"><br><br>  Note that Mercurial guessed that only one file, a.txt, was changed: <br><br><img src="https://habrastorage.org/storage/7e7e4f7c/44a2a982/429514a6/ea1f8d40.png"><br><br>  And now, after I committed (fixed the changes), let's look at the story: <br><br><img src="https://habrastorage.org/storage/30655b31/b8a4769b/cabb993c/cd4bad09.png"><br><br>  Like any current blogger, Mercurial puts the newest in the beginning. <br><br>  I'm going to make another change, just to amuse myself. <br><br><img src="https://habrastorage.org/storage/ce916884/653f2957/8d61c6eb/daeab3db.png"><br><br>  Kommichu (commit changes): <br><br><img src="https://habrastorage.org/storage/1b0b9bd3/265a2c06/84473f38/64028691.png"><br><br>  My message to the commit: <br><br><img src="https://habrastorage.org/storage/64909d63/4d121c11/5243ddb9/f16bd56c.png"><br><br>  And what about our history now? <br><br><img src="https://habrastorage.org/storage/f8759acb/815f0236/1614fff7/7b5449b8.png"><br><br>  Well, that was fun.  I made a few changes and each time, making a significant change, I fixed it in the repository. <br><br>  I know you are thinking now: "JOEL, ALL THIS IS LOOKING FOR EMPTY TIME TIME."  Why all this confusion with commits? <br><br>  Patience, my young friend.  You are about to learn how to capitalize on all of this. <br><br>  For a start: let's say you made a big mistake in the editing process. <br><br><img src="https://habrastorage.org/storage/1e32f444/b934daf5/5dab5b35/d90f3dec.png"><br><br>  And then, God, in addition to everything, you deleted a couple of very important files. <br><br><img src="https://habrastorage.org/storage/74f57309/93aecdca/9cb11413/afb87796.png"><br><br>  At a time when there was no Mercurial, all this could be a good reason to go to the system administrator.  There, with tears in his eyes, you would ask him a piercingly sad question: "Why is the backup system" temporarily "not working all the past eight months." <br><br>  The system administrator, whom everyone calls <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B0%25D0%25BA%25D0%25BE">Taco</a> , is too modest and does not have lunch with the rest of the team.  In those rare cases when he does not sit in his wheelchair, you can see a triangular <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B0%25D0%25BB%25D1%258C%25D1%2581%25D0%25B0_(%25D1%2581%25D0%25BE%25D1%2583%25D1%2581)">salsa-</a> colored spot where you fell, flying between your legs, drops from his Mexican snacks.  These drops guarantee that no one will take his chair, although this is <a href="http://hermanmiller.com/Products/Aeron-Chairs">one of the excellent chairs from Herman Miller</a> , bought by the founders of the company for themselves, and not the usual budget office something, because of which everyone has a backache. <br><br>  In any case, there is no backup, yeah. <br><br>  Thanks to Mercurial, if you don‚Äôt like what you‚Äôve done, you can execute the convenient <code>hg revert</code> command, which immediately returns your directory to the view it was in at the time of the last commit. <br><br><img src="https://habrastorage.org/storage/faad2087/64fce902/eb83246d/28a37ffa.png"><br><br><blockquote> <code>hg revert</code> <br>  returns the modified files to the form fixed in the repository. <br></blockquote><br><br>  I used the argument <code>--all</code> , because I wanted to return <i>all</i> files to the previous state. <br><br>  Thus, when you work on source code using Mercurial, you: <br><ol><li>  Make changes </li><li>  Evaluate if they are suitable </li><li>  If suitable, then <code>commit</code> </li><li>  If not suitable, then perform <code>revert</code> </li><li>  GOTO 1 </li></ol><br><br>  (I know. I use the command line, on Windows, and also the GOTO operator ‚Äî I am <i>the strongest programmer</i> I've ever lived.) <br><br>  Over time, you can forget where you left off and what you have changed since the last commit.  Mercurial keeps track of all this for you.  All you need to do is execute <code>hg status</code> and Mercurial will give you a list of changed files. <br><br><blockquote> <code>hg status</code> <br>  displays a list of changed files. <br></blockquote><br><br>  Suppose I created one file, edited another, and deleted a third one. <br><br><img src="https://habrastorage.org/storage/3e908ca1/4cb8b4cf/daa03ab7/07f0f673.png"><br><br>  <code>hg status</code> displays a list of changed files, adding an icon at the beginning of each line.  This icon indicates what happened.  ‚ÄúM‚Äù means ‚ÄúModified‚Äù - the file has been modified.  "!"  means no - the file should be here, but somewhere gone.  "?"  means that the state is undefined - Mercurial knows nothing about this file.  Don't know yet. <br><br>  Let's deal with the changes one by one.  Here is what has changed in the <b>a.txt</b> file?  You can forget what changed.  Damn, I hardly remember what I usually eat for breakfast.  And it is especially anxious that these are always crisp ringlets of <a href="http://en.wikipedia.org/wiki/Cheerios">CHEERIOS</a> .  In any case, a.txt is modified.  What has changed? <br><br>  And there is a command for this: <code>hg diff</code> will tell you exactly what happened to the file from the last commit. <br><br><blockquote> <code>hg diff</code> <br>  shows what has changed in the file. <br></blockquote><br><br><img src="https://habrastorage.org/storage/cadb3342/3816d012/1d850a8a/8548d3b2.png"><br><br>  The format of the result is a little confusing, but the most important thing is that you can see lines starting with a minus (this is what was deleted) and lines that start with a plus (this is what has been added).  So you can see that ‚ÄúNormal people‚Äù was replaced by ‚ÄúCivilians‚Äù. <br><br>  Now about that missing <b>favicon.ico</b> file.  As already mentioned, if you really did not plan to delete it, you can issue the <code>hg revert</code> command to restore it.  But suppose you actually wanted to remove it.  Each time you delete (or add) a file, you must report this event to Mercurial. <br><br><blockquote> <code>hg remove</code> <br>  marks files as scheduled for removal from the repository.  Files on the disk will not be deleted until you commit the changes. <br></blockquote><br><br><img src="https://habrastorage.org/storage/1adbcbec/9083b063/0f042dfc/a90411e4.png"><br><br>  "R" means "Removed", that is, marked for deletion.  Mercurial will delete this file during the next commit.  ( <i>The history</i> for this file is saved in the repository, so, of course, we can always get it back.) And finally, we need to add this new <b>b.txt</b> file: <br><br><img src="https://habrastorage.org/storage/c5e7f2af/f381ca0f/f30fd73b/48e0a4ff.png"><br><br>  ‚ÄúA‚Äù means ‚ÄúAdded,‚Äù that is, marked for addition.  Notice that I spilled to write <code>hg status</code> every time?  For Mercurial, a minimum set of letters that uniquely defines a command is sufficient, and only one command begins on <code>st</code> . <br><br>  Having dealt with the questions and exclamation marks, I can continue and make changes: <br><br><img src="https://habrastorage.org/storage/3304169d/c5c0285c/c62c0461/b51d2474.png"><br><br>  What else you should pay attention to in the <code>hg log</code> output: the <i>changeset</i> line displays the number of each commit.  In fact, even two numbers: a short, convenient, like ‚Äú0‚Äù for the first revision and a long incomprehensible hexadecimal, which you can ignore for now. <br><br>  Remember, Mercurial stores enough information in the repository to recreate any version of any file. <br><br>  First of all, with the help of a simple <code>hg cat</code> you can output the contents of any version of any file to the console.  For example, here‚Äôs how to see what is now in the a.txt file: <br><br><img src="https://habrastorage.org/storage/765630ca/414f3878/ec7f20ab/3bc776b0.png"><br><br><blockquote> <code>hg cat</code> <br>  displays the contents of any file for any revision. <br></blockquote><br><br>  In order to see how the file looked before, I can simply specify the desired changeset number (changeset from the log) using the argument <code>-r</code> ("revision", that is, revision): <br><br><img src="https://habrastorage.org/storage/c268d14f/b5655b3d/3b7bf975/f3251569.png"><br><br>  If a file has complex content or a large length, and it has changed only a little, then I can use the <code>hg diff</code> with the argument <code>r</code> to display the difference between the two revisions.  For example, here‚Äôs how to see the difference between revisions 0 and 1: <br><br><img src="https://habrastorage.org/storage/206febdc/576f891d/25c37414/7901a60f.png"><br><br>  And finally - I hope that you have not yet collapsed due to fatigue - before I finish this part, I want to show you another <i>little thing</i> : with the help of the <code>hg update</code> command you can move back and forth by the time you create any revision.  Well, <i>in fact</i> , you will not be able to move to the future, although it would be super cool, yes.  With only four revisions, you could run <code>hg update -r 103994</code> and get a really cool version of your sources.  With gravitas and other futuristic things.  But of course this is not possible. <br><br>  What is actually possible is to return to any revision.  Watch your hands: <br><br><img src="https://habrastorage.org/storage/0c666f35/3ec21ad5/a99e8dc1/86a101c4.png"><br><br><blockquote> <code>hg update</code> <br>  brings the working directory to a state like a given revision. <br></blockquote><br><br>  In fact, to move back and forth between revisions, <code>hg update</code> makes the memorized changes to the files.  If a file has been added or deleted, this command adds or deletes it on the disk.  Running <code>hg update</code> without additional parameters brings the working directory to the state of the latest revision. <br><br><h5>  check yourself </h5><br><br>  Fine!  This part is complete.  Here is all that you should be able to do at the moment: <br><ol><li>  Create repository </li><li>  Add or remove files from repository </li><li>  After making changes, review what was done and then </li><li>  ... commit changes if you like them </li><li>  ... or roll back changes if you don‚Äôt like </li><li>  View previous versions of files or bring the working directory to the state of a revision. </li></ol><br><br>  Continued here: <br>  <a href="http://habrahabr.ru/blogs/development_tools/108904/">Hg Init: Part 3. We get used to working in a team</a> </div><p>Source: <a href="https://habr.com/ru/post/108658/">https://habr.com/ru/post/108658/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../108642/index.html">Domain support. RF in Biggo and Python</a></li>
<li><a href="../108649/index.html">"Berlin"</a></li>
<li><a href="../108650/index.html">Grails, jQuery, AJAX: do anchor-navigation. Part 2 final</a></li>
<li><a href="../108655/index.html">Set up AirPrint on a regular USB printer for Mac OS X 10.6.5 (Video)</a></li>
<li><a href="../108656/index.html">How to make a startup and get an MBA with a broken leg</a></li>
<li><a href="../108659/index.html">Ext JS 4 preview: faster, easier, more stable</a></li>
<li><a href="../108660/index.html">HackDay: Battle of Companies - December 9-10</a></li>
<li><a href="../108661/index.html">"Vkontakte stole everything from Facebook": a boring myth</a></li>
<li><a href="../108662/index.html">Google Cloud Connect - The Empire Strikes Back</a></li>
<li><a href="../108663/index.html">People Power offers an interesting way to improve the energy efficiency of devices.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>