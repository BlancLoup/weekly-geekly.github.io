<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to wind the counter Google Analytics or Google hates Kazakhstan</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 

 I think many read the story about Katya , I decided to write in the same style, i.e. Information about why Google hates Kazakhstan will b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to wind the counter Google Analytics or Google hates Kazakhstan</h1><div class="post__text post__text-html js-mediator-article">  Good day. <br><br>  I think many read the story about <a href="https://habrahabr.ru/company/dcoin/blog/272695/">Katya</a> , I decided to write in the same style, i.e.  Information about why Google hates Kazakhstan will be in spoilers. <br><br>  So. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Prehistory</b> <br>  Once I studied statistics in the Google Search Console, I noticed that another item had appeared in the ‚ÄúView in Search‚Äù section, this item led to a report on the pages indexed by AMP. <br><br>  Going to this page, I saw the inscription <br><img src="https://habrastorage.org/getpro/habr/post_images/27b/d4c/3bb/27bd4c3bbe1be8a90f8ce14ad5e3d850.jpg" alt="image"><br>  Of course, I immediately wanted to know what these accelerated mobile pages are.  Following the link, I saw the AMP page creation guide.  After reading the guideline, I started creating amp pages on my site. <br><a name="habracut"></a><br><br>  <b>Story</b> <br>  After reading the documentation for the creation of AMP, I immediately began to implement. <br><div class="spoiler">  <b class="spoiler_title">Google hates Kazakhstan</b> <div class="spoiler_text">  After I prepared all my pages, I waited for the official launch of AMP, it was supposed to be February 24, and it started on February 24, but Kazakhstan was not included in the list of those countries that will display the AMP versions of the pages in the search.  And nowhere was this written.  And nowhere is it written when AMP is available in Kazakhstan. <br>  <i>Probably because ...</i> <br>  <b><i>Google hates Kazakhstan</i></b> <b><br></b> </div></div><br>  An hour later, I was already ready AMP versions of my pages.  But there was a problem, I could not insert Google Analytics, because  JS scripts cannot be inserted into AMP pages, and the <a href="https://www.ampproject.org/docs/reference/extended/amp-analytics.html">amp-analytics</a> component did not exist yet, but there was an <a href="https://www.ampproject.org/docs/reference/amp-pixel.html">amp-pixel</a> component. <br>  Googling a bit, I came across <a href="http://stackoverflow.com/questions/33342754/google-analytics-support-for-the-amp-pixel-tag">this question</a> on Stackoverflow. <br>  They suggested inserting a pixel with the following url that passed the necessary values ‚Äã‚Äãto Google Analytics <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-pixel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://ssl.google-analytics.com/collect?v=1&amp;tid=UA-12345678-1&amp;t=pageview&amp;cid=$RANDOM&amp;dt=$TITLE&amp;dl=$CANONICAL_URL&amp;z=$RANDOM"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amp-pixel</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  This picture conveyed a unique user ID, the title of the article and the link specified in About the transmitted parameters can be read <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters%3Fhl%3Dru">here</a> , to be honest, I have not read it yet <br><br><div class="spoiler">  <b class="spoiler_title">Google hates Kazakhstan</b> <div class="spoiler_text">  Since  I work in the editorial online media, for us all methods of attracting traffic are important.  One of the main channels for other media is Google News.  But in Google News there is no way to select news from Kazakhstan.  Hell, there is even news from Ethiopia and Kenya !!!  And there is no Kazakhstan !!!  I'm bombed. <br>  <i>This is all because ...</i> <br>  <b><i>Google hates Kazakhstan</i></b> <b><br></b> </div></div><br><br>  Having added this pixel to my website, I noticed that every time the page was updated, he considered me as a new user, after looking again at the link, I realized that $ RANDOM in the amp-pixel each time created a new ID for me and GA considered me unique. <br>  The first thing that occurred to me was writing a loop that would output a bunch of amp-pixel. <br>  To begin with, I decided to create a 100 amp-pixel in order not to load the browser. <br><br>  Here is the cycle itself <br>  <i>ps i use laravel, so the blade markup</i> <br><pre> <code class="php hljs">@<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i=<span class="hljs-number"><span class="hljs-number">0</span></span>;$i&lt;<span class="hljs-number"><span class="hljs-number">100</span></span>;$i++) &lt;amp-pixel src=<span class="hljs-string"><span class="hljs-string">"https://www.google-analytics.com/collect?v=1&amp;t=pageview&amp;z={{rand(100000,500000)}}&amp;dt=$TITLE&amp;dl=$CANONICAL_URL&amp;tid=UA-59188XXX-1&amp;cid=$RANDOM"</span></span> &gt; &lt;/amp-pixel&gt; @<span class="hljs-keyword"><span class="hljs-keyword">endfor</span></span></code> </pre><br><br>  I opened the page, waited for the upload and decided to look at Google Analytics. <br>  And that's what I saw there ... <br><img src="https://habrastorage.org/getpro/habr/post_images/0c1/411/51b/0c141151b386bdde6313261150ae50df.jpg" alt="image">  , <br><br>  Google Analytics showed that I have 100 active users on the site and they all read that article. <br>  I decided to try to increase the cycle to 1000 and I have 1000 active users. <br><img src="https://habrastorage.org/getpro/habr/post_images/aa1/32d/692/aa132d692d6663e4b9c9cde8be194019.jpg" alt="image"><br><div class="spoiler">  <b class="spoiler_title">Google hates Kazakhstan</b> <div class="spoiler_text">  From the last spoiler, you know that there is no release of ‚ÄúKazakhstan‚Äù in Google News, but you can add your site to the news, and they will be displayed in the <a href="https://news.google.com/news/section%3Fcf%3Dall%26pz%3D1%26q%3D%25D0%259A%25D0%25B0%25D0%25B7%25D0%25B0%25D1%2585%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%26siidp%3D12a7e7db35f61f1594dcef1af3d09ffd0056">Kazakhstan</a> section in the Russian edition. <br>  In Google News for publishers, you can add a special ‚ÄúEditor's Choice‚Äù RSS and it should be displayed on the right side of the main news.google.com, I safely added this rss feed and waited.  After waiting a week, I decided to write to Google support and there I found out that ‚ÄúEditor‚Äôs Choice‚Äù will not be displayed, since  The media is Kazakh, and the issue is Russian (what kind of x **, does the Kazakhstani media in general go to the Russian issue ???) <br>  <i>Definitely</i> <br>  <b><i>Google hates Kazakhstan</i></b> <b><br></b> </div></div><br>  But the bounce rate was 100%, depth 1 and the rendering of the amp-pixel heavily loaded processes. <br><br>  Therefore, I first decided to create a regular version of the page (Regular HTML, instead of AMP) and insert there a hundred images with this link. <br>  <i>As it turned out, it worked in plain HTML.</i> <i><br></i>  Now it was necessary to solve the problem of depth and failures, so for the place of randomly generating a user ID, I decided to create an array. <br><pre> <code class="php hljs">$users = range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2000</span></span>);</code> </pre><br><br>  Next, create 2 pages with different links and titles, where there is a link to another page.  We go to the first page and wait until the pictures are loaded, and go to the 2nd page, and so a dozen times. <br><div class="spoiler">  <b class="spoiler_title">Indicative gif</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/381/e41/17b/381e4117b645b934b858578b9509e37d.gif" alt="image"><br></div></div><br><br>  As a result, we have a decent depth, a large number of views, a low failure rate, etc. <br><img src="https://habrastorage.org/getpro/habr/post_images/de1/add/181/de1add181f57bc5676031e306e49dea4.jpg" alt="image"><br><br>  <b>I think that you can wind up other indicators, so experimenting :)</b> <br><br>  PS <br>  I almost forgot, you can screw statistics to anyone, the main thing is to know the tracking ID. </div><p>Source: <a href="https://habr.com/ru/post/280498/">https://habr.com/ru/post/280498/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280488/index.html">Basics of Elasticsearch</a></li>
<li><a href="../280490/index.html">Google Analytics in Telegram</a></li>
<li><a href="../280492/index.html">Xubuntu: I propose to vote for the inclusion of a dark visual theme in the distribution</a></li>
<li><a href="../280494/index.html">Cloud Digest # 3: Data Storage, Security and WordPress</a></li>
<li><a href="../280496/index.html">As I wrote skad. Part Seven</a></li>
<li><a href="../280500/index.html">Predicting attendance of ads by content</a></li>
<li><a href="../280502/index.html">Using Open vSwitch with DPDK to transfer data between virtual machines with virtualization of network functions</a></li>
<li><a href="../280504/index.html">Hosting for a dollar</a></li>
<li><a href="../280506/index.html">Don't miss the online Build conference opening tonight (18:30 MCK)</a></li>
<li><a href="../280508/index.html">DevOps section at the DUMP-2016 conference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>