<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Petya cryptographer actually destroys user data, sending meaningless money</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On ransomware, which received the name Petya / PetrWrap, many are now writing. And this is not surprising, because it is he who is the central element...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Petya cryptographer actually destroys user data, sending meaningless money</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/e12/10a/b89/e1210ab8950fcd75a15dcdaa250c90a0.png"><br><br>  On ransomware, which received the name Petya / PetrWrap, <a href="https://geektimes.ru/search/%3Fq%3Dpetya">many are</a> now writing.  And this is not surprising, because it is he who is the central element of the most powerful cyber attack, which affected computers and computer networks of commercial companies, government organizations and individuals in Ukraine, Russia, Belarus and many European countries.  Externally, Petya looks like an ordinary cryptographer, whose authors promise to decrypt user data if he sends a ransom. <br><br>  But the reality is somewhat different.  The fact is that under the guise of a cryptographer, a virus-viper (that is, a ‚Äúeraser) is hiding, the creators of which pursue only one goal - the destruction of the victim‚Äôs computer data.  Yes, all this is masked by the demand to send money, but it‚Äôs still not worth paying.  And not only because the <a href="https://geektimes.ru/post/290557/">operator blocked the</a> e-mail to which it is necessary to send information about the payment.  But also because it is all the same meaningless, the data decryption function is simply not provided here. <br><a name="habracut"></a><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); width: 500px; margin: 10px auto; max-width: 100%; min-width: 220px;"></twitter-widget><blockquote class="twitter-tweet" align="center" data-twitter-extracted-i1551867742391101926="true"><p lang="en" dir="ltr">  But there is no need to get their files back.  <a href="https://t.co/68vxThNIPM">pic.twitter.com/68vxThNIPM</a> </p>  - Mikko Hypponen (@mikko) <a href="https://twitter.com/mikko/status/880036070267772929">June 28, 2017</a> </blockquote><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  The cryptographer "really asks the victim for about $ 300 for returning information from the hard drives of the infected computer. The attackers also frighten their victims with the following text:" Do not waste your time. No one can recover your files without our decryption service. " 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The text works, some users of infected machines still pay, and a lot.  At least 50 Petya victims (aka ExPetr, aka NotPetya), who paid a total of $ 10,200 in dollar equivalent, are now known.  But the affected users do not know that the attackers have no decryption service.  Money rushes to the wind. <br><br>  According <a href="https://securelist.com/expetrpetyanotpetya-is-a-wiper-not-ransomware/78902/">to</a> cybersecurity experts, for their money, these users will receive absolutely nothing, because there is an error in the malicious code that makes it impossible to decrypt files.  The company's specialists analyzed the malware code, the area that is associated with file encryption, and realized that after the disk is fully encrypted, the victim loses the ability to get his information back. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7ff/d62/4f3/7ffd624f3f942fa93af26ff7ec4ab95c.png"><br><br>  The fact is that when processing the file, exPetya does not create a unique installation ID for the program.  Accordingly, the user receives a completely random set of characters when deducing the victim‚Äôs payment request.  Perhaps the new version of ransomware has nothing to do with the original malware Petya, since the original virus created this ID during installation.  Here is the piece of code that is responsible for creating the ID. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/d9e/f9e/fbe/d9ef9efbe3125fdfa64e4f075f8c3e59.png"><br><br>  The screenshot shows that the ID is generated in a random order, which closes the opportunity for the victim to obtain a key to decrypt their files, even if it exists. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/804/589/b8f/804589b8fd28ef625311f958ff5ca913.png"><br><br>  An attacker simply has no way to extract information for decoding random characters from a string.  The 2016 version of Petya encrypted the disk so that it could be decrypted with a key.  All operations with files and disk sectors were performed correctly.  But Petya from 2017 permanently damages the wheels. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/ae8/b5b/568/ae8b5b568e819da78314e1571f51f9c2.png"><br>  <font color="gray">On the left is a section of the exPetr code, which seems to have turned into a viper.</font> <br><br>  Moreover, in the exPetr code there is a section that is responsible for the operation of the viper.  When this code is activated, the virus completely erases user data.  Thus, the malware overwrites the file location table (Master FAT Table) and the master boot record of the computer on which the virus is installed.  This is a distinctive feature of the new virus, which is uncharacteristic for ransomware. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f71/073/cb0/f71073cb06e6c74276af490524b4ddeb.png"><br><br>  Many cyber security experts agree with the above opinion.  For example, Matt Suish from Comae Technologies <a href="https://blog.comae.io/petya-2017-is-a-wiper-not-a-ransomware-9ea1d8961d3b%3Fgi%3Defd7ed22a043">talks</a> about how Petya simply destroys data like other wipers do, including Shamoon.  And the goal of the developers of malicious software is completely different than that pursued by the creators of these cryptographers.  Everything is simple there - attackers want money.  In the case of wipers, the situation is more complicated - what do their creators want, only they know. <br><br>  Of the other features of the virus, <a href="https://geektimes.ru/post/290615/">you can call the</a> command to restart the infected PC an hour after the infection.  The undocumented WinAPI <a href="http://undocumented.ntinternals.net/UserMode/Undocumented%2520Functions/Error/NtRaiseHardError.html">NtRaiseHardError</a> function is used for this. </div><p>Source: <a href="https://habr.com/ru/post/370597/">https://habr.com/ru/post/370597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../370587/index.html">Sleep in hand: gadgets that will help tame sleep</a></li>
<li><a href="../370589/index.html">Why aerobic training affects the brain so much: the reason for evolution</a></li>
<li><a href="../370591/index.html">Production of supercapacitors based on electrolytes of NITU ‚ÄúMISiS‚Äù started in Russia</a></li>
<li><a href="../370593/index.html">How does artificial intelligence help save the world?</a></li>
<li><a href="../370595/index.html">Ilon Musk officially began to drill near Los Angeles</a></li>
<li><a href="../370599/index.html">Musical DIY shaitan machine or what did a Swedish musician with two thousand balls</a></li>
<li><a href="../370601/index.html">Review of the exhibition Kintex (South Korea, Seoul). Virtual reality, drones, 3D printing</a></li>
<li><a href="../370603/index.html">David vs. Goliath: used cartridges no longer belong to manufacturers</a></li>
<li><a href="../370605/index.html">Pollution of solar panels reduces their output by 35%</a></li>
<li><a href="../370607/index.html">What kind of merit Kingston love data centers? Says 3data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>