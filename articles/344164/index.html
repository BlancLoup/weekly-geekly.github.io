<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Layers, Bulbs, Hexogons, Ports and Adapters - it's all about one thing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mark Seemann's translation of popular software development architectures and what they have in common. 

 One of my readers asked me:  Vernon, in his ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Layers, Bulbs, Hexogons, Ports and Adapters - it's all about one thing</h1><div class="post__text post__text-html js-mediator-article">  <i>Mark Seemann's translation of popular software development architectures and what they have in common.</i> <br><br>  One of my readers asked me: <blockquote>  Vernon, in his book <a href="https://www.amazon.com/gp/product/0321834577/ref%3Das_li_ss_tl%3Fie%3DUTF8%26camp%3D1789%26creative%3D390957%26creativeASIN%3D0321834577%26linkCode%3Das2%26tag%3Dploeh-20">‚ÄúImplementing DDD,‚Äù</a> talks a lot about the Ports and Adapters architecture as a more advanced level of <b>Layered Architecture</b> .  I would like to hear your opinion on this matter. </blockquote>  If you do not go into details, then in my <a href="https://www.amazon.com/gp/product/1935182501/ref%3Das_li_ss_tl%3Fie%3DUTF8%26camp%3D1789%26creative%3D390957%26creativeASIN%3D1935182501%26linkCode%3Das2%26tag%3Dploeh-20">book</a> I describe this particular architectural pattern, although I never call it by that name. <br><br>  <i>TL; DR. If we apply the principle of dependency inversion to a layered architecture, then ultimately we get <b>Ports and Adapters</b> .</i> <br><a name="habracut"></a><br><h2>  Layered Architecture </h2><br>  In the book, I describe typical pitfalls that arise when working with <b>Laminated Architecture</b> .  For example, a popular error when building it: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/963/d3b/34c/963d3b34cd8354c790dc7dee1a005797.png" alt="image"></div><br>  The arrows show the direction of the dependencies, that is, the User Interface depends on Domain, which in turn depends on Data Access.  This is a gross violation of the <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B8%25D0%25BD%25D1%2586%25D0%25B8%25D0%25BF_%25D0%25B8%25D0%25BD%25D0%25B2%25D0%25B5%25D1%2580%25D1%2581%25D0%25B8%25D0%25B8_%25D0%25B7%25D0%25B0%25D0%25B2%25D0%25B8%25D1%2581%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2581%25D1%2582%25D0%25B5%25D0%25B9">Principle of Inversion of Dependencies</a> , because Domain depends on Data Access, but <br><blockquote>  ‚ÄúAbstractions should not depend on details.  Details must depend on abstractions. ‚Äù <br>  - Agile Principles, Patterns, and Practices in C # </blockquote>  Dependencies in this scheme need to be inverted as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b2b/2e2/829/b2b2e2829f8d25f8ac8c8f4502f092ad.png" alt="image"></div><br>  The scheme looks almost the same as the previous one, however, it is important to note that the directions of dependencies have changed, and now Data Access depends on Domain, and not vice versa.  So, the scheme corresponds to the <b>Principle of Inversion of Dependencies</b> - details (UI, Data Access) depend on abstractions (Domain Model). <br><br><h2>  Onion Architecture </h2><br>  The previous example is quite simple, as it includes only three components.  Let's imagine a more realistic project in which the <b>Principle of Inversion of Dependencies</b> would be observed: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/394/ee3/6a9/394ee36a97fd3db3954ac6debf419280.png" alt="image"></div><br>  Despite the large number of components, all dependencies are directed inside.  If you think "layers", you can select and portray them as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/106/969/a45/106969a450369ea13161b15b438ec6f8.png" alt="image"></div><br>  These layers really resemble onion layers, no wonder Jeffrey Palermo <a href="http://jeffreypalermo.com/blog/the-onion-architecture-part-1/">called</a> the architecture <b>Onion Architecture</b> . <br><br>  <b>The principle of Inversion of Dependencies</b> is still observed, since dependencies go only in one direction.  However, it can be noted that the UI (red) and Data Access (blue) components are located in the same layer (I added several yellow components, which, for example, can symbolize unit tests).  It seems that somewhere there is a mistake, but in fact everything is correct, because all these components of the outer layer are on the borders of the application.  Some borders (UI, APIs) look outward, others (databases, file systems) inwards (operating system, database server). <br><br>  As you can see from the diagram, components may depend on other components of their layer, but does this mean that UI components can directly access components of Data Access? <br><br><h2>  Hexagonal Architecture </h2><br>  Despite the fact that the traditional <b>Layered Architecture has</b> experienced the peak of its popularity, this does not mean that all its principles have lost relevance.  The idea of ‚Äã‚Äãallowing UI components to access the Data Acess directly is invalid.  Direct interaction between them can cause changes in data to bypass important business logic and break consistency. <br>  You may have noticed that I have grouped the orange, yellow, and blue components into separate groups.  This is done so that the UI components do not depend on and do not communicate directly with the Data Access components and vice versa.  Let's divide these groups graphically: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e41/7a6/cdb/e417a6cdb598c25f81851adf736f4006.png" alt="image"></div><br>  The result was exactly six sections (three empty).  Let it be a good liner to the concept of Alistair Cockburn <a href="http://alistair.cockburn.us/Hexagonal%2Barchitecture">Hexagonal Architecture</a> ( <i>hex = hex</i> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f9/433/6a4/0f94336a4617f2e23b45b443a0897ecb.png" alt="image"></div><br>  You might think that I cheated by creating exactly 6 sections, making the diagram hexagonal, but there is nothing to worry about, because the hex has nothing to do with <b>Hexagonal Architecture</b> ( <i>however, the <a href="http://alistair.cockburn.us/Hexagonal%2Barchitecture">source</a> explains the connection between these concepts of the translator</i> ).  The name of the pattern does not reflect its essence.  Therefore, I like to call it <b>Ports and Adapters</b> . <br><br><h2>  Ports and Adapters </h2><br>  In the diagram above, we see a too deep hierarchy of dependencies.  When the diagram consisted of well-defined circles, we had 3 "onion" layers. The hexagonal dependency diagram still has these intermediate (gray) components, but, as I <a href="https://stackoverflow.com/questions/9501604/ioc-di-why-do-i-have-to-reference-all-layers-assemblies-in-entry-application/9503612">tried to explain</a> earlier, the flat dependency hierarchy is better nested.  Let's try to make it as flat as possible inside the hexagon: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf8/9e4/97b/bf89e497b01e244e2283b6aa6582fa66.png" alt="image"></div><br>  Components inside a hex have only a few (or no at all) dependencies on each other, whereas components behind a hex work as <b>adapters</b> between internal components and the boundaries of the application - its <b>ports</b> . <br><br><h2>  Summing up </h2><br>  In my book, I did not invent a name for the architecture I was describing, but in fact it turned out <b>Ports and Adapters</b> .  In addition to the options described above, there are other architectures that follow the <b>Principle of Inversion of Dependencies</b> , but the basis of the book ‚ÄúDependency Injection in .NET‚Äù is certainly <b>Ports and Adapters</b> . <br><br>  I did not use the names <b>Onion Architecture</b> , <b>Ports and Adapters</b> in my book because I did not know about them at that time.  But without even realizing it, I described precisely these patterns.  Only later, having familiarized myself with them, did I recognize my architecture in them.  And this confirms that <b>Ports and Adapters</b> are an example of a real, canonical pattern, because one of the signs of a pattern is that it can manifest itself in various, independent environments and situations, after which it ‚Äúopens‚Äù as a pattern. </div><p>Source: <a href="https://habr.com/ru/post/344164/">https://habr.com/ru/post/344164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344144/index.html">Binary search in graphs</a></li>
<li><a href="../344146/index.html">Kotlin Night Moscow - video, photo, presentation</a></li>
<li><a href="../344150/index.html">Survey for users of the browser Vivaldi</a></li>
<li><a href="../344156/index.html">Visual Studio extension to render instances of custom classes in debug mode. Part 2</a></li>
<li><a href="../344160/index.html">List of useful ideas for high-load services</a></li>
<li><a href="../344166/index.html">TeamCity 2017.2: 100 free build configurations, Docker, .NET CLI, composite builds and improvements in Kotlin DSL</a></li>
<li><a href="../344170/index.html">How we taught smart socket to measure power</a></li>
<li><a href="../344172/index.html">Malfunctions of the site. How to effectively organize the support of web resources by third-party services</a></li>
<li><a href="../344174/index.html">How I came up with and used the format of storing the results of experiments Measurelook</a></li>
<li><a href="../344178/index.html">Postmortem Shadow Tactics: Blades of the Shogun</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>