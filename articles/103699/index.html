<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Getting Started with MongoDB and PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Generation Next 
 Over the past year, there has been a small revolution in the DBMS world, associated with the emergence of schema-free (structureless...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Getting Started with MongoDB and PHP</h1><div class="post__text post__text-html js-mediator-article">  <strong>Generation Next</strong> <br>  Over the past year, there has been a small revolution in the DBMS world, associated with the emergence of schema-free (structureless) DBMS such as <a href="http://couchdb.apache.org/">Apache CouchDB</a> .  In these databases, a different approach is used than in relational databases.  They quickly become popular among Web developers because of their flexibility, simplicity and easy integration with modern technologies such as JSON. <br>  This article provides a brief overview of MongoDB, one of the new generations of noncircuit DBMS, which has received much attention from developers. <br><a name="habracut"></a><br>  <strong>Start me up</strong> <br>  On the <a href="http://www.mongodb.org/">official website of</a> MongoDB it is written that it is an expandable, high-performance, document-oriented database with open source.  It exists under a large number of platforms and is distributed under the GNU AGPL license. <br>  Although MongoDB is similar to CouchDB, there are serious differences between them: <br><ul><li>  MongoDB developers should use native language drivers to access the database, while REST is used for CouchDB </li><li>  MongoDB supports more data types. </li><li>  MongoDB's scalability is built on the basis of sharding technology ( <em>there is no Russian equivalent, left in English</em> ), while for CouchDB it is replication. </li><li>  MongoDB requests use <a href="http://en.wikipedia.org/wiki/BSON">BSON</a> objects, while CouchDB requests are generated using JavaScript. </li></ul><br>  The MongoDB documentation describes in detail all these (and a bit more) differences, there are also tests comparing <a href="http://www.mongodb.org/display/DOCS/MongoDB%252C%2BCouchDB%252C%2BMySQL%2BCompare%2BGrid">MongoDB, CouchDB and MySQL</a> ( <em>another reason for holy war</em> ). <br>  A quick overview is over, time to download and install MongoDB.  In most cases, a standard binary package is enough;  it contains MongoDB and a command line client, a set of utilities for backing up, restoring, and saving and retrieving binary files.  To get started, download the appropriate version for your system: <br>  shell&gt; cd / usr / local <br>  shell&gt; tar -xzvf mongodb-linux-i686-1.4.2.tgz <br>  shell&gt; ln -s mongodb-linux-i686-1.4.2 mongo <br>  If you have Ubuntu, you can install MongoDB using aptitude.  To do this, add the following line to /etc/apt/sources.list: <br>  deb <a href="http://downloads.mongodb.org/distros/ubuntu">downloads.mongodb.org/distros/ubuntu</a> 10.4 10gen <br>  Then install this package using aptitude: <br>  shell&gt; aptitude update <br>  shell&gt; aptitude install mongodb-stable <br>  When the package is installed, start the MongoDB server <br>  shell&gt; mkdir / usr / local / mongo / data <br>  shell&gt; / usr / local / mongo / bin / mongod --dbpath = / usr / local / mongo / data <br><img src="http://devzone.zend.com/content/articles/12132/image1.jpg"><br><br>  Note that by default, the MongoDB server considers that data is stored in / data / db, and ends execution if it does not find this path.  The --dbpath option allows you to specify another path. <br>  You can use the command line to access the server, as shown below: <br>  shell&gt; / usr / local / mongo / mongo <br>  Here's what it looks like: <br><img src="http://devzone.zend.com/content/articles/12132/image2.jpg"><br><br>  You can give commands to the server, as well as in the MySQL client.  Below is an example that shows the server version and available databases: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&gt;show dbs <br> <font color="#0000ff">admin</font> <br> <font color="#0000ff">local</font> <br> &gt;db.version() <br> 1.4.2 <br> &gt;db.stats() <br> { <br> "collections" : 0, <br> "objects" : 0, <br> "dataSize" : 0, <br> "storageSize" : 0, <br> "numExtents" : 0, <br> "indexes" : 0, <br> "indexSize" : 0, <br> "ok" : 1 <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>Collecting Ideas</strong> <br>  In the MongoDB universe, the equivalent of a table is the ‚Äúcollection‚Äù.  Just as tables have many records, in collections there are many ‚Äúdocuments‚Äù.  These documents are represented as JSON objects, with fields and values ‚Äã‚Äãrepresenting key-value pairs, and stored (serialized) in BSON (Binary JSON) for storage.  Below is an example of one such document: <br>  { <br>  "OrderDate": "10-05-2010", <br>  "OrderTotal": 468.99, <br>  } <br>  Since the main MongoDB element is a JSON document, and JSON supports hierarchical data, you can include one document in another.  Further, since documents are serialized to BSON for storage, MongoDB can easily search for attached documents.  Below is an example: <br>  { <br>  "OrderDate": "10-05-2010", <br>  "OrderTotal": 468.99, <br>  "ShipTo": <br>  { <br>  "Street": "17 Hill View", <br>  "Zip": "12345", <br>  "Country": "US" <br>  } <br>  } <br>  To create a new MongoDB collection, run the client on the command line and execute the following commands that will create a collection called items "and add several documents: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  &gt; db.items.  <font color="#0000ff">insert</font> ({name: <font color="#A31515">'eggs'</font> , quantity: 10, price: 1.50}) </li><li>  &gt; db.items.  <font color="#0000ff">insert</font> ({name: <font color="#A31515">'bacon'</font> , quantity: 3, price: 3.50}) </li><li>  &gt; db.items.  <font color="#0000ff">insert</font> ({name: <font color="#A31515">'tomatoes'</font> , quantity: 30, price: 0.50}) </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  We continue further, add more documents as shown above.  To display the full list of documents in the collection, call the find () method with no arguments: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  &gt; db.items.find ({}) </li><li>  {"_id": ObjectId ("4bea15293302000000006dcf"), "name": "eggs", "quantity": 10, "price": 1.5} </li><li>  {"_id": ObjectId ("4bea15463302000000006dd0"), "name": "bacon", "quantity": 3, "price": 3.5} </li><li>  {"_id": ObjectId ("4bea15523302000000006dd1"), "name": "tomatoes", "quantity": 30, "price": 0.5 </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Notice that each document has a special '_id' key.  When you write a new document to the collection, MongoDB automatically adds a unique identifier to each document.  This identifier can be used to retrieve or modify a document, it is a kind of auto-increment key in relational databases. <br>  To display a list of documents by any criteria, add this criterion (as a JSON object) to the find () method.  Below is an example showing entries with a quantity greater than 9 and a price less than 1: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  &gt; db.items.find ({quantity: {$ gt: 9}, price: {$ lt: 1}}) </li><li>  {"_id": ObjectId ("4bea15523302000000006dd1"), "name": "tomatoes", "quantity": 30, "price": 0.5 </li><li>  } </li><li></li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Now let's try to write something in php! <br><br>  <strong>Hooking things up</strong> <br>  MongoDB support in PHP is implemented through an extension that provides an API for accessing MongoDB collections.  This extension is developed by Kristina Chodorow and is available for free in <a href="http://pecl.php.net/mongo">PECL</a> under the Apache License.  The extension is stable and allows you to perform most tasks related to accessing and using the MongoDB database from applications written in PHP. <br>  To use this extension, install it using the standard pecl command. <br>  shell&gt; pecl install mongo <br>  Or you can download the source code, compile it into a downloadable PHP module: <br>  shell&gt; tar -xzvf mongo-1.0.7.tar.gz <br>  shell&gt; cd mongo-1.0.7 <br>  shell&gt; phpize <br>  shell&gt; ./configure <br>  shell&gt; make <br>  shell&gt; make install <br>  You now have a PHP downloadable module called mongo.so, which is in the standard PHP module directory.  Enable this extension in php.ini, reload the Web server and check the activity of this extension with the phpinfo () command: <br><img src="http://devzone.zend.com/content/articles/12132/image3.jpg"><br><br>  Now let's see what we can do using this extension. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  &lt;? php </li><li>  <font color="#0000ff">try</font> { </li><li>  <font color="#008000">// open connection to MongoDB server</font> </li><li>  $ conn = <font color="#0000ff">new</font> Mongo ( <font color="#A31515">'localhost'</font> ); </li><li></li><li>  <font color="#008000">// access database</font> </li><li>  $ db = $ conn-&gt; test; </li><li></li><li>  <font color="#008000">// access collection</font> </li><li>  $ collection = $ db-&gt; items; </li><li></li><li>  <font color="#008000">// execute query</font> </li><li>  <font color="#008000">// retrieve all documents</font> </li><li>  $ cursor = $ collection-&gt; find (); </li><li></li><li>  <font color="#008000">// iterate through the result set</font> </li><li>  <font color="#008000">// print each document</font> </li><li>  echo $ cursor-&gt; count ().  <font color="#A31515">'document (s) found.</font>  <font color="#A31515">&lt;br/&gt; '</font> ; </li><li>  <font color="#0000ff">foreach</font> ($ cursor <font color="#0000ff">as</font> $ obj) { </li><li>  echo <font color="#A31515">'Name:'</font> .  $ obj [ <font color="#A31515">'name'</font> ].  <font color="#A31515">'&lt;br/&gt;'</font> ; </li><li>  echo <font color="#A31515">'Quantity:'</font> .  $ obj [ <font color="#A31515">'quantity'</font> ].  <font color="#A31515">'&lt;br/&gt;'</font> ; </li><li>  echo <font color="#A31515">'Price:'</font> .  $ obj [ <font color="#A31515">'price'</font> ].  <font color="#A31515">'&lt;br/&gt;'</font> ; </li><li>  echo <font color="#A31515">'&lt;br/&gt;'</font> ; </li><li>  } </li><li></li><li>  <font color="#008000">// disconnect from server</font> </li><li>  $ conn-&gt; close (); </li><li>  } <font color="#0000ff">catch</font> (MongoConnectionException $ e) { </li><li>  die ( <font color="#A31515">'Error connecting to MongoDB server'</font> ); </li><li>  } <font color="#0000ff">catch</font> (MongoException $ e) { </li><li>  die ( <font color="#A31515">'Error:'</font> . $ e-&gt; getMessage ()); </li><li>  } </li><li>  ?&gt; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  At the beginning of this script, a new Mongo object is initialized, to the constructor of which the information necessary to establish a connection with the MongoDB server (in the example host name) is transferred.  This object is used for all subsequent interactions with the MongoDB server. <br>  The next step is to gain access to the database.  This can be done using the selectDB () method or, more simply, using the magic call method, access the database as an object property.  Once the database is accessed, it will not be difficult to access the collection using the selectCollection () method or by using the magic call method, accessing the collection as a property.  Collections are represented as MongoCollection objects. <br>  Each MongoCollection object has a find () method that can be used to execute queries.  The method takes as arguments two arrays: an array of query parameters and an array of fields that should be obtained as a result of the response to the query.  The return value is a cursor represented by an object of type MongoCursor object.  The MongoCursor type implements the (implement) Iterator pattern, so it is fairly easy to run through the entire returned set using foreach ().  The MongoCursor type contains a count () method that returns the number of entries. <br>  The Mongo PHP extension supports the exception model implemented in PHP 5.x and defines 5 types of exceptions: MongoConnectionException for connection errors, MongoCursorException and MongoCursorTimeoutException for request errors;  MongoGridFSException for file interaction errors;  and MongoException for all other errors.  In the previous example, it would be a good idea to enclose the code in a try / catch block. <br>  Below is an example of the output of the previous example: <br><img src="http://devzone.zend.com/content/articles/12132/image4.jpg"><br><br>  <strong>Addition And Subtraction</strong> <br>  Adding a new document to the collection is quite simple.  See the following example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// insert a new document</font> <br> $item = array( <br> <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'milk'</font> , <br> <font color="#A31515">'quantity'</font> =&gt; 10, <br> <font color="#A31515">'price'</font> =&gt; 2.50, <br> <font color="#A31515">'note'</font> =&gt; <font color="#A31515">'skimmed and extra tasty'</font> <br> ); <br> $collection-&gt;insert($item); <br> echo <font color="#A31515">'Inserted document with ID: '</font> . $item[ <font color="#A31515">'_id'</font> ]; <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  To add a new document to the collection, create a new array containing a key-value pair that you want to insert (the mechanism also supports nested arrays that are converted into embedded documents) and pass this array to the insert method of an object of type MongoCollection.  This method will add a document to the collection and calculate the value of '_id' (unique document identifier), which will be added to the original array.  This identifier is represented by a special type of MongoId, which is a hexadecimal representation of the identifier.  Therefore, you can easily get the ID of the document without making an additional request. <br>  Below is an example: <br><img src="http://devzone.zend.com/content/articles/12132/image5.jpg"><br><br>  The document is removed from the collection by the remove () method, which takes an array of criteria as parameters, and removes all documents that meet these criteria.  Normally remove () returns a Boolean value (true or false);  However, if you pass a special 'safe' argument as the second argument, you can get an array with a large amount of information, including the number of deleted documents.  Below is an example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// remove a document</font> <br> $criteria = array( <br> <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'milk'</font> , <br> ); <br> $r = $collection-&gt;remove($criteria, array( <font color="#A31515">'safe'</font> =&gt; <font color="#0000ff">true</font> )); <br> echo <font color="#A31515">'Removed '</font> . $r[ <font color="#A31515">'n'</font> ] . <font color="#A31515">' document(s).'</font> ; <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  It is also possible to delete a document using its id.  However, the object of the MongoId method is passed to the remove () method, not the PHP string.  Below is an example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// remove a document by ID</font> <br> $criteria = array( <br> <font color="#A31515">'_id'</font> =&gt; <font color="#0000ff">new</font> MongoId( <font color="#A31515">'4bea96b400f4784c0a070000'</font> ), <br> ); <br> $collection-&gt;remove($criteria); <br> echo <font color="#A31515">'Removed document with ID: '</font> . $criteria[ <font color="#A31515">'_id'</font> ]; <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The document is updated using the save () method, as shown below: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// retrieve existing document</font> <br> $criteria = array( <br> <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'eggs'</font> , <br> ); <br> $doc = $collection-&gt;findOne($criteria); <br> <br> <font color="#008000">// update document with new values</font> <br> <font color="#008000">// save back to collection</font> <br> $doc[ <font color="#A31515">'name'</font> ] = <font color="#A31515">'apples'</font> ; <br> $doc[ <font color="#A31515">'quantity'</font> ] = 35; <br> $doc[ <font color="#A31515">'note'</font> ] = <font color="#A31515">'green apples taste sooooo good!'</font> ; <br> $collection-&gt;save($doc); <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Note that if findOne () did not return anything, the save () call will add a new document. <br>  <strong>Asking Questions</strong> <br>  When it comes to query execution, MongoDB offers quite flexible tools.  You have already seen the find () method, which returns a collection of documents matching the search criteria.  There is also a findOne () method that returns a single document.  You can use many search criteria ‚Äî just pass an array as find criteria to find () or findOne (), and MongoDB will apply all of these criteria with the AND modifier. <br>  Below is an example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// formulate AND query</font> <br> $criteria = array( <br> <font color="#A31515">'quantity'</font> =&gt; 30, <br> <font color="#A31515">'price'</font> =&gt; 0.5 <br> ); <br> <br> <font color="#008000">// retrieve only 'name' and 'price' keys</font> <br> $fields = array( <font color="#A31515">'name'</font> , <font color="#A31515">'price'</font> ); <br> <br> <font color="#008000">// execute query</font> <br> $cursor = $collection-&gt;find($criteria, $fields); <br> <br> <font color="#008000">// iterate through the result set</font> <br> <font color="#008000">// print each document</font> <br> echo $cursor-&gt;count() . <font color="#A31515">' document(s) found. &lt;br/&gt;'</font> ; <br> <font color="#0000ff">foreach</font> ($cursor <font color="#0000ff">as</font> $obj) { <br> echo <font color="#A31515">'Name: '</font> . $obj[ <font color="#A31515">'name'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'Price: '</font> . $obj[ <font color="#A31515">'price'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'&lt;br/&gt;'</font> ; <br> } <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  MongoDB also supports a large number of <a href="http://www.mongodb.org/display/DOCS/Advanced%2BQueries">conditional and logical operators</a> for creating complex queries.  Plus, regular expression support.  Below is an example that displays all entries with a number between 10 and 50 and whose names end with 'es': <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// formulate complex query</font> <br> $criteria = array( <br> <font color="#A31515">'quantity'</font> =&gt; array( <br> <font color="#A31515">'$gt'</font> =&gt; 10, <br> <font color="#A31515">'$lt'</font> =&gt; 50 <br> ), <br> <font color="#A31515">'name'</font> =&gt; <font color="#0000ff">new</font> MongoRegex( <font color="#A31515">'/es$/i'</font> ) <br> ); <br> <br> <font color="#008000">// execute query</font> <br> $cursor = $collection-&gt;find($criteria); <br> <br> <font color="#008000">// iterate through the result set</font> <br> <font color="#008000">// print each document</font> <br> echo $cursor-&gt;count() . <font color="#A31515">' document(s) found. &lt;br/&gt;'</font> ; <br> <font color="#0000ff">foreach</font> ($cursor <font color="#0000ff">as</font> $obj) { <br> echo <font color="#A31515">'Name: '</font> . $obj[ <font color="#A31515">'name'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'Quantity: '</font> . $obj[ <font color="#A31515">'quantity'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'Price: '</font> . $obj[ <font color="#A31515">'price'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'&lt;br/&gt;'</font> ; <br> } <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  How will it look like: <br><img src="http://devzone.zend.com/content/articles/12132/image6.jpg"><br><br>  You can also change the number of returned documents or sort them by the required key using the limit () and sort () methods.  Below is an example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// execute query</font> <br> <font color="#008000">// sort by price</font> <br> <font color="#008000">// limit to 3 documents</font> <br> $cursor = $collection-&gt;find(); <br> $cursor-&gt;sort(array( <font color="#A31515">'price'</font> =&gt; 1))-&gt;limit(3); <br> <br> <font color="#008000">// iterate through the result set</font> <br> <font color="#008000">// print each document</font> <br> echo $cursor-&gt;count() . <font color="#A31515">' document(s) found. &lt;br/&gt;'</font> ; <br> <font color="#0000ff">foreach</font> ($cursor <font color="#0000ff">as</font> $obj) { <br> echo <font color="#A31515">'Name: '</font> . $obj[ <font color="#A31515">'name'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'Quantity: '</font> . $obj[ <font color="#A31515">'quantity'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'Price: '</font> . $obj[ <font color="#A31515">'price'</font> ] . <font color="#A31515">'&lt;br/&gt;'</font> ; <br> echo <font color="#A31515">'&lt;br/&gt;'</font> ; <br> } <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  By the way, if you go to find out how inside MongoDB executes a request, you can use the explain () method of the MongoCursor object to ‚Äúlook inside‚Äù the query processing system, much like the MySQL EXPLAIN command.  Below is an example and output: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// access collection</font> <br> $collection = $db-&gt;items; <br> <br> <font color="#008000">// execute and explain query</font> <br> $criteria = array( <br> <font color="#A31515">'quantity'</font> =&gt; array( <br> <font color="#A31515">'$gt'</font> =&gt; 10, <br> <font color="#A31515">'$lt'</font> =&gt; 50 <br> ), <br> <font color="#A31515">'name'</font> =&gt; <font color="#0000ff">new</font> MongoRegex( <font color="#A31515">'/es$/i'</font> ) <br> ); <br> $cursor = $collection-&gt;find($criteria); <br> $cursor-&gt;sort(array( <font color="#A31515">'price'</font> =&gt; 1))-&gt;limit(3); <br> print_r($cursor-&gt;explain()); <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><img src="http://devzone.zend.com/content/articles/12132/image7.jpg"><br><br>  <strong>Rank and file</strong> <br>  In addition to documents, MongoDB also supports binary data.  Binary data up to 4 MB can be stored in a regular document, and data (files) that are larger than this size can be saved using a small thing called <a href="http://www.mongodb.org/display/DOCS/GridFS%2BSpecification">GridFS</a> . <br>  GridFS is a specification that describes splitting and saving large files in MongoDB.  Normally, GridFS uses two collections: the 'files' collection, which caches metadata about each file, and the 'chunks' collection, which stores data divided into chunks.  Each file in the 'files' collection has a unique identifier, similar to the identifiers of other documents stored in MongoDB;  This identifier can be used to get or modify the file. <br><br>  The MongoDB PECL extension provides a set of MongoGridFS classes that can be used to interact with files saved using GridFS.  Each file is represented by an instance of the MongoGridFSFile class, and each MongoGridFS object provides methods for adding, deleting, and searching for these files. <br><br>  For better understanding, consider the following example, which illustrates the process of adding an image to MongoDB: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// get GridFS files collection</font> <br> $gridfs = $db-&gt;getGridFS(); <br> <br> <font color="#008000">// store file in collection</font> <br> $id = $gridfs-&gt;storeFile( <font color="#A31515">'/tmp/img_2312.jpg'</font> ); <br> echo <font color="#A31515">'Saved file with ID: '</font> . $id; <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  At the beginning of the example, an instance of the MongoGridFS class is obtained using the MongoDB class's getGridFS () method, and then stored by the storeFile () method in MongoDB.  If you run this example, and then look at the contents of your database, you will see two new collections 'fs.files' and 'fs.chunks'.  If you look a little deeper into the 'fs.files' collection, then you will see the file you‚Äôve added. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&gt; show collections <br> fs.chunks <br> fs.files <br> items <br> system.indexes <br> &gt; db.fs.files.find() <br> { <font color="#A31515">"_id"</font> : ObjectId( <font color="#A31515">"4beaa34f00f4784c0a300000"</font> ), <font color="#A31515">"filename"</font> : <font color="#A31515">"/tmp/img_2312.jpg"</font> , <font color="#A31515">"uploadDate"</font> : <font color="#A31515">"Wed May 12 2010 18:17:11 GMT+0530 (India Standard Time)"</font> , <font color="#A31515">"length"</font> : 11618, <font color="#A31515">"chunkSize"</font> : 262144, <font color="#A31515">"md5"</font> : <font color="#A31515">"e66b9a33c7081ae2e4fff4c37f1f756b"</font> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  As an alternative to the storeFile (), there is a method called storeUpload (), which is designed to be used in conjunction with file loading using PHP.  Using this feature is very easy: pass the name of the file upload field to the storeUpload in the form, and MongoDB will do everything itself.  You can also pass the file name as the second argument. <br>  Below is a small example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;html&gt; <br> &lt;head&gt;&lt;/head&gt; <br> &lt;body&gt; <br> &lt;form method= <font color="#A31515">"post"</font> enctype= <font color="#A31515">"multipart/form-data"</font> &gt; <br> Select file <font color="#0000ff">for</font> upload: <br> &lt;input type= <font color="#A31515">"file"</font> name= <font color="#A31515">"f"</font> /&gt; <br> &lt;input type= <font color="#A31515">"submit"</font> name= <font color="#A31515">"submit"</font> /&gt; <br> &lt;/form&gt; <br> &lt;?php <br> <font color="#0000ff">if</font> (isset($_POST[ <font color="#A31515">'submit'</font> ])) { <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// get GridFS files collection</font> <br> $gridfs = $db-&gt;getGridFS(); <br> <br> <font color="#008000">// check uploaded file</font> <br> <font color="#008000">// store uploaded file in collection and display ID</font> <br> <font color="#0000ff">if</font> (is_uploaded_file($_FILES[ <font color="#A31515">'f'</font> ][ <font color="#A31515">'tmp_name'</font> ])) { <br> $id = $gridfs-&gt;storeUpload( <font color="#A31515">'f'</font> ); <br> echo <font color="#A31515">'Saved file with ID: '</font> . $id; <br> } <font color="#0000ff">else</font> { <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">'Invalid file upload'</font> ); <br> } <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (Exception $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> } <br> ?&gt; <br> &lt;/body&gt; <br> &lt;/html&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Having a file in the database, how to get it back?  Of course, using the document ID to retrieve the file (MongoGridFS is the inheritor of the MongoCollection, so you can use find () and findOne ()) as an object of the MongoGridFSFile class, and then write it to disk using the write () method, or output it to or using getBytes ().  If you use browser output, do not forget to add the necessary header (header)! <br>  Below is an example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">try</font> { <br> <font color="#008000">// open connection to MongoDB server</font> <br> $conn = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// access database</font> <br> $db = $conn-&gt;test; <br> <br> <font color="#008000">// get GridFS files collection</font> <br> $grid = $db-&gt;getGridFS(); <br> <br> <font color="#008000">// retrieve file from collection</font> <br> $file = $grid-&gt;findOne(array( <font color="#A31515">'_id'</font> =&gt; <font color="#0000ff">new</font> MongoId( <font color="#A31515">'4beaa34f00f4784c0a300000'</font> ))); <br> <br> <font color="#008000">// send headers and file data</font> <br> header( <font color="#A31515">'Content-Type: image/jpeg'</font> ); <br> echo $file-&gt;getBytes(); <br> exit; <br> <br> <font color="#008000">// disconnect from server</font> <br> $conn-&gt;close(); <br> } <font color="#0000ff">catch</font> (MongoConnectionException $e) { <br> die( <font color="#A31515">'Error connecting to MongoDB server'</font> ); <br> } <font color="#0000ff">catch</font> (MongoException $e) { <br> die( <font color="#A31515">'Error: '</font> . $e-&gt;getMessage()); <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  <strong>Boys And Their Toys</strong> <br>  Although the PECL MongoDB extension offers quite convenient methods for working with MongoDB, you may need a higher level of abstraction - say, for example, if you are trying to integrate MongoDB into an existing application (framework-based application).  In this case, you can use <a href="http://code.google.com/p/mongodb-morph/">Morph</a> , the high-level library for MongoDB, which is available for free under the GNU GPL license. <br><br>  Morph is written as an ActiveRecord template that allows you to create a description of a MongoDB object, extending the main Morph_Object class.  These instances of the Morph_Object class are reflected directly into MongoDB documents and have the same properties and methods by which you can work using standard object notation. <br><br>  To illustrate, suppose you want to create a toy database.  Common attributes include name, description, age suitability, gender suitability and price.  You can present all this information as an object of the Morph_Object class: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">class</font> Toy extends Morph_Object { <br> <br> <font color="#0000ff">public</font> function __construct($id = <font color="#0000ff">null</font> ) <br> { <br> parent::__construct($id); <br> $ <font color="#0000ff">this</font> -&gt;addProperty( <font color="#0000ff">new</font> Morph_Property_String( <font color="#A31515">'name'</font> )) <br> -&gt;addProperty( <font color="#0000ff">new</font> Morph_Property_String( <font color="#A31515">'colors'</font> )) <br> -&gt;addProperty( <font color="#0000ff">new</font> Morph_Property_Integer( <font color="#A31515">'minAge'</font> )) <br> -&gt;addProperty( <font color="#0000ff">new</font> Morph_Property_Integer( <font color="#A31515">'maxAge'</font> )) <br> -&gt;addProperty( <font color="#0000ff">new</font> Morph_Property_Enum( <font color="#A31515">'gender'</font> , <font color="#0000ff">null</font> , array( <font color="#A31515">'boys'</font> , <font color="#A31515">'girls'</font> , <font color="#A31515">'both'</font> ))) <br> -&gt;addProperty( <font color="#0000ff">new</font> Morph_Property_Float( <font color="#A31515">'price'</font> )); <br> } <br> } <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now you can create a new document using this template using an object of the Toy class, set properties and write it using the save () method.  Below is an example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> require_once <font color="#A31515">'Morph.phar'</font> ; <br> <br> <font color="#008000">// initialize MongoDB connection</font> <br> $mongo = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// select database for storage</font> <br> $storage = Morph_Storage::init($mongo-&gt;selectDb( <font color="#A31515">'test'</font> )); <br> <br> <font color="#008000">// create object and set properties</font> <br> $toy = <font color="#0000ff">new</font> Toy(); <br> $toy-&gt;name = <font color="#A31515">'Ride Along Fire Engine'</font> ; <br> $toy-&gt;colors = <font color="#A31515">'red,yellow'</font> ; <br> $toy-&gt;minAge = <font color="#A31515">'2'</font> ; <br> $toy-&gt;maxAge = <font color="#A31515">'4'</font> ; <br> $toy-&gt;gender = <font color="#A31515">'both'</font> ; <br> $toy-&gt;price = 145.99; <br> <br> <font color="#008000">// save to database</font> <br> $storage-&gt;save($toy); <br> echo <font color="#A31515">'Document saved with ID: '</font> . $toy-&gt;id(); <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Also, you can get an object by its identifier, update it and save it back. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> require_once <font color="#A31515">'Morph.phar'</font> ; <br> <br> <font color="#008000">// initialize MongoDB connection</font> <br> $mongo = <font color="#0000ff">new</font> Mongo( <font color="#A31515">'localhost'</font> ); <br> <br> <font color="#008000">// select database for storage</font> <br> $storage = Morph_Storage::init($mongo-&gt;selectDb( <font color="#A31515">'test'</font> )); <br> <br> <font color="#008000">// create object and set properties</font> <br> $toy = <font color="#0000ff">new</font> Toy(); <br> $toy-&gt;loadById( <font color="#A31515">'5421d0b9fc6217c5bb929baa14a97e08'</font> ); <br> $toy-&gt;name = <font color="#A31515">'Jumping Squid'</font> ; <br> $toy-&gt;colors = <font color="#A31515">'red,orange,green,blue,yellow'</font> ; <br> $toy-&gt;minAge = <font color="#A31515">'2'</font> ; <br> $toy-&gt;maxAge = <font color="#A31515">'10'</font> ; <br> $toy-&gt;gender = <font color="#A31515">'boys'</font> ; <br> $toy-&gt;price = 22.99; <br> <br> <font color="#008000">// save to database</font> <br> $storage-&gt;save($toy); <br> echo <font color="#A31515">'Document saved with ID: '</font> . $toy-&gt;id(); <br> ?&gt; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  All these examples illustrate - MongoDB provides a reliable, feature-rich implementation of a schema-free DBMS.  Accessibility for various platforms, easy integration with PHP and other languages, and extensive documentation (plus very cool online experimentation) make MongoDB ideal for developing modern, document-oriented databases. </div><p>Source: <a href="https://habr.com/ru/post/103699/">https://habr.com/ru/post/103699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../103688/index.html">Highscreen Alex - e-book with Android inside</a></li>
<li><a href="../103691/index.html">BBCode-enabled Growl Webkit Style</a></li>
<li><a href="../103692/index.html">Droider Chart 17. Special Edition</a></li>
<li><a href="../103694/index.html">With the world on click or where to find buyers in Runet?</a></li>
<li><a href="../103696/index.html">Production Information Systems. The devil is in the details</a></li>
<li><a href="../103700/index.html">Service u.nu closed</a></li>
<li><a href="../103702/index.html">WebHiTech '2010. Are you already using HTML 5? Set a good example for the rest!</a></li>
<li><a href="../103703/index.html">Overview of Office File Viewers (doc and docx) for Android</a></li>
<li><a href="../103704/index.html">Show HTML5 features on Google.com homepage</a></li>
<li><a href="../103706/index.html">Robot bayanist</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>