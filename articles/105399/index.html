<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We are looking for a solution to the problem of data loss in the fall of Fox</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It so happened that in the last few days, Firefox did not close normally twice. The first time he honestly gave up (crash) after a long period of inte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We are looking for a solution to the problem of data loss in the fall of Fox</h1><div class="post__text post__text-html js-mediator-article"> It so happened that in the last few days, Firefox did not close normally twice.  The first time he honestly gave up (crash) after a long period of intensive work, carrying on board more than 50 extensins, and the second time: he came to work today - and the computer was turned off.  It turned out that electricity was cut down ... <br><br>  For the first time, I noticed that the settings of one extension, which I was using at that time, were not saved.  I had to re-configure.  But when today I had to restore these settings a second time, I thought that this should not be so. <br><br>  After searching a bit, I found that Firefox does save the settings to the prefs.js file <br>  <sup>(lives at C: \ Documents and Settings \ User \ Application Data \ Mozilla \ Firefox \ Profiles \ sDgUfwhg.default \ prefs.js)</sup> <br>  only with a regular closure (and even with some movements that surfaced during the investigation). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But the browser in our time almost never closes ... So there must be a solution;) <br><a name="habracut"></a><br><br>  There is a typical situation: <br>  So I just made some amendments to the extensin settings (for example, added the site to the white list of BetterCache, or Stop Autoplay).  I know for sure that these settings are stored in prefs.js, that is, they will actually be saved to the screw when the browser is closed.  And now, in order not to lose the work done, now there is a desire to close and open the browser (or restart), but I really don‚Äôt want to, as many tabs are open, and in general the browser should not close.  It turns out that if you do nothing and continue to work, then such data will most likely be lost. <br><br>  A similar problem exists with Windows applications that store data in the registry: very rarely, but it happened that I received a BSOD and noticed after loading that the settings of some programs ‚Äúforgot‚Äù all my recent changes.  That is, changes in the registry is also not immediately saved on the screw. <br><br>  In this situation with Firefox, I started looking for a solution to save the settings, or rather, how to make flush settings in the prefs.js file, without closing the browser. <br><br>  I thought that there might already be some kind of extension, but the search on addons.mozilla.org did not yield any results (I was once again convinced that they had no search). <br><br>  Then I started to google on the topic ‚Äúprefs.js‚Äù flush and found 2 explanatory pages: <br>  <a href="http://www.softwarepunk.com/blog/firefox-preferences-flush.html">www.softwarepunk.com/blog/firefox-preferences-flush.html</a> <br>  <a href="http://fixunix.com/mozilla/408327-savepreffile-doesnt-really-work.html">fixunix.com/mozilla/408327-savepreffile-doesnt-really-work.html</a> <br><br>  So in half an hour I already had the code: <br> <code>Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).savePrefFile(null)</code> <br> <br>  But running it in the Firebug console, I got: <br>  Error: Permission denied for &lt;...&gt; to get property XPCComponents.classes <br>  For any page of any site. <br><br>  Then I thought that you need to try not on sites, but on the internal Firefox pages.  I try on about: config - a characteristic delay —ñ no error message.  I look at prefs.js - updated. <br>  Checked in the text search for the presence of the domains I whitelisted are present, which means the preservation of recent changes is exactly happening. <br><br>  Now the next task: how to make saving convenient? <br><br>  The first thought is a bookmarklet.  I create a bookmark, I register it in the Location: <br> <code>javascript:Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).savePrefFile(null)</code> <br>  I try with the open page about: config - it works, on all others - Permission denied. <br><br>  That's what I'm stuck with. <br><br>  How to make the button work no matter which site is open?  (open about: config with the script, run the code there and close it? I think it will not work for the same reason that we get Permission denied - a security violation). <br><br>  How to make a normal button, or so that it doesn‚Äôt need a button at all, but just so that the save code works periodically?  (Write an extension? I have no experience, if there is anyone more experienced - help). <br>  <b>UPD.</b>  A good man was found, see the first comment. <br><br>  So far, I manually open about: config and press the button of the bookmarklet for which I made an icon <img src="https://habrastorage.org/getpro/habr/post_images/b88/5fb/74e/b885fb74ed62a4cb14c9a2d66e222342.png" alt="image">  ( <a href="">download</a> ). <br>  I put the icon using the extenic <a href="https://addons.mozilla.org/en-US/firefox/addon/7849/">Favicon Picker 3</a> . <br><br><h4>  Noticed </h4>  When you click on such a bookmarklet, saving occurs only if something has really changed in the settings.  Otherwise, nothing happens, prefs.js does not move, and there is no noticeable delay when the button is pressed.  It is very good to periodically save in the background, if this is done somehow. <br><br><h4>  Passing thoughts </h4>  In a good way, this extensions should flush when closing their settings window, not the user.  Similarly, Firefox could do this periodically, and not only at closing and, as it turned out about the research process, with changes in the browser settings (the Options window or the about: config tab).  Each time to change something in the settings, or in the table about: config, changing back and forth an arbitrary boolean parameter is also an option, but still not the same ... <br><br>  I hope that together the community can find / come up with a better solution than what I got. <br><br></div><p>Source: <a href="https://habr.com/ru/post/105399/">https://habr.com/ru/post/105399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../105391/index.html">Liveblog Camera</a></li>
<li><a href="../105392/index.html">Online Poker Security</a></li>
<li><a href="../105393/index.html">Canobuvosti, 59th edition</a></li>
<li><a href="../105396/index.html">Video review of the Apacer AL670 media player</a></li>
<li><a href="../105398/index.html">Philosophy of language</a></li>
<li><a href="../105400/index.html">Kindle vs nook</a></li>
<li><a href="../105402/index.html">Chromium was launched on iPad</a></li>
<li><a href="../105406/index.html">Put the second video card into the PCI-Express x1 slot</a></li>
<li><a href="../105408/index.html">Java for HPC. Calculation of the scalar product of vectors</a></li>
<li><a href="../105410/index.html">Google Street View detects dead bodies on the streets of Brazil</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>