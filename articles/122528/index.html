<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Auto-generating APK with various data from the command line using Ant</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently I ran into a problem - it was necessary to generate an apk file on the remote server for download, and depending on the server address being ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Auto-generating APK with various data from the command line using Ant</h1><div class="post__text post__text-html js-mediator-article">  Recently I ran into a problem - it was necessary to generate an apk file on the remote server for download, and depending on the server address being transmitted, the program had to connect to different servers during installation by default. <br><br>  So the task is to give the user the opportunity to download from the Internet a dynamically generated Android application that will behave differently depending on the parameters transferred (in this case, different data download servers). <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perhaps this task will seem easy to many, but I came across this for the first time and I hope that the information will be useful to someone. <br><br>  First, set up Java and Ant, Android SDK on your remote server.  Make sure that the paths to them are specified or enter the full path when launching applications from these packages.  Copy the project source to the server. <br><br><h5>  Command order </h5><br><br>  I give this example for Ubuntu.  For a Windows server, you only need to replace the command for creating a file on the command line. <br><br>  Create a batch file that will generate an apk file with variable server addresses.  Naturally you can use it for other variables. <br><br>  At first you create a file of your data and specified the folder / assets in your project as a data path ... <br><br> <code>cat&lt;&lt;F&gt;__/_.txt <br>    ,       <br> F</code> <br> <br>  Generate the build.xml file in the project root, and the project name &lt;project_name&gt; you can specify any, it will be the name of the apk file.  If you need to make different releases, then you can point for example project_name_release_number_version_number, etc. <br><br> <code>android update project --name &lt;project_name&gt; --path &lt;path_to_your_project&gt;</code> <br> <br>  Then run the command from the project root. <br><br> <code>ant release</code> <br> <br>  as a result, you will get a ready apk in the / bin directory.  In this case, you will receive a file with the suffix -unsigned.apk, since you have not signed your application.  To sign your application you need to make sure that the path to your certificate store is specified in the <b>local.properties</b> file.  How to create a certificate for signing your application is described <a href="http://developer.android.com/guide/publishing/app-signing.html">here</a> .  This is beyond the scope of this note. <br><br> <code>key.store=/Path/to/my/keystore/MyKeystore.ks <br> key.alias=myalias</code> <br> <br>  To be sure, we can insert the code generating this file. <br><br> <code>cat&lt;&lt;F &gt;_/local.properties <br> # This file is automatically generated by Android Tools. <br> # Do not modify this file -- YOUR CHANGES WILL BE ERASED! <br> # <br> # This file must *NOT* be checked in Version Control Systems, <br> # as it contains information specific to your local configuration. <br> # location of the SDK. This is only used by Ant <br> # For customization when using a Version Control System, please read the <br> # header note. <br> sdk.dir=/__sdk/Android-sdk <br> key.store=/Path/to/my/keystore/MyKeystore.ks <br> key.alias=myalias <br> F <br></code> <br><br>  In your Java code, you get the data you need to work from the generated file in / assets.  Use them as you need.  In my case, I just read the address of the server from which to download. <br>  User for download give a link to the finished apk. <br><br>  The complete batch file is shown below.  Data paths and file names you can transfer to the script / batch file using parameters. <br><br>  <b>ATTENTION!</b>  In the text of the note, everywhere EOF is written with the help of Russian letters E and O - otherwise it was incorrectly displayed. <br><br> <code>cat&lt;&lt;F &gt;__/_.txt <br>    ,       <br> F <br> android update project --name &lt;project_name&gt; --path &lt;path_to_your_project&gt; <br> cat&lt;&lt;F&gt;_/local.properties <br> # This file is automatically generated by Android Tools. <br> # Do not modify this file -- YOUR CHANGES WILL BE ERASED! <br> # <br> # This file must *NOT* be checked in Version Control Systems, <br> # as it contains information specific to your local configuration. <br> # location of the SDK. This is only used by Ant <br> # For customization when using a Version Control System, please read the <br> # header note. <br> sdk.dir=/__sdk/Android-sdk <br> key.store=/Path/to/my/keystore/MyKeystore.ks <br> key.alias=myalias <br> F <br> ant release <br></code> </div><p>Source: <a href="https://habr.com/ru/post/122528/">https://habr.com/ru/post/122528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122519/index.html">Infographics: Microsoft vs. Apple The history of development</a></li>
<li><a href="../122520/index.html">Sony continues to fight "hackers"</a></li>
<li><a href="../122523/index.html">Using Access Control Service 2.0 for authorization in your applications</a></li>
<li><a href="../122524/index.html">Google AdSense or wood chopping - chips fly</a></li>
<li><a href="../122525/index.html">New model reader Lbook V60</a></li>
<li><a href="../122529/index.html">MTBF - where does a million hours MTBF come from?</a></li>
<li><a href="../122530/index.html">Dataflow architecture. Part 2</a></li>
<li><a href="../122531/index.html">Fast full-text search ElasticSearch</a></li>
<li><a href="../122533/index.html">Losing innocence: about the design of your first app</a></li>
<li><a href="../122535/index.html">NUMA and what does vSphere know about it?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>