<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calculation of pizzerias: Papa Jones, who does not care about security</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Picture to attract attention is taken here. 

 Pizzeria Papa Jones is open in many countries, the engine of sites is almost everywhere different. Howe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calculation of pizzerias: Papa Jones, who does not care about security</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/u8/hi/hc/u8hihc2vt3kt9qtcsqkv5sjg70e.jpeg" alt="image"></div><br>  <i>Picture to attract attention is taken <a href="http://www.nashgorod.ru/otdih/news/news102209.html">here.</a></i> <br><br>  Pizzeria Papa Jones is open in many countries, the engine of sites is almost everywhere different.  However, the engine, which was developed somewhere in Russia, is also used on sites for Poland, Kyrgyzstan and Belarus.  We will consider it. <br><a name="habracut"></a><br>  You can see the engine itself on a <a href="https://m.papajohns.ru/">mobile site for Russia</a> , for example.  Why mobile?  Because the <a href="https://papajohns.ru/">desktop</a> does not even have a registration form, although this is explained by the fact that registration is automatic when ordering.  I decided to check once on how things are with vulnerabilities. <br><br>  Since picking in applications is the easiest, I took it.  To my surprise, I found out that the application is just a strange wrapper for the site, although the server can clearly distinguish who the request came from when requesting it.  It turned out to be possible to test with equal success both the application and the mobile version.  The only difference is that the platform field - mobSite is transmitted for the mobile site, and the applications report the system and version. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I succeeded immediately because I started with password recovery.  I propose to look at how this happens. <br><br>  First you need to get the code itself in SMS.  Ask for the link with JSON in the body: <br><br><pre><code class="hljs pgsql">POST https://www.papajohns.ru/api/auth/recovery/requestCode { "username": "+79", "transport": "sms", "lang": "ru", "version": "1.0.34", "platform": "Android" }</code> </pre> <br>  The server responds: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre><br>  Strange data is not enough.  Identifier or session at least, but look further. <br><br>  In SMS comes a four-digit code (only numbers).  We will not send it, because changing the password leads to blocking of points for two weeks, and I had plans for them.  Let's try to send random: <br><br><pre> <code class="hljs pgsql">POST https://www.papajohns.ru/api/auth/recovery/updatePassword { "code": "1234", "password": "123456qwe", "transport": "sms", "version": "1.0.34", "platform": "Android" }</code> </pre><br>  I was very impressed.  It turned out that when requesting SMS, a pair of phone number + code is written to the database, and when requesting recovery by code, the server checks for the presence of the code in the database and, if found, sets the received password to the database. <br><br>  The situation gets worse from the fact that there is no restriction on code search.  Experimentally, I found out that over a 10 minute search the script is guaranteed to set a password.  And if you request recovery for all 10,000 codes from 0000 to 9999? <br><br>  On May 12, I communicated all the details directly to the developer of the site (well, at least he introduced himself to them).  June 19, I wondered how things were going to close the vulnerability.  The script sent about three hundred requests and stood up.  Having specified the developer status, I found out that the server is now blocking by IP, if it receives 5 incorrect requests.  Today I again checked whether the logic has changed, and I am ready to inform you: it has not changed.  The server is now also indifferent: I sent 3000 requests without too much difficulty, so that all 10,000, I suppose, will go away without any problems. <br><br>  The risk of disclosing all stored addresses only by the presence of a mobile phone number remains significant.  Bank cards are deleted when the password is reset.  They gave me 1000 points and pizza.  The pizza is delicious, but the address I will not store there. </div><p>Source: <a href="https://habr.com/ru/post/418611/">https://habr.com/ru/post/418611/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../418601/index.html">The whole truth about the RTOS. Article # 7. Nucleus SE: introduction</a></li>
<li><a href="../418603/index.html">Matrix PowerWatch smart watches that never need to be charged</a></li>
<li><a href="../418605/index.html">Analysts: Microsoft's capitalization could reach $ 1 trillion</a></li>
<li><a href="../418607/index.html">Choosing a vendor in corporate Wi-Fi</a></li>
<li><a href="../418609/index.html">120 kW of reserve energy or How to power the estate from the energy of the sun</a></li>
<li><a href="../418615/index.html">Zyxel Nebula and company growth</a></li>
<li><a href="../418617/index.html">Lenovo DS6200 storage system overview</a></li>
<li><a href="../418619/index.html">React and SEO: how to make friends?</a></li>
<li><a href="../418621/index.html">Why engineer soft skills</a></li>
<li><a href="../418625/index.html">Andy Grove's Secret Call That Helped Apple Buy NeXT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>