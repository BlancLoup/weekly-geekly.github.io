<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Shield and sword in RBS systems - 2, or how to deal with MITM attacks and unauthorized remote access</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In January 2013, we already wrote about a universal solution for RBS systems. Over the past year, a number of revisions were carried out aimed at impr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Shield and sword in RBS systems - 2, or how to deal with MITM attacks and unauthorized remote access</h1><div class="post__text post__text-html js-mediator-article">  In January 2013, we already wrote about a <a href="http://habrahabr.ru/company/aktiv-company/blog/165887/">universal solution</a> for RBS systems.  Over the past year, a number of revisions were carried out aimed at improving protection against theft and increasing usability. <br><br>  Doing so has prompted us to a sharp increase in the number of attacks on the RBS systems associated with the use of remote access to users' computers.  Unfortunately, with this type of attack, ordinary two-factor authentication is in no way capable of protecting the company's financial assets.  An obvious countermeasure is the need to create a trusted environment with the inability to use remote control tools. <br><br>  So, we will remind that such <a href="http://www.rutoken.ru/products/all/rutoken-pinpad/">PINPad Ruken</a> .  This is a solution of the TrustScreen class that can form a trusted environment and visualize the document being signed before applying the electronic signature.  The signature occurs directly on the device itself after the user physically presses the corresponding button on the screen.  Thus, we defend ourselves against attacks made using remote control tools, substituting the contents of the document for transfer to the signature (Man-in-the-browser). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/e32/162/286/e32162286a566db4a30fd42453da1fa5.png" alt="image"><br><a name="habracut"></a><br>  As you can see, we made a new case with a special stand, completely redesigned the interface design, and also provided the device with additional functionality. <br><br>  So, the main points: <br><ul><li>  Visualization of documents and their signature on the device itself </li><li>  Implementation of domestic cryptographic algorithms "on board the device" </li><li>  Unrecoverable keys </li><li>  PIN hardware input on the screen </li><li>  The ability to generate and confirm a certificate request in the format PKCS # 10 </li><li>  X.509 format and PKI support </li><li>  Lack of ability to sign unverified data </li><li>  The possibility of making mass payments on the "white" lists </li><li>  PIN caching option </li><li>  Operation log for incident investigation </li><li>  Work with any browser through the plugin </li><li>  Color touch screen </li></ul><br>  Now we will show how it all looks when used. <br>  We will proceed to our Demobank, where we will go through the registration process to get started, namely, we <i><b>will form a request for a certificate</b></i> . <br><br>  Choose from the list of connected PINPad devices: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/73e/666/d6a/73e666d6ac971b7504f6525c9c2e786b.jpg" alt="image"><br><br>  We will invent a login: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ea/cfc/c11/7eacfcc115bec63431c0b8d85c8cbf7f.jpg" alt="image"><br><br>  The request is displayed on the screen and, if we agree, click on the check mark and enter the PIN code: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/498/a62/d94/498a62d94d078d86df22e999289db392.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe9/79b/bcc/fe979bbcc171e6e89500fefbd8875c37.png" alt="image"><br><br>  Now <i><b>authorization</b></i> .  We choose our certificate, we look at the screen with what certificate is the entrance and at what address. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e77/4c0/603/e774c0603b837d36c82d9fde66239b6a.jpg" alt="image"><br><br>  We agree and enter the PIN-code on the device for authorization: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/80a/2f5/744/80a2f574442a946c43c30fa49450b3dd.png" alt="image"><br><br>  Note that registration and authentication occur by signing random data on the device in the CMS format with the request displayed on the device screen. <br><br>  In the Demobank there is a white list implementation in which the contractors are listed, with whom we constantly work and trust them completely. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/152/717/265152717718a84c087b8b3d57ff3890.jpg" alt="image"><br><br>  What does the exclamation mark mean for billing?  In this case, a visual confirmation of payment for non-white list respondents and a payment confirmation with an amount in excess of 100,000 rubles have been implemented.  Such payments require visualization and additional confirmation with the help of Rutoken PINPad. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/576/8a2/955/5768a2955d27b48530899a4bc3bb0979.jpg" alt="image"><br><br>  If we make a mass payment of 4 payments, two of them, not marked with an exclamation mark, will be signed without visualization, and the other two will be displayed on the screen of PINPad: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/482/dc9/ad7/482dc9ad72931431ef9f5fe19374e564.png" alt="image"><br><br>  In the case of a substitution of the payment document by the attacker, on the device screen, we notice incorrect details and reject the payment: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7bb/929/9cc/7bb9299cc300f35a29549f8e33497ab3.png" alt="image"><br><br>  If everything is OK, then we sign the payment order, a signature is formed, then all data is encrypted and sent to the server: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/50c/85b/19c/50c85b19cb4abee0869a16d1730971b8.png" alt="image"><br><br>  After viewing and confirming the generated signature in the CMS format: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a8/91f/d23/2a891fd2344124f982843f47446618b4.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/497/062/373/497062373803b03fe8736492073385bb.jpg" alt="image"><br><br>  Note that, depending on the security policy chosen, it is possible to cache the PIN during authorization and use this cache in the session without requesting the PIN during each operation. <br><br>  <strong><b>To conclude:</b></strong> <strong><br><br></strong>  <strong><b>The presented solution is able to maximally protect user accounts from various types of threats, including those related to remote control and document substitution.</b></strong>  <strong><b>PINPad also allows you to make secure mass payments, organize incident investigation.</b></strong> <strong><b><br></b></strong>  <strong><b>Currently, Rutoken PINPad is being supported in the most common RBS systems and a number of banks.</b></strong> </div><p>Source: <a href="https://habr.com/ru/post/216087/">https://habr.com/ru/post/216087/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216077/index.html">Storwize V5000 - IBM's new storage system</a></li>
<li><a href="../216079/index.html">Meeting with Opera tomorrow in Moscow</a></li>
<li><a href="../216081/index.html">Underwater wireless "Internet"</a></li>
<li><a href="../216083/index.html">Long-awaited trainings from Ciklum Consulting office in April, Minsk</a></li>
<li><a href="../216085/index.html">IBM and National Geographic plan to create the world's smallest magazine cover</a></li>
<li><a href="../216089/index.html">Auto-Triggered or "invisible" VPN</a></li>
<li><a href="../216091/index.html">Samsung Gear 2 Smart Watch and Gear Fit Fitness Bracelet video review</a></li>
<li><a href="../216093/index.html">Freescale reduced the size of the world's smallest microcontroller on ARM architecture</a></li>
<li><a href="../216095/index.html">STM32F429I debug board and GPS module. Get detailed information about satellites</a></li>
<li><a href="../216099/index.html">QuisyReader</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>