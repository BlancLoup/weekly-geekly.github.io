<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Budget petabytes: How to build a cheap cloud storage. part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continued. Start see here 

 Connecting the Wires: How to Assemble the Backblaze Storage Container 
 The power distribution layout of the Backblaze st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Budget petabytes: How to build a cheap cloud storage. part 2</h1><div class="post__text post__text-html js-mediator-article">  <i>Continued.</i>  <i>Start see <a href="http://habrahabr.ru/blogs/hardware/68832/">here</a></i> <br><br><h4>  Connecting the Wires: How to Assemble the Backblaze Storage Container </h4><br>  The power distribution layout of the Backblaze storage container is shown below.  Power supplies (PSUs) provide most of their power at 2 different voltages: 5V and 12V.  We use 2 PSUs in the container, since 45 drives require a lot of 5V-power, while powerful ATX PSUs transfer most of their power through the 12V bus.  This is no coincidence: 1500W and more powerful ATX PSUs are designed for powerful 3D video cards that need extra power over a 12V bus.  We could prefer 1 server power supply, but 2 ATX power supplies are cheaper. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/008/338/6b4/0083386b42ee1ef3951a738c8f1eac47.jpg" title="Server power plan diagram" alt="   "><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      BP1 feeds 3 front fans and breeder panels for ports 1, 2, 3, 4 and 7. BP2 feeds everything else.  (For a detailed list of special connectors on each power supply unit, see Appendix A).  To power the port multiplier panels, the power cables go from the power supply unit through 4 holes in the separating metal plate on which the fans are held in the center of the case (near the base of the fans) and then to the bottom side of the 9 panels.  Each panel of port multipliers on the bottom side has 2 male pins.  Hard drives require the most power at the initial spin-up of drives, so if you turn on both power supplies at the same time, there will be a large (14 amp) peak of 120V power from the outlet.  We recommend that you first turn on the BP1, wait until the disks spin up (and the power consumption drops to reasonable values), and then turn on the BP2.  Fully included, the entire container will consume approximately 4.8 amps when idle and up to 5.6 amps with high loads. <br><br>  Below is a photo of a partially assembled storage container Backblaze (click on the photo to enlarge).  The metal case below has screws facing upwards, to which we attach nylon gaskets (small white things in the photo below).  Nylon helps dampen vibration, and this is a critical aspect of server design.  The boards shown above the nylon pads are a few of the 9 breeder panels of the SATA ports, which have 1 SATA connector on the bottom, and you can insert 5 hard drives vertically into the top of the boards.  All power and SATA cables go under the port breeder panels.  One of the panels in the photo below is completely filled with hard drives to show the placement. <br><br> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/e32/846/77f/e3284677f479ea8a7cba763e7b5847ae.jpg" title="Partially assembled Backblaze server. Click to enlarge" alt="   Backblaze"></a> <br><br>  A note about the vibrations of the disks: the disks vibrate too much if you leave them standing as shown in the photo above, so we wind the ‚Äúanti-vibration sleeve‚Äù (almost rubber band) around the hard disk, between the red metal grille and the disks.  It holds the disc tightly in rubber.  We also put a large (40 cm x 42 cm x 3 mm) piece of porous material along the top of the hard drives, after all 45 are inserted into the case.  After that, the cap is screwed on top of the porous material to secure the discs.  In the future, we will devote a whole blog posting to vibrations. <br><br>  Below is the wiring diagram for SATA cables. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7d9/751/2ff/7d97512ffc31a8aca2731b7192242a49.jpg" title="SATA wiring diagram" alt="   SATA"><br><br>  4 SATA boards are inserted into the Intel motherboard: 3 dual-port SYBA boards and 1 four-port Addonics board.  9 SATA cables are connected to the top of the SATA boards and come in tandem with the power cables.  All 9 SATA cables have a length of 91 cm and use L-shaped connectors with snaps on the side of the port multiplier panels and straight connectors without snaps on the SATA side. <br><br>  A note about SATA chipsets: each of the port multiplier boards contains a Silicon Image SiI3726 chip so that 5 drives can be attached to 1 SATA port.  Each of the SYBA 2-port PCIe SATA boards contains Silicon Image SiI3132, and the Addonics 4-port PCI cards contain a Silicon Image SiI3124 chip.  We use only 3 of the 4 available ports on the Addonics boards, since we only have 9 port breeder panels.  We do not use SATA ports on the motherboard, because, despite Intel's statements about supporting port multipliers in their ICH10 Southbridge, we noticed strange results in our performance tests.  Silicon Image was a pioneer in port breeder technology, and their chips work best together. <br><br><h4>  Storage container Backblaze runs on free software </h4><br>  The Backblaze Storage Container is not a complete building block until it loads and is online.  Containers work on 64-bit Debian 4 Linux and the JFS file system, and they are self-contained devices, all of which are accessed and accessed via HTTPS.  Below you can see a diagram of the layers. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/500/d0d/c7e/500d0dc7ebe13232f50b5aef1fe7e672.jpg" title="Software Level Diagram" alt="  "><br><br>  Starting from the bottom, there are 45 hard drives available through SATA controllers.  Then we use the fdisk utility in Linux to create 1 partition per disk.  Above this, we combine 15 hard drives in 1 RAID6 volume with 2 parity disks (out of 15).  RAID6 is created by the mdadm utility.  Above this is the JFS file system, and the only access we allow for this fully self-sufficient storage building block is through HTTPS based on a special level of Backblaze program logic in Apache Tomcat 5.5.  Taking all this into account, the formatted (available) space is 87% of the raw capacity of hard drives.  One of the most important aspects here is that any read / write data to the Backblaze storage container occurs only via HTTPS.  There is no iSCSI, neither NFS, nor SQL, nor Fiber Channel.  None of these technologies scale so cheaply and reliably, cannot reach these sizes, and is not managed as easily as standalone containers, each with its own IP address, waiting for requests over HTTPS. <br><br><h4>  Backblaze Storage Container - Building Block </h4><br>  We are extremely pleased with the reliability and excellent performance of the containers, and the Backblaze storage container is a completely self-contained storage server.  But the logic of where to save data and how to encrypt it, index it, and eliminate duplication is at a higher level (beyond the scope of this posting).  When you manage a data center with thousands of hard drives, processors, motherboards and power supplies, you will have hardware failures - this is incontrovertible.  Backblaze storage containers are the building blocks on which a larger system can be built that does not allow a single point of failure.  Each container in itself is only a large piece of raw storage at a low price;  he himself is not yet the "solution." <br><br><h4>  Cloud storage: the next step </h4><br>  The first step to building a cheap cloud storage is to have a cheap storage, and above we have shown how to create your own.  If all you need is cheap storage, then that is enough.  If you need to build a cloud, then you still have to work. <br><br>  Building a cloud includes not only installing a large amount of hardware, but, importantly, deploying software to manage the hardware.  In Backblaze, we have developed programs that eliminate duplication and ‚Äúcut‚Äù data into blocks;  encrypt and transmit for backup;  reassemble, decode, re-create duplicate blocks and pack data for recovery;  Finally, they monitor and manage the entire cloud storage system.  This process is our own technology that we have been developing for years. <br><br>  You can own your own system for this process and embed the Backblaze storage container design, or maybe you are just looking for an inexpensive storage that will not be part of the cloud.  In both cases, you can freely use the storage container design described above.  If you do this, we would appreciate a link to Backblaze and welcome any insights, although this is not necessary.  Please note that since we do not sell the design or the storage containers themselves, we do not provide any support or guarantees. <br><br>  In the following series: in a few weeks we will talk about iPhone vibration sensors, design of containers like Swiss cheese, why electricity costs more traffic, and more about the design of a large cloud storage. <br><br><h4>  Thanks  We stood on the shoulders of giants. </h4><br>  The design of the storage container Backblaze would not have been possible without a huge amount of help (which was usually asked bluntly) of incredibly intelligent and generous people who answered our questions, worked with us and gave key clarifications at critical moments.  First, we thank Chris Robertson for the inspiration to build our own repository and for his early work on prototypes;  Kurt Schaefer for advice on metal processing and the concept of "furniture" for printed circuit boards;  Dominic Giampaolo of Apple Computer for his tips on hard drives, vibration and certifications;  Stuart Cheshire from Apple Computer and Nick Tingle from Alcatel-Lucent for tips on low-level networks;  Aaron Emigh (EVP &amp; GM, Core Technology) at Six Apart for his help with the original design;  Gary Orenstein for clarifying the reliability of disks and the storage industry as a whole;  Jonathan Beck for invaluable advice on vibrations, fans, cooling and housing design;  Steve Smith (Senior Design Manager), Imran Pasha (Director of Software Engineering), and Alex Chervet (Director of Strategic Marketing) from Silicon Image, who helped us debug problems with the SATA protocol and loaned 10 different SATA boards for tests;  James Lee from Chyang Fun Industries in Taiwan for developing SATA boards to simplify our design;  Western Digital's Wes Slimick, Richard Crockett, Don Shields and Robert Knowles for their help in debugging Western Digital disc logs;  Christa Carey, Jennifer Hurd and Shirley Evely from Protocase for offering hundreds of small improvements in 3-D hull design;  Chester Yeung from Central Computer for locally supplied parts quickly and permanently when it really mattered;  Mason Lee from Zippy for tips on power supplies and special cables;  as well as Angela Lai for knowing all the right people and presenting them properly. <br><br>  Finally, we thank thousands of engineers who worked for millions of hours for free so that we could get container components that are either cheap or completely free, such as an Intel processor, Gigabit Ethernet, amazingly dense hard disks, Linux, Tomcat, JFS, etc. We realize that we are standing on the shoulders of giants. <br><br><h4>  Appendix A. A detailed list of components for a Backblaze storage container. </h4><br>  <i>From the translator: Appendix A is in the form of a neat table, which I cannot reproduce using Habr's tools.</i>  <i>In addition, to translate into Russian "760 Watt Power Supply", "Qty", "Price", "Total" and "SATA II Cable" is, in my opinion, already overkill.</i>  <i>Therefore, please see the original application at the end of the <a href="http://blog.backblaze.com/2009/09/01/petabytes-on-a-budget-how-to-build-cheap-cloud-storage/" title="Petabytes on a budget: cloud storage">original English posting.</a></i> </div><p>Source: <a href="https://habr.com/ru/post/68854/">https://habr.com/ru/post/68854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68841/index.html">Yandex.Tabs</a></li>
<li><a href="../68842/index.html">Asus Eee PC 1005HA or the story of a single SSD</a></li>
<li><a href="../68843/index.html">The course of the young fighter: intercepting authentication on the routers</a></li>
<li><a href="../68849/index.html">Insanely Twisted Shadow Planet</a></li>
<li><a href="../68852/index.html">Debian GNU / Linux 5.0.3 released</a></li>
<li><a href="../68856/index.html">Build Ruby, RubyGems and Ruby on Rails in the new Snow Leopard</a></li>
<li><a href="../68857/index.html">Steering Wheel for iPhone and iPod Touch</a></li>
<li><a href="../68860/index.html">Snow Leopard: About Licenses and Pricing</a></li>
<li><a href="../68861/index.html">We wanted the best, but it turned out as always</a></li>
<li><a href="../68867/index.html">We program for Windows 7. The progress indicator on the taskbar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>