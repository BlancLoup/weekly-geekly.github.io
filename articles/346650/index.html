<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Secrets of the resource forest: how we gathered together the IT structure of VTB</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Even if you combine networks and infrastructures of at least two grocery stores, this can easily turn into a difficult task. Suddenly, various nuances...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Secrets of the resource forest: how we gathered together the IT structure of VTB</h1><div class="post__text post__text-html js-mediator-article">  Even if you combine networks and infrastructures of at least two grocery stores, this can easily turn into a difficult task.  Suddenly, various nuances related to network organization will emerge - for example, D-Link bricked up in an unknown back room, which works by pretending that it is the core of the network.  When it comes to companies of the scale of VTB and VTB24, everything goes to a new level - requirements from a huge number of departments, managers, security services are added ... We will tell about how we dealt with this under the cut. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d0/390/ea1/6d0390ea136c8556845a264157f65727.jpg"><br><a name="habracut"></a><br><br>  So, we were faced with the task of combining the infrastructures of several large companies in the context of a decent set of legacy tools that are capricious for architecture. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basis of the created infrastructure is the ‚Äúresource forest‚Äù - a system that combines an instant messenger, a single address book, portal, file service and other key resources.  Initially, the resource forest was conceived as a framework for the interaction of various legal entities in the same banking group.  For the merger of a group of companies, this option turned out to be optimal. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/efe/b7c/c95/efeb7cc95861bc82397c4a56b09aadc9.png"><br><br>  Technically, it was necessary to solve two problems: to create a common network segment where the services would be located, and to provide a single domain authentication.  And all this is painless and without disrupting the mode of operation of banks. <br><br><h2>  Network infrastructure </h2><br>  All network segments are routed in the territories of two data centers, and engineers had to combine resources.  For each bank, they created a separate segment with transparent routing, and the firewalls were already placed on the border between these segments and the internal resources of the companies themselves. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/287/650/ac6/287650ac6609235c7c2b418b002a12ba.jpg"><br><br>  Resource forest implies a separate domain and the presence of a trust relationship with the group members.  Fortunately, we managed to find a pool of network addresses, which for all merged banks do not overlap with local ones.  As a result, at the sites of two data centers, all segments of each of the banks interact transparently in a single address space.  This multi-layered structure helps ensure the most transparent routing. <br><br>  It happens that the application server needs to connect to the client, initiating a call-back in the direction of his machine.  The client may be any workstation with its peripherals, for example, a video camera.  The bank has a number of reliable, but not new legacy-applications that require such an opportunity.  We laid transparent call-back access into the architecture - it gives painless compatibility with legacy systems and helps to gradually move away from legacy in stages, without breaking the current functionality. <br><br>  The uniform address space also allowed us to avoid non-standard workarounds when working with Active Directory, due to the fact that Microsoft does not officially support the creation of trust relationships between independent servers in the presence of NAT.  We tried to work in several address spaces in the test mode, but decided to abandon the officially not supported implementation variant. <br><br>  The most interesting thing is how we organized the routing.  Puzzled for a long time, but in the end everything turned out quite simple.  The segments of each bank in the infrastructure core are VPNs spread over MPLS and present at two sites.  We planned to route between them through MPLS label import / export policies.  But together, these components refused to work harmoniously, because we have different equipment at different sites.  If you write on each problem in technical support vendor, you can disrupt all possible terms of the project (and in our case they were very short).  All this did not suit us at all.  In the end, we just made separate physical links between VPNs. <br><br>  Another difficulty was to set up rules for filtering routes between two sites - in the process of uniting VPN networks there is a possibility of unexpected ‚Äúloops‚Äù that are fraught with a fall in the network infrastructure. <br><br><h2>  Application level </h2><br>  To simplify access to services of companies from every corner of the ‚Äúresource forest‚Äù, we have implemented the concept of ‚Äúdata marts‚Äù. <br><br>  Each of the banks publishes in its network segment a set of proxies to access their tasks.  That is, in the showcase each bank publishes those applications that must be used together with other participants.  For example, VTB24 delivered a gateway to its segment for access to their VDI. <br><br>  After the gateway is activated on the firewall, the corresponding rules are opened, and users connected to the ‚Äúforest‚Äù have the opportunity to work at VTB24 virtual desktops.  We have identified "windows" for terminal and web applications.  Terminal applications are published on the Citrix farm, and for the web, technology has been used for many years in the bank.  About 70 applications are integrated with it.  It was built on the basis of the Oracle Access Manager product. <br><br>  With applications from other banks, everything is much more complicated, since they are not integrated with Access Manager.  Therefore, it was decided to put the windows running in reverse proxy mode. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/057/57e/fe9/05757efe94cf71257b64bd38b20b46ed.jpg"><br><br>  Another prerequisite was the domain authentication requested by the storefront.  For correct forwarding through it, HAProxy was chosen - free software included in the Red Hat Enterprise Server package.  This is a great finished product, with which you can do both reverse HTTP Proxy, and proxies of many other things.  You can proxy not only HTTP, but also any other traffic, including private protocols, which are used in the application for data exchange. <br><br>  Another important task that we are now solving is to bring the communication system to a single standard in our companies.  With all its conservatism, the banking sector requires very fast decision-making and well-established communications.  Now we began to use Skype for Business.  Major deployment work is almost complete. <br><br>  Between the individual servers with Skype there is a federated relationship, that is, a trusted relationship between independent peer servers.  Thanks to the integration and synchronization of accounts, you can now easily find a contact for contact.  Skype for Business is integrated with telephony and video conferencing.  You can call a regular phone with Skype and back on the PSTN if the employee has got a number in his Skype account.  If you have a headset and a video camera, you can call the meeting room from your workplace via Skype for Business.  Naturally, all types of communication must comply with strict safety standards. <br><br>  In addition to the specific tasks associated with the functioning of banks as commercial structures, in the new architecture, we simultaneously solved a lot of pressing problems.  For example, synchronization of passwords, accounts and mail. <br><br><h2>  Perspectives </h2><br>  New architecture with a resource forest is a kind of framework, the foundation for further information exchange with the group‚Äôs daughters.  This includes both applications (for example, mail) and, say, access to the portal with contacts.  In the future, based on the new architecture, standardized sets of requirements will be formed for connecting to the platform, for example, subsidiary banks.  This will help simplify the entire procedure. <br><br>  Now we have tried to provide all possible nuances of the development of the architecture and thus ensure the absence of problems with integration in the future. </div><p>Source: <a href="https://habr.com/ru/post/346650/">https://habr.com/ru/post/346650/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346640/index.html">Studying the wget command with 12 examples</a></li>
<li><a href="../346642/index.html">PHP Digest 123 (January 1 - 14, 2018)</a></li>
<li><a href="../346644/index.html">Rust: "Back to the roots"</a></li>
<li><a href="../346646/index.html">Announcement of the conference Heisenbug 2018 Piter. Make Heisenbug, not war«É</a></li>
<li><a href="../346648/index.html">What questions do you have?</a></li>
<li><a href="../346652/index.html">Parsing badoo php tasks and new test How to get an offer to London in February</a></li>
<li><a href="../346654/index.html">Game design: don't confuse the player</a></li>
<li><a href="../346656/index.html">What threatens blockchain networks: we consider attacks and methods of protection</a></li>
<li><a href="../346658/index.html">How to develop and produce IoT devices in Russia</a></li>
<li><a href="../346660/index.html">[Video] Reports from the iOS developer Red Hot Chili Apples</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>