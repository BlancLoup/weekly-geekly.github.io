<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Random RPG damage distribution</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In order to calculate the damage from an attack , tabletop role-playing games like Dungeons & Dragons use damage rolls . This is logical for a game wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Random RPG damage distribution</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/240/907/217/240907217378849086ae6905df3847cc.jpg" alt="image"><br><br>  In order to calculate the <a href="http://www.dandwiki.com/wiki/SRD:Attack_Damage">damage from an attack</a> , tabletop role-playing games like Dungeons &amp; Dragons use <abbr title="Dice rolls to determine base damage inflicted">damage rolls</abbr> .  This is logical for a game whose process is based on dice rolls.  In many computer RPGs, damage and other attributes (strength, magic points, dexterity, etc.) are calculated using a similar system. <br><br>  Usually, the <code>random()</code> call code is written first, and then the results are adjusted and adjusted to the desired behavior of the game.  This article will cover three topics: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Simple adjustments - mean and variance </li><li>  Add asymmetry - discarding results or adding critical hits </li><li>  Full freedom in setting up random numbers, unlimited opportunities for cubes </li></ol><a name="habracut"></a><br><h2>  The basics </h2><br>  This article assumes that you have a <code>random( <em>N</em> )</code> function that returns a random integer between <code>0</code> and <code>range-1</code> .  In Python, you can use <code>random.randrange( <em>N</em> )</code> .  In Javascript you can use <code>Math.floor( <em>N</em> * Math.random())</code> .  The standard C library has <code>rand() % <em>N</em></code> , but it doesn‚Äôt work well, so use another random number generator.  In C ++, you can connect <code>uniform_int_distribution(0, <em>N</em> -1)</code> to <a href="http://www.cplusplus.com/reference/random/">a random number generator object</a> .  In Java, you can create a random number generator object with <code>new Random()</code> , and then call <code>.nextInt( <em>N</em> )</code> for it.  Standard libraries in many languages ‚Äã‚Äãdo not have good random number generators, but there are many third-party libraries, for example, <a href="http://www.pcg-random.org/">PCG</a> for C and C ++. <br><br>  Let's start with one die.  This histogram shows the results of one 12-sided dice rolls: <code>1+random(12)</code> .  Since <code>random(12)</code> returns a number from 0 to 11, and we need a number from 1 to 12, we add 1 to it. On the X axis, the damage is located, on the Y axis - the frequency of receiving the corresponding damage.  For one dice, a roll of damage 2 or 12 is just as likely as a roll 7. <br><br><img src="https://habrastorage.org/web/008/b0d/845/008b0d84541e4873b04b8986f9b85ed3.png"><br><br>  To throw a few dice, it is useful to use the record used in games with dice: <i>N</i> d <i>S</i> means that you need to throw an <i>S-</i> side bone <i>N</i> times.  A roll of one 12-sided dice is recorded as sided 1d12;  <a href="http://www.wolframalpha.com/input/%3Fi%3D3d4">3d4</a> means throwing 4-sided dice three times.  In the code, this can be written as <code>3 + random(4) + random(4) + random(4)</code> . <br><br>  Let's throw two 6-sided dice (2d6) and summarize the results: <br><br><pre> <code class="cpp hljs">damage = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> each <span class="hljs-number"><span class="hljs-number">0</span></span> ‚â§ i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>: damage += <span class="hljs-number"><span class="hljs-number">1</span></span>+random(<span class="hljs-number"><span class="hljs-number">6</span></span>)</code> </pre> <br>  Results can be in the range from 2 (on both bones, 1) to 12 (on both bones, 6).  The probability of getting 7 is higher than 12. <br><br><img src="https://habrastorage.org/web/29e/436/c30/29e436c308ae4be891aaafeaad224db6.png"><br><br>  What happens if we increase the number of bones, but reduce their size? <br><br><img src="https://habrastorage.org/web/dc7/525/b40/dc7525b40a1146f3b72c73615694745f.png"><br><br><img src="https://habrastorage.org/web/470/a1c/591/470a1c591fb04209b8818642ab6fbd4d.png"><br><br><img src="https://habrastorage.org/web/209/7c4/5a2/2097c45a231746c598e758e4cd5e8a80.png"><br><br>  The most important effect - the distribution will not be <em>wide</em> , but <em>narrow</em> .  There is a second effect - the peak <em>is shifted</em> to the right.  Let's first explore the use of offsets. <br><br><h3>  Permanent offsets </h3><br>  Some of the weapons in Dungeons &amp; Dragons give bonus damage.  You can write 2d6 + 1 to indicate the bonus +1 to damage.  In some games, armor or shields reduce damage.  You can write 2d6-3, which means removing 3 points of damage (in this example, I assume that the minimum damage is 0). <br><br>  Let's try to shift the damage to the negative (to reduce the damage) or to the positive (for the damage bonus) side: <br><br><img src="https://habrastorage.org/web/689/a1e/396/689a1e3966e9465182e0b6990d03208b.png"><br><br><img src="https://habrastorage.org/web/02f/d0c/98d/02fd0c98d95e4f428568c266f7d82b0b.png"><br><br><img src="https://habrastorage.org/web/351/59b/1f6/35159b1f669542f2bc6a8e3807bcb5fa.png"><br><br><img src="https://habrastorage.org/web/2b7/3b9/166/2b73b91666fe4a4fb38481ec2cae0350.png"><br><br>  Adding damage bonus or subtracting the blocked damage, we simply shift the entire distribution to the left or to the right. <br><br><h3>  Distribution variance </h3><br>  When moving from 2d6 to 6d2, the distribution becomes <em>narrower</em> and <em>shifts</em> to the right.  As we saw in the previous section, offset is a simple shift.  Let's look at the variance of the distribution. <br><br>  Define a function for <em>N</em> consecutive <code>random( <em>S+1</em> )</code> throws <code>random( <em>S+1</em> )</code> , returning a number from <b>0</b> to <em>N * S</em> : <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rollDice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(N, S)</span></span></span><span class="hljs-function">: #  N ,       0  S value </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ‚â§ i &lt; N: value += random(S+<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value</code> </pre> <br>  Generating random numbers from 0 to 24 using several bones gives the following distribution of results: <br><br><img src="https://habrastorage.org/web/44e/890/891/44e8908919b242e8b591ce918d810fed.png"><br><br><img src="https://habrastorage.org/web/37d/468/b4e/37d468b4e89d441c82d7e72bdae5cd95.png"><br><br><img src="https://habrastorage.org/web/eae/405/309/eae405309a8047018f8289f37df10f48.png"><br><br><img src="https://habrastorage.org/web/9ba/757/582/9ba7575829fe4583ba86f0ee79c7ff8d.png"><br><br>  With an increase in the number of shots and maintaining a constant range from 0 to <em>N * S, the</em> distribution becomes <em>narrower</em> (with less variance).  More results will be near the middle of the range. <br><br>  Note: with an increase in the number of sides <em>S</em> (see pictures below) and dividing the result by <em>S, the</em> distribution approaches the <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">normal one</a> .  A simple way to randomly select from a normal distribution is <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B5%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%2591%25D0%25BE%25D0%25BA%25D1%2581%25D0%25B0_%25E2%2580%2594_%25D0%259C%25D1%258E%25D0%25BB%25D0%25BB%25D0%25B5%25D1%2580%25D0%25B0">the Box-Muller transform</a> . <br><br><h2>  Asymmetry </h2><br>  Distributions for <code>rollDice( <em>N</em> , <em>S</em> )</code> <em>symmetric</em> .  Values ‚Äã‚Äãbelow the average are as likely as values ‚Äã‚Äãabove the average.  Is this suitable for your game?  If not, there are different asymmetry techniques. <br><br><h3>  Cutting throws or throwing </h3><br>  Suppose we want the values ‚Äã‚Äãabove the average to be more frequent than the below average.  Such a scheme is rarely used for damage, but is applicable for attributes such as strength, intelligence, etc.  One of the ways to implement it is to make several throws and choose the best result. <br><br>  Let's try to roll <code>rollDice(2,20)</code> cubes and select the maximum result: <br><br><pre> <code class="cpp hljs">roll1 = rollDice(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) roll2 = rollDice(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) damage = max(roll1, roll2)</code> </pre> <br><img src="https://habrastorage.org/web/aad/d69/eaa/aadd69eaa0634eed8eac621926eb291f.png"><br><br>  When choosing the maximum of <code>rollDice(2, 12)</code> and <code>rollDice(2, 12)</code> , we will get a number from 0 to 24. Another way to get a number from 0 to 24 is to use <code>rollDice(1, 12)</code> three times and select the best two of three results.  The form will be even more asymmetric than when choosing one of two <code>rollDice(2, 12)</code> : <br><br><pre> <code class="cpp hljs">roll1 = rollDice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>) roll2 = rollDice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>) roll3 = rollDice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>) damage = roll1 + roll2 + roll3 #   : damage = damage - min(roll1, roll2, roll3)</code> </pre> <br><img src="https://habrastorage.org/web/17d/c76/427/17dc7642782743c49bde1aa6eca3a469.png"><br><br>  Another way is to transfer the lowest result.  In general, it is similar to the previous approaches, but slightly different in implementation: <br><br><pre> <code class="cpp hljs">roll1 = rollDice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) roll2 = rollDice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) roll3 = rollDice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) damage = roll1 + roll2 + roll3 #      : damage = damage - min(roll1, roll2, roll3) + rollDice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)</code> </pre> <br><img src="https://habrastorage.org/web/a68/019/59f/a6801959fc634bf2a2bacdf415314632.png"><br><br>  Any of these approaches can be used for inverse asymmetry, making the values ‚Äã‚Äãmore frequent less than the average.  We can also assume that the distribution creates random bursts of high values.  This distribution is often used for damage and rarely for attributes.  Here <code>max()</code> we change to <code>min()</code> : <br><br><pre> <code class="cpp hljs">roll1 = rollDice(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>) roll2 = rollDice(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>) damage = min(roll1, roll2)</code> </pre> <br><img src="https://habrastorage.org/web/b03/0af/f0c/b030aff0ce884214b216e397317c997b.png"><br>  <i>Drop the largest of two shots.</i> <br><br><h3>  Critical hits </h3><br>  Another way to create random high damage bursts is to implement them more directly.  In some games, a certain bonus gives a "critical hit".  The simplest bonus is extra damage.  In the code below, the damage from critical hit is added in 5% of cases: <br><br><pre> <code class="cpp hljs">damage = rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random(<span class="hljs-number"><span class="hljs-number">100</span></span>) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>: damage += rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)</code> </pre> <br><img src="https://habrastorage.org/web/a8e/8ef/95c/a8e8ef95c1044bc8ba5034bc38008bc7.png"><br>  <i>Critical damage rate 5%</i> <br><br><img src="https://habrastorage.org/web/2a6/6dd/b2c/2a66ddb2c42e4eedac045f3a0617ee08.png"><br>  <i>Critical damage rate 60%.</i> <br><br>  In other approaches to adding asymmetry, additional attacks are used: during critical strikes, there is a chance that additional critical blows will trigger;  during critical strikes, the second attack is triggered, breaking through the defense;  during critical strikes, the enemy misses the attack.  But in this article I will not consider the distribution of damage in multiple attacks. <br><br><h3>  Let's try to create our own distribution. </h3><br>  When using randomness (damage, attributes, etc.), we must begin with a description of the distribution characteristics that we need for the game process: <br><br><ul><li>  <strong>Interval:</strong> what are the minimum and maximum values ‚Äã‚Äã(if any)?  Use scaling and offset to fit the distribution in this interval. </li><li>  <strong>Dispersion:</strong> how often should the values ‚Äã‚Äãbe close to the mean?  You can use fewer shots for more variance or more for less variance. </li><li>  <strong>Asymmetry:</strong> Do I need to more often meet the values ‚Äã‚Äãof more or less than the average?  Use min, max or critical bonuses to add asymmetry to the distribution. </li></ul><br>  Here are a couple of examples with some of the parameters: <br><br><pre> <code class="cpp hljs">value = <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) # Min  : value = min(value, <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) # Max  : value = max(value, <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) #  : <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random(<span class="hljs-number"><span class="hljs-number">100</span></span>) &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>: value += <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)</code> </pre> <br><br><pre> <code class="cpp hljs">value = <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) # Min  : value = min(value, <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>))</code> </pre> <br><img src="https://habrastorage.org/web/d33/cde/ead/d33cdeead5a74951819394ea7fc1292e.png"><br><br><pre> <code class="cpp hljs">value = <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) # Max  : value = max(value, <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) #  : <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random(<span class="hljs-number"><span class="hljs-number">100</span></span>) &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>: value += <span class="hljs-number"><span class="hljs-number">0</span></span> + rollDice(<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)</code> </pre> <br><img src="https://habrastorage.org/web/9e7/85f/7f4/9e785f7f4072416dba2589c1ec67c1e3.png"><br><br>  There are many other ways of structuring random numbers, but I hope these examples gave an idea of ‚Äã‚Äãhow flexible the system is already.  It‚Äôs also worth looking at <a href="http://www.avanderw.co.za/dice-distributions/">this damage roll calculator</a> .  However, sometimes a combination of dice rolls is not enough. <br><br><h2>  Arbitrary forms </h2><br>  We started with <em>input</em> algorithms and studying the corresponding <em>output</em> distributions.  We had to go through a lot of input algorithms to find the result we needed.  Is there a more direct way to get the right algorithm?  <em>Yes!</em> <br><br>  <strong>Let's do the opposite</strong> and start with the output we need, presented in the form of a histogram.  Let's try to do it with a simple example. <br><br>  Suppose I need to choose from 3, 4, 5, and 6 in the following proportions: <br><br><img src="https://habrastorage.org/web/b2e/b16/739/b2eb167395144c6588f94089dd6f5160.png"><br><br>  It does not correspond to anything that can be obtained by throwing bones. <br><br>  How to write code for these results? <br><br><pre> <code class="cpp hljs">x = random(<span class="hljs-number"><span class="hljs-number">30</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">40</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>: value = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span>: value = <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span>+<span class="hljs-number"><span class="hljs-number">10</span></span>: value = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: value = <span class="hljs-number"><span class="hljs-number">6</span></span></code> </pre> <br>  Examine this code and figure out how it works before proceeding to the next steps.  Let's make the code more general so that it can be used for different probability tables.  The first step is to create the table: <br><br><pre> <code class="cpp hljs">damage_table = [ #  (, ) (<span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), (<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), (<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>), ];</code> </pre> <br>  In this hand-written code, each <code>if</code> construct compares <code>x</code> with the <em>total</em> amount of probabilities.  Instead of writing separate <code>if</code> constructions with manually set amounts, we can cycle through all the records in the table: <br><br><pre> <code class="cpp hljs">cumulative_weight = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (weight, result) in table: cumulative_weight += weight <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; cumulative_weight: value = result <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre> <br>  The last thing to summarize is the sum of the table entries.  Let's calculate the sum and use it to select a random x: <br><br><pre> <code class="cpp hljs">sum_of_weights = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (weight, value) in table: sum_of_weights += weight x = random(sum_of_weights)</code> </pre> <br>  Combining everything together, we can write a function to search for results in the table and a function to select a random result (you can turn them into methods of the damage table class): <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lookup_value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(table, x)</span></span></span><span class="hljs-function">: # ,  0 ‚â§ x &lt; sum_of_weights cumulative_weight </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (weight, value) in table: cumulative_weight += weight <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; cumulative_weight: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value function roll(table): sum_of_weights = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (weight, value) in table: sum_of_weights += weight x = random(sum_of_weights) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lookup_value(damage_table, x)</code> </pre> <br>  The code for generating numbers from a table is very simple.  It was fast enough for my tasks, but if the profiler reports that it is too slow, try speeding up the linear search with a binary / interpolation search, lookup tables, or <a href="http://www.keithschwarz.com/darts-dice-coins/">a pseudonymity method</a> .  See also <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25BF%25D1%2580%25D0%25B5%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">inverse transform method</a> . <br><br><h3>  Draw your own distribution </h3><br>  This method is convenient because it allows you to use <em>any</em> form. <br><br><img src="https://habrastorage.org/web/3b3/5a3/d8f/3b35a3d8fb5d42c8bfc52b090c6a2c13.png"><br><br><pre> <code class="cpp hljs">damage_table = [(<span class="hljs-number"><span class="hljs-number">53</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">63</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>), (<span class="hljs-number"><span class="hljs-number">75</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>), (<span class="hljs-number"><span class="hljs-number">52</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>), (<span class="hljs-number"><span class="hljs-number">47</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>), (<span class="hljs-number"><span class="hljs-number">43</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>), (<span class="hljs-number"><span class="hljs-number">37</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>), (<span class="hljs-number"><span class="hljs-number">38</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>), (<span class="hljs-number"><span class="hljs-number">35</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>), (<span class="hljs-number"><span class="hljs-number">35</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>), (<span class="hljs-number"><span class="hljs-number">33</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>), (<span class="hljs-number"><span class="hljs-number">33</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>), (<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">13</span></span>), (<span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>), (<span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>), (<span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>), (<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">17</span></span>), (<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>), (<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">19</span></span>), (<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>), (<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">21</span></span>), (<span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>), (<span class="hljs-number"><span class="hljs-number">31</span></span>,<span class="hljs-number"><span class="hljs-number">23</span></span>), (<span class="hljs-number"><span class="hljs-number">33</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>), (<span class="hljs-number"><span class="hljs-number">36</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>), (<span class="hljs-number"><span class="hljs-number">40</span></span>,<span class="hljs-number"><span class="hljs-number">26</span></span>), (<span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">27</span></span>), (<span class="hljs-number"><span class="hljs-number">82</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>), (<span class="hljs-number"><span class="hljs-number">81</span></span>,<span class="hljs-number"><span class="hljs-number">29</span></span>), (<span class="hljs-number"><span class="hljs-number">76</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>), (<span class="hljs-number"><span class="hljs-number">68</span></span>,<span class="hljs-number"><span class="hljs-number">31</span></span>), (<span class="hljs-number"><span class="hljs-number">60</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>), (<span class="hljs-number"><span class="hljs-number">54</span></span>,<span class="hljs-number"><span class="hljs-number">33</span></span>), (<span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">34</span></span>), (<span class="hljs-number"><span class="hljs-number">44</span></span>,<span class="hljs-number"><span class="hljs-number">35</span></span>), (<span class="hljs-number"><span class="hljs-number">39</span></span>,<span class="hljs-number"><span class="hljs-number">36</span></span>), (<span class="hljs-number"><span class="hljs-number">37</span></span>,<span class="hljs-number"><span class="hljs-number">37</span></span>), (<span class="hljs-number"><span class="hljs-number">34</span></span>,<span class="hljs-number"><span class="hljs-number">38</span></span>), (<span class="hljs-number"><span class="hljs-number">32</span></span>,<span class="hljs-number"><span class="hljs-number">39</span></span>), (<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>), (<span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">41</span></span>), (<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">42</span></span>), (<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">43</span></span>), (<span class="hljs-number"><span class="hljs-number">21</span></span>,<span class="hljs-number"><span class="hljs-number">44</span></span>), (<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span>), (<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">46</span></span>), (<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">47</span></span>), (<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">48</span></span>), (<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">49</span></span>), (<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">50</span></span>)]</code> </pre> <br>  With this approach, we can choose a distribution that matches any game process that is not limited to the distributions created by the roll of the dice. <br><br><h2>  Conclusion </h2><br>  Random damage rolls and random attributes are implemented simply.  You, as a game designer, must choose the properties that the final distribution will have.  If you use dice rolls: <br><br><ul><li>  To control the variance, use the <em>number of</em> shots.  A small amount corresponds to a high dispersion, and vice versa. </li><li>  To control the scale, use the <em>offset</em> and <em>bone size</em> .  If you want random numbers to be in the range from <em>X</em> to <em>Y</em> , then for each of the <em>N</em> shots a random number from 0 to <em>(YX) / N</em> should be obtained, after which <em>X is</em> added to it.  Positive shifts can be used for damage bonuses or attribute bonuses.  Negative offsets can be used to block damage. </li><li>  For more frequent values ‚Äã‚Äãgreater or less than the average, use <em>asymmetry</em> .  For attribute throws, values ‚Äã‚Äãmore often than the average are required, they can be obtained by choosing the maximum, the best of the three, or moving the minimum value.  For damage rolls, values ‚Äã‚Äãthat are often lower than the average are required, they can be obtained by choosing the minimum or critical bonuses.  For the complexity of random encounters with enemies, values ‚Äã‚Äãbelow average are also often used. </li></ul><br>  Think about how the distribution should vary in your game.  Attack bonuses, damage blocking, and critical hits can be used to vary the distribution with simple parameters.  These parameters can be associated with objects in the game.  Use the sandbox in the <a href="http://www.redblobgames.com/articles/probability/damage-rolls.html">original article</a> to see how these parameters affect the distribution.  Think about how the distribution should work when you increase the level of the player;  See on <a href="http://rpg.stackexchange.com/questions/91264/what-dice-mechanic-gives-a-bell-curve-distribution-that-narrows-and-increases-me">this page for</a> information on increasing and decreasing variance over time when calculating distributions using <a href="http://anydice.com/">AnyDice</a> (about which there is <a href="http://anydice.com/articles/">an excellent blog</a> ). <br><br>  Unlike board game players with dice, you are not limited to distributions based on sums of random numbers.  Using the code written in the section ‚ÄúLet's try to create your own distribution‚Äù, <em>you can use any distribution</em> .  You can write a visual tool that allows you to draw histograms, save data to tables, and then draw random numbers based on this distribution.  You can change the table in JSON or XML.  You can also edit tables in Excel and export them to CSV.  Distributions without parameters provide more flexibility, and using data tables instead of code allows you to perform quick iterations without recompiling the code. <br><br>  There are many ways to implement interesting probability distributions based on simple code.  First, determine the properties that you need, and then select the code for them. </div><p>Source: <a href="https://habr.com/ru/post/335840/">https://habr.com/ru/post/335840/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335828/index.html">Download photos from Instagram using the Vkontakte bot</a></li>
<li><a href="../335830/index.html">On the quality of requirements in IT projects, to be honest (from the standpoint of the development team). Part 1</a></li>
<li><a href="../335834/index.html">DDD in practice. Design a wish list</a></li>
<li><a href="../335836/index.html">How to write normal texts in English, not being a native speaker</a></li>
<li><a href="../335838/index.html">Overview of C ++ deep learning libraries Apache.SINGA, tiny-dnn, OpenNN</a></li>
<li><a href="../335842/index.html">Everything is relative, or the implementation of one simple task in python and tcl</a></li>
<li><a href="../335844/index.html">Automate workflow with the new platform. Part 1. Office. Work with "Incoming Documents"</a></li>
<li><a href="../335846/index.html">Logs as part of the product. How GrayLog Impacted Quality</a></li>
<li><a href="../335848/index.html">MIPSfpga - practical experience</a></li>
<li><a href="../335850/index.html">Taxes on IT-business in Russia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>