<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We connect the "domestic" LCD 16x2 MT-16S2S by SPI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The trend of import substitution pushed to test the character LCD indicator from the company MELT. We took the MT-16S2S on ST7070. In some ways, this ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We connect the "domestic" LCD 16x2 MT-16S2S by SPI</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/246/bc1/f9e/246bc1f9e3fb4d1aa8f5b4d1ecc5aca2.jpg"><br><br>  The trend of import substitution pushed to test the character LCD indicator from the company MELT.  We took the <a href="http://www.melt.com.ru/docs/MT-16S2S.pdf">MT-16S2S</a> on ST7070.  In some ways, this is an analogue of the well-known WH-1602 at 44780. And it also supports SPI mode. <br><br>  MELT also collects displays on the domestic controller KB1013VG6 from Integral.  It has a difference in operation in 4-bit mode from the already standard 44780. <br><a name="habracut"></a><br>  On the manufacturer's website there is an example of code for working in different modes.  But it is written in assembler and under an abstract platform in a vacuum.  Redoing it on the STM - anyway, what to write again.  The experience of using ready-made libraries even for the common 44780 I, too, cannot be called positive.  They have to edit for a long time under the desired platform and controller model.  And most of them use the delay function under AVR, which ‚Äúfor some reason‚Äù is not provided for STM.  And even what started up, works very badly, then deducing it, then hanging.  Therefore, it was decided to write your own library. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In addition, the MT-16S2S has another feature: the SPI interface, which reduces the number of controller legs used to 4. So, the output will be organized through SPI. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7d9/81f/bcf/7d981fbcffac47de9590c44a473d7050.PNG"></div><br>  The command system is described in some detail.  In general, in the whole present situation, when there is almost no domestic electronics in life, I am very pleased, although it is unusual, to read the description of microchips and other products in Russian (not translated from English or Chinese like ‚ÄúBalsam tiger white drops death construction protein‚Äù).  True, sometimes there are such pearls that you think ‚Äúit would be better in English‚Äù.  But here it is all right. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/92e/1c9/04a/92e1c904a29147dba1b7428acd3b8054.PNG"></div><br>  Connection is almost standard.  VCC, E, D0-D4 on plus power, A0, GND, R / W and PSB to ground;  Connect to the controller: D5‚Äì to CS, D6‚Äì to SCK, D7 ‚Äì to MOSI, XRES‚Äì to any GPIO.  I connected to MISO, because  I still manage it programmatically.  On the website in the description, by the way, the wrong scheme is shown.  It is indicated that the D5 pulls up to the power plus, but this is CS.  The forum wrote that they know about it, but so far nothing has been fixed. <br><br>  The outputs for the backlight can be left free, but it is better, of course, to work with the backlight, and to do this, connect the anode through a 10-30 ohm resistor to the power supply and the cathode to the ground.  The output for contrast control, oddly enough, on the 5-volt indicator does not control anything.  I just left him hanging in the air. <br><br>  Another interesting feature is the presence of two pages of character generator.  Because of this, you can display on the display a huge amount of <s>unknown garbage a</s> wide variety of characters. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2fe/da6/c3b/2feda6c3bcb34bae94f8d9b5065cce3e.PNG"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a0b/c09/9ae/a0bc099ae8d6445f88bcd5a572d26372.PNG"></div><br>  But if you chose the "domestic" display to work with the Cyrillic alphabet, a surprise awaits you.  Russian letters that do not have analogues in Latin, located on the first page.  And the numbers and Latin - at zero.  And to bring them together, you have to switch between pages.  So no whole line output will work. <br><br>  In this respect, the display from Winstar is more convenient.  Let him not so many characters, but they are on the same page. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0b0/969/8dd/0b09698dd0fc49679571b3a909ab541f.PNG"></div><br>  But 90% of the MT-16S2S character generator will not be needed by the Russian person.  Another trouble for the programmer is the designation in the datasheet of the coordinates of the characters in the table with ones and zeros by nibbles.  It is even more fun to designate them as H and L. That is, the symbol number will be, for example, 1111 + 1101 or HHHH + HHLH. <br><br>  Why not use a developer-friendly hexadecimal code 0xFD?  And after all on some displays such tables are.  Is it really so difficult to make a convenient grid? <br><br>  Now about the library.  The following requirements were for functionality: <br><br>  1. Output a symbol from the table to an arbitrary position; <br>  2. Displaying a line of text in an arbitrary position; <br>  3. Write to the memory of your own character; <br>  4. Cleaning the display, turning the cursor on and off, its shift, shift of the display area and other indicator settings. <br><br>  All this managed to be implemented fairly quickly.  But still straining the need to constantly switch between the pages of character generator when using Cyrillic.  I do not post the library itself, because it is made ‚Äúfor myself‚Äù.  With all the flaws and crutches and for a specific chip: with wired ports and frequencies (since the goal was not to create a commercial version with card games and women, the port settings, SPI and delays are spelled out directly in the functions themselves, depending on which controller and to which SPI the display is connected).  In the future, its finalization is planned. <br><br>  Now about the operating experience of the display.  It has been tested and works stably in the temperature range from -20 ¬∞ C to + 60 ¬∞ C.  True, at -20 ¬∞ C begins to slow down when changing images.  But there's nothing you can do.  Just switch to another type of indicator. <br><br>  In general, the impression is positive.  Some minor bugs in the description of the display and the absence of normal code examples interfere.  The rest is not bad.  Even the price is not higher than the Winstar equivalent of WH-1602. </div><p>Source: <a href="https://habr.com/ru/post/397977/">https://habr.com/ru/post/397977/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../397965/index.html">How the Universe will die</a></li>
<li><a href="../397967/index.html">HyperX on "Igromir": tons of prizes and quest in Telegram</a></li>
<li><a href="../397969/index.html">Programmable chips help Microsoft optimize the performance of its cloud services.</a></li>
<li><a href="../397971/index.html">Donkey Kong and I</a></li>
<li><a href="../397975/index.html">Ultra-budget spot welding of lithium batteries at home</a></li>
<li><a href="../397979/index.html">This is not a race, this is an ultramarathon: the spread of cryptotechnologies</a></li>
<li><a href="../397981/index.html">Apple Pay launch in Russia</a></li>
<li><a href="../397983/index.html">Man of the future</a></li>
<li><a href="../397985/index.html">External FOBO tire pressure sensors will always help</a></li>
<li><a href="../397987/index.html">PR campaign No Man's Sky will check the British Agency for Advertising Standards</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>