<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Output video from multiple webcams on one page</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once I was depressed, I didn‚Äôt want to do anything, and then I remembered that as a child I strongly wanted to have a video monitoring console like so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Output video from multiple webcams on one page</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/db0/654/429/db065442997c43b3aa64862662af4177.GIF" align="left">  Once I was depressed, I didn‚Äôt want to do anything, and then I remembered that as a child I strongly wanted to have a video monitoring console like some villain in a movie who sits in a dark room and laughs watching helpless people who are trying to find a way out.  Well, having refreshed my childhood memories, I decided to bring them to life, well, that part with the monitoring console, without the little people.  And here my friend was HTML5 leaps and bounds, or rather the <b>Stream API</b> . <br>  Since I had previously used <b>getUserMedia</b> to capture sound from a microphone, I thought that there would be no problems with the video either, but they still got out into the light.  Those.  There were no problems with the capture of the video stream, but with the simultaneous output of data from several sources on one page it turned out to be not so simple as we wanted. <br><br>  So, let's start from the very beginning, namely from capturing and outputting video from one source.  For this we will use the <b>getUserMedia function</b> , which is supported in all normal browsers of older versions ( <a href="http://caniuse.com/">Stream API</a> ), well, of course, except for IE. <br><a name="habracut"></a><br><br>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Explanations </h2><br><ul><li>  All code examples below will be written in <b>angularjs</b> , for now I am writing on it. </li><li>  All scripts will be written to work with Chrome and Opera browsers, below will be written why. </li></ul><br><br><h2>  getUserMedia </h2><br>  To access the webcam, you need to request permission from the user, and then <b>getUserMedia</b> comes on the scene, it takes three arguments: <br><ul><li>  <b><a href="https://developer.mozilla.org/en-US/docs/NavigatorUserMedia.getUserMedia">constraints</a></b> - here we indicate what type of data we want to access.  We will look at it below in more detail; </li><li>  <b>successCallback</b> - the function returns a <b>LocalMediaStream</b> object, this is our stream from the camera; </li><li>  <b>errorCallback</b> - the function works if an error occurs when trying to capture a stream or if the user refuses to provide access to his device. </li></ul><br>  As a means of output, we will use the <b>video</b> element, in the <b>src</b> attribute of which the <a href="http://www.html5rocks.com/en/tutorials/workers/basics/">URL element in the Blob format</a> from the <b>LocalMediaStream</b> object will be passed. <br>  As a result, the simplest function for capturing a stream will look like this: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   navigator.webkitGetUserMedia({'video': true}, function (stream) { var video = document.createElement("video"); video.src = window.URL.createObjectURL(stream); video.controls = true; video.play(); angular.element(document.querySelector('body')).append(video); }, function (e) { alert("    !"); });</span></span></code> </pre> <br>  Here the following happens: <br><ol><li>  We create a <b>video</b> element; </li><li>  With the help of f-and <b><a href="https://developer.mozilla.org/en-US/docs/Web/API/URL.createObjectURL">createObjectURL</a></b> from the <b><a href="https://developer.mozilla.org/en-US/docs/Web/API/URL.createObjectURL">LocalMediaStream</a></b> object <b>,</b> we create a URL element of type Blob, which we transmit as the source to the <b>video</b> element; </li><li>  Allow autoplay; </li><li>  Insert our created item on the page. </li></ol><br>  The task is at least solved, we brought the stream from one camera to our page.  Now we need to output streams from the rest of our cameras. <br><br><h2>  MediaStreamTrack </h2><br>  Of course, in trying to solve my problem, I turned for help to the object <b><a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack">MediaStreamTrack</a></b> , which is an interface for working with streams from all multimedia devices that the browser could reach.  <b>MediaStreamTrack</b> is still quite a rare beast and is found in the latest versions of <b>Chrome</b> , <b>Opera</b> and <b>Firefox</b> .  So why do we need him?  And then, to get information about data sources. <br><br>  In general, we groped the clue to solve our problem.  Only I felt the joy of a dream coming true, as I realized that I could not get all the sources at once for their withdrawal.  After a hysterical search for a solution, it was found that in <b>Chrome</b> and <b>Opere, the</b> object <b>MediaStreamTrack</b> has the <b>function getSources</b> , which is our salvation.  As the name implies, this function returns an object that contains information about all sources of audio and video. <br><br>  Well, let's find our cameras: <br><br><pre> <code class="javascript hljs">getMediaSources: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mediaSources = []; MediaStreamTrack.getSources(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sources</span></span></span><span class="hljs-function">) </span></span>{ an.forEach(sources, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">val, key</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sources[key].kind === <span class="hljs-string"><span class="hljs-string">'video'</span></span>) { mediaSources.push(val); } }); }); }</code> </pre><br>  The <b>sources</b> object provided to us by the <b>getSources function</b> is an array of objects with information about data sources.  Each of these objects contains the following information: <br><ul><li>  <b>id</b> - the unique identifier of the source, generated by the browser; </li><li>  <b>kind</b> - the type to which the source belongs ( <b>audio</b> or <b>video</b> ); </li><li>  <b>label</b> - device label (source), in my case there was a <b>USB Video Device</b> ; </li><li>  <b>facing</b> - as I understand it, the parameter is relevant only for mobile platforms and points to the front and rear camera (Accepts two values <b>User</b> - front camera and <b>environment</b> - rear camera). </li></ul><br><h2>  Decision </h2><br>  Thus, to summarize what we can now do.  We can get a list of all sources with source identifiers, as well as we can intercept data from them and output.  It remains only to put it all together, and we get what we wanted. <br><br>  We will have the following sequence of actions: <br><ol><li>  When you load the page with the help of f-and <b>MediaStreamTrack.getSources,</b> we determine all the sources of the video signal; </li><li>  We list the sources on the page.  We do this so that we still have to give permission to access each camera.  This can be avoided if the page works through <b>https</b> </li><li>  When you click on any source from the list, we intercept data from it using <b>GetUserMedia</b> , create a <b>video</b> element for it and display it.  (If we select the same source several times, then a copy of the stream will be simply made) </li></ol><br>  Before giving the final working example, we‚Äôll go back to the f-and <b>webkitGetUserMedia</b> , namely its first <b><a href="https://developer.mozilla.org/en-US/docs/NavigatorUserMedia.getUserMedia">constraints</a></b> argument.  The documentation says that source types are transferred there in the format: <br><br><pre> <code class="javascript hljs">{<span class="hljs-string"><span class="hljs-string">"video"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-string"><span class="hljs-string">"audio"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>}</code> </pre><br>  This is obviously not enough for us, because we need to at least pass the source identifier.  It turns out that instead of the standard object you can pass the so-called restrictive object.  Thanks to him, we can adjust quite a lot of parameters, such as frame rate and resolution. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> constraints = {}; constraints.video = { <span class="hljs-attr"><span class="hljs-attr">mandatory</span></span>: { <span class="hljs-attr"><span class="hljs-attr">minWidth</span></span>: <span class="hljs-number"><span class="hljs-number">640</span></span>, <span class="hljs-attr"><span class="hljs-attr">minHeight</span></span>: <span class="hljs-number"><span class="hljs-number">480</span></span>, <span class="hljs-attr"><span class="hljs-attr">minFrameRate</span></span>: <span class="hljs-number"><span class="hljs-number">30</span></span> }, <span class="hljs-attr"><span class="hljs-attr">optional</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">sourceId</span></span>: sourceid } ] };</code> </pre><br>  Our facility is divided into two parts: <br><ul><li>  <b>mandatory</b> - here you can see the mandatory restrictions for our video and, if they cannot be met, an exception will be thrown. </li><li>  <b>optional</b> - these are not mandatory parameters that, if possible, will be applied to the stream (i.e., if we indicate here that we want to have a video signal with an output frequency of not 30, but 60, at the output, and our camera provides such a stream, then we we will get what we want, and if the camera does not satisfy the conditions, the video will be output at a frequency of 30 frames, which will correspond to the value of the <b>minFrameRate</b> parameter in the <b>mandatory</b> block). </li></ul><br>  Of the parameters that can be customized, I found these: <br><ul><li>  <b>frameRate</b> - frame rate </li><li>  <b>aspectRatio</b> - aspect ratio </li><li>  <b>minWidth</b> - minimum width </li><li>  <b>minHeight</b> - minimum height </li><li>  <b>sourceId</b> - unique source identifier </li><li>  <b>width</b> </li><li>  <b>height</b> </li></ul><br>  Now everything is ready to write the final version of our module: <br><div class="spoiler">  <b class="spoiler_title">Module code</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Created by abaddon on 11.09.14. */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*global window, document, angular, MediaStreamTrack, console, navigator */</span></span> (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">w, d, an, mst, nav</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; angular.module(<span class="hljs-string"><span class="hljs-string">"camersRoom"</span></span>, []). value(<span class="hljs-string"><span class="hljs-string">"$sectors"</span></span>, {}). directive(<span class="hljs-string"><span class="hljs-string">"ngVideoSector"</span></span>, [<span class="hljs-string"><span class="hljs-string">'$sectors'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$sectors</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">restrict</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">link</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">scope, elem, attr</span></span></span><span class="hljs-function">) </span></span>{ $sectors[attr.ngVideoSector] = elem; } }; }]). directive(<span class="hljs-string"><span class="hljs-string">"ngRoomPlace"</span></span>, [<span class="hljs-string"><span class="hljs-string">"$room"</span></span>, <span class="hljs-string"><span class="hljs-string">"$sectors"</span></span>, <span class="hljs-string"><span class="hljs-string">"$compile"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$room, $sectors, $compile</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">restrict</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">controller</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$scope, $element</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.createViews = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">html</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> videoBlock = $sectors.rec, content; videoBlock.append(html); content = videoBlock.contents(); $compile(content)($scope); }; }, <span class="hljs-attr"><span class="hljs-attr">link</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">scope, elem, attr, cont</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($room.support) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mediaSources = [], html, count; $room.getMediaSources().then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sources</span></span></span><span class="hljs-function">) </span></span>{ an.forEach(sources, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">val, key</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sources[key].kind === <span class="hljs-string"><span class="hljs-string">'video'</span></span>) {<span class="hljs-comment"><span class="hljs-comment">/*find only video devices.    */</span></span> mediaSources.push(val); } }); count = mediaSources.length; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count) { html = $room.createSourcePreview(mediaSources); cont.createViews(html); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { scope.error = { <span class="hljs-attr"><span class="hljs-attr">show</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">"       !"</span></span> }; } <span class="hljs-comment"><span class="hljs-comment">/*create video block views.*/</span></span> }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { scope.error = { <span class="hljs-attr"><span class="hljs-attr">show</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">" ,      .  Google Chrome"</span></span> }; } } }; }]). factory(<span class="hljs-string"><span class="hljs-string">"$room"</span></span>, [<span class="hljs-string"><span class="hljs-string">"$q"</span></span>, <span class="hljs-string"><span class="hljs-string">"$sectors"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$q, $sectors</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Room = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> methods = { get support() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.media; }, set support(value) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.media = value; } }; an.extend(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, methods); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.support = mst.getSources; }; Room.prototype = { <span class="hljs-attr"><span class="hljs-attr">_createVideoElement</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stream</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> video = d.createElement(<span class="hljs-string"><span class="hljs-string">"video"</span></span>); video.src = w.URL.createObjectURL(stream); video.controls = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; video.play(); $sectors.place.append(video); }, <span class="hljs-attr"><span class="hljs-attr">getMediaSources</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{<span class="hljs-comment"><span class="hljs-comment">/*get all media sources.    ,  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defer = $q.defer(); mst.getSources(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sources</span></span></span><span class="hljs-function">) </span></span>{ defer.resolve(sources); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> defer.promise; }, <span class="hljs-attr"><span class="hljs-attr">createSourcePreview</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mediaSources</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> htmlString = <span class="hljs-string"><span class="hljs-string">''</span></span>, i = <span class="hljs-number"><span class="hljs-number">0</span></span>; an.forEach(mediaSources, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">val</span></span></span><span class="hljs-function">) </span></span>{ i++; htmlString += <span class="hljs-string"><span class="hljs-string">'&lt;button class="video-preview" ng-click="startBroadcast($event)" id="'</span></span> + val.id + <span class="hljs-string"><span class="hljs-string">'"&gt; '</span></span> + i + <span class="hljs-string"><span class="hljs-string">'&lt;/button&gt;'</span></span>; }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> htmlString; }, <span class="hljs-attr"><span class="hljs-attr">addVideoPlace</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sourceid</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> constraints = {}; constraints.video = { <span class="hljs-attr"><span class="hljs-attr">mandatory</span></span>: { <span class="hljs-attr"><span class="hljs-attr">minWidth</span></span>: <span class="hljs-number"><span class="hljs-number">640</span></span>, <span class="hljs-attr"><span class="hljs-attr">minHeight</span></span>: <span class="hljs-number"><span class="hljs-number">480</span></span>, <span class="hljs-attr"><span class="hljs-attr">minFrameRate</span></span>: <span class="hljs-number"><span class="hljs-number">30</span></span> }, <span class="hljs-attr"><span class="hljs-attr">optional</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">sourceId</span></span>: sourceid } ] }; nav.webkitGetUserMedia(constraints, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">stream</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._createVideoElement(stream); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>), <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ alert(<span class="hljs-string"><span class="hljs-string">"     !"</span></span>); }); } }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Room(); }]); }(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>, angular, MediaStreamTrack, navigator));</code> </pre><br></div></div><br><br>  I will not give the code of the <b>html</b> template.  Everything can be viewed on the <a href="http://angular.demosite.pro/camersroom/">demo</a> and on <a href="https://github.com/abaddonGIT/camersRoom">github</a> . <br><br>  That's all, thank you for your attention, and I hope that this article will be useful to someone. <br><br>  Well, of course, the list of references: <br><ul><li>  <a href="http://www.w3.org/TR/mediacapture-streams/">www.w3.org/TR/mediacapture-streams</a> </li><li>  <a href="http://www.blaccspot.com/blog/webrtc/tutorials/getusermedia-with-resolution-constraints-tutorial/">www.blaccspot.com/blog/webrtc/tutorials/getusermedia-with-resolution-constraints-tutorial</a> </li><li>  <a href="https://developer.mozilla.org/en-US/docs/Web/API">developer.mozilla.org/en-US/docs/Web/API</a> </li><li>  <a href="http://www.sitepoint.com/introduction-getusermedia-api/">www.sitepoint.com/introduction-getusermedia-api</a> </li><li>  <a href="http://w3c.github.io/mediacapture-main/getusermedia.html">w3c.github.io/mediacapture-main/getusermedia.html#idl-def-Constraints</a> </li><li>  <a href="http://muaz-khan.blogspot.ru/">muaz-khan.blogspot.ru</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/236699/">https://habr.com/ru/post/236699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236685/index.html">Reasons for failing to achieve goals</a></li>
<li><a href="../236687/index.html">Ice Bucket Challenge: engagement lessons</a></li>
<li><a href="../236689/index.html">Automatic optimization of algorithms using fast exponentiation of matrices</a></li>
<li><a href="../236693/index.html">Flight to Mars: non-Gomanov trajectory, aero braking and landing difficulties in a rarefied atmosphere</a></li>
<li><a href="../236697/index.html">Quick access to map by key row</a></li>
<li><a href="../236701/index.html">Available pre-order microcomputer Edison board for the Internet of things from Intel</a></li>
<li><a href="../236703/index.html">Modular Analog Synthesizers</a></li>
<li><a href="../236707/index.html">Using MagicalRecord when developing iOS applications</a></li>
<li><a href="../236709/index.html">With 1,000,000,000 a day in a year!</a></li>
<li><a href="../236711/index.html">Tesla Battery Factory in Nevada will get 1.3 billion tax breaks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>