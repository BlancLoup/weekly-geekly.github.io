<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fluent interface and Delphi</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fluent interface (Fluent interface) is a very young method, even more like a design pattern, which has gained popularity and wide distribution among J...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fluent interface and Delphi</h1><div class="post__text post__text-html js-mediator-article">  Fluent interface (Fluent interface) is a very young method, even more like a design pattern, which has gained popularity and wide distribution among Java, C #, and PHP coders. <br>  In most of the ‚Äúgood code‚Äù techniques, the text of the code (discharging lines, spaces, indents, etc) lies, and this is very cool, but sometimes it turns into hell.  Scrolling through the code, memorizing the method call chain, the eternal dilemma between the long method and readability, etc. <br>  But the solution is - <b>Fluid interface!</b>  Now on Delphi! <br><a name="habracut"></a><br><h5>  So what is a fluid interface? </h5><br>  In short, it is the simplification of multiple calls to methods of a single object, using a chain of methods that return the object that called it (that is, itself).  It sounds difficult, but it looks very easy and simple: <br><pre><code class="delphi hljs">CreateFluentBinaryWriter(Stream) .WriteString(<span class="hljs-string"><span class="hljs-string">'active'</span></span>) .WriteByte(<span class="hljs-number"><span class="hljs-number">130</span></span>);</code> </pre> <br><h5>  Implementation </h5><br>  The interface looks elementary - like this: <br><pre> <code class="delphi hljs">IFluentBinaryWriter = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteByte</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Value: Byte)</span></span></span><span class="hljs-function">:</span></span> IFluentBinaryWriter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Value: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> IFluentBinaryWriter; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br>  The auxiliary function of creating a class that implements an interface looks very simple - like this: <br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFluentBinaryWriter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AStream: TStream)</span></span></span><span class="hljs-function">:</span></span> IFluentBinaryWriter; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TFluentBinaryWriter.Create(AStream); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br>  <b>Further, all functions of the flowing interface must return an instance of the class that called this function.</b> <br><br>  As for example, the WriteString function writes a string to a stream (TBytesStream), and returns an instance of the class that called this function. <br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFluentBinaryWriter</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Value: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> IFluentBinaryWriter; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> fBinaryWriter.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>(Value); <span class="hljs-comment"><span class="hljs-comment">// TBinaryWriter Result := Self; end;</span></span></code> </pre><br>  That's all!  Actually, this could have been completed, but there is one very interesting implementation! <br><br><h5>  Option two - more difficult </h5><br><pre> <code class="delphi hljs">CreateFluentStringWriter(Stream) [<span class="hljs-string"><span class="hljs-string">' '</span></span>] [<span class="hljs-string"><span class="hljs-string">''</span></span>] [<span class="hljs-string"><span class="hljs-string">'!'</span></span>];</code> </pre><br>  Here we will go for a little trick.  Declare Attrib Property <br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">property</span></span> Attrib[Value: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>]: IFluentStringWriter <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> AddString; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre><br>  and in the AddString function, we write the requested string to the stream and return, as a result, an instance of the class that called this function. <br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFluentValueWriter</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Value: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> IFluentValueWriter; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> fBinaryWriter.<span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>(Value); <span class="hljs-comment"><span class="hljs-comment">// TBinaryWriter Result := Self; end;</span></span></code> </pre><br><h5>  PS </h5><br>  Using a fluid interface is quite extensive, and along with anonymous procedures you can achieve very compact and self-documenting code! </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/191170/">https://habr.com/ru/post/191170/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191156/index.html">Nokia Lumia 925. Commercial use</a></li>
<li><a href="../191158/index.html">Give a man a fish, and he will be full all day. Offer him to learn programming, and he ...</a></li>
<li><a href="../191162/index.html">IT Jam 2013</a></li>
<li><a href="../191164/index.html">Many tests do not happen</a></li>
<li><a href="../191168/index.html">How to start using DI</a></li>
<li><a href="../191172/index.html">Private dynamic IP - come, see, hide</a></li>
<li><a href="../191174/index.html">Tenders from the inside by the participant</a></li>
<li><a href="../191176/index.html">Encoding and decoding PHP code</a></li>
<li><a href="../191178/index.html">.NET dynamic, Unity and RuntimeBinder error</a></li>
<li><a href="../191180/index.html">Dell u2412m: getting rid of shima without losing the ability to adjust the brightness</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>