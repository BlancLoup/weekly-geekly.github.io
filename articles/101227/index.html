<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Caching data, maybe the last thing you should use</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I had a fairly hot conflict with the popular PHP e-commerce package. As a result, I wanted to talk about a common error in the web applicati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Caching data, maybe the last thing you should use</h1><div class="post__text post__text-html js-mediator-article">  Recently, I had a fairly hot conflict with the popular PHP e-commerce package.  As a result, I wanted to talk about a common error in the web application architecture. <br><br><h6>  What is this error? </h6><a name="habracut"></a><br><br>  The package with which I worked intensively used caching.  It could not render more than 10 pages per second if some ‚Äúoptional‚Äù cache settings were not included.  Obviously, with such performance, they are not really optional, but mandatory. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I think that when you have such a great tool like memcached, you want to use it to solve any performance problem.  But in many cases it should not be the first tool you are trying to use.  And that's why: <br><br>  - <i>Caching may not work for all users</i> nd - you open the page - it loads quickly.  But is this for all users?  Caching very often allows you to optimize the load time for most visitors, but often in reality you need the page to load quickly for everyone without exception (if you follow the <a href="http://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B5%25D1%2581%25D1%2582%25D1%258C_%25D1%2581%25D0%25B8%25D0%25B3%25D0%25BC%25D0%25B0">six sigma</a> principle).  In practice, a query can always miss the cache for the same user, which aggravates the situation even more ( <b>Approx. Translator</b> : I know a very real case when the cache in the electronic store worked for 99% of users and did not work for 1% of visitors who had a long shopping history, as a result, the store worked slowly just for active buyers). <br><br>  - <i>Caching can lead you away from solving a problem</i> - you look at the slowest loading page and try to optimize it.  But the trick here is that in reality, the performance problem may lie in another area (again six sigma).  You ‚Äúheal‚Äù the problem by caching, for example, the entire page, but the performance problem itself does not go anywhere and remains hidden ( <b>Note</b> : in order to float on other pages again and again and again). <br><br>  - <i>Cache management in reality is not an easy task</i> - Have you ever struggled with " <a href="http://code.google.com/p/memcached/wiki/FAQ">running away from the cache</a> " or with a situation when a large number of cache elements are invalidated at the same time? <br><br><h6>  Alternative approach </h6><br><br>  Caching should be considered as a burden without which many applications cannot live.  You should try to avoid this burden until you have exhausted the entire arsenal of easily applicable optimization methods. <br><br><h6>  What are these ways? </h6><br><br>  Before you enter optimization, make sure that you go through this fairly simple list: <br><br>  - <b>Do you understand the execution plan for each request?</b>  If not, set long_query_time = 0 and use the mk-query-digest command to get a complete list of queries.  Perform EXPLAIN for each of them, analyze the execution plan. <br><br>  - <b>Do you use SELECT * to use only a small set of columns later?</b>  <b>Or do you choose from the database many lines, but use only some of them?</b>  If this is so, then you choose too much data, limiting the optimization of the DBMS level, such as using indexes. <br><br>  - <b>Do you know exactly how many queries you use to generate a single page?</b>  <b>Are they really necessary?</b>  <b>Is it possible to turn any of these requests into one request or to remove it altogether?</b>  ( <b>Note of translator</b> : A very common problem. I really know the case when the page displayed a list of students in a class, and then additional information was requested for each student, including the name of the class. After the conversion, the number of requests was reduced from 61 to 3). <br><br>  I think that as a conclusion one can say: ‚ÄúOptimization very rarely reduces the complexity of the application.  Try to avoid complication by optimizing only what is really to be optimized ‚Äù- quote from <a href="http://instrumentation-for-php.googlecode.com/files/Instrumenting%252520PHP%252520applications%252520Slides.pdf">Justin‚Äôs</a> slide <a href="http://instrumentation-for-php.googlecode.com/files/Instrumenting%252520PHP%252520applications%252520Slides.pdf">- instrumentation-for-php</a> . <br><br>  From the point of view of a long-term perspective, many applications should keep the architecture simple and resist the temptation to solve problems like ‚Äúreal guys do‚Äù. <br><br>  <b>Note</b>  <b>of the translator</b> : Absolutely real dialogue which happened not so long ago: <br>  - So we have performance problems, we need to add caching, vertical partitioning and NoSQL DB for logins <br>  - Guys - I looked EXPLAIN here - you have a fullscan query for 4,000 rows, I tried to create an index, everything accelerated 26 times. <br><br>  <b>A few notes to the translation</b> <br><br>  1. The term cache stampeding - I translated it as a <i>cache runaway</i> (it was tempting to translate as ‚Äúsplicing‚Äù, but that would be wrong).  In short, this is a situation where, for example, a certain query is executed long enough and the results of this query are cached, when this data then sooner or later leaves the cache, and 10 pages are simultaneously rendered on which this data is needed, 10 slow queries are sent to the database one.  Usually, this is what a rewrite is trying to do before requesting data from the cache.  see <a href="http://code.djangoproject.com/ticket/6199">for example</a> <br>  2. I want to note that the article <b>does not</b> say that you do not need to cache data.  They need to be cached, but only after you try some simple ways to optimize database queries.  In other words, we must begin with a simple one. </div><p>Source: <a href="https://habr.com/ru/post/101227/">https://habr.com/ru/post/101227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../101221/index.html">We write a little OpenID authorization</a></li>
<li><a href="../101222/index.html">Conflicts at collective sites: possible solutions</a></li>
<li><a href="../101224/index.html">Illiteracy liquidators</a></li>
<li><a href="../101225/index.html">The site of the Minsk branch of the Belarusian Chygunki was hacked</a></li>
<li><a href="../101226/index.html">The secret of success for startups: invest before taking the product to the market, double the rate AFTER</a></li>
<li><a href="../101229/index.html">Scalar type hints in PHP</a></li>
<li><a href="../101230/index.html">Careful spine</a></li>
<li><a href="../101232/index.html">We write the filter of "bad" words</a></li>
<li><a href="../101234/index.html">Available on pre-order $ 200 Android tablet</a></li>
<li><a href="../101235/index.html">Beware of extremist literature</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>