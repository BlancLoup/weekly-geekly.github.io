<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dynamic identification of control objects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Identification of control objects - a set of methods for constructing mathematical models of an object from observational data. 

 A ma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dynamic identification of control objects</h1><div class="post__text post__text-html js-mediator-article"><h3>  Introduction </h3><br>  Identification of control objects - a set of methods for constructing mathematical models of an object from observational data. <br><br>  A mathematical model in this context means a mathematical description of the behavior of an object or process in the frequency or time domain, for example, physical processes (the movement of a mechanical system under the influence of an external force [1]), the economic process (the effect of a change in exchange rates on consumer prices on goods [2]). <br><br>  Currently, this area of ‚Äã‚Äãcontrol theory is widely used in practice and therefore interesting to consider. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The field of dynamic identification of control objects in connection with the different nature of the objects themselves is quite extensive, so for the beginning we will limit ourselves to considering the processing methods of the so-called acceleration curve. <br><br>  The acceleration curve is the process of the change in time of the output variable, caused by a step input.  The acceleration curve is used to determine the dynamic properties of the object. <br><a name="habracut"></a><br><h3>  Formulation of the problem </h3><br>  1. To build mathematical models of dynamic identification of the control object according to the normalized transient response (acceleration curve): <br><br>  ‚Ä¢ The method of least squares using derivatives; <br>  ‚Ä¢ Modified area method. <br><br>  2. To determine and compare the adequacy of the mathematical models obtained to the control object. <br><br>  <b>Theory</b> <br><br>  Identification consists in finding an adequate model for the object.  Distinguish between structural and parametric identification.  In the case of structural identification, the form of the model is determined from some given class of functions; in parametric identification, the model parameters are determined. <br><br>  If the output signals of the object Y (t) are completely determined by the observed input effects X (t), then to identify it, it suffices to use the methods of the active experiment. <br><br>  The initial information is the experimentally recorded acceleration curve ‚Äî the object Y (t) response to the input input action X (t) in the time interval 0‚â§t‚â§T. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zz/y0/_v/zzy0_vjoar1ujs8addgyk90zxpg.png"></div><br>  This is a block diagram of an object model with an operator transfer function W (p).  The equation of the dynamic characteristics of the object can be represented as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/z0/g7/i7/z0g7i7w2603vdxivtsqshlalezk.png"></div>  (one) <br>  Where <img src="https://habrastorage.org/webt/kw/7i/4w/kw7i4woifmb5w5-4xziyitfswgm.png">  - lag time of the object, which runs from the moment the signal is given to the input of the object to the moment the signal appears at its output;  k - gain (or transfer coefficient) of the object. <br><br>  Scheme for determining the lag time and the gain of the object: <br><br><img src="https://habrastorage.org/webt/m0/d3/lo/m0d3lo_exxwukt13kqyj4hadqvk.png"><br><br><img src="https://habrastorage.org/webt/wq/0t/ni/wq0tnikpsuktyw-mbk_id_7fkxm.png"><br><br>  Input and output values ‚Äã‚Äãare usually scaled in the standard range from 0 to 1 (normalized): <br><br><img src="https://habrastorage.org/webt/8p/sq/y8/8psqy833pedsu8dyn7thz9vdsgw.png"><br><br>  After determining k and <img src="https://habrastorage.org/webt/kw/7i/4w/kw7i4woifmb5w5-4xziyitfswgm.png">  You can explore the object in normalized coordinates and without delay, by shifting the time scale to the right by <img src="https://habrastorage.org/webt/kw/7i/4w/kw7i4woifmb5w5-4xziyitfswgm.png">  [3]. <br><br>  <b>Structural identification of the object</b> <br><br>  In structural identification, a priori information about the object is used to determine the structure of the model. <br><br>  The equation of dynamics, as a rule, is chosen from the class of linear or linearized characteristics.  In normalized coordinates, an object model with lumped parameters, one input and one output signal is an ordinary differential equation with constant coefficients: <br><br><img src="https://habrastorage.org/webt/im/rs/ro/imrsroeavl2osfkmmfvqjlj_lsw.png">  (2) <br><br>  where are the coefficients <img src="https://habrastorage.org/webt/hk/z_/9w/hkz_9wa9fd06yrbfzrlpq6sum1k.png">  and <img src="https://habrastorage.org/webt/bf/q1/il/bfq1ilguc1bpow8rikletfnudrs.png">  have the dimension of time to a degree equal to the order of the derivative of the corresponding term.  In physically realizable systems, n‚â•m <br><br>  By the form of the acceleration curve, you can approximately determine the order of a future model, for example, for a first-order object: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rz/qa/9t/rzqa9ttc-royarunow15rnrojsg.png"></div><br>  For objects of higher orders: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/de/6k/wd/de6kwdjqcblbrzfixd517aa7qsi.png"></div><br>  Usually X (t) is a step function, therefore the order of equation (1) can be approximately determined by the shape of the object's acceleration curve.  If this characteristic has no inflection points, then n = 1. If there is an inflection at t = t, and t / T &lt;0.1 ... 0.15, then n = 2. Otherwise, consider n&gt; 2. However You can reduce the order of the model by introducing a dummy lag. <br><br>  <b>Conclusion</b> <br><br>  The influence of the measurement error X (t) and Y (t) and the error of numerical methods for processing information usually makes <b>it impractical to use models of a higher third or fourth order.</b> <br><br>  <b>Parametric object identification</b> <br><br>  With parametric identification, data about an object is processed to obtain a posteriori information about it.  The parameters of the selected model are evaluated.  In the simplest cases, such an assessment can be performed according to a transient response graph. <br><br>  <b>Parametric identification by least squares method using derivatives</b> <br><br>  To identify an object of arbitrary order, the least squares method is used, which requires minimization of the mean square of the residual of the right and left sides of equation (2): <br><br><img src="https://habrastorage.org/webt/tf/uj/ff/tfujffk9u4zcc_cjscwbrpvivdc.png">  (3) <br><br>  Where: <img src="https://habrastorage.org/webt/uw/qo/uc/uwqoucq2jgy8rs7j-j3rbhgzfok.png">  and <img src="https://habrastorage.org/webt/tw/x7/b7/twx7b7wc8myefgnasvqswbakw8c.png">  - derivatives of the i-th and j-th order of the functions of the output and input signals. <br><br>  The solution of problem (3) is reduced to the solution of the system: <br><br><img src="https://habrastorage.org/webt/74/83/e3/7483e3ggy2o0efxiqkdubplbdjg.png">  (four) <br><br>  By transforming (4) in accordance with equation (3), one can obtain a system of linear algebraic equations: <br><br><img src="https://habrastorage.org/webt/jj/fj/hx/jjfjhxqe8x4zbhaz9hpnopdetrm.png">  (five) <br><br>  To solve system (5) with respect to unknown parameters <img src="https://habrastorage.org/webt/ru/uo/hw/ruuohw3sildkkwpibuzhommxp9o.png">  you need to know the derivatives of the input and output signals of the object, which are the result of smoothing the functions X (t) and Y (t) on the segment <img src="https://habrastorage.org/webt/_m/2a/up/_m2aup1bfita-gg2o1u-7p-_2ha.png">  .  To calculate the coefficient <img src="https://habrastorage.org/webt/fm/-f/nh/fm-fnhn0tfkoq7oo2mkfjuks9be.png">  used formula: <br><br><img src="https://habrastorage.org/webt/2z/on/d_/2zond_rzuto22vwhsidrspzz4km.png"><br><br>  <b>Conclusion</b> <br><br>  The error of numerical differentiation, as a rule, is quite high, so the scheme for determining the coefficients, <img src="https://habrastorage.org/webt/ru/uo/hw/ruuohw3sildkkwpibuzhommxp9o.png">  you need to use the differentiation of analytical expressions for X (t) and Y (t). <br><br>  <b>Parametric identification by the modified area method</b> <br><br>  To create a model using Python, modifying the area method is on an unchanged time scale.  In the classic version, a new time scale is introduced, which, with a numerical solution, leads to an additional error. <br><br>  Usually, the expression for the transfer function is searched for in one of three mathematical models: <br><br><img src="https://habrastorage.org/webt/x3/a_/y7/x3a_y7moq-lzasiqzlkxcjka0sy.png"><br><br>  The expression 1 / W (p), the inverse of the transfer function of the model, can be expanded in a series according to degree p: <br><br><img src="https://habrastorage.org/webt/eb/ji/dp/ebjidpwn5uexxlg6jellk5-gjws.png"><br><br>  The coefficients a, b of the reduced transfer functions are associated with the coefficients S by the following system of equations: <br><br><img src="https://habrastorage.org/webt/rb/ah/th/rbahthyuwxgsyvesrl3_jo_mojy.png"><br><br>  The coefficients Si are associated with the transition function h (t) by the relations: <br><br><img src="https://habrastorage.org/webt/6i/zt/jr/6iztjr1qzto7d8g_kzwrrnexary.png">  (6) <br><br>  <b>Conclusion</b> <br><br>  Relations (6) are optimal for solving by means of Python interpolating h (t) with cubic splines, which will be proved by examples. <br><br><h3>  Assessment of the adequacy of mathematical models of identification of control objects </h3><br>  To select the optimal model, it is sufficient to use the second order adequacy indicator: <br><br><img src="https://habrastorage.org/webt/ux/dc/ks/uxdcksduspag9hboed0usckd3fc.png">  (7) <br><br>  Where <img src="https://habrastorage.org/webt/3s/ej/1s/3sej1slhmaprblz1awmegwt2-ui.png">  - data taken from the acceleration curve, <img src="https://habrastorage.org/webt/ur/6y/es/ur6yesgt8mg8hvabfayi13lx8uq.png">  - values ‚Äã‚Äãcalculated by the real part Re (W (i √ó w)) of the transfer function of the model (transition from the frequency domain to the time domain): <br><br><img src="https://habrastorage.org/webt/ec/sm/vk/ecsmvkzbaxhfhuflzopxxv026ok.png">  (eight) <br>  The best should be considered a model that provides the maximum value. <img src="https://habrastorage.org/webt/x2/jp/bs/x2jpbswi_rsn2fxe-8fomae8ln0.png"><br><br>  Considering the significant error of numerical differentiation when solving the system of equations (5), we implement symbolic differentiation.  For this, we apply interpolation by a polynomial in accordance with the following listing: <br><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf8 -*- import matplotlib.pyplot as plt#    import time start = time.time() import scipy as sp#    import numpy as np#        from sympy import *#     import scipy.integrate as spint from scipy.integrate import quad x=[0.0, 0.4, 0.8, 1.2, 1.6 ,2.0, 2.4, 2.8 ,3.2, 3.6]# y=[0.00, 0.11, 0.36, 0.61, 0.79, 0.89, 0.94, 0.98, 0.99, 1.00]#   fp, residuals, rank, sv, rcond = sp.polyfit(x, y,4, full=True)#   a=round(fp[0],4);b=round(fp[1],4);c=round(fp[2],4) d=round(fp[3],4);e=round(fp[4],4) t=symbols('t ' ,real=True) def h(t):#     h(t) return a*t**4+b*t**3+c*t**2+d*t+e '''   ''' L1=integrate(h(t).diff(t)*h(t).diff(t,t),(t,0,3.6)) L2=integrate(h(t).diff(t,t)*h(t).diff(t,t),(t,0,3.6)) L3=integrate(h(t).diff(t)*h(t).diff(t),(t,0,3.6)) L4=integrate((1-h(t))*h(t).diff(t,t),(t,0,3.6)) L5=integrate((1-h(t))*h(t).diff(t),(t,0,3.6)) """      (5)    (3)""" P= np.zeros([2,2]) P[0,0]=L2;P[0,1]=L1 P[1,0]=L1;P[1,1]=L3 Q= np.zeros([2,1]) Q[0,0]=L4;Q[1,0]=L5 P=np.matrix(P); Q=np.matrix(Q) C=PI*Q '''    ''' a2=C[0,0] a1=C[1,0] b1=C[0,0]*h(t).diff(t).subs(t,0) a2=round(C[0,0],3) a1=round(C[1,0],3) b1=round(C[0,0]*h(t).diff(t).subs(t,0),3) """         (8)""" def ff(x,t): j=(-1)**0.5 return (2/np.pi)*( ((b1*x*j+1)/(a2*(x*j)**2+a1*x*j+1)).real)*(np.sin(x*t)/x) z=np.array([round(quad(lambda x: ff(x,t),0, 20)[0],2) for t in x]) """      (7) """ k=round(1-sum([(y[i]-z[i])**2 for i in np.arange(0,len(y)-1,1)])/sum([(y[i])**2 for i in np.arange(0,len(y)-1,1)]),5) stop = time.time() print ("   :",round(stop-start,3)) plt.title('   \n   -%s'%k) plt.plot(x, y,'o', label='  ') plt.plot(x, z,'r', label=' W=(%s*p+1)/(%s*p**2+%s*p+1)'%(b1,a2,a1)) plt.legend(loc='best') plt.grid(True) plt.show()</span></span></code> </pre> <br>  <b>We get:</b> <br><br>  Program working time: 0.802 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/c9/p0/oj/c9p0ojox1ghb8dq_gwlp35jecq0.png"></div><br>  The high degree of adequacy of the model <b>0.99743</b> indicates that the resulting transfer function: <br><br>  <b>W = (0.092 * p + 1) / (0.431 * p ** 2 + 1.114 * p + 1)</b> , <br><br>  quite accurately displays the dynamic properties of the object. <br><br>  The acceleration curve was obtained experimentally; therefore, a further study of object control systems for stability [4] and the determination of controller parameters [5] is of practical importance. <br><br>  <b>Python implementation of object identification by the modified area method</b> <br><br>  To solve this problem, you can use numerical methods because the model does not contain differentiation, and the proposed method for solving according to relations (6) does not imply a change in the time coordinate.  In addition, we apply spline interpolation in accordance with the following listing: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf8 -*- import matplotlib.pyplot as plt import time start = time.time() from scipy.interpolate import splev, splrep import scipy.integrate as spint import numpy as np from scipy.integrate import quad xx =np.array([0.0, 0.4, 0.8, 1.2, 1.6 ,2.0, 2.4, 2.8 ,3.2, 3.6]) yy =np.array([0.00, 0.11, 0.36, 0.61, 0.79, 0.89, 0.94, 0.98, 0.99, 1.00]) """      """ def h(x): spl = splrep(xx , yy ) return splev(x, spl) """          (6)""" S1=(spint.quad(lambda x:1-h(x),xx[0],xx[len(xx)-1])[0]) S2=(spint.quad(lambda x:(1-h(x))*(S1-x),xx[0],xx[len(xx)-1])[0]) S3=(spint.quad(lambda x:(1-h(x))*(S2-S1*x+(1/2)*x**2),xx[0],xx[len(xx)-1])[0]) S4=(spint.quad(lambda x:(1-h(x))*(S3-S2*x+S1*(1/2)*x**2-(1/6)*x**3),xx[0],xx[len(xx)-1])[0]) """    """ b1=-S4/S3 a1=b1+S1 a2=b1*S1+S2 a3=b1*S2+S3 """    """ def ff(x,t): j=(-1)**0.5 return (2/np.pi)*( ((b1*x*j+1)/(a3*(x*j)**3+a2*(x*j)**2+a1*x*j+1)).real)*(np.sin(x*t)/x) y=np.array([round(quad(lambda x: ff(x,t),0, 20)[0],2) for t in xx]) """     """ k=round(1-sum([(yy[i]-y[i])**2 for i in np.arange(0,len(yy)-1,1)])/sum([(yy[i])**2 for i in np.arange(0,len(yy)-1,1)]),5) stop = time.time() print ("   :",round(stop-start,3)) plt.title('   .\n   -%s'%k) plt.plot(xx, yy,'o', label='   ()') plt.plot(xx, y,'r', label='W=(%s*p+1)/(%s*p**3+%s*p**2+%s*p+1)'%(round(b1,3),round(a3,3),round(a2,3),round(a1,3))) plt.legend(loc='best') plt.grid(True) plt.show()</span></span></code> </pre> <br>  <b>We get:</b> <br><br>  Program working time: 0.238 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tb/9p/zu/tb9pzu3mh4kysy5jabotvsrtrye.png"></div><br>  The high degree of adequacy of the model <b>0.99996</b> and greater speed than with symbolic differentiation, suggests that the transfer function: <br><br>  <b>W = (0.074 * p + 1) / (0.067 * p ** 3 + 0.502 * p ** 2 + 1.207 * p + 1))</b> , <br><br>  obtained by the modernized method of areas better displays the dynamic properties of the object. <br><br><h3>  findings </h3><br>  1. The publication introduces the basics of dynamic identification of the control object. <br><br>  2. Implementing the solution of the identification problem in the free Python programming language with examples of using the explicit representation of the transition function by a polynomial and splines will help expand the scope of Python. <br><br>  3. For numerical solutions of identification problems, it is possible to suggest the use of relations (6), which allow one to obtain a result without changing the time coordinate. <br><br><h3>  Links </h3><br><ol><li>  <a href="https://habrahabr.ru/post/325650/">Oscillating link model using symbolic and numerical solutions of a differential equation on SymPy and NumPy.</a> </li><li>  <a href="https://habrahabr.ru/post/341268/">Mathematical model of financial market dynamics.</a> </li><li>  <a href="https://studfiles.net/preview/6235047/">Determination of model parameters by the area method.</a> </li><li>  <a href="https://habrahabr.ru/post/340554/">Determination of the stability of automatic control systems of industrial robots.</a> </li><li>  <a href="https://habrahabr.ru/post/328608/">PID controller model in Python.</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/345198/">https://habr.com/ru/post/345198/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345188/index.html">Today is the day of thick polar fox retail - the error of cash registers Shtrikh-M across the country</a></li>
<li><a href="../345190/index.html">We generate fake news headlines in the style of Tapy.ru</a></li>
<li><a href="../345192/index.html">Understand what happened with the course of Bitcoin</a></li>
<li><a href="../345194/index.html">Information security of bank non-cash payments. Part 2 - Typical IT infrastructure of the bank</a></li>
<li><a href="../345196/index.html">Attention! S in Ethereum stands for Security. Part 1. Blockchain things</a></li>
<li><a href="../345200/index.html">How to deal with miners cryptocurrency in the corporate network</a></li>
<li><a href="../345202/index.html">Typescript. Read Only Properties</a></li>
<li><a href="../345204/index.html">How to learn to think in images using visual analogies</a></li>
<li><a href="../345206/index.html">We tried to hire these two for five years. And every minute of our waiting paid off.</a></li>
<li><a href="../345208/index.html">1Kb autocomplete</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>