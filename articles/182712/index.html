<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Saving Google Reader Data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The closer the closing date of Google Reader, the more urgent becomes the question of not only transferring subscriptions to a similar service, but al...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Saving Google Reader Data</h1><div class="post__text post__text-html js-mediator-article">  The closer the closing date of Google Reader, the more urgent becomes the question of not only transferring subscriptions to a similar service, but also saving all current records. <br><br>  The solutions found, including those in Habr√© ( <a href="http://habrahabr.ru/post/181420/">here</a> and <a href="http://habrahabr.ru/post/180111/">here</a> ), did not work mainly for two reasons: there is no possibility of saving to the database and the slow speed of work.  I had to collect my bike - <a href="https://github.com/wistful/grbackup">grbackup</a> , which <br><pre><code class="bash hljs">grbackup -e fake@gmail.com -p password -ba -o mongodb://localhost:27017 -w 20</code> </pre> <br>  for <b>20</b> minutes saved <b>328,250</b> records from <b>102</b> subscriptions to the local MongoDB database. <br><br>  Key features: <br><ul><li>  Saving all records that can be obtained using the Google Reader API </li><li>  saving records to various storage </li><li>  using a format identical to that given by Google Reader via the API </li><li>  parallel receiving / saving records </li><li>  extensibility: the ability to add a new type of storage </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The available storage types are determined by extensions (plug-ins) and are set using the option ( <i>-o, --output</i> ) of the type <i>type: uri</i> . <br>  At the time of this writing, the following extensions are available: <br><ul><li>  <b>simple</b> : output to terminal (used only in view mode) </li><li>  <b>json</b> : write to json file ( <i>json: /path/to/file.json</i> ) </li><li>  <b>mongodb</b> : write to MongoDB ( <i>mongodb: // [username: password @] hostN [: portN]]] [/ [db] [? opts]]</i> ) </li><li>  <b>redis</b> : write to Redis ( <i>redis: // username: password @ host [: port] / dbindex</i> ) </li></ul><br>  Performance tested on Ubuntu (64) and Win7 (64). <br>  Book of suggestions and comments can be found <a href="https://github.com/wistful/grbackup/issues">here</a> . <br>  Below is a detailed description of the utility. <br><a name="habracut"></a><br><h5>  Installation </h5><br><pre> <code class="bash hljs">pip install grbackup</code> </pre><br>  or <br><pre> <code class="bash hljs">easy_install grbackup</code> </pre><br>  or <br><pre> <code class="bash hljs">pip install git+git://github.com/wistful/grbackup.git</code> </pre><br><h5>  Command line options </h5><br>  Authorization <br><ul><li>  <i>-e, --email</i> : email address used to log in to Google Reader </li><li>  <i>-p, --password</i> : password </li></ul><br>  <a href="https://github.com/wistful/grbackup">grbackup</a> supports two actions: <br><ul><li>  <b>preview</b> : <i>-l, --list</i> </li><li>  <b>save</b> : <i>-b, --backup</i> </li></ul><br>  The action can be performed on one of four data types: <br><ul><li>  <b>subscriptions</b> ;  <i>-s, --subscriptions</i> </li><li>  <b>entries</b> : <i>-t, --topics</i> </li><li>  <b>Marked entries</b> : <i>-x, --starred</i> </li><li>  <b>all previous ones taken together</b> : <i>-a, --all</i> </li></ul><br>  Additional options: <br><ul><li>  <i>-w, --workers</i> : maximum number of simultaneously processed subscriptions (default 1) </li><li>  <i>-o, --output</i> : URI indicating where to save records </li><li>  <i>-n, --count</i> : the number of entries received from Google Reader for one request (default 200).  Too many can result in smaller amounts of data (oh, this google). </li></ul><br>  All options, as well as plugin descriptions, can be viewed using the <i>-h, --help</i> option: <br><pre> <code class="bash hljs">grbackup -h</code> </pre><br><div class="spoiler">  <b class="spoiler_title">previous command output</b> <div class="spoiler_text"><pre> <code class="bash hljs">Usage: grbackup [options] [args] Examples: list subscriptions: grbackup -e email@gmail.com -p password -ls list topics: grbackup -e email@gmail.com -p password -lt http://feed.com list starred: grbackup -e email@gmail.com -p password -lx list all items: grbackup -e email@gmail.com -p password -la backup subscriptions: grbackup -e email@gmail.com -p password -bs -o json:/tmp/subscriptions.json backup topics: grbackup -e email@gmail.com -p password -bt http://myfeed.com -o json:/tmp/myfeed.json backup starred into MongoDB: grbackup -e email@gmail.com -p password -bx -o mongodb://localhost:27017 backup all items into Redis: grbackup -e email@gmail.com -p password -ba -o redis://localhost:6379/3 Available plugins: mongodb: save items into MongoDB output scheme: mongodb://[username:password@]hostN[:portN]]][/[db][?opts]] output examples: mongodb://localhost:27017 mongodb://user:<span class="hljs-built_in"><span class="hljs-built_in">pwd</span></span>@localhost,localhost:27018/?replicaSet=grbackup json: save items into file output scheme: json:/path/to/file.json output examples: json:/home/grbackup/grbackup.json json:/tmp/grbackup/grbackup.json redis: save items into Redis output scheme: redis://username:password@host[:port]/dbindex output examples: redis://localhost:6379/3 redis://user:password@localhost:6379/0 Options: Auth Options: -e EMAIL, --email=EMAIL gmail account -p PWD, --password=PWD account password Command Options: -b, --backup backup items -l, --list list items Scope Options: -a, --all processing all items -s, --subscriptions processing subscriptions only -t, --topics processing topics only -x, --starred processing starred topics only MongoDB Options: --mongodb-db=MONGODB_DB the name of the database[default: greader] --mongodb-scol=MONGODB_SUBSCRIPTIONS collection name <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> subscriptions[default: subscriptions] --mongodb-tcol=MONGODB_TOPICS collection name <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> topics[default: topics] --mongodb-tstar=MONGODB_STARRED collection name <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> starred items[default: starred] --mongodb-w=MONGODB_W &lt;int&gt; Write operations will block until they have been replicated to the specified number [default: 1] --mongodb-j block until write operations have been committed to the journal [default: False] Redis Options: --redis-scol-prefix=REDIS_SUBS subscriptions key prefix[default: subscription] --redis-tcol-prefix=REDIS_TOPICS topics key prefix[default: topic] --redis-xcol-prefix=REDIS_STARRED starred key prefix[default: starred] Other Options: -w WORKERS, --workers=WORKERS number of workers [default: 1] -o OUTPUT, --output=OUTPUT output uri -n COUNT, --count=COUNT the number of topics that can be <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> at once [default: 200] -c CODING, --coding=CODING output coding [default: utf8] -v, --verbose verbose output -h, --<span class="hljs-built_in"><span class="hljs-built_in">help</span></span></code> </pre><br></div></div><br><h5>  Using </h5><br>  list of subscriptions: <pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -ls</code> </pre><br>  list of specific subscription records: <pre> <code class="bash hljs"> grbackup -e email@gmail.com -p password -lt http://habrahabr.ru/rss/hub/python/</code> </pre><br>  list of all marked entries: <pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -lx</code> </pre><br>  list of all entries: <pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -la</code> </pre><br>  saving subscriptions to json file: <pre> <code class="bash hljs"> grbackup -e email@gmail.com -p password -bs -o json:/tmp/subscriptions.json</code> </pre><br>  saving all records of a specific subscription to a json file: <pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -bt http://habrahabr.ru/rss/hub/python/ -o json:/tmp/python.json</code> </pre><br>  save all selected entries in MongoDB: <pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -bx -o mongodb://localhost:27017</code> </pre><br>  save all entries in Redis using 20 streams: <pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -ba -o redis://localhost:6379/3 -w 20</code> </pre><br><h5>  Plugins </h5><br><h6>  Json </h6><br>  General URI format: <i>json: /path/to/file.json</i> <br>  Multithreading support: yes <br>  Usage example: <br><pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -ba -o json:/home/grbackup/grbackup.json</code> </pre><br>  Records are saved to a separate file as a list of objects. <br>  There are three types of objects: <br><ul><li>  <b>subscriptions</b> : <i>{"type": "subscription", "value": subscription}</i> </li><li>  <b>marked records</b> : <i>{"type": "starred", "value": record}</i> </li><li>  <b>normal record</b> : <i>{"type": "topic", "subscription": subscription_url, "value": record}</i> </li></ul><br><br><h6>  MongoDB </h6><br>  General URI format: <i>mongodb: // [username: password @] hostN [: portN]]] [/ [db] [? Opts]]</i> <br>  Multithreading support: yes <br>  Usage example: <br><pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -ba -o mongodb://localhost:27017 -w 20</code> </pre><br>  Records are arranged in three collections: <i>subscriptions</i> , <i>topics</i> , <i>starred</i> . <br>  Collection names can be changed. <br><br><h6>  Redis </h6><br>  General URI format: <i>redis: // username: password @ host [: port] / dbindex</i> <br>  Multithreading support: yes <br>  Usage example: <br><pre> <code class="bash hljs">grbackup -e email@gmail.com -p password -ba -o redis://user:password@localhost:6379/0 -w 20</code> </pre><br>  To store records, the <a href="http://redis.io/topics/data-types">Hashes</a> data type is <a href="http://redis.io/topics/data-types">used</a> . <br>  Keys can be of three types: <i>‚Äúsubscription: record_id‚Äù</i> , <i>‚Äústarred: record_id‚Äù</i> , <i>‚Äútopic: record_id‚Äù</i> , where <i>record_id</i> is the unique identifier of the record. <br>  Key prefixes can be changed. <br><br><h6>  Own plugin </h6><br>  The module should be in the grb_plugins package, the module name does not matter. <br>  Module structure: <br><ul><li>  <b>plugin_type</b> - string type, contains the name of the plugin </li><li>  <b>support_threads</b> - boolean type, indicates the possibility of using multiple threads </li><li>  <b>descriptions</b> - string type, contains plugin description </li><li>  <b>add_option_group</b> - function that adds additional options of the command line </li><li>  <b>writer</b> is a context manager that returns an object with methods: <br><ul><li>  <i>put_subscription (subscription)</i> - called when saving a subscription, <i>subscription</i> - dictionary </li><li>  <i>put_starred (topic)</i> - called when the marked entry is saved, <i>topic</i> is a dictionary </li><li>  <i>put_topic (self, subscription_url, topic)</i> - called when saving a record (option <i>'-t', '--topics</i> '), <br>  <i>topic</i> - dictionary, <i>subscription_url</i> - string subscription address </li><li>  <i>put_all (subscription, topic)</i> - called when saving a record using the option <i>'-a', '--all'</i> , <br>  subscription and topic - dictionaries </li></ul><br></li></ul><br><div class="spoiler">  <b class="spoiler_title">An example of a plugin using logging to save records to a file</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python # coding=utf-8 from optparse import OptionGroup import logging plugin_type = "myplugin" support_threads = True description = """save items using logging output scheme: myplugin:/path/to/logfile.log output examples: myplugin:/tmp/storage.log """ def add_option_group(parser): # Plugin Options myplugin_group = OptionGroup(parser, "myplugin Options") myplugin_group.add_option("--myplugin-format", dest="format", type="str", default="%(asctime)s %(message)s", help="record format" "[default: %default]") myplugin_group.add_option("--myplugin-datefmt", dest="datefmt", type="str", default="%m/%d/%Y %I:%M:%S %p", help="date format" "[default: %default]") parser.add_option_group(myplugin_group) class WriteMyPlugin(object): def __init__(self, logger): self.logger = logger def put_subscription(self, subscription): subscription_url = subscription['id'][5:] self.logger.warning("write subscription: %s", subscription_url) def put_all(self, subscription, topic): subscription_url = subscription['id'][5:] self.put_subscription(subscription) self.put_topic(subscription_url, topic) def put_starred(self, topic): self.logger.warning("write starred: %s", topic.get('title', '')) def put_topic(self, subscription_url, topic): self.logger.warning("write topic: %s %s", subscription_url, topic.get('title', '')) class writer(object): def __init__(self, opt): path = opt.output[opt.output.index(":") + 1:] self._logger = logging.getLogger("myplugin") handler = logging.FileHandler(path) handler.setFormatter(logging.Formatter(opt.format, opt.datefmt)) self._logger.addHandler(handler) def __enter__(self): return WriteMyPlugin(self._logger) def __exit__(self, *exc_info): pass</span></span></code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/182712/">https://habr.com/ru/post/182712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../182702/index.html">How to test the finalizer code (c #)</a></li>
<li><a href="../182704/index.html">Infographics - Tor, HTTPS and Security</a></li>
<li><a href="../182706/index.html">Camjacking, like the evolution of Clickjacking, or ‚ÄúGyulchatay! Open your face! ‚Äù</a></li>
<li><a href="../182708/index.html">ASUS Padfone Infinity Review</a></li>
<li><a href="../182710/index.html">Weebly Online Website Builder</a></li>
<li><a href="../182714/index.html">The prototype of the totalitarian framework for node.js</a></li>
<li><a href="../182716/index.html">Deanonymization through genetic information</a></li>
<li><a href="../182720/index.html">Application Statistics in the Windows Store</a></li>
<li><a href="../182722/index.html">In one fell swoop 100 million ubivahom. Or lock-free memory allocator</a></li>
<li><a href="../182724/index.html">HP All-flash array and 10 more major changes to 3PAR storage systems (part 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>