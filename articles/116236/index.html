<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The task of finding the maximum on segments of fixed length</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Formulation of the problem 
 Let an array A of length N be given, and a number K ‚â§ N be given. It is required to find a maximum (minimum, sum ...) in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The task of finding the maximum on segments of fixed length</h1><div class="post__text post__text-html js-mediator-article"><h4>  Formulation of the problem </h4><br>  Let an array A of length N be given, and a number K ‚â§ N be given. It is required to find a maximum (minimum, sum ...) in sub-spans of length K of this array.  This is a special case of the RMQ (Range Minimum Query - Minimum on the Segment) problem, but with additional restrictions - the constant length of the search segment.  In this solution, the task does not imply the possibility of changing the elements of the array. <a name="habracut"></a>  For definiteness, we will consider finding the maximum. <br><br><h4>  Advantages and disadvantages </h4><br>  This algorithm makes it possible to find the maximum on subframes of a fixed length beyond O (1), with preprocessing beyond O (N).  In this case, the auxiliary memory requires 2 * N.  But the main advantage can be considered a very simple implementation and clarity.  The disadvantage is that the algorithm is not adapted to change the elements of the original array.  Those.  the change is possible, but this will require performing an order of O (K) actions. <br><br><h4>  Decision </h4><br><h6>  Preprocessing </h6><br>  We divide the initial array A into blocks of length K-1 (why exactly K-1, you will understand just below).  Then we calculate two additional arrays B and C as follows: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      in B [i] we will store a maximum in the interval from the beginning of the current block to the i-th element; <br>  in C [i], we will store a maximum between the i-th element and the end of the current block. <br><br>  For example, in B [2] we will store a maximum from A [0] to A [2], and in C [2] - a maximum from A [2] to A [3].  It is clear that this operation can be performed in O (n).  The following figure shows an example for N = 22, K = 5: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage/f115398c/be5bec7e/53a8c77b/ed103d24.png"></div><br><br><h6>  Processing request </h6><br>  Now, using this simple structure, you can easily find a maximum on a segment of length K. We specially made blocks of length K-1, so that the edges of any query always fall into two adjacent blocks.  And, therefore, with any query, the segment will include the boundary of 2 blocks.  We call it T. The left edge of the segment is l, the right edge is r.  Now, in order to get the maximum, we only need to take max (C [l], B [r]).  Indeed, C [l] is the maximum in the interval from l to T, and B [r] is the maximum from T to r, and, therefore, the maximum from C [l] and B [r] will be the maximum in the segment from l to r. <br><br><h4>  Implementation </h4><br>  Below is the simplest implementation in C ++; <br><br><pre><code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> &gt; B, C; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &gt; A, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> k)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = A.size(); B.resize(n); C.resize(n); k--; <span class="hljs-comment"><span class="hljs-comment">//  B for(int i = 0; i &lt; n; i++) { if(i % k) B[i] = max(A[i], B[i - 1]); else B[i] = A[i]; } //  C C.back() = A.back(); for(int i = n - 2; i &gt;= 0; i--) { if((i + 1) % k) C[i] = max(A[i], C[i + 1]); else C[i] = A[i]; } } int GetMax(int l, int k) { return max(C[l], B[l + k - 1]); }</span></span></code> </pre> <br><br>  For proper operation, it is also necessary that K, supplied to the input of the build and GetMax functions, be the same. <br><br>  Obviously, this implementation of the build function is not optimal, but it is the most simple and straightforward.  At each next step, a new value is calculated based on the previous one.  Below is a faster implementation. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &gt; A, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> k)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = A.size(); B.resize(n); C.resize(n); B.front() = A.front(); C.back() = A.back(); k--; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i1(<span class="hljs-number"><span class="hljs-number">1</span></span>), i2(n - <span class="hljs-number"><span class="hljs-number">2</span></span>); i1 &lt; n; i1++, i2--) { B[i1] = (i1 % k) ? max(A[i1], B[i1 - <span class="hljs-number"><span class="hljs-number">1</span></span>]) : A[i1]; C[i2] = ((i2 + <span class="hljs-number"><span class="hljs-number">1</span></span>) % k) ? max(A[i2], C[i2 + <span class="hljs-number"><span class="hljs-number">1</span></span>]) : A[i2]; } }</code> </pre><br><br><h4>  Total </h4><br>  As you can see, the algorithm is very simple both in terms of implementation and in terms of understanding.  It gives the asymptotically best estimate O (1) for finding the maximum on a subsegment of a given length.  This structure is easy to change to find a minimum or amount.  In addition, the maximum number of possible options will be equal to NK, and therefore, using this structure, you can count all possible combinations for O (n).  At each time point, only two adjacent blocks of length K need to be stored in memory, which will reduce the size of the memory in more advanced implementations. <br><br><h6>  The authorship of the algorithm belongs to Van Hercu. </h6><br><br><h4>  Links </h4><br>  <a href="http://habrahabr.ru/blogs/algorithm/114980/">RMQ Task - 1. Static RMQ</a> <br>  <a href="http://habrahabr.ru/blogs/algorithm/115026/">RMQ Task - 2. Segment Tree</a> <br>  <a href="http://e-maxx.ru/algo/stacks_for_minima">Solving the same problem by modifying the stack (e-maxx)</a> <br>  <a href="http://e-maxx.ru/algo/rmq_linear">More about RMQ (e-maxx)</a> <br>  <a href="http://www.leptonica.com/grayscale-morphology.html">A large amount of information (in English)</a> </div><p>Source: <a href="https://habr.com/ru/post/116236/">https://habr.com/ru/post/116236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116228/index.html">OpenOffice Automation: Ending</a></li>
<li><a href="../116230/index.html">YouTube marks Earth Hour</a></li>
<li><a href="../116232/index.html">Inversion Control / Inversion of Control</a></li>
<li><a href="../116234/index.html">Full hiding of fields by properties in C #</a></li>
<li><a href="../116235/index.html">Bird twitter</a></li>
<li><a href="../116237/index.html">Universal templating for Kohana 3.1</a></li>
<li><a href="../116239/index.html">Daily Twitter Twitter in London</a></li>
<li><a href="../116240/index.html">Erlang web</a></li>
<li><a href="../116241/index.html">New release of open hypervisor Xen 4.1</a></li>
<li><a href="../116242/index.html">People routers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>