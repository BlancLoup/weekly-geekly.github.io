<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Heartbleed and his friends in 2015: how an advertising network endangers site visitors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On the first working day of the new year, I would like to draw the attention of site owners to the ads that they publish. Does your site work on HTTPS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Heartbleed and his friends in 2015: how an advertising network endangers site visitors</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/13b/875/c77/13b875c77c524fa4b7fe46a096ef20e5.png"><br><br>  On the first working day of the new year, I would like to draw the attention of site owners to the ads that they publish.  Does your site work on HTTPS, like all advertising scripts?  Do you use the latest software versions, only support secure protocols and cipher suites?  And the advertising system? <br><a name="habracut"></a><br>  Heartbleed is an error in OpenSSL that allows unauthorized reading of memory on a server up to 64 kilobytes in one request.  An attack can be performed infinitely many times.  The error was introduced in March 2012, and the vulnerability information was published <b><u>on April 8, 2014</u></b> (9 months ago). <br><br>  Articles on Habr√©: <br>  <a href="http://habrahabr.ru/post/218609/">Critical vulnerability in OpenSSL 1.0.1 and 1.0.2-beta</a> <br>  <a href="http://habrahabr.ru/post/218661/">Implications of OpenSSL HeartBleed</a> <br>  <a href="http://habrahabr.ru/post/219335/">What else does Heartbleed threaten a simple user with?</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      During the Christmas holidays, I was engaged in the implementation of HTTPS on a friend‚Äôs website.  It took several hours to eliminate mixed content (loading HTTP resources on an HTTPS page).  When it came to an end, I noticed a browser warning when scrolling down the page: <br><br><img src="https://habrastorage.org/files/d5d/1d7/243/d5d1d72436a84cc08eab8335cf6d6e0d.png"><br><br>  What, one more?  We look console: <br><br><img src="https://habrastorage.org/files/b78/2f2/bd2/b782f2bd20364526b46a29916fc3ef7c.png"><br><br>  See the script: <br><br><img src="https://habrastorage.org/files/3ea/c18/524/3eac18524d8c416aa62918babf11fab8.png"><br><br>  Everything here is pretty trite: the HTTP script Advertur is registered in the Adriver HTTPS script.  But I was interested in another warning: <br><blockquote>  content.adriver.ru: server does not support RFC 5746, see CVE-2009-3555 </blockquote>  This warning indicates that the server does not support <i>secure renegotiation</i> .  It was decided to test Adriver on <a href="https://www.ssllabs.com/">SSL Labs</a> : <br><br><img src="https://habrastorage.org/files/a39/df0/618/a39df0618e8a404997d3e3b374ff1de3.png"><br><br>  All content servers, except the 2nd and 4th, were rated C because of the vulnerability to <a href="http://habrahabr.ru/company/dsec/blog/240499/">POODLE against SSL3</a> .  But why did the second and fourth get an F rating?  Maybe they support SSL2?  Or unsafe reconnection?  Maybe they are vulnerable to <a href="http://habrahabr.ru/post/225381/">CVE-2014-0224</a> , as it was with Habrom itself for half a year (we are not robots)?  Or to <a href="https://www.imperialviolet.org/2014/12/08/poodleagain.html">POODLE vs. TLS</a> , as is often the case with banks and EPS?  The list can be continued with support for anonymous cipher suites and other vulnerabilities. <br><br>  But a terrible thing happened: <br><br><img src="https://habrastorage.org/files/488/3f3/56f/4883f356f7ca4f81a3b41e5c355b84a5.png"><br><br><img src="https://habrastorage.org/files/3a2/ea5/55b/3a2ea555b0fb4cf79ffe7b884d96a314.png"><br><br>  2 Adriver servers serving JavaScript are still subject to the most terrible vulnerability in the history of OpenSSL.  Server memory contains referrers, IP addresses, cookies, user agents, and so on. <br><br>  217.16.28.104 - masterh4.adriver.ru <br>  217.16.18.206 - masterh5.adriver.ru <br><br>  What is it fraught with?  The servers have a security certificate installed that is valid for all Adriver subdomains until the end of February 2016.  Possession of the private key of the certificate obtained from the server's memory will allow imperceptibly replacing JavaScript in browsers of visitors to sites with an installed Adriver advertisement (Habr falls into this category). <br><br>  Exploiting a vulnerability using <a href="https://gist.github.com/eelsivart/10174134">a Python script</a> : <br><blockquote>  python heartbleed.py masterh4.adriver.ru -n 100 -a dump.txt </blockquote>  This command will send 100 heartbeat messages to masterh4.adriver.ru and store the received data in dump.txt. <br><br>  Video: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/wrmpp_suZuA%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700253&amp;usg=ALkJrhjewDhdlHchDXoswqbKVyHGS_KwHQ" frameborder="0" allowfullscreen=""></iframe><br><br>  Conclusions and precautions: <br>  1. Installing advertising and tracking services, test their security.  Do not leave the site and its visitors vulnerable. <br>  2. Consider how relevant advertising and tracking on HTTPS sites.  In no case do not install third-party scripts on the order processing pages, as it is done, for example, by Yves Rocher. <br><br><img src="https://habrastorage.org/files/d6e/245/edc/d6e245edc12b43399ea48cc27a5a1495.png"><br><br>  Guaranteed! <br><br><img src="https://habrastorage.org/files/3c7/374/e51/3c7374e5197d4e12a9024215d5cf77b0.png"><br><br>  3. Site visitors should always block ads and trackers.  A more radical method is blocking connections to all Adriver servers. <br><br><blockquote>  83.222.14.88 <br>  217.16.28.104 <br>  217.16.18.207 <br>  217.16.18.206 <br>  77.109.110.134 <br>  217.16.18.163 <br>  217.16.18.213 <br>  77.109.85.18 <br>  217.16.18.214 <br>  83.222.14.222 <br>  81.222.128.98 <br>  195.209.111.3 <br>  195.209.111.2 <br>  81.222.128.22 <br>  81.222.128.23 </blockquote><br>  Report a vulnerability: <br><br>  Adriver <br><blockquote>  support@adriver.ru <br><br>  Moscow, Pokrovsky Boulevard, 3, building 1B <br>  (495) 981-34-00 <br><br>  St. Petersburg, st.  Savushkina, 83, Bldg.  3, letter A, (business center "Antares"), 6th floor <br>  (812) 438-10-74 </blockquote><br>  Masterhost <br><blockquote>  Multichannel phones <br>  (495) 772-97-20 <br>  (495) 956-97-20 <br>  Free phone for regions <br>  8-800-200-97-20 <br><br>  Technical support support@masterhost.ru <br>  Information about found vulnerabilities by security@masterhost.ru </blockquote><br>  Thawte (Adriver certificate publisher) <br><blockquote>  Chat - <a href="http://www.thawte.com/chat/chat_intro.html">www.thawte.com/chat/chat_intro.html</a> <br>  The list of phones - <a href="http://www.thawte.com/about/contact/index.html">www.thawte.com/about/contact/index.html</a> (Certificate Order Processing) </blockquote><br>  And may all your wishes come true! <br><br><img src="https://habrastorage.org/files/ee9/715/d1a/ee9715d1ae644e0885bffdd1b5dc3e36.png"></div><p>Source: <a href="https://habr.com/ru/post/247621/">https://habr.com/ru/post/247621/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../247607/index.html">Chart Wars: Charts Strike Back</a></li>
<li><a href="../247609/index.html">5 trends in data analysis and processing in 2015</a></li>
<li><a href="../247615/index.html">Packaging, Compression and Assembly Protection</a></li>
<li><a href="../247617/index.html">Is life possible without a template engine?</a></li>
<li><a href="../247619/index.html">Programming Philosophy 3 - Chichikov and Programmer</a></li>
<li><a href="../247625/index.html">Practical safety: trends and forecasts-2015</a></li>
<li><a href="../247629/index.html">Get to know Docker containers for a Django developer</a></li>
<li><a href="../247631/index.html">NetApp FAS and VMware ESXi: Swap</a></li>
<li><a href="../247635/index.html">Divide by zero is the norm. Part 1</a></li>
<li><a href="../247637/index.html">Say a word for a test plan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>