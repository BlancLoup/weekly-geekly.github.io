<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Secret codes, or as I wrote my application for android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think everyone who has a device based on the Android OS, although I would have heard a bit about the ‚Äúsecret codes‚Äù. 
 However, a search on Habr sho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Secret codes, or as I wrote my application for android</h1><div class="post__text post__text-html js-mediator-article">  I think everyone who has a device based on the Android OS, although I would have heard a bit about the ‚Äúsecret codes‚Äù. <br>  However, a search on Habr showed that there is not a single article on this topic.  But some codes are quite powerful: for example, one of the codes on my Samsung Galaxy Tab allows you to set up GPS, which speeds up the search for satellites, the other is to set the connection mode with the network (GPRS, EDGE, 3G ...) in places with unstable communication to save battery on jumps between modes. <br>  But I‚Äôm telling the story not so much about the possibilities of codes, but about the study of the mechanism of launching applications by codes in the Android OS, how to find all the codes (and the application in which it all turned out).  And a little more about how to make an application that will respond to your code. <br>  Under the cut there are 6 pictures, a bit of code and a lot of text ... I‚Äôm asking the most impatient to immediately post results at the end of the article and then read the technology. <br><a name="habracut"></a><br><br><h4>  Introduction </h4><br><br>  I heard about Android codes for a long time.  The most common is * # * # 4636 # * # * - this is information about the phone, battery, network status, etc. <br><img src="https://habrastorage.org/getpro/habr/post_images/33f/cf2/239/33fcf223997f6c64af4d94447625908a.png" alt="image"><br>  But recently I installed the <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.elsdoerfer.android.autostarts">Autostarts</a> program for <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.elsdoerfer.android.autostarts">myself</a> , did a search for installed applications, and ( <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.elsdoerfer.android.autostarts">lo</a> and <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.elsdoerfer.android.autostarts">behold</a> !) I saw the strange event ‚ÄúSecret Code Entered‚Äù.  A whole bunch of applications answered it!  This fact led me to a deeper search on this topic.  Here is what I found out: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      {Not wanting to load the main part of the public with unnecessary explanations, I solemnly swear to chew more details in incomprehensible sections in the comments if I become a member of a respected community.} <br><br><h4>  Part one.  Android events </h4><br><br>  As you know, every Android application contains a manifest.  This is a specially crafted XML file containing information about which target OS version, which resolution options the application needs to work, etc.  The most interesting part of this manifesto is the sections describing BroadcastReceivers.  These are classes that respond to certain events.  There are many of these events, for example: an outgoing call is made (android.intent.action.NEW_OUTGOING_CALL), the status of the flight mode has changed (android.intent.action.ACTION_AIRPLANE_MODE_CHANGED) ... The official list can be seen <a href="http://developer.android.com/reference/android/content/Intent.html">on the Android website</a> . <br>  However, the list is by no means full.  each application can create its own event.  This causes some chaos in the documentation when trying to figure out what the application might react to. <br><br>  It was in this chaos that an event that is of great interest successfully hid: android.provider.Telephony.SECRET_CODE <br><br>  As shown by the opening of the source codes of the regular dialer in Android, when you enter something starting with * # * and ending with # * # * in the dialer, the message is sent and transmitted to that BroadcastRecever that is listening to this particular code (what is between * # * # and # * # *) <br><br><h4>  Part two.  We respond to the code </h4><br><br>  Now let's see what is required from the application to react to the occurrence of this event: <br><br> <code>&lt;receiver android:name=".receivers.DebugReceiver"&gt; <br> &lt;intent-filter&gt; <br> &lt;action android:name="android.provider.Telephony.SECRET_CODE" /&gt; <br> &lt;data android:scheme="android_secret_code" android:host="727" /&gt; <br> &lt;/intent-filter&gt; <br></code> <br><br>  Where: <br>  &lt;receiver android: name = ". receivers.DebugReceiver"&gt; - the beginning of the BroadcastReceiver section and an indication of which Receiver should be called when this event occurs. <br>  &lt;action android: name = "android.provider.Telephony.SECRET_CODE" /&gt; is the event to which the receiver responds, a set of code. <br>  &lt;data android: scheme = "android_secret_code" android: host = "727" /&gt; - and here is the most interesting place.  The data block is responsible for additional event parameters and for a secret code event - mandatory.  The android: host field here means exactly the code that awakens our sleeping beauty from sleep. <br>  Those.  to run Receiver ".receivers.DebugReceiver", applications from the manifest of which this block (about it a little later), you need to dial * 7 * # 727 # * # * <br><br>  As you can see, it‚Äôs very easy to add hidden features to your Android apps. <br>  What do I do in Receiver, I will keep silent, there is already your own path, personally I - cause a debugging Activity. <br><br><h4>  Part Three  We are looking for partisans </h4><br><br>  We now turn to the search for Receivers reacting to codes.  The first thought (and the first implementation) was the following code: <br> <code>for(int i=0;i&lt;10000;i++) <br> { <br> Intent intent = new Intent("android.provider.Telephony.SECRET_CODE", <br> Uri.parse("android_secret_code://"+ i.toString())); <br> ComponentName cn = intent.resolveActivity(pm); <br> .... <br> } <br></code> <br><br>  I don‚Äôt remember exactly the code, it was overwritten as unnecessary since a better solution was found.  This solution simply enumerates all codes from 0 to 10,000, the range in which a significant part of the codes are located.  But not all. <br>  It was this ‚Äúnot all‚Äù that prompted me to a more detailed search and led to a new solution: <br>  1) Take a list of all installed applications via PackageManager: <br> <code>List&lt;android.content.pm.PackageInfo&gt; pil = pm.getInstalledPackages(PackageManager.GET_DISABLED_COMPONENTS); <br></code> <br>  2) From each package we take out its manifest: <br> <code>AssetManager am = context.createPackageContext(p.packageName, 0).getAssets(); <br> xml = assets.openXmlResourceParser("AndroidManifest.xml"); <br></code> <br>  3) Simple magic with the analysis of the manifest and the search for the necessary Receivers, IntentFilters, Actions. <br>  4) Profit. <br><br>  This method has only one drawback: it was noticed on the <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.noshufou.android.su">ChainsDD SuperUser</a> application.  The fact is that this application has a curve manifest that looks something like this: <br><br> <code>&lt;receiver android:name=".receivers.DebugReceiver"&gt; <br> &lt;intent-filter&gt; <br> &lt;action android:name="android.provider.Telephony.SECRET_CODE" /&gt; <br> &lt;data android:scheme="android_secret_code"/&gt; <br> &lt;/intent-filter&gt; <br></code> <br><br><br>  As you can see, it does not indicate the code to which it should react and Receiver is called when entering any code.  By decompiling this program I made sure that it was done by mistake and not following the desire to keep a log of all entered codes, since  in Receiver itself, the code is checked for equality of the specified value and if the code is not equal to the specified one, then nothing happens: (i.e. this Receiver is launched each time the code is entered, which could have been avoided by specifying which code should wake Receiver. <br><br><h4>  Part last.  For the most patient. </h4><br><br>  The last part left for the presentation of the results. <br>  The result of all these investigations was a wonderful (I‚Äôm not afraid of this word) program, which had no analogues on the market: <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.afp_group.software">Secret Codes</a> <br><br>  In addition to the possibility described above, the program also allows you to search for secret codes: <br>  - Run the codes found <br>  - Comment / read other users' comments about codes.  This is done so that people who are afraid of FactoryFormat can make sure that the code is safe before it is launched, and the reckless experimenters write what this or that code does.  I personally launched ALL the available codes on the Samsung Galaxy Tab 7 "and commented on all the codes that display at least some information. (By the way, I successfully survived FactoryFormat, because I made a backup of all applications and data beforehand.) <br>  - Assign badges to codes for greater visibility of the code list. <br><br>  For a snack, 6 screenshots: <br>  Main Activity: <br><img src="http://habrastorage.org/storage2/2f5/c44/f45/2f5c44f454fc32e46f8d80746e537a87.png" alt="image"><br><br>  Activity search codes: <br><img src="http://habrastorage.org/storage2/667/741/053/667741053ab39eebfc25f5a05f9a4f5f.png" alt="image"><br><br>  Code search complete: <br><img src="http://habrastorage.org/storage2/29c/eca/f80/29cecaf80393ea3b207d228f77d5ac98.png" alt="image"><br><br>  List of codes: <br><img src="http://habrastorage.org/storage2/050/f42/747/050f427479cbe5e7dc6ce49bb6052f90.png" alt="image"><br><br>  Activity code: <br><img src="http://habrastorage.org/storage2/6f9/6bc/880/6f96bc88090bfc48ac81d6e708975c21.png" alt="image"><br><br>  Some of the available icons for code designation include: <br><img src="http://habrastorage.org/storage2/ea3/aec/de2/ea3aecde2a67da21dfd10d23f6b967ea.png" alt="image"><br><br>  PS on SreenShot'ah only 3 codes  They were made on the emulator.  On my Galaxy Tab, there are more than 100 of them. <br><br>  <s>PPS article was published at the request of Vladislav Aksyonov due to the absence of his account (who liked the article and did not mind the invite, here‚Äôs an e-mail, send: grafmailgraf@mail.ru).</s> <br>  Wrote an article <a href="https://habrahabr.ru/users/blackswan/" class="user_link">BlackSwan</a> .  Thanks <a href="https://habrahabr.ru/users/krovatti/" class="user_link">krovatti</a> for an invite! <br><br>  Here is the QR-ka: <br><img src="http://habrastorage.org/storage2/af1/6b0/85a/af16b085a72970c880f3a6c75058f95e.png" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/141890/">https://habr.com/ru/post/141890/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141884/index.html">Pomatrosil and quit: Google sells Motorola</a></li>
<li><a href="../141885/index.html">The perfect Android player for non-music</a></li>
<li><a href="../141886/index.html">TOP-3 Hi-tech: Fashionable Gadgets for Pets</a></li>
<li><a href="../141887/index.html">DasKeyboard and RetroMouse raffle on Technology Forum</a></li>
<li><a href="../141889/index.html">Plan your flights in Yandex</a></li>
<li><a href="../141891/index.html">A bug was detected in Nokia Lumia 900, each buyer will receive a compensation of $ 100</a></li>
<li><a href="../141893/index.html">Mystery of the Japanese Tiger or Space Translation Contest</a></li>
<li><a href="../141894/index.html">Digital without silicone - a conference for those who have to plan advertising on the Web</a></li>
<li><a href="../141895/index.html">ISO 9001 in IT companies</a></li>
<li><a href="../141897/index.html">Chaordic teaching or what is common between Agile and IT education</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>