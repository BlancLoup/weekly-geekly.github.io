<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHP: arrays returned by a function</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I like PHP (if you don‚Äôt like it - please forget about this topic. You don‚Äôt have to do a holivar), and I also like one thing that is right everywhere...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHP: arrays returned by a function</h1><div class="post__text post__text-html js-mediator-article"> I like PHP (if you don‚Äôt like it - please forget about this topic. You don‚Äôt have to do a holivar), and I also like one thing that is right everywhere, but not in PHP: <br><br> <code>superFunction(foo, bar)[2]; <br></code> <br><br>  What does this code do?  Right!  Returns the third element of the array, which returns superFunction () with arguments foo and bar. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In PHP syntax, it would look like this: <br><br> <code>superFunction($foo, $bar)[2]; <br></code> <br><br>  Here only this code issues Parse Error.  ‚ÄúAnd rightly so!‚Äù - screams of haters of syntactic sugar are heard already.  I suggest that they also go far away from this topic, so as not to holivarit and not to prove that it is not necessary (look at what blog I posted it, after all). <br><br>  On the PHP site, I learned that the developers do not plan to allow this syntax even in version 6.  Well damn.  I myself - well done!  So, over the night I wrote a small class, which, if used correctly, allows you to work with arrays humanly. <br><br><a name="habracut"></a><br><br><h4>  Does it work? </h4><br><br>  Yes, Preparser works.  After several hours of debugging, I was able to teach him not to fail, processing one of my ‚Äúbig‚Äù applications using the Zend Framework and a thousand things in a row.  From which I conclude that it will not fail by default. <br>  It works quickly.  Yes, it parses all connected (include, etc.) files and changes everything there as it wants.  But Preparser caches the processed code, of course, neatly caches and connects with the usual include when the script is re-run, which does not take extra CPU time at all.  By the way, Preparser checks the date of file modification, so you can not worry about clearing the cache with each modified line. <br>  Already otparsennye files perform the construction of func () [] without loss of performance.  There is nothing terrible happening at all :) <br><br>  It works simply.  In order to take and translate well, everything is straightforward for a huge, large application on Preparser, you need to write 2 or there I don‚Äôt know, 3 lines.  If you program by changing global variables in include, then you have to add a few more lines.  But you are adults and have not been doing such bjak for a long time, right? <br>  By the way, global variables from include will cease to change, but the command return $ smth;  will work. <br>  And also: for compatibility with Zend_View in all the files inside classes, $ this continues to work. <br>  So, if you write using the Zend Framework, then everything will be fine.  If you have some other civil framework without ugliness like global variables - most likely, everything will be fine (I didn‚Äôt check, I‚Äôll be happy with your feedback!).  Well, if not, I don‚Äôt know, it‚Äôs still worth a try, it's a blessing.  At the same time tell me what I'm wrong :) <br><br>  Oh yes, Preparcer needs PHP branches 5.3.  :) <br><br><h4>  What's up? </h4><br><br>  Preparser works with files that are loaded through it, as well as files that are loaded by those files that are loaded through it.  You probably did not understand the previous phrase.  Okay. <br><br><h5>  Option 1: play around </h5><br><br>  The bottom line is this: in order to use the func () [2] construct in a php file, it needs to be connected via Preparser.  Ie, create, say, index.php and hooray.php: <br> <code>&lt;? // index.php <br> <br> //  include_path()    <br> require_once '/library/Preparser.php'; <br> <br> //  ,  .       ! <br> Preparser\setCachePath('/../data/preparserCache/'); <br> <br> Preparser\requirePreparsed_once('hooray.php'); <br></code> <br><br>  Now you can use the most terrible constructions in hooray.php (in / tests/dereferencing.php you can find examples): <br><br> <code>&lt;? // hooray.php <br> <br> assert( array('a' =&gt; 1, 'b' =&gt; 2)['a'] == 1 ); <br> <br> function ret_anything($lol) { <br> return $lol; <br> } <br> <br> assert( ret_anything( array(1, 2, ret_anything(4), ret_anything(array(1, 2, 3))[1])[ ret_anything(array(1, 2, 3))[ret_anything(array(1, 2, 3))[1]] ]) == 2 ); <br> <br></code> <br><br><h5>  Option 2: transfer the project to Preparser </h5><br><br>  Here's how I changed index.php for one cool site: <br> <code>&lt;? <br> //       set_include_path() <br> <br> require_once '/Preparser.php'; <br> Preparser\setCachePath(APPLICATION_PATH . '/../data/preparserCache/'); <br> <br> //: require_once 'Zend/Application.php'; <br> Preparser\requirePreparsed_once('Zend/Application.php'); <br> <br> // Create application, bootstrap, and run <br> $application = new Zend_Application( <br> APPLICATION_ENV, <br> APPLICATION_PATH . '/configs/application.ini' <br> ); <br> <br> $application-&gt;bootstrap() <br> -&gt;run(); <br></code> <br><br>  Added two lines, and then changed one.  Very difficult!  Then I opened index.php in the browser and waited (long enough, almost a minute) until the cache was formed.  After that, everything worked quickly and without a hitch. <br><br><h4>  Underwater rocks? </h4><br><br>  I do not know what kind of pitfalls there are.  I tried to work carefully.  The global namespace is not cluttered.  A freshly inclined file will not receive a bunch of variables as a gift; it will not receive any at all, except, perhaps, $ this.  Well, you can also connect your global variables with the global directive. <br><br>  I think you will find these stones faster than me - I will be happy for your feedback! <br><br><h4>  Where to get? </h4><br><br>  And, take this from <a href="http://code.google.com/p/php-preparser/">GoogleCode</a> .  Open Source.  License New BSD, I did not go into details, but it seems you can use it as you want and you don‚Äôt have to open your code :) <br><br>  <a href="http://code.google.com/p/php-preparser/">There</a> still is not even started manual.  I will be glad if someone helps me to write it ... <br><br><h4>  How to help? </h4><br>  ... yes, I will be glad if someone helps me to write manuals and stuff.  I‚Äôm really bad at speaking English, so I‚Äôm a little ashamed of everything I‚Äôve written in README.txt and HOWTOS.txt.  I will be grateful for correcting the mistakes there too, but one is a request: do not write about them in the comments here in the factory, so as not to foul up these very comments with temporary and meaningful messages.  I have different mails, for example, preparser@va1en0k.net <br><br>  I will also be grateful for the testing.  Well, and - especially - for the patches. <br><br>  Ficrekvesty required.  I think that much more would be worth teaching a php parser. <br><br>  Thanks for attention! <br><br>  I did this, of course, out of boredom and I do not promise any support or justification for the necessity of existence. 8) </div><p>Source: <a href="https://habr.com/ru/post/73358/">https://habr.com/ru/post/73358/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../73347/index.html">Configuration Management (Part 2, Tool Review)</a></li>
<li><a href="../73348/index.html">Green Plastic</a></li>
<li><a href="../73351/index.html">Work with program version numbers</a></li>
<li><a href="../73352/index.html">DataBinder and speed</a></li>
<li><a href="../73357/index.html">Cyber ‚Äã‚ÄãCleanser Gel (Cyber ‚Äã‚ÄãClean¬Æ)</a></li>
<li><a href="../73359/index.html">.NET 4.0: What's new in base classes (BCL)? Detailed review</a></li>
<li><a href="../73361/index.html">Does the Higgs boson sabotage the Large Hadron Collider?</a></li>
<li><a href="../73362/index.html">Baby dictionary</a></li>
<li><a href="../73363/index.html">Whoer.net - service for checking your anonymity</a></li>
<li><a href="../73364/index.html">Item ‚ÄúProperties‚Äù will be removed from the context menu of the Firefox browser (but you can use the extension)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>