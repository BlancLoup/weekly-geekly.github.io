<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open machine learning course. Topic 1. Primary data analysis with Pandas</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The course consists of: 


- 10 articles on Habr√© (and the same on Medium in English) 
- 10 lectures ( Youtube channel in Russian + more recent lectur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open machine learning course. Topic 1. Primary data analysis with Pandas</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/10c/15f/f3d/10c15ff3dcb14abdbabdac53fed6d825.jpg"></div><br><br><p>  The course consists of: </p><br><ul><li>  10 articles on Habr√© (and the same on <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-1-exploratory-data-analysis-with-pandas-de57880f1a68">Medium</a> in English) </li><li>  10 lectures ( <a href="https://www.youtube.com/playlist%3Flist%3DPLVlY_7IJCMJdgcCtQfzj5j8OVB_Y0GJCl">Youtube</a> channel in Russian + more recent <a href="https://www.youtube.com/watch%3Fv%3DQKTuw4PNOsU%26list%3DPLVlY_7IJCMJeRfZ68eVfEcu-UcN9BbwiX">lectures</a> in English), a detailed description of each topic - in <a href="https://habrahabr.ru/company/ods/blog/344044/">this</a> article </li><li>  reproducible materials (Jupyter notebooks) in <a href="">the</a> mlcourse.ai <a href="">repository</a> and in the form of <a href="https://www.kaggle.com/kashnitsky/mlcourse">Kaggle Dataset</a> (only a browser is needed) </li><li>  excellent Kaggle Inclass competitions (not on "xgboost glass", but on building signs) </li><li>  homework for each topic (in the repository - a <a href="https://github.com/Yorko/mlcourse.ai/wiki/About-the-course-(in-Russian)">list of</a> demo versions of tasks) </li><li>  motivating rating, an abundance of live communication and quick feedback from the authors </li></ul><br><p>  The current launch of the course - from <strong>October 1,</strong> 2018 in English ( <a href="https://docs.google.com/forms/d/1_pDNuVHwBxV5wuOcdaXoxBZneyAQcqfOl4V2qkqKbNQ">link</a> to the survey to participate, fill in English).  Follow the announcements in <a href="https://vk.com/mlcourse">the</a> VC <a href="https://vk.com/mlcourse">group</a> , join the OpenDataScience community. </p><a name="habracut"></a><br><h3 id="spisok-statey-serii">  List of articles series </h3><br><ol><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Primary data analysis with Pandas</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Visual data analysis with Python</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322534/">Classification, decision trees and the method of nearest neighbors</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323890/">Linear classification and regression models</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Compositions: bagging, random forest</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325422/">Construction and selection of signs.</a>  <a href="https://habrahabr.ru/company/ods/blog/325422/">Applications for word processing, image and geodata tasks</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325654/">Teaching without a teacher: PCA, clustering</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/326418/">Training in gigabytes with Vowpal Wabbit</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/327242/">Time Series Analysis with Python</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/327250/">Gradient boosting</a> </li></ol><br><h3 id="plan-etoy-stati">  Plan for this article </h3><br><ol><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">About the course</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Homework in the know</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Demonstration of the main methods of Pandas</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">First attempts to predict churn</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Homework number 1</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Overview of useful resources</a> </li></ol><br><h2 id="1-o-kurse">  1. About the course </h2><br><p>  We do not set ourselves the task of developing another <em>comprehensive</em> introductory course on machine learning or data analysis (that is, it is not a substitute for the specialization of Yandex and MIPT, additional education of HSE and other fundamental online and offline programs and books).  The purpose of this series of articles is to quickly refresh your knowledge or help find topics for further study.  The approach is approximately the same as that of the authors of the book <em>Deep Learning</em> , which begins with a review of mathematics and the basics of machine learning - a brief, very capacious and with an abundance of references to sources. </p><br><p>  If you plan to complete the course, then we warn you: when selecting topics and creating materials, we focus on the fact that our students know <strong>mathematics at the second-year level of a</strong> technical college and at least know how to <strong>program in Python</strong> .  These are not strict selection criteria, but only recommendations - you can enroll in a course without knowing mathematics or Python, and in parallel build up: </p><br><ul><li>  basic mathematics (mathematical analysis, linear algebra, optimization, theorever and statistics) can be repeated on <a href="https://yadi.sk/d/yEXkABC_353Zmh">these</a> abstracts of Yandex &amp; MIPT (we share with permission).  Briefly, in Russian - what you need.  If in detail, matan - Kudryavtsev, linal - Kostrikin, optimization - Boyd (English), theorever and statistics - Kibzun.  Plus excellent online courses MIPT and HSE on Coursera; </li><li>  Python is enough for a small interactive tutorial on Datacamp or <a href="https://github.com/yorko/python_intro">this</a> Python <a href="https://github.com/yorko/python_intro">repository</a> and basic algorithms and data structures.  Something more advanced is, for example, <a href="https://compscicenter.ru/courses/python/2015-autumn/">the</a> St. Petersburg Computer Science Center; </li><li>  as for machine learning, that is the classic (but slightly outdated) Andrew Ng "Machine Learning" course (Stanford, Coursera).  In Russian there is an excellent specialization of MIPT and Yandex "Machine learning and data analysis."  And here are the best books: "Pattern recognition and Machine Learning" (Bishop), "Machine Learning: A Probabilistic Perspective" (Murphy), "The elements of statistical learning" (Hastie, Tibshirani, Friedman), "Deep Learning" (Goodfellow , Bengio, Courville).  The book Goodfellow begins with a review of mathematics and a clear and interesting introduction to machine learning and the internal structure of its algorithms.  It's nice that now about deep learning there is a book in Russian - ‚ÄúDeep Learning: Immersion in the World of Neural Networks‚Äù (Nikolenko S.I., Kadurin A.A., Arkhangelskaya Ye.O.). </li></ul><br><p>  Also about the course described in <a href="https://habrahabr.ru/company/ods/blog/344044/">this</a> announcement. </p><br><h3 id="kakoe-po-nuzhno">  What software is needed </h3><br><p>  To complete the course you need a number of Python packages, most of them are in the <a href="https://www.continuum.io/downloads">Anaconda</a> build with Python 3.6.  Other libraries will be needed a little later, this will be discussed later.  The full list can be viewed in the <a href="https://github.com/Yorko/mlcourse.ai/blob/master/Dockerfile">Dockerfile</a> . </p><br><p>  You can also use a Docker container in which all the necessary software is already installed.  Details are on <a href="https://github.com/Yorko/mlcourse.ai/wiki/Software-requirements-and-Docker-container-(in-Russian)">the</a> Wiki <a href="">repository</a> <a href="https://github.com/Yorko/mlcourse.ai/wiki/Software-requirements-and-Docker-container-(in-Russian)">page</a> . </p><br><h3 id="kak-podklyuchitsya-k-kursu">  How to connect to the course </h3><br><p>  No formal registration is required, you can connect to the course at any time after the start (10/01/18), but homework deadlines are tight. <br>  But so that we know more about you: </p><br><ul><li>  Fill <a href="https://docs.google.com/forms/d/1_pDNuVHwBxV5wuOcdaXoxBZneyAQcqfOl4V2qkqKbNQ/edit">out the survey</a> , indicating in it the <em>real</em> name; </li><li>  <a href="http://ods.ai/">Join</a> the OpenDataScience community, the course is under discussion in the channel <em># mlcourse.ai</em> . </li></ul><br><h2 id="2-domashnie-zadaniya-v-kurse">  2. Homework in the know </h2><br><ul><li>  Each article is accompanied by homework in the form of a notebook <a href="http://jupyter.org/">Jupyter</a> , in which you need to add the code, and based on this, choose the correct answer in the form of Google; </li><li>  Homework solutions are sent to those who sent the solution in the form; </li><li>  At the end of a series of articles will be summed up (rating of participants); </li><li>  Examples of homework are given in the articles of the series (at the end). </li></ul><br><h2 id="3-demonstraciya-osnovnyh-metodov-pandas">  3. Demonstration of the main methods of Pandas </h2><br><p> <em>All code can be reproduced in <a href="https://github.com/Yorko/mlcourse.ai/blob/master/jupyter_russian/topic01_pandas_data_analysis/topic1_habr_pandas.ipynb">this</a> Jupyter notebook.</em> </p><br><p>  <strong><a href="http://pandas.pydata.org/">Pandas</a></strong> is a Python library that provides extensive data analysis capabilities.  The data that datasenists work with is often stored in the form of tablets ‚Äî for example, in .csv, .tsv, or .xlsx formats.  Using the Pandas library, such tabular data is very convenient to load, process and analyze using SQL-like queries.  And in conjunction with the libraries Matplotlib and Seaborn Pandas provides ample opportunities for visual analysis of tabular data. </p><br><p>  The main data structures in Pandas are the <strong>Series</strong> and <strong>DataFrame classes</strong> .  The first one is a one-dimensional indexed data array of some fixed type.  The second is a two-dimensional data structure, which is a table, each column of which contains data of one type.  You can think of it as a dictionary of Series objects.  The DataFrame structure is great for representing real data: the rows correspond to feature descriptions of individual objects, and the columns correspond to features. </p><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  Pandas  Numpy import pandas as pd import numpy as np</span></span></code> </pre> <br><p>  We will show the main methods in the business, analyzing a <a href="https://bigml.com/user/francisco/gallery/dataset/5163ad540c0b5e5b22000383">set of data</a> on the outflow of customers of the telecom operator (no need to download, it is in the repository).  Let's read the data (the <code>read_csv</code> method) and look at the first 5 lines using the <code>head</code> method: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">df</span></span> = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'../../data/telecom_churn.csv'</span></span>)</code> </pre> <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.head</span></span>()</code> </pre> <br><img src="https://habrastorage.org/files/978/022/6a8/9780226a800b4a1da342daaa966b4a0e.png"><br><br><div class="spoiler">  <b class="spoiler_title">About the withdrawal of the data frame in the notebook Jupyter</b> <div class="spoiler_text"><p>  In Jupyter laptops, Pandas data frames are displayed in the form of such beautiful tablets, and <code>print(df.head())</code> looks worse. <br>  By default, Pandas displays only 20 columns and 60 rows, so if your data frame is more, use the <code>set_option</code> function: </p><br><pre> <code class="hljs cs">pd.set_option(<span class="hljs-string"><span class="hljs-string">'display.max_columns'</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) pd.set_option(<span class="hljs-string"><span class="hljs-string">'display.max_rows'</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre> </div></div><br><p>  Each line represents a single client - this is the <strong>object of</strong> study. <br>  Columns - <strong>signs of the</strong> object. </p><br><div class="spoiler">  <b class="spoiler_title">Feature description</b> <div class="spoiler_text"><table><thead><tr><th>  Title </th><th>  Description </th><th>  Type of </th></tr></thead><tbody><tr><td>  <strong>State</strong> </td><td>  State letter code </td><td>  nominal </td></tr><tr><td>  <strong>Account length</strong> </td><td>  How long does a customer have been served by the company? </td><td>  quantitative </td></tr><tr><td>  <strong>Area code</strong> </td><td>  Phone number prefix </td><td>  quantitative </td></tr><tr><td>  <strong>International plan</strong> </td><td>  International roaming (connected / not connected) </td><td>  binary </td></tr><tr><td>  <strong>Voice mail plan</strong> </td><td>  Voicemail (connected / not connected) </td><td>  binary </td></tr><tr><td>  <strong>Number vmail messages</strong> </td><td>  Number of voice messages </td><td>  quantitative </td></tr><tr><td>  <strong>Total day minutes</strong> </td><td>  Total duration of conversations in the afternoon </td><td>  quantitative </td></tr><tr><td>  <strong>Total day calls</strong> </td><td>  Total number of calls during the day </td><td>  quantitative </td></tr><tr><td>  <strong>Total day charge</strong> </td><td>  Total amount of payment for services in the afternoon </td><td>  quantitative </td></tr><tr><td>  <strong>Total eve minutes</strong> </td><td>  The total duration of conversations in the evening </td><td>  quantitative </td></tr><tr><td>  <strong>Total eve calls</strong> </td><td>  Total number of calls in the evening </td><td>  quantitative </td></tr><tr><td>  <strong>Total eve charge</strong> </td><td>  The total amount of payment for services in the evening </td><td>  quantitative </td></tr><tr><td>  <strong>Total night minutes</strong> </td><td>  The total duration of conversations at night </td><td>  quantitative </td></tr><tr><td>  <strong>Total night calls</strong> </td><td>  Total number of calls at night </td><td>  quantitative </td></tr><tr><td>  <strong>Total night charge</strong> </td><td>  Total payment for services at night </td><td>  quantitative </td></tr><tr><td>  <strong>Total intl minutes</strong> </td><td>  Total duration of international calls </td><td>  quantitative </td></tr><tr><td>  <strong>Total intl calls</strong> </td><td>  Total international calls </td><td>  quantitative </td></tr><tr><td>  <strong>Total intl charge</strong> </td><td>  Total amount of payment for international calls </td><td>  quantitative </td></tr><tr><td>  <strong>Customer service calls</strong> </td><td>  The number of calls to the service center </td><td>  quantitative </td></tr></tbody></table><br><p>  Target variable: <strong>Churn</strong> - <strong>Outflow</strong> symptom, binary sign (1 - client loss, i.e. outflow).  Then we will build models that predict this sign for the rest, so we called it target. </p></div></div><br><p>  Let's look at the size of the data, the names of features and their types. </p><br><pre> <code class="hljs lisp">print(<span class="hljs-name"><span class="hljs-name">df</span></span>.shape)</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">3333</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)</code> </pre> <br><p>  We see that in table 3333 rows and 20 columns.  Let's output the column names: </p><br><pre> <code class="hljs lisp">print(<span class="hljs-name"><span class="hljs-name">df</span></span>.columns)</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>([<span class="hljs-string"><span class="hljs-string">'State'</span></span>, <span class="hljs-string"><span class="hljs-string">'Account length'</span></span>, <span class="hljs-string"><span class="hljs-string">'Area code'</span></span>, <span class="hljs-string"><span class="hljs-string">'International plan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Number vmail messages'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total day minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total day calls'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total day charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total eve minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total eve calls'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total eve charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total night minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total night calls'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total night charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total intl minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total intl calls'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total intl charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Customer service calls'</span></span>, <span class="hljs-string"><span class="hljs-string">'Churn'</span></span>], dtype=<span class="hljs-string"><span class="hljs-string">'object'</span></span>)</code> </pre> <br><p>  To view general information on the data frame and all features, use the <strong><code>info</code></strong> method: </p><br><pre> <code class="hljs lisp">print(<span class="hljs-name"><span class="hljs-name">df</span></span>.info())</code> </pre> <cut></cut><br><pre> <code class="hljs pgsql">&lt;<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-string"><span class="hljs-string">'pandas.core.frame.DataFrame'</span></span>&gt; Range<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>: <span class="hljs-number"><span class="hljs-number">3333</span></span> entries, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">3332</span></span> Data <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> (total <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>): State <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Account length <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Area code <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 International plan <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Voice mail plan <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Number vmail messages <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total day minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total day calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total day charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total eve minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total eve calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total eve charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total night minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total night calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total night charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total intl minutes <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Total intl calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Total intl charge <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> float64 Customer service calls <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 Churn <span class="hljs-number"><span class="hljs-number">3333</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> dtypes: <span class="hljs-type"><span class="hljs-type">bool</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>), float64(<span class="hljs-number"><span class="hljs-number">8</span></span>), int64(<span class="hljs-number"><span class="hljs-number">8</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>) memory <span class="hljs-keyword"><span class="hljs-keyword">usage</span></span>: <span class="hljs-number"><span class="hljs-number">498.1</span></span>+ KB <span class="hljs-keyword"><span class="hljs-keyword">None</span></span></code> </pre> <br><p>  <code>bool</code> , <code>int64</code> , <code>float64</code> and <code>object</code> are the types of attributes.  We see that 1 sign is logical (bool), 3 signs are of object type and 16 signs are numeric.  Also, using the <code>info</code> method, it is convenient to quickly look at the gaps in the data, in our case they are not there, there are 3333 observations in each column. </p><br><p>  <strong>You</strong> can <strong>change the column type</strong> using the <code>astype</code> method.  Apply this method to the <code>Churn</code> feature and translate it to <code>int64</code> : </p><br><pre> <code class="hljs cs">df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>].astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>)</code> </pre> <br><p>  The <strong><code>describe</code></strong> method shows the main statistical characteristics of the data for each numeric attribute (types <code>int64</code> and <code>float64</code> ): the number of non-omitted values, mean, standard deviation, range, median, 0.25 and 0.75 quartiles. </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.describe</span></span>()</code> </pre> <br><img src="https://habrastorage.org/files/7d2/ca9/ba8/7d2ca9ba80ed4611b2388b6c6170befb.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  To view statistics on non-numeric characters, you need to explicitly specify the types of interest in the <code>include</code> parameter. </p><br><pre> <code class="hljs pgsql">df.describe(<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>=[<span class="hljs-string"><span class="hljs-string">'object'</span></span>, <span class="hljs-string"><span class="hljs-string">'bool'</span></span>])</code> </pre> <br><table border="1"><thead><tr><th></th><th>  State </th><th>  International plan </th><th>  Voice mail plan </th></tr></thead><tbody><tr><th>  count </th><td>  3333 </td><td>  3333 </td><td>  3333 </td></tr><tr><th>  unique </th><td>  51 </td><td>  2 </td><td>  2 </td></tr><tr><th>  top </th><td>  WV </td><td>  No </td><td>  No </td></tr><tr><th>  freq </th><td>  106 </td><td>  3010 </td><td>  2411 </td></tr></tbody></table><br><br><p>  For categorical ( <code>object</code> type) and boolean ( <code>bool</code> type) attributes, you can use the <strong><code>value_counts</code></strong> method.  Let's look at the distribution of data on our target variable - <code>Churn</code> : </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">['Churn']</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.value_counts</span></span>()</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2850</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">483</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>: Churn, dtype: int64</code> </pre> <br><p>  2850 users out of 3333 are loyal, the value of the <code>Churn</code> variable is <code>0</code> . </p><br><p>  Let's look at the distribution of users by the variable <code>Area code</code> .  Specify the value of the parameter <code>normalize=True</code> to view not absolute frequencies, but relative ones. </p><br><pre> <code class="hljs pgsql">df[<span class="hljs-string"><span class="hljs-string">'Area code'</span></span>].value_counts(normalize=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><pre> <code class="hljs css">415 0<span class="hljs-selector-class"><span class="hljs-selector-class">.496550</span></span> 510 0<span class="hljs-selector-class"><span class="hljs-selector-class">.252025</span></span> 408 0<span class="hljs-selector-class"><span class="hljs-selector-class">.251425</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Name</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Area</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">code</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">dtype</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">float64</span></span></code> </pre> <br><h3 id="sortirovka">  Sorting </h3><br><p>  DataFrame can be sorted by the value of any of the signs.  In our case, for example, by <code>Total day charge</code> ( <code>ascending=False</code> for sorting in descending order): </p><br><pre> <code class="hljs cs">df.sort_values(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>=<span class="hljs-string"><span class="hljs-string">'Total day charge'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ascending</span></span>=False).head()</code> </pre> <br><img src="https://habrastorage.org/files/dd2/759/ada/dd2759ada8644838a54d2f355b9fec51.png"><br><br><p>  You can also sort by column group: </p><br><pre> <code class="hljs pgsql">df.sort_values(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>=[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total day charge'</span></span>], ascending=[<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>]).head()</code> </pre> <br><p>  <em>Thanks for the comment about the outdated sort of</em> <a href="https://habr.com/users/makkos/" class="user_link">makkos</a> </p><br><img src="https://habrastorage.org/files/b77/c81/8f5/b77c818f5c2448ddac8dc586985198c1.png"><br><br><h3 id="indeksaciya-i-izvlechenie-dannyh">  Indexing and data retrieval </h3><br><p>  DataFrame can be indexed in different ways.  In this regard, we consider various ways of indexing and extracting the data we need from a data frame using simple questions as an example. </p><br><p>  To retrieve a single column, you can use the construction of the form <code>DataFrame['Name']</code> .  We use this to answer the question: <strong>what is the proportion of people disloyal users in our data frame?</strong> </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">['Churn']</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.mean</span></span>(). # : 0<span class="hljs-selector-class"><span class="hljs-selector-class">.14491449144914492</span></span></code> </pre> <br><p>  14.5% is a rather bad indicator for a company, with such a percentage of churn you can go broke. </p><br><p>  <strong>Logical indexing of a</strong> DataFrame on one column is very convenient.  It looks like this: <code>df[P(df['Name'])]</code> , where <code>P</code> is some logical condition, checked for each element of the <code>Name</code> column.  The result of this indexing is a DataFrame, consisting only of rows that satisfy the condition <code>P</code> on the <code>Name</code> column. </p><br><p>  We will use this to answer the question: <strong>what are the mean values ‚Äã‚Äãof numerical attributes among disloyal users?</strong> </p><br><pre> <code class="hljs matlab">df[df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>] == <span class="hljs-number"><span class="hljs-number">1</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">mean</span></span>()</code> </pre> <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Account</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">length</span></span> 102<span class="hljs-selector-class"><span class="hljs-selector-class">.664596</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Number</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vmail</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">messages</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.115942</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">day</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 206<span class="hljs-selector-class"><span class="hljs-selector-class">.914079</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">day</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 101<span class="hljs-selector-class"><span class="hljs-selector-class">.335404</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">day</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 35<span class="hljs-selector-class"><span class="hljs-selector-class">.175921</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eve</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 212<span class="hljs-selector-class"><span class="hljs-selector-class">.410145</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eve</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 100<span class="hljs-selector-class"><span class="hljs-selector-class">.561077</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eve</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 18<span class="hljs-selector-class"><span class="hljs-selector-class">.054969</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">night</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 205<span class="hljs-selector-class"><span class="hljs-selector-class">.231677</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">night</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 100<span class="hljs-selector-class"><span class="hljs-selector-class">.399586</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">night</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.235528</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">intl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 10<span class="hljs-selector-class"><span class="hljs-selector-class">.700000</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">intl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.163561</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">intl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.889545</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Customer</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">service</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.229814</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Churn</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.000000</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dtype</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">float64</span></span></code> </pre> <br><p>  Combining the previous two types of indexing, we will answer the question: <strong>how many on average do disloyal users talk on the phone during the day</strong> ? </p><br><pre> <code class="hljs markdown">df[<span class="hljs-string"><span class="hljs-string">df['Churn'</span></span>] == 1]['Total day minutes'].mean() # : 206.91407867494823</code> </pre> <br><p>  <strong>What is the maximum length of international calls among loyal users ( <code>Churn == 0</code> ) who do not use the international roaming service ( <code>'International plan' == 'No'</code> )?</strong> </p><br><pre> <code class="hljs markdown">df[<span class="hljs-string"><span class="hljs-string">(df['Churn'</span></span>] == 0) &amp; (df[<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>] == 'No')]['Total intl minutes'].max() # : 18.899999999999999</code> </pre> <br><p>  Data frames can be indexed either by the name of a column or row, or by their sequence number.  For indexing <strong>by name</strong> , the <strong><code>loc</code></strong> method is used, <strong>by number</strong> - <strong><code>iloc</code></strong> . </p><br><p>  In the first case, we say <em>‚Äúgive us the values ‚Äã‚Äãfor the id rows from 0 to 5 and for the columns from State to Area code‚Äù</em> , and in the second, <em>‚Äúgive us the values ‚Äã‚Äãof the first <u>five</u> rows in the first three columns‚Äù</em> . </p><br><blockquote>  <em>Note to the</em> hostess <em>:</em> when we pass a slice object to <strong>iloc</strong> , the data frame is sliced ‚Äã‚Äãas usual.  However, in the case of <strong>loc,</strong> both the beginning and the end of the slice are taken into account ( <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html%3Fhighlight%3Dloc">link to the documentation</a> , thanks to <a href="https://habr.com/users/arkane0906/" class="user_link">arkane0906</a> for the remark). </blockquote><br><pre> <code class="hljs cs">df.loc[<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">'State'</span></span>:<span class="hljs-string"><span class="hljs-string">'Area code'</span></span>]</code> </pre> <br><table border="1"><thead><tr><th></th><th>  State </th><th>  Account length </th><th>  Area code </th></tr></thead><tbody><tr><th>  0 </th><td>  KS </td><td>  128 </td><td>  415 </td></tr><tr><th>  one </th><td>  OH </td><td>  107 </td><td>  415 </td></tr><tr><th>  2 </th><td>  NJ </td><td>  137 </td><td>  415 </td></tr><tr><th>  3 </th><td>  OH </td><td>  84 </td><td>  408 </td></tr><tr><th>  four </th><td>  Ok </td><td>  75 </td><td>  415 </td></tr><tr><th>  five </th><td>  AL </td><td>  118 </td><td>  510 </td></tr></tbody></table><br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.iloc</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[0:5, 0:3]</span></span></code> </pre> <br><table border="1"><thead><tr><th></th><th>  State </th><th>  Account length </th><th>  Area code </th></tr></thead><tbody><tr><th>  0 </th><td>  KS </td><td>  128 </td><td>  415 </td></tr><tr><th>  one </th><td>  OH </td><td>  107 </td><td>  415 </td></tr><tr><th>  2 </th><td>  NJ </td><td>  137 </td><td>  415 </td></tr><tr><th>  3 </th><td>  OH </td><td>  84 </td><td>  408 </td></tr><tr><th>  four </th><td>  Ok </td><td>  75 </td><td>  415 </td></tr></tbody></table><br><br><p>  If we need the first or last line of the data frame, we use the <code>df[:1]</code> or <code>df[-1:]</code> : construct: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[-1:]</span></span></code> </pre> <br><img src="https://habrastorage.org/files/be1/171/b2f/be1171b2f036492d8e99c7a05dad8717.png"><br><br><h3 id="primenenie-funkciy-k-yacheykam-stolbcam-i-strokam">  Apply functions to cells, columns, and rows </h3><br><p>  <strong>Applying a function to each column: apply</strong> </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.apply</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">np</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.max</span></span>)</code> </pre> <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">State</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">WY</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Account</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">length</span></span> 243 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Area</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">code</span></span> 510 <span class="hljs-selector-tag"><span class="hljs-selector-tag">International</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">plan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Yes</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Voice</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mail</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">plan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Yes</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Number</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vmail</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">messages</span></span> 51 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">day</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 350<span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">day</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 165 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">day</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 59<span class="hljs-selector-class"><span class="hljs-selector-class">.64</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eve</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 363<span class="hljs-selector-class"><span class="hljs-selector-class">.7</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eve</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 170 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eve</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 30<span class="hljs-selector-class"><span class="hljs-selector-class">.91</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">night</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 395 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">night</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 175 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">night</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 17<span class="hljs-selector-class"><span class="hljs-selector-class">.77</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">intl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">minutes</span></span> 20 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">intl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 20 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Total</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">intl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">charge</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Customer</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">service</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">calls</span></span> 9 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Churn</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">True</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dtype</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">object</span></span></code> </pre> <br><p>  The <code>apply</code> method can also be used to apply a function to each line.  To do this, specify <code>axis=1</code> . </p><br><p>  <strong>Application of function to each cell of a column: <code>map</code></strong> </p><br><p>  For example, the <code>map</code> method can be used to <strong>replace values ‚Äã‚Äãin a column</strong> by passing to it as an argument a dictionary of the form <code>{old_value: new_value}</code> : </p><br><pre> <code class="hljs pgsql">d = {<span class="hljs-string"><span class="hljs-string">'No'</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'Yes'</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>} df[<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>].map(d) df.head()</code> </pre> <br><img src="https://habrastorage.org/files/65c/63a/6f6/65c63a6f622342e48764b59f1b00b1d8.png"><br><br><p>  A similar operation can be rotated using the <code>replace</code> method: </p><br><pre> <code class="hljs pgsql">df = df.replace({<span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>: d}) df.head()</code> </pre> <br><img src="https://habrastorage.org/files/991/e9b/d4d/991e9bd4d43d45cb91de19138b5b8042.png"><br><br><h3 id="gruppirovka-dannyh">  Grouping data </h3><br><p>  In general, grouping data in Pandas is as follows: </p><br><pre> <code class="hljs pgsql">df.groupby(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>=grouping_columns)[columns_to_show].<span class="hljs-keyword"><span class="hljs-keyword">function</span></span>()</code> </pre> <br><ol><li>  The groupby method is applied to the <strong><code>groupby</code></strong> , which divides the data by <code>grouping_columns</code> - a feature or set of features. </li><li>  Select the columns we need ( <code>columns_to_show</code> ). </li><li>  A function or several functions are applied to the received groups. </li></ol><br><p>  <strong>Grouping data based on the value of the <code>Churn</code> feature and displaying statistics on the three columns in each group.</strong> </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">columns_to_show</span></span> = [<span class="hljs-string"><span class="hljs-string">'Total day minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total eve minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total night minutes'</span></span>] df.groupby([<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>])[columns_to_show].describe(percentiles=[])</code> </pre> <br><p><img src="https://habrastorage.org/web/a17/608/78d/a1760878daf6424ebb1a46880d0c0bfe.png"><br></p><br><p>  Let's do the same, but a little differently, by transferring to <code>agg</code> list of functions: </p><br><pre> <code class="hljs matlab">columns_to_show = [<span class="hljs-string"><span class="hljs-string">'Total day minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total eve minutes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total night minutes'</span></span>] df.groupby([<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>])[columns_to_show].agg([np.<span class="hljs-built_in"><span class="hljs-built_in">mean</span></span>, np.std, np.<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>, np.<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>])</code> </pre> <br><img src="https://habrastorage.org/web/198/787/85e/19878785ef7249d0bfe87a37cae8045b.png"><br><br><h3 id="svodnye-tablicy">  Summary Tables </h3><br><p>  Suppose we want to see how the observations in our sample are distributed in the context of two traits - <code>Churn</code> and <code>International plan</code> .  To do this, we can build <strong>a contingency table</strong> using the <strong><code>crosstab</code></strong> method: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">pd</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.crosstab</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">['Churn']</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">['International plan']</span></span>)</code> </pre> <br><table border="1"><thead><tr><th>  International plan </th><th>  No </th><th>  Yes </th></tr><tr><th>  Churn </th><th></th><th></th></tr></thead><tbody><tr><th>  0 </th><td>  2664 </td><td>  186 </td></tr><tr><th>  one </th><td>  346 </td><td>  137 </td></tr></tbody></table><br><br><pre> <code class="hljs pgsql">pd.crosstab(df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>], df[<span class="hljs-string"><span class="hljs-string">'Voice mail plan'</span></span>], normalize=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><table border="1"><thead><tr><th>  Voice mail plan </th><th>  No </th><th>  Yes </th></tr><tr><th>  Churn </th><th></th><th></th></tr></thead><tbody><tr><th>  0 </th><td>  0.602460 </td><td>  0.252625 </td></tr><tr><th>  one </th><td>  0.120912 </td><td>  0.024002 </td></tr></tbody></table><br><br><p>  We see that the majority of users are loyal and at the same time use additional services (international roaming / voice mail). </p><br><p>  Advanced Excel users will surely remember such a feature as pivot tables.  In Pandas, the <strong><code>pivot_table</code></strong> method is responsible for summary tables, which takes as parameters: </p><br><ul><li>  <code>values</code> - the list of variables for which you want to calculate the necessary statistics, </li><li>  <code>index</code> - a list of variables by which you need to group data, </li><li>  <code>aggfunc</code> - that, in fact, we need to calculate by groups - the amount, average, maximum, minimum or something else. </li></ul><br><p>  Let's look at the average number of day, evening and night calls for different Area code: </p><br><pre> <code class="hljs cs">df.pivot_table([<span class="hljs-string"><span class="hljs-string">'Total day calls'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total eve calls'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total night calls'</span></span>], [<span class="hljs-string"><span class="hljs-string">'Area code'</span></span>], aggfunc=<span class="hljs-string"><span class="hljs-string">'mean'</span></span>).head(<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br><table border="1"><thead><tr><th></th><th>  Total day calls </th><th>  Total eve calls </th><th>  Total night calls </th></tr><tr><th>  Area code </th><th></th><th></th><th></th></tr></thead><tbody><tr><th>  408 </th><td>  100.496420 </td><td>  99.788783 </td><td>  99.039379 </td></tr><tr><th>  415 </th><td>  100.576435 </td><td>  100.503927 </td><td>  100.398187 </td></tr><tr><th>  510 </th><td>  100.097619 </td><td>  99.671429 </td><td>  100.601190 </td></tr></tbody></table><br><br><h3 id="preobrazovanie-datafreymov">  Convert Data Frames </h3><br><p>  Like many things in Pandas, adding columns to a DataFrame is possible in several ways. </p><br><p>  For example, we want to count the total number of calls for all users.  Create a <code>total_calls</code> object of the Series type and insert it into the data frame: </p><br><pre> <code class="hljs pgsql">total_calls = df[<span class="hljs-string"><span class="hljs-string">'Total day calls'</span></span>] + df[<span class="hljs-string"><span class="hljs-string">'Total eve calls'</span></span>] + \ df[<span class="hljs-string"><span class="hljs-string">'Total night calls'</span></span>] + df[<span class="hljs-string"><span class="hljs-string">'Total intl calls'</span></span>] df.<span class="hljs-keyword"><span class="hljs-keyword">insert</span></span>(loc=len(df.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>), column=<span class="hljs-string"><span class="hljs-string">'Total calls'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>=total_calls) # loc -  ,      Series #   len(df.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>),       df.head()</code> </pre> <br><img src="https://habrastorage.org/files/7d9/24f/a03/7d924fa03ed745b691b56dd4c1b7b3ba.png"><br><br><p>  Adding a column from existing ones is possible and easier without creating intermediate Series: </p><br><pre> <code class="hljs cs">df[<span class="hljs-string"><span class="hljs-string">'Total charge'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'Total day charge'</span></span>] + df[<span class="hljs-string"><span class="hljs-string">'Total eve charge'</span></span>] + df[<span class="hljs-string"><span class="hljs-string">'Total night charge'</span></span>] + df[<span class="hljs-string"><span class="hljs-string">'Total intl charge'</span></span>] df.head()</code> </pre> <br><img src="https://habrastorage.org/files/231/b67/a22/231b67a2294f42a8a82e1587dfe214e2.png"><br><br><p>  To remove columns or rows, use the <code>drop</code> method, passing in the required indexes as an argument and the required value of the <code>axis</code> parameter ( <code>1</code> if deleting columns, and nothing or <code>0</code> if deleting rows): </p><br><pre> <code class="hljs pgsql">#       df = df.<span class="hljs-keyword"><span class="hljs-keyword">drop</span></span>([<span class="hljs-string"><span class="hljs-string">'Total charge'</span></span>, <span class="hljs-string"><span class="hljs-string">'Total calls'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) df.<span class="hljs-keyword"><span class="hljs-keyword">drop</span></span>([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]).head() #      </code> </pre> <br><img src="https://habrastorage.org/files/06e/cd4/df4/06ecd4df461a4e20a376d1ecb0138573.png"><br><br><h2 id="4-pervye-popytki-prognozirovaniya-ottoka">  4. The first attempts to predict the outflow </h2><br><p>  Let's see how the outflow is associated with the sign <em>"Connecting international roaming" (International plan)</em> .  We will do this with the help of the <em>crosstab</em> summary tablet, as well as through illustrations with Seaborn (how exactly to build such pictures and analyze graphics with them - the material of the next article). </p><br><pre> <code class="python hljs">pd.crosstab(df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>], df[<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>], margins=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><table border="1"><thead><tr><th>  International plan </th><th>  False </th><th>  True </th><th>  All </th></tr><tr><th>  Churn </th><th></th><th></th><th></th></tr></thead><tbody><tr><th>  0 </th><td>  2664 </td><td>  186 </td><td>  2850 </td></tr><tr><th>  one </th><td>  346 </td><td>  137 </td><td>  483 </td></tr><tr><th>  All </th><td>  3010 </td><td>  323 </td><td>  3333 </td></tr></tbody></table><br><br><img src="https://habrastorage.org/files/bc3/39d/60b/bc339d60b38f43e682f17ba767e8a4e6.png"><br><br><p>  We see that when roaming is connected, the share of outflow is much higher - an interesting observation!  It is possible that large and poorly controlled spending in roaming is very conflict-causing and leads to dissatisfaction of customers with a telecom operator and, accordingly, to their outflow. </p><br><p>  Next, look at another important feature - <em>"The number of calls to the service center" (Customer service calls)</em> .  We will also build a pivot table and a picture. </p><br><pre> <code class="python hljs">pd.crosstab(df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>], df[<span class="hljs-string"><span class="hljs-string">'Customer service calls'</span></span>], margins=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><table border="1"><thead><tr><th>  Customer service calls </th><th>  0 </th><th>  one </th><th>  2 </th><th>  3 </th><th>  four </th><th>  five </th><th>  6 </th><th>  7 </th><th>  eight </th><th>  9 </th><th>  All </th></tr><tr><th>  Churn </th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><th>  0 </th><td>  605 </td><td>  1059 </td><td>  672 </td><td>  385 </td><td>  90 </td><td>  26 </td><td>  eight </td><td>  four </td><td>  one </td><td>  0 </td><td>  2850 </td></tr><tr><th>  one </th><td>  92 </td><td>  122 </td><td>  87 </td><td>  44 </td><td>  76 </td><td>  40 </td><td>  14 </td><td>  five </td><td>  one </td><td>  2 </td><td>  483 </td></tr><tr><th>  All </th><td>  697 </td><td>  1181 </td><td>  759 </td><td>  429 </td><td>  166 </td><td>  66 </td><td>  22 </td><td>  9 </td><td>  2 </td><td>  2 </td><td>  3333 </td></tr></tbody></table><br><br><img src="https://habrastorage.org/files/fed/e25/781/fede257819424580ba6f16da0dc452e7.png"><br><br><p>  Perhaps, on the summary plate it is not so clearly seen (or it is boring to crawl through the lines with numbers), but the picture eloquently indicates that the share of the outflow increases greatly from 4 calls to the service center. </p><br><p>  Now we add a binary sign to our DataFrame - the result of comparison of <code>Customer service calls &gt; 3</code> .  And again, let's see how it is associated with the outflow. </p><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'Many_service_calls'</span></span>] = (df[<span class="hljs-string"><span class="hljs-string">'Customer service calls'</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">3</span></span>).astype(<span class="hljs-string"><span class="hljs-string">'int'</span></span>) pd.crosstab(df[<span class="hljs-string"><span class="hljs-string">'Many_service_calls'</span></span>], df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>], margins=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><table border="1"><thead><tr><th>  Churn </th><th>  0 </th><th>  one </th><th>  All </th></tr><tr><th>  Many_service_calls </th><th></th><th></th><th></th></tr></thead><tbody><tr><th>  0 </th><td>  2721 </td><td>  345 </td><td>  3066 </td></tr><tr><th>  one </th><td>  129 </td><td>  138 </td><td>  267 </td></tr><tr><th>  All </th><td>  2850 </td><td>  483 </td><td>  3333 </td></tr></tbody></table><br><br><img src="https://habrastorage.org/files/9df/85e/6c9/9df85e6c9bde483ab46f45131718afd7.png"><br><br><p>  Let us combine the conditions discussed above and construct a summary table for this combination and outflow. </p><br><pre> <code class="python hljs">pd.crosstab(df[<span class="hljs-string"><span class="hljs-string">'Many_service_calls'</span></span>] &amp; df[<span class="hljs-string"><span class="hljs-string">'International plan'</span></span>] , df[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>])</code> </pre> <br><table border="1"><thead><tr><th>  Churn </th><th>  0 </th><th>  one </th></tr><tr><th>  row_0 </th><th></th><th></th></tr></thead><tbody><tr><th>  False </th><td>  2841 </td><td>  464 </td></tr><tr><th>  True </th><td>  9 </td><td>  nineteen </td></tr></tbody></table><br><br><p>  So, predicting the outflow of the client in the case when the number of calls to the service center is more than 3 and roaming is connected (and predicting loyalty - otherwise), you can expect about 85.8% of the correct hits (we are mistaken only 464 + 9 times).  These 85.8%, which we obtained using very simple arguments, are a good starting point ( <em>baseline</em> ) for further machine learning models that we will build. </p><br><p>  In general, before the advent of machine learning, the process of analyzing data looked like this.  Summarize: </p><br><ul><li>  The share of loyal customers in the sample is 85.5%.  The most naive model, the answer of which "the client is always loyal" on such data will guess in about 85.5% of cases.  That is, the proportion of correct answers ( <em>accuracy</em> ) of subsequent models should be at least not less, but better, much higher than this figure; </li><li>  With the help of a simple forecast, which can be conditionally expressed by the following formula: "International plan = True &amp; Customer Service calls&gt; 3 =&gt; Churn = 1, else Churn = 0", one can expect a share of guesses of 85.8%, which is slightly higher than 85.5%.  Subsequently, we will talk about decision trees and figure out how to find such rules automatically based on input data only; </li><li>  We received these two baselines without any machine learning, and they serve as a starting point for our subsequent models.  If it turns out that by enormous efforts we increase the proportion of correct answers of everything, say, by 0.5%, then perhaps we are doing something wrong, and it suffices to restrict ourselves to a simple model of two conditions; </li><li>  Before learning complex models it is recommended to twist the data a bit and check simple assumptions.  Moreover, in business applications of machine learning most often begin with simple solutions, and then experiment with their complications. </li></ul><br><h2 id="5-domashnee-zadanie-1">  5. Homework number 1 </h2><br><p>  Further, the course will be conducted in English (there are <a href="https://medium.com/open-machine-learning-course">articles</a> on Medium too).  The next launch is October 1, 2018. </p><br><p>  For warm-up / training, it is proposed to analyze demographic data using Pandas.  You need to fill in the missing code in the <a href="http://nbviewer.jupyter.org/github/Yorko/mlcourse.ai/blob/master/jupyter_russian/assignments_demo/assignment01_adult_pandas.ipynb">Jupyter template</a> and select the correct answers in the <a href="https://docs.google.com/forms/d/1xAzU-5N6oEeR4UG8G44V6XL-Kbr4WYcPBG45Kijge2Y/">web form</a> (there you will also find the solution). </p><br><h2 id="6-obzor-poleznyh-resursov">  6. Review of useful resources </h2><br><ul><li>  Translation of this article into English - <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-1-exploratory-data-analysis-with-pandas-de57880f1a68">Medium story</a> </li><li>  <a href="https://youtu.be/dEFxoyJhm3Y">Video recording of the</a> lecture based on this article. </li><li>  First of all, of course, the <a href="http://pandas.pydata.org/pandas-docs/stable/index.html">official Pandas documentation</a> .  In particular, we recommend a short introduction <a href="http://pandas.pydata.org/pandas-docs/stable/10min.html">10 minutes to pandas</a> </li><li>  Russian <a href="https://drive.google.com/file/d/1EqUUrS81tAHwt_vghs9Hibksa5_GHecI/view">translation of the</a> book "Learning pandas" + <a href="https://github.com/Gewissta/Learning_pandas_russian_translation">repository</a> </li><li>  <a href="https://github.com/pandas-dev/pandas/blob/master/doc/cheatsheet/Pandas_Cheat_Sheet.pdf">PDF-crib on the library</a> </li><li>  Presentation of Alexander Dyakonov <a href="https://alexanderdyakonov.wordpress.com/2015/11/06/%25D0%25B7%25D0%25BD%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BC%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE-%25D1%2581-pandas-%25D1%2581%25D0%25BB%25D0%25B0%25D0%25B9%25D0%25B4%25D1%258B/">"Meeting with Pandas"</a> </li><li>  <a href="https://tomaugspurger.github.io/modern-1-intro.html">A series of</a> posts "Modern Pandas" (in English) </li><li>  There is a <a href="https://github.com/guipsamora/pandas_exercises/">collection</a> of Pandas <a href="https://github.com/guipsamora/pandas_exercises/">exercises</a> and <a href="https://github.com/TomAugspurger/effective-pandas">another</a> useful repository (in English) "Effective Pandas" on the githaba </li><li>  <a href="http://www.scipy-lectures.org/index.html">scipy-lectures.org</a> - tutorial on working with pandas, numpy, matplotlib and scikit-learn </li><li>  <a href="https://www.youtube.com/watch%3Fv%3D5JnMutdy6Fw">Pandas From The Ground Up</a> - video from PyCon 2015 </li></ul><br><p>  <em>The article was written in collaboration with <a href="https://habr.com/users/yorko/" class="user_link">yorko</a> (Yuri Kashnitsky).</em> </p></div><p>Source: <a href="https://habr.com/ru/post/322626/">https://habr.com/ru/post/322626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322616/index.html">Setting up DKIM / SPF / DMARC records or defending against spoofing</a></li>
<li><a href="../322618/index.html">Visualization of JavaScript exchange sorting algorithms</a></li>
<li><a href="../322620/index.html">Moving to Yandex ClickHouse</a></li>
<li><a href="../322622/index.html">Linus Torvals spoke about the SHA-1 collisions in the Git repositories: there is nothing to fear</a></li>
<li><a href="../322624/index.html">Uber - the reasons for the transition from Postgres to MySQL</a></li>
<li><a href="../322634/index.html">Free IP Camera Software</a></li>
<li><a href="../322636/index.html">Experiment: looking for int i = 0xDEADBEEF in a physical memory dump</a></li>
<li><a href="../322642/index.html">Pygest # 4. Releases, articles, interesting projects from the world of Python [February 14, 2017 - February 27, 2017]</a></li>
<li><a href="../322646/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ251 (February 20 - 26, 2017)</a></li>
<li><a href="../322648/index.html">PHP Digest number 103 - interesting news, materials and tools (February 12 - 26, 2017)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>