<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a simple neural network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation Making a Simple Neural Network 

 What do we do? We will try to create a simple and very small neural network, which we will explain and t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a simple neural network</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ac/tt/kj/acttkjv76eyz3ban4o0lroam6i0.jpeg"><br><br>  <i>Translation <a href="https://becominghuman.ai/making-a-simple-neural-network-2ea1de81ec20">Making a Simple Neural Network</a></i> <br><br>  What do we do?  We will try to create a simple and very small neural network, which we will <b>explain</b> and <b>teach</b> something to distinguish.  At the same time, we will not go into the history and mathematical jungles (it is very easy to find such information) - instead, we will try to explain the task (not the fact that we succeed) to you and yourself with pictures and code. <br><a name="habracut"></a><br>  Many of the terms in neural networks are related to biology, so let's start from the beginning: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/894/2ca/932/8942ca932bbcae69fa905d941a0986c4.png"><br>  The brain is a complicated thing, but it can also be divided into several main parts and operations: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a9d/70c/3dc/a9d70c3dc81c6ee4987be8808c442b9c.png"><br><br>  The causative agent may be <b>internal</b> (for example, an image or an idea): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/070/0c3/85a/0700c385ae4bd6581ccacfe3ee34df97.png"><br><br>  And now let's take a look at the basic and simplified <b>parts of the</b> brain: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f0e/8a6/4df/f0e8a64df55c24fdf44bd7ee6a330c37.png"><br>  <i>The brain is generally similar to the cable network.</i> <br><br>  <b>The neuron</b> is the basic unit of calculus in the brain, it receives and processes the chemical signals of other neurons, and, depending on a number of factors, either does nothing, or generates an electrical impulse, or Action Potential, which then sends signals through the synapses to neighboring neurons: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/946/b58/2c7/946b582c7606740ba399856e9a9b9682.png"><br><br>  Dreams, memories, self-regulated movements, reflexes and in general everything that you think or do ‚Äî everything happens due to this process: millions, or even billions of neurons work at different levels and create connections that create various parallel subsystems and constitute a biological neural <b>network.</b> . <br><br>  Of course, these are all simplifications and generalizations, but thanks to them we can describe a simple <br>  neural network: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b4c/1fa/0f5/b4c1fa0f54936c62cedf6670af34c410.png"><br><br>  And to describe it formalized using the graph: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/642/1db/8ab/6421db8ab21c127565d20728a72cf25a.png"><br><br>  This requires some explanation.  Circles are neurons, and lines are connections between them, <br>  and, in order not to complicate at this stage, <b>interconnections</b> are the direct movement of information <b>from left to right</b> .  The first neuron is currently active and highlighted in gray.  We also assigned a number to it (1 - if it works, 0 - if not).  The numbers between neurons show the <b>weight of the</b> connection. <br><br>  The graphs above show the network time, for a more accurate display, you need to divide it into time segments: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/daf/6cc/b7b/daf6ccb7ba582e13f2a1acf9bb1c56f6.png"></div><br><br>  To create your neural network, you need to understand how weights affect neurons and how neurons are trained.  As an example, take a rabbit (test rabbit) and put it in the conditions of a classic experiment. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a78/51c/9d1/a7851c9d12bddb08627ecd7b8c695d81.png"><br><br>  When a safe stream of air is directed at them, the rabbits, like people, blink: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a84/bda/606/a84bda606848164e1e4525d29ea111cb.png"><br><br>  This behavior model can be drawn with graphs: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c6/0f0/484/1c60f04842b60cb027019b4154ae43ee.png"><br><br>  As in the previous diagram, these graphs show only the moment when the rabbit feels the breath, and we thus <b>encode the</b> breath as a logical value.  In addition, we calculate whether the second neuron works, based on the weight value.  If it is 1, then the sensory neuron is triggered, we blink;  if the weight is less than 1, we do not blink: in the second neuron the <b>limit</b> is 1. <br><br>  We introduce another element - a safe sound signal: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/364/be7/436/364be743605b4a8ceff1b7e9c64304c0.png"><br><br>  We can simulate a rabbit's interest like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db2/8c3/c4b/db28c3c4bbff5a1f7d782c2589748e22.png"><br><br>  The main difference is that now the weight is <b>zero</b> , so we did not get the blinking rabbit, well, so far, at least.  Now we teach the rabbit to blink on the team, mixing <br>  irritants (beep and whiff): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/396/a91/5cc/396a915cc38d2215dde0d7a30639ed49.png"><br><br>  It is important that these events take place in different time <b>periods</b> , in the graphs it will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b6/a90/d38/6b6a90d3846b88fb71cbc77160076785.png"><br><br>  By itself, the sound does nothing, but the air flow still makes the rabbit blink, and we show this through weights multiplied by stimuli (red). <br><br>  <b>Learning</b> complex behavior can be simplifiedly expressed as a gradual change in weight between connected neurons over time. <br><br>  To train the rabbit, repeat the steps: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/291/a8c/762/291a8c76287ca4f3c2724a5f94760f1e.png"><br><br>  For the first three attempts, the schemes will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c42/e46/98c/c42e4698c4b1e0efc2a2ded0a5ee8b60.png"><br><br>  Please note that the weight for a sound stimulus grows after each repetition (highlighted in red), this value is now arbitrary - we chose 0.30, but the number can be anything, even negative.  After the third repetition, you will not notice a change in the behavior of the rabbit, but after the fourth repetition, something amazing will happen - the behavior will change. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbc/787/122/fbc7871226276d67bad346023bed3b32.png"><br><br>  We removed the impact of air, but the rabbit still blinks when he heard the beep!  Our last schema can explain this behavior: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e31/559/8cf/e315598cf6e3413cfbd72a1043ff07e5.png"><br><br>  We trained the rabbit to respond to the sound with a blink. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ad/126/fe8/3ad126fe866c4fcac73f4f6eee588c20.png"><br>  <i>In a real experiment of this kind, it may take more than 60 repetitions to achieve a result.</i> <br><br>  Now we leave the biological world of the brain and rabbits and try to adapt everything that <br>  learned to create an artificial neural network.  To begin, let's try to do a simple task. <br><br>  Let's say we have a four-button machine that gives out food when you press the correct one. <br>  buttons (well, or energy, if you are a robot).  The task is to find out which button gives a reward: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ea/32b/83c/2ea32b83cc7f0a696d1f5b47dd42a1f0.png"><br><br>  We can draw (schematically) what the button does when pressed as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/771/f53/53c/771f5353cbf9ded96ece3c9c807243b9.png"><br><br>  It is better to solve this problem entirely, so let's look at all possible results, including the correct one: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/928/588/b8b/928588b8b7f455775659cbd0e611061d.png"><br>  <i>Click on the 3rd button to get your dinner.</i> <br><br>  To reproduce a neural network in code, we first need to make a model or a graph with which to associate the network.  Here is one suitable schedule for the task, and it also displays its biological analogue well: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7bd/d7e/008/7bdd7e0083616476b74edbc2ca4d6961.png"><br><br>  This neural network simply receives incoming information - in this case it will be the perception of which button is pressed.  Next, the network replaces the incoming information with weights and makes a conclusion based on the addition of the layer.  It sounds a bit confusing, but let's see how the button is represented in our model: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/512/69e/c23/51269ec23b57cea2b96121da45437515.png"><br>  <i>Note that all weights are 0, so the neural network, like a baby, is completely empty, but completely interconnected.</i> <br><br>  Thus, we associate an external event with the input layer of the neural network and calculate the value at its output.  It may or may not coincide with reality, but for the time being we will ignore this and begin to describe the task in a way understandable to the computer.  Let's start by entering the weights (we will use JavaScript): <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputs = [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> weights = [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//      </span></span></code> </pre> <br>  The next step is to create a function that collects the input values ‚Äã‚Äãand weights and calculates the output value: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluateNeuralNetwork</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inputVector, weightVector</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-number"><span class="hljs-number">0</span></span>; inputVector.forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inputValue, weightIndex</span></span></span><span class="hljs-function">) </span></span>{ layerValue = inputValue*weightVector[weightIndex]; result += layerValue; }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (result.toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>)); } <span class="hljs-comment"><span class="hljs-comment">//   ,  ,    ‚Äî    /   </span></span></code> </pre> <br>  As expected, if we run this code, we will get the same result as in our model or graphics ... <br><br><pre> <code class="javascript hljs">evaluateNeuralNetwork(inputs, weights); <span class="hljs-comment"><span class="hljs-comment">// 0.00</span></span></code> </pre> <br>  A live example: <a href="http://codepen.io/k3no/pen/GWyJgP">Neural Net 001</a> . <br><br>  The next step in the improvement of our neural network will be a way to check its own output or the resulting values ‚Äã‚Äãis comparable to the actual situation, <br>  let's first encode this particular reality into a variable: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f98/7ca/0cc/f987ca0cce416afcb2e1e5a2293f570c.png"><br><br>  To detect inconsistencies (and how many), we add an error function: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Error</span></span> = Reality - Neural Net Output</code> </pre> <br>  With it, we can evaluate the work of our neural network: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/52f/0d1/a5b/52f0d1a5bf44f21b12259e8f71cbb723.png"><br><br>  But more importantly - how about situations where reality gives a positive result? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/270/ef9/da1/270ef9da17dd3b36b9133f82982ebf91.png"><br><br>  Now we know that our model of the neural network is not working (and we know how) the great!  This is great because now we can use the error function to control our learning.  But all this will make sense if we redefine the error function as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Error</span></span> = <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">b</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Desired Output</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">b</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> - Neural Net Output</code> </pre> <br>  An elusive, but such an important discrepancy, tacitly showing that we will <br>  use previously obtained results for comparison with future actions <br>  (and for learning, as we will see later).  It exists in real life, full <br>  repeating patterns, so it can become an evolutionary strategy (well, in <br>  most cases). <br><br>  Next, we will add a new variable to our sample code: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> input = [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> weights = [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> desiredResult = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br>  And a new feature: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluateNeuralNetError</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">desired,actual</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (desired ‚Äî actual); } <span class="hljs-comment"><span class="hljs-comment">// After evaluating both the Network and the Error we would get: // "Neural Net output: 0.00 Error: 1"</span></span></code> </pre> <br>  A live example: <a href="http://codepen.io/k3no/pen/dvaGpX">Neural Net 002</a> . <br><br>  <b>Let's summarize the subtotal</b> .  We started with a task, made its simple model in the form of a biological neural network and got a way to measure its performance in comparison with reality or the desired result.  Now we need to find a way to correct inconsistencies - a process that, like computers, can also be considered as training for people. <br><br>  <b>How to train a neural network?</b> <br><br>  The basis of learning both biological and artificial neural networks is the repetition <br>  and <b>learning algorithms</b> , so we will work with them separately.  Let's start with <br>  learning algorithms. <br><br>  In nature, learning algorithms are defined as changes in physical or chemical <br>  characteristics of the neurons after the experiments: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/28f/064/15d/28f06415d6cbefd3c2c68bc23670e847.png"><br><br>  A dramatic illustration of how two neurons change over time in the code and our ‚Äúlearning algorithm‚Äù model means that we will simply change something for a while to make our lives easier.  So let's add a variable to denote the degree of life ease: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> learningRate = <span class="hljs-number"><span class="hljs-number">0.20</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ,      :)</span></span></code> </pre> <br>  <b>And what will it change?</b> <br><br>  This will change the weights (just like a rabbit!), Especially the weight of the output we want: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/17a/6ee/f16/17a6eef16de58a4aaa856d4361c06284.png"><br><br>  How to encode such an algorithm is your choice, for simplicity I add the learning coefficient to the weight, here it is as a function: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">learn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inputVector, weightVector</span></span></span><span class="hljs-function">) </span></span>{ weightVector.forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">weight, index, weights</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputVector[index] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { weights[index] = weight + learningRate; } }); }</code> </pre> <br>  When used, this learning function will simply add our learning coefficient to the weight vector of the <b>active neuron</b> , before and after the learning circle (or repeat), the results will be as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Original weight vector: [0,0,0,0] // Neural Net output: 0.00 Error: 1 learn(input, weights); // New Weight vector: [0,0.20,0,0] // Neural Net output: 0.20 Error: 0.8 //    ,      1 ( ) ‚Äî ,    ,    ,      </span></span></code> </pre> <br>  A live example: <a href="http://codepen.io/k3no/pen/qrJoXO">Neural Net 003</a> . <br><br>  Okay, now that we are moving in the right direction, the last part of this puzzle will be the introduction of <b>repetitions</b> . <br><br>  It's not so difficult, in nature we just do the same thing over and over again, and in the code we just indicate the number of repetitions: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> trials = <span class="hljs-number"><span class="hljs-number">6</span></span>;</code> </pre> <br>  And the implementation of the number of repetitions in our training neural network will look like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">train</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">trials</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; trials; i++) { neuralNetResult = evaluateNeuralNetwork(input, weights); learn(input, weights); } }</code> </pre> <br>  Well, our final report: <br><br><pre> <code class="javascript hljs">Neural Net output: <span class="hljs-number"><span class="hljs-number">0.00</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: <span class="hljs-number"><span class="hljs-number">1.00</span></span> Weight Vector: [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>] Neural Net output: <span class="hljs-number"><span class="hljs-number">0.20</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: <span class="hljs-number"><span class="hljs-number">0.80</span></span> Weight Vector: [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0.2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>] Neural Net output: <span class="hljs-number"><span class="hljs-number">0.40</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: <span class="hljs-number"><span class="hljs-number">0.60</span></span> Weight Vector: [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0.4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>] Neural Net output: <span class="hljs-number"><span class="hljs-number">0.60</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: <span class="hljs-number"><span class="hljs-number">0.40</span></span> Weight Vector: [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0.6</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>] Neural Net output: <span class="hljs-number"><span class="hljs-number">0.80</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: <span class="hljs-number"><span class="hljs-number">0.20</span></span> Weight Vector: [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0.8</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>] Neural Net output: <span class="hljs-number"><span class="hljs-number">1.00</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: <span class="hljs-number"><span class="hljs-number">0.00</span></span> Weight Vector: [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-comment"><span class="hljs-comment">// Chicken Dinner !</span></span></code> </pre> <br>  A live example: <a href="http://codepen.io/k3no/pen/dvBZLe%3Feditors%3D0012">Neural Net 004</a> . <br><br>  Now we have a weight vector, which will give only one result (chicken for dinner), if the input vector corresponds to reality (pressing the third button). <br><br>  <b>So what's the cool thing we just did?</b> <br><br>  In this particular case, our neural network (after training) can recognize the input data and say what will lead to the desired result (we will still need to program specific situations): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/497/2ab/de2/4972abde2828a4bbe83505eaf2ace1f2.png"><br><br>  In addition, it is a scalable model, a toy and a tool for our learning.  We were able to learn something new about machine learning, neural networks and artificial intelligence. <br><br>  Caution to users: <br><br><ul><li>  The storage mechanism of the studied scales is not provided, so this neural network will forget everything that it knows.  When updating or re-running the code, you need at least six successful repetitions to get the network fully trained, if you think that a person or a machine will press the buttons in a random order ... It will take some time. <br></li><li>  Biological networks for learning important things have a learning rate of 1, so only one successful replay will be needed. <br></li><li>  There is a learning algorithm that is very similar to biological neurons, it has a catchy name: the <b>rule widroff-hoff</b> , or <b>learning widroff-hoff</b> . <br></li><li>  The thresholds of neurons (1 in our example) and the effects of retraining (with a large number of repetitions, the result will be greater than 1) are not taken into account, but they are very important in nature and are responsible for large and complex blocks of behavioral responses.  Like negative weight. <br></li></ul><br><h2>  Notes and references for further reading </h2><br>  I tried to avoid mathematics and strict terms, but if you are interested, we built a <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B5%25D1%2580%25D1%2586%25D0%25B5%25D0%25BF%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD">perceptron</a> , which is defined as an algorithm for supervised learning ( <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2581_%25D1%2583%25D1%2587%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BC">teaching with a teacher</a> ) of <a href="https://en.wikipedia.org/wiki/Binary_classification">double classifiers</a> - a hard thing. <br><br>  The biological structure of the brain is not a simple topic, partly because of inaccuracy, partly because of its complexity.  It‚Äôs better to start with Neuroscience (Purves) and Cognitive Neuroscience (Gazzaniga).  I modified and adapted the example of the Gateway to Memory (Gluck) rabbit, which is also an excellent guide to the world of graphs. <br><br>  Another smart resource An Introduction to Neural Networks (Gurney), suitable for all your needs related to AI. <br><br>  And now in Python!  Thanks to Ilya Undshmidt for providing the version in Python: <br><br><pre> <code class="python hljs">inputs = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] weights = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] desired_result = <span class="hljs-number"><span class="hljs-number">1</span></span> learning_rate = <span class="hljs-number"><span class="hljs-number">0.2</span></span> trials = <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluate_neural_network</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input_array, weight_array)</span></span></span><span class="hljs-function">:</span></span> result = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(input_array)): layer_value = input_array[i] * weight_array[i] result += layer_value print(<span class="hljs-string"><span class="hljs-string">"evaluate_neural_network: "</span></span> + str(result)) print(<span class="hljs-string"><span class="hljs-string">"weights: "</span></span> + str(weights)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluate_error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(desired, actual)</span></span></span><span class="hljs-function">:</span></span> error = desired - actual print(<span class="hljs-string"><span class="hljs-string">"evaluate_error: "</span></span> + str(error)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> error <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">learn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input_array, weight_array)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">"learning..."</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(input_array)): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> input_array[i] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: weight_array[i] += learning_rate <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">train</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(trials)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(trials): neural_net_result = evaluate_neural_network(inputs, weights) learn(inputs, weights) train(trials)</code> </pre> <br>  And now on GO!  For this version, thank Kieran Maher. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"math"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { fmt.Println(<span class="hljs-string"><span class="hljs-string">"Creating inputs and weights ..."</span></span>) inputs := []<span class="hljs-keyword"><span class="hljs-keyword">float64</span></span>{<span class="hljs-number"><span class="hljs-number">0.00</span></span>, <span class="hljs-number"><span class="hljs-number">0.00</span></span>, <span class="hljs-number"><span class="hljs-number">1.00</span></span>, <span class="hljs-number"><span class="hljs-number">0.00</span></span>} weights := []<span class="hljs-keyword"><span class="hljs-keyword">float64</span></span>{<span class="hljs-number"><span class="hljs-number">0.00</span></span>, <span class="hljs-number"><span class="hljs-number">0.00</span></span>, <span class="hljs-number"><span class="hljs-number">0.00</span></span>, <span class="hljs-number"><span class="hljs-number">0.00</span></span>} desired := <span class="hljs-number"><span class="hljs-number">1.00</span></span> learningRate := <span class="hljs-number"><span class="hljs-number">0.20</span></span> trials := <span class="hljs-number"><span class="hljs-number">6</span></span> train(trials, inputs, weights, desired, learningRate) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">train</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(trials </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, inputs []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">, weights []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">, desired </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">, learningRate </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i := <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; trials; i++ { weights = learn(inputs, weights, learningRate) output := evaluate(inputs, weights) errorResult := evaluateError(desired, output) fmt.Print(<span class="hljs-string"><span class="hljs-string">"Output: "</span></span>) fmt.Print(math.Round(output*<span class="hljs-number"><span class="hljs-number">100</span></span>) / <span class="hljs-number"><span class="hljs-number">100</span></span>) fmt.Print(<span class="hljs-string"><span class="hljs-string">"\nError: "</span></span>) fmt.Print(math.Round(errorResult*<span class="hljs-number"><span class="hljs-number">100</span></span>) / <span class="hljs-number"><span class="hljs-number">100</span></span>) fmt.Print(<span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">learn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inputVector []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">, weightVector []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">, learningRate </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> []</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">float64</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> index, inputValue := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> inputVector { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> inputValue &gt; <span class="hljs-number"><span class="hljs-number">0.00</span></span> { weightVector[index] = weightVector[index] + learningRate } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> weightVector } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inputVector []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">, weightVector []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">float64</span></span></span></span> { result := <span class="hljs-number"><span class="hljs-number">0.00</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> index, inputValue := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> inputVector { layerValue := inputValue * weightVector[index] result = result + layerValue } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evaluateError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(desired </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">, actual </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">float64</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> desired - actual }</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/423647/">https://habr.com/ru/post/423647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423637/index.html">7 practical lessons on UX</a></li>
<li><a href="../423639/index.html">More efficient writing of arrays to the permanent memory of a smart contract in Solidity</a></li>
<li><a href="../423641/index.html">Deep Learning and OpenVINO Toolkit. Intel Expert Answers</a></li>
<li><a href="../423643/index.html">Banks are increasingly monitoring customer reputation: an investigation by Business Insider</a></li>
<li><a href="../423645/index.html">How we served the IT infrastructure of ‚ÄúLuzhniki‚Äù during the World Cup</a></li>
<li><a href="../423649/index.html">‚ÄúKubernetes in all fields!‚Äù - an interview with the DevOops conference program committee</a></li>
<li><a href="../423651/index.html">We invite everyone to hackathon SmartMail Hack: Pro Welcome</a></li>
<li><a href="../423653/index.html">PsRealVehicle, or the Open Source plugin for tank physics in Armored Warfare: Assault</a></li>
<li><a href="../423655/index.html">Generics + Spring: May the Force be with you</a></li>
<li><a href="../423657/index.html">I don‚Äôt respect encapsulation, or use another type of table of methods to quickly call private methods.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>