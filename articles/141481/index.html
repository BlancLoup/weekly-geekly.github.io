<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>School fun or multiplayer game without sockets and p2p</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear Habrazhiteli! 

 Just want to make a reservation that this article was created just for fun, and does not pretend to any teaching property...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>School fun or multiplayer game without sockets and p2p</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear Habrazhiteli! <br><br>  Just want to make a reservation that this article was created just for fun, and does not pretend to any teaching property. <br><br>  In our school, computer science is taught from the 6th grade, but we practically haven‚Äôt taught anything, because we so harmoniously and diligently formatted texts in the Word that we finished studying it only to the 9th grade.  It was a little sad, and I started programming.  I remember how copy-paste ‚ÄúHello, World!‚Äù From a book in C ++, then the first calculator, then another calculator, then I learned ActionScript, made a couple of creepy games, and then I became lazy. <br>  After another boring task on Excel, my friend and I decided to implement our long-standing idea - to make a multiplayer game.  On school computers, there was Macromedia Flash 8, Borland Delphi 7, and at the other end of the class, the Windows Server 2003 emblem glittered on the monitor. <br><a name="habracut"></a><br><h4>  First try... </h4><br>  ... and the very first failure.  We tried to use the standard server socket component from Delphi, but this was affected by our little programming experience and we could not even connect.  Even the search for possible problems on the Internet did not help - it was terribly interfered by the <s>useless</s> Internet censor.  Desperately, we were already thinking of giving up our idea, when suddenly a friend had a strange thought: ‚ÄúWhat if we do everything with text files ?!‚Äù.  At first, I looked at him as if I was crazy, and then I realized that there was something in his idea. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, we agreed that we should try to place the text files on a shared disk, kindly provided by the server, and see what happens. <br><br><h4>  Language selection </h4><br>  I attached great importance to this, even though the choice was very small: the old ActionScript, Delphi or Pascal.  Defending the Flash, I tried long and hard to read the files, but (again, because of my limited experience), he did not want to open a text file.  For a long time I was freaking out, calming down, thinking what was wrong, but to no avail.  In the end, I quit this business, and again we went to Excel with happy mugs. <br><br>  After about half a quarter, I had a free lesson - there was no teacher.  We sat down at the computer, opened Turbo Pascal and decided to write "something with WinApi".  Having rummaged in the help, we found such things as <b>SetCursorPos ()</b> and <b>GetCursorPos ()</b> .  With a cunning facial expression, we wrote programs that synchronized the mouse cursors on two computers.  It happened like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/7c3/cb7/0d6/7c3cb70d63d158d079470637cc9acedf.jpg" alt="image"><br><br>  For "falling asleep" used crutch: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">/*  /      SetCursorPos()*/</span></span> delay:=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> delay&lt;<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> delay:=delay+<span class="hljs-number"><span class="hljs-number">0.00001</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br><br>  For some unknown reason, the sleep function did not work, and we had to load the computer with extra calculations. <br><br>  It is impossible to convey our joy when the cursor on another computer moves without the help of a mouse!  Sources can be found <a href="">here</a> .  Inspired, we set about creating ping-pong. <br><br><h4>  Actually, the creation </h4><br>  So, we, inspired by our small but life-affirming Win, have begun to create ping-pong.  Klin was the issue of visualization.  We decided to use a two-dimensional array of characters, in which the field is filled with spaces with several characters' |  '- players and "ball".  There were 3 programs - controlling the first player, controlling the second player and controlling the ball and its physics. <br><br><h5>  Control </h5><br>  The control is performed with the mouse, using the same <b>GetCursorPos ()</b> .  The first trouble that we encountered was the scaling of the cursor coordinates relative to our ‚Äúgrid‚Äù array.  If our grid has 70x24 attributes, then school monitors with a resolution of 1024x640, which is much more.  We learned the ratio of the ‚Äúgrid‚Äù and monitor attributes, and divided the mouse coordinates by the resulting ratio: <br><br><pre> <code class="hljs go">getCursorPos(cursorPos); py := cursorPos.y div <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(py &gt; h - <span class="hljs-number"><span class="hljs-number">5</span></span>) then py := h - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(py &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) then py := <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br><br>  In our case, the ratio turned out to be equal to 20. We also block the exit of our cursor beyond the coordinates of the array (h is the height of the field, 5 is the height of the player). <br><br><h5>  Ball physics </h5><br>  As I noted above, the whole physics of the ball is calculated in a separate program.  Physics is the simplest - when the ball reaches the field boundaries or collisions with players, its velocity vector changes to the opposite.  When colliding with players to give the gameplay <s>at least some</s> interest, we increase the speed of our ball.  When the ball goes beyond the array, we place it in the center of our field and attach random speed.  Great, finished with the ball. <br><br><h5>  Synchronization </h5><br>  Perhaps the funniest thing about this game is synchronization.  We have three text files: <b>ball.txt</b> , <b>player_1.txt</b> and <b>player_2.txt</b> .  The ball.txt records the coordinates of the ball, the player‚Äôs upper limit of the player‚Äôs files.  Each file is simultaneously kept open at once by three programs, which significantly slows down the whole game process.  Nevertheless, no significant lags were found. <br><br><h4>  The moral of this fable ... </h4><br>  ... obvious.  If you have nothing to do, then you can even create such nonsense as this.  and we can say that the time we spent is not entirely useless - when you play your own, albeit clumsy, stupid, but the game ... It‚Äôs impossible to convey emotions.  Of course, we are just the most ordinary shkololo and we admire everything (as we admired ‚ÄúHello World‚Äù), which is somehow related to programming, but it seems to me that we have not wasted time. <br><br>  PS The sources are <a href="">here</a> .  Little comments! <br><br>  PPS Completely forgot.  The programs we started right away in the shared folder, so that they are sharpened to lie in the same folder as the text files. </div><p>Source: <a href="https://habr.com/ru/post/141481/">https://habr.com/ru/post/141481/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141476/index.html">How to speed up the reaction to clicking links in the WebView under Android</a></li>
<li><a href="../141477/index.html">Why i hate frameworks</a></li>
<li><a href="../141478/index.html">Authentication as a licensing mechanism</a></li>
<li><a href="../141479/index.html">Interception of WEB traffic through the WPAD protocol using Intercepter-NG</a></li>
<li><a href="../141480/index.html">An ISO standard has appeared in Ruby</a></li>
<li><a href="../141482/index.html">How to unleash the power of HTML5 Canvas for games</a></li>
<li><a href="../141483/index.html">Free VPN from Comodo</a></li>
<li><a href="../141484/index.html">Charity and sponsorship (crowdfunding): two different forms of financing font development</a></li>
<li><a href="../141486/index.html">Where do ux specialists come from</a></li>
<li><a href="../141487/index.html">What It Worth Thinking About, Keeping Your Data in the Cloud. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>