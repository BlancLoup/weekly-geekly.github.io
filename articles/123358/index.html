<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AD and its weakness to the communication channel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Summer, sun, weekend 
 It all started a week ago, the Friday day was over and it was warm and everyone was torn away from work, the staff were living ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AD and its weakness to the communication channel</h1><div class="post__text post__text-html js-mediator-article"><h4>  Summer, sun, weekend </h4><br>  It all started a week ago, the Friday day was over and it was warm and everyone was torn away from work, the staff were living and cheerfully going home, with smiles on their faces, in anticipation of the weekend.  The weekend passed instantly, and here it is Monday, as they say the day is hard, but so much so ... <br>  Calls to the IT department began to arrive selectively, but with the same problem, they could not log in to their domain under their account, and someone started working and did not notice what was happening.  Everything led to one, errors on the domain controller. <br><a name="habracut"></a><br><h4>  Main problem </h4><br>  I must say, I work in the state.  institution whose domain, with a single directory service (ESC) throughout the country.  After a brief inspection of the equipment, it turned out that the domain controller swore at the tainted AD database (0xc00002e1).  Oaths led to server reboot and request to restore the database through recovery mode.  Well, I think, fine, now we will restore the database and start replication with the main domain controller.  But it was not there!  Due to the imposed restrictions on information security from above, there was simply no access to the controller. <br><br><h4>  Temporary solution </h4><br>  Employees were assigned an alternate AD server, which enabled them to fully work in their workplaces.  During the day, everyone was already comfortably working through a server located at the other end of the city, everything was spinning and that was good, but the problem was not solved yet. <br><br><h4>  Problem one </h4><br>  Tuesday morning.  Came, clicked the computer and went to drink coffee.  But I did not have time to move away from the phone, the bell, we can not go in, the computer hangs.  The question of how to hang was answered simply: ‚ÄúApplying computer settings.‚Äù  It was clear that computers again could not reach out to AD, but the connection with the alternative controller was and did not disappear.  And oh my goodness!  Ping to an alternative server 1500-3000ms, with packet loss.  here and so a couple of hundred computers at once included hung up a communication channel to the server.  Communication is carried out by means of a DSL connection (2 Mbps). <br>  In order to make everything work faster, I chopped off all the switches in order to remove the load from the channel and connected in order with an interval of a couple of minutes.  Ping fell to an acceptable 300-500 ms, you can work. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Problem two (bureaucratic) </h4><br>  Big network, your own call center.  Answers to letters strictly according to the rules during the day.  Of course, at the end of 24 hours, answers were received on what to do with the dohlyachkom in the rack, then long calls, conversations with operators, with call forwarding and conversations with administrators of AD.  We came to the conclusion that we need a complete reinstallation of the server with certain settings.  No sooner said than done!  Now we are sitting waiting for my server to handle, will go into the domain and replicate. <br><br><h4>  Problem three </h4><br>  A day has passed, the operability check is not confirmed in any way, the server is working, but like an unconfigured empty shell, not a domain controller.  Again, calls to the call center, call transfers, finding out the cause of the breakdown, began to look remotely.  After entering the domain, and the beginning of replication, it took almost two days, to the question how much progress is in percentage terms, the answer was learned: "3%". <br>  This is where the anxiety began.  This is what happens, replication will end by simple calculations in 1.5 months?  I think no less.  Replication is on the same DSL communication channel, on which hangs about two hundred workstations.  Be patient and wait. <br><br><h4>  Problem four (final) </h4><br>  There is a way out, I thought!  You can grab the server in your hands and run to the domain controller from which workstations feed on life.  Everything is easy, but there is one BUT!  It is only set up through the Dionysus gateway (who knows, he knows what there is), but of course everyone is sitting through this gateway on a secondary controller.  And taking this artery at the time, the work of the whole building would stand up.  Without a gateway in the network segment where the working domain controller is located, my newly created server would simply not be visible (let me remind you that it is not possible to set up a network connection, there is no access to the system locally). <br>  And this is how we sit for a week and stare at the employees, pings and management, periodically by rank in the call center, to find out the percentage of the downloaded base. <br><br><h4>  Conclusion </h4><br>  A little more rights, the speed of operation of those support and financing of state structures and the development of communication channels would help to avoid many problems.  The development of the ESC was in full swing, but the speed of data exchange with the main structure remained at the level of the 90s, and it cuts the whole idea at the root. </div><p>Source: <a href="https://habr.com/ru/post/123358/">https://habr.com/ru/post/123358/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123348/index.html">Users to help web project tester</a></li>
<li><a href="../123350/index.html">Fast flux DNS or new cybercrime technology</a></li>
<li><a href="../123351/index.html">Case study: audit of Habrahabr usability</a></li>
<li><a href="../123353/index.html">Life in a black hole or how to interact with large Russian companies</a></li>
<li><a href="../123356/index.html">How to develop your brand?</a></li>
<li><a href="../123359/index.html">New release platform for creating online stores Synergy 0.60.0</a></li>
<li><a href="../123360/index.html">Working with commons-cli 1.2</a></li>
<li><a href="../123361/index.html">Android + Arduino = ‚ô•</a></li>
<li><a href="../123362/index.html">On-line webinar "Modern approaches to the organization of software development processes: Lean and Agile"</a></li>
<li><a href="../123363/index.html">Simple words about e-government</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>