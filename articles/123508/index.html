<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Generation of analytical surfaces on the example of maps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 There was once an interesting task: to organize the possibility of the program working with three-dimensional images of the earth's sur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Generation of analytical surfaces on the example of maps</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  There was once an interesting task: to organize the possibility of the program working with three-dimensional images of the earth's surface of large sizes.  After studying a variety of literature and various sources, it became clear that effective approaches in the general access can not be found. <br><a name="habracut"></a><br>  There is either complex mathematics, which still needs to be adequately transferred to the source code, or closed commercial products.  Game algorithms for this task are not suitable, because it requires high accuracy and reliability of the results obtained. <br><br><h4>  Task </h4><br>  To be able to get height at any point, having two coordinates: <br><br>  h = f (x, y); 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Coordinates can be both geographic and linear.  To be able to get heights with any step of coordinates within machine accuracy.  Map sizes range from a few hundred kilometers to thousands, all the way to the whole earth.  The operation of obtaining the height must have O (1) complexity and will be performed quickly enough for the graphics engine to work. <br><br><h4>  Initial data </h4><br>  The cards come in a variety of formats, so pre-processing was done.  After processing, there is a contour map (irregular grid) of the earth's surface in a unified format: <br><br>  &lt;Number of points&gt; &lt;Height&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br><br>  &lt;Number of points&gt; &lt;Height&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  &lt;Latitude&gt; &lt;Longitude&gt; <br>  ... <br><br>  Or in numbers: <br><br>  3 0.000000 <br><br>  32.071945 69.587814 <br>  32.074299 69.586975 <br>  32.070995 69.585907 <br><br>  4 0.000000 <br><br>  32.063576 69.578514 <br>  32.062050 69.578270 <br>  32.059124 69.578407 <br>  32.057785 69.579376 <br><br>  Isolines can be closed and consist of separate lines.  Isolines are not allowed to intersect, although the approach used will also process incorrect data.  Also in large numbers there are single points of height. <br><br><h4>  The content of the work </h4><br>  It was decided to split the entire work into three stages: data preparation, obtaining a uniform grid, and obtaining an analytical surface using spline interpolation. <br><br>  In the first part, it is necessary to increase the resolution of the data provided in order to avoid conversion losses.  Imagine a situation where you have points, some of them are connected by a line.  This line ensures that the height along it is constant <nobr>(Figure 1).</nobr> <br><br>  In the second part, the non-uniform grid is converted to a uniform one with the required resolution. <br><br>  The stage of creating a spline surface from a uniform grid, the calculation of coefficients, correction values ‚Äã‚Äãcompletes the work. <br><br>  At each stage, there are problems and peculiarities.  All of them will be listed in the relevant sections. <br><br><h4>  Part 1. Data preparation </h4><br><h4>  Introduction </h4><br>  All maps come with some scale.  This parameter directly affects the number of parts that can be obtained (the spatial analogue of the Shannon-Kotelnikov theorem).  The quality of the entire work will depend on the correctness of the data preparation. <br><br><h4>  The content of the work </h4><br>  Part 1. Data preparation <br>  <a href="http://habrahabr.ru/blogs/algorithm/123911/">Part 2. Generating a uniform grid.</a> <br>  <a href="http://habrahabr.ru/blogs/algorithm/124108/">Part 3. Creating an analytical surface</a> <br><br><h4>  Subtask target </h4><br>  Determine the most efficient detailing of the irregular grid, to preserve details. <br><br><h4>  Algorithms </h4><br>  This part uses a fairly simple approach to data processing.  Suppose in some part of the map we meet several points.  Some are connected and represent isoline.  And one more point is located close to the isoline, but has a strong difference in height with it.  During simple processing of points, after interpolation, the part of the isoline will change its height by something in between two heights (Figure 1).  What do you think, what height will be at the point marked with a question mark?  To avoid distortions at elevation changes, it is necessary to increase the number of points on the contour. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/feebbb65/6618351a/9ef8716d/20733361.png"></div><br>  Figure 1. Initial data. <br><br>  The best option is to set the resolution of the uniform grid at this stage.  In this case, you can control the quality of the generated surface.  Therefore, let us set the grid resolution and add all points to the isolines, so that all points of the isolines become inseparable. <br><br>  The easiest way: <a href="http://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D0%25BF%25D0%25BE%25D0%25BB%25D1%258F%25D1%2586%25D0%25B8%25D1%258F">linear interpolation</a> .  Simply add points to the contour using the Bresenham <a href="http://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_%25D0%2591%25D1%2580%25D0%25B5%25D0%25B7%25D0%25B5%25D0%25BD%25D1%2585%25D1%258D%25D0%25BC%25D0%25B0">algorithm</a> or the like. <br><br>  A bit more complicated and demanding on computer resources spline interpolation on the plane.  We used <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D1%2583%25D0%25B1%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D1%2581%25D0%25BF%25D0%25BB%25D0%25B0%25D0%25B9%25D0%25BD">cubic interpolation</a> .  It is very important to use interpolation algorithms (new elements contain all given points), approximation (new elements are close to the original points) in this case will only distort the data.  With high quality source data, even linear interpolation gives excellent results. <br><br><h4>  Processing results </h4><br>  After processing an irregular grid, its size on the disk increases, about 3-5 times, depending on the quality of the data.  Graphically, the result looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/1381394f/06234114/308e580e/799b8b3f.png"></div><br>  Figure 2. Linear interpolation. <br><br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/caf88653/1c2ad2b4/e29099d8/a09519a2.png"></div><br>  Figure 3. Spline interpolation with some steps. <br><br>  When using spline interpolation (Figure 3), the line is not straight, as information on the position of the extreme points is taken into account. <br><br><h4>  findings </h4><br>  After pre-processing of the non-uniform grid, you can proceed to the second stage of the work - creating a uniform grid of high detail.  You can see how many different data you need to process to get the result.  Perhaps the use of various algorithms to obtain high-quality data. <br><br>  The next part will show an interesting, very high-quality and simple algorithm for obtaining a uniform grid, which showed itself perfectly on large amounts of data. </div><p>Source: <a href="https://habr.com/ru/post/123508/">https://habr.com/ru/post/123508/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123496/index.html">Mashable: Google abandons Blogger and Picasa brands in favor of Google+</a></li>
<li><a href="../123501/index.html">Pdf.js passed the first pixel test</a></li>
<li><a href="../123502/index.html">Using MongoDB in Java EE 6</a></li>
<li><a href="../123504/index.html">Fun with Google's Street View</a></li>
<li><a href="../123507/index.html">MS SQL 2011 - Error Handling</a></li>
<li><a href="../123509/index.html">Hot summer room UserAndLINUX ‚Ññ11</a></li>
<li><a href="../123510/index.html">Orbduino - mechanical arm controlled via the Internet</a></li>
<li><a href="../123513/index.html">Twitter is already valued at $ 7 billion.</a></li>
<li><a href="../123515/index.html">Useful Asterisk</a></li>
<li><a href="../123516/index.html">We write a game for Android using AndEngine. Part 4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>