<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SNA Hackathon 2019: we complicate architecture - we simplify features</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will tell you about my solution to the text part of the SNA Hackathon 2019 task. Some of the proposed ideas will be useful to the pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SNA Hackathon 2019: we complicate architecture - we simplify features</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/g7/n-/lw/g7n-lwqhzzuabg1ul4kaexfouhg.png"><br><br>  In this article I will tell you about my solution to the text part of the <a href="https://snahackathon.org/">SNA Hackathon 2019</a> task.  Some of the proposed ideas will be useful to the participants in the full-time part of the hackathon, which will be held in the Moscow office of Mail.ru Group from March 30 to April 1.  In addition, this story may be interesting and readers who solve practical problems of machine learning.  Since I cannot claim prizes (I work at Odnoklassniki), I tried to offer the simplest, but at the same time effective and interesting solution. <br><br>  Reading about new models of machine learning, I want to understand how the author reasoned while working on the task.  Therefore, in this article I will try to substantiate in detail all the components of my decision.  In the first part I will talk about the formulation of the problem and limitations.  In the second - about the evolution of the model.  The third part is devoted to the results and analysis of the model.  Finally, in the comments I will try to answer any questions that may arise.  Impatient readers can immediately look at the <a href="">final architecture</a> . <br><a name="habracut"></a><br><h2>  Task </h2><br>  The hackathon organizers offered us to solve the problem of forming a smart tape.  For each user, it is necessary to sort the set of posts so that the maximum number of posts to which the user has set the ‚Äúclass‚Äù are at the top of the list.  To adjust the ranking algorithm, it was supposed to use historical data of the form (user, post, feedback).  The table gives a brief description of the data from the text part and the notation that I will use in this article. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <table><tbody><tr><th width="130">  A source <br></th><th width="150">  Designation <br></th><th width="160">  Type of <br></th><th>  Description <br></th></tr><tr><td>  user <br></td><td>  user_id <br></td><td>  categorical <br></td><td>  user ID <br></td></tr><tr><td>  fast <br></td><td>  post_id <br></td><td>  categorical <br></td><td>  post ID <br></td></tr><tr><td>  fast <br></td><td>  text <br></td><td>  list categorical <br></td><td>  list of normalized words <br></td></tr><tr><td>  fast <br></td><td>  features <br></td><td>  categorical <br></td><td>  post feature group (author, language, etc.) <br></td></tr><tr><td>  Feedback <br></td><td>  feedback <br></td><td>  list binary <br></td><td>  various actions that the user could spend with the post (view, class, comment, etc.) <br></td></tr></tbody></table><br>  Before starting to build a model, I introduced several restrictions on the future solution.  It was necessary to meet the requirements of simplicity and practicality, my interests and reduce the number of possible options.  Here are the most important of these restrictions. <br><br>  <b>Predicting the probability of "class</b> . <b>"</b>  I immediately decided that I would solve this problem as a classification task.  It would be possible to apply the methods used in the ranking, for example, to predict the order in pairs of posts.  But I stopped at a simpler formulation in which posts are sorted according to the predicted probability of getting a ‚Äúclass‚Äù.  It is worth noting that the approach described below can be expanded to formulate rankings. <br><br>  <b>Monolithic model</b> .  Despite the fact that model ensembles tend to win competitions, supporting an ensemble on a combat system is more difficult than a single model.  In addition, I wanted to have at least some non-black box interpretation possibilities. <br><br>  <b>Differentiable computational graph</b> .  First, models of this class (neural networks) determine state-of-the-art in many tasks, including those associated with the <a href="https://paperswithcode.com/task/machine-translation">analysis of</a> <a href="https://paperswithcode.com/task/language-modeling">textual</a> <a href="https://paperswithcode.com/task/question-answering">data</a> .  Secondly, modern frameworks, in my case <a href="https://mxnet.apache.org/">Apache MXNet</a> , allow implementing very diverse architectures.  Therefore, you can experiment with different models by changing just a few lines of code. <br><br>  <b>Minimum of work with signs</b> .  I wanted the model to be easily extended with new data.  This may be necessary in the internal part, where the time to prepare the signs will be short.  Therefore, I stopped at the simplest approach to the selection of signs: <br><br><ul><li>  binary data is represented by a sign with a value of 1 or 0; </li><li>  numeric data either remains as it is or is discretized into categories; </li><li>  categorical data are submitted by embeddings. </li></ul><br>  Having decided on a common strategy, I began to try different models. <br><br><h2>  Model evolution </h2><br>  The starting point was the matrix factorization approach, often used in recommendation tasks: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.898ex" height="2.78ex" viewBox="-38.5 -832 10289.5 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6A" x="624" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-3D" x="1614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-73" x="2920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-69" x="3389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-67" x="3735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6D" x="4215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-61" x="5094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-28" x="5623" y="0"></use><g transform="translate(6013,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-63" x="7180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-64" x="7613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6F" x="8137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-74" x="8622" y="0"></use><g transform="translate(8984,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6A" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-29" x="9861" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy="false">(</mo><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> p_ {i, j} = \ sigma (u_ {i} \ cdot v_ {j}) </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mo>,</mo><mi>v</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.422ex" height="2.78ex" viewBox="0 -832 13959.5 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6F" x="681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-73" x="1167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-73" x="1636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-28" x="2106" y="0"></use><g transform="translate(2495,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6A" x="624" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-2C" x="3818" y="0"></use><g transform="translate(4264,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-70" x="0" y="0"></use><g transform="translate(503,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-2C" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6A" x="624" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-29" x="5600" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-72" x="6239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-69" x="6691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-67" x="7036" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-68" x="7517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-74" x="8093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-61" x="8455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-72" x="8984" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-72" x="9436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6F" x="9887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-77" x="10373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6D" x="11089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-69" x="11968" y="0"></use><g transform="translate(12313,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMAIN-2C" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/odnoklassniki/blog/445348/&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiqTZSNr-zx9VRQljR_11blcElZaA#MJMATHI-76" x="851" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mo>,</mo><mi>v</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> Loss (y_ {i, j}, p_ {i, j}) \ rightarrow min_ {u, v} </script></p><br>  In the language of computational graphs, this means that the estimate of the probability that user <i>i</i> will put a ‚Äúclass‚Äù to post <i>j</i> is a sigmoid from the scalar product of embeddings of the user ID and the post ID.  The same can be expressed in the diagram: <br><br><img src="https://habrastorage.org/webt/dk/ac/1u/dkac1uzffso-cinlnzwefakma_s.png"><br><br>  This model is not very interesting: it does not use all the signs, it is not very useful for low-frequency identifiers and suffers from a cold start problem.  But, having formulated the task in the form of a computational graph, we ‚Äúuntied our hands‚Äù and can now solve problems in stages.  First of all, for low frequency values, we will start a single embedding of <a href="https://medium.com/%40shabeelkandi/handling-out-of-vocabulary-words-in-natural-language-processing-based-on-context-4bbba16214d5">Out-Of-Vocabulary</a> .  Next, we will get rid of the need to have embeddings of the same dimension.  To do this, we replace the scalar product by a shallow perceptron that accepts concatenated attributes as input.  The result is shown in the diagram: <br><br><img src="https://habrastorage.org/webt/c6/uk/-m/c6uk-mxjwwnwcx7trljgrelygq4.png"><br><br>  As soon as we get rid of the fixed dimension, nothing prevents us from starting to add new features.  By presenting the post with all sorts of characteristics (language, author, text, ...), we will solve the problem of the cold start of posts.  The model will learn, for example, that a user with <i>user_id = 42</i> puts ‚Äúclasses‚Äù to posts in Russian containing the word ‚Äúcarpet‚Äù.  In the future, we will be able to recommend all Russian-language posts about carpets to this user, even if they did not appear in the training data.  For embedding, for the time being, we will simply average the embeddings of the words in it.  As a result, the model looks like this: <br><br><img src="https://habrastorage.org/webt/6s/mq/ul/6smqulw3mslpoddknuyoigwkpgy.png"><br><br>  Finally I would like to deal with the cold start of users.  It would be possible to construct features from historical data about user views of posts.  This approach does not satisfy the chosen strategy: we decided to minimize the manual creation of features.  Therefore, I provided the model with the opportunity to independently learn the user's view from a sequence of posts viewed before the post for which the ‚Äúclass‚Äù probability estimate is made.  Unlike the post being evaluated, all feedback is known for each of the posts in the sequence.  This means that the model will be available information about whether the user has put the previous posts "class" or vice versa deleted them from the tape. <br><br><img src="https://habrastorage.org/webt/qk/k0/6m/qkk06mydcetsmnd1roumkqigtm4.png"><br><br>  It remains to determine how to combine a sequence of posts of different lengths into a fixed-width representation.  As such a combination, I used a weighted sum of the views of each of the posts.  In the diagram, the weight of the post <i>j is</i> denoted by <i>Œ±_j</i> .  Weights were calculated using the query-key-value attention mechanism, similar to the one used in the <a href="https://arxiv.org/pdf/1706.03762.pdf">transformer</a> or <a href="">NMT</a> .  In this way, the learned user's view is also configured for the post for which the evaluation is being conducted.  Here is a piece of the graph responsible for calculating <i>Œ±_j</i> : <br><br><img src="https://habrastorage.org/webt/pq/dh/en/pqdhen_hrmrwsicjsokis3a6a_y.png"><br><br>  After I <s>felt the chatter of the revelry</s> convinced of the effectiveness of the approach with attention, it was also decided to use attention in the presentation of the texts.  For the sake of saving time and iron, I decided not to use self-attention as in the same transformer, but directly teaching the weights of words in the text, like this: <br><br><img src="https://habrastorage.org/webt/xw/nl/i5/xwnli58eyq6udoihpvpkjur5918.png"><br><br>  At this development of the architecture of the model was completed.  As a result, I went from the classical matrix factorization to a rather complex sequence-model. <br><br><h2>  Results and analysis </h2><br>  I developed my solution and debugged it on one seventh of the data on a laptop with 16 GB of memory and a GeForce 930MX video card.  Experiments on complete data were run on a dedicated server with 256 GB of memory and a Tesla T4 card.  For optimization, the Adam algorithm was used with default parameters from MXNet.  The table presents the results for the trimmed model - the length of the sequence of posts was limited to ten.  In competitive submission, I used sequences of length fifty. <br><br><table><tbody><tr><th width="120">  Model <br></th><th width="120">  Log loss <br></th><th width="200">  Improvement from the previous line <br></th><th width="100">  Studying time <br></th></tr><tr><td>  Random <br></td><td>  0.4374 ¬± 0.0009 <br></td><td></td><td></td></tr><tr><td>  Perceptron <br></td><td>  0.4330 ¬± 0.0010 <br></td><td>  0.0043 ¬± 0.0002 <br></td><td>  7 min <br></td></tr><tr><td>  Featured perceptron <br></td><td>  0.4119 ¬± 0.0008 <br></td><td>  0.0212 ¬± 0.0003 <br></td><td>  44 min <br></td></tr><tr><td>  Perceptron with a sequence of posts <br></td><td>  0.3873 ¬± 0.0008 <br></td><td>  0.0247 ¬± 0.0003 <br></td><td>  4 hours 16 minutes <br></td></tr><tr><td>  Perceptron with a sequence of posts and attention in the texts <br></td><td>  0.3874 ¬± 0.0008 <br></td><td>  0.0001 ¬± 0.0001 <br></td><td>  4 hours 43 minutes <br></td></tr></tbody></table><br>  The last line was the most unexpected for me: the use of attention in the presentation of texts does not give a visible improvement in the result.  I expected the attention-network to learn the weights of words in texts, something like <a href="https://www.wikiwand.com/en/Tf%25E2%2580%2593idf">idf</a> .  Perhaps this did not happen, because the organizers removed the stop words in advance, and in the prepared lists there were words of about one importance.  Therefore, ‚Äúsmart‚Äù weighing did not give a tangible advantage compared to simple averaging.  Another possible reason is that the attention-network for words was rather small: it contained only one narrow hidden layer.  Perhaps she did not have enough representation capacity to learn something useful. <br><br>  The query-key-value attention mechanism gives you the opportunity to look inside the model and find out what it ‚Äúpays attention to‚Äù when making a decision.  To illustrate this, I <b>selected a</b> few examples: <br><br><pre><code class="plaintext hljs">,       http://ollston.ru/2018/02/10/uznajte-kakogo-cveta-vasha - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.16]        2016        2016 GZ8btjgY_Q0 https: - [0.16]  . Nike http://ollston.ru/2018/02/04/istorii-yspeha-nike/   -  : - [0.09]    - 5      - 5   O3qAop0A5Qs https://ww - [0.09] ...      ,          - [0.22] Microsoft Windows ‚Äî   http://ollston.ru/2018/02/06/microsoft-windows-istoriia-yspeha/  - [0.20]  ,   6  . ,   ? http://ollston.ru/2018/02/08/buddisty-g</code> </pre> <br>  The first line shows the text of the post that needs to be assessed, next - the posts that have been scanned before and the corresponding attention score.  We are relieved to note that the model has learned not to pay attention to padding.  The most important model found posts about the types of souls and about Windows.  It should be borne in mind that attention can be both positive (the user will react to the post about the aura, just like the post about the types of souls) and negative (we estimate the post about the aura - therefore the reaction will not be the same as the reaction to the post about technology).  The following example - attention "in all its glory": <br><br><pre> <code class="plaintext hljs">          - [0.20]      2018    (),  ,    .     - [0.08]       ...  !!!        - [0.04]  )))  - [0.18]      !    ,   .  10   - [0.18]   2-    ,  5 , , 2 , . .   - [0.07]     !   -   ()       - [0.03]     "".   .       - [0.13]   ,    - [0.05] ,    ... - [0.05]     ...</code> </pre> <br>  Here the model clearly saw the theme of the summer holiday.  Even the children and kittens went into the background.  The following example shows that it is not always possible to interpret attention.  Sometimes even absolutely nothing is clear: <br><br><pre> <code class="plaintext hljs">        ! - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.02] PADDING - [0.15] , !   !!! - [0.16]  ! http://gifok.ru/dobryj-vecher/ - [0.20] http://gifq.ru/aforizmy/ - [0.25]     .  . - [0.15] ,      . : 800   250-300  </code> </pre> <br>  After viewing a number of similar lists, I concluded that the model was able to learn what I expected.  The next thing I did was look at the embedding of words.  In our task, we cannot expect embeddings to be just as beautiful as when learning the <a href="https://arxiv.org/abs/1810.04805">language model</a> : we are trying to predict a rather noisy variable, besides we do not have a small context window - embeddingings of all words are simply averaged without taking into account their order in the text.  Examples of tokens and their closest neighbors in the embedding space: <br><br><pre> <code class="plaintext hljs"> -  : , , , ,  -  : , , , ,  -  : , , , ,  -  : , , , ,  -  : , , , , </code> </pre> <br>  Something from this list is easy to explain (program - bl), something causes confusion (iphone - yoki), but in general, the result again met my expectations. <br><br><h2>  Conclusion </h2><br>  I like the model building approach based on differentiable graphs ( <a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/45530.pdf">many</a> <a href="https://arxiv.org/abs/1810.09591">agree</a> ).  It allows you to get away from the tedious manual selection of features and focus on the correct formulation of the problem and the design of interesting architectures.  And although my model took only second place in the SNA Hackathon 2019 text task, I am quite pleased with this result, given its simplicity and almost unlimited expansion options.  I am sure that in the future there will appear more and more interesting and applicable models in combat systems based on similar ideas. </div><p>Source: <a href="https://habr.com/ru/post/445348/">https://habr.com/ru/post/445348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445336/index.html">FlexiRemap¬Æ vs. RAID</a></li>
<li><a href="../445338/index.html">DHCP + Mysql server in Python</a></li>
<li><a href="../445340/index.html">Increase network security by using a cloud analyzer</a></li>
<li><a href="../445344/index.html">OpenVox Unified Communications Platform</a></li>
<li><a href="../445346/index.html">How to write a bad API</a></li>
<li><a href="../445350/index.html">Sonata - SIP provisioning server</a></li>
<li><a href="../445352/index.html">Spark Structured Streaming Applications on Kubernetes. Experience FASTEN RUS</a></li>
<li><a href="../445354/index.html">Finding objects in the pictures</a></li>
<li><a href="../445356/index.html">Overview of the Mobile section on the DUMP-2019: maximum application and useful in everyday work</a></li>
<li><a href="../445358/index.html">Organization of the event system in Unity - through the eyes of game designer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>