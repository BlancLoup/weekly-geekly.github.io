<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Life Cycle Activity Stack (Part 1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Perhaps the most popular question during interviews with an Android developer is: ‚Äútell us about the Activity life cycle‚Äù. At first glance, there is n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Life Cycle Activity Stack (Part 1)</h1><div class="post__text post__text-html js-mediator-article">  Perhaps the most popular question during interviews with an Android developer is: ‚Äútell us about the Activity life cycle‚Äù.  At first glance, there is nothing difficult about this, in which only the blog has not yet written about it, and the candidate immediately begins to draw the well-known flowchart and explain in the course of the process.  Spherical life cycle in a vacuum, which abounds in all the lessons, is really quite simple to understand, but after all, activity is only part of a certain generalizing essence.  This entity is called Activity Stack, and we will now try to understand its life cycle. <br><br>  <a href="http://habrahabr.ru/post/201886/">Life Cycle Activity Stack (Part 2)</a> <br><a name="habracut"></a><br>  There is: <br>  ActivityA, ActivityB, ActivityC <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".ActivityA"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".ActivityB"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".ActivityC"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br>  On the layout of each of their Activities there is one button, which makes the usual launch of the next Activity: <br><pre> <code class="java hljs">Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(view.getContext(), ActivityB.class); startActivity(intent);</code> </pre><br>  That is, ActivityA starts ActivityB, ActivityB starts ActivityC, and ActivityC starts ActiviyA again. <br><br>  The Activity stack is the one for the rule that ‚Äúthe last to come ‚Äî the first to go‚Äù rule works for him.  On the back button, the current Activity is destroyed ( <code>onDestroy()</code> ), and the previous one is restored ( <code>onCreate()</code> and / or <code>onStart()</code> ), if the deleted was not the root. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For clarity, the log <b>A-&gt; B-&gt; C-&gt; back-&gt; back-&gt; back:</b> <br><pre> <code class="bash hljs">***   *** I/ActivityManager(249): START {act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.habrahabr.ActivityStackLifeCycle/.ActivityA u=0} from pid 8672 D/ActivityA(28229): onCreate() D/ActivityA(28229): onStart() I/ActivityManager(249): Displayed com.habrahabr.ActivityStackLifeCycle/.ActivityA: +234ms ***   ActivityB *** I/ActivityManager(249): START {cmp=com.habrahabr.ActivityStackLifeCycle/.ActivityB u=0} from pid 28229 D/ActivityB(28229): onCreate() D/ActivityB(28229): onStart() I/ActivityManager(249): Displayed com.habrahabr.ActivityStackLifeCycle/.ActivityB: +135ms D/ActivityA(28229): onStop() ***   ActivityC *** I/ActivityManager(249): START {cmp=com.habrahabr.ActivityStackLifeCycle/.ActivityC u=0} from pid 28229 D/ActivityC(28229): onCreate() D/ActivityC(28229): onStart() I/ActivityManager(249): Displayed com.habrahabr.ActivityStackLifeCycle/.ActivityC: +206ms D/ActivityB(28229): onStop() ***  Back *** D/ActivityB(28229): onStart() D/ActivityC(28229): onStop() D/ActivityC(28229): onDestroy() ***  Back *** D/ActivityA(28229): onStart() D/ActivityB(28229): onStop() D/ActivityB(28229): onDestroy() ***  Back *** D/ActivityA(28229): onStop() D/ActivityA(28229): onDestroy()</code> </pre><br>  Everyone is familiar with this behavior, but is our Activity Stack protected if we decide to leave the application in the background and start a resource-intensive third-party application? <br><br>  <b>App1-&gt; A-&gt; B-&gt; C-&gt; Home-&gt; App2-&gt; back-&gt; App1:</b> <br><pre> <code class="bash hljs">***   *** I/ActivityManager(249): START {flg=0x10000000 cmp=com.habrahabr.ActivityStackLifeCycle/.ActivityA u=0} from pid 1195 I/ActivityManager(249): Start proc com.habrahabr.ActivityStackLifeCycle <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> activity com.habrahabr.ActivityStackLifeCycle/.ActivityA: pid=1267 uid=10060 gids={1028} D/ActivityA(1267): onCreate() D/ActivityA(1267): onStart() ***  Home,  - , , ,      *** &lt;...&gt; I/ActivityManager(249): Process com.habrahabr.ActivityStackLifeCycle (pid 1267) has died. &lt;...&gt; ***    ,     *** I/ActivityManager(249): Start proc com.habrahabr.ActivityStackLifeCycle <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> activity com.habrahabr.ActivityStackLifeCycle/.ActivityC: pid=1879 uid=10060 gids={1028} D/ActivityC(1879): onCreate() D/ActivityC(1879): onStart()</code> </pre><br>  From the log, we see that the process of our application ( <code>id=1267</code> ) was killed, but this did not prevent Android from returning to our application to create a new one ( <code>id=1879</code> ) and open the last ActivityC we were on when we turned off the application. <br><br>  We will do something similar, but we will not wait until the third-party application requires memory and kills our application, and do it ourselves through the Application Manager with the Force Stop button. <br><br>  <b>App1-&gt; A-&gt; B-&gt; C-&gt; Home-&gt; App Manager-&gt; Force Stop-&gt; App1</b> <br><pre> <code class="bash hljs">***   *** I/ActivityManager(249): START {flg=0x10000000 cmp=com.habrahabr.ActivityStackLifeCycle/.ActivityA u=0} from pid 32050 I/ActivityManager(249): Start proc com.habrahabr.ActivityStackLifeCycle <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> activity com.habrahabr.ActivityStackLifeCycle/.ActivityA: pid=32090 uid=10060 gids={1028} D/ActivityA(32090): onCreate() D/ActivityA(32090): onStart() &lt;...&gt; ***  Home,  Application Manager,       Force Stop *** I/ActivityManager(249): Force stopping package com.habrahabr.ActivityStackLifeCycle uid=10060 I/ActivityManager(249): Killing proc 32090:com.habrahabr.ActivityStackLifeCycle/u0a60: force stop I/ActivityManager(249): Force finishing activity ActivityRecord{419ba4b0 com.habrahabr.ActivityStackLifeCycle/.ActivityA} I/ActivityManager(249): Force finishing activity ActivityRecord{41c392b8 com.habrahabr.ActivityStackLifeCycle/.ActivityB} I/ActivityManager(249): Force finishing activity ActivityRecord{41ac4588 com.habrahabr.ActivityStackLifeCycle/.ActivityC} &lt;...&gt; ***   Application Manager,     *** I/ActivityManager(249): START {flg=0x10104000 cmp=com.habrahabr.ActivityStackLifeCycle/.ActivityA u=0} from pid 337 I/ActivityManager(249): Start proc com.habrahabr.ActivityStackLifeCycle <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> activity com.habrahabr.ActivityStackLifeCycle/.ActivityA: pid=32378 uid=10060 gids={1028} D/ActivityA(32378): onCreate() D/ActivityA(32378): onStart()</code> </pre><br>  We get a completely different behavior: Activity Stack is lost, and when the application starts after force stop, we find ourselves in the root ActivityA. <br><br>  We also note that in both cases, when our process was completely destroyed, the <code>onDestroy()</code> method was not called in any Activity, this should certainly be taken into account when developing. <br><br>  We dealt with the default behavior, but Android‚Äôs arsenal has the tools to change the behavior to fit our needs.  We will look at them in the next section. <br><br>  PS Added your comments to the logs at the request of <a href="https://habrahabr.ru/users/vest/" class="user_link">Vest</a> .  Thank!  It seems to be clearer. <br></div><p>Source: <a href="https://habr.com/ru/post/201214/">https://habr.com/ru/post/201214/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201204/index.html">Hadoop Part 2: Collecting Data with Flume</a></li>
<li><a href="../201206/index.html">How Passport.js works</a></li>
<li><a href="../201208/index.html">In South Australia, earned a wave power plant with a capacity of 1 MW</a></li>
<li><a href="../201210/index.html">How to sign java applet</a></li>
<li><a href="../201212/index.html">About how I accidentally dropped the browser game server from EA</a></li>
<li><a href="../201218/index.html">What personal GTD / To-Do services lack</a></li>
<li><a href="../201220/index.html">Simulate the electrical activity of neurons</a></li>
<li><a href="../201222/index.html">[Answer] Building a street wifi network</a></li>
<li><a href="../201228/index.html">Tower defense do it yourself</a></li>
<li><a href="../201230/index.html">Reader problems. Is paradise somewhere near?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>