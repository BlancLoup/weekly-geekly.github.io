<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We use MongoDB in a cloud backend of mobile applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the advantages of the .NET mobile services backend in Azure is that it has built-in support not only for the SQL Database (SQL Azure), but also...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We use MongoDB in a cloud backend of mobile applications</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e63/df8/db3/e63df8db3e7c4d1f89205a15e1e98ceb.png"><br><br>  One of the advantages of the <b>.NET</b> mobile services <b>backend</b> in <a href="http://azure.microsoft.com/ru-ru/">Azure</a> is that it has built-in support not only for the SQL Database (SQL Azure), but also for other data warehouses. <br><br>  When using <b>node.</b>  <b>js,</b> you can refuse to work with SQL and use other possible storage (for example, as it is written in Chris Reisner‚Äôs article on Azure Table Storage), but this functionality is not built-in, so you have to write some code yourself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When using .NET, most of the functions for working with non-SQL storages are already integrated, so <b>there is no need to create ‚Äúdummy‚Äù tables</b> , as in node.js, only to be able to send queries to the data. <br><br>  In this article, I will talk about <b>MongoDB support</b> and how to create tables, CRUD operations with which will be carried out directly with the MongoDB collection. <br><a name="habracut"></a><br><h3>  Database Setup </h3><br>  If you already <b>have a MongoDB account</b> , you can skip this step (remember the connection string - we will need it later). <br><br>  In this article I will use a collection called ‚Äúorders‚Äù, if such a collection does not exist, then you don‚Äôt need to create it yourself - the backend will create it automatically. <br><br>  For those <b>who start from scratch</b> , I explain: this article uses <b>the Mongo Labs database</b> , which is available on the <a href="http://azure.microsoft.com/ru-ru/">Microsoft Azure</a> portal for free (limited version).  To create an account, go to the Azure portal, then click <b>"New" -&gt; "Store"</b> and select the MongoLab add-on, and then register your account. <br><br> <a href=""><img src="https://habrastorage.org/files/65f/855/2fe/65f8552fe58f4f239fc83311a7f25a0d.png"></a> <br><br>  When the account is set up, click the <b>"Connection info"</b> button in order to get the URI required to connect to the database.  Let's keep it.  Your account name will be the name of the database that we will use later. <br><br> <a href=""><img src="https://habrastorage.org/files/d25/0e4/d4c/d250e4d4cb9f4445a5c219acfc0a6d5e.png"></a> <br><br>  Mongo database is configured;  we do not need to create a collection, since it will be created when we try to access it for the first time. <br><br><h3>  Service setting </h3><br>  In Visual Studio, there is no possibility of creating a project with a backend using something other than the Entity Framework, so we will create an empty web project.  We will start with what I did in my <a href="http://blogs.msdn.com/b/azuremobile/archive/2014/04/10/creating-an-azure-mobile-services-net-backend-from-scratch.aspx">previous article on creating a .NET backend from scratch</a> , but instead of adding the Azure Mobile Services .NET Backend Entity Framework NuGet package, we‚Äôll add the <a href="https://www.nuget.org/packages/WindowsAzure.MobileServices.Backend.Mongo">Azure Mobile Services .NET Backend <b>Mongo</b></a> package <a href="https://www.nuget.org/packages/WindowsAzure.MobileServices.Backend.Mongo"><b>.</b></a> <a href="https://www.nuget.org/packages/WindowsAzure.MobileServices.Backend.Mongo"><br><br></a>  We will also add the <a href="https://www.nuget.org/packages/Microsoft.Owin.Host.SystemWeb">Microsoft.Owin.Host.SystemWeb</a> package, which is necessary in order for us to be able to run locally to facilitate the debugging process. <br><br>  After installing both packages (and their dependencies), we add the initializing static <b>WebApiConfig</b> class with the Register method by default: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WebApiConfig</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Register</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ServiceConfig.Initialize(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConfigBuilder()); } }</code> </pre> <br>  Add a global class to the application to locally call the initializer: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Global</span></span> : <span class="hljs-title"><span class="hljs-title">System</span></span>.<span class="hljs-title"><span class="hljs-title">Web</span></span>.<span class="hljs-title"><span class="hljs-title">HttpApplication</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { WebApiConfig.Register(); } }</code> </pre><br>  Define an object model that will be stored in a database collection.  We define the class ‚ÄúOrder‚Äù containing a list of elements. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Order</span></span> : <span class="hljs-title"><span class="hljs-title">DocumentData</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime OrderDate { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Client { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;OrderItem&gt; Items { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OrderItem</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Quantity { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br>  The data model must implement the <code>ItableData</code> interface as well as it does for the Entity Framework data models. To implement this interface in the Entity Framework, we use the base class <code>EntityData</code> <code>,</code> which is similar to the <code>DocumentData</code> class when using MongoDB <code>.</code>  After that, we can only determine the properties of the subject area in the class model. <br><br><h3>  Table definition </h3><br>  Tables for MongoDB are actually <b>similar to EF</b> .  Operations can be implemented in the same scenario, excluding only those situations when we need to implement a new managing class of the domain for which we can use the <b>MongoDomainManager</b> class, available from the <a href="https://www.nuget.org/packages/WindowsAzure.MobileServices.Backend.Mongo">Azure Mobile Services .NET Backend Mongo</a> package. <br><br>  Please note that for execution of operations you can always use <b>types directly from the MongoDB driver</b> (or any other Mongo client) to implement operations, but for common scenarios the required implementation is provided by the base class <b>TableController &lt;</b> <b>T&gt;</b> . <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OrderController</span></span> : <span class="hljs-title"><span class="hljs-title">TableController</span></span>&lt;<span class="hljs-title"><span class="hljs-title">Order</span></span>&gt; { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpControllerContext controllerContext</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Initialize(controllerContext); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> connStringName = <span class="hljs-string"><span class="hljs-string">"mongodb"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dbName = <span class="hljs-string"><span class="hljs-string">"MyMongoLab"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collectionName = <span class="hljs-string"><span class="hljs-string">"orders"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.DomainManager = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MongoDomainManager&lt;Order&gt;(connStringName, dbName, collectionName, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Request, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Services); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IQueryable&lt;Order&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetAllOrders</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Query(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Order </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetOneOrder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Lookup(id).Queryable.FirstOrDefault(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpResponseException(HttpStatusCode.NotFound); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Task&lt;Order&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PostOrder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Order order</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.InsertAsync(order); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DeleteOrder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.DeleteAsync(id); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Task&lt;Order&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PatchOrder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, Delta&lt;Order&gt; patch</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.UpdateAsync(id, patch); } }</code> </pre><br>  The first parameter in the <code>MongoDomainManager</code> constructor is the name of the element from the <b>&lt;</b> <b>connectionStrings&gt;</b> section in the configuration that contains the actual connection string to the database (we can later add a function to pass the actual connection string to the constructor). <br><br>  Add the appropriate section to the <b>web.config file</b> (use the connection string obtained in the Azure portal): <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">connectionStrings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mongodb"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">connectionString</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mongodb://MyMongoLab:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX-@dsNNNNNN.mongolab.com:PPPPP/MyMongoLab"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">connectionStrings</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now the project should start. <br><br><h3>  Service testing </h3><br>  Test the service.  To send requests to the service, use <b>Fiddler</b> . <br><br>  First, let's see what GET returns to us: <br><br><pre> <code class="bash hljs">GET http://localhost:54524/tables/order HTTP/1.1 User-Agent: Fiddler Host: localhost:54524 =-=-=-=-=-=-=-=-=- HTTP/1.1 200 OK Cache-Control: no-cache Pragma: no-cache Content-Length: 2 Content-Type: application/json; charset=utf-8 Expires: 0 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 15:43:31 GMT []</code> </pre><br>  Nothing unexpected (except that we already have a collection of "orders"). <br><br>  Add a couple of elements to our collection: <br><br><pre> <code class="bash hljs">POST http://localhost:54524/tables/order HTTP/1.1 User-Agent: Fiddler Host: localhost:54524 Content-Length: 211 Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"client"</span></span>:<span class="hljs-string"><span class="hljs-string">"John Doe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>:<span class="hljs-string"><span class="hljs-string">"2014-04-13T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>:[ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"bread"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 1.99 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"milk"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 2, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 2.99 } ] } =-=-=-=-=-=-=-=-=- HTTP/1.1 200 OK Content-Length: 383 Content-Type: application/json; charset=utf-8 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 15:53:13 GMT { <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-13T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"John Doe"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"bread"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 1.99 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"milk"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 2.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 2.99 } ], <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0469f76e1e10c4703c2b"</span></span>, <span class="hljs-string"><span class="hljs-string">"__createdAt"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-14T15:53:12.982Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"__updatedAt"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-14T15:53:12.982Z"</span></span> }</code> </pre><br>  And one more: <br><br><pre> <code class="bash hljs">POST http://localhost:54524/tables/order HTTP/1.1 User-Agent: Fiddler Host: localhost:54524 Content-Length: 216 Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"client"</span></span>:<span class="hljs-string"><span class="hljs-string">"Jane Roe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>:<span class="hljs-string"><span class="hljs-string">"2014-02-22T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>:[ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"nails"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 100, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 3.50 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"hammer"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 12.34 } ] } =-=-=-=-=-=-=-=-=- HTTP/1.1 200 OK Content-Length: 387 Content-Type: application/json; charset=utf-8 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 15:53:21 GMT { <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-02-22T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"Jane Roe"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"nails"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 100.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 3.5 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"hammer"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 12.34 } ], <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0471f76e1e10c4703c2c"</span></span>, <span class="hljs-string"><span class="hljs-string">"__createdAt"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-14T15:53:21.557Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"__updatedAt"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-14T15:53:21.557Z }</span></span></code> </pre><br>  Send another GET request to check the result: <br><br><pre> <code class="bash hljs">GET http://localhost:54524/tables/order HTTP/1.1 User-Agent: Fiddler Host: localhost:54524 =-=-=-=-=-=-=-=-=- HTTP/1.1 200 OK Cache-Control: no-cache Pragma: no-cache Content-Length: 239 Content-Type: application/json; charset=utf-8 Expires: 0 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 15:55:12 GMT [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0469f76e1e10c4703c2b"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"John Doe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-13T00:00:00Z"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0471f76e1e10c4703c2c"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"Jane Roe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-02-22T00:00:00Z"</span></span> } ]</code> </pre><br>  We received the elements added earlier, but did not receive <b>difficult property</b> (items list) in object. <br><br>  The problem is that the return type of the function ( <b>IQueryable Order</b> ) returns complex types only if it is explicitly specified in the request (using the <b>$</b> <b>expand = &lt;</b> <b>propertyName&gt;</b> parameter). <br><br>  It is useful to have a method that returns an object of type <b>queryable</b> , because it additionally allows you to use filtering and sorting (via the <b>$ filter and $ orderby parameters</b> ). <br><br>  Therefore, we must decide whether to continue using the queryable and send the $ expand parameter to return complex types, or better to switch to another return type. <br><br>  <b>In the latter case, the</b> change is quite simple: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Order&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetAllOrders</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Query().ToList(); }</code> </pre><br>  There are several options for generating queries.  The simplest (on the server) is to make the <b>client send the $ expand parameter in the header</b> , and then nothing needs to be changed on the server. <br><br>  We send the request and get back the whole document: <br><br><pre> <code class="bash hljs">GET http://localhost:54524/tables/order?<span class="hljs-variable"><span class="hljs-variable">$expand</span></span>=items HTTP/1.1 User-Agent: Fiddler Host: localhost:54524 =-=-=-=-=-=-=-=-=- HTTP/1.1 200 OK Cache-Control: no-cache Pragma: no-cache Content-Length: 663 Content-Type: application/json; charset=utf-8 Expires: 0 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 17:52:26 GMT [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0469f76e1e10c4703c2b"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"John Doe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-13T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"bread"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 1.99 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"milk"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 2.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 2.99 } ] }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0471f76e1e10c4703c2c"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"Jane Roe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-02-22T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"nails"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 100.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 3.5 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"hammer"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 12.34 } ] } ]</code> </pre><br>  Another option is to use the <b>action</b> <b>filter</b> attribute <b>,</b> which changes the incoming request so that the $ expand parameter is constantly added to the request. <br><br>  Below is one of the possible implementations: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">AttributeUsage(AttributeTargets.Method, AllowMultiple = true)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ExpandPropertyAttribute</span></span> : <span class="hljs-title"><span class="hljs-title">ActionFilterAttribute</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> propertyName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExpandPropertyAttribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> propertyName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.propertyName = propertyName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnActionExecuting</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpActionContext actionContext</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.OnActionExecuting(actionContext); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> uriBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UriBuilder(actionContext.Request.RequestUri); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> queryParams = uriBuilder.Query.TrimStart(<span class="hljs-string"><span class="hljs-string">'?'</span></span>).Split(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">'&amp;'</span></span> }, StringSplitOptions.RemoveEmptyEntries).ToList(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> expandIndex = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; queryParams.Count; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (queryParams[i].StartsWith(<span class="hljs-string"><span class="hljs-string">"$expand"</span></span>, StringComparison.Ordinal)) { expandIndex = i; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (expandIndex &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { queryParams.Add(<span class="hljs-string"><span class="hljs-string">"$expand="</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.propertyName); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { queryParams[expandIndex] = queryParams[expandIndex] + <span class="hljs-string"><span class="hljs-string">","</span></span> + propertyName; } uriBuilder.Query = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Join(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>, queryParams); actionContext.Request.RequestUri = uriBuilder.Uri; } }</code> </pre><br>  And after we mark our method with this attribute: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">ExpandProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Items"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IQueryable&lt;Order&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetAllOrders</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Query(); }</code> </pre><br>  We can send queries that use <b>other queryable attributes</b> , but at the same time return all the elements of the object. <br><br><pre> <code class="bash hljs">GET http://localhost:54524/tables/order?<span class="hljs-variable"><span class="hljs-variable">$orderby</span></span>=client HTTP/1.1 User-Agent: Fiddler Host: localhost:54524 =-=-=-=-=-=-=-=-=- HTTP/1.1 200 OK Cache-Control: no-cache Pragma: no-cache Content-Length: 663 Content-Type: application/json; charset=utf-8 Expires: 0 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 18:37:27 GMT [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0471f76e1e10c4703c2c"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"Jane Roe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-02-22T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"nails"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 100.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 3.5 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"hammer"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 12.34 } ] }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0469f76e1e10c4703c2b"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"John Doe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-13T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"bread"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 1.99 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"milk"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 2.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 2.99 } ] } ]</code> </pre><br><br><h3>  Deployment </h3><br>  Now that the service is running locally, everything is ready for publishing to <a href="http://azure.microsoft.com/ru-ru/">Azure</a> . <br><br>  After downloading the publication profile from the portal, right-click on the project in VS and select <b>‚ÄúPublish‚Äù</b> - the service will be published. <br><br>  And, if we use Fiddler again, we will need to get two ‚Äúorder‚Äù elements directly from Azure: <br><br><pre> <code class="bash hljs">GET http://blog20140413.azure-mobile.net/tables/order HTTP/1.1 User-Agent: Fiddler Host: blog20140413.azure-mobile.net =-=-=-=-=-=-=-=-=- HTTP/1.1 500 Internal Server Error Cache-Control: no-cache Pragma: no-cache Content-Length: 43 Content-Type: application/json; charset=utf-8 Expires: 0 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 18:50:22 GMT { <span class="hljs-string"><span class="hljs-string">"message"</span></span>: <span class="hljs-string"><span class="hljs-string">"An error has occurred."</span></span> }</code> </pre><br><br>  Something went wrong.  By default, the runtime does not return error details (for security reasons), so we can check the log files in the portal and see what happened.  The error will be here: <br><br><pre> <code class="bash hljs">Exception=System.ArgumentException: No connection string named <span class="hljs-string"><span class="hljs-string">'mongodb'</span></span> could be found <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the service configuration. at Microsoft.WindowsAzure.Mobile.Service.MongoDomainManager`1.GetMongoContext(String connectionStringName) at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory) at Microsoft.WindowsAzure.Mobile.Service.MongoDomainManager`1..ctor(String connectionStringName, String databaseName, String collectionName, HttpRequestMessage request, ApiServices services) at MongoDbOnNetBackend.OrderController.Initialize(HttpControllerContext controllerContext) at System.Web.Http.ApiController.ExecuteAsync(HttpControllerContext controllerContext, CancellationToken cancellationToken) at System.Web.Http.Dispatcher.HttpControllerDispatcher.SendAsyncCore(HttpRequestMessage request, CancellationToken cancellationToken) at System.Web.Http.Dispatcher.HttpControllerDispatcher.d__0.MoveNext(), Id=6133b3eb-9851-4</code> </pre><br>  The problem is that the <b>local web.config file</b> used when starting the service locally is not suitable when starting the service in the cloud.  We need to define the connection string in another way. <br><br>  Unfortunately, because of this error, we don‚Äôt have a simple way to define a connection string (the portal would allow it to be done easily, but so far this function is not there), so we use a <b>workaround</b> . <br><br>  To do this, go to the portal in the section of mobile services and on the tab <b>‚ÄúConfigure‚Äù</b> add a new <i>app setting</i> , whose value is the connection string, which we defined in the web.config file: <br><br> <a href=""><img src="http://habrastorage.org/files/295/5cb/51d/2955cb51d05b4725abb14961b04a2267.png"></a> <br><br>  After initializing the table controller, we change the connection string in the service settings, based on the value we received from the application settings. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> connectionStringInitialized = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeConnectionString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> connStringName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> appSettingName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!connectionStringInitialized) { connectionStringInitialized = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Services.Settings.Connections.ContainsKey(connStringName)) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> connFromAppSetting = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Services.Settings[appSettingName]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> connSetting = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConnectionSettings(connStringName, connFromAppSetting); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Services.Settings.Connections.Add(connStringName, connSetting); } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpControllerContext controllerContext</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> connStringName = <span class="hljs-string"><span class="hljs-string">"mongodb"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dbName = <span class="hljs-string"><span class="hljs-string">"MyMongoLab"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collectionName = <span class="hljs-string"><span class="hljs-string">"orders"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Workaround for lack of connection strings in the portal InitializeConnectionString(connStringName, "mongoConnectionString"); base.Initialize(controllerContext); this.DomainManager = new MongoDomainManager&lt;Order&gt;(connStringName, dbName, collectionName, this.Request, this.Services); }</span></span></code> </pre><br>  Now, if we deploy the service again, we should be able to get the table data from Azure: <br><br><pre> <code class="bash hljs">GET http://blog20140413.azure-mobile.net/tables/order HTTP/1.1 User-Agent: Fiddler Host: blog20140413.azure-mobile.net x-zumo-application: cOFQkbaAmffuVRBJRpYDKHbNHbtDYG97 =-=-=-=-=-=-=-=-=- HTTP/1.1 200 OK Cache-Control: no-cache Pragma: no-cache Content-Length: 663 Content-Type: application/json; charset=utf-8 Expires: 0 Server: Microsoft-IIS/8.0 X-Powered-By: ASP.NET Date: Mon, 14 Apr 2014 19:21:11 GMT [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0469f76e1e10c4703c2b"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"John Doe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-04-13T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"bread"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 1.99 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"milk"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 2.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 2.99 } ] }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"534c0471f76e1e10c4703c2c"</span></span>, <span class="hljs-string"><span class="hljs-string">"client"</span></span>: <span class="hljs-string"><span class="hljs-string">"Jane Roe"</span></span>, <span class="hljs-string"><span class="hljs-string">"orderDate"</span></span>: <span class="hljs-string"><span class="hljs-string">"2014-02-22T00:00:00Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"nails"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 100.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 3.5 }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"hammer"</span></span>, <span class="hljs-string"><span class="hljs-string">"quantity"</span></span>: 1.0, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: 12.34 } ] } ]</code> </pre><br>  Finally, I note that with the local launch of the service, the default is not authentication, so our request may not send the keys.  When sending a request to the server in Azure, you need to specify the <b>application key</b> (default authentication level) in the "x-zumo-application" header. <br><br><h3>  Conclusion </h3><br>  .  <b>NET backend</b> for mobile services Azure offers a set of storage providers for tabular data abstraction. <br><br>  Since most of the existing examples describe the work with the Entity Framework (SQL server), I hope that this post has allowed you to learn how to use the <b>MongoDB provider</b> for data storage. <br><br>  And as usual, we welcome comments and tips on the blog, on the MSDN forums or on twitter <b>@AzureMobile</b> . <br><br><h3>  useful links </h3><br>  <a href="http://www.windowsazure.com/ru-ru/pricing/free-trial/%3FWT.mc_id%3DAF078DAA2">Free</a> 30-day trial of Microsoft Azure; <br>  <a href="http://msdn.microsoft.com/ru-ru/jj950243">Free</a> access to Microsoft Azure resources for <a href="http://bit.ly/11VUn4L">startups</a> , <a href="http://bit.ly/19LE3bS">partners</a> , teachers, <a href="http://bit.ly/19LE3bS">MSDN subscribers</a> ; <br>  <a href="http://www.azurehub.ru/">Microsoft Azure Development Center (azurehub.ru)</a> - scripts, tutorials, examples, recommendations on the choice of services and development on Microsoft Azure; <br>  Latest Microsoft Azure News - <a href="http://www.twitter.com/windowsazure_ru">Twitter.com/windowsazure_ru</a> . <br>  <a href="http://www.facebook.com/groups/azurerus/">The Microsoft Azure Community on Facebook</a> .  Here you will find experts, photos and a lot of news. <br>  <a href="http://www.microsoftvirtualacademy.com/">Microsoft Virtual Academy (MVA) Training Courses</a> <br>  <a href="http://aka.ms/getvsrus">Download free or trial Visual Studio 2013</a> </div><p>Source: <a href="https://habr.com/ru/post/239633/">https://habr.com/ru/post/239633/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../239619/index.html">Extended processor instructions in .NET or "C # Intrinsics"</a></li>
<li><a href="../239621/index.html">User intention: enhancing the digital campaign with user factors</a></li>
<li><a href="../239625/index.html">200 microcomputers in 3 hours, or small-scale production of microelectronics in Shenzhen (on the example of the VoCore project)</a></li>
<li><a href="../239627/index.html">Algorithmic trading on the stock market in Russia: trends and technologies</a></li>
<li><a href="../239629/index.html">Check Network Security Services Library</a></li>
<li><a href="../239635/index.html">Creating OS X Applications with JavaScript</a></li>
<li><a href="../239637/index.html">Do not be afraid to use HandlerSocket</a></li>
<li><a href="../239639/index.html">Exoskeletons in medicine</a></li>
<li><a href="../239641/index.html">Instructions for obtaining a radio call sign and certificate of registration of RES</a></li>
<li><a href="../239643/index.html">Alternative outcome of creating a strong AI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>