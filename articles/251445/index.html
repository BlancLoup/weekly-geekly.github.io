<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability in WP-Slimstat plugin 3.9.5 and below for WordPress</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Users of the WP-Slimstat plugin version 3.9.5 and below should upgrade as soon as possible! During the next security audit, we discovered a security e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability in WP-Slimstat plugin 3.9.5 and below for WordPress</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/8bb/c3b/190/8bbc3b190aa344f29b84a3d8d79b843f.png"><br><br>  Users of the WP-Slimstat plugin version 3.9.5 and below should upgrade as soon as possible!  During the next security audit, we discovered a security error, due to which an attacker could obtain the ‚Äúsecret‚Äù key of the plug-in and, thus, implement a SQL injection. <br><br>  Successful implementation of this bug can lead to attacks like ‚Äúblind sql injection‚Äù (Blind SQL-Injection), which will allow an attacker to obtain data from the database, including the username, password hash, and in some configurations and secret keys of WordPress itself (full control of the site). <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      WP-Slimstat uses a ‚Äúsecret‚Äù key to sign data sent from / to the client.  Looking at how this key is generated, it can be concluded that it is easy for an attacker to recognize it: <br><img src="https://habrastorage.org/files/26a/2ea/0ff/26a2ea0ff4da4581af93fa412c23c9c1.png"><br><br>  The hash from the time when the plugin was installed is used as a ‚Äúsecret‚Äù key.  An attacker could use sites such as, for example, <a href="https://archive.org/">Internet Archive</a> , to find out the approximate time of site creation (after this there are approximately 30 million values ‚Äã‚Äãto check that for modern CPUs it will take about 10 minutes). <br><br>  To be able to perform brute force, you only need to get valid and signed data from the plugin.  They are easy to find in different fragments of generated web pages: <br><img src="https://habrastorage.org/files/e46/27d/6b1/e4627d6b15d54d508f8fe183a3852cea.png"><br><br>  At first glance, this may seem complicated, but, looking at how this data structure is used in the plugin, you can follow a simple way of signing data and hashing a composite string consisting of payload and a ‚Äúsecret‚Äù token: <br><img src="https://habrastorage.org/files/3e5/58a/3c9/3e558a3c97154af3a5684afd85209655.png"><br><br>  Knowing this information, an attacker can brutalize timestamps until he receives the same signature as the site he attacked. <br><br>  During the investigation, we were able to establish that we can pass arbitrary data when calling <b>unserialize ()</b> , which will later be passed to the <b>maybe_insert_row ()</b> method via the <b>$ content_info</b> variable: <br><img src="https://habrastorage.org/files/31d/a9c/459/31da9c4591464c52804c60f0d9a75555.png"><br><br><img src="https://habrastorage.org/files/569/5f0/3fe/5695f03fe7e745c8aefb3683ed5d571f.png"><br><br>  Given that we control <b>$ _data</b> , we can add an associative array to it, whose indexes are SQL expressions, for example: <pre><code class="sql hljs">array(‚Äú1=sleep(100)‚Äì‚Äú=&gt;‚Äù1‚Ä≥)</code> </pre> <br>  This ability to perform any requests allows an attacker to get any data from the database.  This is a dangerous vulnerability and you should update the plugin as soon as possible. </div><p>Source: <a href="https://habr.com/ru/post/251445/">https://habr.com/ru/post/251445/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251435/index.html">We stamp windows: automated deployment of Windows virtual machines to Hyper-V using Vagrant (part 1)</a></li>
<li><a href="../251437/index.html">Creating a convenient export of photos in VK. Part 1. iPhoto</a></li>
<li><a href="../251439/index.html">The output temperature, traffic jams and exchange rates on the LED matrix Raspberry Pi</a></li>
<li><a href="../251441/index.html">Few obscure frontend tricks</a></li>
<li><a href="../251443/index.html">Visual Studio 2015 CTP6 released</a></li>
<li><a href="../251447/index.html">In search of the best signal of the mobile Internet in the spring of 2015</a></li>
<li><a href="../251449/index.html">Complete energy autonomy or how to survive with solar panels in the outback (part 2. practical)</a></li>
<li><a href="../251451/index.html">Usb killer</a></li>
<li><a href="../251459/index.html">We make a map of cable routes "on the knee"</a></li>
<li><a href="../251461/index.html">A year and a half of working with SAP hybris: normal flight. The most important thing you need to know about developing on eCommerce platforms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>