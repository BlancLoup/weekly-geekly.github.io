<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hyperledger Fabric for Dummies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A Blockchain Platform for the Enterprise 





 Good afternoon, dear readers, my name is Nikolay Nefedov, I am an IBM technical specialist, in this ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hyperledger Fabric for Dummies</h1><div class="post__text post__text-html js-mediator-article"><h2 id="a-blockchain-platform-for-the-enterprise">  A Blockchain Platform for the Enterprise </h2><br><p><img src="https://habrastorage.org/webt/qn/hb/p7/qnhbp7fep6rj8xhtahqvmo_ofjw.png"></p><br><p>  Good afternoon, dear readers, my name is Nikolay Nefedov, I am an IBM technical specialist, in this article I would like to introduce you to the blockchain platform - Hyperledger Fabric.  The platform is designed to build enterprise-level business applications (Enterprise class).  The level of the article is for unprepared readers with basic knowledge of IT technologies. </p><a name="habracut"></a><br><p>  Hyperledger Fabric is an open-source project, one of the branches of the open project Hyperledger, a consortium of Linux Foundation.  Hyperledger Fabric was originally launched by Digital Assets and IBM.  The main feature of the platform Hyperledger Fabric is focused on corporate use.  Therefore, the platform was designed to ensure high speed of transactions and their low cost, as well as the identification of all participants.  These benefits are achieved through the separation of the transaction verification service and the formation of new blocks of a distributed registry, as well as the use of a certification authority and authorization of participants. </p><br><p>  My article is part of a series of articles on Hyperledger Fabric in which we describe the design of a system for accounting for students entering a university. </p><br><h3 id="obschaya-arhitektura-hyperledger-fabric">  Hyperledger Fabric overall architecture </h3><br><p>  Hyperledger Fabric is a distributed blockchain network consisting of various functional components that are installed on network nodes.  The components of the Hyperledger Fabric are Docker containers, which can be freely downloaded from the DockerHub.  Hyperledger Fabric can also be run in a Kubernetes environment. </p><br><p>  We used Golang to write smart contracts (chaincode in the context of Hyperledger Fabric) (although Hyperledger Fabric allows other languages ‚Äã‚Äãto be used).  In our case, Node.js with the corresponding Hyperledger Fabric SDK was used to develop a custom application. </p><br><p>  The nodes run business logic (smart contract) - chaincode, stores the state of the distributed registry (ledger data), and performs other system services of the platform.  A node is only a logical unit, different nodes can exist on the same physical server.  Much more important is how the nodes are grouped (Trusted domain) and what functions of the blockchain network they are associated with. </p><br><p>  The overall architecture is as follows: </p><br><p><img src="https://habrastorage.org/webt/s7/qb/ms/s7qbms0zfwhx0qnl7xxl27yzbvu.png"></p><br><p>  <em>Picture 1. General Hyperledger Fabric Architecture</em> </p><br><p>  User application (Submitting Client) - an application with which users work with the blockchain network.  To work, you must pass authorization and have the appropriate rights to various actions in the network. </p><br><p>  Peers (Nodes) come in several roles: </p><br><ul><li>  Endorsing Peer is a node that simulates the execution of a transaction (executes a smart contract code).  After the verification and execution of the smart contract is completed, the node returns the results of the execution to the client application along with its signature. </li><li>  Ordering Service - a distributed service on several nodes; it is used to form new blocks of a distributed registry and create a sequence for the execution of transactions.  Ordering Service does not add new blocks to the registry (For better performance, this function has been moved to Committing Peers). </li><li>  Committing Peer is the node that contains the distributed registry and adds new blocks to the registry (which were formed by the Ordering Service).  All Committing Peers contain a local copy of the distributed registry.  Committing Peer before local adding of a new block checks all transactions inside the block for validity. </li></ul><br><p>  Endorsement Policy is a validation policy for a transaction.  These policies determine the required set of nodes on which a smart contract must be executed in order for a transaction to be recognized as valid. </p><br><p>  The Distributed Registry - Lerger - consists of two parts: WolrldState (also called State DataBase) and BlockChain. </p><br><p>  BlockChain is a chain of blocks that keeps records of all changes that have occurred to objects of the distributed registry. </p><br><p>  WolrldState is a distributed registry component that stores the current (extreme) values ‚Äã‚Äãof all distributed registry objects. </p><br><p>  WorldState is a database, in the base case - LevelDB or more complex - CouchDB, which contains key-value pairs, for example: Name - Ivan, Last Name - Ivanov, system registration date - 12.12.21, date of birth - 12.17.1961, etc.  WorldState and the distributed registry must be consistent across all members of this channel. </p><br><p>  Since the Hyperledger Fabric is a network in which all participants are known and authenticated, it uses a dedicated certification authority - CA (Certification Authority).  CA works on the basis of the X.509 standard and public key infrastructure - PKI. </p><br><p>  Membership Service is a service through which members verify that an object belongs to a particular organization or channel. </p><br><p>  A transaction - in most cases, is a record of new data in a distributed registry. <br>  There are also transactions to create channels or smart contracts.  The transaction is initiated by the user application and ends with writing to the distributed registry. </p><br><p>  Channel (Channel) - is a closed subnet, consisting of two or more participants of the blockchain network, designed to conduct confidential transactions within a limited, but known, group of participants.  The channel is determined by the participants, their distributed registry, smart contracts, Ordering Service, WorldState.  Each channel participant must be authorized to access the channel and have the right to perform various types of transactions.  Authorization is performed using the Membership Service. </p><br><h3 id="tipovoy-scenariy-ispolneniya-tranzakcii">  Typical transaction execution scenario </h3><br><p>  Further I would like to tell about the typical scenario of transaction performance on the example of our project. </p><br><p>  As part of our internal project, we have created a Hyperledger Fabric network, which is designed to register and account for students entering universities.  Our network consists of two organizations belonging to University A and University B. Each organization contains a client application, as well as its Committing and Endorsing Peer.  We also use the general services Ordering Service, Memebership Service and Certification Authority. </p><br><h4 id="1-iniciaciya-tranzakcii">  1) Transaction Initiation </h4><br><p>  The user application, using the Hyperledger Fabric SDK, initiates a transaction request and sends a request to the nodes with smart contracts.  A request may be for changing or reading from a distributed registry (Ledger).  If we consider an example of our test system configuration for accounting for university students, the client application sends a transaction request to the universities A and B, which are included in the Endorsement policy of the called smart contract.  Node A is a node that is located at the university, which registers an incoming student, and node B is a node that is located at another university.  In order for the transaction to be saved to a distributed registry, it is necessary that all nodes that, according to business logic, must approve the transaction, successfully execute smart contracts with the same result.  The user application of node A, using the tools of the Hyperledger Fabric SDK, gets an Endorsement policy and finds out which nodes need to send a transaction request.  This is a request to call (invoke) a specific smart contract (chaincode function) to read or write certain data to a distributed registry.  Technically, the client SDK uses the corresponding function, the API of which passes a certain object with transaction parameters, and also adds a client signature and sends this data via protocol buffer over gRPC to the corresponding nodes (endorsing peers). </p><br><p><img src="https://habrastorage.org/webt/cr/ey/97/crey97gyuageyhchm1dk5ybbgxi.png"><br>  <em>Picture 2. Transaction Initiation</em> </p><br><h4 id="2-vypolnenie-smart-kontrakta">  2) Execution of a smart contract </h4><br><p> The nodes (Endorsing Peers), after receiving a request to conduct a transaction, check the client's signature and, if everything is in order, then take the object with the request data and start the simulation of the smart contract execution (chaincode function) with this data.  A smart contract is a business logic of a transaction, a specific set of conditions and instructions (in our case, this is a student's check, a new one is a student, or he is already registered, an age check, etc.).  To execute a smart contract, you also need data from WorldState.  As a result of the simulation of a smart contract for Endorsing peer, two sets of data are obtained - Read Set and Write Set.  Read Set and Write Set are the original and new WorldState values.  (new - in the sense obtained when simulating a smart contract). </p><br><p><img src="https://habrastorage.org/webt/my/_a/k6/my_ak6-vqamxqbdxa0dohcw4jua.png"><br>  <em>Picture 3. Execution of a smart contract</em> </p><br><h4 id="3-vozvrat-dannyh-klientskomu-prilozheniyu">  3) Return data to the client application </h4><br><p>  After the simulation of the smart contract, Endorsing Peers returns the initial data and the simulation result to the client application, as well as the RW Set, signed with their certificate.  At this stage, no changes are made to the distributed registry.  The client application verifies the Endorsing Peer signature, and also compares the original transaction data that was sent and the data that returned (that is, it checks if the original data was not distorted over which the transaction was simulated).  If the transaction was only for reading data from the registry, then the client application receives the required Read Set, respectively, and this usually completes the transaction without changing the distributed registry.  In the case of a transaction that is supposed to change the data in the registry, the client application additionally checks the execution of the Endorsing policy.  It is possible that the client application does not check the result of the Endorsement Policy, but the Hyperledger Fabric platform in this case provides for checking the policies on the nodes (Comitting Peers) at the stage of adding a transaction to the registry. </p><br><p><img src="https://habrastorage.org/webt/jv/8z/bl/jv8zbla4eudtvw222jqecbndeik.png"><br>  <em>Picture 4. Returning data to the client application</em> </p><br><h4 id="4-otpravka-rw-sets-na-ordering-peers">  4) Sending RW sets to Ordering Peers </h4><br><p>  The client application sends the transaction along with the accompanying data to the Ordering service.  This includes the RW Set, Endorsing peers signatures, as well as the Channel ID. </p><br><p>  Ordering service - based on the name, the main function of this service is to build incoming transactions in the correct order.  As well as the formation of a new block of the distributed registry and guaranteed delivery of the newly formed blocks to all Commiting nodes, thus ensuring the consistency of the data on all nodes containing the distributed registry (Commiting peers).  At the same time, the Ordering service itself does not change the registry.  Ordering Service is a vital component of the system, so it is a cluster of several nodes.  The Ordering Service does not check a transaction for validity, it simply accepts a transaction with a specific channel identifier, builds incoming transactions in a specific order, and forms new blocks of the distributed registry from them.  One Ordering Service can serve several channels simultaneously.  The Ordering Service includes a Kafka cluster, which maintains the correct (unchanged) transaction queue (see clause 7). </p><br><p><img src="https://habrastorage.org/webt/ig/mv/1l/igmv1ll-f-jxt9ifjwraarbpnuk.png"><br>  <em>Picture 5. Sending RW sets to Ordering Peers</em> </p><br><h5 id="5-otpravka-sformirovannyh-blokov-na-committing-peer">  5) Sending formed blocks to Committing Peer </h5><br><p>  The blocks formed in the Ordering Service are transmitted (broadcast) to all nodes on the network.  Each node, having received a new block, checks it for compliance with the Endorsing Policy, checks that all Endorsing Peers received the same result (Write Set) as a result of the smart contract simulation, and also checks whether the original values ‚Äã‚Äãhave changed (i.e., Read Set - data read by a smart contract from WorldState) since the transaction was initiated.  If all conditions are met - the transaction is marked valid, otherwise, the transaction receives the status is not valid. </p><br><p><img src="https://habrastorage.org/webt/83/g0/ih/83g0ih05dpwo1jimfqjbqhqwcg0.png"><br>  <em>Picture 6. Sending formed blocks to Committing Peer</em> </p><br><h4 id="6-dobavleniya-bloka-v-reestr">  6) Adding a block to the registry </h4><br><p>  Each node adds a transaction to its local copy of the distributed registry, while, if the transaction is valid, then the Write Set is applied to the WorldState (current state), respectively, new values ‚Äã‚Äãof the objects affected by the transaction are recorded.  If the transaction received a token - not valid (for example, two transactions occurred with the same objects within one block, then one of the transactions will not be valid, since the original values ‚Äã‚Äãhave already been changed by another transaction).  This transaction is also added to the distributed registry with a non-valid token, but the Write Set of this transaction does not apply to the current state of the WorldState and, accordingly, does not change the objects involved in the transaction.  After that, a notification is sent to the user application that a transaction has been added to the distributed registry for all eternity, as well as the status of the transaction, that is, whether it is valid or not ... </p><br><p><img src="https://habrastorage.org/webt/u0/n1/xi/u0n1xixwimb5yfgmvuoezwtkjhy.png"><br>  <em>Picture 7. Adding a block to the registry</em> </p><br><h3 id="ordering-service">  ORDERING SERVICE </h3><br><p>  Ordering Service consists of a Kafka cluster with corresponding ZooKeeper nodes and Ordering Service Nodes (OSN), which are between the clients of the Ordering service and the Kafka Cluster.  The Kafka cluster is a distributed, fault-tolerant flow (messaging) platform.  Each channel (topic) in Kafka is an unchangeable sequence of records that only supports adding a new record (deleting an existing one is impossible).  An illustration of the structure of the topic is shown below.  It is this property of Kafka that is used to build the blockchain platform. </p><br><p><img src="https://habrastorage.org/webt/by/_h/hu/by_hhufpjkkd3isye8ng5if3mj8.png"><br>  taken from kafka.apache.org </p><br><ul><li>  Picture 8. Ordering Service Topic Structure * </li></ul><br><h4 id="polezny-ssylki">  Useful links </h4><br><p>  <a href="https://www.youtube.com/watch%3Fv%3DEKa5Gh9whgU">Youtube - Building a blockchain for business with the Hyperledger Project</a> <br>  <a href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/">Hyperledger Fabric Docs</a> <br>  <a href="https://dl.acm.org/citation.cfm%3Fid%3D3190538">Hyperledger fabric: blockchains</a> </p><br><h4 id="blagodarnosti">  Thanks </h4><br><p>  I express my deep gratitude for the help in the preparation of the article to my colleagues: <br>  Nikolay Marina <br>  Igor Hapov <br>  Dmitry Gorbachev <br>  Alexandra Zemtsova <br>  Ekaterina Guseva </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/444874/">https://habr.com/ru/post/444874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444858/index.html">In search of the best means</a></li>
<li><a href="../444860/index.html">OFFZONE 2.0</a></li>
<li><a href="../444864/index.html">Usb typewriter</a></li>
<li><a href="../444866/index.html">My path from Python to Go - sharing tips and resources</a></li>
<li><a href="../444870/index.html">Corporate Business Structure 2019</a></li>
<li><a href="../444878/index.html">SpaceX announced a change in the design of Starlink satellites so that they completely burned in the atmosphere when they fell</a></li>
<li><a href="../444880/index.html">Multi-world interpretation of quantum mechanics</a></li>
<li><a href="../444882/index.html">Banks began to block the accounts of freelancers</a></li>
<li><a href="../444884/index.html">C√©dric Champeau left Groovy</a></li>
<li><a href="../444886/index.html">Reverse engineering applications after obfuscation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>