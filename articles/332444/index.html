<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Doctor Web: MEDoc contains a backdoor giving attackers access to a computer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Analysts from Doctor Web investigated the MEDoc update module and found its involvement in the spread of at least one more malicious program. We remin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Doctor Web: MEDoc contains a backdoor giving attackers access to a computer</h1><div class="post__text post__text-html js-mediator-article">  Analysts from Doctor Web investigated the MEDoc update module and found its involvement in the spread of at least one more malicious program.  We remind you that, according to independent researchers, the source of the recent epidemic of the cipher worm Trojan.Encoder.12544, also known as NePetya, Petya.A, ExPetya and WannaCry-2, was the update module of the popular in Ukraine program for tax reporting Medoc. <br><br>  Reports claim that the initial spread of the Trojan.Encoder.12544 worm was carried out through the popular MEDoc application developed by the Ukrainian company Intellect Service.  In one of the modules of the MEDoc update system called ZvitPublishedObjects.Server.MeCom, Dr. Web analytics virus analysts found an entry corresponding to the characteristic Windows registry key: HKCU \ SOFTWARE \ WC. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3e7/b6a/246/3e7b6a246f787fb84b443507c6c85419.png"></div><br>  The Doctor Web specialists noticed this registry key due to the fact that the Trojan cryptographer Trojan.Encoder.12703 uses the same path in its work.  Analysis of the Dr.Web anti-virus log received from the computer of one of our clients showed that the encoder Trojan.Encoder.12703 was launched on an infected machine by ProgramData \ Medoc \ Medoc \ ezvit.exe, which is a component of the MEDoc program: <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21d/d61/253/21dd612538b46bd2d108fef888c997e1.png"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>id: 425036, timestamp: 15:41:42.606, type: PsCreate (16), flags: 1 (wait: 1), cid: 1184/5796:\Device\HarddiskVolume3\ProgramData\Medoc\Medoc\ezvit.exe <br> <br> source context: start addr: 0x7fef06cbeb4, image: 0x7fef05e0000:\Device\HarddiskVolume3\Windows\Microsoft.NET\Framework64\v2.0.50727\mscorwks.dll <br> <br> created process: \Device\HarddiskVolume3\ProgramData\Medoc\Medoc\ezvit.exe:1184 --&gt; \Device\HarddiskVolume3\Windows\System32\cmd.exe:6328 <br> <br> bitness: 64, ilevel: high, sesion id: 1, type: 0, reason: 1, new: 1, dbg: 0, wsl: 0 <br> <br> curdir: C:\Users\user\Desktop\, cmd: "cmd.exe" /c %temp%\wc.exe -ed BgIAAACkAABSU0ExAAgAAAEAAQCr+LiQCtQgJttD2PcKVqWiavOlEAwD/cOOzvRhZi8mvPJFSgIcsEwH8Tm4UlpOeS18o EJeJ18jAcSujh5hH1YJwAcIBnGg7tVkw9P2CfiiEj68mS1XKpy0v0lgIkPDw7eah2xX2LMLk87P75rE6 UGTrbd7TFQRKcNkC2ltgpnOmKIRMmQjdB0whF2g9o+Tfg/3Y2IICNYDnJl7U4IdVwTMpDFVE+q1l+Ad9 2ldDiHvBoiz1an9FQJMRSVfaVOXJvImGddTMZUkMo535xFGEgkjSDKZGH44phsDClwbOuA/gVJVktXvD X0ZmyXvpdH2fliUn23hQ44tKSOgFAnqNAra <br> <br> status: signed_microsoft, script_vm, spc / signed_microsoft / clean <br> <br> id: 425036 ==&gt; allowed [2], time: 0.285438 ms <br> <br> 2017-Jun-27 15:41:42.626500 [7608] [INF] [4480] [arkdll] <br> <br> id: 425037, timestamp: 15:41:42.626, type: PsCreate (16), flags: 1 (wait: 1), cid: 692/2996:\Device\HarddiskVolume3\Windows\System32\csrss.exe <br> <br> source context: start addr: 0x7fefcfc4c7c, image: 0x7fefcfc0000:\Device\HarddiskVolume3\Windows\System32\csrsrv.dll <br> <br> created process: \Device\HarddiskVolume3\Windows\System32\csrss.exe:692 --&gt; \Device\HarddiskVolume3\Windows\System32\conhost.exe:7144 <br> <br> bitness: 64, ilevel: high, sesion id: 1, type: 0, reason: 0, new: 0, dbg: 0, wsl: 0 <br> <br> curdir: C:\windows\system32\, cmd: \??\C:\windows\system32\conhost.exe "1955116396976855329-15661177171169773728-1552245407-149017856018122784351593218185" <br> <br> status: signed_microsoft, spc / signed_microsoft / clean <br> <br> id: 425037 ==&gt; allowed [2], time: 0.270931 ms <br> <br> 2017-Jun-27 15:41:43.854500 [7608] [INF] [4480] [arkdll] <br> <br> id: 425045, timestamp: 15:41:43.782, type: PsCreate (16), flags: 1 (wait: 1), cid: 1340/1612:\Device\HarddiskVolume3\Windows\System32\cmd.exe <br> <br> source context: start addr: 0x4a1f90b4, image: 0x4a1f0000:\Device\HarddiskVolume3\Windows\System32\cmd.exe <br> <br> created process: \Device\HarddiskVolume3\Windows\System32\cmd.exe:1340 --&gt; \Device\HarddiskVolume3\Users\user\AppData\Local\Temp\wc.exe:3648 <br> <br> bitness: 64, ilevel: high, sesion id: 1, type: 0, reason: 1, new: 1, dbg: 0, wsl: 0 <br> <br> curdir: C:\Users\user\Desktop\, cmd: C:\Users\user\AppData\Local\Temp\wc.exe -ed BgIAAACkAABSU0ExAAgAAAEAAQCr+LiQCtQgJttD2PcKVqWiavOlEAwD/cOOzvRhZi8mvPJFSgIcsEwH8Tm4UlpOeS18oE JeJ18jAcSujh5hH1YJwAcIBnGg7tVkw9P2CfiiEj68mS1XKpy0v0lgIkPDw7eah2xX2LMLk87P75rE6U GTrbd7TFQRKcNkC2ltgpnOmKIRMmQjdB0whF2g9o+Tfg/3Y2IICNYDnJl7U4IdVwTMpDFVE+q1l+Ad92 ldDiHvBoiz1an9FQJMRSVfaVOXJvImGddTMZUkMo535xFGEgkjSDKZGH44phsDClwbOuA/gVJVktXvDX 0ZmyXvpdH2fliUn23hQ44tKSOgFAnqNAra <br> <br> fileinfo: size: 3880448, easize: 0, attr: 0x2020, buildtime: 01.01.2016 02:25:26.000, ctime: 27.06.2017 15:41:42.196, atime: 27.06.2017 15:41:42.196, mtime: 27.06.2017 15:41:42.196, descr: wc, ver: 1.0.0.0, company: , oname: wc.exe <br> <br> hash: 7716a209006baa90227046e998b004468af2b1d6 status: unsigned, pe32, new_pe / unsigned / unknown <br> <br> id: 425045 ==&gt; undefined [1], time: 54.639770 ms</code> <br> <br>  The ZvitPublishedObjects.dll file requested from the infected machine had the same hash as the sample examined in the Doctor Web virus lab.  Thus, our analysts have come to the conclusion that the MEDoc update module, implemented as a ZvitPublishedObjects.dll dynamic library, contains a backdoor.  Further research has shown that this backdoor can perform the following functions in an infected system: <br><br><ul><li>  collection of data for access to mail servers; </li><li>  execute arbitrary commands in the infected system; </li><li>  upload arbitrary files to the infected computer; </li><li>  download, save and run any executable files; </li><li>  upload arbitrary files to a remote server. </li></ul><br>  The following code snippet of the MEDoc update module looks very interesting - it allows you to start the payload using the rundll32.exe utility with the parameter # 1: <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/603/cc4/e80/603cc4e807e791c4d2038e0844be90dc.png"></a> </div><br>  It was in this way that a cipher Trojan known as NePetya, Petya.A, ExPetya and WannaCry-2 (Trojan.Encoder.12544) was launched on the victim‚Äôs computers. <br><br>  In one of their interviews, which was published on the Reuters agency website, the developers of the MEDoc program stated that the application they created does not contain any malicious functions.  Based on this, and also taking into account the data of static code analysis, the virus analysts of Doctor Web came to the conclusion that some unidentified attackers infected one of the MEDoc components with a malicious program.  This component has been added to Dr.Web virus databases under the name BackDoor.Medoc. <br><br>  ‚Üí <a href="https://vms.drweb.ru/virus/%3Fi%3D15454815%26lng%3Dru">More about Trojan</a> <br><br>  PS In Ukraine, the servers were <a href="http://www.rbc.ru/technology_and_media/04/07/2017/595bb1bc9a7947bc8356a6a3">seized</a> from the company that spread the Petya virus. </div><p>Source: <a href="https://habr.com/ru/post/332444/">https://habr.com/ru/post/332444/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332432/index.html">Kubernetes Network Performance Comparison</a></li>
<li><a href="../332434/index.html">Systems Management Analysis</a></li>
<li><a href="../332436/index.html">Bitfury Group conducted the first successful multi-hop transaction on the Lightning Network</a></li>
<li><a href="../332438/index.html">‚ÄúUltimate‚Äù blockchain digest: useful materials on Habr√© and other sources on the topic</a></li>
<li><a href="../332442/index.html">ML Grid - Apache Ignite machine learning library</a></li>
<li><a href="../332448/index.html">Delivery of billions of messages strictly once</a></li>
<li><a href="../332450/index.html">Moby / Docker in production. Failure history</a></li>
<li><a href="../332456/index.html">Running AMP applications on Cyclone V SoC</a></li>
<li><a href="../332458/index.html">Broadcast HPE Digitize: talk about our new products and solutions</a></li>
<li><a href="../332460/index.html">Why do I need your permanent collections? They are slow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>