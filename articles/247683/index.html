<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Functions for solving quadratic comparisons. Implementation in MATLAB</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 To solve cryptographic problems, it is necessary to be able to solve quadratic comparisons of a given module. The algorithm for solving...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Functions for solving quadratic comparisons. Implementation in MATLAB</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  To solve cryptographic problems, it is necessary to be able to solve quadratic comparisons of a given module.  The algorithm for solving quadratic comparisons is quite simple and does not cause difficulties in solving for small values ‚Äã‚Äãof the modulus and the free term, however, due to the use of sufficiently large numbers in cryptography, solving quadratic comparisons manually is a very laborious and lengthy process.  Of course, to solve quadratic comparisons, you can use the online service.  But since the solution of a cryptographic problem does not end with solving a quadratic comparison, it will be convenient for a person involved in cryptography to have a function that can solve quadratic comparisons and freely interact with other functions used by it.  That is why it was decided to write a function for solving quadratic comparisons of the form <i>x ^ 2 ‚â° a (mod p)</i> , where <i>a</i> and <i>p</i> are mutually prime numbers, in MATLAB. <br><br><img src="https://habrastorage.org/files/6ce/1f2/3a9/6ce1f23a96c346d99685adc62813403d.jpg"><br><a name="habracut"></a><br>  Immediately, I note that the writing of functions for solving quadratic comparisons was educational in nature; some user functions used in the computation duplicate the functions already existing in the MATLAB environment. <br><br>  First, I propose to consider the code of two main functions, one of which is designed to solve quadratic comparisons in a composite module, and the second to solve quadratic comparisons modulo a simple module.  In this case, we will get acquainted, first of all, with the algorithm for solving quadratic comparisons, and secondly, with the functions that are necessary to perform the calculations themselves. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Function to solve complex modulus comparisons </h4><br>  This function allows you to solve quadratic comparisons, both in simple and complex modulus.  When calling a function, it is necessary to transfer two variables <i>a</i> and <i>p</i> , as a result of its execution, the function will return a vector - a string of two solutions of quadratic comparison opposite in sign. <br><br><pre><code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ result ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqcomdif</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span></span></code> </pre> <br>  The next step in solving a quadratic comparison is to determine the type of the module <i>p</i> .  For this, the custom <i>factorization</i> function will be used, designed to decompose a number into prime factors.  In addition to the string vector with prime factors, the function returns the number of prime factors.  In fact, the <i>factorization</i> function duplicates the standard MATLAB <i>factor</i> function. <br><br><pre> <code class="matlab hljs">[ mp, sp ] = factorization( p );</code> </pre><br>  After the module has been factorized using the conditional operator, the number of factors is checked.  If the number of factors exceeds <i>1</i> , that is, the module <i>p</i> is a composite number, then we need to solve a system of <i>sp</i> quadratic comparisons (in each of the comparisons the module will be one of the factors of the composite module <i>p</i> ).  Before tackling the obtained system of quadratic comparisons, it is necessary to make sure that each of the quadratic comparisons of this system has a solution.  To do this, we use the <i>for</i> loop, which will make the transition between the elements of the vector with the factors <i>mp</i> .  In the body of the loop, a function will be called that calculates the value of the Legendre symbol for each pair of numbers. <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:sp SL( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ) = symvol( a, mp( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ) );</code> </pre><br>  If the value of the Legendre symbol is <i>1</i> , then the <i>count</i> variable will be incremented by <i>1</i> .  This is necessary so that after all iterations of the cycle have been completed, we can check whether all the equations of the system have a solution, because it depends on whether we will solve the quadratic comparisons of which the system is composed, or we will display messages that the original quadratic comparison does not making. <br><br><pre> <code class="matlab hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> SL( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ) == <span class="hljs-number"><span class="hljs-number">1</span></span> count = count + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">%      count   1 end</span></span></code> </pre><br>  If the number of equations of the system is equal to the number of equations that have solutions, then row vectors are created to store intermediate results of the calculation. <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> count == sp <span class="hljs-comment"><span class="hljs-comment">%       answer1 = zeros ( 1, sp ); %     modul = zeros ( 1, sp ); %         answer2 = zeros ( 1, sp ); %          . </span></span></code> </pre><br>  Using a <i>for</i> loop, a transition is made between the multipliers of the <i>p</i> module.  The vector vector <i>answer1</i> records the results of solving a quadratic comparison modulo a simple module, which is obtained using the <i>sqcom</i> function, to which the value of the variable a was passed, as well as the value of the <i>i-th</i> factor of the module <i>p</i> .  In the vector-line <i>modul</i> , the quotient of dividing the composite module <i>p</i> by the <i>i-th</i> factor of the module <i>p is</i> written.  The <i>answer2 vector</i> will <i>contain the</i> result of solving a linear inequality <i>(p / p (I)) * y ‚â° 1 (p (i))</i> , which will be necessary to calculate the final answer using the formula obtained from the Chinese theorem. <br><br><pre> <code class="matlab hljs"><span class="hljs-comment"><span class="hljs-comment">%        for i=1:1:sp answer1( 1, i ) = sqcom( a, mp( 1, i ) ) ; modul( 1, i ) = p / mp( 1, i ); answer2( 1, i ) = lincom ( modul( 1, i ), 1, mp( 1, i ) ); end</span></span></code> </pre><br>  After the cycle has completed its execution, it is necessary to calculate the final answer using the formula: <i>x = ((p / p (1)) * b (1) * y (1) + ((p / p (2)) * b (2 ) * y (2) + ((p / p (i)) * b (i) * y (i)</i> . To do this, we use element-wise multiplication. As a result, we obtain a row vector, the sum of the elements of which we will find using the command <i>sum</i> . We will find the remainder of dividing the sum by the composite module <i>p</i> ‚Äî this will be one of the solutions of the quadratic comparison modulo. The second answer will be obtained by writing the first answer with the opposite sign. <br><br><pre> <code class="matlab hljs"> <span class="hljs-comment"><span class="hljs-comment">%    result = zeros ( 1, 2 ); result( 1, 1 ) = mod( sum( ( modul .* answer1 ) .* answer2 ), p ); result( 1, 2 ) = - result( 1, 1 );</span></span></code> </pre><br>  In the event that initially the module <i>p</i> turned out to be a prime number, then the solution of a quadratic comparison will be obtained by a one-time function call for solving a quadratic comparison - <i>sqcom</i> .  The second solution will be obtained by taking the first answer with the opposite sign. <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> result( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ) = sqcom( a, p ); result( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> ) = - result( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  Below is the full sqcomdif function code. <br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ result ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqcomdif</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span><span class="hljs-function"> %          %        , %     .       , %     ,    . </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ mp, sp ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factorization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function"> &gt; 1 %      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> = 0; %         %     </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function">=1:1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, mp( 1, i )</span></span></span><span class="hljs-function"> ); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> == 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> + 1; %      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function">   1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %        </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> == </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function"> %       </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer1</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zeros</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, sp )</span></span></span><span class="hljs-function">; %     </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">modul</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zeros</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, sp )</span></span></span><span class="hljs-function">; %         </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer2</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zeros</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, sp )</span></span></span><span class="hljs-function">; %          .  %        </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function">=1:1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqcom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, mp( 1, i )</span></span></span><span class="hljs-function"> ) ; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">modul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> / </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lincom</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( modul( 1, i )</span></span></span><span class="hljs-function">, 1, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> ); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zeros</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 2 )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 1 )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( sum( ( modul .* answer1 )</span></span></span><span class="hljs-function"> .* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer2</span></span></span><span class="hljs-function"> ), </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> ); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 2 )</span></span></span><span class="hljs-function"> = - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 1 )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-function"> = '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">net</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resheniy</span></span></span><span class="hljs-function">'; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 1 )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqcom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 2 )</span></span></span><span class="hljs-function"> = - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 1 )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br><h4>  Function to solve quadratic comparisons modulo simple </h4><br>  This function was repeatedly called in the <i>sqcomdif</i> function, and as already mentioned, the <i>sqcom</i> function <i>is</i> used to solve quadratic comparisons in a simple module and can be called independently of the <i>sqcomdif</i> function, that is, you can call it and get the right answer without any problems when you are sure that the module is a prime number.  Since only deprivation of quadratic comparisons of the form <i>x ^ 2 ‚â° a (mod p) is considered</i> , it is necessary to transfer the numerical values ‚Äã‚Äãof the variables <i>a</i> and <i>p</i> to the function.  As a result of the function, one solution of the quadratic comparison will be obtained. <br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ answer ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqcom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span></span></code> </pre><br>  Since the sqcom function can be used separately from the <i>sqcomdif</i> function, it is necessary to make sure that the number written in the variable <i>a</i> is a quadratic residue of the module <i>p</i> .  To do this, we use the <i>symvol</i> function, which allows us to calculate the value of the Legendre symbol for a specified pair of numbers. <br><br><pre> <code class="matlab hljs">[ Symvol_Lejandra ] = symvol( a, p );</code> </pre><br>  If the value of the <i>Symvol_Lejandra</i> variable is <i>1</i> , then a is a quadratic residue modulo <i>p</i> and further steps will be taken to find a solution to the quadratic comparison.  We need to write the number <i>(p - 1)</i> in the form <i>2 ^ r * q</i> .  The initial values ‚Äã‚Äãof the variables <i>r</i> , <i>q</i> are given on the basis that <i>(p - 1)</i> is an odd number.  However, if this is not the case, they will change during the execution of the cycle (until <i>q</i> becomes an odd number). <br><br><pre> <code class="matlab hljs">q = p - <span class="hljs-number"><span class="hljs-number">1</span></span>; r = <span class="hljs-number"><span class="hljs-number">0</span></span>; otn = q / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( ( q - <span class="hljs-built_in"><span class="hljs-built_in">floor</span></span>( otn ) * <span class="hljs-number"><span class="hljs-number">2</span></span> ) == <span class="hljs-number"><span class="hljs-number">0</span></span> ) q = otn; r = r + <span class="hljs-number"><span class="hljs-number">1</span></span>; otn = q / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  Now it is necessary to find the value of the variable <i>b</i> , which equals <i>b = a ^ q (mod p)</i> .  Since <i>a</i> and <i>q</i> are usually expressed by sufficiently large numbers, it will not be possible to raise the number <i>a</i> to the power of <i>q in the</i> usual way, since in most cases an overflow will occur.  Therefore, the exponentiation must be performed according to the quadriration method.  In order to accomplish this, it is necessary to call the <i>kvadrirovanie</i> function and transfer to it the value of the base, the exponent, and the module on which the calculations will be performed. <br><br><pre> <code class="matlab hljs">b = kvadrirovanie( a, q, p );</code> </pre><br>  To continue the calculations, you need to find the smallest non-negative number <i>f</i> , which will be a quadratic non-residue modulo <i>p</i> .  For this, the variable <i>f</i> is assigned the value <i>1</i> , and using the <i>symvol</i> function, the value of the Legendre symbol is determined for a pair of numbers <i>f</i> and <i>p</i> .  If the Legendre symbol for <i>1</i> and <i>p</i> is <i>1</i> , then the variable <i>f</i> , using the <i>while loop</i> , increases until a value that is a quadratic non-residue modulo <i>p</i> is reached. <br><br><pre> <code class="matlab hljs">f = <span class="hljs-number"><span class="hljs-number">1</span></span>; sym_lej = symvol( f, p ); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> sym_lej ~= <span class="hljs-number"><span class="hljs-number">-1</span></span> f = f + <span class="hljs-number"><span class="hljs-number">1</span></span>; sym_lej = symvol( f, p ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  Now the value of <i>f</i> , which is a quadratic non-residue modulo <i>p</i> , must be raised to the power of <i>q</i> .  For this, it is also necessary to resort to the <i>kvadrirovanie</i> function, the variable <i>k</i> must be assigned the value <i>0</i> . <br><br><pre> <code class="matlab hljs"> g = kvadrirovanie( f, q, p); k = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br>  After the above actions, you need to check the value of the variable <i>b</i> .  If <i>b is</i> comparable with <i>1</i> modulo <i>p</i> , then it is necessary to proceed to the calculation of the answer, otherwise find the smallest non-negative number <i>m</i> such that <i>b ^ (2 ^ m) 1 (mod p)</i> .  When such a value of <i>m</i> is found, it is necessary to recalculate the values ‚Äã‚Äãof the variables <i>k</i> , <i>g</i> , <i>b</i> , after which the variable <i>r is</i> assigned the value of <i>m</i> .  But this is not all, it is necessary to check that the new value of the variable <i>b</i> is also comparable to <i>1</i> modulo <i>p</i> .  If this is not the case, then it is necessary to return to the selection of the number <i>m</i> .  The variable <i>pok is</i> needed to avoid performing certain mathematical actions twice. <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> b ~= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> b ~= <span class="hljs-number"><span class="hljs-number">1</span></span> m = <span class="hljs-number"><span class="hljs-number">0</span></span>; b1 = kvadrirovanie( b, <span class="hljs-number"><span class="hljs-number">2</span></span>^m, p ); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( b1, p) ~= <span class="hljs-number"><span class="hljs-number">1</span></span> m = m + <span class="hljs-number"><span class="hljs-number">1</span></span>; b1 = kvadrirovanie( b, <span class="hljs-number"><span class="hljs-number">2</span></span>^m, p ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> pok = <span class="hljs-number"><span class="hljs-number">2</span></span>^(rm); g1 = kvadrirovanie( g, pok, p ); b = <span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( ( b*g1), p ); k = <span class="hljs-built_in"><span class="hljs-built_in">fix</span></span>(k + pok); r = m; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  After <i>m has</i> been found that satisfies the above conditions, we can proceed to the direct calculation of the answer.  The answer is calculated by the formula <i>x = a ^ ((q + 1) / 2) * g ^ (k / 2) (mod p)</i> .  To calculate both factors, we use the quadration function; we take the result modulo <i>p</i> . <br><br><pre> <code class="matlab hljs"> first = kvadrirovanie( a, ( ( q + <span class="hljs-number"><span class="hljs-number">1</span></span> ) / <span class="hljs-number"><span class="hljs-number">2</span></span> ), p ); second = kvadrirovanie( g, ( k / <span class="hljs-number"><span class="hljs-number">2</span></span> ), p ); answer = <span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( ( first * second ), p);</code> </pre><br>  The result obtained cannot always be written optimally, modulo <i>p</i> .  Therefore it is necessary to perform the following check: <br><br><pre> <code class="matlab hljs"> delta = p - answer; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> delta &lt; answer answer = delta; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  The following is the full <i>sqcom</i> function <i>code</i> : <br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ answer ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqcom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span><span class="hljs-function"> %         %  %      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">^2 = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mod p )</span></span></span><span class="hljs-function"> ,  %  .        %  . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a,p)</span></span></span><span class="hljs-function">; %  1        </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ Symvol_Lejandra ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Symvol_Lejandra</span></span></span><span class="hljs-function"> == 1 %  2  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function">,  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> - 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function"> = 0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">otn</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function"> / 2; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">while</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ( q - floor( otn )</span></span></span><span class="hljs-function"> * 2 ) == 0 ) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">otn</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function"> + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">otn</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function"> / 2; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, q, p )</span></span></span><span class="hljs-function">; %  3  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function"> = 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sym_lej</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( f, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">while</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sym_lej</span></span></span><span class="hljs-function"> ~= -1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function"> + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sym_lej</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( f, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">g</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( f, q, p)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = 0; %  4  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> ~= 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">while</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> ~= 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-function"> = 0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b1</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( b, 2^m, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">while</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( b1, p)</span></span></span><span class="hljs-function"> ~= 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-function"> + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b1</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( b, 2^m, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pok</span></span></span><span class="hljs-function"> = 2^</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rm)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">g1</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( g, pok, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ( b*g1)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> ); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(k + pok)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">r</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %  5    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">first</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, ( ( q + 1 )</span></span></span><span class="hljs-function"> / 2 ), </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> ); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( g, ( k / 2 )</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> ); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ( first * second )</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delta</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delta</span></span></span><span class="hljs-function"> &lt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delta</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">answer</span></span></span><span class="hljs-function"> = '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">net</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resheniya</span></span></span><span class="hljs-function">'; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  And now I propose to become familiar with the auxiliary functions that are used both in solving quadratic comparisons, and so can be used separately. <br><br><img src="https://habrastorage.org/files/b69/f7b/e88/b69f7be880f646389b6e36363761788e.jpg"><br><br><h4>  Factor expansion </h4><br>  When solving a quadratic comparison, in many cases it is necessary to resort to factorization of the number, and this operation will also have to be resorted to when it is necessary to check: is the number simple or composite. <br>  The <i>factorization</i> function is passed a number that needs to be factorized.  As a result, the function returns a vector - a string with multipliers and the number of these multipliers. <br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ mnojitel, ind ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factorization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( delimoe )</span></span></span></span></code> </pre><br>  A function consists of a <i>switch statement</i> that performs various actions depending on the value of the input variable <i>delimoe</i> .  So if <i>delimoe = 1</i> , then <i>mnojitel is</i> written <i>1</i> to the vector storing the result of the factorization, and the variable <i>ind</i> , which stores the number of factors, is also written <i>1</i> .  Similar actions are performed in the event that <i>delimoe</i> is <i>-1</i> . <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> delimoe <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> { <span class="hljs-number"><span class="hljs-number">1</span></span> } mnojitel( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> )=<span class="hljs-number"><span class="hljs-number">1</span></span>; ind=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> { <span class="hljs-number"><span class="hljs-number">-1</span></span> } mnojitel( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> )= <span class="hljs-number"><span class="hljs-number">-1</span></span>; ind = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br>  If these conditions are not met, then we check the sign of the number factorized.  If <i>delimoe is</i> less than <i>0</i> , then <i>-1 is</i> written to the first factor, <i>2 is</i> written to <i>ind</i> , and the function will continue to work with the module of the <i>delimoe</i> variable <i>.</i> If the number is greater than <i>0</i> , then the value of <i>ind is</i> assigned to <i>1</i> . <br><br><pre> <code class="matlab hljs"> <span class="hljs-keyword"><span class="hljs-keyword">otherwise</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> delimoe &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> mnojitel( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> )= <span class="hljs-number"><span class="hljs-number">-1</span></span>; ind = <span class="hljs-number"><span class="hljs-number">2</span></span>; delimoe = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span> ( delimoe ); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> ind = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  The <i>while loop</i> runs as long as <i>delimoe is</i> not equal to <i>delitel</i> , with the initial <i>delitel</i> variable <i>being</i> assigned the value <i>2</i> .  At each iteration of the loop, the remainder of <i>delimoe divided</i> by <i>delitel is</i> <i>written</i> into the <i>ostatok variable</i> .  If the remainder is <i>0</i> , that is, the <i>delitel</i> is a <i>delimoe</i> multiplier, then this value is written to the vector in which the multipliers are stored, and the counter of this vector is increased by <i>1</i> .  In this case, the <i>delimoe</i> variable <i>is</i> assigned the quotient of the division performed.  If the remainder of the division is not equal to <i>0</i> , then the <i>delitel is</i> increased by <i>1</i> .  When the exit from the loop occurs, the value remaining in the <i>delimoe</i> variable is written to the vector with factors as one of the factors. <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( delimoe ~= delitel ) ostatok = <span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( delimoe, delitel ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ostatok ~= <span class="hljs-number"><span class="hljs-number">0</span></span> delitel = delitel + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> delimoe = delimoe / delitel; mnojitel( <span class="hljs-number"><span class="hljs-number">1</span></span>, ind ) = delitel; ind = ind + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> mnojitel( <span class="hljs-number"><span class="hljs-number">1</span></span>, ind ) = delimoe;</code> </pre><br>  Below is the full code of the <i>factorization</i> function. <br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ mnojitel, ind ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factorization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( delimoe )</span></span></span><span class="hljs-function"> %       %   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delitel</span></span></span><span class="hljs-function"> = 2; %    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">switch</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delimoe</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">case</span></span></span><span class="hljs-function"> { 1 } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnojitel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 1 )</span></span></span><span class="hljs-function">=1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function">=1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">case</span></span></span><span class="hljs-function"> { -1 } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnojitel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 1 )</span></span></span><span class="hljs-function">= -1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function"> = 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">otherwise</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delimoe</span></span></span><span class="hljs-function"> &lt; 0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnojitel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 1 )</span></span></span><span class="hljs-function">= -1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function"> = 2; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delimoe</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">abs</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( delimoe )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function"> = 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">while</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( delimoe ~= delitel )</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ostatok</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( delimoe, delitel )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ostatok</span></span></span><span class="hljs-function"> ~= 0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delitel</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delitel</span></span></span><span class="hljs-function"> + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delimoe</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delimoe</span></span></span><span class="hljs-function"> / </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delitel</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnojitel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, ind )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delitel</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function"> + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnojitel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, ind )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delimoe</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br><h4>  Calculating the value of the Legendre symbol </h4><br><br>  In order to check whether a number is a quadratic residue by a given module (in this case, a quadratic comparison has a solution) or a quadratic non-residue (then such a quadratic comparison has no solution), the Legendre symbol is used, which is denoted in the Russian literature as <i>L (a; p)</i> , in foreign literature as <i>L (a / p)</i> . <br>  The Legendre symbol can take the following values: <br>  <i>L (a; p) = 1</i> , in this case a belongs to QR, the quadratic comparison has the solution <br>  <i>L (a; p) = -1</i> , in which case a belongs to QNR, the quadratic comparison has no solution <br>  If <i>L (a; p) = 0</i> , then a and p are not mutually simple numbers, that is, the <i>gcd (a; p) is</i> not equal to <i>1</i> <br>  The following properties are used to calculate the value of the Legendre symbol: <br><br><ol><li>  <i>L (1; p) = 1</i> </li><li>  <i>L (-1; p) = (-1) ^ ((p - 1) / 2)</i> </li><li>  <i>L (2; p) = (-1) ^ ((p ^ 2 - 1) / 8)</i> </li><li>  If <i>‚â° b *  (mod p)</i> , then <i>L (b * ; p) = L (b; p) * L (; p)</i> </li><li>  If <i>‚â° b (mod p)</i> , then <i>L (a; p) = L (b; p)</i> </li><li>  If <i>a</i> and <i>p</i> are prime numbers, then <i>L (a; p) = (-1) ^ (((p - 1) * (a-1)) / 4) * L (p; a)</i> .  The latter property is called the Gauss law of reciprocity. </li></ol><br><br>  The calculation of the Legendre symbol is performed on the basis of the above properties.  As soon as one of the conditions is fulfilled, we begin to check the properties for the resulting pair <i>a</i> and <i>p</i> , until the final value of the Legendre symbol is found. <br>  Now consider how you can implement the calculation of the value of the Legendre symbol programmatically. <br>  The function will return the value of the Legendre symbol for a pair of numbers <i>a</i> and <i>p</i> that were passed to it.  This is evident from the function header: <br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ sl ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span></span></code> </pre><br>  The next step is essentially the use of property <i>5</i> .  If the number <i>a is</i> greater than the modulus <i>p</i> , then it can be replaced by a smaller number comparable to a modulo <i>p</i> . <br><br><pre> <code class="matlab hljs">a=<span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( a, p ); <span class="hljs-comment"><span class="hljs-comment">%     </span></span></code> </pre><br>  The resulting number is, trying to factor out.  For factoring a factor, a custom function <i>factorization</i> was written that returns a vector with prime factors that make up the number <i>a</i> , as well as their number.  This feature has been described in detail above. <br><br><pre> <code class="matlab hljs">[ mnoj, ind ] = factorization( a ); <span class="hljs-comment"><span class="hljs-comment">%     </span></span></code> </pre><br>  If <i>a was</i> not a prime number, then we will act by property <i>4</i> .  That is, the value of the Legendre symbol for a pair of numbers <i>L (a; p)</i> , we find as the product of the values ‚Äã‚Äãof the Legendre symbols for numbers that are prime factors of <i>a</i> .  To store intermediate results, create a row vector filled with zeros with a dimension equal to the number of factors of <i>a</i> .  If <i>a</i> is simple, then this string will consist of one element. <br><br><pre> <code class="matlab hljs">sl = <span class="hljs-built_in"><span class="hljs-built_in">zeros</span></span>( <span class="hljs-number"><span class="hljs-number">1</span></span>, ind ); <span class="hljs-comment"><span class="hljs-comment">%          </span></span></code> </pre><br>  To calculate the Legendre symbol for each multiplier, alternately use the <i>for</i> loop, which will change its values ‚Äã‚Äãfrom <i>1</i> to the number of the last multiplier.  In the body of this cycle, the immediate process of calculating the value of the Legendre symbol takes place using the properties listed above. <br>  The code for checking property 1 is as follows: <br><br><pre> <code class="matlab hljs"> <span class="hljs-comment"><span class="hljs-comment">%   L(1,p) if mnoj( 1, i ) == 1 sl( 1, i ) = 1; end</span></span></code> </pre><br>  Since when checking the value of a symbol when it is <i>L (-1, p)</i> , by property <i>2</i> , it is necessary to calculate the value <i>(-1) ^ ((p - 1) / 2)</i> , it is necessary to use another conditional operator, in which be checked if the indicator <i>-1 is</i> an even or odd number.  Depending on this, the value of the Legendre symbol will vary.  If the index is even, then the Legendre symbol will be equal to <i>1</i> , otherwise <i>-1</i> .  The use of this conditional operator avoids the erection of <i>-1</i> to the power of <i>(p - 1) / 2</i> , which is a very costly operation. <br><br><pre> <code class="matlab hljs"> <span class="hljs-comment"><span class="hljs-comment">%   L(-1,p) if mnoj( 1, i ) == -1 if mod( ( ( p - 1 ) ) / 2, 2 ) == 0 sl( 1, i ) = 1; else sl( 1, i ) = -1; end end</span></span></code> </pre><br>  Similar actions are carried out in the case when it is necessary to calculate the value of the Legendre symbol in its form <i>L (2; p)</i> .  In this case, it will be <i>(-1) ^ ((p ^ 2 - 1) / 8)</i> . <br><br><pre> <code class="matlab hljs"> <span class="hljs-comment"><span class="hljs-comment">%   L(2,p) if mnoj( 1, i ) == 2 %         1,  -1 if mod( ( ( p^2 - 1 ) / 8 ), 2 ) == 0 sl(1,i)=1; else sl(1,i)=-1; end end</span></span></code> </pre><br>  After checking this condition, the number <i>a</i> is passed to the function in order to check whether it is simple or not.  If the number <i>a</i> is a compound (the number of its factors <i>ind1 is</i> greater than <i>1</i> ), then recursion occurs and the number <i>a</i> is transferred to the same function to perform further calculations. <br><br><pre> <code class="matlab hljs"> [ mn, ind1 ] = factorization( mnoj( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ) ); <span class="hljs-comment"><span class="hljs-comment">%      if ind1 &gt; 1 %    -  sl( 1, i ) = symvol( mnoj(1,i), p ); %       ,   </span></span></code> </pre><br>  Otherwise, the number <i>a</i> is prime.  If at the same time it is not equal to <i>-1</i> , <i>1</i> , <i>2</i> , then one has to use property <i>6</i> , the Gauss reciprocity law.  The sign in front of the Legendre symbol is determined by determining the parity of the factors of its index.  He turns in plus if at least one of the factors is even.  After that, a recursive call to the <i>symvol</i> function <i>occurs</i> , and the arguments are passed to it in a different order. <br><br><pre> <code class="matlab hljs"> <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> and( mnoj(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>)~=<span class="hljs-number"><span class="hljs-number">-1</span></span>, and( mnoj( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ) ~= <span class="hljs-number"><span class="hljs-number">1</span></span>, mnoj( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ) ~= <span class="hljs-number"><span class="hljs-number">2</span></span> ) )<span class="hljs-comment"><span class="hljs-comment">%    - ,   1, -1, 2 if or( mod( ( ( p - 1 ) / 2 ), 2 ) == 0, mod( ( ( mnoj( 1, i ) - 1 ) / 2 ), 2 ) == 0 ) %        -  sl(1,i)= symvol( p, mnoj( 1, i ) ); % L(p,a) else sl(1,i)=-symvol( p, mnoj( 1, i ) ); % -L(p,a) end end</span></span></code> </pre><br>  As a result of the verification of the above conditions, all possible variants of the number a were covered. <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If initially the number </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was composite, then the variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sl is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> written the product of all elements of the string - the vector </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , after which the resulting value is returned to the program that caused this function.</font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ind ~= <span class="hljs-number"><span class="hljs-number">1</span></span> sl = prod( sl ); <span class="hljs-comment"><span class="hljs-comment">%   L(a,p) end</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The complete code for the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">symvol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ sl ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span><span class="hljs-function"> %      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">L</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a,p)</span></span></span><span class="hljs-function"> %     ,    % ,         </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, p )</span></span></span><span class="hljs-function">; %      </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ mnoj, ind ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factorization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a )</span></span></span><span class="hljs-function">; %      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zeros</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, ind )</span></span></span><span class="hljs-function">; %           %      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function"> %   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">L</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,p)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnoj</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> == 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">L</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(-1,p)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnoj</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> == -1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ( ( p - 1 )</span></span></span><span class="hljs-function"> ) / 2, 2 ) == 0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = -1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">L</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2,p)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnoj</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> == 2 %         1,  -1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ( ( p^2 - 1 )</span></span></span><span class="hljs-function"> / 8 ), 2 ) == 0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,i)</span></span></span><span class="hljs-function">=1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,i)</span></span></span><span class="hljs-function">=-1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ mn, ind1 ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">factorization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mnoj( 1, i )</span></span></span><span class="hljs-function"> ); %     , %       </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind1</span></span></span><span class="hljs-function"> &gt; 1 %    -  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mnoj(1,i)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> ); %       ,    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">elseif</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">and</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mnoj(1,i)</span></span></span><span class="hljs-function">~=-1, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">and</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mnoj( 1, i )</span></span></span><span class="hljs-function"> ~= 1, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mnoj</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, i )</span></span></span><span class="hljs-function"> ~= 2 ) )%    - ,   1    2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">or</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mod( ( ( p - 1 )</span></span></span><span class="hljs-function"> / 2 ), 2 ) == 0, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ( ( mnoj( 1, i )</span></span></span><span class="hljs-function"> - 1 ) / 2 ), 2 ) == 0 ) %        -  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,i)</span></span></span><span class="hljs-function">= </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( p, mnoj( 1, i )</span></span></span><span class="hljs-function"> ); % </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">L</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p,a)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,i)</span></span></span><span class="hljs-function">=-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">symvol</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( p, mnoj( 1, i )</span></span></span><span class="hljs-function"> ); % -</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">L</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p,a)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ind</span></span></span><span class="hljs-function"> ~= 1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sl</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( sl )</span></span></span><span class="hljs-function">; %   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">L</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a,p)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Raising a number to a power by quadrature method </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When solving a quadratic comparison, one often comes across the need to build large numbers to a power with an exponent equal to several hundred, or even thousands. </font><font style="vertical-align: inherit;">With the usual raising of a number to such a degree, it is rather easy to come across such an unpleasant phenomenon as overflow. </font><font style="vertical-align: inherit;">In order to avoid it, it is necessary to raise such numbers to a power using the quadration method. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consider the algorithm of this method:</font></font><br><br><ol><li>       . </li><li>        ,   <i>1</i>   <i>m=a</i> . </li><li>     : <br><ul><li>      <i>m</i>        <i></i> ,      <i></i>      <i></i> ,      <i>m</i> . </li><li>   ,    <i>m</i>  ,     <i></i> ,      <i>m</i> . </li></ul></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Go to the next bit on the right and repeat the steps described in paragraph 3, until the calculations for the last bit are performed. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And now let's look at how the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kvadrirovanie</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><i><font style="vertical-align: inherit;">works</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The values ‚Äã‚Äãof the base, indicator and module are transferred to the function, and the function returns a single number - the final result.</font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ result ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, q, p )</span></span></span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We </font><font style="vertical-align: inherit;">translate the </font><font style="vertical-align: inherit;">exponent </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">q</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> into a binary view, and since the result will consist of individual characters, we use the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">size</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command </font><font style="vertical-align: inherit;">to determine the number of bits needed to record the exponent.</font></font><br><br><pre> <code class="matlab hljs">q = dec2bin( q ); size_q = <span class="hljs-built_in"><span class="hljs-built_in">size</span></span>(q);</code> </pre><br>          ,     :    <i>m</i>  <i>uint64</i>  <i></i> .      <i>for</i> ,      <i>i</i>  <i>2</i>   <i>1</i>   ,      <i>q</i> ,  ,      . <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> size_q( <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> ) &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span> m = uint64(a); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>=<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:size_q(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre><br>      , ,     <i>i-</i> ,   ,      <i>m</i> .   ,    <i>1</i> ,    <i>m^2</i>     <i></i> ,       <i></i> ,      <i></i> . <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> q(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>)==<span class="hljs-string"><span class="hljs-string">'1'</span></span> m = uint64( <span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( ( <span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( ( m^<span class="hljs-number"><span class="hljs-number">2</span></span> ), p ) * a ), p ));</code> </pre><br> , <i>q(1,i)=='0'</i> ,   <i>m^2</i>      <i></i> . <br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> m = uint64(<span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( ( m^<span class="hljs-number"><span class="hljs-number">2</span></span> ), p )); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>     ,    <i>m</i>    <i>result</i> . <br><br><pre> <code class="matlab hljs">result =uint64(m);</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the exponent in binary form is equal to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then the </font><font style="vertical-align: inherit;">initial number itself is written </font><font style="vertical-align: inherit;">into the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">result</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><font style="vertical-align: inherit;">, which was required to be raised to a power.</font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> q(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) == <span class="hljs-string"><span class="hljs-string">'1'</span></span> result = uint64( a );</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If this condition is not fulfilled, then the exponent is </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In this case, the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">result</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><font style="vertical-align: inherit;">will be written </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> result = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Full function code for exponentiation by the quadration method: </font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ result ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kvadrirovanie</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a, q, p )</span></span></span><span class="hljs-function"> %          %     ,    1   %        ,     %  .     . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dec2bin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( q )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size_q</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(q)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size_q</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( 1, 2 )</span></span></span><span class="hljs-function"> &gt;= 2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uint64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function">=2:1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size_q</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,2)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,i)</span></span></span><span class="hljs-function">=='1' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uint64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mod( ( mod( ( m^2 )</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> ) * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> ), </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> )); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uint64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mod( ( m^2 )</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function"> )); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-function"> =</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uint64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">elseif</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,1)</span></span></span><span class="hljs-function"> == '1' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uint64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( a)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">result</span></span></span><span class="hljs-function"> = 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linear comparison solution </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When solving quadratic comparisons in complex moduli, the formula obtained from the Chinese theorem will be applied. </font><font style="vertical-align: inherit;">In order to calculate the answer using this formula, it becomes necessary to solve the linear comparison </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k * x ‚â° b (mod p)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This function is intended to solve them with the help of an inverse element, that is, such a number </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> which, when multiplied by </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , will give a result comparable with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> given a modulus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lincom</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><i><font style="vertical-align: inherit;">passes the</font></i><font style="vertical-align: inherit;"> coefficient values ‚Äã‚Äãfor an unknown </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the number </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with which the left side is comparable, and also the module </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the function returns respectively a linear comparison solution with the specified parameters. </font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ x ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lincom</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( k, b, p)</span></span></span></span></code> </pre><br>   ,       .             . ,          ,       .          <i>( a, b )</i> ,          ‚Äì <i>b</i> ,         <i>k</i> . <br>        <i>b0</i>  <i>b1</i> ,       .   <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which was written to the variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , is divided completely into the coefficient </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then the inverse element will be equal to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Otherwise, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be calculated using a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while loop</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The cycle will recalculate the values ‚Äã‚Äãof the variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . After a new value of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b0 is found</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">swap</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> function </font><font style="vertical-align: inherit;">will exchange the values ‚Äã‚Äãbetween the variables </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Also, with each iteration of the cycle, new values ‚Äã‚Äãwill be assigned to a number of other variables.</font></font><br><br><pre> <code class="matlab hljs">b0=<span class="hljs-number"><span class="hljs-number">0</span></span>; b1=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">%  ostatok = mod( pr, k ); while ostatok ~= 0 chastnoe = floor( pr / k ); b0 = b0 - b1 * chastnoe; [ b0, b1 ] = swap( b0, b1 ); pr = k; k = ostatok; ostatok = mod( pr, k ); end</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After the cycle ends, it will be necessary to calculate the value of the linear comparison solution. </font><font style="vertical-align: inherit;">It will be equal to the product of the variables </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , taken modulo </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (for this operation at the beginning of the function the modulus value was duplicated using the variable </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br><pre> <code class="matlab hljs">x = <span class="hljs-built_in"><span class="hljs-built_in">mod</span></span>( b1*b, p );</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The following is the entire function code: </font></font><br><br><pre> <code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ x ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lincom</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( k, b, p)</span></span></span><span class="hljs-function"> %        </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mod p )</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pr</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b0</span></span></span><span class="hljs-function">=0; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b1</span></span></span><span class="hljs-function">=1; %  </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ostatok</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( pr, k )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">while</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ostatok</span></span></span><span class="hljs-function">~=0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chastnoe</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">floor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( pr / k )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b0</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b0</span></span></span><span class="hljs-function"> - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b1</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chastnoe</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[ b0, b1 ]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">swap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( b0, b1 )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pr</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ostatok</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ostatok</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( pr, k )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( b1*b, p )</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The list of sources that helped in creating features and writing an article: </font></font></h4><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summaries and lectures Plotnikova L.I. </font><font style="vertical-align: inherit;">(who in the subject will understand)</font></font></li><li> <a href="http://math.hashcode.ru/questions/52339/%25D1%2582%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B8%25D1%258F-%25D1%2587%25D0%25B8%25D1%2581%25D0%25B5%25D0%25BB-%25D0%25BA%25D0%25B2%25D0%25B0%25D0%25B4%25D1%2580%25D0%25B0%25D1%2582%25D0%25B8%25D1%2587%25D0%25BD%25D1%258B%25D0%25B5-%25D1%2581%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F-%25D0%25BF%25D0%25BE-%25D0%25BF%25D1%2580%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D0%25BC%25D1%2583-%25D0%25BC%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258E"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://math.hashcode.ru</font></font></a> </li><li> <a href="http://mathhelpplanet.com/static.php%3Fp%3Donlain-naiti-nod-i-nok"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://mathhelpplanet.com</font></font></a> </li><li> <a href="http://www.wolframalpha.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://www.wolframalpha.com</font></font></a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/247683/">https://habr.com/ru/post/247683/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../247671/index.html">How to create a robotic startup: a textbook for the entrepreneur</a></li>
<li><a href="../247673/index.html">FAT32 media emulation on stm32f4</a></li>
<li><a href="../247677/index.html">Calculate the average temperature at the hospital</a></li>
<li><a href="../247679/index.html">Qmpot - programmable sound editor</a></li>
<li><a href="../247681/index.html">Introduction to Distributed Switch Architecture: Network Management Technology as a Single Device</a></li>
<li><a href="../247685/index.html">Online Arbitration or Arbitration Court on the Internet</a></li>
<li><a href="../247687/index.html">A guide to creating habit-forming products. Part one</a></li>
<li><a href="../247691/index.html">Zen Early Awakening: 10 ways to fix the morning ritual</a></li>
<li><a href="../247693/index.html">Blog design: what it should be</a></li>
<li><a href="../247695/index.html">It's hard to be a game designer.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>