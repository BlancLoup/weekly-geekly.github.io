<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we started real MS Excel in PHP and what came of it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It‚Äôs no secret that PHP programmers often have to solve problems that are very far from everyday understanding of ‚Äúweb development‚Äù. The development o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we started real MS Excel in PHP and what came of it</h1><div class="post__text post__text-html js-mediator-article">  It‚Äôs no secret that PHP programmers often have to solve problems that are very far from everyday understanding of ‚Äúweb development‚Äù.  The development of the language in recent years has led to the fact that PHP is increasingly considered a general-purpose language, suitable not only for sites, but also for other tasks. <br><br>  I had to solve one of such ‚Äúother‚Äù tasks quite recently.  We decided to share the ‚Äúrake card‚Äù with those who may follow the same path. <br><br><h3>  Given </h3><br><ul><li>  Many of our partners (let's say frankly - these are big banks) like to count something in Excel.  And ‚Äúlove‚Äù is very gently said.  Complicated scoring models can be ‚Äúprogrammed‚Äù in Excel, in a file of hundreds of sheets with dozens of macros </li><li>  Translate "programs", written in Excel into any programming language - almost unreal.  It will take a lot of time, and the problem of constant updating and validation makes such a task completely unsolvable. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Is required </h3><br><ul><li>  The main information system of our company is written in PHP.  It contains both web interfaces, and a lot of console services and workers. </li><li>  With these ‚Äúprograms‚Äù in Excel, you need to somehow interact from console applications in PHP ‚Äî transfer data to them, calculate, get results </li></ul><br>  For a while we had enough of the features of the popular PHPExcel library.  But when another demand came from the business ‚Äúit is necessary for the macros to work, and it would be good to save all this in PDF,‚Äù it became clear that the chosen path was a dead end.  It is necessary not to parse xlsx files, not to imitate a miscalculation, and not even use Open Office, but to learn how to interact with the ‚Äúreal‚Äù Microsoft Excel. <br><br><img src="https://habrastorage.org/files/9b9/482/ce7/9b9482ce7166477585b4b147967e7aa8.png"><br><a name="habracut"></a><br>  As a result of a brief survey, it was decided to create an internal micro-web service that would be able to receive data, open the specified Excel file, insert the received data into it, calculate the result and issue it as a response to the client.  Interest in such a web service was expressed by several internal projects and the work began to boil. <br><br><h3>  Server under Windows?  Why not! </h3><br>  The first to be hit was the dev-ops department.  They had to prepare the server for the future service.  It was unusual, because no one has any current experience with Windows ... <br><br>  Windows Server 2012 R2 standart was chosen as the server platform.  It should be immediately noted that out of the box, Windows is completely unsuitable for hosting PHP applications.  Required to bring the system to the desired level. <br><br>  To begin with, <a href="http://www.powershellserver.com/">PowerShellServer</a> was installed.  This allowed us to connect to the windows-server using the usual ssh protocol without reinventing bicycles.  Authorization by keys is supported, rsync works (this is important).  It is a pity that the Personal Edition restricts only one simultaneous connection, but for us it is not critical. <br><br>  Nginx was installed in a regular way.  Taken from the page <a href="http://nginx.org/ru/download.html">nginx.org/ru/download.html</a> Keep in mind - under windows there are significant limitations: only one workflow that holds no more than 1024 connections.  However, this again was uncritical for the internal micro-service. <br><br>  PHP 7.0.9 taken from <a href="http://windows.php.net/download">windows.php.net/download</a> , installed in a regular way. <br><br>  To simplify the restart of all this "good", a simple cmd-file was written: <br><br><pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> C:\nginx taskkill /f /IM nginx.exe taskkill /f /IM php-cgi.exe rm C:\nginx\logs\* start nginx start -WindowStyle Hidden php\php-cgi -A <span class="hljs-string"><span class="hljs-string">"-b 0.0.0.0:9000 -c C:\server\php\php.ini"</span></span></code> </pre> <br><br>  The initial server setup ended with a successful page output with phpinfo ().  However, this was only the very beginning ... <br><br><h3>  Customize the assembly on Windows or How to step on all the pitfalls? </h3><br>  We inside the company use Continuous Integration.  Is always.  For any small project.  A rough deployment plan looks like this: <br><br><ul><li>  Teamcity server monitors changes in the necessary branches of the repository (in this particular case, the workflow was simplified to the limit and the branch was actually one - master) </li><li>  He also starts the project build when changes occur: <br><ul><li>  The contents of the repository from the TeamCity server using rsync are delivered to the target server, to a temporary folder (this gives us the opportunity to save on TeamCity agents) </li><li>  In the same place, with the help of ssh, a build script is launched on phing, which does the main work: <br><ul><li>  Transfer code to a permanent place. </li><li>  Installs dependencies through composer </li><li>  Lays configs </li><li>  Applies migrations and so on ... </li><li>  And, finally, it switches the symlink current (this is wwwroot), to a new folder </li></ul><br></li></ul><br></li></ul><br>  What was required next?  The ssh server is already installed, rsync is running correctly.  Install phing: <br><ul><li>  The executable file (phing.phar) is <a href="https://www.phing.info/trac/wiki/Users/Installation">taken</a> from <a href="https://www.phing.info/trac/wiki/Users/Installation">www.phing.info/trac/wiki/Users/Installation</a> </li><li>  A neat and beautiful bat-nickname can be found at <a href="">www.phing.info/trac/browser/bin/phing.bat</a> </li><li>  Do not forget to add the path to phing in PATH to get the system-wide command </li></ul><br><br>  We take Git for Windows from <a href="https://git-scm.com/">git-scm.com</a> , install, check for correct operation. <br><br>  We follow exactly the same scheme with the composer, only we write the bat file ourselves and it will be much simpler: <br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%PHPBIN%"</span></span> == <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PHPBIN=C:\server\php\php.exe <span class="hljs-string"><span class="hljs-string">"%PHPBIN%"</span></span> <span class="hljs-string"><span class="hljs-string">"C:\nginx\php\composer.phar"</span></span> %*</code> </pre><br><br>  Everything seems to be ready.  Run the build ... fail! <br><br>  Cause 1. You need to install the php_openssl.dll extension, otherwise Phing will not be able to work with repositories via SSL.  No problems delivered. <br><br>  Reason 2. More serious.  In our build script, we use the technique of switching the symlink to the folder with the fresh build in the last step.  Like that: <br><br><pre> <code class="bash hljs">&lt;symlink target=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${current.dir}</span></span></span><span class="hljs-string">"</span></span> link=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${home.dir}</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${build.branch}</span></span></span><span class="hljs-string">/current"</span></span> overwrite=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt;</code> </pre><br>  The result is something like <br> <code>symlink: "c:\server\domains\this.service\master\current" =&gt; "c:\server\domains\this.service\master\2016-04-01-12-34-56" <br></code> <br>  It turned out that creating a symbolic link to NTFS is not a problem.  The problem to remove it ... For some reason, the operation of deleting a symlink requires administrative rights, which ordinary PHP does not and cannot have. <br><br>  The junction utility ( <a href="https://technet.microsoft.com/en-us/sysinternals/bb896768">technet.microsoft.com/en-us/sysinternals/bb896768</a> ) helped us.  With her, the above piece of script began to look something like this: <br><br><pre> <code class="bash hljs">&lt;<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=<span class="hljs-string"><span class="hljs-string">"junction -d </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${home.dir}</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${build.branch}</span></span></span><span class="hljs-string">/current"</span></span> checkreturn=<span class="hljs-string"><span class="hljs-string">"true"</span></span> passthru=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;symlink target=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${current.dir}</span></span></span><span class="hljs-string">"</span></span> link=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${home.dir}</span></span></span><span class="hljs-string">/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${build.branch}</span></span></span><span class="hljs-string">/current"</span></span> overwrite=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt;</code> </pre><br>  So, everything fell into place, the assembly earned, as it should be.  It is time to write the code! <br><br><h3>  COM Objects in PHP </h3><br>  It should be noted that the actual service code did not cause any problems. <br><br>  How to run Microsoft Excel and load an existing file into the application? <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Components</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Excel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $xls; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($filename = null)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xls = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \COM(<span class="hljs-string"><span class="hljs-string">"Excel.Application"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">todo:</span></span></span><span class="hljs-comment"> ,       $this-&gt;xls-&gt;Application-&gt;Visible = 1; $this-&gt;xls-&gt;DisplayAlerts = 0; if (empty($filename)) { $this-&gt;xls-&gt;Workbooks-&gt;Add(); } else { $this-&gt;xls-&gt;Workbooks-&gt;Open($filename); } $this-&gt;xls-&gt;Workbooks[1]-&gt;Activate(); } }</span></span></code> </pre><br>  How to close the application after the script ends? <br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__destruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xls-&gt;Workbooks[<span class="hljs-number"><span class="hljs-number">1</span></span>]-&gt;Close(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xls-&gt;Quit(); }</code> </pre><br>  Get a list of all named ranges? <br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNames</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $names = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xls-&gt;Names; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($names-&gt;Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> []; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $ret = []; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($names <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $name) { $ret[$name-&gt;Name] = $name-&gt;Value; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $ret; } }</code> </pre><br>  Set cell or range value? <br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($range, $value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xls-&gt;Range($range)-&gt;Value = iconv(<span class="hljs-string"><span class="hljs-string">'UTF-8'</span></span>, <span class="hljs-string"><span class="hljs-string">'Windows-1251'</span></span>, $value); }</code> </pre><br>  Read value from cell or range? <br>  It returns either a scalar value from a single cell or an array of values ‚Äã‚Äãif we request a range. <br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($range)</span></span></span><span class="hljs-function"> </span></span>{ $range = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xls-&gt;Range($range); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($range-&gt;Count == <span class="hljs-number"><span class="hljs-number">1</span></span>) { $val = $range-&gt;Value; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> is_string($val) ? iconv(<span class="hljs-string"><span class="hljs-string">'Windows-1251'</span></span>, <span class="hljs-string"><span class="hljs-string">'UTF-8'</span></span>, $val) : $val; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $ret = []; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($range <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $cell) { $val = $cell-&gt;Value; $ret[$cell-&gt;Address] = is_string($val) ? iconv(<span class="hljs-string"><span class="hljs-string">'Windows-1251'</span></span>, <span class="hljs-string"><span class="hljs-string">'UTF-8'</span></span>, $val) : $val; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $ret; } }</code> </pre><br>  Export book to pdf? <br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FORMATS = [ <span class="hljs-string"><span class="hljs-string">'PDF'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ]; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saveAs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($filename, $format = self::FORMATS[</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'PDF'</span></span></span></span><span class="hljs-function"><span class="hljs-params">])</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    ,   MS-DOS   ! $this-&gt;xls-&gt;Workbooks[1]-&gt;ExportAsFixedFormat($format, str_replace('/', '\\', $filename)); }</span></span></code> </pre><br><br>  What needs to be done to make all this crazy magic work? <br> <code>  php_com_dotnet.dll <br></code> <br><br><h3>  Instead of conclusion </h3><br>  It's quite enchanting to watch the server: when a request arrives, Excel instantly opens, the export is started, and then all this business is instantly closed. <br><br>  Good luck and do not step on the same rake! <br><br><h3>  Literature </h3><br><ol><li>  <a href="http://php.net/manual/en/book.com.php">php.net/manual/en/book.com.php</a> </li><li>  <a href="https://msdn.microsoft.com/ru-ru/library/wss56bz7.aspx">msdn.microsoft.com/en-ru/library/wss56bz7.aspx</a> </li><li>  <a href="https://geektimes.ru/post/50878/">geektimes.ru/post/50878</a> </li></ol><br><br><h3>  PS </h3><br>  Following the discussion in the comments, I decided to add a few important additions to the article. <br><br>  1. No, the task is not to ensure that some kind of PHP library can write to Excel files or read data from them.  The article is not about that.  The task is to run calculations, the algorithm of which is set from the outside in the form of Excel files (and there is no way to convert the algorithm to something else), to submit data to the input, to receive answers, to generate a report.  For this purpose, there is no other solution than to run the file in the native Microsoft Excel application. <br><br>  2. Files - hundreds.  Requests for calculations (that is, the launch of such files) - thousands per day.  This leads us to the impossibility of solving "and let someone himself manually run these files."  Requires complete and reliable automation. <br><br>  3. See previous paragraph.  Translation of algorithms into any programming language is impossible, since the costs of verification and QA will exceed the costs of the windows-server by three orders of magnitude. <br><br>  4. The web service is written for use by other services, not by human clients. <br><br>  5. Slightly changed the public function getValue ($ range) method to show how to read a range of cells as one unit.  Added a method to get a list of all named ranges. </div><p>Source: <a href="https://habr.com/ru/post/306408/">https://habr.com/ru/post/306408/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306398/index.html">Undo and Redo - analysis and implementation</a></li>
<li><a href="../306400/index.html">Representation of movements in 3D modeling: interpolation, approximation, and Lie algebra</a></li>
<li><a href="../306402/index.html">Online chat in small business: to be or not to be?</a></li>
<li><a href="../306404/index.html">XCOM 2 - parse the mechanics and look at "that's exactly the same, only less and the other"</a></li>
<li><a href="../306406/index.html">Grafana Benefits for Testing</a></li>
<li><a href="../306410/index.html">What technologies of computer games are flowing into reality - and a review of technologies in live action games</a></li>
<li><a href="../306414/index.html">On the development of open data in Ukraine</a></li>
<li><a href="../306416/index.html">10 tips on creating email newsletters</a></li>
<li><a href="../306418/index.html">Recent Trends in Online Payments</a></li>
<li><a href="../306420/index.html">Dates among the digits of Pi: some thoughts from the perspective of statistics and numerology</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>