<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let's talk about the weather</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I had to quite thoroughly communicate with several services of Yahoo! In this article I will talk about one of them, which may be useful for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let's talk about the weather</h1><div class="post__text post__text-html js-mediator-article"> Recently, I had to quite thoroughly communicate with several services of Yahoo!  In this article I will talk about one of them, which may be useful for many.  This is <a href="http://weather.yahoo.com/">Yahoo!</a>  <a href="http://weather.yahoo.com/">Weather</a> . <br><br>  About two years ago I searched the network for a convenient and open source of such data, but I did not find anything.  All domestic services exported data for money (it was not the price that scared off rather than having to pay), but Westerners either did not provide data in a convenient format for automatic processing, or did not know about the existence of the city in which I live. <br><br>  Yahoo!  Weather pleased with the absence of these shortcomings.  Information about the current weather, as well as the forecast for the next 5 days is exported from their server in RSS format.  In my opinion, the choice of this format is pulled by the ears, because  weather RSS "feed" contains only one item.  The same data could be exported in a more concise way, but Yahoo seemed to rely on standard RSS processing methods, which is also quite a weighty argument.  Standard is still standard. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The RSS feed address for the city of interest can be found at <a href="http://weather.yahoo.com/">weather.yahoo.com</a> . <br><br><img src="http://www.paradigm.ru/;-)/2008/02/yahoo-weather.png" width="500" height="291"><br><br>  In general, the URL is as follows: <br><br> <code><a href="http://xml.weather.yahoo.com/forecastrss%3Fp%3D%25D0%25BA%25D0%25BE%25D0%25B4_%25D0%25B3%25D0%25BE%25D1%2580%25D0%25BE%25D0%25B4%25D0%25B0%26u%3D%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2586%25D1%258B_%25D0%25B8%25D0%25B7%25D0%25BC%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F"></a> xml.weather.yahoo.com/forecastrss?p=_&amp;u=_</code> <br> <br>  The first parameter is the identifier of the city of interest.  The second parameter determines in which units the temperature will be displayed.  The value of "c" corresponds to degrees Celsius, "f" - degrees Fahrenheit. <a name="habracut"></a><br>  A few examples: <br><br><ul><li>  Moscow - <a href="http://xml.weather.yahoo.com/forecastrss%3Fp%3DRSXX0063%26u%3Dc">http://xml.weather.yahoo.com/forecastrss?p=RSXX0063&amp;u=c</a> </li><li>  St. Petersburg - <a href="http://xml.weather.yahoo.com/forecastrss%3Fp%3DRSXX0091%26u%3Dc">http://xml.weather.yahoo.com/forecastrss?p=RSXX0091&amp;u=c</a> </li><li>  Ekaterinburg - <a href="http://xml.weather.yahoo.com/forecastrss%3Fp%3DRSXX1219%26u%3Dc">http://xml.weather.yahoo.com/forecastrss?p=RSXX1219&amp;u=c</a> </li><li>  Khanty-Mansiysk - <a href="http://xml.weather.yahoo.com/forecastrss%3Fp%3DRSXX1234%26u%3Dc">http://xml.weather.yahoo.com/forecastrss?p=RSXX1234&amp;u=c</a> </li><li>  Kiev - <a href="http://xml.weather.yahoo.com/forecastrss%3Fp%3DUPXX0016%26u%3Dc">http://xml.weather.yahoo.com/forecastrss?p=UPXX0016&amp;u=c</a> </li></ul><br><br><h3>  Automate it </h3><br><br>  The <code>YahooWeather</code> class (PHP5) described below is designed to download RSS over HTTP and preprocess data. <br><br><pre>  &lt;? php

 class YahooWeather {
	 // Wind
	 public $ wind_chill;
	 public $ wind_direction;
	 public $ wind_speed;
	
	 // Atmospheric indicators
	 public $ humidity;
	 public $ visibility;
	 public $ pressure;
	
	 // We translate sunrise and sunset time to unix time
	 public $ sunrise;
	 public $ sunset;
	
	 // Current air temperature and weather
	 public $ temp;
	 public $ condition_text;
	 public $ condition_code;
	
	 // Weather forecast for 5 days
	 public $ forecast;
	
	 public $ units;
	
	 function __construct ($ code, $ units = 'c', $ lang = 'en') {
		 $ this-&gt; units = ($ units == 'c')? 'c': 'f';
		
		 $ url = 'http://xml.weather.yahoo.com/forecastrss?p='.
			 $ code. '&amp; u ='. $ this-&gt; units;
		
		 $ xml_contents = file_get_contents ($ url);
		 if ($ xml_contents === false) 
			 throw new Exception ('Error loading'. $ url);
		
		 $ xml = new SimpleXMLElement ($ xml_contents);
		
		 // Wind
		 $ tmp = $ xml-&gt; xpath ('/ rss / channel / yweather: wind');
		 if ($ tmp === false) throw new Exception ("Error parsing XML.");
		 $ tmp = $ tmp [0];
		
		 $ this-&gt; wind_chill = (int) $ tmp ['chill'];
		 $ this-&gt; wind_direction = (int) $ tmp ['direction'];
		 $ this-&gt; wind_speed = (int) $ tmp ['speed'];
		
		 // Atmospheric indicators
		 $ tmp = $ xml-&gt; xpath ('/ rss / channel / yweather: atmosphere');
		 if ($ tmp === false) throw new Exception ("Error parsing XML.");
		 $ tmp = $ tmp [0];
		
		 $ this-&gt; humidity = (int) $ tmp ['humidity'];
		 $ this-&gt; visibility = (int) $ tmp ['visibility'];
		 $ this-&gt; pressure = (int) $ tmp ['pressure'];
		
		 // We translate sunrise and sunset time to unix time
		 $ tmp = $ xml-&gt; xpath ('/ rss / channel / yweather: astronomy');
		 if ($ tmp === false) throw new Exception ("Error parsing XML.");
		 $ tmp = $ tmp [0];
		
		 $ this-&gt; sunrise = strtotime ($ tmp ['sunrise']);
		 $ this-&gt; sunset = strtotime ($ tmp ['sunset']);
		
		 // Current air temperature and weather
		 $ tmp = $ xml-&gt; xpath ('/ rss / channel / item / yweather: condition');
		 if ($ tmp === false) throw new Exception ("Error parsing XML.");
		 $ tmp = $ tmp [0];
		
		 $ this-&gt; temp = (int) $ tmp ['temp'];
		 $ this-&gt; condition_text = strtolower ((string) $ tmp ['text']);
		 $ this-&gt; condition_code = (int) $ tmp ['code'];
		
		 // Weather forecast for 5 days
		 $ forecast = array ();
		 $ tmp = $ xml-&gt; xpath ('/ rss / channel / item / yweather: forecast');
		 if ($ tmp === false) throw new Exception ("Error parsing XML.");
		
		 foreach ($ tmp as $ day) {
			 $ this-&gt; forecast [] = array (
				 'date' =&gt; strtotime ((string) $ day ['date']),
				 'low' =&gt; (int) $ day ['low'],
				 'high' =&gt; (int) $ day ['high'],
				 'text' =&gt; (string) $ day ['text'],
				 'code' =&gt; (int) $ day ['code']
			 );
		 }
	 }
	
	 public function __toString () {
		 $ u = "¬∞". (($ this-&gt; units == 'c')? 'C': 'F');
		 return $ this-&gt; temp. '  '. $ u.', '. $ this-&gt; condition_text;
	 }
 }

 ?&gt; </pre><br><br>  Example of use: <br><br><pre>  &lt;? php

 try {
	 $ weather = new YahooWeather ('RSXX0091');
 } catch (Exception $ e) {
	 echo "Caught exception:". $ e-&gt; getMessage ();
	 exit ();
 }

 echo '&lt;h1&gt;'. $ weather. '&lt;/ h1&gt;';

 echo "&lt;pre&gt;";
 print_r ($ weather);
 echo "&lt;/ pre&gt;";

 ?&gt; </pre><br><br>  Conclusion: <br><br><img src="http://www.paradigm.ru/;-)/2008/02/weather-report.png" width="447" height="441"><br><br>  Sunrise and sunset time values ‚Äã‚Äã(sunrise and sunset fields, respectively) are automatically converted to the unix time format.  It should also pay attention to the fact that for some unknown reason, Yahoo!  gives an obviously incorrect value of atmospheric pressure (0).  But the very presence of the corresponding attribute in XML gives some hope that sooner or later the export of this data will be repaired. <br><br>  The <code>condition_code</code> field is used to store the weather code code.  The text decoding of the current value is stored in the <code>condition_text</code> field, and the full list of possible options is given in the following table: <br><br><table><tbody><tr><td>  <strong>Code</strong> </td><td>  <strong>Description</strong> </td></tr><tr><td>  0 </td><td>  tornado </td></tr><tr><td>  one </td><td>  tropical storm </td></tr><tr><td>  2 </td><td>  hurricane </td></tr><tr><td>  3 </td><td>  severe thunderstorms </td></tr><tr><td>  four </td><td>  thunderstorms </td></tr><tr><td>  five </td><td>  mixed rain and snow </td></tr><tr><td>  6 </td><td>  mixed rain and sleet </td></tr><tr><td>  7 </td><td>  mixed snow and sleet </td></tr><tr><td>  eight </td><td>  freezing drizzle </td></tr><tr><td>  9 </td><td>  drizzle </td></tr><tr><td>  ten </td><td>  freezing rain </td></tr><tr><td>  eleven </td><td>  showers </td></tr><tr><td>  12 </td><td>  showers </td></tr><tr><td>  13 </td><td>  snow flurries </td></tr><tr><td>  14 </td><td>  light snow showers </td></tr><tr><td>  15 </td><td>  blowing snow </td></tr><tr><td>  sixteen </td><td>  snow </td></tr><tr><td>  17 </td><td>  hail </td></tr><tr><td>  18 </td><td>  sleet </td></tr><tr><td>  nineteen </td><td>  dust </td></tr><tr><td>  20 </td><td>  foggy </td></tr><tr><td>  21 </td><td>  haze </td></tr><tr><td>  22 </td><td>  smoky </td></tr><tr><td>  23 </td><td>  blustery </td></tr><tr><td>  24 </td><td>  windy </td></tr><tr><td>  25 </td><td>  cold </td></tr><tr><td>  26 </td><td>  cloudy </td></tr><tr><td>  27 </td><td>  mostly cloudy (night) </td></tr><tr><td>  28 </td><td>  mostly cloudy (day) </td></tr><tr><td>  29 </td><td>  partly cloudy (night) </td></tr><tr><td>  thirty </td><td>  partly cloudy (day) </td></tr><tr><td>  31 </td><td>  clear (night) </td></tr><tr><td>  32 </td><td>  sunny </td></tr><tr><td>  33 </td><td>  fair (night) </td></tr><tr><td>  34 </td><td>  fair (day) </td></tr><tr><td>  35 </td><td>  mixed rain and hail </td></tr><tr><td>  36 </td><td>  hot </td></tr><tr><td>  37 </td><td>  isolated thunderstorms </td></tr><tr><td>  38 </td><td>  scattered thunderstorms </td></tr><tr><td>  39 </td><td>  scattered thunderstorms </td></tr><tr><td>  40 </td><td>  scattered showers </td></tr><tr><td>  41 </td><td>  heavy snow </td></tr><tr><td>  42 </td><td>  scattered snow showers </td></tr><tr><td>  43 </td><td>  heavy snow </td></tr><tr><td>  44 </td><td>  partly cloudy </td></tr><tr><td>  45 </td><td>  thundershowers </td></tr><tr><td>  46 </td><td>  snow showers </td></tr><tr><td>  47 </td><td>  isolated thundershowers </td></tr><tr><td>  3200 </td><td>  not available </td></tr></tbody></table><br><br>  The article was published on the <a href="http://paradigm.ru/">paradigm.ru</a> blog. <br><br><h3>  Related Links </h3><br><br><ul><li>  <a href="http://weather.yahoo.com/">Yahoo!</a>  <a href="http://weather.yahoo.com/">Weather</a> </li><li>  <a href="http://developer.yahoo.com/weather/">Yahoo!</a>  <a href="http://developer.yahoo.com/weather/">Weather RSS feed</a> @ Yahoo!  Dev Network - a complete description of the exported data </li></ul></div><p>Source: <a href="https://habr.com/ru/post/20461/">https://habr.com/ru/post/20461/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../204598/index.html">Enyo 2. OOP</a></li>
<li><a href="../20460/index.html">Call to Google Reader users</a></li>
<li><a href="../204600/index.html">Bubble sort and all-all-all</a></li>
<li><a href="../204602/index.html">Looking for a virtual keyboard or ‚ÄúInternet of Things‚Äù at your fingertip</a></li>
<li><a href="../204604/index.html">VmWare patch for linux 3.13</a></li>
<li><a href="../204610/index.html">Backup: success stories or how I survived OCZ Vertex 2</a></li>
<li><a href="../204612/index.html">Design and design of applications for Windows: look online today at 10:00 (MSK)</a></li>
<li><a href="../204614/index.html">Happy 3D and other graphics!</a></li>
<li><a href="../204616/index.html">Creating apps for LG Smart TV: tips for a beginner developer</a></li>
<li><a href="../204618/index.html">Where in the Silicon Valley SVODat investors and startups?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>