<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rust: We get acquainted with the language on the example of "Guess-ki"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let's get acquainted with Rust, having worked on a small project! We will show the basic concepts of Rust with a real example. You will learn about le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rust: We get acquainted with the language on the example of "Guess-ki"</h1><div class="post__text post__text-html js-mediator-article"><p> Let's get acquainted with Rust, having worked on a small project!  We will show the basic concepts of Rust with a real example.  You will learn about <code>let</code> , <code>match</code> , methods, associated functions, connecting third-party libraries and much more.  We implement the classic task: the game ‚Äúguess the-ka‚Äù. </p><a name="habracut"></a><br><ol><li>  The program generates a random number from 1 to 100. </li><li>  After that asks the player to enter his guess. </li><li>  After that, the program notifies the player: <br><ul><li>  if he guessed the number, the game ends </li><li>  if not: <br><ul><li>  writes, less suggested number than conceived or more. </li><li>  proceeds to step 2. </li></ul></li></ul></li></ol><br><h2 id="sozdanie-novogo-proekta">  Creating a new project </h2><br><p>  In order to create a new project: </p><br><pre> <code class="hljs pgsql">$ cargo <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> guessing_game <span class="hljs-comment"><span class="hljs-comment">--bin $ cd guessing_game</span></span></code> </pre> <br><p>  The first <code>cargo new</code> command takes the program name ( <code>guessing_game</code> ) as the first argument.  <code>--bin</code> tells Cargo to prepare a project for writing a program (as opposed to a library).  Let's see what we have in the configuration file of the project - <em>Cargo.toml</em> </p><br><pre> <code class="hljs pgsql">[package] <span class="hljs-type"><span class="hljs-type">name</span></span> = "guessing_game" version = "0.1.0" authors = ["Your Name &lt;you@example.com&gt;"] [dependencies]</code> </pre> <br><p>  If the author information that Cargo received from your system is incorrect, correct the configuration file and save.  By default, the new project contains "Hello, world". <br>  <em>src / main.rs</em> </p><br><pre> <code class="rust hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Hello, world!"</span></span>); }</code> </pre> <br><p>  Let's build the program and run: </p><br><pre> <code class="hljs ruby">$ cargo run Compiling guessing_game v<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1.0</span></span> (<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">//projects</span></span><span class="hljs-regexp"><span class="hljs-regexp">/guessing_game) Finished dev [unoptimized + debuginfo] target(s) in 1.50 secs Running `target/debug</span></span><span class="hljs-regexp"><span class="hljs-regexp">/guessing_game` Hello, world!</span></span></code> </pre> <br><p>  The <code>run</code> command is very useful when you often repeat the compile, build and run phases in succession. </p><br><h2 id="obrabotka-dogadki">  Guess processing </h2><br><p>  The first part of our program will ask the user to enter his guess, process his input and verify that it is <em>valid</em> .  To begin with, let's give the user a guess of his: Hereinafter, all changes are made to <code>src/main.rs</code> : </p><br><pre> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">//        stdout use std::io; fn main() { println!("Guess the number!"); println!("Please input your guess."); let mut guess = String::new(); io::stdin().read_line(&amp;mut guess) .expect("Failed to read line"); println!("You guessed: {}", guess); }</span></span></code> </pre> <br><p>  The code carries a lot of information, so consider it gradually.  To get the entered guess from the user and output it to stdout, we need to bring the <code>io</code> library into the global <em>scope</em> .  <code>io</code> is part of the standard library (hereafter, <code>std</code> ): </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::io;</code> </pre> <br><p>  By default, Rust brings into the program scope only a few types ( <code>prelude</code> ).  If the <code>prelude</code> does not have the type you need, you should add it to the scope by manually writing the <code>use</code> statement.  Using <code>std::io</code> gives us many functions for handling I / O ( <em>IO</em> ), including the ability to read user input.  The <code>main</code> function (as in C and C ++) is the <em>entry point</em> into the program. </p><br><pre> <code class="rust hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() {</code> </pre> <br><p>  <code>fn</code> allows you to declare a new function, <code>()</code> indicates that the function takes no parameters, <code>{</code> precedes the body of the function. <code>println!</code>  - macro ( <code>macro</code> ), which displays a string on the console: </p><br><pre> <code class="rust hljs"><span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess the number!"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   . println!("Please input your guess.");</span></span></code> </pre> <br><h2 id="hranim-znacheniya-v-peremennyh">  Store values ‚Äã‚Äãin variables </h2><br><p>  Now create a place where user input will be stored: </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::new();</code> </pre> <br><p>  Notice the <code>let</code> statement, which is needed to create variables.  Could be so: </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> foo = bar;</code> </pre> <br><p>  The code creates a variable called <code>foo</code> and binds it to the value <code>bar</code> .  In Rust, the default variables are immutable.  To make them editable, next to <code>let</code> before the variable name add <code>mut</code> . </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> foo = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  (immutable) let mut bar = 5; // mutable()</span></span></code> </pre> <br><p>  Now you know that <code>let mut guess</code> creates a variable variable <code>guess</code> .  On the right side of the <code>=</code> sign is the value to which the "bind" <code>guess</code> is the result of calling <code>String::new</code> , a function that returns a new string.  <code>String</code> is a string type (similar to <code>string</code> in C ++ and <code>StringBuilder</code> in Java), which can grow, contains text encoded in <em>UTF-8</em> .  <code>::</code> in <code>::new</code> indicates that <code>new</code> is an <em>associated function</em> with a <code>String</code> type.  The associated function is implemented over the type, in this case over the String, and over a specific type instance.  Some languages, such as C ++, call such functions static ( <em>static</em> ) methods.  The <code>new</code> function creates a new empty <code>String</code> instance.  You will see that <code>new</code> implemented over many types, because it is used to denote a function that creates a new value of some type.  To summarize: <code>let mut guess = String::new();</code>  created a new variable that is ‚Äúbound‚Äù ( <em>bound</em> ) to a new empty <code>String</code> instance (empty string).  We have connected functions for working with IO by <code>use std::io</code> .  Now we will call the associated function <code>stdin</code> : </p><br><pre> <code class="rust hljs">io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess) .expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>);</code> </pre> <br><p>  If we did not write <code>use std::io</code> at the beginning of the program, then we could write the call to this function as <code>std::io::stdin</code> .  The <code>stdin</code> function returns an instance of <code>std::io::Stdin</code> , which is the type that represents the pointer to the standard input stream ( <em>standard input</em> ).  Here it is the user keyboard.  The next part of our code, <code>.read_line(&amp;mut guess)</code> , calls <code>read_line</code> on the just-received pointer ( <em>handle</em> ) to <code>stdin</code> to read the user input.  We also send a single argument: <code>&amp;mut guess</code> .  <code>read_line</code> accepts from the user what comes to <code>stdin</code> and puts this input into the string, therefore accepts a reference to a string variable.  This string argument must be mutable so that the method can change the value of this string by adding user input.  <code>&amp;</code> indicates that this argument ( <code>&amp;mut guess</code> ) is a reference ( <code>reference</code> ), which allows different parts of the code to access the same data region without copying the value from this data region many times.  One of the strengths of Rust is that it‚Äôs easy to use links (and without damaging the memory) with links.  For now, it‚Äôs enough for us to know that links, like variables, are by default immutable.  Therefore, we write <code>&amp;mut guess</code> (create a changeable link), not <code>&amp;guess</code> (create an immutable link). </p><br><pre> <code class="rust hljs">.expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>);</code> </pre> <br><p>  When you call a method using the syntax <code>.foo()</code> , it is advisable to switch to a new line so that the line of code is not too long.  This will make it easier for other programmers to read the code. </p><br><pre> <code class="rust hljs">io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess).expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>);</code> </pre> <br><p>  read a little harder. </p><br><h2 id="obrabotka-zaversheniya-s-oshibkoy-ispolzuem-result">  Handling completion with an error (use <code>Result</code> ) </h2><br><p>  <code>read_line</code> not only reads a string, but also returns a value; here, this value is of type <code>io::Result</code> .  Rust has several types called <code>Result</code> in different library modules. </p><br><ul><li>  common <code>Result</code> </li><li>  specific, for example <code>io::Result</code> <br>  <code>Result</code> types are <em>enumerations</em> - an implementation of the <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25B5%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D1%2582%25D0%25B8%25D0%25BF_%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D1%2585">Algebraic Data Type</a> .  In C / C ++, the analog is <a href="https://en.wikipedia.org/wiki/Tagged_union"><em>tagged union</em></a> .  The <code>Result</code> value can be represented by the options <code>Ok</code> and <code>Err</code> .  <code>Ok</code> indicates that the operation was successful, contains the returned value.  <code>Err</code> - indicates that the operation completed with an error, contains error information inside.  For <code>Result</code> values, <code>Result</code> -specific methods are applicable, for example, <code>expect</code> .  If the <code>Result</code> object has the value <code>Err</code> , then <code>expect</code> will print the error message passed to it and crash the program.  If it is <code>Ok</code> , <code>expect</code> return the value that is inside <code>Ok</code> .  The <code>read_line</code> function we <code>read_line</code> returns (if successfully completed) the number of bytes entered into <code>Ok</code> user.  If we do not call <code>expect</code> , the program will issue a warning when compiling: </li></ul><br><pre> <code class="hljs ruby">$ cargo build Compiling guessing_game v<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1.0</span></span> (<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">//projects</span></span><span class="hljs-regexp"><span class="hljs-regexp">/guessing_game) warning: unused `std::result::Result` which must be used --&gt; src/main</span></span>.<span class="hljs-symbol"><span class="hljs-symbol">rs:</span></span><span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-params"><span class="hljs-params">| 10 |</span></span> io::stdin().read_line(&amp;mut guess); <span class="hljs-params"><span class="hljs-params">| ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ |</span></span> = <span class="hljs-symbol"><span class="hljs-symbol">note:</span></span> <span class="hljs-comment"><span class="hljs-comment">#[warn(unused_must_use)] on by default</span></span></code> </pre> <br><p>  The compiler notifies us that we did not use the returned <code>Result</code> value, indicating that the program did not handle a possible error.  To suppress a warning, you need to write an error handling code, but we use <code>expect</code> , because we want to see how the program ends with an error. </p><br><h2 id="pechat-znacheniy-posredstvom-println">  Printing values ‚Äã‚Äãthrough println! </h2><br><pre> <code class="rust hljs"><span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You guessed: {}"</span></span>, guess); <span class="hljs-comment"><span class="hljs-comment">//  ,   </span></span></code> </pre> <br><p>  <code>{}</code> is a <em>placeholder</em> , indicates that the resulting string will contain the value corresponding to this placeholder variable.  To print multiple values, use multiple placeholders: the first placeholder ( <code>{}</code> ) corresponds to the first output value, the second one to the second, and so on.  For example: </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> x = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> y = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"x = {} and y = {}"</span></span>, x, y); <span class="hljs-comment"><span class="hljs-comment">// : // x = 5 and y = 10</span></span></code> </pre> <br><h2 id="proverka-pervoy-chasti">  Check the first part </h2><br><pre> <code class="rust hljs">$ cargo run Compiling guessing_game v0.<span class="hljs-number"><span class="hljs-number">1.0</span></span> (file:<span class="hljs-comment"><span class="hljs-comment">///projects/guessing_game) Finished dev [unoptimized + debuginfo] target(s) in 2.53 secs Running `target/debug/guessing_game` Guess the number! Please input your guess. 6 You guessed: 6</span></span></code> </pre> <br><p>  The program requested a number, we entered, the program output this number - everything works.  Go ahead. </p><br><h2 id="generirovanie-sekretnogo-chisla">  Secret number generation </h2><br><p>  Think of a number (from 1 to 100) that the user will try to guess.  It must be a random number so that you can play the game more than once.  Rust in <code>std</code> (standard library) does not have a module for working with random numbers, so we use a third-party library ( <em>crate</em> ) in terms of Rust) <code>rand</code> . </p><br><h2 id="ispolzuem-_kreyty_-dlya-polucheniya-dopolnitelnogo-funkcionala">  We use <em>crate</em> to get additional functionality </h2><br><p>  The crate is just a package of code on Rust.  We are writing the <em>binary crate</em> , a regular program in the form of an <em>executable</em> binary file.  <code>rand</code> - <em>library crate</em> , similar to <em>.o</em> and <em>.so</em> files in C - contains functions that any other crate can connect.  Cargo is very convenient to use to install third-party crates.  In order to start using the <code>rand</code> crate, we need to make the appropriate changes to <em>Cargo.toml</em> so that it includes <code>rand</code> as dependency.  Make changes to the [dependencies] section </p><br><pre> <code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">dependencies</span></span>] rand = <span class="hljs-string"><span class="hljs-string">"0.3.14"</span></span></code> </pre> <br><p>  In the <em>Cargo.toml</em> file <em>,</em> everything that follows the section header continues until a new section starts.  The [dependencies] section is where you specify <em>Cargo</em> crates, on which your project code depends, and which versions you need.  In this case, we have indicated that we need a <code>rand</code> crate with a version <code>0.3.14</code> to build the project.  <em>Cargo</em> understands the model of semantic versioning ( <a href="http://semver.org/"><em>Semantic Versioning</em></a> ), which is one of the standards for naming different versions of programs.  The number <code>0.3.14</code> (actually, this is the short form of the record <code>^0.3.14</code> ) means that any version that has an open ( <em>public</em> ) API is compatible with version 0.3.14.  Let's collect, but with a new dependency: </p><br><pre> <code class="hljs mel">$ cargo build Updating registry <span class="hljs-string"><span class="hljs-string">`https://github.com/rust-lang/crates.io-index`</span></span> Downloading <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span> v0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> Downloading libc v0<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> Compiling libc v0<span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> Compiling <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span> v0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> Compiling guessing_game v0<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>:<span class="hljs-comment"><span class="hljs-comment">///projects/guessing_game) Finished dev [unoptimized + debuginfo] target(s) in 2.53 secs</span></span></code> </pre> <br><p>  Cargo downloads dependencies from the repository ( <em>registry</em> ) - <a href="http://crates.io/">Crates.io</a> .  Crates.io is a place where Rust-developers post their open-source projects.  After Cargo.toml downloads the index, it checks if there are any dependencies that have not been downloaded yet.  If there is, then download them.  In addition, it also downloads <code>libc</code> , because the <code>rand</code> crate depends on it.  This means that transitive dependencies are resolved (dependency resolution) automatically.  After downloading the dependencies, rustc (the Rust compiler) compiles them, then compiles the program itself, using precompiled dependencies.  If you run the <code>cargo build</code> again, you will not see any messages.  Cargo knows that the necessary dependencies are already downloaded and compiled, and knows that you have not changed the [dependencies] section in <em>Cargo.toml</em> .  Cargo also knows that you have not changed your code, so it is not recompiled again.  Cargo is completed, as there is no work that he would need to do.  If you open <em>src / main.rs</em> and make changes, then the <code>cargo build</code> will compile the code of our project again, but not the compilation of dependencies, because they have not changed ( <em>incremental compilation</em> ). </p><br><h2 id="cargolock-sposobstvuet-sborke-vosproizvodimyh-_reproducible-builds_-programm">  Cargo.lock helps build <em>reproducible builds</em> </h2><br><p>  Cargo has tools that allow you to receive renewable assemblies, it will use only those versions of dependencies that you specified, until you specify other versions of dependencies.  What happens if a <code>rand</code> version <code>v0.3.15</code> , containing an important <em>bug fix</em> , and a regression that breaks your code?  In order to solve this problem, the <em>Cargo.lock</em> file is <em>used</em> , which was created when <em>cago build</em> was first run and is now located in the root directory of the project.  When you build a project for the first time, Cargo finds out the dependency numbers that meet the specified requirements (in <em>Cargo.toml</em> ) and writes information about them in <em>Cargo.lock</em> .  When you build your project for the second and subsequent times, Cargo sees that <em>Cargo.lock</em> already exists and uses the versions that are listed there, and does not display them again, wasting time on dependency analysis.  This gives us the opportunity to get reproducible builds.  In other words, the project will use <code>rand</code> version <code>0.3.14</code> until you explicitly upgrade. </p><br><h2 id="obnovlenie-kreyta-do-svezhey-versii">  Update crate to the latest version </h2><br><p>  When you want to update the crate, Cargo provides us with the <em>update</em> command, which: </p><br><ul><li>  ignores <em>Cargo.lock</em> and finds out the latest dependency versions that satisfy the requirements you specified in <em>Cargo.toml</em> . </li><li>  if this succeeds, Cargo writes these version numbers of the updated dependencies in <em>Cargo.lock</em> <br>  By default, Cargo will use versions&gt; <code>0.3.0</code> and &lt; <code>0.4.0</code> .  If the <code>rand</code> authors release two new versions, for example, <code>0.3.15</code> and <code>0.4.0</code> , then you will see the following when updating dependencies ( <code>cargo update</code> ): </li></ul><br><pre> <code class="hljs sql">$ cargo <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> Updating registry <span class="hljs-string"><span class="hljs-string">`https://github.com/rust-lang/crates.io-index`</span></span> Updating <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span> v0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.14</span></span> -&gt; v0<span class="hljs-number"><span class="hljs-number">.3</span></span><span class="hljs-number"><span class="hljs-number">.15</span></span></code> </pre> <br><p>  After that, you will notice that the <code>rand</code> version in <em>argo.lock</em> has changed to <code>0.3.15</code> .  If you want to use <code>rand</code> version <code>0.4.0</code> or any other <code>0.4.x</code> version, then you will need to update <em>Cargo.toml</em> so that it looks like this: </p><br><pre> <code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">dependencies</span></span>] rand = <span class="hljs-string"><span class="hljs-string">"0.4.0"</span></span></code> </pre> <br><p>  The next time you run the <code>cargo build</code> , Cargo will update the index of available crate and re-revise the dependencies.  Cargo makes it very easy to connect third-party libraries, which contributes to <em>code reuse</em> ( <em>code reuse</em> ).  It is easy <br>  write new crate using existing building blocks. </p><br><h2 id="generirovanie-sluchaynogo-chisla">  Random number generation </h2><br><p>  Let's proceed to use <code>rand</code> , for this we update <em>src / main.rs</em> </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> rand; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::io; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> rand::Rng; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess the number!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secret_number = rand::thread_rng().gen_range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"The secret number is: {}"</span></span>, secret_number); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Please input your guess."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::new(); io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess) .expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You guessed: {}"</span></span>, guess); }</code> </pre> <br><p>  We added <code>extern crate rand;</code>  , which indicates rustc that you need to connect a third-party library.  This is also similar to <code>use rand</code> , because now we have the opportunity to call functions from <code>rand</code> by writing <code>rand::</code> .  We also added <code>use rand::Rng</code> .  <code>Rng</code> is a type that defines the methods that will be implemented by random number generators.  This type must be in scope so that we can use its methods.  We also added two lines in the middle.  The <code>rand::thread_rng</code> function <code>rand::thread_rng</code> return a random number generator that is local to the current thread ( <em>thread</em> ), having been previously initialized ( <em>seeded</em> ) by the operating system.  Next we call <code>gen_range</code> on the generator.  This method is defined in the <code>Rng</code> , which we previously added to the scope by the <code>use rand::Rng</code> operator.  <code>gen_range</code> takes two numbers and returns a random number between them.  The range includes the lower limit and does not include the upper one, so we need to specify the numbers <code>1</code> and <code>101</code> in order to get a number from 1 to 100. To familiarize yourself with all the crate features, you need to read its documentation.  Another possibility for Cargo is that you can "collect" the documentation by calling the <code>cargo doc --open</code> , after which the documentation will be opened in the browser (after assembly).  If you are interested in other <code>rand</code> crate functionality, then select <code>rand</code> in the left pane.  The second line we added prints the secret number.  For now, let's leave it this way, it is convenient for checking the operation of the program, it will not be in the final version of the program.  Run a couple of times: </p><br><pre> <code class="hljs pgsql">$ cargo run Compiling guessing_game v0<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (file:///projects/guessing_game) Finished dev [unoptimized + debuginfo] target(s) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">2.53</span></span> secs Running `target/<span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>/guessing_game` Guess the number! The secret number <span class="hljs-keyword"><span class="hljs-keyword">is</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span> Please <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> your guess. <span class="hljs-number"><span class="hljs-number">4</span></span> You guessed: <span class="hljs-number"><span class="hljs-number">4</span></span> $ cargo run Running `target/<span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>/guessing_game` Guess the number! The secret number <span class="hljs-keyword"><span class="hljs-keyword">is</span></span>: <span class="hljs-number"><span class="hljs-number">83</span></span> Please <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> your guess. <span class="hljs-number"><span class="hljs-number">5</span></span> You guessed: <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br><p>  The program must each time display different random numbers from 1 to 100. </p><br><h2 id="sravnivaem-dogadku-s-sekretnym-chislom">  Compare the guess with the secret number </h2><br><p>  After we have generated a random number and got a guess from the user, we can compare them.  Make changes to <em>src / main.rs</em> </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> rand; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::io; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::cmp::Ordering; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> rand::Rng; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess the number!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secret_number = rand::thread_rng().gen_range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"The secret number is: {}"</span></span>, secret_number); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Please input your guess."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::new(); io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess) .expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You guessed: {}"</span></span>, guess); <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.cmp(&amp;secret_number) { Ordering::Less =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too small!"</span></span>), Ordering::Greater =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too big!"</span></span>), Ordering::Equal =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You win!"</span></span>), } }</code> </pre> <br><p>  The first unfamiliar element here is another use of the use statement, which introduces the type <code>std::cmp::Ordering</code> from <em>std</em> into the scope.  <code>Ordering</code> is another enumeration, it is similar to <code>Result</code> , but has other options: </p><br><ul><li> <code>Less</code> </li> <li> <code>Greater</code> </li> <li> <code>Equal</code> <br>  These are three possible results that we can get when comparing two numbers.  We also added code using the <code>Ordering</code> type: </li></ul><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.cmp(&amp;secret_number) { Ordering::Less =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too small!"</span></span>), Ordering::Greater =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too big!"</span></span>), Ordering::Equal =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You win!"</span></span>), }</code> </pre> <br><p>  The <code>cmp</code> method compares two numbers, it can be called for any two entities that are comparable to each other.  It gets a link to what you want to compare this element with: in this case, the <code>guess</code> and <code>secret_number</code> .  <code>cmp</code> returns the <code>Ordering</code> variant (we previously added it to the scope by using the <code>use</code> operator).  We also use <code>match</code> matching to decide, depending on the results of the comparison, how to proceed further.  Match matching consists of branches ( <code>arm</code> s).  A branch consists of a template and code that must be executed if the matching expression matches a branch template.  Rust sequentially matches an expression with patterns in the <code>match</code> branches, and after a <code>match</code> is found, the code to the right of the matching pattern is executed.  Let's look at an example of a possible interaction with the program.  Let's say the user suggested the number 50 as a guess, and the secret (conceived) number is 38. When the code compares 50 and 38, the <code>cmp</code> method returns <code>Ordering::Greater</code> , because 50&gt; 38. <code>Ordering::Greater</code> is the value that <code>match</code> .  <code>match</code> looks at the pattern of the first branch, <code>Ordering::Less</code> , but the value of <code>Ordering::Greater</code> not comparable (in this case because it is not equal) to <code>Ordering::Less</code> , therefore ignores the code in this branch and proceeds to match the following patterns.  The template for the next branch, <code>Ordering::Greater</code> comparable to <code>Ordering::Greater</code> (which we passed to <code>match</code> ).         <code>Too big!</code>  .  <code>match</code>     ,     .     ,     : </p><br><pre> <code class="hljs ruby">$ cargo build Compiling guessing_game v<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1.0</span></span> (<span class="hljs-symbol"><span class="hljs-symbol">file:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">//projects</span></span><span class="hljs-regexp"><span class="hljs-regexp">/guessing_game) error[E0308]: mismatched types --&gt; src/main</span></span>.<span class="hljs-symbol"><span class="hljs-symbol">rs:</span></span><span class="hljs-number"><span class="hljs-number">23</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-params"><span class="hljs-params">| 23 |</span></span> match guess.cmp(&amp;secret_number) { <span class="hljs-params"><span class="hljs-params">| ^^^^^^^^^^^^^^ expected struct `std::string::String`, found integral variable |</span></span> = <span class="hljs-symbol"><span class="hljs-symbol">note:</span></span> expected type <span class="hljs-string"><span class="hljs-string">`&amp;std::string::String`</span></span> = <span class="hljs-symbol"><span class="hljs-symbol">note:</span></span> found type <span class="hljs-string"><span class="hljs-string">`&amp;{integer}`</span></span> <span class="hljs-symbol"><span class="hljs-symbol">error:</span></span> aborting due to previous error Could <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> compile <span class="hljs-string"><span class="hljs-string">`guessing_game`</span></span>.</code> </pre> <br><p>   ,     . Rust ‚Äî      , , ,  .    <code>let guess = String::new()</code> , Rust  ,   <code>guess</code>    <code>String</code> ,        .   , <code>secret_number</code> ‚Äî  .        1  100.    : </p><br><ul><li> <code>i32</code> ‚Äî 32-  (   ) </li><li> <code>u32</code> ‚Äî 32-  (    ) </li><li> <code>i64</code> ‚Äî 64-  (   ) <br>  other. Rust     <code>i32</code> ,   <code>secret_number</code>    (       ,    ,   ,    <code>secret_number</code>  ,   ).    ,  Rust          .         <code>String</code> ,       ,  ,         .         <code>main</code> : </li></ul><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> rand; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::io; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::cmp::Ordering; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> rand::Rng; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess the number!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secret_number = rand::thread_rng().gen_range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"The secret number is: {}"</span></span>, secret_number); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Please input your guess."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::new(); io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess) .expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> guess: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = guess.trim().parse() .expect(<span class="hljs-string"><span class="hljs-string">"Please type a number!"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You guessed: {}"</span></span>, guess); <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.cmp(&amp;secret_number) { Ordering::Less =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too small!"</span></span>), Ordering::Greater =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too big!"</span></span>), Ordering::Equal =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You win!"</span></span>), } }</code> </pre> <br><p>    : </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> guess: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = guess.trim().parse() .expect(<span class="hljs-string"><span class="hljs-string">"Please type a number!"</span></span>);</code> </pre> <br><p>      <code>guess</code> . ,      ? ,  Rust   ( <em>shadow</em> ),   .       ,           .  ( <em>shadowing</em> )     ( <em>identifier</em> ),     ,  <code>guess_str</code>  <code>guess</code> .   ( <code>bind</code> ) <code>guess</code>   <code>guess.trim().parse()</code> . <code>guess</code>        <code>guess</code> ,    .  <code>trim</code>    <code>String</code>       . <code>u32</code>    ,      <code>ENTER</code> ,    (   <code>read_line</code> ).    <code>ENTER</code> ,       . ,      5    <code>ENTER</code> , <code>guess</code>   <code>5\n</code> . <code>\n</code> ‚Äî     ,     <code>ENTER</code> .  <code>trim</code>  <code>\n</code> ,   <code>5</code> .  <code>parse</code>   <code>String</code> ,    .           ,    Rust    ,     <code>let guess: u32</code> . ( <code>:</code> )  <code>guess</code> ,  Rust  ,     ( <em>annotate</em> )    . Rust       , , <code>u32</code> ,      32- .          .    <code>u32</code>    <code>guess</code>   <code>guess</code>  <code>secret_number</code>  ,  Rust    <code>secret_number</code>  <code>u32</code> .             ( <code>u32</code> ).  <code>parse</code>     . ,  ,      <code>A%</code> ,        . - ,     , <code>parse</code>    <code>Result</code> ,  ,    <code>read_line</code> .    <code>Result</code>  :   <code>expect</code> .  <code>parse</code>   <code>Err</code> - ,       ,   <code>expect</code>     ,      <code>expect</code> .        <code>parse</code>  ,  <code>parse</code>   <code>Ok</code> ,  <code>expect</code>     <code>Ok</code> .   : </p><br><pre> <code class="rust hljs">$ cargo run Compiling guessing_game v0.<span class="hljs-number"><span class="hljs-number">1.0</span></span> (file:<span class="hljs-comment"><span class="hljs-comment">///projects/guessing_game) Finished dev [unoptimized + debuginfo] target(s) in 0.43 secs Running `target/guessing_game` Guess the number! The secret number is: 58 Please input your guess. 76 You guessed: 76 Too big!</span></span></code> </pre> <br><p>  Fine!         ,  ,    76.      ,   -     : </p><br><ul><li>   </li><li>    </li><li>    <br>     ,       .  ,  . </li></ul><br><h2 id="predlagayte-vashi-dogadki-neskolko-raz">      </h2><br><p>   <code>loop</code>     . : </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> rand; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::io; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::cmp::Ordering; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> rand::Rng; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess the number!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secret_number = rand::thread_rng().gen_range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"The secret number is: {}"</span></span>, secret_number); <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Please input your guess."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::new(); io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess) .expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> guess: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = guess.trim().parse() .expect(<span class="hljs-string"><span class="hljs-string">"Please type a number!"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You guessed: {}"</span></span>, guess); <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.cmp(&amp;secret_number) { Ordering::Less =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too small!"</span></span>), Ordering::Greater =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too big!"</span></span>), Ordering::Equal =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You win!"</span></span>), } } }</code> </pre> <br><p>    ,     . : </p><br><pre> <code class="hljs pgsql">$ cargo run Compiling guessing_game v0<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (file:///projects/guessing_game) Running `target/guessing_game` Guess the number! The secret number <span class="hljs-keyword"><span class="hljs-keyword">is</span></span>: <span class="hljs-number"><span class="hljs-number">59</span></span> Please <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> your guess. <span class="hljs-number"><span class="hljs-number">45</span></span> You guessed: <span class="hljs-number"><span class="hljs-number">45</span></span> Too small! Please <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> your guess. <span class="hljs-number"><span class="hljs-number">60</span></span> You guessed: <span class="hljs-number"><span class="hljs-number">60</span></span> Too big! Please <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> your guess. <span class="hljs-number"><span class="hljs-number">59</span></span> You guessed: <span class="hljs-number"><span class="hljs-number">59</span></span> You win! Please <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> your guess. quit thread <span class="hljs-string"><span class="hljs-string">'main'</span></span> panicked at <span class="hljs-string"><span class="hljs-string">'Please type a number!: ParseIntError { kind: InvalidDigit }'</span></span>, src/libcore/result.rs:<span class="hljs-number"><span class="hljs-number">785</span></span> note: Run <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> `RUST_BACKTRACE=<span class="hljs-number"><span class="hljs-number">1</span></span>` <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a backtrace. error: Process didn<span class="hljs-string"><span class="hljs-string">'t exit successfully: `target/debug/guess` (exit code: 101)</span></span></code> </pre> <br><p>  <code>quit</code>  , ,     - .     :  ,   ,    . </p><br><h2 id="zavershenie-igry-pri-pravilnoy-dogadke">      </h2><br><p>   ,  <code>break</code>       : </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> rand; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::io; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::cmp::Ordering; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> rand::Rng; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess the number!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secret_number = rand::thread_rng().gen_range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"The secret number is: {}"</span></span>, secret_number); <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Please input your guess."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::new(); io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess) .expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> guess: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = guess.trim().parse() .expect(<span class="hljs-string"><span class="hljs-string">"Please type a number!"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You guessed: {}"</span></span>, guess); <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.cmp(&amp;secret_number) { Ordering::Less =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too small!"</span></span>), Ordering::Greater =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too big!"</span></span>), Ordering::Equal =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You win!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } }</code> </pre> <br><p>   <code>break</code>    <code>You win!</code> ,        ,  ,     .        ,       . </p><br><h2 id="obrabotka-nepravilnogo-vvoda">    </h2><br><p>   ,          ,     .     ,     : </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> guess: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.trim().parse() { <span class="hljs-literal"><span class="hljs-literal">Ok</span></span>(num) =&gt; num, <span class="hljs-literal"><span class="hljs-literal">Err</span></span>(_) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>, };</code> </pre> <br><p>   <code>expect</code>  <code>match</code>   .     ,   .   <code>parse</code>      ,    <code>Ok</code>   <code>match</code> ,   ,    <code>Ok</code>  ( <code>num</code> ),  <code>parse</code>   <code>Ok</code> .         <code>guess</code> .    <code>parse</code>       ,     <code>Err</code> ,        .  <code>Err</code>        <code>Ok(num)</code>     <code>match</code> ,       <code>Err(_)</code>   . <code>_</code>  ,      ,    <code>Err(_)</code>         <code>Err</code> .          <code>match</code> ‚Äî <code>continue</code> ,        .     : </p><br><pre> <code class="hljs mel">$ cargo run Compiling guessing_game v0<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>:<span class="hljs-comment"><span class="hljs-comment">///projects/guessing_game) Running `target/guessing_game` Guess the number! The secret number is: 61 Please input your guess. 10 You guessed: 10 Too small! Please input your guess. 99 You guessed: 99 Too big! Please input your guess. foo Please input your guess. 61 You guessed: 61 You win!</span></span></code> </pre> <br><p>  Fine.        . </p><br><pre> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> rand; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::io; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> std::cmp::Ordering; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> rand::Rng; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Guess the number!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secret_number = rand::thread_rng().gen_range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">101</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Please input your guess."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess = <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>::new(); io::stdin().read_line(&amp;<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> guess) .expect(<span class="hljs-string"><span class="hljs-string">"Failed to read line"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> guess: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.trim().parse() { <span class="hljs-literal"><span class="hljs-literal">Ok</span></span>(num) =&gt; num, <span class="hljs-literal"><span class="hljs-literal">Err</span></span>(_) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>, }; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You guessed: {}"</span></span>, guess); <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> guess.cmp(&amp;secret_number) { Ordering::Less =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too small!"</span></span>), Ordering::Greater =&gt; <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"Too big!"</span></span>), Ordering::Equal =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">println!</span></span>(<span class="hljs-string"><span class="hljs-string">"You win!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } }</code> </pre> <br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>       Rust: </p><br><ul><li> <code>let</code> ‚Äî      ( <code>type inference</code> ) <br>    </li><li> <code>match</code> ‚Äî         </li><li>  </li><li>  .  <code>static</code>   ++ </li><li>    ( <em>crates</em> ) </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/349134/">https://habr.com/ru/post/349134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349122/index.html">How ‚Äúthe survivor‚Äôs mistake‚Äù makes it difficult to draw conclusions in content marketing and smm</a></li>
<li><a href="../349124/index.html">Shadow ban and what it eats - part two</a></li>
<li><a href="../349126/index.html">From vague ideas to sponsored R & D: a guide to an uncertain start-up</a></li>
<li><a href="../349128/index.html">Monitor communication channels via Juniper RPM and Zabbix</a></li>
<li><a href="../349130/index.html">How we helped digitize the age-old history of weather observations in Brazil</a></li>
<li><a href="../349136/index.html">Universal React + Express Applications (continued)</a></li>
<li><a href="../349138/index.html">Comparison: Docker swarm, Kubernetes, Rancher and D2C</a></li>
<li><a href="../349140/index.html">Ramda Thinking: Partial Application (Currying)</a></li>
<li><a href="../349144/index.html">TOP-10. Analysis of the best reports in the public domain. Heisenbug 2017 Moscow</a></li>
<li><a href="../349146/index.html">Configuring Zones on Solaris 11.3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>