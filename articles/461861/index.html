<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Office 365 Cloud Services: Check Point CloudGuard SaaS Testing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habr! My name is Boris, and I am responsible for the information security of client and internal services at Linxdatacenter. Today we‚Äôll talk a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Office 365 Cloud Services: Check Point CloudGuard SaaS Testing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/d54/83c/5d2/d5483c5d27f3ac1ecdd34eeb8a720c28.jpg"><br><br>  Hello, Habr!  My name is Boris, and I am responsible for the information security of client and internal services at Linxdatacenter.  Today we‚Äôll talk about how to protect corporate mail in Office 365 from data leakage and loss. The IT engineer‚Äôs nightmare is a crowd of colleagues with panicked screams about unopened documents and missing mail.  And when all the data is synchronized in a public cloud, a single act of an unwary user separates a nightmare from reality.  There are several ways to insure against this disaster, but not everyone is equally good.  For several weeks, we persistently searched for a solution for the peace of mind of the IT department and tested it.  Today I want to talk about the test results and the product that we have chosen for use in the product. <br><a name="habracut"></a><br><h2>  What are the risks? </h2><br>  The human factor plays a key role in protecting information.  In more than 90% of cases, the main cause of incidents is a person and his actions, which lead to a violation of information security.  The most dangerous and most often used by staff applications are email and file sharing applications.  For our company, such services are Office 365 E-mail and OneDrive.  Both applications are available outside the office, without the use of a VPN connection and two-factor authentication. <br><br>  To begin with, let us dwell on the most common types of attacks that occur when using these applications, and their consequences. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Typical Attacks in Office 365 Email </h4><br><div class="scrollable-table"><table><tbody><tr><td>  Typical Attacks </td><td>  Possible consequences </td></tr><tr><td>  Using malware </td><td><ul><li>  Loss of access to accounts. <br></li><li>  Loss of files on the user's computer and the file storages available to him. <br></li><li>  Leaking personal or confidential information. <br></li><li>  Wailing (sending letters on behalf of an employee). <br></li><li>  Taking control of a workstation and other objects in the future. <br></li></ul><br></td></tr><tr><td>  Phishing </td><td><ul><li>  The user clicks on the attacker‚Äôs link and further infects the victim‚Äôs computer. <br></li><li>  Loss of files on the user's computer and the file storages available to him. <br></li><li>  Loss of access to accounts and services. <br></li></ul><br></td></tr><tr><td>  Unauthorized access </td><td><ul><li>  Loss of access to your account. <br></li><li>  Leakage of confidential information. <br></li><li>  Using a victim's account to access confidential information for the needs of attackers or competitors. <br></li></ul><br></td></tr></tbody></table></div><br><h4>  Typical Attacks in Office 365 OneDrive </h4><br><div class="scrollable-table"><table><tbody><tr><td>  Using malware <br></td><td><ul><li>  Loss of access to accounts. <br></li><li>  Loss of files on the user's computer and the file storages available to him. <br></li><li>  Taking control of a workstation and other objects in the future. <br></li></ul><br></td></tr><tr><td>  Unauthorized access <br></td><td><ul><li>  Loss of access to your account. <br></li><li>  Leakage of confidential information. <br></li><li>  Using a victim's account to access confidential information for the needs of attackers or competitors. <br></li></ul><br></td></tr></tbody></table></div><br>  Now that you‚Äôve also thought about the risks associated with using seemingly innocent email applications, we‚Äôll move on to protecting them. <br><br><h2>  What solutions were considered? </h2><br>  To protect Office 365 cloud services, we reviewed the following solutions: Microsoft ATP and Check Point CloudGuard SaaS.  Why exactly these products?  The fact is that CloudGuard SaaS for the period of testing, and now, is the only SaaS-solution of its kind that interacts with Office 365 services at the API level.  Microsoft ATP, in turn, is an embedded product.  The remaining vendors have solutions that are built into the work of the mail service by redirecting traffic to a physical or virtual server that processes the message and returns it to the end user.  To do this, you need to configure Office 365 connectors and change MX records in DNS, which can lead to downtime of email services.  The work of the mail service is critical for us, so we did not consider such solutions. <br><br>  Before active testing, reports and reviews on the listed products on various specialized resources were studied, a survey of colleagues was conducted. <br><br><h2>  Microsoft ATP </h2><br>  Microsoft Office 365 Advanced Threat Protection offers three paid subscription levels (E1, E3, and E5) for companies with 300 or more users.  Each level includes scanning attachments and the sandbox (Safe Attachments), filtering the reputation of URLs (safe links), basic protection against spoofing, as well as antiphishing. <br><br>  Sounds great ... However, MS Office 365 ATP has a number of significant vulnerabilities.  First, the service allows hackers to search for MX records to determine if users are using Office 365. After that, attackers target an attack by using fake Office 365 login or file sharing via OneDrive.  In addition, any hacker can activate a mailbox with Microsoft ATP protection, and then constantly check his attacks on the system using the trial and error method until he finds a strategy that works.  Attackers for as little as $ 10 can open hundreds of accounts to test their methods and still make a solid profit if their attacks are successful in the long run.  Not so long ago, researchers discovered a 0-day vulnerability called BaseStriker.  Although, to be honest, publications on circumvention of Microsoft protection appear regularly. <br><br>  <a href="https://www.avanan.com/resources/basestriker-vulnerability-office-365">Avanan</a> reported that BaseStriker is used by hackers to conduct more effective phishing attacks.  This method allows you to send a large number of web links through MSFT servers without scanning.  This link may point the user to a phishing site or to a file that downloads malware.  BaseStriker can infiltrate Office 365, essentially obfuscating ATP by splitting and hiding a malicious link using a URL tag.  A malicious link is included in the email, but instead of being part of the original link, it is shared.  This is shown in detail in the Avanan example. <br><br>  Using your own program shell in the user‚Äôs environment (inside the browser), which, as it turned out, doesn‚Äôt react at all to malware and scripts, allows the execution of malicious code on a phishing site.  In Prevent mode, emulation takes about 30 minutes or more.  Colleagues who tested this solution also do not yet recommend using it in practice. <br><br>  A vivid demonstration of ATP (Proof-of-concept) and its shortcomings is also available on the TrustedSec website ( <a href="https://www.trustedsec.com/2017/02/office-365-advanced-threat-protection-features-shortfalls/">link</a> ). <br><br><h2>  Check Point Cloud Guard SaaS </h2><br>  Let's move on to the solution from Check Point.  In our test, we used the CloudGuard SaaS solution. <br><br>  CloudGuard SaaS connects to Office 365 through an administrator account and granting access rights to mail and files. <br><br>  <b>Scan Levels:</b> <br><br><ul><li>  Incoming and outgoing letters, attachments, links in letters. <br></li><li>  Files on file storage. <br></li></ul><br>  <b>The solution consists of several modules operating at different levels:</b> <br><br><ul><li>  Attachments and files are <b>scanned by the Anti-Virus module</b> , using Check Point SandBlast technology. <br></li><li>  <b>The Anti-Phishing module</b> works on previously unknown and potentially dangerous senders.  Check Point claims to use more than 300 parameters to determine phishing. <br></li><li>  <b>The DLP module</b> responds to documents, letters, and attachments that contain potentially important financial or organizational information.  A quite useful function, especially against possible sabotage or employee mistakes, as well as for controlling information flows. <br></li><li>  <b>The Shadow IT module</b> allows you to identify the use of third-party services in addition to Office 365. Shadow IT refers to IT devices, software, and services that are present in the organization but not served by the IT department.  They are not on the balance sheet of the IT department, their status and work are not controlled, moreover, the IT department may not know anything about them.  These include Amazon AWS, GPC, amoCRM, and other services. <br></li><li>  <b>Anomaly Detection</b> allows you to identify anomalies when users log on to Office 365. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/646/a7b/55b/646a7b55b70d65579387e02684b4e5e0.jpg">  <i>In the Cloud Guard SaaS dashboard, statistics for each module are displayed.</i> <br><br>  All modules are trained and allow the administrator to indicate false positives. <br><br>  For testing, CloudGuard SaaS was connected to Office 365 Email and Office 365 OneDrive in monitoring mode. <br><br><h2>  Let's move on to practice </h2><br>  Let's analyze the data of the service over the past couple of months from the date of implementation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab4/153/b47/ab4153b47d67c9436e7c323f7c8daaaa.png"><br>  <i>CloudGuard scans email attachments to prevent threats and runs them through the sandbox.</i> <br><br>  The screenshot above shows the following information: <br><br><ul><li>  the number of external users (we mean addresses not with our domain); </li><li>  the number of protected internal users (those that are in the system); </li><li>  number of incoming emails with attachments; </li><li>  number of outgoing emails with attachments. </li></ul><br><h3>  Office 365 Scan Report </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/12d/2c5/a44/12d2c5a4449cb4b1ab5871427a1b26cf.jpg"><br><br>  <i>Summary of identified threats and scanned objects.</i> <br><br>  The screenshot above provides information about the prevented threats (Security Events) and scanned objects (Scanned objects): <br><br><ul><li>  leakage of confidential information (Data Leak Prevention); </li><li>  malware entry attempts (malware); </li><li>  phishing </li><li>  abnormal activity - it is different; </li><li>  suspicion of phishing; </li><li> shadow IT; </li><li>  SPAM </li><li>  threat extraction (converting files to a safe form). </li></ul><br><h3>  OneDrive Scan Report </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/d32/c54/321/d32c543212c39946d20bb3a2a3b26b12.png"><br><br>  In fact, the report is a much larger amount of information.  For example, in the DLP module, you can see what mask is triggered, find a letter that caused a potential information leak.  Alas, I can‚Äôt share such a screen. <br><br><h3>  Examples of displaying malicious emails on the CloudGuard portal </h3><br><ul><li>  Email with detected malicious attachment: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c25/c73/5bc/c25c735bcc46af43a4ca744b591388eb.png"></li><li>  Phishing email missed by Microsoft built-in filters: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/add/dc9/164/adddc9164ea029f369601f8a079e70e2.png"></li><li>  The URL reputation (one of the parameters for evaluating phishing emails) is fine, but the link in the email is phishing: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27e/179/4a9/27e1794a96ec27dbdfcc954e7789d363.png"></li><li>  An example of a message suspected of phishing, also not seen by Microsoft filters: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45a/9a9/822/45a9a982227db0f1eef168531b4d192c.png"></li></ul><br><h2>  And ... conclusions </h2><br>  Now let's talk about the pros and cons of CloudGuard SaaS. <br><br><h3>  Pros: </h3><br><ul><li>  Nice and fairly simple interface. </li><li>  <s>Fast</s> , very fast integration in Office 365: requires administrator account and 5-10 minutes. </li><li>  Consultations and direct support of the vendor. </li><li>  The possibility of free testing for 30 days. </li><li>  The ability to use native Office 365 groups to create a list of protected addresses, flexible license management. </li><li>  Each user connected to Check Point CloudGuard SaaS can be protected by any module for a fixed price and on any available CloudGuard SaaS service (Office 365 mail, OneDrive, SharePoint, Google Drive, Dropbox, etc.). </li><li>  Detailed reports for each event; </li><li>  Not so long ago there was an antispam! </li></ul><br>  In addition, in future editions, the vendor promises the implementation of several important improvements: <br><br><ul><li>  Identity Protection module for Azure AD, which will allow you to bind two-factor authentication to each of the available services; </li><li>  protection against SMS phishing. </li></ul><br><h3>  Minuses: </h3><br><ul><li>  Check Point gets full access to our services.  Relations are built on mutual trust. </li><li>  Not the fastest technical support response to emerging issues. </li><li>  Lack of whitelisting for external mailing addresses. </li><li>  The inability to upload reports from the analytics section is sorely lacking. </li><li>  The absence of the read-only role of the portal user (only admin is available). </li></ul><br>  In general, we are satisfied with the test results and opted for the product of Check Point.  CloudGuard SaaS is currently connected to Office 365 Email and Office 365 OneDrive in Prevent mode. <br><br>  I would like to note that Linxdatacenter engineers also considered Cisco Email Security and Fortimail as another option for protecting the mail server from phishing attacks and spam, but the implementation of CES requires changing the MX domain record, connecting the connectors in Exchange and can potentially lead to a small downtime. which, unfortunately, is critical.  Perhaps in the near future we will return to testing the updated CES and Fortimail solutions. </div><p>Source: <a href="https://habr.com/ru/post/461861/">https://habr.com/ru/post/461861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461837/index.html">Deploying your MTProxy Telegram with statistics</a></li>
<li><a href="../461845/index.html">Investments on the stock exchange as a way to preserve finances: 3 working methods</a></li>
<li><a href="../461849/index.html">PVS-Studio glanced at Red Dead Redemption engine - Bullet</a></li>
<li><a href="../461855/index.html">Salaries in IT in the first half of 2019: according to the salary calculator My Circle</a></li>
<li><a href="../461859/index.html">You don't know anything about food tech</a></li>
<li><a href="../461863/index.html">How Chinese Mpow Headphones Bestseller on Amazon: Getting to Know the Brand</a></li>
<li><a href="../461865/index.html">Video course ‚ÄúIntroduction to reversing from scratch using IDA PRO. Chapter 1"</a></li>
<li><a href="../461867/index.html">How to recognize pictures and texts on your phone using ML Kit</a></li>
<li><a href="../46187/index.html">"Classmates" have become a partner of "Runner"</a></li>
<li><a href="../461871/index.html">101 tips for becoming a good programmer (and human)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>