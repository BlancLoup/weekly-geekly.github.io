<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LED Management Tutorial with the Robotics Development Kit</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This tutorial demonstrates how to manage GPIO contacts with a simple example, similar to writing the simplest ‚ÄúHello World‚Äù program: by setting the UP...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LED Management Tutorial with the Robotics Development Kit</h1><div class="post__text post__text-html js-mediator-article">  This tutorial demonstrates how to manage GPIO contacts with a simple example, similar to writing the simplest ‚ÄúHello World‚Äù program: by setting the UP card so that you can blink with an external LED. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/442/5bd/9f5/4425bd9f58f24bbcab0e4a2bdf8f33d4.jpg"></div><br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7d4/93e/437/7d493e437c8d4f77be224055c1da363e.jpg"></div><br><h2>  <font color="#0071c5">UP fee in Robotics Development Kit</font> </h2><br>  The <a href="https://software.intel.com/en-us/realsense/robotic-development-kit">Intel RealSense Robotics Development Kit</a> (RDK) consists of an Intel RealSense R200 depth camera and an Aaeon * UP card.  The UP board in this system is the computing core.  For connecting external devices, this board is equipped with a 40-pin I / O terminal shown in the figure above.  A total of 28 independent GPIO pins are placed on the I / O terminal on the UP board.  The Ubuntu 14.04 kernel platform drivers have been developed for the UP card, providing for the numbering of GPIO contacts in Linux in the range from 0 to 27 with emulation of the capabilities of the Raspberry Pi board. <br><br>  Access to GPIO hardware in this tutorial will be at a low level using Linux sysfs.  With Sysfs, Linux users (or code in user space) can interact with devices at the system (kernel) level. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For this tutorial, no special libraries are needed because the sysfs interface is used. <br><br>  <b>Important!</b>  Note that the Linux GPIO numbers in Figure  1 differs from both physical contact numbers and <a href="http://www.up-board.org/specifications/">wiring on the UP board</a> .  Linux GPIO numbers are assigned according to the Raspberry Pi BCM GPIO numbering scheme. <br><br>  For comparison with the layout on the Raspberry Pi board, visit the <a href="http://pinout.xyz/">site</a> . <br><br><h2>  <font color="#0071c5">How to light up the LED using the UP board</font> </h2><br>  It is enough to configure the UP board as part of the RDK according to the Quick Start Guide <a href="https://01.org/developerjourney/recipe/intel-realsense-robotic-development-kit">From Zero to Hero: Getting up and running with the Intel RealSense Robotic Development Kit</a> , and everything is ready to work on the first real project.  We will control the switching on of the LED using the C programming language and GPIO pins on the UP board. <br><br><h3>  <font color="#0071c5">What do you learn</font> </h3><br>  You will assemble the simplest circuitry and connect it to the GPIO pins of the UP card. <br><br><h3>  <font color="#0071c5">What is needed</font> </h3><br><ul><li>  1 small LED of any color. </li><li>  1 50 ohm resistor. </li><li>  Single core wire of small cross section. </li><li>  Dummy or crocodile clips (or both) for fixing the contacts. </li></ul><br><h3>  <font color="#0071c5">Let there be light!</font> </h3><br>  Before writing the code, you should familiarize yourself with the numbering of contacts on the UP board and assemble a simple electrical circuit.  To begin with, we simply turn on the LED using the 3.3 V contact and the ground contact on the UP board.  The circuit of our electric circuit is as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ea5/dbf/889/ea5dbf889bd64caf823f82c234d76602.jpg"></div><br>  Before you start, turn off the UP board.  If you work with it in the on state, there is a risk of a short circuit, and this should be avoided, especially if you consider that this is our first project. <br><br><ul><li>  Based on the available parts, assemble the electrical circuit either on the circuit board or using crocodile clips. </li><li>  Pin 1 (+3.3 V) must be connected to the long leg of the LED (anode).  This contact supplies a voltage of 3.3 V. In contrast to the GPIO contacts on the UP board, this contact is not programmable: it is impossible to control it using software. </li><li>  Connect the short leg of the LED to the resistor.  Then connect the second resistor pin to pin 6 (ground) on the UP board. </li></ul><br>  Check again how everything is connected.  When everything is ready, the electrical circuit should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f07/b6f/67d/f07b6f67d590448ca7b6981053ddefda.jpg"></div><br>  Turn on the UP board.  The LED should light up immediately. <br><br><h2>  <font color="#0071c5">LED control using software code</font> </h2><br>  So, the simplest electrical circuit has been tested, now it‚Äôs time to switch the positive wire from the permanently connected 3.3 V contact to one of the programmable GPIO contacts.  Here is how the scheme will look like: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b11/bd4/871/b11bd48714c34434a1e0edc1e79cf3b1.jpg"></div><br><ul><li>  Turn off the UP card again before changing anything in the connections. </li><li>  Transfer the positive wire from pin 1 to pin 7. </li></ul><br>  When everything is ready, the electrical circuit should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/139/b05/d4a/139b05d4ac5e4ca6b3a4945632485ecb.jpg"></div><br><h2>  <font color="#0071c5">Source code to control blinking</font> </h2><br>  The following source code example will make the LED blink. <br><br><div class="spoiler">  <b class="spoiler_title">Source</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;sys/stat.h&gt; #include &lt;sys/types.h&gt; #include &lt;fcntl.h&gt; #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; #define IN 0 #define OUT 1 #define LOW 0 #define HIGH 1 #define PIN 24 /* physical pin 18 */ #define POUT 4 /* physical pin 7 */ static int GPIOExport(int pin); static int GPIOUnexport(int pin); static int GPIODirection(int pin, int dir); static int GPIORead(int pin); static int GPIOWrite(int pin, int value); int main(int argc, char *argv[]) { int repeat = 9; /* * Enable GPIO pins */ if (-1 == GPIOExport(POUT) || -1 == GPIOExport(PIN)) return(1); /* * Set GPIO directions */ if (-1 == GPIODirection(POUT, OUT) || -1 == GPIODirection(PIN, IN)) return(2); do { /* * Write GPIO value */ if (-1 == GPIOWrite(POUT, repeat % 2)) return(3); /* * Read GPIO value */ printf("I'm reading %d in GPIO %d\n", GPIORead(PIN), PIN); usleep(500 * 1000); } while (repeat--); /* * Disable GPIO pins */ if (-1 == GPIOUnexport(POUT) || -1 == GPIOUnexport(PIN)) return(4); return(0); } Int GPIOExport(int pin) { #define BUFFER_MAX 3 char buffer[BUFFER_MAX]; ssize_t bytes_written; int fd; fd = open("/sys/class/gpio/export", O_WRONLY); if (-1 == fd) { fprintf(stderr, "Failed to open export for writing!\n"); return(-1); } bytes_written = snprintf(buffer, BUFFER_MAX, "%d", pin); write(fd, buffer, bytes_written); close(fd); return(0); } Int GPIOUnexport(int pin) { char buffer[BUFFER_MAX]; ssize_t bytes_written; int fd; fd = open("/sys/class/gpio/unexport", O_WRONLY); if (-1 == fd) { fprintf(stderr, "Failed to open unexport for writing!\n"); return(-1); } bytes_written = snprintf(buffer, BUFFER_MAX, "%d", pin); write(fd, buffer, bytes_written); close(fd); return(0); } Int GPIODirection(int pin, int dir) { static const char s_directions_str[] = "in\0out"; #define DIRECTION_MAX 35 char path[DIRECTION_MAX]; int fd; snprintf(path, DIRECTION_MAX, "/sys/class/gpio/gpio%d/direction", pin); fd = open(path, O_WRONLY); if (-1 == fd) { fprintf(stderr, "Failed to open gpio direction for writing!\n"); return(-1); } if (-1 == write(fd, &amp;s_directions_str[IN == dir ? 0 : 3], IN == dir ? 2 : 3)) { fprintf(stderr, "Failed to set direction!\n"); return(-1); } close(fd); return(0); } Int GPIORead(int pin) { #define VALUE_MAX 30 char path[VALUE_MAX]; char value_str[3]; int fd; snprintf(path, VALUE_MAX, "/sys/class/gpio/gpio%d/value", pin); fd = open(path, O_RDONLY); if (-1 == fd) { fprintf(stderr, "Failed to open gpio value for reading!\n"); return(-1); } if (-1 == read(fd, value_str, 3)) { fprintf(stderr, "Failed to read value!\n"); return(-1); } close(fd); return(atoi(value_str)); } Int GPIOWrite(int pin, int value) { static const char s_values_str[] = "01"; char path[VALUE_MAX]; int fd; snprintf(path, VALUE_MAX, "/sys/class/gpio/gpio%d/value", pin); fd = open(path, O_WRONLY); if (-1 == fd) { fprintf(stderr, "Failed to open gpio value for writing!\n"); return(-1); } if (1 != write(fd, &amp;s_values_str[LOW == value ? 0 : 1], 1)) { fprintf(stderr, "Failed to write value!\n"); return(-1); } close(fd); return(0); }</span></span></span></span></code> </pre> <br></div></div><br>  If the source file is called blink.c, you can compile the code with the following command: <br><br><pre> <code class="bash hljs">gcc ‚ÄìWall ‚Äìo blink blink.c</code> </pre><br><h2>  <font color="#0071c5">Conclusion</font> </h2><br>  In this tutorial for working with the UP board, a simple circuit diagram is created;  the UP board and the C program using the Linux sysfs mechanism control the operation of the LED, which should flash 10 times. <br><br>  In the next tutorial in this series, we will adjust the LED brightness using depth data from the R200 camera and Intel RealSense cross-platform API, for which we will have to re-work both the electrical capture and the C program. </div><p>Source: <a href="https://habr.com/ru/post/313942/">https://habr.com/ru/post/313942/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313932/index.html">The implementation of the block cipher "Grasshopper" with CFB mode in C ++</a></li>
<li><a href="../313934/index.html">Concept of life program</a></li>
<li><a href="../313936/index.html">Modeling of enterprise assets: modern standards and practice</a></li>
<li><a href="../313938/index.html">Flexbox Cheat Sheet (CSS3 Flexible Box)</a></li>
<li><a href="../313940/index.html">The digest of interesting materials for the mobile # 177 developer (October 24-30)</a></li>
<li><a href="../313944/index.html">A few things to know about MaaS</a></li>
<li><a href="../313946/index.html">How to make a sound processor in Zhiguli</a></li>
<li><a href="../313948/index.html">Tips on proportions and scale in games</a></li>
<li><a href="../313950/index.html">How to unload dll from java-machine</a></li>
<li><a href="../313958/index.html">Select / Multiselect without JS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>