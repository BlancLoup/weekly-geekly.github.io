<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Load testing of Web-systems. We continue training</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article describes a number of points (number of connections and execution sequence, third-party resources in the script, grouping of requests) tha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Load testing of Web-systems. We continue training</h1><div class="post__text post__text-html js-mediator-article">  The <a href="https://habrahabr.ru/post/332862/">article</a> describes a number of points (number of connections and execution sequence, third-party resources in the script, grouping of requests) that should be paid attention to in preparing for the test with a high load on the Web-system with a web-interface. <br><br>  I propose to consider the following script configuration elements that may affect the performance of your test. <br><a name="habracut"></a><br>  I want to describe why the use of real HTTP methods is more important than its ‚Äúfast‚Äù counterparts.  We will touch on the need to use checks of the received data and the construction of regular expressions to get the values. <br><br><h2>  Getting answers with real data size </h2><br>  In my opinion, at least in the final testing of the Web-system, it is necessary to use the requests that the browser sends.  If it was a GET request, then we should simulate only it and not replace it with, for example, HEAD.  The main difference between these methods is that GET receives the contents of the response, but HEAD does not.  It would seem, why should I get unnecessary data, for example, from pictures, css, fonts, but as practice shows, they are no less important. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Compare two types of queries for the same test resource. <br>  HEAD <br><br><img src="https://habrastorage.org/web/3f2/45d/5b9/3f245d5b9e954264b9c9229ccacf3545.png" alt="image"><br><br>  Get <br><br><img src="https://habrastorage.org/web/537/786/f04/537786f04be944d4956f6e7a9c2fca8c.png" alt="image"><br><br>  In the pictures you can see that the GET request is executed many times longer than HEAD.  Consequently, the server gave the data to this request longer and could not serve the following.  With one user, this difference does not seem to be significant, but with 1,000 virtual users, the server will waste time no longer processing each of them. <br><br>  For example, our web server is configured in such a way that it can handle only 100 simultaneous connections.  As a result, we will see that the first 100 are connected and will work for at least 3 seconds.  In this case, all the other 900 will be waiting for connectivity  As soon as someone from the first hundred finishes, he will give the resources to the next one.  That is, the thousandth user in our example will be able to start working with the specified request only after approximately 27 seconds.  If we used the HEAD method, the thousandth user would get access to the system in 2 seconds.  (these calculations are extremely rough) <br><br>  <i>As a result, we see how using the "correct" method to access the server shows the real load on it.</i> <br><br>  The example used in the pictures is fully synthetic to show greater visibility in the query execution time.  You may not have such large requests.  But even with a response of 100 to 200 kilobytes and the use of 5,000 users, we can observe significant slowdowns in the operation of the Web server. <br><br><h2>  Verification of received data </h2><br>  Many will say that verification of the received data is not load testing, but functional, and you will be right in part.  In practice, there are situations when the functional part of the Web-system does not start to work correctly under a heavy load.  For example, a web application may not properly process incoming data under heavy load. <br><br>  I was faced with situations when the web-system reported on the success of the request, sending a response 200 OK.  But the request body was empty, after a deep study of the system, we managed to find out that this was a planned response.  That is, the success of the query could only be determined by the presence of content in the response. <br><br>  <i>It turns out that the only option to check the correct operation of the system under high load is to control the received data, and not just the status of receiving a response.</i> <br><br>  Today, with the intensive development of dynamic work with web-systems (AJAX, WebSocket, Flash, Java, etc.), we can receive different content for the same request.  And you need to be sure that the answer text is correct. <br><br><h2>  Building ‚Äúregular‚Äù regular expressions </h2><br>  In many utilities, to perform load testing, in order to verify the correctness of the data obtained, it is necessary to use regular expressions.  We all know what it is, but what are ‚Äúregular‚Äù regular expressions.  This expression takes as little time as possible to find the source value. <br><br>  There are a lot of examples and articles on the Internet about the poor performance of certain regular expressions or engines on which they are used.  They describe what lazy, greedy, and super greedy quantifiers are.  Why and when it is necessary to use groupings and alternations.  How to perform instantiation to increase the speed of the regular expression engine.  I think, to whom it is important and interesting, they will be able to find information. <br><br>  I want to demonstrate why you need to build them correctly.  Take a certain sequence of requests, which at the time of recording had some kind of delay. <br><br><img src="https://habrastorage.org/web/cde/e30/f07/cdee30f07a78436cb803788f086ea1c2.png" alt="image"><br><br>  On the picture, delays are indicated by green arrows.  When executing the script, the utility must simulate the delay between requests, thereby guaranteeing the ‚Äúreal‚Äù user load. <br><br>  From the previous abazatsa we found out that it is necessary to perform control of the received data.  We do this with regular expressions.  As a result, for part of the requests, we will compose the expressions and begin the check. <br><br>  Performed checks should spend time searching for data.  As a result, we get about the following <br><br><img src="https://habrastorage.org/web/24b/c99/2e8/24bc992e845046a6a29234b84e2a1c7f.png" alt="image"><br><br>  The red arrows show some time that will be spent on the work of regular expressions. <br><br>  As a result, we see that the overall runtime of the script has already deviated a little about how, as if one user had done it.  If we consider that each virtual user must do such a check, and we have 1,000 of such running on the same computer, the processing time will increase several times.  Each virtual user will capture the resources of the operating system for calculations.  Therefore, while resources are occupied by some users, others cannot access them. <br><br>  <i>The more accurately we have a regular expression, the less time is spent on its processing, and we get a more real load on the system with a large number of virtual users</i> <br><br>  Of course, for many, the use of regular expressions, and even more so their ‚Äúcorrect‚Äù version is not required.  But if you want to bring your test closer to the more realistic conditions of execution by virtual users, then you must not forget about the speed of the service functions. <br><br><h2>  Conclusion </h2><br>  We considered three possible options that may affect the distortion of load testing results.  Of course, not all of the situations described will affect parameters such as server connection time, server response time, and other characteristics you receive. <br><br>  But in most cases, we are interested in how many real users execute a particular scenario, at what speed the server will respond to us, and how much time each user will spend on executing this scenario.  But on these parameters can look at the points reviewed. <br><br>  The server's response time to a request from you can be several milliseconds.  With a larger volume of data received and processing them, the execution time of the entire script can be delayed for several minutes, which is sometimes not acceptable for customers of such a test. <br><br>  <b>Update: we</b> finish the preparation in the <a href="https://habrahabr.ru/post/336104/">article</a> </div><p>Source: <a href="https://habr.com/ru/post/333504/">https://habr.com/ru/post/333504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333494/index.html">How to test SMS distribution</a></li>
<li><a href="../333496/index.html">Australian government hints at a possible ban on end-to-end encryption</a></li>
<li><a href="../333498/index.html">The book "Hitchhiker's Guide to Python"</a></li>
<li><a href="../333500/index.html">How we decided to build CosmoZoo</a></li>
<li><a href="../333502/index.html">Automatic serialization of Java objects in ASN.1</a></li>
<li><a href="../333506/index.html">CSS is not black magic</a></li>
<li><a href="../333510/index.html">Paradigm - Mail.Ru Group design system, part 1: visual language</a></li>
<li><a href="../333512/index.html">Let's Encrypt: distribute video over HTTPS in one click</a></li>
<li><a href="../333514/index.html">Apply Fourier transform to create a guitar tuner on Android. Part 1</a></li>
<li><a href="../333518/index.html">React Native from the bell tower of Android development part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>