<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Study of the safety of the transport system of Tbilisi - or how to ride a vehicle and earn money</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Immediately I hasten to warn you that there is no analogue in Georgia to Article 327 of the Criminal Code of the Russian Federation, therefore all act...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Study of the safety of the transport system of Tbilisi - or how to ride a vehicle and earn money</h1><div class="post__text post__text-html js-mediator-article">  <i>Immediately I hasten to warn you that there is no analogue in Georgia to Article 327 of the Criminal Code of the Russian Federation, therefore all actions described here are legal until damage in the amount of&gt; 2000 GEL (~ 50,000 rubles) is caused.</i> <br><br>  It is worth noting that the idea itself was inspired by three other articles: <a href="https://habrahabr.ru/post/301832/">"Troika"</a> , <a href="https://habrahabr.ru/post/324040/">"Plantain"</a> , <a href="https://habrahabr.ru/post/325776/">"Sitikard</a> . <a href="https://habrahabr.ru/post/325776/">"</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d37/1d7/556/d371d7556528d542146e668fbe32d040.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The transport system in Tbilisi is somewhat different from the usual for residents of Russia.  Here you will not see trams or trolley buses.  There is only a bus, subway, taxi and cable car.  The first and second will cost you 50 tetri (~ 12.5 rubles), a shuttle bus - 80 tetri, and a cable car - 2 or 3 lari.  All this transport can be paid by Metromoney card. <br><a name="habracut"></a><br>  Proxmark3 was used to examine the map.  First of all, we define the type of rfid-tag: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b7/464/563/5b74645634be59ce71b2c30b2c9b2622.jpg" alt="image"><br><br>  As you can see, this is mifare classic 1k with a 4-byte uid.  Proxmark supports three types of attacks on mifare classic: darkside, nested and hard nested.  This card is vulnerable to all three, in contrast to the known to us "Troika" and "Plantain".  This attack has long been known, it was described back in <a href="https://www.cosic.esat.kuleuven.be/rfidsec09/Papers/mifare_courtois_rfidsec09.pdf">2009</a> . <br><br>  The next step is to check the map with a set of standard keys: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c38/686/661/c3868666146ee733e6d5e47749a60984.jpg" alt="image"><br><br>  As a result, we find the standard key - <i>FFFFFFFFFFFFF</i> .  Then go to the most nested attack: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/37b/f3a/09d/37bf3a09d068681cfdcc5f7b12c88b78.jpg" alt="image"><br><br>  In response, we get a key card that we needed.  As we remember, in the previous three publications, the authors used a replay attack due to encryption, but turn our attention to the data structure here using <a href="https://play.google.com/store/apps/details%3Fid%3Dde.syss.MifareClassicTool%26hl%3Den">MCT</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26c/330/bbf/26c330bbf8dd8c84121ebfcca0f9cf37.jpg" alt="image"><br><br>  There is no encryption, it means that all we have to do is to register in the value block where the sum is 5 GEL, any amount we need (remember that&gt; 2000 GEL).  If you want to clone such a card, you need to clone uid cards, too.  its hash is stored in a separate block.  There is no online system for checking maps here, turnstiles in the metro as well as turnstiles on the cable car work offline, buses too.  Georgia is an interesting country, there are payment terminals that work with offline transport cards. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc6/9e4/4f2/dc69e44f2a5c8806d86cd0f586149a7a.jpg" alt="image"><br>  <i>In the photo the extreme right.</i>  <i>On it you can see from below a special place where you should put the rfid-tag</i> <br><br>  We can bring the card with any of our balance and, it will display it without any problems and offer to replenish it. <br><br>  There is also a small nuance here, such a card can be handed over to the cashier with the return of the entire amount on it (!) And the deposit value within 30 days from the date of purchase upon presentation of the check and the card itself. <br><br>  The article would be incomplete if I did not mention the local debit card express bank.  In my hands, quite by chance, I turned out to be a social card of a Georgian student, it looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f3/260/67b/8f326067b22f266de218381b6e8a2380.jpg" alt="image"><br><br>  The rfid tag itself is a jcop41 with mifare classic 1k emulation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/887/897/847/887897847bfd993bc3008014c5a0307f.jpg" alt="image"><br><br>  Of course, I will not pay anything with a credit card with a modified balance, because jokes with banks rarely end well, therefore, I don‚Äôt continue reading data from the card <br>  gone <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd3/56a/f62/bd356af62eddd067270f3881a170fdb5.jpg" alt="image"><br><br>  As correctly noted by the user <a href="https://habrahabr.ru/users/532cdccc1022/" class="user_link">532CDCCC1022,</a> all transport systems are to some degree unsafe.  Using decade-old solutions only makes them more vulnerable. <br><br>  <i>PS All matches are random, and these actions are perfect by some unnamed Jedi.</i> </div><p>Source: <a href="https://habr.com/ru/post/335702/">https://habr.com/ru/post/335702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335692/index.html">Colorful code: how color helps in working with code</a></li>
<li><a href="../335694/index.html">Digital agency / production performance indicators (examples from the West)</a></li>
<li><a href="../335696/index.html">The idea of ‚Äã‚Äãblack and white cinema, correct bees and unarmed ninjas in site optimization</a></li>
<li><a href="../335698/index.html">MongoDB for growth</a></li>
<li><a href="../335700/index.html">Honest realtime on React and Redux, as the basis of auto auction</a></li>
<li><a href="../335704/index.html">Mamba: open-source crypto-fiber</a></li>
<li><a href="../335706/index.html">Reducing prices for local SSD drives in ‚Äúdisplaced‚Äù instances and instances on demand</a></li>
<li><a href="../335708/index.html">5 reasons why you should build a small business - not a startup</a></li>
<li><a href="../335710/index.html">Introduction to the development of smart contracts Ethereum</a></li>
<li><a href="../335712/index.html">Python and GUI for Network Security Services command line utilities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>