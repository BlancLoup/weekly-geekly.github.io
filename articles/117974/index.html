<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jooq - ‚ÄúLINQ‚Äù for Java, a type-safe SQL query builder in Java code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, in search of a middle ground between JDBC and ORM, I came across an interesting open source library ( Apache Software License ), with which ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jooq - ‚ÄúLINQ‚Äù for Java, a type-safe SQL query builder in Java code</h1><div class="post__text post__text-html js-mediator-article">  Recently, <a href="http://stackoverflow.com/questions/5620985/is-there-any-good-dynamic-sql-builder-library-in-java">in search of</a> a middle ground between JDBC and ORM, I came across an interesting open source library ( <a href="http://en.wikipedia.org/wiki/Apache_Software_License">Apache Software License</a> ), with which you can build SQL directly in Java code quite conveniently and safely.  The library is called <a href="http://www.jooq.org/">jooq</a> .  Jooq includes a code generator that parses the structure of your database and creates the necessary Java classes.  In fact, you get something like this code: <br><br><pre><code class="java hljs">Integer taskId = sqlFactory.select(ID).from(TASK).where(STATUS.equal(TaskStatus.QUEUED)). orderBy(LAST_UPDATED).limit(<span class="hljs-number"><span class="hljs-number">1</span></span>).fetchOne(ID);</code> </pre> <br><br>  As you can see, constructing a query and its execution for simple types takes one line.  A little bit about jooq: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h2>  What is good with us? </h2><br><ul><li>  MySQL 5.1.41 / 5.5.8 support, Oracle XE 10.2.0.1.0, DB2 9.7, PostGreSQL 9.0, H2 1.3.154, HSQLDB 2.1.0, SQLite, Derby 10.7 </li><li>  Support is planned for Sybase, MSSQL, Ingres, Firebird </li><li>  Support of code generation not only for tables / fields, but also views, stored procedures, UDF, complex types like ENUM in MySQL, Blob (you can present them as ordinary byte []) </li><li>  Since the entire database schema is represented by classes, the IDE runs the completion of language constructs </li><li>  No SQL Injection vulnerability when properly used - jooq uses parameter templates in queries </li><li>  Mostly database-independent syntax </li><li>  The use of generic types provides a sufficient number of checks even when compiling the code.  Plus, it is impossible to forget to fix any piece of code if you suddenly renamed a column in the database table.  After re-parsing the database, the incorrect code will simply not compile. </li><li>  Basic support for ActiveRecord (the record obtained from the database can be changed and written back with one or two lines) </li><li>  Support not only SELECT queries, but also INSERT, UPDATE. </li><li>  Support for subqueries, arbitrary fields, aggregate functions, UNION queries, arithmetic and other operations </li><li>  Convenient methods for retrieving query results are fetch (), fetchAny (), fetchLazy (), fetchMap (), and others. </li><li>  Good support for <a href="http://www.slf4j.org/">SLF4J</a> , including for profiling Jooq internal device. </li><li>  <a href="https://sourceforge.net/apps/trac/jooq/roadmap">Lots of things planned</a> </li><li>  The author is constantly on the Internet, very promptly answers questions in the <a href="http://groups.google.com/group/jooq-user">jooq Google Group</a> and on <a href="https://sourceforge.net/apps/trac/jooq/report">tickets in the bug tracker</a> . </li><li>  <a href="http://maven.apache.org/">Maven</a> support.  The jooq distributions are available through <a href="http://maven.apache.org/guides/mini/guide-central-repository-upload.html">Maven Central</a> . </li><li>  Support for both DSL syntax <em>(select (). From (). Where ())</em> query construction and OOP <em>(a = new Query (); a.addSelect (); a.addFrom ())</em> </li><li>  The query results and the query objects themselves are serializable. </li></ul><br><h2>  What's wrong with us? </h2><br><ul><li>  <a href="https://sourceforge.net/apps/trac/jooq/ticket/420">There is no</a> direct support for some specific language features like ‚ÄúFOR UPDATE‚Äù or ‚Äúindex usage hints‚Äù constructions in SELECT.  But there is a <a href="https://groups.google.com/forum/">workaround</a> . </li><li>  If you work in one class with more than one table, import static in some cases is difficult to use, which leads to some complication of the query's appearance (an example in relation to what is shown above): </li></ul><br><pre> <code class="java hljs">Integer taskId = sqlFactory.select(Task.ID).from(Task.TASK).where(Task.STATUS.equal(TaskStatus.QUEUED)). orderBy(Task.LAST_UPDATED).limit(<span class="hljs-number"><span class="hljs-number">1</span></span>).fetchOne(Task.ID);</code> </pre><br><ul><li>  A small overhead in the execution of requests and bypassing the result (I think it is small, maybe tens or hundreds of microseconds, maybe?) </li><li>  <a href="https://sourceforge.net/apps/trac/jooq/ticket/416">There is no</a> direct support for LAST_INSERT_ID () in MySQL <a href="https://sourceforge.net/apps/trac/jooq/ticket/416">yet</a> .  But there is a <a href="https://groups.google.com/d/topic/jooq-user/bCTfnqnS1zU/discussion">workaround</a> .  Sequences are <a href="http://sourceforge.net/apps/trac/jooq/wiki/Manual/META/SEQUENCE">supported</a> . </li></ul><br><br><h2>  Subjectivity </h2><br><ul><li>  There is no code on GitHub;), the main development is in Subversion </li><li>  SourceForge project pages slightly slow down, which is a bit annoying. </li><li>  The manual seems to be quite detailed, but some simple but useful things are missing in it.  It also seemed to me not very convenient.  It describes only the most basic without "chips", "buns" and convenience.  However, if you have a great Java experience, you probably can get to everything quickly.  In addition, it seemed to me that it was not very well structured.  Information on it is spread.  I'm always in a hurry and a good manual for me must-have ... </li><li>  Not very convenient syntax for working with aggregated fields (in any case, I haven‚Äôt yet figured out how to do this conveniently) </li></ul><br><pre> <code class="java hljs">Field&lt;Integer&gt; jobTypeCountField = Job.JOBTYPE_ID.count().as(<span class="hljs-string"><span class="hljs-string">"JOBTYPE_ID_COUNT"</span></span>); Result&lt;Record&gt; jobTypeCountRecord = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; jobTypeCountRecord = sqlFactory.select(Job.JOBTYPE_ID, jobTypeCountField).from(Job.JOB) .where(Job.STATUS.equal(JobStatus.EXECUTING)).groupBy(Job.JOBTYPE_ID).fetch(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Record record : jobTypeCountRecord) { System.out.println(record.getValue(Job.JOBTYPE_ID) + <span class="hljs-string"><span class="hljs-string">" - "</span></span> - record.getValue(jobTypeCountField)); }</code> </pre><br><br>  However, opinions on this subject may be different.  Someone such code will seem more understandable. <br><ul><li>  In version 2.0 <a href="https://sourceforge.net/apps/trac/jooq/query%3Fstatus%3Dassigned%26amp%3Bstatus%3Dnew%26amp%3Bstatus%3Daccepted%26amp%3Bstatus%3Dreopened%26amp%3Bgroup%3Dstatus%26amp%3Bmilestone%3DVersion%2B2.0%2BThe%2Bfar%2Baway%2Bfuture">very interesting buns are</a> planned. </li><li>  Non-wiki documentation (Trac) and not very convenient navigation.  However, there is enough javadoc in the code to understand everything by Ctrl-Q.  However, I just think the Trac is not very convenient, so I find fault ... </li><li>  While a <a href="https://sourceforge.net/projects/jooq/files/Release/stats/timeline%3Fdates%3D2011-01-01%2Bto%2B2011-04-22">relatively</a> <a href="http://stackoverflow.com/questions/5625832/java-jooq-persistence-framework-performance-and-feed-back">small</a> number of users. </li></ul><br><br><h2>  Jooq <a href="http://stackoverflow.com/questions/5620985/is-there-any-good-dynamic-sql-builder-library-in-java">analogs</a> </h2><br><ul><li>  <a rel="nofollow" href="http://www.querydsl.com/">Querydsl</a> </li><li>  <a rel="nofollow" href="https://github.com/fuzzylollipop/sqlck">SQL Construction Kit</a> (documentation for it could not be found) </li></ul><br><br><h2>  More analogues, a slightly different plan. </h2><br><ul><li>  <a href="http://en.wikipedia.org/wiki/Java_Persistence_Query_Language">JPQL</a> </li><li>  <a href="http://www.h2database.com/html/jaqu.html">Jaqu</a> </li><li>  <a href="http://docs.jboss.org/hibernate/core/3.3/reference/en/html/queryhql.html">HQL</a> </li></ul><br><br><h2>  Contacts: </h2><br><ul><li>  Project site - <a href="http://www.jooq.org/">http://www.jooq.org</a> </li><li>  Manual: <a href="http://sourceforge.net/apps/trac/jooq/wiki/Manual">http://sourceforge.net/apps/trac/jooq/wiki/Manual</a> </li><li>  Forum - <a href="http://groups.google.com/group/jooq-user">http://groups.google.com/group/jooq-user</a> </li><li>  SVN Info: <a href="https://sourceforge.net/scm/%3Ftype%3Dsvn%26amp%3Bgroup_id%3D283484">https://sourceforge.net/scm/?type=svn&amp;group_id=283484</a> </li></ul><br><br><h2>  Some examples from Jooq source (work with MySQL information_schema database) </h2><br><br>  Perhaps examples are better to look <a href="http://ru.fractalizer.ru/frpost_178/jooq-linq-%25D0%25B4%25D0%25BB%25D1%258F-java-%25D1%2582%25D0%25B8%25D0%25BF%25D0%25BE%25D0%25B1%25D0%25B5%25D0%25B7%25D0%25BE%25D0%25BF%25D0%25B0%25D1%2581%25D0%25BD%25D1%258B%25D0%25B9-%25D0%25BF%25D0%25BE%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C-sql/">here</a> with syntax highlighting from Geshi. <br><br><pre> <code class="java hljs"> select(KeyColumnUsage.CONSTRAINT_NAME, KeyColumnUsage.TABLE_NAME, KeyColumnUsage.COLUMN_NAME) .from(KEY_COLUMN_USAGE).join(TABLE_CONSTRAINTS) .on(KeyColumnUsage.TABLE_SCHEMA.equal(TableConstraints.TABLE_SCHEMA)) .and(KeyColumnUsage.TABLE_NAME.equal(TableConstraints.TABLE_NAME)) .and(KeyColumnUsage.CONSTRAINT_NAME.equal(TableConstraints.CONSTRAINT_NAME)) .where(TableConstraints.CONSTRAINT_TYPE.equal(constraintType)) .and(KeyColumnUsage.TABLE_SCHEMA.equal(getSchemaName())) .orderBy(KeyColumnUsage.TABLE_NAME.ascending(), KeyColumnUsage.ORDINAL_POSITION.ascending()).fetch()</code> </pre><br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Record record : create().select( ReferentialConstraints.CONSTRAINT_NAME, ReferentialConstraints.TABLE_NAME, ReferentialConstraints.REFERENCED_TABLE_NAME, ReferentialConstraints.UNIQUE_CONSTRAINT_NAME, KeyColumnUsage.COLUMN_NAME) .from(REFERENTIAL_CONSTRAINTS) .join(KEY_COLUMN_USAGE) .on(ReferentialConstraints.CONSTRAINT_SCHEMA.equal(KeyColumnUsage.CONSTRAINT_SCHEMA)) .and(ReferentialConstraints.CONSTRAINT_NAME.equal(KeyColumnUsage.CONSTRAINT_NAME)) .where(ReferentialConstraints.CONSTRAINT_SCHEMA.equal(getSchemaName())) .orderBy( KeyColumnUsage.CONSTRAINT_NAME.ascending(), KeyColumnUsage.ORDINAL_POSITION.ascending()) .fetch()) { String foreignKey = record.getValue(ReferentialConstraints.CONSTRAINT_NAME); String foreignKeyColumn = record.getValue(KeyColumnUsage.COLUMN_NAME); String foreignKeyTableName = record.getValue(ReferentialConstraints.TABLE_NAME); String referencedKey = record.getValue(ReferentialConstraints.UNIQUE_CONSTRAINT_NAME); String referencedTableName = record.getValue(ReferentialConstraints.REFERENCED_TABLE_NAME); TableDefinition foreignKeyTable = getTable(foreignKeyTableName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foreignKeyTable != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { ColumnDefinition column = foreignKeyTable.getColumn(foreignKeyColumn); String key = getKeyName(referencedTableName, referencedKey); relations.addForeignKey(foreignKey, key, column); } }</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/117974/">https://habr.com/ru/post/117974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117969/index.html">Enlarge your disk now</a></li>
<li><a href="../117970/index.html">Why do discount card systems die?</a></li>
<li><a href="../117971/index.html">About Google and Microsoft Understanding</a></li>
<li><a href="../117972/index.html">Beeline, reset the DNS cache!</a></li>
<li><a href="../117973/index.html">Introduction to the Pantheios Logging Library</a></li>
<li><a href="../117975/index.html">A calendar that understands you</a></li>
<li><a href="../117977/index.html">MobTop - mobile site traffic analysis tool</a></li>
<li><a href="../117979/index.html">Canobuvosti, 88th edition</a></li>
<li><a href="../117980/index.html">The PSM (zero) project is complete and needs you</a></li>
<li><a href="../117988/index.html">About color matching information in web development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>