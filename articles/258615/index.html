<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pulse sensor device Part 2 - Sensors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article you will learn about several details that need to be paid attention to when designing photoplethysmograph sensors. 

 Introduction 
 I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pulse sensor device Part 2 - Sensors</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f33/7d1/3ee/f337d13ee01f45f485855bb583c06f58.jpg"><br><br>  In this article you will learn about several details that need to be paid attention to when designing photoplethysmograph sensors. <br><a name="habracut"></a><br><h3>  Introduction </h3><br>  In the previous article you got acquainted with the design of the <a href="http://habrahabr.ru/post/258115/">sensor measuring the pulsogram</a> .  Today I will share some ideas that may be useful in choosing the element base of the plethysmograph and developing its electrical circuit.  They will help to improve the quality of the useful signal, which is primarily influenced by the following factors: <br><br><ul><li>  lack of artifacts; </li><li>  the presence of a pronounced pulse wave at the point of registration; </li><li>  sensitive element design. </li></ul><br>  <i>An artifact is a non-useful component of a change in the waveform, spectrally and amplitudely similar to it.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are several sources of artifacts: <br><br><ul><li>  the movement of the person using the photoplethysmograph, the relative source of illumination, natural or artificial, for example, the movement of the sun shade during sports activities; </li><li>  moving the light source relative to a person or changing the brightness of that source.  For example, flickering fluorescent lamps; </li><li>  non-pulse movements of body parts causing movements of the photoplethysmograph or points of the body in the place where the sensitive element is installed.  For example, movements of the bones of the forearm that occur when moving with your fingers, movements of the bones of the head associated with speech and facial expressions. </li></ul><br>  In addition to artifacts, the quality of pulse measurement depends on the severity of the pulse wave.  For the same person, the pulse can be very good and very bad.  For example, I have watched a change in the pulse many times during a three-hour computer psycho-physiological testing.  Pulsogram was measured from the earlobe.  At the same time, the signal deteriorated over time.  This could happen quite quickly - in half an hour, and is connected, presumably, with the fact that the ear clip degrades the blood flow, as well as with the forced immobility of the subject. <br><br>  A similar situation is observed when measuring the pulse from the phalanx of the finger.  A change in temperature in a room or a slight change in a person‚Äôs posture and the resulting shift of the registration point by a small distance can lead to a decrease in the signal level or even to its disappearance. <br><br>  When measuring the pulse from the temple, the problem of lack of signals is exacerbated.  The area of ‚Äã‚Äãthe temple is larger than the area of ‚Äã‚Äãthe finger, it is more difficult to find the point at which the pulse is better manifested, and there is a greater chance that the user will put the sensor on incorrectly. <br><br><h3>  Multichannel Sensors </h3><br>  To solve the described problem, the principle common in engineering can be applied - duplication, which in this case implies the use of a sensor with several sensitive elements.  A schematic diagram that implements such an idea is shown in the following figure. <br><br><img src="https://habrastorage.org/files/8cd/f4b/991/8cdf4b991c994fca97ceab721b431661.jpg"><br><br>  I foresee skeptical thoughts of readers about parallel-on LEDs.  I ask you not to judge strictly, since this is a prototype, which should not have been operated for a long time. <br><br>  The LEDs and phototransistors on the PCB are arranged in pairs.  The size of the board is chosen so as to overlap the entire area of ‚Äã‚Äãthe temple, this allows you to have a gain and filtering circuit in the same place.  The board may contain holes for attachment to the tape.  The appearance of the sensor with nine sensitive elements is presented in the following figure. <br><br><img src="https://habrastorage.org/files/b39/c98/3f3/b39c983f31de417985e9557b67538692.jpg"><br><br>  A similar solution can be applied to measure the pulse from a finger or wrist.  Below is a diagram of a sensor consisting of four phototransistors and one LED. <br><br><img src="https://habrastorage.org/files/6d2/b0d/f02/6d2b0df023894bf589c6f0153d0a9029.jpg"><br><br>  Phototransistor emitters may not be connected, and then the signals from each of them are measured independently, in which case a special multi-channel measuring device is required.  Multi-channel execution can also be useful for eliminating artifacts.  If an artifact occurs only in the region of a single photocell, it is fixed and not taken into account in the overall measurement pattern.  However, the use of such a scheme is not always convenient, since it leads to an increase in size.  It is quite another thing if you connect the photosensitive elements in parallel.  In this case, only one measuring channel is required.  The following figure shows a prototype of such a sensor.  It works according to the ‚Äúreflection‚Äù scheme.  The LED is located in the center, and the phototransistors are on the edges.  The sensor can be used to record a pulsogram with a phalanx of a finger or wrist.  The printed circuit board is divorced so as to be able to connect phototransistors to multichannel or single-channel versions. <br><br><img src="https://habrastorage.org/files/2f0/7a4/c7d/2f07a4c7d3024d4f90f38f9c284359f1.jpg"><br><br><h3>  Compounding </h3><br>  For better fixation of photocells, the surface of the printed circuit board can be filled with compound.  For the fill is made a special form, which you also see in the picture.  To the compound does not stick to the form, it is better to make it from fluoroplastic.  If the form is made of a different material, for example, of metal, then before pouring the compound, it should be smeared with a special compound.  If such a composition is not available, suitable petroleum jelly.  You should also carefully choose the compound, as the wrong composition can deform the elements during curing. <br><br>  In addition to fixing the compound performs the role of a light filter.  Epoxy compounds with dyes are suitable for this purpose.  For example, the compound ‚ÄúEpoxicon‚Äù manufactured by SPbGTI can be used. <br><br>  An alternative to compounds can make solid filters.  They closely adjoin to the printed circuit board, and for LEDs and phototransistors grooves are made with a cutter or laser.  The following figure shows a sensor with elements covered with a milled plate. <br><br><img src="https://habrastorage.org/files/fab/7b7/275/fab7b72758a04de2bb65257a10a3ad07.jpg"><br><br>  Existence of the light filter allows to minimize the artifacts created by external light sources.  The following image shows the appearance of the optical compounds before and after curing. <br><br><img src="https://habrastorage.org/files/8da/eb2/5f4/8daeb25f41ed4498bd76ed7a58fb6622.jpg"><br><br>  Photos from <a href="http://www.lfpti.ru/labsamples.htm">this site</a> <br><br><h3>  Features of the choice of phototransistors and LEDs </h3><br>  To register a pulse wave, photosensitive elements are used - photodiodes or phototransistors.  This article deals only with phototransistors.  Because at the time of my beginning of work in this direction, there were already dozens of different transistor sensors (clips, clothespins and napalechnikov) on their hands, and there were also well-established circuit solutions.  The use of diodes is no worse at all and is widely used in various applications, for example, in common medical sensors of the Nellcor standard. <br><br>  When choosing phototransistors and LEDs, first of all you should pay attention to the following characteristics: <br><br><ul><li>  wavelength (maximum spectral characteristics) [nm]; </li><li>  half brightness angle for LEDs and coverage angle for phototransistors [deg.]; </li><li>  radiation intensity [mW / sr] for LEDs and sensitivity for phototransistors [mA / (mW / cm2)]; </li><li>  rated current of phototransistor and LED [mA]; </li><li>  phototransistor dark current [mA]; </li><li>  presence of lenses and light filters built into the body. </li></ul><br><br>  To measure the pulse is best suited wavelengths that are most absorbed by the blood.  These are waves corresponding to the green color of 530 nm.  Red and infrared bands are also used.  I highly recommend an <a href="http://geektimes.ru/company/darta_systems/blog/246856/">interesting article on giktime</a> with the classification of methods for measuring the pulse, in the same place you will learn about the absorption spectrum of hemoglobin. <br><br>  When choosing photocells, you should pay attention to the presence of lenses and light filters that allow you to achieve the desired angle of half brightness and coverage, and, therefore, be less sensitive to radiation from other sources.  Built-in filters allow you to work only in the selected spectral range.  If you choose a LED with a large angle of half brightness and a phototransistor with a large angle of coverage, then the light will pass, bypassing the skin surface.  This will lead to a deterioration of the measuring range and the luminous flux modulated by the pulse wave will have almost no effect on the output signal of the measuring circuit.  This situation is illustrated in the following figure. <br><br><img src="https://habrastorage.org/files/75e/661/cee/75e661cee9e347deb28c45e18d14f76f.jpg"><br><br>  Angle a2 is valid, and angle a1 is too big to use an LED with that angle in the pulse measurement device.  This example refers to the case of the measurement of the pulse "on reflection".  The choice of an LED with a high angle of half brightness in devices that work "in the light" will lead to the fact that a large radiation power will pass by the photodetector.  This is undesirable, especially in mobile devices. <br><br>  Attention should also be paid to the radiation intensity of the LED, measured in milliwatts per steradian [mW / sr].  In documents for LEDs, it is usually indicated at currents of 20, 100 and 1000 mA.  To save energy, it is better to choose the LEDs, in which this characteristic is higher with the same consumed current.  Attention should be paid to the photoelectric current of the phototransistor; the larger its value, the better.  The last two characteristics are related.  As a result, the minimum expected signal level should be at least several times higher than the expected noise level in the measuring device. <br><br>  LEDs and phototransistors are often sold in pairs that are structurally and spectrally suitable for each other.  The table shows the characteristics of several pairs of LEDs and phototransistors.  Pairs in lines 2 and 3 are not suitable for use in heart rate monitors due to the large angle and low radiation power.  Couples 1, 4 and 5 are suitable, with the first pair best suited.  This was confirmed by testing.  All other things being equal, the best signal of the pulsogram was taken using the first pair.  It should be noted that if an opaque barrier is placed between the LED and the phototransistor, then the radiation angle and sensitivity will not so much influence the quality of the pulse measurement. <br><br><table><tbody><tr><td>  Mark <br>  transistor <br>  -diode </td><td>  Angle of coverage and angle of half brightness <br>  [hail] </td><td>  Wavelength <br>  [nm] </td><td>  Radiation intensity <br>  [mW / Wed] <br>  at current 20mA <br>  (for LEDs) </td><td>  Photoelectric current <br>  [mA] <br>  at 1 mW per cm2 <br>  (for phototransistor) </td></tr><tr><td>  VEMT2020X01 <br>  VSMB2020X01 </td><td>  ¬± 15 <br>  ¬± 12 </td><td>  830-950 <br>  940 </td><td>  eight </td><td>  6 </td></tr><tr><td>  PT100MF0MP1 <br>  GL100MD1MP1 </td><td>  ¬± 15 <br>  ¬± 80 </td><td>  910 <br>  940 </td><td>  0.3 </td><td>  2 </td></tr><tr><td>  TEMT7000X01 <br>  VSMB1940X01 </td><td>  ¬± 60 <br>  ¬± 60 </td><td>  830-950 <br>  940 </td><td>  1.2 </td><td>  0.45 </td></tr><tr><td>  OP571 <br>  OP271 </td><td>  ¬± 25 <br>  ¬± 25 </td><td>  910 <br>  890 </td><td>  1.5 </td><td>  0.5 </td></tr><tr><td>  SD1440 <br>  SE1470 </td><td>  ¬± 12 <br>  ¬± 12 </td><td>  880 <br>  880 </td><td>  - </td><td>  0.14 </td></tr></tbody></table><br><br><h3>  Conclusion  Three in one </h3><br>  Instead of the conclusion I will mention the remarkable integral decision which in the comments to the previous article was brought by the habrew <a href="http://habrahabr.ru/users/valexey/" class="user_link">user valexey</a> .  We are talking about the device <a href="https://www.silabs.com/Support%2520Documents/TechnicalDocs/Si114x.pdf">Si1143</a> production Silicon Labs.  Inside it has two photodiodes - red and IR, a control unit for three LEDs, a built-in gain and filtering circuit, an ADC and an I2C serial interface module.  I will not describe other details, because I have not had time to try it out yet.  Judging by the description, this device is well suited for various measurements related to pulsometry. <br><br><h4>  PS </h4><br>  <a href="https://bitbucket.org/abrakada/pulsesensorrf">The repository</a> replenished with drawings of sensitive elements and intermediate amplifiers. </div><p>Source: <a href="https://habr.com/ru/post/258615/">https://habr.com/ru/post/258615/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258603/index.html">We select the correct Microsoft Azure services</a></li>
<li><a href="../258605/index.html">Bash state machine</a></li>
<li><a href="../258607/index.html">Krovi: Big Data - as dream. 9th series: Why IBM was forced to buy "Alchemists" for $ 100 million</a></li>
<li><a href="../258611/index.html">An example of a vector implementation of a neural network using Python</a></li>
<li><a href="../258613/index.html">Wing IDE Protection Study</a></li>
<li><a href="../258619/index.html">Homemade control unit for diesel engine</a></li>
<li><a href="../258621/index.html">DICOM Viewer from the inside. Functionality</a></li>
<li><a href="../258625/index.html">Top 10 non-cash countries of the world</a></li>
<li><a href="../258627/index.html">The digest of interesting materials for the mobile developer # 104 (on May 18-24)</a></li>
<li><a href="../258629/index.html">Refactoring database schemas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>