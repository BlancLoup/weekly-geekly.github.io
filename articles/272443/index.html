<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We are testing IBM cloud platform on the example of chat</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I happened to meet with IBM technical specialist, who told me about the capabilities of the relatively new IBM Bluemix platform, which shoul...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We are testing IBM cloud platform on the example of chat</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/f82/7af/61e/f827af61e7224974b5c3df356f37c65d.png"><br>  Recently, I happened to meet with IBM technical specialist, who told me about the capabilities of the relatively new IBM Bluemix platform, which should make life easier for the developer.  Using the example of a simple chat, I decided to check this statement. <br><hr><br><br><h3>  Prehistory </h3><br>  Previously, my experience with the platform was close to zero, so in order to understand the huge number of platform services, I again turned to my friend from IBM.  It seemed obvious to me to use the Message Hub service, but in the end it turned out that MQ Light would be better suited for solving our problem.  Main reasons: <br><ul><li>  rate in free 10 thousand messages per month </li><li>  good scalability </li><li>  easy to use API </li></ul><br><a name="habracut"></a><br><br>  We also considered the option of using the IoT Foundation service, but as it turned out, devices cannot subscribe to receive any other events except commands, and they cannot send commands themselves either.  It turns out, we can send data as we want, and receive only in the form of commands. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, let's go to the IBM Bluemix Dashboard. <br><br><h3>  We register cloud service </h3><br>  Since we don‚Äôt need any server-side wrappers for the chat, we just need to register the service and get the connection data. <br><br>  Go to the panel, click ‚ÄúUse services or APIs‚Äù: <br><img src="https://habrastorage.org/files/6b3/2c4/eff/6b32c4eff6264f3eb67b62e0360097ad.png"><br><br>  Looking for MQ Light: <br><img src="https://habrastorage.org/files/a54/2b2/2bf/a542b22bf9ff4f709063ea5f5dc44c73.png"><br><br>  And we take one such myself. <br><img src="https://habrastorage.org/files/634/e3d/d1e/634e3dd1eb2b4c25807889a60a761ef1.png"><br><br>  We return to the Dashboard, select MQ Light - Service Credentials.  We create data for authorization of our applications. <br><img src="https://habrastorage.org/files/fb9/ee4/b64/fb9ee4b6402a4c8a965530e655fa2a2f.png"><br><br>  We get: <br><img src="https://habrastorage.org/files/f17/d8a/1a1/f17d8a1a12524f2780a16d9bbf677611.png"><br>  <i>Check in advance the presence of ";" in the login and password.</i>  <i>The compiler will not like it very much, it is better to generate a new pair.</i> <br><br><h3>  Create a desktop application </h3><br>  Since we need to quickly create a working application - use Node.JS and install the MQ Light library. <br><pre><code class="hljs sql">npm <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> mqlight</code> </pre> <br><br>  ... and open our development environment.  The first step is to connect the library: <br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mqlight = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mqlight'</span></span>);</code> </pre> <br><br>  Now, to create realtime chat, we have to work with data entry from the console.  For this, the standard library from the Node.JS - readline set is perfect. <br><pre> <code class="hljs perl">var <span class="hljs-keyword"><span class="hljs-keyword">readline</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>(<span class="hljs-string"><span class="hljs-string">'readline'</span></span>);</code> </pre> <br><br>  Add some variables for MQ Light. <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> TOPIC = <span class="hljs-string"><span class="hljs-string">"mqlight/simplechat"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SHARE_ID = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> opts = { service: <span class="hljs-string"><span class="hljs-string">'connectionLookupURI'</span></span>, <span class="hljs-comment"><span class="hljs-comment">//    user: 'username', password: 'password' };</span></span></code> </pre><br><br>  And do not forget about the input / output: <br><pre> <code class="hljs vala"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rl = readline.createInterface(process.<span class="hljs-keyword"><span class="hljs-keyword">stdin</span></span>, process.<span class="hljs-keyword"><span class="hljs-keyword">stdout</span></span>);</code> </pre> <br><br>  Next, when starting, ask for a nickname and subscribe to the channel with a nickname in share id: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs lua">mqlightClient.on(<span class="hljs-string"><span class="hljs-string">'started'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { rl.question(<span class="hljs-string"><span class="hljs-string">"Please, choose your nickname: "</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(result)</span></span></span></span> { SHARE_ID = result; console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Welcome,"</span></span>, SHARE_ID, <span class="hljs-string"><span class="hljs-string">"!"</span></span>); rl.setPrompt(SHARE_ID + <span class="hljs-string"><span class="hljs-string">'&gt; '</span></span>); mqlightClient.subscribe(TOPIC, SHARE_ID, { credit : <span class="hljs-number"><span class="hljs-number">5</span></span>, autoConfirm : <span class="hljs-literal"><span class="hljs-literal">true</span></span>, qos : <span class="hljs-number"><span class="hljs-number">0</span></span>}, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) console.<span class="hljs-built_in"><span class="hljs-built_in">error</span></span>(<span class="hljs-string"><span class="hljs-string">"Failed to subscribe: "</span></span> + err); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">"Subscribed to "</span></span> + TOPIC); rl.prompt(); } }); }); });</code> </pre></div></div><br><br>  And we process the receipt of the message (the event 'message' in MQ Light) and the sending of the message (we catch the event 'line' in the readline): <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs javascript">mqlightClient.on(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, delivery</span></span></span><span class="hljs-function">) </span></span>{ data = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(data); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.id != SHARE_ID) { readline.clearLine(process.stdout, <span class="hljs-number"><span class="hljs-number">0</span></span>); rl.setPrompt(data.id + <span class="hljs-string"><span class="hljs-string">'&gt; '</span></span>); rl.prompt(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data.message + <span class="hljs-string"><span class="hljs-string">' '</span></span>); rl.setPrompt(SHARE_ID + <span class="hljs-string"><span class="hljs-string">'&gt; '</span></span>); rl.prompt(); } }); rl.on(<span class="hljs-string"><span class="hljs-string">'line'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(message != <span class="hljs-string"><span class="hljs-string">""</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: SHARE_ID, <span class="hljs-attr"><span class="hljs-attr">message</span></span>: message }); mqlightClient.send(TOPIC, data, { <span class="hljs-attr"><span class="hljs-attr">ttl</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">1000</span></span> }); rl.prompt(); } });</code> </pre></div></div><br><br>  The application is ready.  At startup, it will try to connect to the IBM servers, then ask the nickname, and subscribe to the / mqlight / simplechat channel with the nickname as the SHARE ID.  All it took was just 64 lines!  It seems a very good result for one evening. <br><br><h3>  Testing </h3><br>  Check if everything works: <br><img src="https://habrastorage.org/files/8c1/365/0be/8c13650be4e04e01bf02cdf9540f762a.png"><br><br>  Profit!  And this is how it looks in the control panel: <br><img src="https://habrastorage.org/files/90a/004/25d/90a00425d3a0492ebbc4f00fb1442dda.png"><br><br><h3>  Conclusion </h3><br>  Now about the results. <br><ul><li>  64 lines of code </li><li>  Following the instructions to create a chat will take 20-30 minutes </li><li>  Platform services reduce ~ 40% of the time, given that you need to raise the server, write code for the backend </li><li>  An additional plus, the data is transmitted in encrypted form out of the box, using TLS </li></ul><br><br>  So, we solved the task: to create a chat with minimal resources, in just one evening.  With IBM Bluemix, you can quickly create applications of any complexity using a variety of ready-made services and APIs.  Well, cloud technologies are evolving, and in the future the work of a programmer can become much simpler and more interesting, but what do you think? </div><p>Source: <a href="https://habr.com/ru/post/272443/">https://habr.com/ru/post/272443/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272429/index.html">Moore's Law and Storage Technology</a></li>
<li><a href="../272431/index.html">Mobile search inside apps ... which you don't have!</a></li>
<li><a href="../272433/index.html">Software overview and demonstration - HP ONE VIEW and HP Data Protector</a></li>
<li><a href="../272435/index.html">Review of Managing HP 3PAR StoreServ technologies in the MUK classroom</a></li>
<li><a href="../272441/index.html">12 tips for those who want to get a PMP certificate (Project Management Professional)</a></li>
<li><a href="../272447/index.html">collectd + front-end</a></li>
<li><a href="../272449/index.html">Developed by Mithril. Practice, experience and pitfalls</a></li>
<li><a href="../272451/index.html">Creators of ransomware and fraudulent tech support sites are combined</a></li>
<li><a href="../272455/index.html">Presentation of the program settings in 1C. One of the methods</a></li>
<li><a href="../272457/index.html">Announced the start of acceptance of works at the symposium CTCrypt'2016</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>