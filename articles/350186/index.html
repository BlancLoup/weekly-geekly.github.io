<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What I miss from Rust in C</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About the author. Federico Mena-Quintero is a Mexican programmer, one of the founders of the GNOME project . 

 Librsvg has reached a turning point: i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What I miss from Rust in C</h1><div class="post__text post__text-html js-mediator-article">  <i><font color="gray">About the author.</font></i>  <i><font color="gray">Federico Mena-Quintero is a Mexican programmer, one of the founders of the GNOME project</font></i> . <br><br>  Librsvg has reached a turning point: it suddenly turns out that it is easier to port some of the main parts of C to Rust than to just add accessors.  In addition, more and more "meat" of the library is now written in Rust. <br><br>  Now I often have to switch between two languages, and C now looks very, very primitive. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Elegy C </h1><br>
   C  24  .      <a href="https://en.wikipedia.org/wiki/The_C_Programming_Language">‚ÄúThe C Programming Language by K&amp;R‚Äù</a>    .       Turbo Pascal,      ,   C     .<br>
<br>
K&amp;R&nbsp;‚Äî     <i></i>  .         <code>malloc()/free()</code>,   .        !<br>
<br>
      C.       . ,      Unix  20&nbsp;000     .<br>
<a name="habracut"></a><br>
GIMP  GTK+       . GNOME ,       .  ,     20&nbsp;000   C         .<br>
<br>
      .     <i></i>      .<br>
<br>
<h3>     C</h3><br>
    POV-Ray        .<br>
<br>
  GTK+      ,    .<br>
<br>
  SIOD,    Guile ‚Äî  ,   Scheme    C.<br>
<br>
   Eye of GNOME    .<br>
<br>
<h3> </h3><br>
   Evolution   .      Solaris      Purify;    Valgrind.<br>
<br>
   gnome-vfs.<br>
<br>
  Mesa.<br>
<br>
   Nautilus-share  ,       <code>free()</code>.<br>
<br>
  ,         .<br>
<br>
    ,       .<br>
<br>
 ,  -     Rust,      C.<br>
<br>
<h1>  </h1><br>
   ,     Rust,   <a href="http://blog.skylight.io/rust-means-never-having-to-close-a-socket/">¬´ Rust     ¬ª</a>. Rust   C++:   <a href="http://wiki.c2.com/%3FResourceAcquisitionIsInitialization">¬´   ¬ª (RAII)</a>,  ,         ,       .<br>
<br>
<ul>
<li>:     <code>free()</code>.  ,  ,     .     ,    <a href="https://doc.rust-lang.org/book/second-edition/ch15-03-drop.html">Drop</a>,     .       ,         .</li>
<li>:   ( ,  ,    ..)     .    :      .           .</li>
</ul><br>
   //  C ,  ,      ,     (  <i></i>,  )‚Ä¶ ,      .<br>
<br>
<h1> ( )</h1><br>
<code>Vec&lt;T&gt;</code>    ,     <code>T</code>.        .   <i></i>  ,       <code>T</code>.<br>
<br>
     C   ‚Ä¶     .<br>
<br>
<h1> () ‚Äî   </h1><br>
<a href="https://doc.rust-lang.org/book/second-edition/ch17-00-oop.html">Rust ‚Äî   Java- - </a>.      ,       Java ‚Äî    :     <code>Drawable</code>,       <code>draw ()</code>.<br>
<br>
     .<br>
<br>
<h3> </h3><br>
<a href="https://doc.rust-lang.org/book/second-edition/ch19-03-advanced-traits.html">     () </a>. ,  <code>Iterator</code>    :<br>
<br>
<pre><code class="rust">pub trait Iterator {
    type Item;
    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt;;
}</code></pre><br>
 ,      <code>Iterator</code>  -       <code>Item</code>   .   <code>next()</code>     ,    <code>Some(YourElementType)</code>.     ,    <code>None</code>.<br>
<br>
     <i></i> .<br>
<br>
,  Rust     <code>for</code> ,    <code>IntoIterator</code>:<br>
<br>
<pre><code class="rust">pub trait IntoIterator {
    /// The type of the elements being iterated over.
    type Item;

    /// Which kind of iterator are we turning this into?
    type IntoIter: Iterator&lt;Item=Self::Item&gt;;

    fn into_iter(self) -&gt; Self::IntoIter;
}</code></pre><br>
        <code>Item</code>  ,   <code>IntoIter</code>&nbsp;‚Äî    <code>Iterator</code>,    .<br>
<br>
     ,     .      ¬´   foo  bar,     ,     ¬ª.<br>
<br>
<h1></h1><br>
    <a href="https://people.gnome.org/~federico/blog/rant-on-string-slices.html">    C</a>   ,   ,    .<br>
<br>
<h1>    </h1><br>
 :<br>
<br>
<ul>
<li> <code>pkg-config</code>      Autotools.</li>
<li>    include   ...</li>
<li>‚Ä¶   .</li>
<li> ,       .</li>
</ul><br>
    <code>Cargo.toml</code>,        .   c       .<br>
<br>
     .      <code>cargo build</code>.<br>
<br>
<h1></h1><br>
 -  C     :<br>
<br>
<ul>
<li>   .  ,        ,   .      <code>#include</code>      ,    <code>#ifdef</code>       .</li>
<li>   Makefile,        ,   ,     .</li>
<li>    .   . <i></i> .</li>
</ul><br>
 Rust        :<br>
<br>
<pre><code class="rust">#[test]
fn test_that_foo_works() {
    assert!(foo() == expected_result);
}</code></pre><br>
‚Ä¶    <code>cargo test</code>,    .       .          Makefile,  ,      .<br>
<br>
    -.<br>
<br>
<h1>  </h1><br>
Rust       Markdown.    <i>  </i>.      <i></i>   :<br>
<br>
<pre><code class="rust">/// Multiples the specified number by two
///
/// ```
/// assert_eq!(multiply_by_two(5), 10);
/// ```
fn multiply_by_two(x: i32) -&gt; i32 {
    x * 2
}</code></pre><br>
   <i>   </i>  ,     .<br>
<br>
<b> 23.02.2018</b>: QuietMisdreavus , <a href="https://quietmisdreavus.net/code/2018/02/23/how-the-doctests-get-made/"> rustdoc  doctests   </a>.       .<br>
<br>
<h1> </h1><br>
 Rust   ,          C.         ,   <code>max (5 + 3, 4)</code>  .<br>
<br>
<h1>  </h1><br>
    C, -  <code>int</code>    <code>short</code>, <code>char</code>  -  ‚Äî Rust   .    .<br>
<br>
<h1>  </h1><br>
 .<br>
<br>
<h1> ,   Rust   </h1><br>
 Rust    ,    ¬´ Rust¬ª (  ,      <code>unsafe {}</code>)    .   <code>&gt;&gt;</code>    &nbsp;‚Äî     .<br>
<br>
<h1> </h1><br>
   <code>gcc</code>,   <code>switch()</code>   enum,    ?    .<br>
<br>
   Rust  <a href="https://doc.rust-lang.org/book/second-edition/ch18-03-pattern-syntax.html"> </a>.         <code>match()</code>.    ,      :<br>
<br>
<pre><code class="rust">impl f64 {
    pub fn sin_cos(self) -&gt; (f64, f64);
}

let angle: f64 = 42.0;
let (sin_angle, cos_angle) = angle.sin_cos();</code></pre><br>
  <code>match()</code>  .     .<br>
<br>
<pre><code class="rust">let color = "green";

match color {
    "red"   =&gt; println!("it's red"),
    "green" =&gt; println!("it's green"),
    _       =&gt; println!("it's something else"),
}</code></pre><br>
  ?<br>
<br>
<pre><code>my_func(true, false, false)</code></pre><br>
      ,   :<br>
<br>
<pre><code class="rust">pub struct Fubarize(pub bool);
pub struct Frobnify(pub bool);
pub struct Bazificate(pub bool);

fn my_func(Fubarize(fub): Fubarize, 
           Frobnify(frob): Frobnify, 
           Bazificate(baz): Bazificate) {
    if fub {
        ...;
    }

    if frob &amp;&amp; baz {
        ...;
    }
}

...

my_func(Fubarize(true), Frobnify(false), Bazificate(true));</code></pre><br>
<h1>,   </h1><br>
    .   boolean   ,    ,      .<br>
<br>
<h1>#[derive(Debug)]</h1><br>
    (,    ),   <code>#[derive(Debug)]</code>&nbsp;‚Äî  Rust  ,        .      ,      gdb     .<br>
<br>
<h1></h1><br>
        <code>user_data</code>.<br>
<br>
<h1></h1><br>
     <a href="https://doc.rust-lang.org/book/second-edition/ch16-00-concurrency.html">  ¬´ ¬ª</a>,         . ,       ,     .<br>
<br>
C ‚Äî         .         Unix,      .       .<br>
<br>
Rust  ,    . ,      ,   . ,     ,           .</div><p>Source: <a href="https://habr.com/ru/post/350186/">https://habr.com/ru/post/350186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350176/index.html">Who needs an architect?</a></li>
<li><a href="../350178/index.html">The obvious benefit: how and why to use the service approach beyond IT (Part 3)</a></li>
<li><a href="../350180/index.html">The Internet of Things: From Designing a Backend to Energy Absorption</a></li>
<li><a href="../350182/index.html">Experience of using the Puniverse Quasar library for actors</a></li>
<li><a href="../350184/index.html">Crash Course on Docker: Learn to swim with big fish</a></li>
<li><a href="../350188/index.html">ASP.NET Core: Attack Prevention Mechanisms 2.0</a></li>
<li><a href="../350192/index.html">Deep learning in the cloud: optical computers will replace the GPU</a></li>
<li><a href="../350194/index.html">Antivirus usability on the phone</a></li>
<li><a href="../350198/index.html">Basics of cryptography. Part 0</a></li>
<li><a href="../350200/index.html">Monitoring system organization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>