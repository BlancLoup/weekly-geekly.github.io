<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We get our neighbor's Wi-Fi using standard MacOS tools.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have always been a fan of bugs and vulnerabilities "on the surface", I have always envied dudes who write exploits for the most protected operating ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We get our neighbor's Wi-Fi using standard MacOS tools.</h1><div class="post__text post__text-html js-mediator-article">  I have always been a fan of bugs and vulnerabilities "on the surface", I have always envied dudes who write exploits for the most protected operating systems, and I could only use scripts (the term from zero).  However, my <a href="https://habrahabr.ru/post/70330/">post</a> about vulnerabilities in version control systems scored more than 1000 likes on Habr√© and <a href="https://habrahabr.ru/top/alltime/">remains the top1</a> post in the entire history of Habr, despite the fact that it was written 9 (!) Years ago. <br><br>  And today I would like to show and tell on the fingers about such a thing as wardriving.  Or rather, using standard MacOS tools, you can get passwords from Wi-Fi neighbors.  The difficult one threw me into another apartment.  Somehow, historically, I'm lazy.  A couple of years ago, I already wrote that my laziness, the new apartment and the wire of Beeline (formerly Corbina) helped me <a href="https://habrahabr.ru/post/243997/">find a bug in Beeline</a> and have free internet on their network.  "Today" is happening "like", I am at a new apartment, there is not even a wire, but neighbors have many networks. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u8/1s/nd/u81sndgaeoykwwl1i83jbb37kz4.png" width="400"></div><br>  Having hovered on spending mobile traffic, I decided that ‚Äúneighbors need help‚Äù, and under ‚Äúneighbors‚Äù I had to enter myself ... <br><a name="habracut"></a><br>  Once upon a time I was fond of wardriving, just before that, until I found the Beeline wire in an old apartment) There, too, there were many networks nearby and the first thing that occurred to me was that I needed wi-fi.  Many years have passed since then.  Updating my data about wardriving, I found a mention in the network that 90% of the work of the special utilities ‚Äútoday‚Äù can be made standard MacOS services.  Looking ahead, I would like to note that I am not the author of this method, I myself found it in a foreign internet, just, let's say, this is a free translation and a detailed, artistic description of the way to get wi-fi passwords using standard macos methods, no more. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Neighborhood Wi-Fi Passwords Principles </h3><br>  You have to understand that having a Wi-Fi receiver, which you can find in any laptop today, you can ‚Äúsniff‚Äù all wireless traffic around you.  Earlier, when the networks were open, it was enough to come to McDuck and in the evening you could get 100-200 akkov to classmates.  Open network + lack of https did their job. <br><br>  Now everything is more interesting, everyone is switching to https (taking this opportunity, I want to say hello to <a href="https://letsencrypt.org/">Lets Encypt</a> . Beloved Lets Encypt, I'm on TV and say hello to you, thank you for being) and even forgot about WEP, everyone has WPA2.  But, as you know, the sword was invented before the shield, and no WPA2 is an obstacle for a person who is hungry for the Internet and sees a bunch of Wi-Fi near him. <br><br>  We continue.  Having a Wi-Fi card, i.e.  Any modern laptop, we can sniff traffic near us.  But it is useless, because it is encrypted.  The only thing that can be disassembled from it is metadata, such as the name of networks and so on, and handshake, i.e.  authorization of users in the network.  They occur every time a user connects to a wi-fi network.  For example, when a neighbor comes home and his smartphone in his pocket clings to home wi-fi. <br><br>  If quite rude, handshakes are a regular md5 type hash. <br><blockquote>  This is really quite rude.  The key there is obtained by 4096 rounds of SHA1.  To be precise, the formula is: Key = PBKDF2 (HMAC ‚àí SHA1, passphrase, ssid, 4096, 256) <br><br>  By the way, you can see that the name of the point is mixed in, therefore, with a unique name, precomputations do not help.  And this is the argument for changing the name of the point to your own. </blockquote>  thanks to <a href="https://habrahabr.ru/users/jia3ep/" class="user_link">jia3ep</a> <br><br>  And yes, I lied in my first paragraph about ‚Äúdecoding‚Äù, this is a technical error and a substitution of concepts.  Of course, it is impossible to decrypt the hash.  It's like saying ‚Äútaxi license‚Äù, knowing that taxi activity in the Russian Federation is not licensed.  But just so convenient) <br><br>  So here.  All we need is to find handshakes among the traffic of the radio network around ourselves and ‚Äúdecrypt‚Äù them.  And there used to be a lot of software for all this.  Someone was able to competently scan the radio channel, someone perfectly sniffed it into dumps, someone found hashes in the dumps, someone could break them.  Now everything has become easier, thanks to Tim Cook.  90% of the work for third-party software makes the standard application "Wireless Diagnostics".  Many have seen it - when there are problems with Wi-Fi, the Mac offers to check the network.  Useless utility that gives tips like "reboot the router."  Well, i.e.  it seemed to me) <br><br><h3>  We extract passwords.  Neighbors hang;) </h3><br>  So, drove.  Hold Alt and click on the Wi-Fi logo in the top bar.  In general, Alt and click always opens additional options in MacOS, but this is a topic for a separate topic. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/np/wu/kp/npwukpqzxru0tvuawv7nhw10vr0.png" width="600"></div><br>  In addition to other additional info, which is sometimes very useful, we can launch the Wireless Diagnostics program.  I think everyone who uses poppy remembers this window. <br><br><img src="https://habrastorage.org/webt/jr/oz/9c/jroz9cj0biqhji4w7kmab1y-yis.png"><br><br>  But we are interested in something else.  Click on the menu item "Window" and see a set of additional utilities. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ik/ew/bf/ikewbf6duobo4tllbsvsqnkcupy.png" width="600"></div><br>  And right here there is everything that is needed, even more) We are specifically interested in 2 points.  Scan and Analyzer.  The first one will show us all the networks around with additional information, such as on which channel and on which frequency the network operates.  The second point will allow you to sniff traffic on a specific channel and frequency. <br><br><img src="https://habrastorage.org/webt/bw/ty/gq/bwtygqcezfsmzaj7kbj64pfhaii.png"><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yl/d4/yg/yld4yg9_w1yooppvfijsugmxqqa.png" width="600"></div><br>  By clicking on the ‚ÄúStart‚Äù button in the Analyzer, the Wi-Fi card will switch to receive mode and start scanning the radio frequency around itself, the dump will be written to / var / tmp. <br><br><img src="https://habrastorage.org/webt/cv/_l/ys/cv_lystrkeagaewfkhjrbc9lpie.png"><br><br>  Files * .wcap are our dumps, which contain traffic that is useless for us and we need handshakes. <br><br>  We must understand that we need to catch just handshakes.  Those.  we need to catch and sniff traffic when a neighbor comes home in the evening.  Or, if you have another device on makosi, or any other axis, nukers will help you.  Programs that send out fake deactivation commands.  For example, <a href="http://macheads101.com/pages/downloads/mac.php">JamWiFi</a> .  But this is if you really can‚Äôt wait) In my experience, it‚Äôs enough just to run the Analyzer at 6 pm for an hour. <br><br>  Next we need to put <a href="https://github.com/brannondorsey/naive-hashcat">naive-hashcat</a> and <a href="https://github.com/hashcat/hashcat-utils/releases/">hashcat-utils</a> . <br><br>  ‚ÄúStop‚Äù you say, ‚Äúyou promised to break the neighbor‚Äôs networks using standard methods?‚Äù) Ha!  And you believed me?  In fact, we used standard methods to do 90% of the work through the GUI.  We already have hashes, all we need is to break them.  I'm sure you can do everything with standard utilities, but it's easier to use hashcat.  We collect software through brew or from sorts.  First of all, we need to convert our dump, leaving only our hashes in it.  This is the cap2hccapx binary from the package. <br><br><pre><code class="bash">#  hashcat-utils
git clone https://github.com/hashcat/hashcat-utils.git
Cloning into 'hashcat-utils'...
remote: Counting objects: 403, done.
remote: Total 403 (delta 0), reused 0 (delta 0), pack-reused 403
Receiving objects: 100% (403/403), 114.23 KiB | 61.00 KiB/s, done.
Resolving deltas: 100% (257/257), done.

#  
cd hashcat-utils/src/ &amp;&amp; make
rm -f ../bin/*
rm -f *.bin *.exe
cc -Wall -W -pipe -O2 -std=gnu99  -o cap2hccapx.bin cap2hccapx.c
cc -Wall -W -pipe -O2 -std=gnu99  -o cleanup-rules.bin cleanup-rules.c
‚Ä¶
cc -Wall -W -pipe -O2 -std=gnu99  -o strip-bsr.bin strip-bsr.c
cc -Wall -W -pipe -O2 -std=gnu99  -o strip-bsn.bin strip-bsn.c

#  
./cap2hccapx.bin /var/tmp/2018.01.25_00-37-45-GMT+3.wcap /var/tmp/home.hccapx</code></pre><br>
<img src="https://habrastorage.org/webt/k1/me/rn/k1mernb7jcyycrf-dxd8fcac864.png"><br>
‚Ä¶<br>
<img src="https://habrastorage.org/webt/oh/xb/vl/ohxbvlfqiklnb-ivt3obisbsezm.png"><br>
<br>
 ,    2 ,  ¬´ ¬ª.     naive-hashcat:<br>
<br>
<pre><code class="bash">git clone https://github.com/brannondorsey/naive-hashcat
cd naive-hashcat

#    osx
./build-hashcat-osx.sh

#     wpa/wpa2   (134MB)
curl -L -o dicts/rockyou.txt https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt

#      ,     , 2500   ,     WPA,    naive-hashcat

HASH_FILE=/var/tmp/home.hccapx POT_FILE=home-wifi.txt HASH_TYPE=2500 ./naive-hashcat.sh
</code></pre><br>
<img src="https://habrastorage.org/webt/aa/uz/z1/aauzz1wexqxdugrmt6ew5154dfa.png"><br>
<br>
  .           2000   ,   7,    .   <a href="https://gist.github.com/epixoip/a83d38f412b4737e99bbef804a270c40"> </a>,  1080gtx     400   .     2        ,       .   home-wifi.txt, :<br>
<br>
<img src="https://habrastorage.org/webt/hg/gi/6d/hggi6dlfq4vk-nbft8wscsc9iji.png"><br>
<br>
  .  ,           ,  7  )        wi-fi-   .  , , . <br>
<br>
  ,  <s></s> .     <s>Kali Linux</s> MacOS   . <br>
<br>
       <a href=""></a>.</div><p>Source: <a href="https://habr.com/ru/post/347658/">https://habr.com/ru/post/347658/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347644/index.html">Facebook breaks into blockchain and cryptocurrency: forecast</a></li>
<li><a href="../347646/index.html">Leave all doubts: how to avoid the impostor syndrome</a></li>
<li><a href="../347648/index.html">Outside the office. We automate specialized processes in a medical manufacturing company.</a></li>
<li><a href="../347650/index.html">How the principles of the game "Playing Lean" help in the creation of products</a></li>
<li><a href="../347654/index.html">10 skills cool designer in 2018</a></li>
<li><a href="../347662/index.html">Dostering nginx and php on sockets with log rotation</a></li>
<li><a href="../347664/index.html">Miner Monero: now in YouTube advertising</a></li>
<li><a href="../347666/index.html">The code was checked literally by line: how our firewall was certified by FSTEC</a></li>
<li><a href="../347668/index.html">Break and fallthrough operator</a></li>
<li><a href="../347670/index.html">Developing Tic-Tac-Toe on native javascript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>