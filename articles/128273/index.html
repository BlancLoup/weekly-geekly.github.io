<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Multilingual Django Starter Models</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introductory 
 I work, like all adequate programmers, on a social portal that will conquer all from infants to marazmatik. And since the goals of Napo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Multilingual Django Starter Models</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introductory </h4><br>  I work, like all adequate programmers, on a social portal that will conquer all from infants to marazmatik.  And since the goals of Napoleon - you need to take into account the possibility of using the service even by those representatives of humanity who do not own the great and powerful.  I know that many have long struggled with the question of the localization of content (translation of individual fields of the model into different languages), because  localization of the interface, within the generally accepted, is solved in Django.  The essence of the problem is that the same model (this is important! For example, the points of the catalog common to all languages) have translations of their fields into different languages.  Those who have long been ‚Äúon the needle‚Äù of this framework have probably already found the most appropriate method for solving this problem, but I want to suggest a solution and sketch out a procedure for beginners so that they do not run off to the ruby ‚Äã‚Äãmines. <br><a name="habracut"></a><br><h4>  Excuse </h4><br>  Most recently, I turned up a lucky chance to start turning from a PHP-PHP's larva into a Python'oid beetle.  So don't kick your feet right away.  This article (not the article) is HowTo for the same beginners. <br><br><h4>  Materials used </h4><br>  For localization of models we will use the application for Django - <a href="http://code.google.com/p/django-modeltranslation/"><code>django-modeltranslation</code></a> .  I chose it among others for the following reasons: <br><ul><li>  works with <code>Django 1.3</code> </li><li>  adds translatable fields for languages ‚Äã‚Äãto the same table, i.e.  there will be no extra <code>JOIN</code> </li><li>  does not require entering any code into existing models </li><li>  almost painlessly on and off </li><li>  in the admin, the localized model is integrated with other modules (I was worried about <code>mptt</code> ) </li></ul><br>  You will also need <code>South</code> - installed and working. <br>  Actually everything (not counting the working / developed site on <code>django</code> ). <br><br><h4>  Howto </h4><br>  Install the <code>modeltranslation</code> with the <code>pip install django-modeltranslation</code> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Or download the latest version of <a href="http://code.google.com/p/django-modeltranslation/downloads/list">django-modeltranslation</a> .  Unpack, go to the unpacked directory and install <code>python setup.py install</code> .  From the unpacked directory, you can immediately <code>modeltranslation/static/modeltranslation</code> directory into the folder for static files. <br><br><h6>  Further we work already with our project. </h6><br>  Add <code>'modeltranslation'</code> to the <code>INSTALLED_APPS</code> settings file <code>settings.py</code> . <br><br>  In the same file we add the description of the required localizations, the default language and the imported file of the registration of the models being localized.  In the last <code>MYPROJECT</code> , you need to replace it with the name of your project (it‚Äôs the name of the folder in which it is located), and <code>translation</code> ‚Äî with the name of the <code>.py</code> file itself without an extension; by default, <code>translation.py</code> .  This file is one for the entire project and is placed, respectively, in the root of the project. <br><br><pre> <code class="python hljs">LANGUAGES = ( (<span class="hljs-string"><span class="hljs-string">'ru'</span></span>, <span class="hljs-string"><span class="hljs-string">'Russian'</span></span>), (<span class="hljs-string"><span class="hljs-string">'en'</span></span>, <span class="hljs-string"><span class="hljs-string">'English'</span></span>), ) MODELTRANSLATION_DEFAULT_LANGUAGE = <span class="hljs-string"><span class="hljs-string">'ru'</span></span> MODELTRANSLATION_TRANSLATION_REGISTRY = <span class="hljs-string"><span class="hljs-string">'MYPROJECT.translation'</span></span></code> </pre><br><br>  In this file, we need to create classes containing instructions on which fields (here it's <code>'name'</code> and <code>'description'</code> ) to translate and bind these classes to translated models (here, <code>'Modelka'</code> ) of your applications (here, <code>'app'</code> ) appropriately: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- from modeltranslation.translator import translator, TranslationOptions from app.models import Modelka class ModelkaTranslationOptions(TranslationOptions): """      Modelka. """ fields = ('name', 'description',) translator.register(Modelka, ModelkaTranslationOptions)</span></span></code> </pre><br><br>  At this point, you can generate a migration <code>python manage.py schemamigration app --auto</code> . <br><br>  <code>South</code> discover new fields for localization and generate a migration to add them.  By the way, if you disable the application <code>'modeltranslation'</code> - then you can also generate and migration to remove them.  In addition, a separate convenience is that the <code>modeltranslation</code> binds the default language to the original fields of the model, i.e.  this localization field and the translated original field of the model will be identical. <br><br>  Don't forget to apply the migration later: <code>python manage.py migrate app</code> . <br><br><h6>  And finally, set up the admin panel. </h6><br>  <b>It is very important that the admin panel is described in a separate <code>admin.py</code> file for each application !!!</b>  And not in the model file, as I admit honestly, in the beginning I tried to do. <br><br>  For the sample, I will immediately give an example of using a localized admin panel with the <code>mptt</code> admin <code>mptt</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- from django.contrib import admin from mptt.admin import MPTTModelAdmin from modeltranslation.admin import TranslationAdmin from models import Modelka class ModelkaAdmin(MPTTModelAdmin, TranslationAdmin): """    Modelka. """ list_display = ('name',) class Media: js = ( '/static/modeltranslation/js/force_jquery.js', 'http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js', '/static/modeltranslation/js/tabbed_translation_fields.js', ) css = { 'screen': ('/static/modeltranslation/css/tabbed_translation_fields.css',), } fieldsets = [ (None, { 'fields': [ 'name', 'slug', 'type', 'description', 'parent', ] }), (u'', { 'fields': [ 'author', 'editor', ], 'classes': ['collapse'] }) ] admin.site.register(Modelka, ModelkaAdmin)</span></span></code> </pre><br><br>  Please note that the example immediately includes scripts for displaying translations on different tabs.  These are the files that I initially suggested copying to the directory for static content.  If you installed the modeltranslation via pip, do not forget to build static files with the <code>python manage.py collectstatic</code> ( <a href="https://docs.djangoproject.com/en/1.3/howto/static-files/">for more information about static files</a> ).  Accordingly, do not forget to correct the paths in the nested <code>Meta</code> class, if they are different. <br><br><img src="https://habrastorage.org/storage1/370bf804/e84d2b6d/8458d9d8/aa016fbb.png"><br><br>  The screenshot shows language tabs for the model's translated fields (screenshot from the application being developed, therefore there are more languages ‚Äã‚Äãthan in the example) <br><br><h6>  Work with a localized model </h6><br>  Actually, the work itself is absolutely transparent and also does not affect the already existing code (the best site display language can be determined either by the framework itself or by third-party modules, but this is a separate topic) if you do not need to declare the used language <code>set_language</code> using <code>set_language</code> .  Those.  the model will return field values ‚Äã‚Äãin the current application language returned by <code>get_lang</code> . </div><p>Source: <a href="https://habr.com/ru/post/128273/">https://habr.com/ru/post/128273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128267/index.html">Plastic Logic 100 in real life</a></li>
<li><a href="../128268/index.html">Dave Mendlen transferred from Microsoft to DevExpress</a></li>
<li><a href="../128269/index.html">Data structures in pictures. ArrayList</a></li>
<li><a href="../128270/index.html">Microsoft has implemented an analogue of Synergy (control of several PCs with one mouse)</a></li>
<li><a href="../128271/index.html">YAF - the fastest php framework *</a></li>
<li><a href="../128274/index.html">Work for Watson</a></li>
<li><a href="../128275/index.html">Lock-free memcache API</a></li>
<li><a href="../128276/index.html">September issue of UserAndLINUX magazine released</a></li>
<li><a href="../128277/index.html">How to connect your Ruby project to Travis and cook Martini in 15 minutes</a></li>
<li><a href="../128278/index.html">Happy programmer!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>