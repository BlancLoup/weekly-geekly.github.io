<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Strelki.js - another library for working with arrays</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When programming in JavaScript, there is often a problem of choosing the optimal presentation of data in a program: arrays, hashes, hashes arrays, arr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Strelki.js - another library for working with arrays</h1><div class="post__text post__text-html js-mediator-article">  When programming in JavaScript, there is often a problem of choosing the optimal presentation of data in a program: arrays, hashes, hashes arrays, arrays hashes, etc.  The same data can be loaded into various combinations of structures, but the difficulty of choosing is usually how to find a compromise between the simplicity of the code for accessing this data, the speed of operation and the amount of memory required. <br><br><img src="https://habrastorage.org/files/756/6d7/974/7566d7974ca64d30b85f6bbedd055857.jpg"><br><br>  The article talks about my attempt to find a universal solution. <br><a name="habracut"></a><br>  Let us, for example, need to display some data from two related tables: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/656/614/9a5/6566149a553a4e7b8ae853a8bc47de5c.png"><br><br>  The standard approach usually consists of the following steps: <br><ol><li>  On the server, write a SQL query with JOIN </li><li>  On the server, add a function for it that returns an array of objects and make it accessible via routes </li><li>  On the client, add an AJAX call to the server, and draw the result to a table </li></ol><br><br>  The disadvantages of the standard approach are seen in the following: <br><ol><li>  The SQL query and the wrapper function must take into account possible collisions of column names, i.e. one cannot simply make a " <b>SELECT *</b> ". </li><li>  The server response will contain a large number of duplicate records from related tables.  In our example, the record with the key ‚Äúsales‚Äù from the departments table will be transmitted twice. </li><li>  When linking a large number of tables, we will either get long keys, which will increase the useless consumption of memory and traffic to transfer these keys, or the column names in the SQL query must be manually transferred, which will lead to additional costs when making changes to the database structure. </li><li>  The number of API functions for obtaining data from related tables can significantly exceed the number of tables, which leads to bloat of the code, and, as a result, to costs. </li></ol><br><br>  Non-standard approach - get the tables separately and link them to the client.  Sometimes this can be done easily.  For example, in the structure above, you can load the ‚Äúdepartments‚Äù table into the hash, and access by ‚Äúid‚Äù.  But more often this cannot be done, and one has to use various search functions like Array.find or Array.indexOf. <br><br>  Working on my next project, and once again puzzling over how I better organize the data to avoid the shortcomings of both approaches, I decided that it was time to cut this node once and for all. <br><br>  The approach in which the server gives us normalized tables, and then we associate them in JavaScript code, seemed more attractive to me.  It lacked only a tool to easily bind them.  I put aside all things and sat down to write it. <br><br>  Requirements have the following: <br><ul><li>  The tool should allow me to create arbitrary indexes on an array, and keep them up to date. </li><li>  The tool should be able to search in an array by index, if possible without slow operations of enumerating elements. </li><li>  The tool should be able to connect arrays by indexed fields in accordance with a certain declaration object, something like a JOIN operator in SQL, but without parsing queries and all the power offered by SQL. </li></ul><br>  This is how Strelki.js appeared, and so far the only class in it is IndexedArray. <br><br>  So, create a new IndexedArray: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StrelkiJS.IndexedArray();</code> </pre> <br>  Add data to it: <br><br><pre> <code class="javascript hljs"> emp.put({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"John"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Smith"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"sales"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"200"</span></span> }); emp.put({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"002"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Krasonov"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"sales"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"300"</span></span> });</code> </pre><br>  Let's see what's inside: <br><br><img src="https://habrastorage.org/files/8e5/b75/794/8e5b757947014e3bb1df76bb01dad9b4.png"><br><br>  Under the hood, IndexedArray is a hash (this.data) where object references are stored.  As a hash key, the ‚Äúid‚Äù field of the saved item is used, which must be unique.  Since many modern server frameworks also use the ‚Äúid‚Äù field in a similar way, this restriction should not be a problem. <br><br>  In addition, IndexedArray has a hash of this.indexData.  The keys of this hash contain the name of the field being indexed, and the values ‚Äã‚Äãare hashes with ids of the corresponding elements of the main hash.  We don't have any indexes yet, so this.indexData is empty. <br><br>  Add an index: <br><br><pre> <code class="javascript hljs">emp.createIndex(<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>);</code> </pre><br>  Let's see this.indexData: <br><br><img src="https://habrastorage.org/files/107/8ed/b24/1078edb24b864590804b0013a844fd9c.png"><br><br>  this.indexData now contains the key ‚Äúdep_id‚Äù, which contains index data as nested hashes. <br><br>  Look for something on the index: <br><br><pre> <code class="javascript hljs">&gt; emp.findIdsByIndex(<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>,<span class="hljs-string"><span class="hljs-string">"sales"</span></span>) &lt; [<span class="hljs-string"><span class="hljs-string">"001"</span></span>, <span class="hljs-string"><span class="hljs-string">"002"</span></span>]</code> </pre><br>  Unlike functions like Array.find, index search does not use data iteration, but only hashes, which allows achieving high speed.  I haven‚Äôt done the measurements yet, but it should work quickly. <br><br>  Add more data: <br><br><pre> <code class="javascript hljs">emp.put({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"003"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"George"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Clooney"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"hr"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"400"</span></span> }); emp.put({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"004"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Dev"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Patel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"board"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"500"</span></span> });</code> </pre><br><br>  Find the elements by index, and create a new IndexedArray from them: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sales_emp = emp.where(<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>,<span class="hljs-string"><span class="hljs-string">"sales"</span></span>);</code> </pre><br>  Create and fill another IndexedArray: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> adr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StrelkiJS.IndexedArray(); adr.put({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"200"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address</span></span>: <span class="hljs-string"><span class="hljs-string">"New Orleans, Bourbon street, 100"</span></span>}); adr.put({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"300"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address</span></span>: <span class="hljs-string"><span class="hljs-string">"Moscow, Rojdestvensko-Krasnopresnenskaya Naberejnaya"</span></span>}); adr.put({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">"500"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address</span></span>: <span class="hljs-string"><span class="hljs-string">"Bollywood, India"</span></span>});</code> </pre><br><h3>  Array binding </h3><br>  To describe the relationship of this IndexedArray with any other object serves as follows: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">from_col</span></span>: <span class="hljs-string"><span class="hljs-string">"address_id"</span></span>, <span class="hljs-comment"><span class="hljs-comment">//    IndexedArray to_table: adr, //     to_col: "id", // "id",        type: "outer", // "outer"  LEFT OUTER JOIN,  null  INNER JOIN join: // null          ,    JOIN- }</span></span></code> </pre><br>  Attach adr to emp JOIN: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res = emp.query([ { <span class="hljs-attr"><span class="hljs-attr">from_col</span></span>: <span class="hljs-string"><span class="hljs-string">"address_id"</span></span>, <span class="hljs-comment"><span class="hljs-comment">// name of the column in "emp" table to_table: adr, // reference to another table to_col: "id", // "id", or other indexed field in "adr" table type: "outer", // "outer" for LEFT OUTER JOIN, or null for INNER JOIN //join: [ // optional recursive nested joins of the same structure // { // from_col: ..., // to_table: ..., // to_col: ..., // ... // }, // ... //], } ])</span></span></code> </pre><br>  A similar SQL statement would look like this: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> emp <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OUTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> adr <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> emp.address_id = adr.id</code> </pre><br>  The result will look like this: <br><br><pre> <code class="javascript hljs">[ [ {<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"001"</span></span>,<span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"John"</span></span>,<span class="hljs-string"><span class="hljs-string">"last_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Smith"</span></span>,<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"sales"</span></span>,<span class="hljs-string"><span class="hljs-string">"address_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"200"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"200"</span></span>,<span class="hljs-string"><span class="hljs-string">"address"</span></span>:<span class="hljs-string"><span class="hljs-string">"New Orleans, Bourbon street, 100"</span></span>} ], [ {<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"002"</span></span>,<span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>,<span class="hljs-string"><span class="hljs-string">"last_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Krasonov"</span></span>,<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"sales"</span></span>,<span class="hljs-string"><span class="hljs-string">"address_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"300"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"300"</span></span>,<span class="hljs-string"><span class="hljs-string">"address"</span></span>:<span class="hljs-string"><span class="hljs-string">"Moscow, Rojdestvensko-Krasnopresnenskaya Naberejnaya"</span></span>} ], [ {<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"003"</span></span>,<span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"George"</span></span>,<span class="hljs-string"><span class="hljs-string">"last_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Clooney"</span></span>,<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"hr"</span></span>,<span class="hljs-string"><span class="hljs-string">"address_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"400"</span></span>}, <span class="hljs-literal"><span class="hljs-literal">null</span></span> ], [ {<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"004"</span></span>,<span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Dev"</span></span>,<span class="hljs-string"><span class="hljs-string">"last_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Patel"</span></span>,<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"board"</span></span>,<span class="hljs-string"><span class="hljs-string">"address_id"</span></span>:<span class="hljs-string"><span class="hljs-string">"500"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"500"</span></span>,<span class="hljs-string"><span class="hljs-string">"address"</span></span>:<span class="hljs-string"><span class="hljs-string">"Bollywood, India"</span></span>} ] ]</code> </pre><br><div class="spoiler">  <b class="spoiler_title">A more complex example of linking 3 tables</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dep = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StrelkiJS.IndexedArray(); dep.createIndex(<span class="hljs-string"><span class="hljs-string">"address"</span></span>); dep.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"sales"</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Sales"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"100"</span></span>}); dep.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"it"</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"IT"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"100"</span></span>}); dep.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"hr"</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Human resource"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"100"</span></span>}); dep.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"ops"</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Operations"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"100"</span></span>}); dep.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"warehouse"</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"Warehouse"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"500"</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StrelkiJS.IndexedArray(); emp.createIndex(<span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>); emp.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"john"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"smith"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"sales"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"200"</span></span>}); emp.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"002"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Tiger"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Woods"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"sales"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"300"</span></span>}); emp.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"003"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"George"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Bush"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"sales"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"400"</span></span>}); emp.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"004"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Vlad"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Putin"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"ops"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"400"</span></span>}); emp.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"005"</span></span>, <span class="hljs-attr"><span class="hljs-attr">first_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Donald"</span></span>, <span class="hljs-attr"><span class="hljs-attr">last_name</span></span>: <span class="hljs-string"><span class="hljs-string">"Trump"</span></span>, <span class="hljs-attr"><span class="hljs-attr">dep_id</span></span>: <span class="hljs-string"><span class="hljs-string">"ops"</span></span>, <span class="hljs-attr"><span class="hljs-attr">address_id</span></span>: <span class="hljs-string"><span class="hljs-string">"600"</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userRoles = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StrelkiJS.IndexedArray(); userRoles.createIndex(<span class="hljs-string"><span class="hljs-string">"emp_id"</span></span>); userRoles.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"601"</span></span>, <span class="hljs-attr"><span class="hljs-attr">emp_id</span></span>: <span class="hljs-string"><span class="hljs-string">"001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">role_id</span></span>: <span class="hljs-string"><span class="hljs-string">"worker"</span></span>}); userRoles.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"602"</span></span>, <span class="hljs-attr"><span class="hljs-attr">emp_id</span></span>: <span class="hljs-string"><span class="hljs-string">"001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">role_id</span></span>: <span class="hljs-string"><span class="hljs-string">"picker"</span></span>}); userRoles.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"603"</span></span>, <span class="hljs-attr"><span class="hljs-attr">emp_id</span></span>: <span class="hljs-string"><span class="hljs-string">"001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">role_id</span></span>: <span class="hljs-string"><span class="hljs-string">"cashier"</span></span>}); userRoles.put({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-string"><span class="hljs-string">"604"</span></span>, <span class="hljs-attr"><span class="hljs-attr">emp_id</span></span>: <span class="hljs-string"><span class="hljs-string">"002"</span></span>, <span class="hljs-attr"><span class="hljs-attr">role_id</span></span>: <span class="hljs-string"><span class="hljs-string">"cashier"</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> joinInfo = [ { <span class="hljs-attr"><span class="hljs-attr">from_col</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">to_table</span></span>: emp, <span class="hljs-attr"><span class="hljs-attr">to_col</span></span>: <span class="hljs-string"><span class="hljs-string">"dep_id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">"outer"</span></span>, <span class="hljs-attr"><span class="hljs-attr">join</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">from_col</span></span>: <span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">to_table</span></span>: userRoles, <span class="hljs-attr"><span class="hljs-attr">to_col</span></span>: <span class="hljs-string"><span class="hljs-string">"emp_id"</span></span>, <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">"outer"</span></span>, }], }, <span class="hljs-comment"><span class="hljs-comment">// { // from_col: "id", // to_table: assets, // to_col: "dep_id", // } ]; //var js1 = IndexedArray.IndexedArray.doLookups(dep.get("sales"),joinInfo); var js = dep.where(null,null,function(el) { return el.id === "sales"}).query(joinInfo); // result [ [ {"id":"sales","name":"Sales","address_id":"100"}, {"id":"001","first_name":"john","last_name":"smith","dep_id":"sales","address_id":"200"}, {"id":"601","emp_id":"001","role_id":"worker"} ], [ {"id":"sales","name":"Sales","address_id":"100"}, {"id":"001","first_name":"john","last_name":"smith","dep_id":"sales","address_id":"200"}, {"id":"602","emp_id":"001","role_id":"picker"} ], [ {"id":"sales","name":"Sales","address_id":"100"}, {"id":"001","first_name":"john","last_name":"smith","dep_id":"sales","address_id":"200"}, {"id":"603","emp_id":"001","role_id":"cashier"} ], [ {"id":"sales","name":"Sales","address_id":"100"}, {"id":"002","first_name":"Tiger","last_name":"Woods","dep_id":"sales","address_id":"300"}, {"id":"604","emp_id":"002","role_id":"cashier"} ], [ {"id":"sales","name":"Sales","address_id":"100"}, {"id":"003","first_name":"George","last_name":"Bush","dep_id":"sales","address_id":"400"} ,null ] ]</span></span></code> </pre><br></div></div><br>  As you can see, array binding has evolved from functions with cycles and iterations to a simple declaration of links. <br><br><h3>  Restrictions </h3><br>  IndexedArray does not store copies of objects, but only pointers to them (hence the name Strelki).  Therefore, if the object was placed in IndexedArray by the put () method and then changed, the information in the indexes may become incorrect.  To avoid this situation, you must remove the object from IndexedArray using the del () method before changing. <br><br>  Linking can be carried out only by the indexed field, or by the "id" field. <br><br>  Some methods of the IndexedArray object (for example, length ()) require the construction of an ‚Äúid‚Äù key array.  In this case, the key array is stored in the object for possible reuse.  Each time the array changes (methods put (), del (), etc.), the array of keys is reset.  Therefore, the alternation of methods that create and then zero out an array of keys can lead to performance problems on large data sets. <br><br><h3>  Plans </h3><br>  StrelkiJS created to facilitate the writing of the main project KidsTrack, which I wrote on Habr√© earlier.  Therefore, all decisions on the new functionality are dictated by the needs of the parent project.  In the near future - to make more convenient access to the columns in the results of the JOIN, <br><br><h3>  Where can I download </h3><br>  Github: <a href="">github.com/amaksr/Strelki.js</a> <br>  Sandbox: <a href="https://www.izhforum.info/strelkijs/">www.izhforum.info/strelkijs</a> </div><p>Source: <a href="https://habr.com/ru/post/301258/">https://habr.com/ru/post/301258/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../301244/index.html">Pitertsy world champions! Not hockey, so programming</a></li>
<li><a href="../301246/index.html">Double deception. How the FBI used the Ukrainian hacker Maxim Popov</a></li>
<li><a href="../301248/index.html">Don't you have a minute to talk about C ++?</a></li>
<li><a href="../301250/index.html">Security Week 20: random numbers, 7-Zip vulnerability, Microsoft turns off WiFi Sense</a></li>
<li><a href="../301252/index.html">Microsoft Office and productivity at the DevCon 2016 conference</a></li>
<li><a href="../301262/index.html">Difficult to translate distribution agreements</a></li>
<li><a href="../301268/index.html">Yandex.Algorithm. Analysis of last year's qualifying round and the last chance to participate in the championship</a></li>
<li><a href="../301270/index.html">12 ideas on how to improve game localization</a></li>
<li><a href="../301274/index.html">Fifth "Webmaster" right now</a></li>
<li><a href="../301276/index.html">Chew linear-square regulator to control the inverted pendulum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>