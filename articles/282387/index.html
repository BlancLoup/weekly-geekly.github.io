<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cybercriminals tried to commit the largest bank robbery</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The well-known defense company of the UK, BAE Systems , which is engaged in promising military developments, the aerospace industry, and information s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cybercriminals tried to commit the largest bank robbery</h1><div class="post__text post__text-html js-mediator-article">  The well-known defense company of the UK, <a href="https://en.wikipedia.org/wiki/BAE_Systems">BAE Systems</a> , which is engaged in promising military developments, the aerospace industry, and information security, announced the <a href="http://baesystemsai.blogspot.ru/2016/04/two-bytes-to-951m.html">results of an</a> analysis of a large cyber attack against a bank in Bangladesh, as a result of which attackers managed to compromise the well-known international banking platform SWIFT and steal $ 81 million. <br><br><img src="https://habrastorage.org/files/638/95b/1d8/63895b1d84f34450847fc5cde20fd9d7.jpg"><br>  ( <i>picture Reuters</i> ) <br><br>  The <a href="https://ru.wikipedia.org/wiki/SWIFT">SWIFT</a> platform is called the heart of the global banking system, with its help banks around the world exchange information and service payments.  After the SWIFT software was compromised in a Bangladesh bank, the hackers managed to log in to the system and send a request to a US bank to transfer a large amount to a bank in the Philippines.  As a result of a well-planned cyber attack, hackers planned to transfer almost a billion dollars ($ 951 million) from bank accounts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Experts from BAE Systems have published a minimum cyber attack report and information on publicly available samples of malicious tools (see table below).  Another unique malware sample is at the company's disposal.  It contains complex mechanisms for working with the local SWIFT Alliance Access software used in the victim's system.  These individual components are part of the spectrum of malicious tools that were used to conduct a cyber attack and send false instructions to the bank to complete the transaction.  The tools are quite flexible, which makes it possible to use them for similar cyber attacks in the future. <br><br><img src="https://habrastorage.org/files/bc1/97e/8e5/bc197e8e511c4e2489ec34d8596182a1.png"><br>  Fig.  Some of the malicious tools used in cyber attacks are also available on public malware sample exchange services.  <i>(BAE Systems data)</i> <br><br>  According to BAE Systems, malicious files were created by one cybercriminal or a group of individuals, however, the most valuable file is the hash 525a8e3ae4e3df8c9c61f2a49e38541d196e9228, which contains the logic of working with SWIFT software. <br><br><img src="https://habrastorage.org/files/424/5a1/2a5/4245a12a5d89411abf052661e9c9026b.png"><br>  Fig.  The general scheme of compromising SWIFT.  <i>(BAE Systems data)</i> <br><br>  It can be seen that one of the main steps of the cyber attack is to compromise the server with the installed SWIFT Alliance Software.  Next, this malicious program accesses the gpca.dat configuration file, which lists the search patterns for SWIFT messages that attackers need.  After that, attackers can monitor the messages processed by the server part of SWIFT. <br><br>  The main goal is to gain control over SWIFT messages, in which the presence of certain text strings specified in the configuration file will be checked.  From malicious messages of interest to malware, the program can extract the values ‚Äã‚Äãof certain fields, such as transfer references, as well as SWIFT addresses for interacting with the system database.  The resulting data field values ‚Äã‚Äãare then used to remove information about specific transactions or update balance data from the system.  This function of the malware worked in a cycle until 6 am on February 6, 2016. This period was enough to steal money, which occurred two days before its end.  The malicious tool was designed specifically for this purpose and shows a significant level of knowledge of SWIFT Alliance Access, in addition, its authors have good skills in developing malware. <br><br>  The malicious program uses the following RC4 key to decrypt the contents of its configuration file. <br><br><blockquote>  4e 38 1f a7 7f 08 cc aa 0d 56 ed ef f9 ed 08 ef </blockquote><br><img src="https://habrastorage.org/files/e3d/7f2/424/e3d7f242413d4972b29a6add5a3c2506.png"><br>  Fig.  The general scheme of cyber attack.  <i>(BAE Systems data)</i> <br><br>  At the first stage, the malware lists all the processes running on the server.  If it detects a process into which liboradb.dll is loaded, it modifies its two bytes in memory at a certain offset.  Two bytes are modified with the original values ‚Äã‚Äã0x75 and 0x04 on the nop instruction - 0x90 and 0x90.  These two bytes represent the JNZ conditional jump instruction (if not zero). <br><br><img src="https://habrastorage.org/files/176/cf3/c36/176cf3c36622412ab4f3343a4b727b0c.png"><br>  Fig.  The original conditional branch instruction in the system library code.  <i>(BAE Systems data)</i> <br><br><img src="https://habrastorage.org/files/052/387/1b9/0523871b92ad4309a842885e22a0f9f8.png"><br>  Fig.  Corrected two nop conditional instruction in the system library code.  <i>(BAE Systems data)</i> <br><br>  As a result of this fix, the malware blocks an important check in the code of one of the liboradb.dll functions, which allows attackers to successfully pass the necessary check (validation).  The library liboradb.dll itself is a component of the already mentioned SWIFT's Alliance software from Oracle.  The library is responsible for the following functions: <br><ul><li>  reading the path to the Alliance database from the registry; </li><li>  activation of this database; </li><li>  database backup. </li></ul><br>  By modifying a local instance of the SWIFT Alliance software, the malware gains the right to perform transactions on the SWIFT database through the victim's network. <br><br>  The malicious program monitors SWIFT Financial Application (FIN) messages by parsing the contents of the * .prc and * .fal files from the following directories. <br><br><blockquote>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcm \ in \ <br>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcm \ out \ </blockquote><br>  For more information, see <a href="http://baesystemsai.blogspot.ru/2016/04/two-bytes-to-951m.html">baesystemsai.blogspot.ru/2016/04/two-bytes-to-951m.html</a> <br><br>  All SWIFT messages from the directories below are also tracked. <br><br><blockquote>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcp \ in \ *. * <br>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcp \ out \ *. * <br>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcp \ unk \ *. * <br>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcs \ nfzp <br>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcs \ nfzf <br>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcs \ fofp <br>  [ROOT_DRIVE]: \ Users \ Administrator \ AppData \ Local \ Allians \ mcs \ foff </blockquote><br>  Inside messages, a search is performed for the following bank values ‚Äã‚Äãof interest to intruders <br><br><blockquote>  "19A: Amount" <br>  ": Debit" <br>  "Debit / Credit:" <br>  "Sender:" <br>  "Amount:" <br>  FEDERAL RESERVE BANK <br>  "D" <br>  "C" <br>  "62F:‚Äû <br>  ‚Äú60F:‚Äú <br>  "60M:" <br>  "62M:‚Äû <br>  ‚ÄúCredit‚Äù <br>  "Debit" <br>  "64:" <br>  "20: Transaction" <br>  "90B: Price" </blockquote><br>  <b>Conclusion</b> <br><br>  A sample of malware analyzed by BAE Systems allows you to look inside the cybercrime tool of a group of hackers who planned the cyber attack on the bank.  Many parts of this puzzle are still not disclosed, for example, how attackers sent fake transaction requests, as well as how attackers managed to install malware into the system and compromise the computer network.  Not found the answer to the most important question: who is behind this cyber attack. <br><br>  The main malicious tool from the above set of malware was designed specifically for this cyber attack on the specific infrastructure of the victim.  It is also worth noting that this set will also allow attackers to further carry out similar attacks on banks.  All financial institutions that in one way or another use SWIFT Alliance Access should take this case seriously and evaluate their security system. <br><br>  Cybercriminals have used methods of tracing in a compromised system in such a way as to remain undetected, as well as to impede the process of investigating cyber attacks.  Such a significant lesson, which was presented by the attackers, demonstrates the fact that they are using increasingly sophisticated cyber attacks against various organizations.  Cyber ‚Äã‚Äãattacks are used to intrude intruders into the internal network of such organizations.  As such threats develop, organizations, banks and other network owners should keep up with the times to ensure an adequate level of security for their network infrastructure. </div><p>Source: <a href="https://habr.com/ru/post/282387/">https://habr.com/ru/post/282387/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282377/index.html">A little about the "law of Moore"</a></li>
<li><a href="../282379/index.html">Reverse Polish notation: how to cook a hot dog?</a></li>
<li><a href="../282381/index.html">Gaming Digest: March</a></li>
<li><a href="../282383/index.html">Hydra Slayer: kill time and numbers</a></li>
<li><a href="../282385/index.html">5 stages of the API: what we understood by writing two versions</a></li>
<li><a href="../282391/index.html">Optimization of the game on unity and dev story Tap Tap Builder</a></li>
<li><a href="../282393/index.html">GitLab in Russia</a></li>
<li><a href="../282395/index.html">New memory for new storage architecture</a></li>
<li><a href="../282397/index.html">Angular.js - webApi module development</a></li>
<li><a href="../282399/index.html">On the International Penguin Day, a meditative video and a story about Ubuntu and Bash in Windows 10 from Scott Hanselman</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>