<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fighting HTTPS traffic interception. Experience Yandex Browser</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="According to a study by employees of Mozilla, Google, Cloudflare and a number of universities, from 4 to 11% of secure connections are ‚Äútapped‚Äù as a r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fighting HTTPS traffic interception. Experience Yandex Browser</h1><div class="post__text post__text-html js-mediator-article">  According to a <a href="https://jhalderm.com/pub/papers/interception-ndss17.pdf">study by</a> employees of Mozilla, Google, Cloudflare and a number of universities, from 4 to 11% of secure connections are ‚Äútapped‚Äù as a result of installing questionable root certificates on users' computers that do not even realize the risk.  Today I will talk about how our team draws attention to this problem with the help of Yandex. Browser. <br><br><img src="https://habrastorage.org/files/fdd/c6c/f18/fddc6cf18e52494da53131655f901cbc.png"><br><br>  It is unlikely on Habr√© to talk in detail about the SSL certificates and the tasks that they solve, but just in case, briefly recall the main point (you can just skip a couple of paragraphs, if you are well aware of the principles of work).  Any site can now easily receive a closed lock in the address bar of the browser, so the certificate is in no way a sign of the site‚Äôs ‚Äúreliability‚Äù, despite the appropriate <a href="">labeling in Chromium</a> .  Nevertheless, it performs the important function of protecting our data with you from interception.  The network administrator or an attacker who gains access to the traffic still needs to come up with a way to decrypt the stream, which is usually difficult to do with strong cryptography and the absence of a key. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  If you can not decrypt the stream, you can redirect it through yourself, forcing the browser to establish a connection not with the site, but with its own server (man-in-the-middle attack).  For example, you can hack a user's router and redirect it to a phishing site to steal passwords by spoofing DNS responses.  An experienced user is unlikely to encounter this, and you can set up an alternative DNS server with DNSCrypt directly <a href="https://habrahabr.ru/company/yandex/blog/280380/">in your browser</a> for your loved ones.  But if the attacker wants to go further and begins to act as an intermediary between the user and the HTTPS site, then another task of the certificate will save us - authentication. <br><br>  When the browser receives a certificate from the site, it must make sure that it was the site that sent it, and not the ‚Äúman in the middle‚Äù.  You can confirm this with the help of root certificates that are in the OS repository.  If the certificate that allegedly sent the site cannot find the confirming root, then any modern browser will display something like this: <br><br><img src="https://habrastorage.org/files/27d/c39/2d4/27dc392d4faa437184655438a85d48e1.png"><br><br>  In order to circumvent such protection and hide the fact of their interference with traffic from the user, there remains only one thing - to place their root certificate in the system storage, which legalizes in the eyes of the browser the malicious certificates signed by them.  And any application can do this.  And with administrator rights also without warnings and questions to the user.  A person installs a program from a questionable site, and receives a wiretap of traffic in the appendage.  And not a single modern browser will respond to it at all.  You will see all the same inscription "Reliable" and green lock.  Unless in the case of Firefox, attackers will need to add their root certificate also to the storage of this browser, because it does not use the system one (but this is no more difficult to do). <br><br>  If we exclude cases regarding the legal use of this feature by programs (antiviruses, ad blockers, Fiddler) and control of employees in organizations, then this practice usually leads to shocking and dangerous advertising on the pages visited.  Users in most cases do not know about the causes, blame the site owners or even the developers of Yandex. Browser.  You can imagine how sometimes it‚Äôs difficult for our support service to get to the cause and help a person.  But so the problem is at least noticeable.  But in some cases, no external manifestations occur, and the data is simply stolen. <br><br><img src="https://habrastorage.org/web/430/40d/947/43040d947fde453ba0eecdecb92b8646.png"><br><br>  Moreover, the harm from intruders is not only direct (in the form of data interception and advertising), but also indirect.  In the normal situation, we can click on the lock and find out which certification center issued the certificate, evaluate its reliability ( <a href="">in Yandex</a> Browser; in other browsers this information is often hidden).  When replacing this data is hidden from us.  And not only these, but any other problems with the connection.  If an incorrect certificate is used on the site, which would inevitably lead to a full-fledged warning stub in any browser, then replacing the certificate masks the problem from the user - the usual closed lock is displayed in the address bar.  All this leads to a general drop in the level of security. <br><br><img src="https://habrastorage.org/files/be6/a7b/f53/be6a7bf53c604340a899fe637837c604.png"><br><br>  According to preliminary estimates, already about 400 thousand users from the weekly audience of Yandex. Browser live with the interception of traffic.  And this is minus antiviruses!  That is why we seriously took up the problem and began to experiment with revealing the fact that a doubtful root certificate was installed in the system.  It works as follows.  Now Yandex.Browser does not blindly trust the root certificate from the system storage, but checks it against the list of well-known authoritative certificate authorities.  And if the root certificate is not familiar to the browser, then we open the lock and honestly report potential risk. <br><br><img src="https://habrastorage.org/files/b9b/10b/965/b9b10b965fc84019b9df9840615ffbbc.png"><br><br>  The solution with an open lock is relatively soft - watched the reaction of users.  But a few days ago we moved on to the next stage.  Now, when you download important sites, which include banks, payment and search engines, popular social networks, a full warning appears about the threat. <br><br><img src="https://habrastorage.org/files/3d5/96f/d9e/3d596fd9e2224fc38fdc24057aba1d25.png"><br><br>  The warnings in Yandex Browser cannot be called a panacea, because they have no effect on the main source of the problem - the program that installs its root certificate.  But we hope that informing users will draw their attention to the risk of data loss or at least simplify diagnostics.  After all, even the fact of intercepting traffic to this point was hidden from people. </div><p>Source: <a href="https://habr.com/ru/post/326796/">https://habr.com/ru/post/326796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326786/index.html">Do not believe the navigator: GPS and GLONASS vulnerabilities</a></li>
<li><a href="../326788/index.html">GA Measurement Protocol - complete guide</a></li>
<li><a href="../326790/index.html">About safety, nuclear physics and love: about the contradictions of modern IT architecture of front-end solutions</a></li>
<li><a href="../326792/index.html">Online Ticket Act: Let's Put A Point? Electronic money and aggregators</a></li>
<li><a href="../326794/index.html">ESP8266 as MQTT Broker for Mobile Application</a></li>
<li><a href="../326798/index.html">Why should you go?</a></li>
<li><a href="../326802/index.html">Dictionary Browser Extension: More Than an Online Translator</a></li>
<li><a href="../326804/index.html">Hello, Habr</a></li>
<li><a href="../326806/index.html">RubyMine 2017.1: Docker, RuboCop, autogenerate Rails tests, improvements for Puppet</a></li>
<li><a href="../326808/index.html">Top Online Data Science Courses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>