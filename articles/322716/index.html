<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PyMC3 - MCMC and not only</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PyMC3 - MSMS and not only 



 Hi, Habrahabr! 


 PyMC3 has already been mentioned in this post. There you can read about the basics of MCMC sampling....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PyMC3 - MCMC and not only</h1><div class="post__text post__text-html js-mediator-article"><h1 id="pymc3---msms-i-ne-tolko">  PyMC3 - MSMS and not only </h1><br><p><img src="https://raw.githubusercontent.com/pymc-devs/pymc3/master/docs/pymc3_logo.jpg"><br>  Hi, Habrahabr! </p><br><p>  PyMC3 has already been mentioned in <a href="https://habrahabr.ru/company/wunderfund/blog/279545/">this</a> post.  There you can read about the basics of MCMC sampling.  Here I will tell about the variational conclusion ( <a href="https://arxiv.org/abs/1603.00788">ADVI</a> ), about why all this is needed and will show with rather simple examples from the PyMC3 gallery how this can be useful.  One such example would be the Bayesian neural network for the classification task, but this is at the very end.  Who cares - welcome! </p><br><a name="habracut"></a><br><h1 id="vvedenie">  Introduction </h1><br><p>  Before turning to the main part, I consider it necessary to refresh the terminology of Bayesian analysis.  The subject of this subsection of the theory of probability is the derivation of the posterior distribution.  The task is as follows: </p><br><p>  The analyst wants to learn something about the unobservable (latent) parameters of the model. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> z </script>  and he has some thoughts on how they can be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">p</span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">z</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.156ex" height="2.66ex" viewBox="-38.5 -832 1789.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="1361" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> p (z) </script>  .  In addition, he can judge how well his data <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.924ex" height="2.057ex" viewBox="0 -780.1 828.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> D </script>  fit into the model with parameters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> z </script>  .  This is expressed through credibility <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">p</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">D</span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">z</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.727ex" height="2.66ex" viewBox="-38.5 -832 2896.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-7C" x="1721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="2468" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> p (D | z) </script>  - probability of observing the data with the given parameters. </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-20"><span class="MJXp-mtext" id="MJXp-Span-21">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">p</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">z</span><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">D</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">c</span><span class="MJXp-mrow" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">p</span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">z</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">D</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">p</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">D</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-53">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">c</span><span class="MJXp-mrow" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">p</span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">D</span><span class="MJXp-mrow" id="MJXp-Span-62"><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">z</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">p</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">z</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">p</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">D</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="56.412ex" height="2.66ex" viewBox="0 -832 24288.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="2476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="2980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="3369" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-7C" x="3838" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="4116" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="4945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-3D" x="5612" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-66" x="6918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-72" x="7469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-61" x="7920" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-63" x="8450" y="0"></use><g transform="translate(8883,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-2C" x="1361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="1806" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="2635" y="0"></use></g><g transform="translate(11908,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="1721" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-3D" x="14297" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-66" x="15603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-72" x="16153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-61" x="16605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-63" x="17134" y="0"></use><g transform="translate(17568,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-7C" x="1721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="2468" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="2858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="3361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="3751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="4219" y="0"></use></g><g transform="translate(22177,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="1721" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> \ large p (z | D) = \ frac {p (z, D)} {p (D)} = \ frac {p (D | z) p (z)} {p (D)} </script></p><br><p>  Where </p><br><ul><li><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">p</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">z</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.156ex" height="2.66ex" viewBox="-38.5 -832 1789.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="1361" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> p (z) </script>  - a priori distribution, assumptions about the expected results. <br>  When you approach the solution of a problem, very often there is an idea of ‚Äã‚Äãthe phenomenon that is being investigated. </p><br><ul><li>  For example, take the field of physics.  There are laws and mechanisms of interaction, we have a good idea about them (except for some values, such as the coefficient of friction of a substance with a surface).  We roughly assume what it should be, based on past experience and accumulated knowledge.  At least that it is more than zero.  We can build an experiment by creating a physical model with an unknown parameter that we want to evaluate. </li><li>  <strong>Important note:</strong> Sometimes it is tempting to adjust the prior distribution to the observed data.  Say, for example, that we figured on the data that the desired <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> z </script>  somewhere around <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mn" id="MJXp-Span-83">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-33" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> 3 </script>  and begin to display a posteriori.  Wait, but when you, for example, prove a theorem, you do not use its results to prove it?  Similarly, the prior distribution should not be based on the data set <em>under study</em> . </li></ul><br></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">p</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">D</span><span class="MJXp-mrow" id="MJXp-Span-88"><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">z</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.727ex" height="2.66ex" viewBox="-38.5 -832 2896.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-7C" x="1721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="2468" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> p (D | z) </script>  - credibility, assessment of the adequacy of the alleged <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> z </script>  .  It is expressed in the probability of observing the data subject to the hypothesis chosen <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> z </script>  . <br><ul><li>  We have the results of the experiment, for each set of parameters we can evaluate, "how well the model describes the world."  This idea is used by classic statistics in MLE estimation. </li></ul></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">p</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">z</span><span class="MJXp-mrow" id="MJXp-Span-100"><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">D</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.727ex" height="2.66ex" viewBox="-38.5 -832 2896.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-7A" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-7C" x="1361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMATHI-44" x="1640" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322716/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjrfPAcSo0ovwlR4iAZCHlWy74ZVQ#MJMAIN-29" x="2468" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> p (z | D) </script>  - a posteriori distribution, the conclusions that we want to get. <br><ul><li>  In fact, these are the ideas about the unknown parameters of the model (coefficient of friction) that we formed during the course of the experiment.  It can be considered a compromise between old knowledge and new, expressed through <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">p</span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">z</span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> p (z) </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">p</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">D</span><span class="MJXp-mrow" id="MJXp-Span-113"><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">z</span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> p (D | z) </script>  respectively. </li></ul></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">p</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">D</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> p (D) </script>  - Evidence, the probability of obtaining such data in general, is translated badly into Russian. </li></ul><br><h1 id="bayesovskiy-vyvod">  Bayesian output </h1><br><p>  At first glance, nothing special: we have density formulas <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">p</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">D</span><span class="MJXp-mrow" id="MJXp-Span-126"><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">z</span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> p (D | z) </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">p</span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">z</span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> p (z) </script>  , the density sought is as follows: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-135"><span class="MJXp-mtext" id="MJXp-Span-136">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">p</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">z</span><span class="MJXp-mrow" id="MJXp-Span-145"><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">D</span><span class="MJXp-mo" id="MJXp-Span-148" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">c</span><span class="MJXp-mrow" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">p</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">D</span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">z</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">p</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">z</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">p</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">D</span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-173">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">c</span><span class="MJXp-mrow" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">p</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">D</span><span class="MJXp-mrow" id="MJXp-Span-182"><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">z</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">p</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">z</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-190"><span class="MJXp-mtext" id="MJXp-Span-191">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">p</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">D</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">z</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">p</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">z</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">z</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-19"> \ large p (z | D) = \ frac {p (D | z) p (z)} {p (D)} = \ frac {p (D | z) p (z)} {\ int p ( D | z) p (z) dz} </script></p><br><p>  Multiply two densities - not a problem.  Calculate the integral from below? .. Hmm, well, you can recall the university course of mathematical analysis ... In general, we take, we substitute everything in the formula and it is ready.  Armed with this knowledge, you can safely go to explore simple models with simple distributions.  However, in more or less approximated examples of life, even such knowledge will not save and it is analytically impossible to take the integral analytically. </p><br><h1 id="zachem-vse-eto">  Why all this? </h1><br><p>  Well, if we can not display the distribution <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">p</span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">z</span><span class="MJXp-mrow" id="MJXp-Span-212"><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">D</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> p (z | D) </script>  why not just restrict ourselves to a point estimate, say, where the distribution density is maximal?  Well, or in a pinch, do not even do this and look for a maximum <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">p</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">D</span><span class="MJXp-mrow" id="MJXp-Span-220"><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">z</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> p (D | z) </script>  , we want to build a model that explains our data.  The first approach is called the <strong>MAP</strong> (maximum a posterior) score. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-224"><span class="MJXp-msubsup" id="MJXp-Span-225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-227" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">a</span><span class="MJXp-msubsup" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-239" style="vertical-align: -0.4em;">z</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">p</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">z</span><span class="MJXp-mrow" id="MJXp-Span-243"><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">D</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> z ^ {map} = argmax_z p (z | D) </script>  and the second is <strong>ML</strong> (maximum likelihood) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-247"><span class="MJXp-msubsup" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-250" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">l</span></span></span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">a</span><span class="MJXp-msubsup" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-261" style="vertical-align: -0.4em;">z</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">p</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">D</span><span class="MJXp-mrow" id="MJXp-Span-265"><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">z</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> z ^ {ml} = argmax_z p (D | z) </script>  .  The second method, almost every student of a technical college was in the course of probability theory. </p><br><p>  ML estimates have a number of drawbacks.  The most intuitive of them is that even a complex model may seem attractive in terms of this criterion.  After all, the more likely the better, but with an increase in parameters, the model can simply repeat the data.  This fact is misleading and makes it necessary to justify why the model is adequate.  From the point of view of Bayesian inference, you can imagine ML valuation as MAP with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">p</span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">z</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">U</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">m</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">y</span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-291">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">y</span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> p (z) = Uniform [- \ infty, \ infty] </script>  .  Yes, the integral is not taken, but we have a point estimate and this will not interfere with us, we consider the density <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">p</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">z</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> p (z) </script>  constant. </p><br><p>  <strong>Evidence</strong> </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-303"><span class="MJXp-mtext" id="MJXp-Span-304">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">p</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">z</span><span class="MJXp-mrow" id="MJXp-Span-313"><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">D</span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">c</span><span class="MJXp-mrow" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">p</span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">z</span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">D</span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">p</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">D</span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-336">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">c</span><span class="MJXp-mrow" id="MJXp-Span-341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">p</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">D</span><span class="MJXp-mrow" id="MJXp-Span-345"><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">z</span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">p</span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">z</span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">p</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">D</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-358">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> \ large p (z | D) = \ frac {p (z, D)} {p (D)} = \ frac {p (D | z) p (z)} {p (D)} \ rightarrow max </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-372"><span class="MJXp-mtext" id="MJXp-Span-373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">e</span><span class="MJXp-mtext" id="MJXp-Span-379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">p</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">z</span><span class="MJXp-mrow" id="MJXp-Span-386"><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">D</span><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">g</span><span class="MJXp-mtext" id="MJXp-Span-395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">c</span><span class="MJXp-mrow" id="MJXp-Span-400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">p</span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">z</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">D</span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">p</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">D</span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">g</span><span class="MJXp-mtext" id="MJXp-Span-417">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">c</span><span class="MJXp-mrow" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">p</span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">D</span><span class="MJXp-mrow" id="MJXp-Span-426"><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">z</span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">p</span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">z</span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">p</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">D</span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-439">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> \ large \ log p (z | D) = \ log \ frac {p (z, D)} {p (D)} = \ log \ frac {p (D | z) p (z)} {p ( D)} \ rightarrow max </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-453"><span class="MJXp-mtext" id="MJXp-Span-454">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">e</span><span class="MJXp-mtext" id="MJXp-Span-460">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">m</span><span class="MJXp-mtext" id="MJXp-Span-464">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">g</span><span class="MJXp-mrow" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">p</span><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">D</span><span class="MJXp-mrow" id="MJXp-Span-472"><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">z</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">p</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">z</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-481">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">g</span><span class="MJXp-mrow" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">p</span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">D</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-490">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> \ large \ sim \ log {p (D | z) p (z)} - \ log {p (D)} \ rightarrow max </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-504"><span class="MJXp-mtext" id="MJXp-Span-505">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">e</span><span class="MJXp-mtext" id="MJXp-Span-511">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">m</span><span class="MJXp-mtext" id="MJXp-Span-515">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">g</span><span class="MJXp-mrow" id="MJXp-Span-519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">p</span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">D</span><span class="MJXp-mrow" id="MJXp-Span-523"><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">z</span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-528">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">g</span><span class="MJXp-mrow" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">p</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">z</span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-537">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-29"> \ large \ sim \ log {p (D | z)} + \ log {p (z)} \ rightarrow max </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-551"><span class="MJXp-mtext" id="MJXp-Span-552">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">e</span><span class="MJXp-mtext" id="MJXp-Span-558">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">m</span><span class="MJXp-mtext" id="MJXp-Span-562">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">g</span><span class="MJXp-mrow" id="MJXp-Span-566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">p</span><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">D</span><span class="MJXp-mrow" id="MJXp-Span-570"><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">z</span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-574">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-30"> \ large \ sim \ log {p (D | z)} \ rightarrow max </script></p><br><p>  This kind of prior distribution is called the <strong>Improper Priors</strong> , and specifically it is also <strong>Uninformative</strong> (non-informative). </p><br><p>  In other words, we have no idea what should be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> z </script>  in fact.  Lost the ability to use all available information.  For example: </p><br><ol><li>  For some problem from the theory it is reliably known that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> z </script>  strictly greater than zero.  This can be corrected by conversion, but if you change the setting to <em>‚Äúrather more than less than zero,‚Äù</em> then ML cannot take this into account. </li><li>  For the case of linear regression, when there are a large number of regressors, there is a belief that not all of them are important.  Then in the vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> z </script>  (coefficients) many zero components. </li></ol><br><p>  The standard approach is good simplicity of implementation and the studied asymptotic properties, but MAP is more meaningful in a number of situations. </p><br><div class="spoiler">  <b class="spoiler_title">Import all necessary</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> theano <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> theano, tensor <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pymc3 <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datasets <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> warnings <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scipy.stats <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> stats warnings.filterwarnings(<span class="hljs-string"><span class="hljs-string">'ignore'</span></span>) %matplotlib inline plt.mpl.style.use(<span class="hljs-string"><span class="hljs-string">'ggplot'</span></span>)</code> </pre> </div></div><br><h1 id="primer-s-monetkoy">  Coin example </h1><br><p>  Let's see what happens with the a posteriori distribution when we get new observations.  This is very similar to a change in confidence in its most ordinary sense.  At first, we know nothing, but when we get examples, our understanding of unobservable factors changes.  For a visual representation, I will use the honest conclusion of the a posteriori distribution. </p><br><p>  Having prior <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">U</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">m</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-603">0</span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-605">1</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> Uniform [0, 1] </script>  (equivalent to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">a</span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-613">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">a</span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-620">1</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-622">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">a</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-628">1</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> Beta [\ alpha = 1, \ beta = 1] </script>  ) for the probability of getting an "eagle" <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> r </script>  and having the observation "eagle" <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> t </script>  and "tails" <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> f </script>  , Total <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> N </script>  observations, we obtain the posterior distribution on the probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">a</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-644">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">a</span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">t</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-653">1</span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-655">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">a</span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">f</span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-663">1</span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> Beta [\ alpha = t + 1, \ beta = f + 1] </script>  . </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-665"><span class="MJXp-mtext" id="MJXp-Span-666">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">p</span><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">r</span><span class="MJXp-mrow" id="MJXp-Span-675"><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">T</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">t</span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">F</span><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">f</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-686">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">c</span><span class="MJXp-mrow" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">p</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">T</span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">t</span><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">F</span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">f</span><span class="MJXp-mrow" id="MJXp-Span-701"><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">r</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">p</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">r</span><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-709"><span class="MJXp-mtext" id="MJXp-Span-710">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">p</span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">T</span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">t</span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">F</span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">f</span><span class="MJXp-mrow" id="MJXp-Span-723"><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">r</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">p</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">r</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">r</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> \ large p (r | T = t, F = f) = \ frac {p (T = t, F = f | r) p (r)} {\ int p (T = t, F = f | r ) p (r) dr} </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-733"><span class="MJXp-mtext" id="MJXp-Span-734">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">e</span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-741">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">c</span><span class="MJXp-mrow" id="MJXp-Span-746"><span class="MJXp-msubsup" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">k</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">N</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-753" style="vertical-align: 0.5em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-755">1</span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">r</span><span class="MJXp-msubsup" id="MJXp-Span-758"><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-760" style="vertical-align: 0.5em;">f</span></span></span><span class="MJXp-mrow" id="MJXp-Span-761"><span class="MJXp-mtext" id="MJXp-Span-762">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">n</span><span class="MJXp-msubsup" id="MJXp-Span-765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-768">1</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-767">0</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">k</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">N</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-775" style="vertical-align: 0.5em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-777">1</span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">r</span><span class="MJXp-msubsup" id="MJXp-Span-780"><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-782" style="vertical-align: 0.5em;">f</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">f</span></span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-786">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">c</span><span class="MJXp-mrow" id="MJXp-Span-791"><span class="MJXp-msubsup" id="MJXp-Span-792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-794" style="vertical-align: 0.5em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-796">1</span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">r</span><span class="MJXp-msubsup" id="MJXp-Span-799"><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-801" style="vertical-align: 0.5em;">f</span></span></span><span class="MJXp-mrow" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">B</span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">t</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-807">1</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">f</span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-811">1</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-42"> \ large = \ frac {C_N ^ kr ^ t (1-r) ^ f} {\ int_0 ^ 1 C_N ^ kr ^ t (1-r) ^ fdf} = \ frac {r ^ t (1-r) ^ f} {B (t + 1, f + 1)} </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-813"><span class="MJXp-mtext" id="MJXp-Span-814">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">e</span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">a</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">r</span><span class="MJXp-mspace" id="MJXp-Span-827" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-828"><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-830">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">a</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">t</span><span class="MJXp-mo" id="MJXp-Span-838" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-839">1</span><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-841">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">a</span><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">f</span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-849">1</span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-43"> \ large = Beta (r \; | \ alpha = t + 1, \ beta = f + 1) </script></p><br><p>  For visual illustration, several auxiliary functions and synthetic data are required. </p><br><div class="spoiler">  <b class="spoiler_title">Secondary functions</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     def posterior(t, f): """ t :  f :  """ return stats.beta(a=t+1, b=f+1) #     def plot_pdf(dist, ax, c): space = np.linspace(0, 1) pdf = dist.pdf(space) ax.plot(space, pdf, c=c, alpha=.5) return ax</span></span></code> </pre> </div></div><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  true_p = .3 #    "" random.seed(42) #    trials = np.random.uniform(size=100) &lt; true_p #  ,  1   #   [t, f] observed = np.array(list(zip(np.cumsum(trials), np.arange(1, trials.size+1) - np.cumsum(trials)))) observed[:6]</span></span></code> </pre> <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">array</span></span>(<span class="hljs-selector-attr"><span class="hljs-selector-attr">[[0, 1]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0, 2]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0, 3]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0, 4]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[1, 4]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[2, 4]</span></span>])</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Draw graphics</b> <div class="spoiler_text"><pre> <code class="python hljs">fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>)) cmap = plt.get_cmap(<span class="hljs-string"><span class="hljs-string">'cool'</span></span>) plot_pdf(posterior(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), ax, cmap(<span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (t, f), c <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(observed, np.linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, num=observed.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>])): plot_pdf(posterior(t, f), ax, cmap(c)) plt.title(<span class="hljs-string"><span class="hljs-string">'     '</span></span>) plt.show()</code> </pre> </div></div><br><p><img src="https://habrastorage.org/files/45d/6a0/2ad/45d6a02adf984713a4ceca924e18f769.png" alt="png"></p><br><p>  The more examples we see, the more narrow the posterior distribution becomes, this is a manifestation of confidence in new knowledge.  What is more interesting is the behavior of the distribution with a small number of observations: it adequately reflects the uncertainty.  This does not happen if we use the methods of classical statistics and look for the MLE estimate.  We would get a probability of 0 for an eagle with a small number of observations, which, of course, is not so. </p><br><h1 id="motivaciya">  Motivation </h1><br><p>  <strong>PyMC3</strong> allows you to display a posteriori distribution without directly outputting formulas.  This makes possible the Bayesian probabilistic inference on virtually any adequate models.  Moreover, it can be used to build probabilistic neural networks in which, instead of parameters, distributions and, therefore, predictions are also distributions. <br><img src="https://ai2-s2-public.s3.amazonaws.com/figures/2016-11-08/da6057368920585bcf2443295b98418840f1fc80/1-Figure1-1.png"></p><br><h1 id="nachalo-raboty-s-pymc3">  Getting started with PyMC3 </h1><br><p>  The <em>PyMC3</em> library <em>is</em> written on top of <em><a href="http://deeplearning.net/software/theano/">Theano</a></em> and therefore can be used with it.  <em>Theano</em> is a library for tensor algebra and is widely used for deep learning.  It supports symbolic operations and differentiation, which makes possible not only the training of neural networks with the help of <em>backprop</em> , but also the Baes variational conclusion. </p><br><p>  Working with <em>PyMC3</em> mostly resembles working with <em>Theano</em> , in one of our previous <a href="https://habrahabr.ru/company/ods/blog/323272/">posts</a> it is well written. </p><br><p>  The base part of the library is the model ( <code>pm.Model</code> ), it allows on the fly to make up the a posteriori density (more precisely, its non-normalized part).  In order for this to work with a nice interface, a little magic is applied with the context manager.  Latent variables in <em>PyMC3</em> are declared inside the context <code>with model: ...</code> </p><br><p>  The latent variables themselves are variables in the sense of <code>Theano</code> , for them everything that is true of ordinary tensors in <code>Theano</code> is true.  This is useful to remember, so as not to be afraid to experiment and build more complex models. </p><br><p>  We will build the model sequentially in order to demonstrate by an illustrative example that MCMC methods with an increase in the complexity of the model can worsen their results, or, at least, become unacceptably slow. </p><br><p>  You can <code>pm.sample</code> it using the <code>pm.sample</code> helper function, it works well with the default settings, but they have been changed for demonstration purposes.  By default, suitable parameters are pre-selected for the MCMC method, which is not needed right now. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   import pymc3 as pm with pm.Model() as simple_model: #          #        norm = pm.Normal('norm', 0, 1) #     MCMC  NUTS step = pm.NUTS() trace = pm.sample(1000, step=step) #       :       </span></span></code> </pre> <br><pre> <code class="hljs vhdl"><span class="hljs-literal"><span class="hljs-literal">WARNING</span></span> (theano.tensor.blas): We did <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> found a dynamic <span class="hljs-keyword"><span class="hljs-keyword">library</span></span> into the library_dir <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">library</span></span> we <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> blas. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> you <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> ATLAS, make sure <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> compile it <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> dynamics <span class="hljs-keyword"><span class="hljs-keyword">library</span></span>. <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">1000</span></span>/<span class="hljs-number"><span class="hljs-number">1000</span></span> [<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">1368.27</span></span>it/s]</code> </pre> <br><h2 id="trace-plot">  Trace plot </h2><br><p>  To visualize the results there are great utilities.  For example, <strong>TracePlot</strong> .  This is a graph of the history of the Markov chain.  Analyzing it, you can understand how well the algorithm worked and whether it requires additional configuration.  Visual quality criteria are: </p><br><ol><li>  Stationarity.  Samples must form noise around a value. </li><li>  Do not have a strong autocorrelation.  Sometimes this can be expected (see below), but it is better that it is not </li><li>  All history cannot be from the same recurring point.  If some variable remained constant, then most likely something went wrong in the code of the model itself. </li></ol><br><pre> <code class="python hljs">pm.traceplot(trace);</code> </pre> <br><p><img src="https://habrastorage.org/files/d10/22f/00d/d1022f00d5c74f83922aad575a947770.png" alt="png"></p><br><p>  Let's complicate the model a bit </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> simple_model: norm = pm.Normal(<span class="hljs-string"><span class="hljs-string">'norm'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment">#          laplace = pm.Laplace('lap', mu=norm, b=3) step = pm.NUTS() trace = pm.sample(1000, step=step)</span></span></code> </pre> <br><pre> <code class="hljs matlab"><span class="hljs-number"><span class="hljs-number">100</span></span><span class="hljs-comment"><span class="hljs-comment">%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1000/1000 [00:36&lt;00:00, 27.10it/s]</span></span></code> </pre> <br><p>  Turbulence in the Markov chain for normal distribution became noticeable. </p><br><pre> <code class="python hljs">pm.traceplot(trace);</code> </pre> <br><p><img src="https://habrastorage.org/files/01b/a4e/c5a/01ba4ec5a2884b409e5bd3cb82d20328.png" alt="png"></p><br><p>  This is what happens when the model becomes non-trivial, although it should have been with an independent normally distributed first variable.  For such cases, you can first tighten the ADVI and use the covariance matrix and the means from there to initialize NUTS.  But first, more about ADVI. </p><br><h2 id="advi">  ADVI </h2><br><p>  ADVI stands for <em>Automatic Differentiation Variational Inference</em> ( <a href="https://arxiv.org/abs/1603.00788">link to the article</a> ).  This is perhaps one of the most simple and frequently used algorithms for approximate Bayesian inference.  When the dimension of the latent space grows, MCMC methods become either quite complicated to set up (default parameters are not suitable), or the iterations take a huge amount of time.  The fact that the default parameters may not be suitable, we have seen above.  And then it becomes necessary to at least bring closer the target distribution of those with which we can work. </p><br><h3 id="teoriya">  Theory </h3><br><p>  The essence of the method is that it approximates the posterior distribution <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">p</span><span class="MJXp-mo" id="MJXp-Span-853" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">z</span><span class="MJXp-mrow" id="MJXp-Span-855"><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">D</span><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> p (z | D) </script>  other distribution <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">q</span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">z</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> q (z) </script>  , for which we can count the density and sample.  In the classical formulation, such a distribution is a multidimensional normal with a diagonal covariance matrix. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-mtext" id="MJXp-Span-865">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">l</span><span class="MJXp-mrow" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">N</span></span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-876">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">r</span><span class="MJXp-mrow" id="MJXp-Span-880"><span class="MJXp-mn" id="MJXp-Span-881">0</span></span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">g</span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-888">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">r</span><span class="MJXp-msubsup" id="MJXp-Span-892"><span class="MJXp-mrow" id="MJXp-Span-893" style="margin-right: 0.05em;"><span class="MJXp-mtext" id="MJXp-Span-894">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">a</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-900" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> \ mathcal {N} (\ bar {0}, diag (\ bar {\ sigma} ^ 2)) </script>  .  This is its main drawback: it is assumed that latent variables are independent, but this, of course, is not always the case.  Nevertheless, even with such a strong premise one can achieve good results.  Next, we will see how this simplification saves computational resources. </p><br><h4 id="postanovka-zadachi">  Formulation of the problem </h4><br><p>  Let there be observations <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-903"><span class="MJXp-mtext" id="MJXp-Span-904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">l</span><span class="MJXp-mrow" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">D</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ mathcal {D} </script>  , parametric model with parameters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">z</span><span class="MJXp-mtext" id="MJXp-Span-916">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">n</span><span class="MJXp-mtext" id="MJXp-Span-919">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">l</span><span class="MJXp-msubsup" id="MJXp-Span-927"><span class="MJXp-mrow" id="MJXp-Span-928" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-930" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> z \ in \ mathcal {R} ^ n </script>  and its likelihood function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">p</span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">D</span><span class="MJXp-mrow" id="MJXp-Span-935"><span class="MJXp-mo" id="MJXp-Span-936" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">z</span><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> p (D | z) </script>  .  In addition, the Bayesian approach requires an a priori distribution on the model parameters. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">p</span><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">z</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> p (z) </script>  .  By Bayes' rule, we derive the posterior distribution of the parameters: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-944"><span class="MJXp-mtext" id="MJXp-Span-945">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">p</span><span class="MJXp-mo" id="MJXp-Span-952" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">z</span><span class="MJXp-mrow" id="MJXp-Span-954"><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">D</span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-959">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">c</span><span class="MJXp-mrow" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">p</span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">D</span><span class="MJXp-mrow" id="MJXp-Span-968"><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">z</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">p</span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">z</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mtext" id="MJXp-Span-977">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">t</span><span class="MJXp-mrow" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">p</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">D</span><span class="MJXp-mrow" id="MJXp-Span-985"><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">z</span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">p</span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">z</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">z</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-51"> \ large p (z | D) = \ frac {p (D | z) p (z)} {\ int {p (D | z) p (z) dz}} </script></p><br><p>  A part without a normalizing constant is usually not difficult to calculate: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-995"><span class="MJXp-mtext" id="MJXp-Span-996">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">p</span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">z</span><span class="MJXp-mrow" id="MJXp-Span-1005"><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">D</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1009">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">p</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">D</span><span class="MJXp-mrow" id="MJXp-Span-1019"><span class="MJXp-mo" id="MJXp-Span-1020" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">z</span><span class="MJXp-mo" id="MJXp-Span-1022" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">p</span><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">z</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-52"> \ large p (z | D) \ propto p (D | z) p (z) </script></p><br><p>  Set the parametric family of distributions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1027"><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1030" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1031">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1037">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">Q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> q _ {\ theta} \ in Q </script>  with whom we will work. </p><br><p>  <em>Metrics.</em>  The standard choice for the metric in the distribution space is the Kullback-Leibler distance. </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1041"><span class="MJXp-mtext" id="MJXp-Span-1042">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">L</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">q</span><span class="MJXp-mrow" id="MJXp-Span-1052"><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1054"><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">p</span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1059">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">b</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mrow" id="MJXp-Span-1067" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1069" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">q</span><span class="MJXp-mo" id="MJXp-Span-1071">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">z</span><span class="MJXp-mo" id="MJXp-Span-1073">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">q</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">z</span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">p</span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">z</span><span class="MJXp-mrow" id="MJXp-Span-1089"><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">D</span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-54"> \ large KL (q || p) = \ mathbb {E} _ {q (z)} [log q (z) -logp (z | D)] </script></p><br><p>  If the distributions match, then the expectation is zero, otherwise the expectation is greater than zero.  Thus, the Bayesian inference problem is reduced to the optimization problem. </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1094"><span class="MJXp-mtext" id="MJXp-Span-1095">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">e</span><span class="MJXp-msubsup" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1103" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1104">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">t</span><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1111" style="vertical-align: 0.5em;">‚àó</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1113">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">t</span><span class="MJXp-mrow" id="MJXp-Span-1122"><span class="MJXp-msubsup" id="MJXp-Span-1123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1125" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1126">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1132">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">Q</span></span><span class="MJXp-mrow" id="MJXp-Span-1136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">n</span></span><span class="MJXp-mspace" id="MJXp-Span-1143" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">K</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">L</span><span class="MJXp-mo" id="MJXp-Span-1146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148" style="margin-right: 0.05em;">q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1149" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">a</span><span class="MJXp-mrow" id="MJXp-Span-1155"><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1157"><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">p</span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-55"> \ large q _ {\ theta ^ *} = \ underset {q _ {\ theta} \ in Q} {argmin} \; KL (q_ \ theta || p) </script></p><br><h4 id="reshenie-zadachi">  The solution of the problem </h4><br><p>  This problem is solved by a stochastic gradient descent.  For this you need to take the derivative of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mtext" id="MJXp-Span-1162">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ theta </script>  . </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1168"><span class="MJXp-mtext" id="MJXp-Span-1169">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">e</span><span class="MJXp-mtext" id="MJXp-Span-1175">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">b</span><span class="MJXp-msubsup" id="MJXp-Span-1182"><span class="MJXp-mrow" id="MJXp-Span-1183" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1185" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1188" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1189">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1195">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">z</span><span class="MJXp-mo" id="MJXp-Span-1197">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">g</span><span class="MJXp-msubsup" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1204" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1205">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">z</span><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">p</span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">z</span><span class="MJXp-mrow" id="MJXp-Span-1221"><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">D</span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-57"> \ large \ mathbb {E} _ {q _ {\ theta} (z)} [log q _ {\ theta} (z) -logp (z | D)] </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1226"><span class="MJXp-mtext" id="MJXp-Span-1227">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">e</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">b</span><span class="MJXp-msubsup" id="MJXp-Span-1241"><span class="MJXp-mrow" id="MJXp-Span-1242" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1244" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1247" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1254">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">z</span><span class="MJXp-mo" id="MJXp-Span-1256">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">g</span><span class="MJXp-msubsup" id="MJXp-Span-1261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1263" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">z</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">b</span><span class="MJXp-msubsup" id="MJXp-Span-1282"><span class="MJXp-mrow" id="MJXp-Span-1283" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1285" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1288" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1295">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">z</span><span class="MJXp-mo" id="MJXp-Span-1297">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">p</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">z</span><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mo" id="MJXp-Span-1306" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">D</span><span class="MJXp-mo" id="MJXp-Span-1308" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-58"> \ large = \ mathbb {E} _ {q _ {\ theta} (z)} [log q _ {\ theta} (z)] - \ mathbb {E} _ {q _ {\ theta} (z)} [logp (z | D)] </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1310"><span class="MJXp-mtext" id="MJXp-Span-1311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">e</span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">b</span><span class="MJXp-msubsup" id="MJXp-Span-1325"><span class="MJXp-mrow" id="MJXp-Span-1326" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1328" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1331" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1338">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">z</span><span class="MJXp-mo" id="MJXp-Span-1340">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1341" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">g</span><span class="MJXp-msubsup" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1347" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">z</span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1357" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1358" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">b</span><span class="MJXp-msubsup" id="MJXp-Span-1366"><span class="MJXp-mrow" id="MJXp-Span-1367" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1369" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1372" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1379">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">z</span><span class="MJXp-mo" id="MJXp-Span-1381">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">p</span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">D</span><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">z</span><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1393" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">b</span><span class="MJXp-msubsup" id="MJXp-Span-1402"><span class="MJXp-mrow" id="MJXp-Span-1403" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1405" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1408" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1409">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1415">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">z</span><span class="MJXp-mo" id="MJXp-Span-1417">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">p</span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">z</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1428">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">b</span><span class="MJXp-msubsup" id="MJXp-Span-1435"><span class="MJXp-mrow" id="MJXp-Span-1436" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1438" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1441" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1442">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1448">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">z</span><span class="MJXp-mo" id="MJXp-Span-1450">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">p</span><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">D</span><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-59"> \ large = \ mathbb {E} _ {q _ {\ theta} (z)} [log q _ {\ theta} (z)] - \ mathbb {E} _ {q _ {\ theta} (z)} [logp (D | z)] - \ mathbb {E} _ {q _ {\ theta} (z)} [logp (z)] + \ mathbb {E} _ {q _ {\ theta} (z)} [logp (D )] </script></p><br><p>  We have completely decomposed the KL-metric, and since it must be minimized, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-mtext" id="MJXp-Span-1461">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">b</span><span class="MJXp-msubsup" id="MJXp-Span-1468"><span class="MJXp-mrow" id="MJXp-Span-1469" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1471" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1474" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1475">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1481">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">z</span><span class="MJXp-mo" id="MJXp-Span-1483">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">p</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">D</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> \ mathbb {E} _ {q _ {\ theta} (z)} [logp (D)] </script>  anyway constant, then there is no need to consider it.  Thus, we get rid of the main problem of the analytical inference of the posterior distribution, the non-unstable integral.  All that remains is <math> </math> $ inline $ -ELBO $ inline $   ( <em>Evidence Lower BOund</em> ). </p><br><p>  It would seem, then everything is set analytically and is well considered, but there is one thing.  To take a derivative with respect to parameters, one will have to take a derivative with respect to the integral, which, in turn, depends on these very parameters.  If we do this using the MC method and approximate the integral with several samples, we will encounter the fact that the gradients have a large variance.  This can be avoided, and the family of posterior distributions we have chosen allows us to do this.  The following theorem demonstrates the conditions when the derivative can be introduced under the sign of the integral. </p><br><p>  <strong>Theorem</strong> </p><br><p>  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mtext" id="MJXp-Span-1500">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> \ epsilon </script>  random variable with distribution density <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">q</span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1511">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">n</span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> q (\ epsilon) </script>  let it go <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">z</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">t</span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1525">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">a</span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1532">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">n</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> z = t (\ theta, \ epsilon) </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> t </script>  - deterministic reversible function.  Let the distribution density of a random variable <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> z </script>  this <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">q</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">z</span><span class="MJXp-mrow" id="MJXp-Span-1549"><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1551">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">a</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> q (z | \ theta) </script>  .  Suppose further that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">q</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">n</span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">d</span><span class="MJXp-mtext" id="MJXp-Span-1571">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">n</span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">q</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">z</span><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-mo" id="MJXp-Span-1584" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1585">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">a</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> q (\ epsilon) d \ epsilon = q (z | \ theta) dz </script>  . <br>  Then for the function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">f</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> f </script>  with derivative <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> z </script>  done </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1598"><span class="MJXp-mtext" id="MJXp-Span-1599">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">e</span><span class="MJXp-mtext" id="MJXp-Span-1605">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">c</span><span class="MJXp-mrow" id="MJXp-Span-1610"><span class="MJXp-mtext" id="MJXp-Span-1611">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">l</span></span><span class="MJXp-mrow" id="MJXp-Span-1619"><span class="MJXp-mtext" id="MJXp-Span-1620">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">l</span><span class="MJXp-mtext" id="MJXp-Span-1628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">a</span></span><span class="MJXp-mtext" id="MJXp-Span-1634">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">b</span><span class="MJXp-msubsup" id="MJXp-Span-1641"><span class="MJXp-mrow" id="MJXp-Span-1642" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1644" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">q</span><span class="MJXp-mo" id="MJXp-Span-1646">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">z</span><span class="MJXp-mrow" id="MJXp-Span-1648"><span class="MJXp-mo" id="MJXp-Span-1649">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">a</span><span class="MJXp-mo" id="MJXp-Span-1656">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">f</span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">z</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">a</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1671">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">b</span><span class="MJXp-msubsup" id="MJXp-Span-1678"><span class="MJXp-mrow" id="MJXp-Span-1679" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1681" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">q</span><span class="MJXp-mo" id="MJXp-Span-1683">(</span><span class="MJXp-mtext" id="MJXp-Span-1684">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">n</span><span class="MJXp-mo" id="MJXp-Span-1692">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1694">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">c</span><span class="MJXp-mrow" id="MJXp-Span-1699"><span class="MJXp-mtext" id="MJXp-Span-1700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1704">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">f</span><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">z</span><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">a</span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1719"><span class="MJXp-mtext" id="MJXp-Span-1720">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">z</span></span><span class="MJXp-mtext" id="MJXp-Span-1729">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">c</span><span class="MJXp-mrow" id="MJXp-Span-1734"><span class="MJXp-mtext" id="MJXp-Span-1735">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">z</span></span><span class="MJXp-mrow" id="MJXp-Span-1744"><span class="MJXp-mtext" id="MJXp-Span-1745">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">l</span><span class="MJXp-mtext" id="MJXp-Span-1753">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">a</span></span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1760">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">c</span><span class="MJXp-mrow" id="MJXp-Span-1765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">f</span><span class="MJXp-mo" id="MJXp-Span-1767" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">z</span><span class="MJXp-mo" id="MJXp-Span-1769" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1770">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">a</span><span class="MJXp-mo" id="MJXp-Span-1776" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1777"><span class="MJXp-mtext" id="MJXp-Span-1778">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">l</span><span class="MJXp-mtext" id="MJXp-Span-1786">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">a</span></span><span class="MJXp-mo" id="MJXp-Span-1792" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-71"> \ large \ frac {\ partial} {\ partial \ theta} \ mathbb {E} _ {q (z | \ theta)} [f (z, \ theta)] = \ mathbb {E} _ {q (\ epsilon)} [\ frac {\ partial f (z, \ theta)} {\ partial z} \ frac {\ partial z} {\ partial \ theta} + \ frac {f (z, \ theta)} {\ partial \ theta}] </script></p><br><p>  This is what you need for optimization.  Insofar as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">z</span><span class="MJXp-mtext" id="MJXp-Span-1795">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">m</span><span class="MJXp-mtext" id="MJXp-Span-1799">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">l</span><span class="MJXp-mrow" id="MJXp-Span-1807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">N</span></span><span class="MJXp-mo" id="MJXp-Span-1809" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1810">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">u</span><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">p</span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">w</span><span class="MJXp-msubsup" id="MJXp-Span-1819"><span class="MJXp-mo" id="MJXp-Span-1820" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1821" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> z \ sim \ mathcal {N} (\ mu, exp (w) ^ 2) </script>  representable as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">z</span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">t</span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1828">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830">u</span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">w</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1834">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">n</span><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1844">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">n</span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">p</span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">w</span><span class="MJXp-mo" id="MJXp-Span-1858" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1859" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1860">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> z = t (\ mu, w, \ epsilon) = \ epsilon * exp (w) + \ mu </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1863"><span class="MJXp-mtext" id="MJXp-Span-1864">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">n</span><span class="MJXp-mtext" id="MJXp-Span-1872">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">m</span><span class="MJXp-mtext" id="MJXp-Span-1876">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883">l</span><span class="MJXp-mrow" id="MJXp-Span-1884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">N</span></span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1887">0</span><span class="MJXp-mo" id="MJXp-Span-1888" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1889">1</span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> \ epsilon \ sim \ mathcal {N} (0, 1) </script>  .  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1891"><span class="MJXp-mtext" id="MJXp-Span-1892">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">a</span><span class="MJXp-mo" id="MJXp-Span-1898" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1900">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">u</span><span class="MJXp-mo" id="MJXp-Span-1903" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">w</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> \ theta = (\ mu, w) </script></p><br><p>  This is called <em>Reparametrization Trick</em> .  Using it, it is already much easier to derive the derivative from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">O</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> ELBO </script>  . </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1911"><span class="MJXp-mtext" id="MJXp-Span-1912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">e</span><span class="MJXp-mo" id="MJXp-Span-1918" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1919">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">O</span><span class="MJXp-mo" id="MJXp-Span-1929" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1930">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">b</span><span class="MJXp-msubsup" id="MJXp-Span-1937"><span class="MJXp-mrow" id="MJXp-Span-1938" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1940" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1941">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">l</span><span class="MJXp-mrow" id="MJXp-Span-1949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">N</span></span><span class="MJXp-mo" id="MJXp-Span-1951">(</span><span class="MJXp-mn" id="MJXp-Span-1952">0</span><span class="MJXp-mo" id="MJXp-Span-1953">,</span><span class="MJXp-mn" id="MJXp-Span-1954">1</span><span class="MJXp-mo" id="MJXp-Span-1955">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1956" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1957">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">l</span><span class="MJXp-msubsup" id="MJXp-Span-1962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1964" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1965">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">a</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">g</span><span class="MJXp-msubsup" id="MJXp-Span-1974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975" style="margin-right: 0.05em;">q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1976" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1977">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984">t</span><span class="MJXp-mo" id="MJXp-Span-1985" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1986">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1989">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">a</span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1993">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">n</span><span class="MJXp-mo" id="MJXp-Span-2001" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-2004">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">l</span><span class="MJXp-msubsup" id="MJXp-Span-2009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2011" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2012">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">a</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021">p</span><span class="MJXp-mo" id="MJXp-Span-2022" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023">D</span><span class="MJXp-mrow" id="MJXp-Span-2024"><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">t</span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2028">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033">a</span><span class="MJXp-mo" id="MJXp-Span-2034" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2035">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">n</span><span class="MJXp-mo" id="MJXp-Span-2043" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2044" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2045" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-2046">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2049">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050">l</span><span class="MJXp-msubsup" id="MJXp-Span-2051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2053" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2054">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2058">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">a</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">p</span><span class="MJXp-mo" id="MJXp-Span-2064" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065">t</span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2067">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">a</span><span class="MJXp-mo" id="MJXp-Span-2073" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2074">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2079">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">n</span><span class="MJXp-mo" id="MJXp-Span-2082" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-77"> \ large - \ nabla ELBO = \ mathbb {E} _ {\ mathcal {N} (0, 1)} [\ nabla _ {\ theta} log q _ {\ theta} (t (\ theta, \ epsilon)) - \ nabla _ {\ theta} logp (D | t (\ theta, \ epsilon)) - \ nabla _ {\ theta} logp (t (\ theta, \ epsilon))] </script></p><br><p>  Making the appropriate reparameterization, it will be enough to call <code>theano.grad</code> on the expression and get a gradient higher, or rather its only sample, which is quite enough.  After that, you can use your favorite optimizer. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> simple_model: norm = pm.Normal(<span class="hljs-string"><span class="hljs-string">'norm'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) laplace = pm.Laplace(<span class="hljs-string"><span class="hljs-string">'lap'</span></span>, mu=norm, b=<span class="hljs-number"><span class="hljs-number">3</span></span>) trace = pm.sample(<span class="hljs-number"><span class="hljs-number">1000</span></span>, init=<span class="hljs-string"><span class="hljs-string">'advi'</span></span>, n_init=<span class="hljs-number"><span class="hljs-number">10000</span></span>)</code> </pre> <br><pre> <code class="hljs mel">Auto-assigning NUTS sampler... Initializing NUTS using advi... Average ELBO = <span class="hljs-number"><span class="hljs-number">-0.11837</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">10000</span></span>/<span class="hljs-number"><span class="hljs-number">10000</span></span> [<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">13764.87</span></span>it/s] Finished [<span class="hljs-number"><span class="hljs-number">100</span></span>%]: Average ELBO = <span class="hljs-number"><span class="hljs-number">-0.1085</span></span> Evidence of divergence detected, inspect ELBO. <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">1000</span></span>/<span class="hljs-number"><span class="hljs-number">1000</span></span> [<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">01</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">974.36</span></span>it/s]</code> </pre> <br><p>  Already much better. </p><br><p>  <strong>HINT:</strong> it is important to look at the Markov chain on a treyplot, ideally it should be stationary, something like here, and not very turbulent, as above </p><br><pre> <code class="python hljs">pm.traceplot(trace);</code> </pre> <br><p><img src="https://habrastorage.org/files/a65/440/a8c/a65440a8c803463eb574fd2affb5b387.png" alt="png"></p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> simple_model: norm = pm.Normal(<span class="hljs-string"><span class="hljs-string">'norm'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) laplace = pm.Laplace(<span class="hljs-string"><span class="hljs-string">'lap'</span></span>, mu=norm, b=<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-comment"><span class="hljs-comment">#    (  )   lognorm = pm.Lognormal('lognorm', sd=norm**2 + 1e-7, testval=1) trace = pm.sample(10000, n_init=40000)</span></span></code> </pre> <br><pre> <code class="hljs mel">Auto-assigning NUTS sampler... Initializing NUTS using advi... Average ELBO = <span class="hljs-number"><span class="hljs-number">-7.4197e+05</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">40000</span></span>/<span class="hljs-number"><span class="hljs-number">40000</span></span> [<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">11614.15</span></span>it/s] Finished [<span class="hljs-number"><span class="hljs-number">100</span></span>%]: Average ELBO = <span class="hljs-number"><span class="hljs-number">-1.221e+08</span></span> Evidence of divergence detected, inspect ELBO. <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">10000</span></span>/<span class="hljs-number"><span class="hljs-number">10000</span></span> [<span class="hljs-number"><span class="hljs-number">01</span></span>:<span class="hljs-number"><span class="hljs-number">06</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">150.87</span></span>it/s]</code> </pre> <br><p>  Here it is clear that there is a noticeable autocorrelation in the first Markov chain.  In fact, it is not surprising, because due to the fact that we used the square of the normal distribution as the standard deviation, NUTS was stuck in local density maxima. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  100    pm.traceplot(trace[100:]);</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/e4f/6a5/5af/e4f6a55af9794c2bb3910ce3cf29ee97.png" alt="png"></p><br><p>  The model can be made sequentially, not necessarily immediately in the same context: </p><br><pre> <code class="python hljs">random.seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) obs = random.normal(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, size=<span class="hljs-number"><span class="hljs-number">10</span></span>) + random.normal(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, size=<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> model: hc = pm.HalfCauchy(<span class="hljs-string"><span class="hljs-string">'hc'</span></span>, beta=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># your code with model: #    ,       norm = pm.Normal('norm', 0, hc, observed=obs) with model: trace = pm.sample(1000, tune=200, n_init=1000) pm.traceplot(trace[10:]);</span></span></code> </pre> <br><pre> <code class="hljs mel">Auto-assigning NUTS sampler... Initializing NUTS using advi... Average ELBO = <span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">954.7</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">1000</span></span>/<span class="hljs-number"><span class="hljs-number">1000</span></span> [<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">8967.46</span></span>it/s] Finished [<span class="hljs-number"><span class="hljs-number">100</span></span>%]: Average ELBO = <span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">402.2</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">1000</span></span>/<span class="hljs-number"><span class="hljs-number">1000</span></span> [<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">1464.22</span></span>it/s]</code> </pre> <br><p><img src="https://habrastorage.org/files/d70/124/1bb/d701241bb8e94d5ea58057f70fc687e9.png" alt="png"></p><br><p>  The ideology of PyMC3 provides for verification of the model for validity in the course of construction: this is how errors are avoided at an early stage.  This is achieved by using <code>test_value</code> force. </p><br><pre> <code class="python hljs">norm.tag.test_value</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>([ <span class="hljs-number"><span class="hljs-number">-4.13746262</span></span>, <span class="hljs-number"><span class="hljs-number">-4.79556179</span></span>, <span class="hljs-number"><span class="hljs-number">3.06731129</span></span>, <span class="hljs-number"><span class="hljs-number">-17.60977173</span></span>, <span class="hljs-number"><span class="hljs-number">-17.48333168</span></span>, <span class="hljs-number"><span class="hljs-number">-5.85701227</span></span>, <span class="hljs-number"><span class="hljs-number">-8.54909801</span></span>, <span class="hljs-number"><span class="hljs-number">3.90990806</span></span>, <span class="hljs-number"><span class="hljs-number">-9.54971504</span></span>, <span class="hljs-number"><span class="hljs-number">-13.58047676</span></span>], dtype=float32)</code> </pre> <br><p>  <code>Theano</code> ideal for vectorized operations.  Therefore, if you are faced with the choice of how to set the model - through a cycle or through the creation of a random variable, it is better to choose the second option.  In this case, independent random variables are created, which can then be accessed by indices. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> model: vectorized_p = pm.Uniform(<span class="hljs-string"><span class="hljs-string">'p'</span></span>, shape=(<span class="hljs-number"><span class="hljs-number">4</span></span>,)) vectorized_p.tag.test_value</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>([ <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>], dtype=float32)</code> </pre> <br><p>  If you do not like the default initialization, you can specify your own. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> model: vectorized_p = pm.Uniform(<span class="hljs-string"><span class="hljs-string">'p'</span></span>, shape=(<span class="hljs-number"><span class="hljs-number">4</span></span>,), testval=np.ones((<span class="hljs-number"><span class="hljs-number">4</span></span>,), <span class="hljs-string"><span class="hljs-string">'float64'</span></span>) * <span class="hljs-number"><span class="hljs-number">.3</span></span>, dtype=<span class="hljs-string"><span class="hljs-string">'float64'</span></span>) vectorized_p.tag.test_value</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">array</span></span>([ <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>])</code> </pre> <br><h1 id="bayesovskaya-lineynaya-regressiya">  Bayesian linear regression </h1><br><p>  The first more or less big and meaningful example would be about the prices for Boston apartments: </p><br><pre> <code class="python hljs">data_ = datasets.load_boston() data = pd.DataFrame(data=data_[<span class="hljs-string"><span class="hljs-string">'data'</span></span>], columns=data_[<span class="hljs-string"><span class="hljs-string">'feature_names'</span></span>]) y = data_[<span class="hljs-string"><span class="hljs-string">'target'</span></span>]</code> </pre> <br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>.join(data_.DESCR.splitlines()[<span class="hljs-number"><span class="hljs-number">13</span></span>:<span class="hljs-number"><span class="hljs-number">28</span></span>]))</code> </pre> <br><pre> <code class="hljs pgsql"> :<span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Information (<span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">order</span></span>): - CRIM per capita crime rate <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> town - ZN proportion <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> residential land zoned <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lots <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">000</span></span> sq.ft. - INDUS proportion <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> non-retail business acres per town - CHAS Charles River dummy variable (= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> tract bounds river; <span class="hljs-number"><span class="hljs-number">0</span></span> otherwise) - NOX nitric oxides concentration (parts per <span class="hljs-number"><span class="hljs-number">10</span></span> million) - RM average number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> rooms per dwelling - AGE proportion <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>-occupied units built prior <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1940</span></span> - DIS weighted distances <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> five Boston employment centres - RAD <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> accessibility <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> radial highways - TAX <span class="hljs-keyword"><span class="hljs-keyword">full</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> property-tax rate per <span class="hljs-meta"><span class="hljs-meta">$10</span></span>,<span class="hljs-number"><span class="hljs-number">000</span></span> - PTRATIO pupil-teacher ratio <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> town - B <span class="hljs-number"><span class="hljs-number">1000</span></span>(Bk - <span class="hljs-number"><span class="hljs-number">0.63</span></span>)^<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Bk <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the proportion <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> blacks <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> town - LSTAT % lower status <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the population - MEDV Median <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>-occupied homes <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-meta"><span class="hljs-meta">$1000</span></span><span class="hljs-string"><span class="hljs-string">'s</span></span></code> </pre> <br><pre> <code class="python hljs">data.head()</code> </pre> <br><table border="1"><thead><tr><th></th><th>  CRIM </th><th>  ZN </th><th>  INDUS </th><th>  CHAS </th><th>  Nox </th><th>  RM </th><th>  AGE </th><th>  Dis </th><th>  Rad </th><th>  TAX </th><th>  PTRATIO </th><th>  B </th><th>  Lstat </th></tr></thead><tbody><tr><th>  0 </th><td>  0.00632 </td><td>  18.0 </td><td>  2.31 </td><td>  0.0 </td><td>  0.538 </td><td>  6.575 </td><td>  65.2 </td><td>  4.0900 </td><td>  1.0 </td><td>  296.0 </td><td>  15.3 </td><td>  396.90 </td><td>  4.98 </td></tr><tr><th>  one </th><td>  0.02731 </td><td>  0.0 </td><td>  7.07 </td><td>  0.0 </td><td>  0.469 </td><td>  6.421 </td><td>  78.9 </td><td>  4.9671 </td><td>  2.0 </td><td>  242.0 </td><td>  17.8 </td><td>  396.90 </td><td>  9.14 </td></tr><tr><th>  2 </th><td>  0.02729 </td><td>  0.0 </td><td>  7.07 </td><td>  0.0 </td><td>  0.469 </td><td>  7.185 </td><td>  61.1 </td><td>  4.9671 </td><td>  2.0 </td><td>  242.0 </td><td>  17.8 </td><td>  392.83 </td><td>  4.03 </td></tr><tr><th>  3 </th><td>  0.03237 </td><td>  0.0 </td><td>  2.18 </td><td>  0.0 </td><td>  0.458 </td><td>  6.998 </td><td>  45.8 </td><td>  6.0622 </td><td>  3.0 </td><td>  222.0 </td><td>  18.7 </td><td>  394.63 </td><td>  2.94 </td></tr><tr><th>  four </th><td>  0.06905 </td><td>  0.0 </td><td>  2.18 </td><td>  0.0 </td><td>  0.458 </td><td>  7.147 </td><td>  54.2 </td><td>  6.0622 </td><td>  3.0 </td><td>  222.0 </td><td>  18.7 </td><td>  396.90 </td><td>  5.33 </td></tr></tbody></table><br><br><p>  Create a simple Bayesian linear model. </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">E</span><span class="MJXp-mtext" id="MJXp-Span-2091">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">M</span><span class="MJXp-mo" id="MJXp-Span-2099" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">Z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">N</span><span class="MJXp-mo" id="MJXp-Span-2102" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">U</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">S</span><span class="MJXp-mo" id="MJXp-Span-2108" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110">H</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">S</span><span class="MJXp-mo" id="MJXp-Span-2113" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">X</span><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">M</span><span class="MJXp-mo" id="MJXp-Span-2120" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">E</span><span class="MJXp-mo" id="MJXp-Span-2124" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">S</span><span class="MJXp-mo" id="MJXp-Span-2128" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">D</span><span class="MJXp-mo" id="MJXp-Span-2132" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">X</span><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2138">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143">O</span><span class="MJXp-mo" id="MJXp-Span-2144" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">B</span><span class="MJXp-mo" id="MJXp-Span-2146" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">T</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-78"> PRICE \ sim CRIM + ZN + INDUS + CHAS + NOX + RM + AGE + DIS + RAD + TAX + PTRATIO + B + LSTAT </script></p><br><p>  By default, Prior to the coefficients is <code>Normal(mu=0, tau=1.0E-6)</code> , by a constant - <code>Flat</code> . <br>  We will <a href="https://arxiv.org/abs/1608.04471">evaluate the</a> model using <a href="https://arxiv.org/abs/1608.04471">SVGD</a> for a change. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> functools <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> partial <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> lm_model: lm_model = pm.GLM(x=data, y=y) <span class="hljs-comment"><span class="hljs-comment">#        pm.fit histogram = pm.fit(200, method='svgd', obj_optimizer=partial(pm.adagrad, learning_rate=.7))</span></span></code> </pre> <br><pre> <code class="hljs matlab"><span class="hljs-number"><span class="hljs-number">100</span></span><span class="hljs-comment"><span class="hljs-comment">%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 200/200 [00:05&lt;00:00, 35.31it/s]</span></span></code> </pre> <br><p>  And so, we got the distribution!  It is now possible to build confidence intervals using it, which we will do for the coefficients of our regressors. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  `histogram.sample`   ,      pm.sample. #         pm.forestplot(histogram.sample(300), varnames=data.columns);</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/d86/b40/602/d86b40602bb440eaac56de7d0c5cc26a.png" alt="png"></p><br><h1 id="bayesovskie-neyronnye-seti">  Bayesian Neural Networks </h1><br><p><img src="https://ai2-s2-public.s3.amazonaws.com/figures/2016-11-08/da6057368920585bcf2443295b98418840f1fc80/1-Figure1-1.png"></p><br><p>  Since the <code>PyMC3</code> - <code>Theano</code> backend, it is a completely natural desire to use a variational Bayesian output for neural networks.  This is quite easily and transparently obtained with <code>Lasagne</code> . </p><br><p>  A distinctive feature of the Bayesian neural network from the usual is how weights are modeled.  In the usual case, specific values ‚Äã‚Äãare taken as weights and are optimized using gradient descent. </p><br><p>  In the case of the Bayesian neural network, everything is different.  Network weights are perceived as unobservable random variables with a priori distribution.  Ideally, they need to make an honest Bayesian conclusion, but we have seen that sampling slows down even the simplest tasks, and here a completely different level.  The usual practice in teaching Bayesian networks is an approximate variational derivation of this very distribution.  The fastest of variation methods is the aforementioned ADVI.  We will use it here. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lasagne.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lasagne <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datasets <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scale <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cross_validation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.datasets <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> make_moons</code> </pre> <br><p>  Generate synthetic data using <code>sklearn</code> utilities </p><br><pre> <code class="python hljs">X, Y = make_moons(noise=<span class="hljs-number"><span class="hljs-number">0.2</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>, n_samples=<span class="hljs-number"><span class="hljs-number">1000</span></span>) X = scale(X) <span class="hljs-comment"><span class="hljs-comment">#    ,  X  Y float64 X = X.astype(theano.config.floatX) Y = Y.astype(theano.config.floatX) X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=.5)</span></span></code> </pre> <br><pre> <code class="python hljs">fig, ax = plt.subplots() ax.scatter(X[Y==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[Y==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'b'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Class 0'</span></span>) ax.scatter(X[Y==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[Y==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'r'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Class 1'</span></span>) sns.despine(); ax.legend() ax.set(xlabel=<span class="hljs-string"><span class="hljs-string">'X'</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">'Y'</span></span>, title=<span class="hljs-string"><span class="hljs-string">'Toy binary classification data set'</span></span>);</code> </pre> <br><p><img src="https://habrastorage.org/files/802/625/664/8026256649d64ad280666aebd6eb0d85.png" alt="png"></p><br><p>  For <code>Lasagne</code> , as initialization, you can pass a function that returns the <code>Lasagne</code> character variable.  Initialization is very different from <code>PyMC3</code> , so you have to write your adapter. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> itertools <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RandomWeight</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> counter = itertools.count(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, mu=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, sd=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.mu = mu self.sd = sd <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, shape)</span></span></span><span class="hljs-function">:</span></span> name = <span class="hljs-string"><span class="hljs-string">'auto_%s'</span></span> % next(self.counter) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pm.Normal(name, self.mu, self.sd, testval=lasagne.init.GlorotUniform()(shape), shape=shape, dtype=theano.config.floatX)</code> </pre> <br><p>  Creating a neural network is necessary in the context of the model so that the weights are initialized correctly. </p><br><pre> <code class="python hljs">input_var = theano.shared(X_train) out_var = theano.shared(Y_train) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pm.Model() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> nnet: inp = InputLayer((<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), input_var) <span class="hljs-comment"><span class="hljs-comment">#     ,      z = DenseLayer(inp, 5, W=RandomWeight(), b=None, nonlinearity=tt.tanh) z = DenseLayer(z, 5, W=RandomWeight(), b=None, nonlinearity=tt.tanh) p = DenseLayer(z, 1, W=RandomWeight(), b=None, nonlinearity=tt.nnet.sigmoid) #       ,  -p(D|z)     pm.Bernoulli('observed', p=get_output(p).flatten(), observed=out_var)</span></span></code> </pre> <br><p>  Approximate Bayesian output for such a model can be made using the above described ADVI </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> nnet: inference = pm.ADVI() approx = inference.fit(<span class="hljs-number"><span class="hljs-number">30000</span></span>)</code> </pre> <br><pre> <code class="hljs mel">Average Loss = <span class="hljs-number"><span class="hljs-number">132.78</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| <span class="hljs-number"><span class="hljs-number">30000</span></span>/<span class="hljs-number"><span class="hljs-number">30000</span></span> [<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">35</span></span>&lt;<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>, <span class="hljs-number"><span class="hljs-number">847.38</span></span>it/s] Finished [<span class="hljs-number"><span class="hljs-number">100</span></span>%]: Average Loss = <span class="hljs-number"><span class="hljs-number">132.78</span></span></code> </pre> <br><pre> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>)) plt.plot(inference.hist, alpha=<span class="hljs-number"><span class="hljs-number">.3</span></span>) plt.legend() plt.ylabel(<span class="hljs-string"><span class="hljs-string">'-ELBO'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'iteration'</span></span>);</code> </pre> <br><p><img src="https://habrastorage.org/files/db4/f71/70e/db4f7170eb7d4c84bcd53f2394608d2b.png" alt="png"></p><br><p>  Results can be easily reused for another task, for example, using them to make predictions: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    x = tt.matrix('X') #    n = tt.iscalar('n') #     compute_test_value='raise',    ,      x.tag.test_value = np.empty_like(X_train[:10]) n.tag.test_value = 100 #       sample_node  apply_replacements #        pymc3     _sample_proba = approx.sample_node(get_output(p).flatten(), size=n, more_replacements={input_var:x}) #      #       ,   sample_proba = theano.function([x, n], _sample_proba)</span></span></code> </pre> <br><p>  Actually the predictions themselves can be obtained by calling a function on the test set: </p><br><pre> <code class="python hljs">pred = sample_proba(X_test, <span class="hljs-number"><span class="hljs-number">500</span></span>).mean(<span class="hljs-number"><span class="hljs-number">0</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0.5</span></span></code> </pre> <br><pre> <code class="python hljs">fig, ax = plt.subplots() ax.scatter(X_test[pred==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_test[pred==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'b'</span></span>) ax.scatter(X_test[pred==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_test[pred==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'r'</span></span>) sns.despine() ax.set(title=<span class="hljs-string"><span class="hljs-string">'Predicted labels in testing set'</span></span>, xlabel=<span class="hljs-string"><span class="hljs-string">'X'</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">'Y'</span></span>);</code> </pre> <br><p><img src="https://habrastorage.org/files/39d/0e2/208/39d0e22082114f0892e1eb5d50f52ae2.png" alt="png"></p><br><h1 id="razdelyayuschaya-granica">  Dividing line </h1><br><p>  You can see the dividing border for classes, for this you can substitute there all the points on the plane and average. </p><br><pre> <code class="python hljs">grid = np.mgrid[<span class="hljs-number"><span class="hljs-number">-3</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>:<span class="hljs-number"><span class="hljs-number">100j</span></span>,<span class="hljs-number"><span class="hljs-number">-3</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>:<span class="hljs-number"><span class="hljs-number">100j</span></span>].astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) grid_2d = grid.reshape(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>).T ppc = sample_proba(grid_2d ,<span class="hljs-number"><span class="hljs-number">500</span></span>)</code> </pre> <br><pre> <code class="python hljs">cmap = sns.diverging_palette(<span class="hljs-number"><span class="hljs-number">250</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, s=<span class="hljs-number"><span class="hljs-number">85</span></span>, l=<span class="hljs-number"><span class="hljs-number">25</span></span>, as_cmap=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>)) contour = ax.contourf(grid[<span class="hljs-number"><span class="hljs-number">0</span></span>], grid[<span class="hljs-number"><span class="hljs-number">1</span></span>], ppc.mean(axis=<span class="hljs-number"><span class="hljs-number">0</span></span>).reshape(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), cmap=cmap) ax.scatter(X_test[pred==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_test[pred==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'b'</span></span>) ax.scatter(X_test[pred==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_test[pred==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'r'</span></span>) cbar = plt.colorbar(contour, ax=ax) _ = ax.set(xlim=(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), ylim=(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), xlabel=<span class="hljs-string"><span class="hljs-string">'X'</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">'Y'</span></span>); cbar.ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">'Posterior predictive mean probability of class label = 0'</span></span>);</code> </pre> <br><p><img src="https://habrastorage.org/files/088/96e/76e/08896e76e47a4dd39b0ebfa811d97de1.png" alt="png"></p><br><h1 id="uverennost-modeli">  Model confidence </h1><br><p>  Model confidence in predictions is a very interesting thing.  Usually in models we can get only a point estimate for the value of interest.  It does not in itself carry information about how well the model understands the world around it: only the distribution of the estimate can tell about it.  Using Bayesian methods, this is done very intuitively, and, moreover, is pretty well implemented in <code>PyMC3</code> . </p><br><pre> <code class="python hljs">cmap = sns.cubehelix_palette(light=<span class="hljs-number"><span class="hljs-number">1</span></span>, as_cmap=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>)) contour = ax.contourf(grid[<span class="hljs-number"><span class="hljs-number">0</span></span>], grid[<span class="hljs-number"><span class="hljs-number">1</span></span>], ppc.std(axis=<span class="hljs-number"><span class="hljs-number">0</span></span>).reshape(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), cmap=cmap) ax.scatter(X_test[pred==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_test[pred==<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'b'</span></span>) ax.scatter(X_test[pred==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_test[pred==<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], color=<span class="hljs-string"><span class="hljs-string">'r'</span></span>) cbar = plt.colorbar(contour, ax=ax) _ = ax.set(xlim=(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), ylim=(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), xlabel=<span class="hljs-string"><span class="hljs-string">'X'</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">'Y'</span></span>); cbar.ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">'Uncertainty (posterior predictive standard deviation)'</span></span>);</code> </pre> <br><p><img src="https://habrastorage.org/files/2d1/d1b/300/2d1d1b3001a14819a83adcfad83a4070.png" alt="png"></p><br><p>     ,      PyMC3.     ,  , LDA   . </p><br><p>   PyMC3    ,     .     <em>jupyter</em>  <a href="https://github.com/pymc-devs/pymc3/blob/master/docs/source/notebooks/"> </a> </p><br><h1 id="ssylki-na-ispolzuemye-istochniki">     </h1><br><ul><li> <a href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers">Bayesian Methods for Hackers</a> </li><li> <a href="https://arxiv.org/abs/1505.05424">Weight Uncertainty in Neural Networks</a> </li><li> <a href="https://en.wikipedia.org/wiki/Checking_whether_a_coin_is_fair">  </a> </li><li> <a href="https://arxiv.org/abs/1603.00788">Automatic Differentiation Variational Inference</a> </li><li> <a href="https://arxiv.org/abs/1610.09033">Operator Variational Inference</a> </li><li> <a href="https://arxiv.org/abs/1608.04471">Stein Variational Gradient Descent</a> </li><li> <a href="https://github.com/ferrine/pymc3/blob/master/docs/source/notebooks/bayesian_neural_network_opvi-advi.ipynb">    </a> </li><li> <a href="https://gist.github.com/ferrine/acefc31ff4f688011e94d3db285e1f83"></a>  jupyter     </li></ul><br><h1 id="blagodarnosti">  Thanks </h1><br><p>     <a href="https://habrahabr.ru/users/mephistopheies/" class="user_link">mephistopheies</a>  <a href="https://habrahabr.ru/users/bauchgefuehl/" class="user_link">bauchgefuehl</a>     . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/322716/">https://habr.com/ru/post/322716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322706/index.html">Social bots: who, how and why use bots?</a></li>
<li><a href="../322708/index.html">Data Science Weekend March 3-4</a></li>
<li><a href="../322710/index.html">Primitives for implementing 1-Wire master using PWM and ICP on AVR AtMega microcontrollers</a></li>
<li><a href="../322712/index.html">Arrested the alleged organizer of the MIRAI botnet attack on the provider Deutsche Telekom</a></li>
<li><a href="../322714/index.html">NetScaler Unified Gateway: a secure solution for applications through a single URL</a></li>
<li><a href="../322720/index.html">VLAN configuration on the routerOS operating system</a></li>
<li><a href="../322724/index.html">ClickHouse: very fast and very convenient</a></li>
<li><a href="../322726/index.html">DEV Labs 2017. Online conference for .NET developers. March 4</a></li>
<li><a href="../322728/index.html">Implementation of FFT node with floating point on the FPGA</a></li>
<li><a href="../322730/index.html">What is the Tarantool IIoT platform?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>