<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bitfury Crystal: how it works and where our tool is used to track suspicious crypto transactions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will talk about Bitfury Crystal , a platform that analyzes Bitcoin and Bitcoin Cash blockchains and allows you to detect suspicious cryptocur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bitfury Crystal: how it works and where our tool is used to track suspicious crypto transactions</h1><div class="post__text post__text-html js-mediator-article">  Today we will talk about <a href="https://crystalblockchain.com/">Bitfury Crystal</a> , a platform that analyzes Bitcoin and Bitcoin Cash blockchains and allows you to detect suspicious cryptocurrency transactions.  Consider the tools used by the system, and the principles of their work. <br><br> <a href="https://habr.com/company/bitfury/blog/434282/"><img src="https://habrastorage.org/webt/hk/qn/9z/hkqn9zx2tkxgfosaeqat8dm7m1m.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ <a href="https://crystalblockchain.com/">Bitfury Crystal</a></i></font> <br><br><h2>  Why do you need such a system </h2><br>  A blockchain is an open network, so any of its members can study transaction history and set amounts sent between addresses.  But to know the owner of a wallet is very problematic, since the network is anonymous.  For this reason, attackers are actively using cryptocurrency for money laundering, extortion or blackmail.  According to <a href="https://www.europol.europa.eu/internet-organised-crime-threat-assessment-2018">Europol</a> , it is cryptocurrency operations that are becoming more and more popular for conducting illegal transactions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Our team has developed a set of tools for the most complete analysis of the blockchain.  Crystal groups addresses that belong to the same owner, and gives a risk assessment (what is the chance that they are related to illegal activities).  Also, the service allows you to trace the movement of bitcoins to a specific address or after a certain transaction. <br><br><h2>  Crystal Tools </h2><br>  In general, the Crystal platform can be viewed as a combination of the following tools: clustering, risk assessment, visualization, interaction, and tracking.  Their consistent application allows us to identify the connection of a cryptocurrency wallet or payment with illegal or ‚Äúdoubtful‚Äù activity and provide evidence of such a connection.  Let's tell what tasks each of these tools solves. <br><br><h5>  Clustering </h5><br>  To determine if the wallet is related to suspicious activity, Crystal groups the addresses on the blockchain belonging to the same owner.  That is, solves the problem of clustering.  Crystal clustering most commonly uses two heuristics: <b>total spending</b> <b>heuristics</b> and <b>change heuristics</b> . <br><br>  In the first case, addresses are grouped, which are separate entries of a single transaction.  Since different addresses send funds in the same transaction and have access to each other‚Äôs private keys, it can be assumed that these addresses have a common owner. <br><br><div class="spoiler">  <b class="spoiler_title">What is a transaction entry and exit?</b> <div class="spoiler_text">  <i>All Bitcoin blockchain transactions have one or more inputs and outputs.</i>  <i>The inputs of the new transaction refer to the outputs of the previous transaction and provide data for the transfer of funds.</i> <i><br><br></i>  <i>In detail about the mechanism of the transaction, we wrote <a href="https://habr.com/company/bitfury/blog/330316/">in one of our past materials</a> .</i> <br></div></div><br>  But this rule is not true for all cases.  For example, the <a href="https://en.bitcoin.it/wiki/CoinJoin">CoinJoin</a> method allows <a href="https://en.bitcoin.it/wiki/CoinJoin">you</a> to combine inputs from different senders in a single transaction to anonymize it.  In this case, it becomes more difficult to establish the exact distribution of funds ‚Äúin tandem‚Äù. <br><br><img src="https://habrastorage.org/webt/tr/6c/ao/tr6caozkccc4vtp5h4qth79zbf8.png"><br>  <font color="#A9A9A9"><i>/ An example of Coinjoin transactions on our Visualization</i></font> <br><br>  This condition imposes a number of restrictions on the clustering algorithm.  To expand the capabilities of the system, additional heuristics are used - change heuristics. <br><br>  The sum of all inputs for the current transaction should be used at its outputs, otherwise, the remaining funds become the miner's commission.  For this reason, a new exit address is often generated, to which the sender will receive the change.  The heuristic of delivery allows you to identify such addresses and add them to the sender's cluster. <br><br>  After clustering, Crystal analytics are included in the work, which, based on information about the object found in the sources available to them, determine the owner of the cluster. <br><br><h5>  Risk assessment </h5><br>  Special algorithms estimate the likelihood of wallets associating with potentially harmful activities.  The Risk Assessment module provides additional information about unlabelled clusters (including single addresses) based on their interaction with labeled clusters.  Additional information means the risk level of a group of addresses, depending on whether they belong to any type of activity ( <b>darkmarket, malware, miner, etc.</b> ). <br><br>  The ‚ÄúRisk Assessment‚Äù module uses the <a href="https://en.wikipedia.org/wiki/Label_Propagation_Algorithm">label propagation</a> method, which refers to a type of training with partial teacher involvement ( <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2581_%25D1%2587%25D0%25B0%25D1%2581%25D1%2582%25D0%25B8%25D1%2587%25D0%25BD%25D1%258B%25D0%25BC_%25D0%25BF%25D1%2580%25D0%25B8%25D0%25B2%25D0%25BB%25D0%25B5%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5%25D0%25BC_%25D1%2583%25D1%2587%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258F">semi-supervised learning</a> ).  The label distribution method is used to classify objects that have a graph structure.  In this graph, a subset of vertices is labeled into classes (the number of labeled vertices is much less than unmarked vertices).  In our case, vertices denote clusters, and edges - interactions between them.  The edge weight corresponds to the number of transferred funds between addresses. <br><br><h5>  Visualization </h5><br>  Thanks to the visualization tool, the Crystal user can, in a short period of time, construct a flow chart of all known transactions in the form of a graph.  Moreover, the graph will have a minimum number of intersections of the edges for better visualization. <br><br>  Usually, when drawing graphs, <a href="https://en.wikipedia.org/wiki/Force-directed_graph_drawing">force-directed</a> algorithms are used (they are called the graph-drawing power algorithm).  In this case, a system of attraction and repulsion forces acting between the vertices and the edges of the graph is specified.  Then there is a position in which the system has the lowest energy level (local minimum). <br><br>  This approach has many problems, one of which is a local minimum of intersections instead of a global one.  For this reason, we decided to write our own rendering algorithm.  In the figure below you can see an example of visualization, namely the withdrawal of funds from WannaCry addresses. <br><br><img src="https://habrastorage.org/webt/gu/rg/ed/gurgedy0qm1dxp4jhrxxlkmsgha.png"><br>  <font color="#A9A9A9"><i>/ sample visualization of WannaCry withdrawals</i></font> <br><br><h5>  Interaction </h5><br>  It helps to find all the direct transactions between the two clusters and study them in detail.  Also, the function draws graphics that allow you to assess the intensity of the interaction of the owners of addresses depending on time. <br><img src="https://habrastorage.org/webt/cu/gd/q1/cugdq1ummivtlwy7ot_fqq_5gls.png"><br>  <font color="#A9A9A9"><i>/ example of the interaction of cryptocurrency exchanges Binance and Kraken.</i></font> <br><br><h5>  Tracking </h5><br>  Our Crystal team has developed a tool that automatically tracks the flow of cryptocurrency that participated in a user-defined set of transactions.  This allows, for example, to locate the stolen money or the organization through which it was withdrawn. <br><br>  When you try to track such a movement manually, researchers usually face the problem of large branching: money is divided into small parts, converge on addresses, again divided.  In addition, coins from other sources can be added to stolen money, since a single transaction can contain multiple entries. <br><br>  The result of the tracking of Crystal is a list of cryptocurrency addresses to which the money reached, as well as the definition of all delivery routes.  From this data, you can automatically build a visualization.  For example, the figure below shows the ‚Äúroute‚Äù of withdrawal of funds by hackers from the Zaif exchange. <br><br><img src="https://habrastorage.org/webt/0p/m8/zt/0pm8ztrtb5cwo7alvrecdejpmac.png"><br>  <font color="#A9A9A9"><i>/ Hacker transfer of funds to the Binance Exchange</i></font> <br><br>  The attackers transferred cryptocurrency from the addresses of the exchange in transaction <i>c3b9a4a0831a65523c81e6a04f6ddf5a7a89f344d990e8a13e5278efe57f4280</i> .  The money was collected at <i>1FmwHh6pgkf4meCMoqo8fHH3GNRF571f9w</i> , and we investigated the flow of funds associated with this address. <br><br>  As a result, it turned out that some of the funds were sold on accounts on stock exchanges, such as Binance, Bitstamp and Livecoin.  And some of the funds went to the mixers, for example ChipMixer.com. <br><br>  The entire course of the investigation is described <a href="https://medium.com/meetbitfury/crystal-blockchain-analytics-investigation-of-the-zaif-exchange-hack-a3b4d1faed8f">in</a> detail <a href="https://medium.com/meetbitfury/crystal-blockchain-analytics-investigation-of-the-zaif-exchange-hack-a3b4d1faed8f">in our blog on Medium</a> . <br><br><h2>  Where is Crystal used </h2><br>  Using the tools described above, Crystal allows organizations that accept bitcoins to determine the origin of funds and their connection to illegal activity (Risk Assessment).  If the information received is not enough, organizations can conduct a deeper investigation using the tools "Visualization" and "Interaction". <br><br>  Crystal also allows you to investigate cases of theft of cryptocurrency.  The function "Tracking" allows you to get a list of all addresses and organizations through which the stolen money was spent.  After the system in a visual form displays how they got there.  Then with this data the user can contact the identified organizations with a request to freeze the funds. <br><br>  The Crystal tools listed are the result of the development of the Bitfury team of professionals, which is not going to stop there.  The Crystal platform is already used in Asia, the United States, Europe and the CIS by both financial institutions and law enforcement agencies.  Crystal Short Video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eGK3MnYf_gs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>For cooperation please contact: <b><a href="http://contact%40crystalblockchain.com/">contact@crystalblockchain.com</a></b></i> </div><p>Source: <a href="https://habr.com/ru/post/434282/">https://habr.com/ru/post/434282/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434272/index.html">RoadRunner: PHP is not created to die, or Golang to the rescue</a></li>
<li><a href="../434274/index.html">Parallels become part of Corel?</a></li>
<li><a href="../434276/index.html">Slack apologizes for blocking accounts by mistake</a></li>
<li><a href="../434278/index.html">Amateur mathematician found the smallest universal coverage</a></li>
<li><a href="../434280/index.html">How face recognition technology helps the police</a></li>
<li><a href="../434284/index.html">DOOMBA</a></li>
<li><a href="../434286/index.html">ICQ or Memento Mori *</a></li>
<li><a href="../434288/index.html">Easter Eggs and Open Source</a></li>
<li><a href="../434290/index.html">10 interesting and fun books that will make you love marketing</a></li>
<li><a href="../434292/index.html">Expert opinion on the bill number 608767-7 ("On the autonomous RuNet")</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>