<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java and time: part one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eight years ago, I participated in the design and development of a service that was supposed to serve user requests from all over the globe and coordi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java and time: part one</h1><div class="post__text post__text-html js-mediator-article">  Eight years ago, I participated in the design and development of a service that was supposed to serve user requests from all over the globe and coordinate their actions.  Working on a project, I realized that very often many important aspects of work over time are simply ignored.  Sometimes this is really not very critical: if the service is local and used only in a certain area, or the users are naturally divided into geographically non-interacting geographic clusters.  However, if the service unites users all over the world, then one cannot do without a clear understanding of the principles of working with time.  Imagine a service in which general events (meetings, for example) start at some strictly specific time, and users expect this.  What time to show them, at what point they should be disturbed by notifications, what is a birthday and when you can congratulate a person - in the article I will try to comprehend it. <br><br><img src="https://habrastorage.org/files/688/d09/fb9/688d09fb9b814c19aad3e16a1b352b6e.jpg"><br><br>  The article does not claim to the depth and / or academic.  This is an attempt to systematize the experience and draw the attention of developers to not very obvious aspects. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  A new <a href="http://www.oracle.com/technetwork/articles/java/jf14-date-time-2125367.html">Date Time API has</a> appeared in JDK8, in which many <a href="https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html">new useful classes have appeared</a> , but I will not mention it, as well as <a href="http://www.joda.org/joda-time/">excellent third-party libraries</a> .  This is a separate, big topic that deserves a separate article;  plus, as I have already mentioned, I try not to talk about any particular technology, but about the principles of operation in general, but in this regard, the new API is fundamentally no different from the old one. <br><br><h1>  Time axis </h1><br><br>  Let's start from far away.  Right very far away.  Draw the axis of <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D1%2580%25D0%25B5%25D0%25BC%25D1%258F">time</a> . <br><br><img src="https://habrastorage.org/files/3ed/a3b/ac8/3eda3bac84d344eaadd5caee315d0449.png"><br><br>  Right here begin different questions.  Does the time always go <a href="http://elementy.ru/lib/430702/">in one direction</a> ?  Does it go evenly?  Is it continuous?  What to take for a single vector?  Is this axis one for all?  Does it depend on position in space?  From the speed of movement?  What is the minimum measurable segment? <br><br>  Actually here I am ready only to ask questions, but not to answer them.  There is an opinion that <a href="http://www.newscom.md/rus/fiziki-sdelali-shokiruyushee-zayavlenie-vremeni-ne-sushestvuet.html">there is no time</a> , but I am also not yet ready to discuss this issue. <br><br>  But there are already resolved moments. <br><br>  About the <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D0%25BA%25D1%2583%25D0%25BD%25D0%25B4%25D0%25B0">unit of measurement,</a> everything is clear - it is clearly and unambiguously specified. <br><br>  The distance from Moscow to Washington is approximately 7840000 meters and the light travels this distance over the earth's surface in at least 0.026 seconds, which is quite a lot.  The request to create an account by the user in Vladivostok will be processed on the Moscow server only after some time.  Thus, information about events taking place is not immediately available and depends on the distance between points in space. <br><br>  In addition, the rate of time itself depends on the speed of movement of the object, and even for quite <a href="http://habrahabr.ru/company/ivideon/blog/230117/">ordinary near-terrestrial technologies like GPS</a> . <br><br>  The current standard Java time processing library believes that no relativistic effects exist and no one moves at near-light speeds, and the time axis is the same for all (at least on the scale of one planet) - and this suits us all.  Perhaps later, a new Java Date Time API will be implemented in JDK # 6543, which will allow us to write a service for the <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D1%258B%25D1%2581%25D1%258F%25D1%2587%25D0%25B5%25D0%25BB%25D0%25B5%25D1%2582%25D0%25BD%25D0%25B8%25D0%25B9_%25D1%2581%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BB">Millennium Falcon</a> internal office system, taking into account its speed of movement and the presence / absence of <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D0%25BE%25D1%2582%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D0%25BD%25D0%25BE%25D1%2580%25D0%25B0">wormholes</a> nearby. <br><br>  Now we note some moment on the time axis.  For example, right now I‚Äôll click on the "point" button.  (Clicked) <br><br><img src="https://habrastorage.org/files/f7d/b1d/591/f7db1d59109e4f86b72a8be14d2e240d.png"><br><br>  Now you need to think of a way by which I could inform you about the exact moment I pressed this button.  The easiest way to do this is to designate a point in time, common to all of us, from which we all constantly count time counts.  If this moment in time is indicated ( <em>that very moment</em> ), then I will be able to transfer you the number of my samples from this general moment, and you will be able to understand the relationship between the time you press the button and your current time when you receive my value. <br><br>  In the primitive physical world, we could meet and simultaneously launch the same hourglass.  After that, quietly go about their business, and the times of events to report in the form of the height of the sand column on our watch (probably the clock should be very large and bulky). <br><br><img src="https://habrastorage.org/files/c43/a7b/00e/c43a7b00e36647f093345a6f722689a2.png"><br><br>  The <em>one-moment that</em> we use, in turn, can also be a measurement - but already relative to some more general and important event.  In our case, this is the case; <em>the very moment</em> in the <a href="https://ru.wikipedia.org/wiki/UNIX-%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D1%258F">Unix-time system</a> (numerical value 0), which is used in Java, is a time point labeled 00:00:00 January 1, 1970 A.D.  UTC is already on a different scale - the <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D1%2580%25D0%25B8%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BA%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D1%258C">Gregorian calendar</a> . <br><br><h1>  What's with java </h1><br><br>  To set a time point on the time axis in Java, there is a class <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Date.html">java.util.Date</a> .  In general, java.util.Date is a disgrace to Java, starting from the earliest versions.  First, his name does not reflect the essence;  and secondly, it is mutable.  However, life will be easier if you take it as a simple wrapper over an internal field of type long in which the number of milliseconds from <em>that very moment</em> is stored ‚Äî nothing more.  All other methods are marked as obsolete and should not be used in any way.  Just remember that java.utl.Date is identical (in its essence) to the simple numeric long-value of Unix-time in milliseconds. <br><br><pre><code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">Date</span></span> moment = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">Date</span></span>(<span class="hljs-number"><span class="hljs-number">1451665447567</span></span>L); //    Unix-<span class="hljs-type"><span class="hljs-type">time</span></span>  -- moment.getTime(); //    Unix-<span class="hljs-type"><span class="hljs-type">time</span></span>  --.</code> </pre> <br><br>  If you think a little, it becomes clear that in any language there are limitations to the accuracy of the representation of time.  Therefore, java.util.Date (like any other similar types) is not a point on the time axis, but a segment.  In our case - a segment of millisecond duration.  But from a practical point of view, such accuracy suits us, and therefore we will call it a full stop. <br><br>  Since the representation in Java from the very beginning is 64-bit, then for our age it will be enough for sure: <br><div class="spoiler">  <b class="spoiler_title">We have enough</b> <div class="spoiler_text"><pre> <code class="java hljs">Date theEnd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date(Long.MAX_VALUE); DateFormat dateFormat = SimpleDateFormat.getDateTimeInstance(SimpleDateFormat.LONG, SimpleDateFormat.LONG); dateFormat.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"UTC"</span></span>)); String text = dateFormat.format(theEnd); System.out.println(text); # August <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">292278994</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span> AM UTC</code> </pre><br></div></div><br><br>  For various operations with time such as reading / installation / modification of individual calendar fields (year, month, day, hours, minutes, seconds, etc.) there is a class <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html">java.util.Calendar</a> .  It is also not without sin - in operations, remember that the months go from 0 (it is better to use constants), and the days go from 1. <br><div class="spoiler">  <b class="spoiler_title">java.util.Calendar</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testSunday</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ Calendar calendar = Calendar.getInstance(); calendar.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"UTC"</span></span>)); calendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.JANUARY, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); calendar.add(Calendar.DAY_OF_YEAR, -<span class="hljs-number"><span class="hljs-number">2</span></span>); Assert.assertEquals(Calendar.SUNDAY, calendar.get(Calendar.DAY_OF_WEEK)); }</code> </pre><br></div></div><br><br>  Another muddy moment in java.util.Calendar is that when setting the full date (yyyy, MM, dd, HH, mm, ss), the number of milliseconds is not reset to 0, but remains equal to the number of milliseconds from the previous set point ( current time if the calendar has not changed).  Therefore, if under the conditions of the task in milliseconds it must be 0, then this field must be reset by another additional call: <br><div class="spoiler">  <b class="spoiler_title">java.util.Calendar</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testCalendarMs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); Calendar calendar = Calendar.getInstance(tz); calendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); calendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.APRIL, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(calendar.getTimeInMillis()); calendar.set(Calendar.MILLISECOND, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(calendar.getTimeInMillis()); }</code> </pre><br><pre> 1461142800808
 1461142800000
</pre><br></div></div><br><br>  The first number walks in the first three digits depending on the time of the call.  This behavior can be quite critical in the tests. <br><br>  To translate timestamps to points on the axis and back, there is a class java.text.DateFormat and its heirs. <br><div class="spoiler">  <b class="spoiler_title">java.text.DateFormat</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testFormat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); DateFormat dateFormat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span></span>); dateFormat.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); dateFormat.setTimeZone(tz); Date moment = dateFormat.parse(<span class="hljs-string"><span class="hljs-string">"2005-03-27 01:30:00"</span></span>); Assert.assertEquals(<span class="hljs-string"><span class="hljs-string">"2005-03-27 01:30:00"</span></span>, dateFormat.format(moment)); }</code> </pre><br></div></div><br><br>  About java.text.DateFormat and java.util.Calendar it is necessary to say the following: <br><ul><li>  Both classes have a setTimezone () method for explicitly setting a time zone.  It is highly desirable to always use it in order to indicate that you are in complete control of the process, rather than relying on the time zone by default. </li><li>  Both classes have a setLenient () method for setting the ‚Äúsoft‚Äù mode.  In this mode, both classes will condescendingly treat errors in calendar tags, trying to guess what you really mean.  It depends on the situation, but I would recommend guessing off (by default, the "soft" mode is enabled). </li><li>  Both classes are unsafe.  And, if it is completely expected for java.util.Calendar (since we understand that it has an internal state), then in the case of java.text.DateFormat, for many it turns out to be a surprise. </li></ul><br><br>  There are also (in the old API) a few more classes: <br>  <a href="https://docs.oracle.com/javase/7/docs/api/java/sql/Timestamp.html">java.sql.Timestamp</a> - extension (subclass) java.util.Date with nanosecond precision to work with the TIMESTAMP type in the database <br>  <a href="https://docs.oracle.com/javase/7/docs/api/java/sql/Date.html">java.sql.Date</a> is an extension (subclass) of java.util.Date for working with the <a href="https://en.wikipedia.org/wiki/SQL">DATE</a> type in the database. <br>  <a href="https://docs.oracle.com/javase/7/docs/api/java/sql/Time.html">java.sql.Time</a> is an extension (subclass) of java.util.Date for working with the <a href="https://en.wikipedia.org/wiki/SQL">TIME</a> type in the database. <br><br><br>  In addition, any time point can be stored as a normal long <a href="https://ru.wikipedia.org/wiki/UNIX-%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D1%258F">Unix-time</a> value in milliseconds. <br><br><h1>  Time zones </h1><br><br>  Anyone who has worked in a global company with many offices around the world (or even just across Russia) knows that the information contained in the phrase ‚Äúthe meeting will be on January 1, 2016 at 14:00:00‚Äù is practically useless.  The mark "14:00" does not correspond to any particular point on the time axis, or rather to say - corresponds to several at once.  In order for everyone to get together in video conversations at the same time, the meeting organizer needs to specify something else, namely, the time zone in which we will interpret the ‚Äú14:00‚Äù label.  Often, the time zone is implied by the domination of the head office (‚Äúwe work Moscow time‚Äù), otherwise, if the default time zone is not implied at all, then you need to specify it explicitly, for example, ‚ÄúJanuary 1, 2016 at 14:00 : 00 MSK ‚Äù- in this case, the point on the time axis is set quite unambiguously and everyone will gather for the meeting at the same time. <br><br>  To disambiguate operations with timestamps in the format HH: MM: CC, the time zone must be specified both when <em>displaying the</em> timestamp and when <em>entering</em> . <br><br>  You can not specify the time zone explicitly, in cases where it can be implied in some way implicitly: <br><ul><li>  the time zone is assumed to be the same default for the entire service; </li><li>  the time zone is clearly indicated in the profile by the user; </li><li>  user time zone can be calculated by its position through geo-coordinates; </li><li>  time zone of the user can be calculated by its position through the IP address; </li><li>  the user's time zone can be calculated by its position through indirect signs (behavior analysis); </li><li>  the current offset of the user's time zone can be calculated <a href="http://www.w3schools.com/jsref/jsref_gettimezoneoffset.asp">through JavaScript</a> ; </li></ul><br><br>  It is probably worth noting that the time zone of the service (by default) and the time zone of the server (by default) are in general not the same thing.  The BIOS, the system, the application and the utilities can, for example, work in the UTC time zone, but with all this, the time zone of the service will be the time zone of Moscow.  Although of course it is much easier when they match - in this case, the admins set up time zones on the servers, but the programmers do not think about them at all.  If this is just your case, then you can stop reading. <br><br>  The same timestamp can be displayed differently for users - using the time zone that is most familiar to everyone.  For example, the following timestamps point to the same time point on the time axis: <br><pre> <code class="bash hljs">Fri Jan 1 16:29:00 MSK 2016 Fri Jan 1 13:29:00 UTC 2016 Fri Jan 1 14:29:00 CET 2016 Fri Jan 1 21:29:00 SGT 2016 Fri Jan 1 22:29:00 JST 2016</code> </pre><br><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B0%25D1%2581%25D0%25BE%25D0%25B2%25D0%25BE%25D0%25B9_%25D0%25BF%25D0%25BE%25D1%258F%25D1%2581">Wikipedia about time zones</a> . <br><br>  In Java, time zone information is represented by the <a href="https://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html">java.util.TimeZone</a> class. <br><br>  It must be said that the time zone is not an offset.  This is not to say that GMT + 3 is Europe / Moscow.  But it can be said that during the whole of 2016, the time zone of Europe / Moscow will correspond to the GMT + 3 offset.  The time zone is the entire history of displacements completely for the entire historical period, as well as other data that allow us to correctly calculate the displacements at different historical moments, as well as to make the correct time calculations. <br><br>  Let's explore the time zones - for a start, let's look at Europe / Moscow: <br><div class="spoiler">  <b class="spoiler_title">Europe / Moscow</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testTzMoscow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); System.out.println(tz.getRawOffset()); System.out.println(tz.getOffset(System.currentTimeMillis())); System.out.println(tz.useDaylightTime()); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.LONG, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.SHORT, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.LONG, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.SHORT, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.LONG, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.SHORT, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.LONG, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.SHORT, Locale.FRENCH)); }</code> </pre><br><pre> 10,800,000
 10,800,000
 false
 Moscow Standard Time
 MSK
 Moscow Daylight Time
 MSD
 Heure standard de Moscou
 MSK
 Heure avanc√©e de moscou
 MSD
</pre><br></div></div><br><br>  We see that the Europe / Moscow zone has a current base offset of +3 hours relative to UTC, and the total offset <em>at the moment</em> is also +3 hours.  The switch of arrows to summer time is absent.  The zone has separate names for summer and winter time. <br><br>  Now look at the Paris time: <br><div class="spoiler">  <b class="spoiler_title">Europe / Paris</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testTzParis</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Paris"</span></span>); System.out.println(tz.getRawOffset()); System.out.println(tz.getOffset(System.currentTimeMillis())); System.out.println(tz.useDaylightTime()); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.LONG, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.SHORT, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.LONG, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.SHORT, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.LONG, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.SHORT, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.LONG, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.SHORT, Locale.FRENCH)); }</code> </pre><br><pre> 3.6 million
 3.6 million
 true
 Central European Time
 CET
 Central European Summer Time
 CEST
 Heure d'europe centrale
 CET
 Heure d'√©t√© d'europe centrale
 CEST
</pre><br></div></div><br><br>  The base offset is +1 hour relative to UTC, the total offset <em>at the moment</em> is also +1 hour.  Daylight saving time in the zone.  Also assigned two names - for winter and for summer time separately. <br><br>  Now we will look at the ‚ÄúGMT + 5‚Äù zone.  This is actually not exactly a time zone - it has no history, no summer time, and the shift is constant. <br><div class="spoiler">  <b class="spoiler_title">GMT + 5</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testGmt5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"GMT+5"</span></span>); System.out.println(tz.getRawOffset()); System.out.println(tz.getOffset(System.currentTimeMillis())); System.out.println(tz.useDaylightTime()); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.LONG, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.SHORT, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.LONG, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.SHORT, Locale.ENGLISH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.LONG, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, TimeZone.SHORT, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.LONG, Locale.FRENCH)); System.out.println(tz.getDisplayName(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TimeZone.SHORT, Locale.FRENCH)); }</code> </pre><br><pre> 18000000
 18000000
 false
 GMT + 05: 00
 GMT + 05: 00
 GMT + 05: 00
 GMT + 05: 00
 GMT + 05: 00
 GMT + 05: 00
 GMT + 05: 00
 GMT + 05: 00
</pre><br></div></div><br><br>  So it is, the shift is constant, is +5 hours relative to GMT and never changes. <br><br><h1>  Examples </h1><br><br>  Let's continue by telling you examples that take too long to explain in words.  First, let's look at what happened in 2005 in the time zone ‚ÄúEurope / Moscow‚Äù: <br><div class="spoiler">  <b class="spoiler_title">Europe / Moscow - 2005</b> <div class="spoiler_text"><pre> <code class="bash hljs">$ zdump -v /usr/share/zoneinfo/Europe/Moscow | grep 2005 /usr/share/zoneinfo/Europe/Moscow Sat Mar 26 22:59:59 2005 UT = Sun Mar 27 01:59:59 2005 MSK isdst=0 gmtoff=10800 /usr/share/zoneinfo/Europe/Moscow Sat Mar 26 23:00:00 2005 UT = Sun Mar 27 03:00:00 2005 MSD isdst=1 gmtoff=14400 /usr/share/zoneinfo/Europe/Moscow Sat Oct 29 22:59:59 2005 UT = Sun Oct 30 02:59:59 2005 MSD isdst=1 gmtoff=14400 /usr/share/zoneinfo/Europe/Moscow Sat Oct 29 23:00:00 2005 UT = Sun Oct 30 02:00:00 2005 MSK isdst=0 gmtoff=10800</code> </pre><br></div></div><br><br>  Great, we see the switch to summer day and back to winter time.  Let's look at what happens at these moments with timestamps.  To begin with - the transition to winter time: <br><div class="spoiler">  <b class="spoiler_title">transition to winter time</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testWinterTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); DateFormat dateFormat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd HH:mm:ss z"</span></span>); dateFormat.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); dateFormat.setTimeZone(tz); Calendar calendar = Calendar.getInstance(); calendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); calendar.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"UTC"</span></span>)); calendar.set(<span class="hljs-number"><span class="hljs-number">2005</span></span>, Calendar.OCTOBER, <span class="hljs-number"><span class="hljs-number">29</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">62</span></span>; i++) { String mark = dateFormat.format(calendar.getTime()); System.out.printf(<span class="hljs-string"><span class="hljs-string">"%s - %d, %s\n"</span></span>, mark, tz.getOffset(calendar.getTimeInMillis()), tz.inDaylightTime(calendar.getTime())); calendar.add(Calendar.MINUTE, +<span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre><br><pre> 2005-10-30 02:00:00 MSD - 14400000, true
 2005-10-30 02:01:00 MSD - 14400000, true
 ...
 2005-10-30 02:58:00 MSD - 14400000, true
 2005-10-30 02:59:00 MSD - 14400000, true
 2005-10-30 02:00:00 MSK - 10,800,000, false
 2005-10-30 02:01:00 MSK - 10,800,000, false
</pre><br></div></div><br><br>  We see that after 02:59:00 MSD, the arrows are moved back an hour and the next mark is already 02:00:00 MSK - winter time.  Also, the time zone indicates that summer time is over, and the shift has changed from GMT + 4 to GMT + 3. <br><br>  In the example there is an interesting nuance: using the Europe / Moscow zone, it is absolutely impossible to set a point in the calendar corresponding to the 02:00:00 MSD mark - the 02:00:00 MSK point is set, which is an hour later than we need.  To set this point as a starting point, one has to resort to the services of the UTC time zone, where everything can be installed.  Another option would be to set the 01:00:00 MSD point in the Europe / Moscow zone and add an hour. <br><br>  Now - daylight saving time: <br><div class="spoiler">  <b class="spoiler_title">daylight saving time</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testSummerTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); DateFormat dateFormat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd HH:mm:ss z"</span></span>); dateFormat.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); dateFormat.setTimeZone(tz); Calendar calendar = Calendar.getInstance(); calendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); calendar.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"UTC"</span></span>)); calendar.set(<span class="hljs-number"><span class="hljs-number">2005</span></span>, Calendar.MARCH, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">60</span></span>; i++) { String mark = dateFormat.format(calendar.getTime()); System.out.printf(<span class="hljs-string"><span class="hljs-string">"%s - %d, %s\n"</span></span>, mark, tz.getOffset(calendar.getTimeInMillis()), tz.inDaylightTime(calendar.getTime())); calendar.add(Calendar.MINUTE, +<span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre><br><pre> 2005-03-27 01:00:00 MSK - 10,800,000, false
 2005-03-27 01:01:00 MSK - 10,800,000, false
 ...
 2005-03-27 01:58:00 MSK - 10,800,000, false
 2005-03-27 01:59:00 MSK - 10,800,000, false
 2005-03-27 03:00:00 MSD - 14400000, true
 2005-03-27 03:00:01 MSD - 14400000, true
</pre><br></div></div><br><br>  It can be seen that after 01:59:00 MSK immediately follows 03:00:00 MSD - that is, moving the hands an hour forward.  The time zone signals that at this moment the offset changes from GMT + 3 to GMT + 4, and the summer time flag appears. <br><br>  But what will happen if we try to process the label ‚Äú2005-03-27 02:30:00‚Äù in the Europe / Moscow zone - in theory such a label should not exist? <br><div class="spoiler">  <b class="spoiler_title">nonexistent tag</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testMissing</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); DateFormat dateFormat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span></span>); dateFormat.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); dateFormat.setTimeZone(tz); Date moment = dateFormat.parse(<span class="hljs-string"><span class="hljs-string">"2005-03-27 02:30:00"</span></span>); System.out.println(moment); }</code> </pre><br><pre> java.text.ParseException: Unparseable date: "2005-03-27 02:30:00"
</pre><br></div></div><br><br>  That's right - in strict mode, we get an exception. <br><br>  Calculate the length of the day on the day of the transfer of arrows in winter time: <br><div class="spoiler">  <b class="spoiler_title">winter time switch</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testWinterDay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); Calendar calendar = Calendar.getInstance(); calendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); calendar.setTimeZone(tz); calendar.set(<span class="hljs-number"><span class="hljs-number">2005</span></span>, Calendar.OCTOBER, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); Date time1 = calendar.getTime(); calendar.add(Calendar.DAY_OF_YEAR, +<span class="hljs-number"><span class="hljs-number">1</span></span>); Date time2 = calendar.getTime(); System.out.println(TimeUnit.MILLISECONDS.toHours(time2.getTime() - time1.getTime())); }</code> </pre><br><pre> 25
</pre><br></div></div><br><br>  From 2005-10-30 00:00:00 MSD until 2005-10-31 00:00:00 MSK, 25 hours have passed, and not 24. <br><br>  Now check the daylight saving time: <br><div class="spoiler">  <b class="spoiler_title">daylight saving time</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testSummerDay</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/Moscow"</span></span>); Calendar calendar = Calendar.getInstance(); calendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); calendar.setTimeZone(tz); calendar.set(<span class="hljs-number"><span class="hljs-number">2005</span></span>, Calendar.MARCH, <span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); Date time1 = calendar.getTime(); calendar.add(Calendar.DAY_OF_YEAR, +<span class="hljs-number"><span class="hljs-number">1</span></span>); Date time2 = calendar.getTime(); System.out.println(TimeUnit.MILLISECONDS.toHours(time2.getTime() - time1.getTime())); }</code> </pre><br><pre> 23
</pre><br></div></div><br><br>  Since 2005-03-27 00:00:00 MSK until 2005-03-28 00:00:00 MSD 23 hours have passed, and not 24. <br><br>  These two last examples are devoted to those who add 24 * 60 * 60 * 1000 milliseconds not as 24 hours, but as a calendar day.  You can say that now there is no such problem, since there are no more daylight saving time transfers.  To this I can answer the following: <br><ul><li>  Your program should work correctly in any time zone, not just the Europe / Moscow zone; </li><li>  ‚Äúbackward‚Äù calculations (in the past) still require the correct approach; </li><li>  in 2016, we will have elections for the State Duma, and in 2018 there will be presidential elections - so I think that the story is not over yet. </li></ul><br><br><h1>  java.sql.Time, java.sql.Date </h1><br><br>  Types are intended for working with SQL types <a href="https://en.wikipedia.org/wiki/SQL">TIME and DATE,</a> respectively.  It is understood that both values ‚Äã‚Äãdo not depend on the time zone, but unfortunately this is not quite the case.  Since both types are descendants of java.util.Date - the interpretation of day-hours depends on the time zone: <br><div class="spoiler">  <b class="spoiler_title">The problem with the types of java.sql</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testSqlTime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    2015-01-01 01:00:00 MSK Calendar calendar = Calendar.getInstance(); calendar.setTimeZone(TimeZone.getTimeZone("Europe/Moscow")); calendar.setTimeInMillis(0); calendar.set(2015, Calendar.JANUARY, 10, 1, 0, 0); long now = calendar.getTimeInMillis(); //   java.sql.Time java.sql.Time sqlTime = new java.sql.Time(now); java.sql.Date sqlDate = new java.sql.Date(now); //        Europe/London DateFormat timeFormat = new SimpleDateFormat("HH:mm:ss"); timeFormat.setTimeZone(TimeZone.getTimeZone("Europe/London")); Assert.assertEquals("22:00:00", timeFormat.format(sqlTime)); //        Europe/London DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd"); dateFormat.setTimeZone(TimeZone.getTimeZone("Europe/London")); Assert.assertEquals("2015-01-09", dateFormat.format(sqlDate)); }</span></span></code> </pre><br></div></div><br><br>  In principle, both types cope with the task of transferring information from business logic to the JDBC driver, since usually the code works in the same time zone both there and there, but in more advanced cases, including serialization, you need to be very careful when using these classes. <br><br>  In the new API for the respective types of similar problems are solved. <br><br><h1>  UTC, GMT </h1><br><br>  Most people know that GMT and UTC are special designations for which offsets are made in other time zones.  But not everyone knows that UTC and GMT are <a href="http://www.timeanddate.com/time/gmt-utc-time.html">not exactly the same thing</a> (formally).  I mean that the labels ‚Äú2015-12-01 00:00:00 GMT‚Äù and ‚Äú2015-12-01 00:00:00 UTC‚Äù denote different (albeit close) points on the time axis. <br><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BD%25D0%25B5%25D0%25B5_%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D1%258F_%25D0%25BF%25D0%25BE_%25D0%2593%25D1%2580%25D0%25B8%25D0%25BD%25D0%25B2%25D0%25B8%25D1%2587%25D1%2583">GMT is</a> calculated astronomically based on the position of the earth relative to other objects.  GMT is also directly used as <a href="http://www.timeanddate.com/time/gmt-utc-time.html">a time zone</a> in some countries. <br><br>  As the rotation of the globe slows down chaotically, the earth is in the same position at increasing intervals of time.  Thus, the distance between the time points on the adjacent GMT marks (for example, ‚Äú10:00:01‚Äù and ‚Äú10:00:02‚Äù) may not exactly equal to one <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D0%25BA%25D1%2583%25D0%25BD%25D0%25B4%25D0%25B0">second</a> . <br><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D1%2581%25D0%25B5%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BA%25D0%25BE%25D0%25BE%25D1%2580%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D1%258F">UTC is</a> introduced to replace the GMT and is calculated by the atomic clock.  Directly as a time zone is not used (only as a support for displacement). <br><br>  In UTC, the distance between timestamps (for example, ‚Äú10:00:01‚Äù and ‚Äú10:00:02‚Äù) is exactly the same and strictly equal to one second.  The slowing of the Earth's rotation and the accumulating difference from GMT is solved by entering an extra second in a year (or even two) - namely, <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D0%25BA%25D1%2583%25D0%25BD%25D0%25B4%25D0%25B0_%25D0%25BA%25D0%25BE%25D0%25BE%25D1%2580%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8">coordination seconds</a> (leap second). <br><br>  Thus, the difference between points with the same marks in GMT and UTC never exceeds one second. <br><br>  <a href="http://astro.uni-altai.ru/~orion/blog/2011/10/gmt-ili-utc/">They write</a> that the time UTC almost everywhere displaced GMT, and that using the notation of displacements in the form of GMT + 3 has long been the moveton - the correct use of the designation UTC + 3. <br><br>  Neither GMT nor UTC have summer time. <br><br>  It must be said that <a href="https://ru.wikipedia.org/wiki/UNIX-%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D1%258F">Unix-time</a> , which is used in Java, neither UTC nor GMT directly corresponds.  On the one hand, in Unix-time, the difference between adjacent labels is always 1 second; on the other hand, the presence of leap second in Unix-time is not assumed. <br><br><h1>  Default time zone </h1><br><br>  Do you explicitly display the time zone when outputting, or do not display whether you are requesting a time zone when entering or not asking if you specify a time zone when performing time operations or not specifying that some time zone is still present in these operations implicitly.  If you did not specify your own, the time zone will be used by default. <br><br>  The <em>term default time zone</em> has already been mentioned several times in the text above.  All because without this concept, nothing can be explained properly.  All operations with time, output and input timestamps require a time zone.  The fact that you do not specify it does not mean that it is not there - it is simply taken by default. <br><br>  But everything is not so simple again - by default for <em>whom and why</em> ? <br><br>  Let's start with the kernel.  The <a href="http://linux.die.net/man/8/hwclock">hwclock manual</a> says that the kernel has an internal concept of the time zone, but almost no one uses it, except for some rare modules ‚Äî like the FAT file system driver.  The core hwclock command can inform the core about the time zone change. <br><br>  Application applications define a time zone by default in several ways. <br><br> -,    (   )  Ubuntu    (  ) /etc/localtime,      ‚Äî   /etc/timezone: <br><pre> <code class="bash hljs">$ cat /etc/timezone Europe/Moscow $ file /etc/localtime /etc/localtime: timezone data, version 2, 15 gmt time flags, 15 std time flags, no leap seconds, 77 transition <span class="hljs-built_in"><span class="hljs-built_in">times</span></span>, 15 abbreviation chars $ zdump -v /etc/localtime | head -n 10 /etc/localtime -9223372036854775808 = NULL /etc/localtime -9223372036854689408 = NULL /etc/localtime Wed Dec 31 21:29:42 1879 UT = Wed Dec 31 23:59:59 1879 LMT isdst=0 gmtoff=9017 /etc/localtime Wed Dec 31 21:29:43 1879 UT = Thu Jan 1 00:00:00 1880 MMT isdst=0 gmtoff=9017 /etc/localtime Sun Jul 2 21:29:42 1916 UT = Sun Jul 2 23:59:59 1916 MMT isdst=0 gmtoff=9017 /etc/localtime Sun Jul 2 21:29:43 1916 UT = Mon Jul 3 00:01:02 1916 MMT isdst=0 gmtoff=9079 /etc/localtime Sun Jul 1 20:28:40 1917 UT = Sun Jul 1 22:59:59 1917 MMT isdst=0 gmtoff=9079 /etc/localtime Sun Jul 1 20:28:41 1917 UT = Mon Jul 2 00:00:00 1917 MST isdst=1 gmtoff=12679 /etc/localtime Thu Dec 27 20:28:40 1917 UT = Thu Dec 27 23:59:59 1917 MST isdst=1 gmtoff=12679 /etc/localtime Thu Dec 27 20:28:41 1917 UT = Thu Dec 27 23:00:00 1917 MMT isdst=0 gmtoff=9079</code> </pre><br><br>         <a href="http://www.wikihow.com/Change-the-Timezone-in-Linux">  </a> ,  Ubuntu : <br><pre> <code class="bash hljs">$ dpkg-reconfigure tzdata</code> </pre><br><br>      tzselect: <br><pre> <code class="bash hljs">$ tzselect Please identify a location so that time zone rules can be <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> correctly. Please select a continent, ocean, <span class="hljs-string"><span class="hljs-string">"coord"</span></span>, or <span class="hljs-string"><span class="hljs-string">"TZ"</span></span>. 1) Africa 2) Americas 3) Antarctica 4) Arctic Ocean 5) Asia 6) Atlantic Ocean 7) Australia 8) Europe 9) Indian Ocean 10) Pacific Ocean 11) coord - I want to use geographical coordinates. 12) TZ - I want to specify the time zone using the Posix TZ format. <span class="hljs-comment"><span class="hljs-comment">#?</span></span></code> </pre><br><br>         TZ,            / . <br><br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$TZ</span></span> $ date Wed Dec 30 20:18:18 MSK 2015 $ TZ=UTC date Wed Dec 30 17:18:25 UTC 2015 $ TZ=Europe/London date Wed Dec 30 17:18:35 GMT 2015 $ TZ=Europe/Paris date Wed Dec 30 18:18:40 CET 2015</code> </pre><br><br>           /   : <br><pre> <code class="bash hljs">$ date --utc Fri Jan 1 08:34:36 UTC 2016</code> </pre><br><br> ,   date       : <br><pre> <code class="bash hljs">$ date +%Z MSK</code> </pre><br><br>       libc,      Java.           . <br><br>      JVM. <br><br><pre> <code class="bash hljs">$ cat &lt;&lt; EOF | scala -Duser.timezone=Europe/Paris <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"%s\n%s\n"</span></span>.format(java.util.TimeZone.getDefault().getID(), new java.util.Date())) EOF ... Europe/Paris Wed Dec 30 19:24:00 CET 2015</code> </pre><br><br>             TimeZone.setDefault(TimeZone timeZone): <br><pre> <code class="bash hljs">$ cat &lt;&lt; EOF | scala &gt; java.util.TimeZone.setDefault(java.util.TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"America/Los_Angeles"</span></span>)) &gt; <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"%s\n%s\n"</span></span>.format(java.util.TimeZone.getDefault().getID(), new java.util.Date())) &gt; EOF ... America/Los_Angeles Wed Dec 30 10:25:45 PST 2015</code> </pre><br><br>    : <br><pre> <code class="bash hljs">$ TZ=Europe/London cat &lt;&lt; EOF | scala -Duser.timezone=Europe/Paris java.util.TimeZone.setDefault(java.util.TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"America/Los_Angeles"</span></span>)) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"%s\n%s\n"</span></span>.format(java.util.TimeZone.getDefault().getID(), new java.util.Date())) EOF ... America/Los_Angeles Wed Dec 30 10:37:28 PST 2015</code> </pre><br><br><h1>    </h1><br><br>   <a href="http://lenta.ru/news/2011/02/08/zimynebudet/"></a>  <a href="http://www.gazeta.ru/science/2015/10/26_a_7844459.shtml"></a>       ,  /     <a href="http://lenta.ru/news/2015/11/24/time/"> </a>  <a href="http://www.timeanddate.com/news/time/north-korea-new-time-zone.html"> </a> .            ‚Äî         ,    -    ,    "+2  "  . <br><br>  Linux    libc          /usr/share/zoneinfo.     tzdata,        .           .        ,     Linux     . <br><br>  ,         ,     ‚Äî      <a href="http://habrahabr.ru/post/130401/">    </a> .  <a href="https://ru.wikipedia.org/wiki/Tz_database"> </a>    . <br><br>  But not everything is so simple. <br><br> Java       . , ,  OpenJDK         tzdata-java   ,   Oracle JDK   <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html"></a>  JDK    ,    <a href="http://www.oracle.com/technetwork/articles/javase/tzupdater-readme-136440.html"> </a>         JDK. <br><br> ,    Joda-time      tzdata,    JVM ‚Äî ,          ,     <a href="http://joda-time.sourceforge.net/tz_update.html">   </a> . <br><br>  python   (     ) <a href="https://pypi.python.org/pypi/pytz/"> </a> . <br><br>  javascript   -  ,        <a href="https://google.github.io/closure-library/api/class_goog_i18n_TimeZone.html">  Google Closure</a> . <br><br>   ,            ,  . ,   Lightning    Thunderbird    sqlite-   ,                  .       . <br><br> ,  ,         ( ),             tzdata    ‚Äî   JVM. <br><br>        Android.   ‚Äî    Android  .           tzdata,    ,            (   ).        ,     .  ,           ,   ,     tzdata    .           , -    ( Europe/Minsk  Europe/Moscow).       Europe/Moscow (GMT+4)     ‚Äî             .           ,       . <br><br><h1>  Calendars </h1><br><br>           .          .    ,            <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D1%2580%25D0%25B8%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BA%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D1%258C"> </a> ,            <a href="https://ru.wikipedia.org/wiki/%25D0%25AE%25D0%25BB%25D0%25B8%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BA%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D1%258C"> </a> ,      <a href="http://www.kp.ru/daily/25655/818406/">,   </a>  ,     . <br><br>   ,     ,            -.  ‚Äî <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D1%258C_%25D1%2587%25D1%2583%25D1%2587%25D1%2585%25D0%25B5"> </a> .     <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B0%25D1%2582%25D0%25B5%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%258F:%25D0%259A%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D0%25B8"> </a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and we all just do not think that </font></font><a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D1%2580%25D0%25B8%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BA%25D0%25B0%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D1%258C"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">our calendar is</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> just one of many, perhaps the most used, but not the only one. </font><font style="vertical-align: inherit;">You can play with some </font></font><a href="http://www.direct-time.ru/index.php%3Fid%3D12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leap year </font></font></h1><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leap year is a year in which 366 days, not 365 days as in a normal year. </font><font style="vertical-align: inherit;">In a leap year, one day is added to February - February 29. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The formula for determining that a leap year is simple and described in </font></font><a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B8%25D1%2581%25D0%25BE%25D0%25BA%25D0%25BE%25D1%2581%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B3%25D0%25BE%25D0%25B4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia</font></font></a> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Leap second </font></font></h1><br><br>      ( <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D0%25BA%25D1%2583%25D0%25BD%25D0%25B4%25D0%25B0_%25D0%25BA%25D0%25BE%25D0%25BE%25D1%2580%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8"> </a> )   .    ,                   .            .        ,         .    ,       ‚Äî         .        ‚Äî        . <br><br> ,     ,   UTC    60- : <br><pre> <code class="bash hljs">23:59:58 23:59:59 23:59:60 <span class="hljs-comment"><span class="hljs-comment"># leap second 00:00:00 00:00:01</span></span></code> </pre><br><br>   Unix-time <a href="https://en.wikipedia.org/wiki/Unix_time"> </a>     60: ¬´Because it does not handle leap seconds, it is neither a linear representation of time nor a true representation of UTC.¬ª <br><br>  ,   -    UTC <a href="https://access.redhat.com/articles/15145"> </a>        : <br><pre> <code class="bash hljs">23:59:58 23:59:59 23:59:59 <span class="hljs-comment"><span class="hljs-comment"># leap second 00:00:00 00:00:01</span></span></code> </pre><br><br>  <a href="https://access.redhat.com/articles/15145"></a>     ,          . <br><br>   ,     : <br><ul><li>    23:59:00  00:01:00    120,   121    </li><li>     ,       </li></ul><br><br>  Java,       Unix-time,  <a href="http://stackoverflow.com/questions/30984599/how-does-the-oracle-java-jvm-know-a-leap-second-is-occurring/30989049">  </a> leap-second.     API,    API,    Joda-time.      leap-second   tzdata <a href="http://stackoverflow.com/a/30985583/827139"></a> ,   JavaDoc   <a href="">java.util.Date#getSeconds</a>   ,   ,  ,  Java-       60   61. <br><br>   ,    leap second  Java    . <br><div class="spoiler"> <b class="spoiler_title"> API</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testLeapSecond1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone tz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"UTC"</span></span>); Calendar calendar = Calendar.getInstance(); calendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); calendar.setTimeZone(tz); calendar.set(<span class="hljs-number"><span class="hljs-number">2015</span></span>, Calendar.JUNE, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); Date d1 = calendar.getTime(); calendar.set(<span class="hljs-number"><span class="hljs-number">2015</span></span>, Calendar.JULY, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); Date d2 = calendar.getTime(); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> elapsed = d2.getTime() - d1.getTime(); System.out.println(TimeUnit.MILLISECONDS.toSeconds(elapsed)); }</code> </pre><br><pre> 120
</pre><br></div></div><br><br>  ‚Äî 120 ,   121   . <br><br>    API: <br><div class="spoiler"> <b class="spoiler_title"> API</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testLeapSecond2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ ZonedDateTime beforeLeap = ZonedDateTime.of(<span class="hljs-number"><span class="hljs-number">2015</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, ZoneOffset.UTC); ZonedDateTime afterLeap = ZonedDateTime.of(<span class="hljs-number"><span class="hljs-number">2015</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, ZoneOffset.UTC); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> elapsed = afterLeap.toInstant().toEpochMilli() - beforeLeap.toInstant().toEpochMilli(); System.out.println(TimeUnit.MILLISECONDS.toSeconds(elapsed)); }</code> </pre><br><pre> 3600
</pre><br></div></div><br><br>  3600 ,    3601. <br><br> ,        .   ‚Äî    <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D0%25BA%25D1%2583%25D0%25BD%25D0%25B4%25D0%25B0_%25D0%25BA%25D0%25BE%25D0%25BE%25D1%2580%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8">  </a> . <br><br>    .            /usr/share/zoneinfo/right. <br><pre> <code class="bash hljs">$ file /usr/share/zoneinfo/right/UTC /usr/share/zoneinfo/right/UTC: timezone data, version 2, 1 gmt time flag, 1 std time flag, 26 leap seconds, no transition <span class="hljs-built_in"><span class="hljs-built_in">times</span></span>, 1 abbreviation char $ zdump -v /usr/share/zoneinfo/right/UTC | grep <span class="hljs-string"><span class="hljs-string">'59:60'</span></span> | wc -l 26</code> </pre><br><br>    /usr/share/zoneinfo        . <br><pre> <code class="bash hljs">$ file /usr/share/zoneinfo/UTC /usr/share/zoneinfo/UTC: timezone data, version 2, 1 gmt time flag, 1 std time flag, no leap seconds, no transition <span class="hljs-built_in"><span class="hljs-built_in">times</span></span>, 1 abbreviation char $ zdump -v /usr/share/zoneinfo/UTC | grep <span class="hljs-string"><span class="hljs-string">'59:60'</span></span> | wc -l 0</code> </pre><br><br>      ‚Äî   26  . <br><br>       1970-01-01 00:00:00 UTC  2016-01-01 00:00:00 UTC.   :  Java ( Unix-time)  - ,   . <br><br>  Java: <br><div class="spoiler"> <b class="spoiler_title">1970-01-01 00:00:00 UTC  2016-01-01 00:00:00 UTC - Java</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testEpochDiff</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ ZonedDateTime s = ZonedDateTime.of(<span class="hljs-number"><span class="hljs-number">1970</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, ZoneOffset.UTC); ZonedDateTime f = ZonedDateTime.of(<span class="hljs-number"><span class="hljs-number">2016</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, ZoneOffset.UTC); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> elapsed = f.toInstant().toEpochMilli() - s.toInstant().toEpochMilli(); System.out.println(TimeUnit.MILLISECONDS.toSeconds(elapsed)); }</code> </pre><br><pre>1451606400
</pre><br></div></div><br><br>  1451606400, : <br><pre> <code class="bash hljs">$ dateutils.ddiff --from-zone <span class="hljs-string"><span class="hljs-string">"right/UTC"</span></span> -f <span class="hljs-string"><span class="hljs-string">'%S'</span></span> <span class="hljs-string"><span class="hljs-string">"1970-01-01 00:00:00"</span></span> <span class="hljs-string"><span class="hljs-string">"2016-01-01 00:00:00"</span></span> 1451606400</code> </pre><br><br>   ‚Äî  1451606400 ,    : <br><pre> <code class="bash hljs">$ dateutils.ddiff --from-zone <span class="hljs-string"><span class="hljs-string">"right/UTC"</span></span> -f <span class="hljs-string"><span class="hljs-string">'%rS'</span></span> <span class="hljs-string"><span class="hljs-string">"1970-01-01 00:00:00"</span></span> <span class="hljs-string"><span class="hljs-string">"2016-01-01 00:00:00"</span></span> 1451606425</code> </pre><br><br>  ,  1451606425 .        25,   26 ,         . <br><br><img src="https://habrastorage.org/files/657/109/7d3/6571097d35dc4d37a71760085eace43b.jpg" width="600"><br><br>  ,         ‚Äî            Java.   ,             ‚Äî    .         ‚Äî       . <br><br><h1> currentTimeMillis(), nanoTime() </h1><br><br>        Java    :        ,  ‚Äî        . <br><br><ul><li> java.lang.System#currentTimeMillis ‚Äî       1  1970 (   UTC).         java.util.Date  java.util.Calendar.   ,      ,       ‚Äî   .     ,       ‚Äî          . </li><li> java.lang.System#nanoTime ‚Äî      ¬´¬ª.         ‚Äî -,         ; - ‚Äî       ,                   .     ,     . ,     ,        ‚Äî       ,      java.lang.System#currentTimeMillis </li></ul><br><br>       : <br><ul><li> <a href="https://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks">Inside the Hotspot VM: Clocks, Timers and Scheduling Events</a> </li><li> <a href="https://stackoverflow.com/questions/510462/is-system-nanotime-completely-useless/4588605">Is System.nanoTime() completely useless?</a> </li><li> <a href="http://juliusdavies.ca/posix_clocks/clock_realtime_linux_faq.html">Linux FAQ for clock_gettime(CLOCK_REALTIME)</a> </li></ul><br><br><h1>    </h1><br><br>     ,      -      ‚Äî     java.lang.System#nanoTime.  java.lang.System#currentTimeMillis  ,         .      JavaDoc   . <br><br>   ,      java.lang.Thread     : <br><div class="spoiler"> <b class="spoiler_title">java.lang.Thread#join(long)</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">join</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> millis)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> InterruptedException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> base = System.currentTimeMillis(); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> now = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (millis &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalArgumentException(<span class="hljs-string"><span class="hljs-string">"timeout value is negative"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (millis == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (isAlive()) { wait(<span class="hljs-number"><span class="hljs-number">0</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (isAlive()) { <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> delay = millis - now; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (delay &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } wait(delay); now = System.currentTimeMillis() - base; } } }</code> </pre><br></div></div><br><br>   ,  -  , ,   java.util.concurrent.ExecutorService,   System.nanoTime. <br><br>          ,        System.currentTimeMillis()     ‚Äî   . <br><br><h1>    </h1><br><br>         ‚Äî             . <br><br>     ‚Äî , ,  -,    ,        . <br><br>   :   ,    .        IoC, ,  low-coupling  high-cohesion.  ,        .      ,   .       ‚Äî  .    ,   ,     .   ,          . <br><br>  ,      : <br><div class="spoiler"> <b class="spoiler_title">org.myproject.Chronometer</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Chronometer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">Date </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentMoment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentMs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentTicks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre><br></div></div><br><br>     ,    .     (org.myproject.Timer)     . <br><br>      ‚Äî ,  ,   : <br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><pre> <code class="java hljs">#   user.setCreated(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date()); user.setModified(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date()); #   Date now = chronometer.getCurrentMoment(); user.setCreated(now); user.setModified(now); #   Calendar calendar = Calendar.getInstance(); calendar.add(Calendar.DAY_OF_YEAR, -<span class="hljs-number"><span class="hljs-number">3</span></span>); Date expiration = calendar.getTime(); #   Calendar calendar = Calendar.getInstance(); calendar.setTimeZone(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.operationTimeZone) calendar.setTime(chronometer.getCurrentMoment()); calendar.add(Calendar.DAY_OF_YEAR, -<span class="hljs-number"><span class="hljs-number">3</span></span>); Date expiration = calendar.getTime();</code> </pre><br></div></div><br><br>           ,               -. <br><br>           . <br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">#   -   DELETE FROM records WHERE created &lt;= DATE_SUB(NOW(), INTERVAL 30 DAY) #    -       DELETE FROM records WHERE created &lt;= DATE_SUB(:now, INTERVAL 30 DAY) #    -       /  DELETE FROM records WHERE created &lt;= :expiration</span></span></code> </pre><br></div></div><br><br>   ,     ,        ‚Äî       1953    2312: <br><div class="spoiler">  <b class="spoiler_title">Sample test</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//  ""  mockChronometer.setCurrentTime("2120.06.10 15:33:11"); //      ""  Period period = new Period(); period.setStart(TimeUtils.parse("2120.06.01 00:00:00")); period.setEnd(TimeUtils.parse("2120.07.01 00:00:00")); period.setIndex("wdwwddwwdw"); period.setType(PeriodType.MONTH); period.setDescription("efefef"); periodsDao.save(period); // -  -         "2120.06.10 15:33:11". //   ,      . //         -     (  ). checkSomething1(); // ...  2     mockChronometer.setCurrentTime("2120.06.12 15:38:14"); //            checkSomething2();</span></span></code> </pre><br></div></div><br><br>           /  ,         MockChronometer  TimeUtils ‚Äî      .          ‚Äî    .       -     UTC ,        . <br><br>  Java 8   Date Time API   <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Clock.html">java.time.Clock</a> ,        ‚Äî    ,     . <br><br>   ‚Äî     <a href="http://habrahabr.ru/post/230239/">JVM   </a> ,           System.nanoTime()  System.currentTimeMillis().     ,      <a href="http://stackoverflow.com/questions/17398279/is-it-possible-to-freeze-system-currenttimemillis-for-testing"></a> <a href="http://stackoverflow.com/questions/2001671/override-java-system-currenttimemillis-for-testing-time-sensitive-code"></a> .            ‚Äî   System.nanoTime(), System.currentTimeMillis(), new Date(), Calendar.getInstance()     . <br><br><h1> Spring Framework </h1><br><br> 8    Spring  LocaleResolver,    TimezoneResolver (,   ,      ).    ,     DispatcherServlet. <br><br>    ,    <a href="https://jira.spring.io/browse/SPR-1528"> </a> (   ), <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/i18n/TimeZoneAwareLocaleContext.html">   </a>     4-  . <br><br><h1>  MVC </h1><br><br>   ‚Äî ,     ,     . <br><br>  FreeMarker   <a href="http://freemarker.incubator.apache.org/docs/ref_directive_setting.html"></a>   : <br><pre> <code class="hljs objectivec">&lt;<span class="hljs-meta"><span class="hljs-meta">#setting time_zone=</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Europe/Moscow"</span></span></span><span class="hljs-meta">&gt;</span></span></code> </pre><br><br>  JSP        <a href="http://www.tutorialspoint.com/jsp/jstl_format_formatdate_tag.htm"> </a>    <a href="http://www.tutorialspoint.com/jsp/jstl_format_settimezone_tag.htm"> </a> : <br><pre> <code class="hljs pgsql">&lt;fmt:formatDate <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>="both" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="${now}" timeZone="Europe/Moscow"/&gt; &lt;fmt:timeZone <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="Europe/Moscow"&gt; &lt;fmt:formatDate <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>="both" <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="${now}"/&gt; &lt;/fmt:timeZone&gt;</code> </pre><br><br>  Velocity  <a href="https://velocity.apache.org/tools/devel/javadoc/org/apache/velocity/tools/generic/DateTool.html">- </a> ,     . <br><br><h1>     </h1><br><br>         ‚Äî    java.util.Date#getTime()       long- Unix-time.      long  java.util.Date   .      Hibernate  RowMapper'.          ,        .         , ,   MySQL,     FROM_UNIXTIME. <br><br>   ,      /       .      (,   ,    ),     ,       .   ,             /: <br><ul><li>    -  ; </li><li>    -  ; </li><li>    -   ; </li><li>    -  ; </li><li>    -  ; </li><li>         . </li></ul><br><br>        ,           .      long   -  (    )         . <br><br>            ,            ,                 . <br><br>     ,         ,   .    MySQL       : TIMESTAMP and DATETIME. <br><br>    , TIMESTAMP     ,   ¬´2015-01-01 12:00:00 MSK¬ª      ,  ¬´2015-01-01 09:00:00 UTC¬ª       UTC,           .    DATETIME,   MSK- ¬´2015-01-01 12:00:00 MSK¬ª,  MySQL  UTC- ¬´2015-01-01 12:00:00 UTC¬ª,            . <br><br>  MySQL.   : <br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="bash hljs">$ sudo docker run --name mysql-time -e MYSQL_ROOT_PASSWORD=root -d mysql/mysql-server:5.7 $ sudo docker ps -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 82bb3eebc8bc mysql/mysql-server:5.7 /entrypoint.sh mysq 5 minutes ago Up 5 minutes 3306/tcp mysql-time $ sudo docker <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -it 82bb3eebc8bc bash [root@82bb3eebc8bc /]<span class="hljs-comment"><span class="hljs-comment"># TZ=Europe/Moscow mysql -u root -p Enter password: mysql&gt; CREATE DATABASE test; Query OK, 1 row affected (0.00 sec) mysql&gt; use test; Database changed mysql&gt; CREATE TABLE dates (id INTEGER, t1 TIMESTAMP, t2 DATETIME); Query OK, 0 rows affected (0.02 sec)</span></span></code> </pre><br></div></div><br><br>     ¬´Europe/Moscow¬ª   : <br><div class="spoiler"> <b class="spoiler_title">Europe/Moscow</b> <div class="spoiler_text"><pre> <code class="bash hljs">mysql&gt; SET time_zone = <span class="hljs-string"><span class="hljs-string">'Europe/Moscow'</span></span>; Query OK, 0 rows affected (0.00 sec) mysql&gt; SELECT @@session.time_zone; +---------------------+ | @@session.time_zone | +---------------------+ | Europe/Moscow | +---------------------+ 1 row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> (0.00 sec) mysql&gt; INSERT INTO dates VALUES (1, <span class="hljs-string"><span class="hljs-string">'2015-01-01 12:00:00'</span></span>, <span class="hljs-string"><span class="hljs-string">'2015-01-01 12:00:00'</span></span>); Query OK, 1 row affected (0.00 sec) mysql&gt; SELECT * FROM dates WHERE id = 1; +------+---------------------+---------------------+ | id | t1 | t2 | +------+---------------------+---------------------+ | 1 | 2015-01-01 12:00:00 | 2015-01-01 12:00:00 | +------+---------------------+---------------------+ 1 row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> (0.00 sec)</code> </pre><br></div></div><br><br>      ¬´UTC¬ª    : <br><div class="spoiler"> <b class="spoiler_title">UTC</b> <div class="spoiler_text"><pre> <code class="bash hljs">mysql&gt; SET time_zone = <span class="hljs-string"><span class="hljs-string">'UTC'</span></span>; Query OK, 0 rows affected (0.00 sec) mysql&gt; SELECT @@session.time_zone; +---------------------+ | @@session.time_zone | +---------------------+ | UTC | +---------------------+ 1 row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> (0.00 sec) mysql&gt; SELECT * FROM dates WHERE id = 1; +------+---------------------+---------------------+ | id | t1 | t2 | +------+---------------------+---------------------+ | 1 | 2015-01-01 09:00:00 | 2015-01-01 12:00:00 | +------+---------------------+---------------------+ 1 row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> (0.00 sec)</code> </pre><br></div></div><br><br> ,     t1  ‚Äî    ,      t2              . <br><br>      ,       .       ,     (    ),         (   ).   ,         ,       ‚Äî        .   ,    (   ),      . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Many databases have types of types that, in addition to the time point itself, store additional and information about the time zone in which it was entered. </font><font style="vertical-align: inherit;">For example, this can be useful if you need to know which particular time zone was primary for this value.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NTP </font></font></h1><br><br>    ,         ,          ,     ‚Äî   <a href="https://ru.wikipedia.org/wiki/NTP">NTP</a> . <br><br>   ‚Äî   ,        ,  NTP  <a href="http://habrahabr.ru/post/79461/"> </a>     . <br><br>            , <a href="https://en.wikipedia.org/wiki/Network_Time_Protocol"> </a>       UDP ,         <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_%25D0%259C%25D0%25B0%25D1%2580%25D0%25B7%25D1%2583%25D0%25BB%25D0%25BB%25D0%25BE"> </a> . <br><br> <a href="https://ru.wikipedia.org/wiki/NTP"></a> ,            10. <br><br><h1>  Notifications </h1><br><br>      (  )     :  (,  , )   (, , ,  ).           ,          ,         .   -      10   20 .   ,       . <br><br>   ,       -     ,      .  ,      -   (   )       ,          ,      . <br><br>         ‚Äî     ,        .                :    Android TV,      ;   Android-,         .  ,          .         ,       ,      . <br><br><div class="spoiler">  <b class="spoiler_title">Example</b> <div class="spoiler_text"><pre> <code class="java hljs">Date now = chronometer.getCurrentMoment(); TimeZone timeZone = userDeviceRecord.getTimeZone(); Calendar calendarFrom = Calendar.getInstance(timeZone); calendarFrom.setTime(now); calendarFrom.set(Calendar.HOUR_OF_DAY, comfortHourFrom); Calendar calendarTill = Calendar.getInstance(timeZone); calendarTill.setTime(now); calendarTill.set(Calendar.HOUR_OF_DAY, comfortourHourTill); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (now.after(calendarTill.getTime())) { calendarFrom.add(Calendar.DAY_OF_YEAR, +<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> delayMs = Math.max(calendarFrom.getTime().getTime() - now.getTime(), <span class="hljs-number"><span class="hljs-number">0</span></span>); notificationService.sendNotificationWithDelay(msg, delayMs);</code> </pre><br></div></div><br><br><h1> AM / PM </h1><br><br>  ,    ,     ,     <a href="https://ru.wikipedia.org/wiki/12-%25D1%2587%25D0%25B0%25D1%2581%25D0%25BE%25D0%25B2%25D0%25BE%25D0%25B9_%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2582_%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B5%25D0%25BD%25D0%25B8">12- </a>  . <br><br>      ,     : am (. ante meridiem  ‚Äî ¬´ ¬ª)  pm (. post meridiem  ‚Äî ¬´ ¬ª). <br><br>      ,   ‚Äî   12pm    0am,    12am. ,  ‚Äî   12am   0pm,  12pm.           ,   <a href="https://ru.wikipedia.org/wiki/12-%25D1%2587%25D0%25B0%25D1%2581%25D0%25BE%25D0%25B2%25D0%25BE%25D0%25B9_%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2582_%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B5%25D0%25BD%25D0%25B8"> </a> . <br><br><h1>    </h1><br><br>             ‚Äî  <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B0%25D1%2581%25D1%258B_%25D1%2580%25D0%25B5%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25B2%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B5%25D0%25BD%25D0%25B8">  </a>    Linux ¬´The Hardware Clock¬ª. <br><br><img src="https://habrastorage.org/files/7dd/90c/5cf/7dd90c5cf1d4469da21645b60e62ddc7.jpeg"><br><br>          :       ,    ,       -  .           ,         <a href="https://www.maximintegrated.com/en/design/tools/calculators/product-design/battery.cfm"> </a> . <br><br>    Hardware Clock (      )  Linux    hwclock.       (   /dev/rtc),      root. <br><br><pre> <code class="bash hljs">$ sudo hwclock Wed 30 Dec 2015 17:59:12 MSK -0.328637 seconds</code> </pre><br><br>       Hardware Clock    .         ? <br><br>   ,       Linux   ,    (The System Time).  Linux      ,    ,          .         ‚Äî      Hardware Clock         ,     ,   .     Linux    Hardware Clock,        ‚Äî        . <br><br>         ‚Äî        .     ,       hwclock <br><br>       (  -     ). <br><br>   ,        .    Hardware Clock        ‚Äî              .  hwclock            .      Hardware Clock  -     .  hwclock       Hardware Clock   ,        /etc/adjtime.         Hardware Clock    System Time  ,              . <br><br>   ,     -     System Time  .  ,  -    ,       System Time   .      ‚Äî    (  11 )     System Time   Hardware Time. <br><br>        <a href="http://linux.die.net/man/8/hwclock">  hwclock</a> . <br><br>      ,   Linux     Hardware Clock  .    ,  Hardware Clock    <a href="https://wiki.archlinux.org/index.php/Time">  yyyy, MM, dd, HH, mm, ss</a> .      ,            . <br><br>       :    UTC,     (,      -). <br><br>     BIOS       .     BIOS    ,   ,     BIOS     ( ‚Äî     Windows );    ,   BIOS     UTC (   ‚Äî   ). <br><br> Windows   ,     Hardware Clock   .  Linux         Hardware Clock,     UTC ( ). ,  ,       BIOS       Windows,  Linux   . <br><br>     Debian/Ubuntu  : <br><pre> <code class="bash hljs">$ cat /etc/default/rcS | grep UTC <span class="hljs-comment"><span class="hljs-comment"># assume that the BIOS clock is set to UTC time (recommended) UTC=yes</span></span></code> </pre><br><br><h1>   </h1><br><br>    -  ,            ,    Ubuntu/Debian   <a href="http://manpages.ubuntu.com/manpages/wily/man1/faketime.1.html"> faketime</a> ,      . <br><br><pre> <code class="bash hljs">$ date Wed Dec 30 22:53:11 MSK 2015 $ faketime -f <span class="hljs-string"><span class="hljs-string">'+2y'</span></span> date Fri Dec 29 22:53:39 MSK 2017</code> </pre><br><br><h1>  Birthday </h1><br><br>  - ,   ¬´15 ¬ª,           .   ,   ¬´15  2001 ¬ª,        .    ,            . -,    . -,     . , ,      ,     . <br><br>              ,             ?  ,   : <br><ul><li>    ‚Äî t(u).      ,     .    ,     . </li><li>    ‚Äî t(f).     ,       . </li></ul><br><br><div class="spoiler"> <b class="spoiler_title">Japan-France</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testBirthday</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ TimeZone japanTz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Japan"</span></span>); Calendar japanCalendar = Calendar.getInstance(japanTz); japanCalendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); japanCalendar.setTimeInMillis(<span class="hljs-number"><span class="hljs-number">0</span></span>); japanCalendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.APRIL, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"Japan 2016-04-15 09:00:00: "</span></span> + japanCalendar.getTimeInMillis()); japanCalendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.APRIL, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"Japan 2016-04-16 21:00:00: "</span></span> + japanCalendar.getTimeInMillis()); TimeZone franceTz = TimeZone.getTimeZone(<span class="hljs-string"><span class="hljs-string">"Europe/France"</span></span>); Calendar franceCalendar = Calendar.getInstance(franceTz); franceCalendar.setLenient(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); franceCalendar.setTimeInMillis(<span class="hljs-number"><span class="hljs-number">0</span></span>); franceCalendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.APRIL, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"France 2016-04-14 09:00:00: "</span></span> + franceCalendar.getTimeInMillis()); franceCalendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.APRIL, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"France 2016-04-14 21:00:00: "</span></span> + franceCalendar.getTimeInMillis()); franceCalendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.APRIL, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"France 2016-04-15 09:00:00: "</span></span> + franceCalendar.getTimeInMillis()); franceCalendar.set(<span class="hljs-number"><span class="hljs-number">2016</span></span>, Calendar.APRIL, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"France 2016-04-15 21:00:00: "</span></span> + franceCalendar.getTimeInMillis()); }</code> </pre><br><pre>Japan 2016-04-15 09:00:00: 1460678400000<font></font>
Japan 2016-04-16 21:00:00: 1460721600000<font></font>
France 2016-04-14 09:00:00: 1460624400000<font></font>
France 2016-04-14 21:00:00: 1460667600000<font></font>
France 2016-04-15 09:00:00: 1460710800000<font></font>
France 2016-04-15 21:00:00: 1460754000000<font></font>
</pre><br></div></div><br><br><img src="https://habrastorage.org/files/2b2/fa3/cab/2b2fa3cabe2e4e1fb8a6318d02ab8ee9.png" width="600"><br><br>  t(f)       t(u) ‚Äî ,     ,    ‚Äî  .    ,   ,        ,          .           ,       ¬´¬ª. <br><br><h1>   </h1><br><br>   ,     ,   .     :  ,   ,   . <br><br> ,     2000.01.10 00:00:01  .    2016.01.09 23:59:59  .       (2000.01.10)      (2016.01.09)   16     .  2016.01.09 23:59:59   ‚Äî    2016.01.10   (  )   16    .   ,            16,        ‚Äî    . <br><br>        <a href="http://citizen.joosy.ru/questions/240219-%25D0%259A%25D0%25BE%25D0%25B3%25D0%25B4%25D0%25B0-%25D1%258E%25D1%2580%25D0%25B8%25D0%25B4%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8-%25D0%25BD%25D0%25B0%25D1%2587%25D0%25B8%25D0%25BD%25D0%25B0%25D0%25B5%25D1%2582%25D1%2581%25D1%258F-%25D1%2581%25D0%25BE%25D0%25B2%25D0%25B5%25D1%2580%25D1%2588%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25BB%25D0%25B5%25D1%2582%25D0%25B8%25D0%25B5--%25D0%25B2-%25D0%25B4%25D0%25B5%25D0%25BD%25D1%258C-%25D1%2580%25D0%25BE%25D0%25B6%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F-%25D0%25B8%25D0%25BB%25D0%25B8-%25D0%25BD%25D0%25B0-%25D1%2581%25D0%25BB%25D0%25B5%25D0%25B4%25D1%2583%25D1%258E%25D1%2589%25D0%25B8%25D0%25B9-%25D0%25B4%25D0%25B5%25D0%25BD%25D1%258C-"> </a> ,    /   00:00:00  ,   .       2016.01.11 00:00:00     ‚Äî       16 ,     . <br><br><h1>  findings </h1><br><br><ul><li>    </li><li>       ,        Java      .          . </li><li>    JDK            . </li></ul><br><br> <a href="http://habrahabr.ru/post/274905/">  </a> ‚Äî   Date Time API  Java 8. </div><p>Source: <a href="https://habr.com/ru/post/274811/">https://habr.com/ru/post/274811/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274801/index.html">Custom rounded view</a></li>
<li><a href="../274803/index.html">Using Matalysis in computer games (part 2)</a></li>
<li><a href="../274805/index.html">On the issue of timers in RTOS (Conclusions)</a></li>
<li><a href="../274807/index.html">High Speed ‚Äã‚ÄãFile Transfer Protocol - Aspera FASP</a></li>
<li><a href="../274809/index.html">Quick work with JSON in Swift</a></li>
<li><a href="../274813/index.html">Shaders in libgdx for dummies</a></li>
<li><a href="../274815/index.html">Servo browser engine architecture</a></li>
<li><a href="../274819/index.html">All you need to know about the growing popularity of Malvertising</a></li>
<li><a href="../274821/index.html">How to predict a stock price: An adaptive filtering algorithm</a></li>
<li><a href="../274825/index.html">Algorithm Deflate for example PNG format</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>