<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Use lambdas to build CAML requests in SharePoint</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Article from colleagues, SharePoint-developers. 
 This article is written for those SharePoint -based product developers who occasionally encounter th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Use lambdas to build CAML requests in SharePoint</h1><div class="post__text post__text-html js-mediator-article">  Article from colleagues, SharePoint-developers. <br>  This article is written for those <b>SharePoint</b> -based product developers who occasionally encounter the need to make selections from one and / or several SharePoint lists ‚Äî which, in principle, happens almost always :-).  In this article I will discuss several ways to implement such samples with their advantages and disadvantages.  At the end of the article, I will give an example of using the recently published <b>Camlex.NET</b> project ( <a href="http://camlex.codeplex.com/">http://camlex.codeplex.com/</a> ), which seems to me the most convenient for this case.  So‚Ä¶ <br><a name="habracut"></a><br><h4>  First approach </h4><br>  The first, which is the easiest way, is to go through the list, select the necessary records and, possibly, perform some operations with them, for example, sort: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ]));</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ])); <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">SPWeb web = <font color="#0000ff">null</font> ; SPList list = web.Lists[ <font color="#A31515">"SomeList"</font> ]; <font color="#2B91AF">List</font> foundItems = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> (); <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0; i&lt;list.Items.Count; i++) { SPListItem item = list.Items[i]; <font color="#0000ff">if</font> (( <font color="#0000ff">string</font> ) item[ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; (( <font color="#0000ff">int</font> ) item[ <font color="#A31515">"IntField"</font> ] != 1 || ( <font color="#2B91AF">DateTime</font> )item[ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Today)) { foundItems.Add(item); } } foundItems.Sort( (x, y) =&gt; (( <font color="#0000ff">int</font> )x[ <font color="#A31515">"SortField"</font> ]).CompareTo(( <font color="#0000ff">int</font> )y[ <font color="#A31515">"SortField"</font> ]));</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Although the example is rather heavy, it presents almost all widely used things - fields of different types (string, int, DateTime), different comparison operations (==,! =, &lt;), Different logical operations (AND, OR) and, in appendage, there is also sorting.  The filter / sort semantics in our case is not important, so we will pay attention only to the syntax. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So - consider this example.  It is in the old-school style - simple and intuitive.  However, the performance of such a code is satisfactory only on very small lists containing literally several entries.  There is more (let's say, 1,000 entries) on the lists - this code is terribly slow.  The problem is that each record is drawn from the list (and this means from the content database) by a separate SQL request, while the filtering / sorting logic is located in the C # code. <br><br>  To solve this performance problem, Microsoft has developed the <b>SPQuery</b> and <b>SPSiteDataQuery classes</b> .  These classes accept SQL-like queries formatted in XML, and with their help, you can get the final result - respectively, filters and sorting / grouping are executed inside the SQL engine, and not in C # code.  So: <br><br><h4>  Second approach </h4><br>  This approach is optimal in performance.  The following example does the same as in the first example, but already uses the <b>SPQuery</b> class: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  SPQuery query = <font color="#0000ff">new</font> SPQuery (); </li><li>  query.Query = </li><li>  <font color="#A31515">"&lt;Where&gt;"</font> + </li><li>  <font color="#A31515">"&lt;And&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Eq&gt;"</font> + </li><li>  <font color="#A31515">"&lt;FieldRef Name = \" TextField \ "/&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Value Type = \" Text \ "&gt; Test &lt;/ Value&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ Eq&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Or&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Neq&gt;"</font> + </li><li>  <font color="#A31515">"&lt;FieldRef Name = \" IntField \ "/&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Value Type = \" Integer \ "&gt; 1 &lt;/ Value&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ Neq&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Lt&gt;"</font> + </li><li>  <font color="#A31515">"&lt;FieldRef Name = \" DateField \ "/&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Value Type = \" DateTime \ "&gt;"</font> + </li><li>  <font color="#A31515">"&lt;Today /&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ Value&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ Lt&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ Or&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ And&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ Where&gt;"</font> + </li><li>  <font color="#A31515">"&lt;OrderBy&gt;"</font> + </li><li>  <font color="#A31515">"&lt;FieldRef Name = \" SortField \ "/&gt;"</font> + </li><li>  <font color="#A31515">"&lt;/ OrderBy&gt;"</font> ; </li><li>  SPListItemCollection resultItems = list.GetItems (query); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Everything works and works quickly.  Fine! <br>  But the problems are also evident: <br><ul><li>  Any syntax error when formatting XML causes exception. </li><li>  The unreadability of the code totally increases - not only does the size of the sample increase by 2 times, it becomes much harder to read compared to the first approach. </li><li>  When changing the filter, you need to rebuild the tree of XML nodes - for example, the node of each logical operation takes only 2 operands, and in case you need to add another condition to the OR, you will have to split the corresponding subassembly into 2 parts, and in our case , the overall depth of the tree is becoming frightening. </li><li>  Transition from the usual C # code to the option of presenting code as XML - and, as a result, loss of compile-time checks, Intellisense, etc.  etc.  Given the global tendency to support the code-first approach, this drawback becomes simply critical. </li></ul>  Consequence - general developer dissatisfaction :-) <br><br><h4>  Third approach </h4><br>  In the following example, we will use the open-source project <b>CAML.NET</b> - <a href="http://camldotnet.codeplex.com/"><b></b></a><b><a href="http://camldotnet.codeplex.com/">camldotnet.codeplex.com</a></b> - (I really had to suffer a bit here, since the examples from the project documentation do not work - the API uses the missing CAML.Query () method ). <br>  Again, the following example performs exactly the same as the previous examples (I left the arrangement of parentheses authentic - just as used in the examples for the project): <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  SPQuery query2 = <font color="#0000ff">new</font> SPQuery (); </li><li>  query2.Query = </li><li>  CAML.Where ( </li><li>  CAML.And ( </li><li>  CAML.Eq ( </li><li>  CAML.FieldRef ( <font color="#A31515">"TextField"</font> ), </li><li>  CAML.Value ( <font color="#A31515">"Test"</font> )), </li><li>  CAML.Or ( </li><li>  CAML.Neq ( </li><li>  CAML.FieldRef ( <font color="#A31515">"IntField"</font> ), </li><li>  CAML.Value (1)), </li><li>  CAML.Lt ( </li><li>  CAML.FieldRef ( <font color="#A31515">"Datefield"</font> ), </li><li>  CAML.Value ( <font color="#2B91AF">DateTime</font> .Today))))) + </li><li>  CAML.OrderBy ( </li><li>  CAML.FieldRef ( <font color="#A31515">"SortField"</font> )); </li><li>  SPListItemCollection resultItems2 = list.GetItems (query2); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Well, that's better!  Making mistakes when printing XML has already become significantly more difficult, and performance has remained at its best.  The latter, however, is not surprising, since CAML.NET does not affect performance in any way, it‚Äôs just a thin wrapper over the standard CAML syntax ‚Äî CAML.NET simply helps to prepare XML, nothing more.  Which, however, is not at all bad! <br><br>  If you take a closer look at the resulting code, it becomes clear that this is just an attempt to mimic the standard CAML syntax.  As a consequence, this approach inherits many of the original CAML syntax problems.  Of the problems that I mentioned above (in the description of the second approach), in fact, only one problem is solved - the problem of correct XML formatting, while all other problems remain.  If you go to the CAML.NET project forum, you can see that users just complain about these problems. <br><br>  Is there anything more convenient for the developer?  I would not write this article if my answer was ‚Äúno‚Äù :-) <br><br><h4>  Fourth approach </h4><br>  Just over a week ago, we posted a new project called <b>Camlex.NET</b> on <b>CodePlex</b> - the project aims to solve the mentioned problems with developing samples from SharePoint lists - to make this process as close and understandable as possible to a C # developer.  The project's address is <a href="http://camlex.codeplex.com/"><b></b></a><b><a href="http://camlex.codeplex.com/">camlex.codeplex.com</a></b> . <br><br>  So, more to the point - let's reproduce the functionality of the previous examples, but already on the basis of the <b>Camlex.NET</b> project: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  SPQuery query3 = <font color="#0000ff">new</font> SPQuery (); </li><li>  query3.Query = Camlex.Query () </li><li>  .Where (x =&gt; ( <font color="#0000ff">string</font> ) x [ <font color="#A31515">"TextField"</font> ] == <font color="#A31515">"Test"</font> &amp;&amp; </li><li>  (( <font color="#0000ff">int</font> ) x [ <font color="#A31515">"IntField"</font> ]! = -1 || ( <font color="#2B91AF">DateTime</font> ) x [ <font color="#A31515">"DateField"</font> ] &lt; <font color="#2B91AF">DateTime</font> .Now)) </li><li>  .OrderBy (x =&gt; x [ <font color="#A31515">"SortField"</font> ]). ToString (); </li><li>  SPListItemCollection resultItems3 = list.GetItems (query3); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  And it's all!  :-) <br><br>  As you can see, this approach uses <b>expression trees</b> and <b>lambda to its</b> fullest, giving developers the opportunity to write C # code <i>without scoring their head with the problems of using CAML syntax</i> . <br><br>  Advantages of this approach: <br><ul><li>  The size of the code was even smaller than in the very first example, and the filters remained the same as there, simple and clear. </li><li>  Performance - at the level of the net CAML request. </li><li>  The ability to use when sampling from a variety of lists (instead of <b>SPQuery,</b> you must use <b>SPSiteDataQuery</b> ). </li><li>  Absence of XML syntax as such :-) Any filter changes are natural for C # developers, and will not require rebuilding the XML tree. </li><li>  The developer remains to the C # context.  And that means Intellisense, compile-time checks, code-first approach, etc.  etc. </li></ul>  In this article, I did not go into details of the <b>Camlex.NET</b> project - the format of the article will not allow me to do this, but if you go to the project site, you can see many other examples of use.  In the same article, I just wanted to make comparisons of different sampling techniques from the SharePoint lists - and the decision on what to use is yours, dear readers! <br><br><h4>  Links </h4><br>  Lastly, once again the address of our project: <br>  <b>Camlex.NET</b> on <b>CodePlex</b> 's - <a href="http://camlex.codeplex.com/">http://camlex.codeplex.com/</a> . <br><br>  Developer Blogs: <br>  <a href="http://twitter.com/sadomovalex">Alexey Sadomov</a> (my colleague) - <a href="http://sadomovalex.blogspot.com/">http://sadomovalex.blogspot.com/</a> <br>  <a href="http://twitter.com/vtimashkov">Vladimir Timashkov (your humble servant)</a> - <a href="http://vtimashkov.wordpress.com/">http://vtimashkov.wordpress.com/</a> <br><br>  I hope our project will be useful to you in your daily struggle with SharePoint :-) </div><p>Source: <a href="https://habr.com/ru/post/82787/">https://habr.com/ru/post/82787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82771/index.html">The sea is worried once ..., or Captcha 4D</a></li>
<li><a href="../82772/index.html">Lost youtube client for sonyericsson w995 + instructions for picking up jar</a></li>
<li><a href="../82778/index.html">question in space: will there be a normal post markup language in Habr√©?</a></li>
<li><a href="../82779/index.html">k3b 2 went into beta</a></li>
<li><a href="../82781/index.html">The computer of your dreams. Part 3: Hidden Horizons</a></li>
<li><a href="../82788/index.html">Fear of the future</a></li>
<li><a href="../82789/index.html">Ez-12 Parabolic Reflector Template / WiFi Signal Amplifier for Home Access Point</a></li>
<li><a href="../82790/index.html">New way to purchase premium</a></li>
<li><a href="../82792/index.html">Our version of ‚ÄúMille Bornes‚Äù on the iPhone - is it a damn lump?</a></li>
<li><a href="../82797/index.html">February Trainings</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>