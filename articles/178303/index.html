<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Context-sensitive form in yii</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When working with frameworks, you always have to create the basic functionality yourself, preferably using the capabilities of the framework (why then...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Context-sensitive form in yii</h1><div class="post__text post__text-html js-mediator-article">  When working with frameworks, you always have to create the basic functionality yourself, preferably using the capabilities of the framework (why then do we need it).  As the title implies, we‚Äôll talk about context-sensitive forms in Yii.  The article describes the implementation of this form using a modal window.  I hope that this option will be useful to someone. <br><br>  Looking ahead, I‚Äôll say that the result should be such a field, a drop-down menu and a button on the right to select the necessary data. <br><br><img src="https://habrastorage.org/storage2/e8b/111/15d/e8b11115d5981f027eb46eeedc755a5f.png"><br><a name="habracut"></a><br>  <b>Context-sensitive selection window:</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/84b/3f6/cae/84b3f6caec2c4e11e7265a7d82dfd4e9.png"><br><br>  <b>After selection:</b> <br><br><img src="https://habrastorage.org/storage2/c2e/221/a64/c2e221a64fa312dfa03d7c94eae440f5.png"><br><br>  Why was the option with a modal window chosen?  This allows you to simplify the selection of the desired item.  In a modal window, you can display CGridView, while you can sort, search and filter data, which is very convenient if you have to choose from a large number of elements. <br>  So, the ingredients for making this Yii scissors: <br><ul><li>  One <a href="http://www.yiiframework.com/">Yii</a> </li><li>  <a href="http://www.yiiframework.com/extension/nlsclientscript">NLSClientScript extension</a> </li><li>  <a href="http://twitter.github.io/bootstrap/">Bootstrap</a> to taste ( <a href="http://www.yiiframework.com/extension/bootstrap/">extension for Yii</a> ) </li></ul><br>  Now, be patient and start cooking. <br><br>  Suppose we have a <b>menuController.php</b> controller, a <b>viewform _form.php</b> file and a <b>Menu.php</b> model.  I will not dwell on who is who, all this is standard, automatically generated code <a href="">Gii</a> , Gee. <br><br><h4>  Model (Menu.php) </h4><br>  We first clarify how the model works.  We assume that we have a bundle of data type and ID, which is tied to the data type.  The model (as well as in the database) must contain the <i>type</i> and <i>data_id fields</i> , both integral.  For convenience, when loading the model, we will load the name of the object to which it refers (needed when editing the object).  Suppose in the <i>data_name</i> field.  Check the necessary frauds in the <i>afterFind ()</i> function.  Also make the list of data types more dynamic.  We define a static array in the class, so if we need to expand or narrow the type options, we will only edit the model class. <br>  Since  we use ActiveRecord, in fact, you only need to know the name of the model and view to work with a specific data type. <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $types = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-number"><span class="hljs-number">1</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"name"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"model"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"Pages"</span></span>, <span class="hljs-string"><span class="hljs-string">"view"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"pages_grid"</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"name"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"model"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"Docs"</span></span>, <span class="hljs-string"><span class="hljs-string">"view"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"docs_grid"</span></span>), <span class="hljs-number"><span class="hljs-number">3</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"name"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"model"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"Cats"</span></span>, <span class="hljs-string"><span class="hljs-string">"view"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"cats_grid"</span></span>), ); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSimpleTypes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   .   DropDownList $st = array(); foreach (Menu::$types as $key =&gt; $value) $st[$key] = $value["name"]; return $st; } var $data_name; public function afterFind() { $dataModel = $types[$this-&gt;type]['model']::model()-&gt;findByPk($this-&gt;data_id); $this-&gt;data_name = $dataModel-&gt;title; //   $data_name    parent::afterFind(); }</span></span></code> </pre> <br>  At the end of this review model. <br><br><h4>  View form (_form.php) </h4><br>  We look view file of our form _form.php <br><br><pre> <code class="php hljs">&lt;!--    --&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $form=<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;beginWidget(<span class="hljs-string"><span class="hljs-string">'bootstrap.widgets.TbActiveForm'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'menu-form'</span></span>, <span class="hljs-string"><span class="hljs-string">'enableAjaxValidation'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">'type'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span>, )); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;!--       --&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $form-&gt;errorSummary($model);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $form-&gt;textFieldRow($model,<span class="hljs-string"><span class="hljs-string">'name'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;!--  ,    data_id --&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $form-&gt;textField($model,<span class="hljs-string"><span class="hljs-string">'data_id'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'hide'</span></span>)); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;!--        bootstrap--&gt; &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">control</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">group</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">control</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">label</span></span></span><span class="hljs-class">"&gt; &lt;?=$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">labelEx</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">,'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">')?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">controls</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">input</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">append</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dropDownList</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">,'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">',</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Menu</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">getSimpleTypes</span></span></span><span class="hljs-class">());?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">button</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">select</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loading</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">text</span></span></span><span class="hljs-class">="..." </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">button</span></span></span><span class="hljs-class">"&gt;&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">i</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">icon</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">i</span></span></span><span class="hljs-class">&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">button</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;!--   ,    .     </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Update</span></span></span><span class="hljs-class">,   ,  --&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">success</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">controls</span></span></span><span class="hljs-class"> &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNewRecord</span></span></span><span class="hljs-class">):?&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hide</span></span></span><span class="hljs-class">&lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endif</span></span></span><span class="hljs-class">;?&gt;"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">i</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">icon</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">file</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">i</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">span</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">info</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class">(!$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNewRecord</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">echo</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data_name</span></span></span><span class="hljs-class">?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">span</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;!--  /--&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">actions</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">widget</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bootstrap</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">widgets</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TbButton</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">( '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">buttonType</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">submit</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">primary</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">label</span></span></span><span class="hljs-class">'=&gt;$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNewRecord</span></span></span><span class="hljs-class"> ? '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Create</span></span></span><span class="hljs-class">' : '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Save</span></span></span><span class="hljs-class">', )); ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endWidget</span></span></span><span class="hljs-class">(); ?&gt; &lt;!--      --&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">beginWidget</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bootstrap</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">widgets</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TbModal</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dataModal</span></span></span><span class="hljs-class">')); ?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">modal</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">header</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">close</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dismiss</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">modal</span></span></span><span class="hljs-class">"&gt;√ó&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h4</span></span></span><span class="hljs-class">&gt;&lt;?=</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Yii</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">("</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">menu</span></span></span><span class="hljs-class">", " ")?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h4</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">modal</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">body</span></span></span><span class="hljs-class">"&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">modal</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">footer</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">widget</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bootstrap</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">widgets</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TbButton</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">( '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">label</span></span></span><span class="hljs-class">'=&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Yii</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">("</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">menu</span></span></span><span class="hljs-class">", ""), '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class">'=&gt;'#', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">htmlOptions</span></span></span><span class="hljs-class">'=&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">array</span></span></span><span class="hljs-class">('</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dismiss</span></span></span><span class="hljs-class">'=&gt;'</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">modal</span></span></span><span class="hljs-class">'), )); ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">endWidget</span></span></span><span class="hljs-class">(); ?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">script</span></span></span><span class="hljs-class">&gt; //       </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">selectData</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#Menu_data_id"</span></span>).val(id); $(<span class="hljs-string"><span class="hljs-string">"#data-info .info"</span></span>).html(name); $(<span class="hljs-string"><span class="hljs-string">"#data-info"</span></span>).show(); $(<span class="hljs-string"><span class="hljs-string">'#dataModal'</span></span>).modal(<span class="hljs-string"><span class="hljs-string">"hide"</span></span>); } <span class="hljs-comment"><span class="hljs-comment">//  data_id     $('#Menu_type').change(function(){ $("#Menu_data_id").val(""); $("#data-info").hide(); }) //         ,   AJAX $('#data-select-btn').click(function(){ var buttn = this; $(buttn).button('loading'); $.ajax({ url: "</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?php</span></span></span><span class="hljs-comment"> echo $this-&gt;createAbsoluteUrl('menu/loadData') </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment">", cache: false, data: "type="+$("#Menu_type").val(), success: function(html){ $(".modal-body").html(html); $(buttn).button('reset'); $('#dataModal').modal().css({ width: 'auto', 'margin-left': function () { return -($(this).width() / 2); }, }); } }); }) &lt;/script&gt;</span></span></code> </pre><br>  Actually this is the entire form file.  The main elements here are our field and function for AJAX data request. <br>  As you can see, the data retrieval function accesses the <i>menu / loadData action</i> .  Let's see what he does: <br><br><h4>  Controller (menuController.php) </h4><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionLoadData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($type)</span></span></span><span class="hljs-function"> </span></span>{ $model_name = Menu::$types[$type][<span class="hljs-string"><span class="hljs-string">'model'</span></span>]; $model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> $model_name(<span class="hljs-string"><span class="hljs-string">'search'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      if(isset($_GET[$model_name])) //          $model-&gt;attributes=$_GET[$model_name]; $this-&gt;renderPartial(Menu::$types[$type]['view'],array( 'model'=&gt;$model, ), false, true); //   $processOutput = true,      . }</span></span></code> </pre><br>  It is worth noting that you need to set the parameter <i>$ processOutput = true</i> for the <i>renderPartial</i> function, otherwise the scripts connected by the widgets in the view file will not be loaded. <br>  You also need to clarify a very important point, when setting the <i>$ processOutput</i> parameter, all files will be uploaded, including those that have already been connected on the main page, which is very critical in the case of, for example, JQuery.  Therefore, I advise you to install the NLSClientScript extension, it will check that all files are connected once. <br><br><h4>  View file for modal window (docs_grid.php) </h4><br>  View files should be stored in the designated folder of the controller, i.e.  in our case it will be <b>/ protected / views / menu</b> <br>  Now let's analyze one of the view files for the modal window.  You can use any convenient form to select data, the main thing is that it works through the model object.  I like the <a href="http://www.yiiframework.com/doc/api/1.1/CGridView">CGridView</a> because  it has everything you need: search, pagination and sorting. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;widget(<span class="hljs-string"><span class="hljs-string">'bootstrap.widgets.TbGridView'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'docs-grid'</span></span>, <span class="hljs-string"><span class="hljs-string">'dataProvider'</span></span>=&gt;$model-&gt;search(), <span class="hljs-string"><span class="hljs-string">'filter'</span></span>=&gt;$model, <span class="hljs-string"><span class="hljs-string">'columns'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'title'</span></span>, <span class="hljs-string"><span class="hljs-string">'updated'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'class'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'CButtonColumn'</span></span>, <span class="hljs-string"><span class="hljs-string">'template'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"{insert}"</span></span>, <span class="hljs-string"><span class="hljs-string">'buttons'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"insert"</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'label'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">'options'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"class"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"btn btn-mini btn-success"</span></span>, <span class="hljs-string"><span class="hljs-string">"onclick"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'selectData($(this).parent().parent().children(":nth-child(1)").text(),$(this).parent().parent().children(":nth-child(2)").text());'</span></span>, ) ), ) ), ), ));</code> </pre><br>  There is nothing superfluous, one single grid with item selection buttons.  The example uses a bootstrap grid, but you can use a standard CGridView. <br>  But there is one trick.  As you noticed, there is a nondescript script on the item selection button that tears out the <i>id</i> and <i>title of the</i> item from the table.  Unfortunately, the GridView widget does not allow to operate with data of a single record.  Therefore, it is necessary in this way to get the necessary <i>id</i> and <i>title</i> , which are passed to the <i>selectData</i> function described in the view <b>_form.php</b> file. <br><br>  That's all.  In order to add a new data type, it is enough to add one more line in the array created in the <b>Menu.php</b> model and write or generate, with the help of Gii, the ActiveRecord model for the new type. </div><p>Source: <a href="https://habr.com/ru/post/178303/">https://habr.com/ru/post/178303/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../178287/index.html">Google is preparing a netbook on Android for $ 200</a></li>
<li><a href="../178289/index.html">The results of an independent study of the market of information security systems</a></li>
<li><a href="../178297/index.html">The next winners of the Microsoft BizSpark startups story contest</a></li>
<li><a href="../178299/index.html">Customization of scrollbars in the browser: a compromise between html, css, js technologies and usability</a></li>
<li><a href="../178301/index.html">This capricious eigrp on DMVPN tunnels</a></li>
<li><a href="../178305/index.html">JQuery Popup Fixed Navigation</a></li>
<li><a href="../178307/index.html">Options in css 3 and a little about the possibilities for rubber sites</a></li>
<li><a href="../178309/index.html">Population algorithm based on fish school behavior</a></li>
<li><a href="../178311/index.html">The implementation of the stack due to ... call stack</a></li>
<li><a href="../178313/index.html">Autostart PPPoE connection without logging in to your account</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>