<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to generate meaningful commits. Apply Conventional Commits Standard</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habitual chaos in commit names. Familiar picture? 

 Surely you know git-flow . This is a great set of conventions for organizing work with branches i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to generate meaningful commits. Apply Conventional Commits Standard</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ng/mu/rl/ngmurlvjeqhxhfrhsovr_vhh5cc.png"><br><br>  <i>Habitual chaos in commit names.</i>  <i>Familiar picture?</i> <br><br>  Surely you know <b><font color="#487284"><a href="https://nvie.com/posts/a-successful-git-branching-model/">git-flow</a></font></b> .  This is a great set of conventions for organizing work with branches in Git.  It is well documented and widely distributed.  Usually we are familiar with the correct branching and talk a lot about it, but, unfortunately, we pay too little attention to the name of commits, so often the messages in Git are written haphazardly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      My name is Yerzhan Tashbenbetov, I work in one of the Yandex.Market teams.  And today I will tell Habr's readers what tools to create meaningful commits we use in the team.  I invite you to join the discussion of this topic. <br><br><a name="habracut"></a><br>  The lack of agreement on commits makes it difficult to work with history in Git.  That was on our team.  Before using common for all regulations and implementation of automation, typical commits looked as follows: <br><br><pre><code class="bash hljs">SECRETMRKT-700:     , . SECRETMRKT-701, SECRETMRKT-702:     ...</code> </pre> <br>  First, each developer wrote messages as he wanted: someone described the task, someone listed the changes made, someone used a random phrase generator.  Everything was at odds with each other.  Second, task numbers that were present in commits often shortened useful text.  All this made it difficult to work effectively with history in Git. <br><br>  For this reason, we implemented the <i>Conventional Commits</i> standard in the team, began to generate commits in the <i>commitizen</i> console utility and check the result using <i>commitlint</i> .  As a result, commits have changed and become like this: <br><br><pre> <code class="bash hljs">refactor(tutorial):      feat(products):      fix(products):     </code> </pre> <br>  Reading the history and recognizing the changes made easier.  We didn‚Äôt refuse to specify task numbers, everything was neatly transferred inside commits according to <i>Conventional Commits convention</i> . <br><br>  Next, I'll tell you how to achieve a similar order in Git. <br><br><hr><br><h2>  Best practices, recommendations, and common solutions for committing names </h2><br>  If you try to understand what practices are used in the industry, you can find the following options: <br><br><ul><li>  <b>Articles with general tips on writing commits.</b>  For the most part, they are quite logical and not bad reveal the topic, but there is a sense of confusion and the lack of a comprehensive solution to the issue. </li><li>  <b>Standards for writing commits.</b>  They are few.  They are documents with a clear list of rules, often written specifically for a large library or framework.  These standards are captivating with a systematic approach, popularity and support in the open-source community. </li></ul><br><blockquote>  <b>We need more order in commits!</b> </blockquote><br>  <b><font color="#487284"><a href="https://www.conventionalcommits.org/">Conventional Commits methodology</a></font></b> stands out against other standards and deserves close examination for several reasons: <br><br><ol><li>  It is well documented and worked out.  In its specification answers to the most common questions. </li><li>  The creators of the convention were inspired by the requirements for writing commits, which are used in the popular and time-tested framework <b><font color="#487284"><a href="">AngularJS</a></font></b> . </li><li>  Several large and popular open-source libraries (such as <b><font color="#487284"><a href="https://github.com/yargs/yargs">yargs</a></font></b> and <b><font color="#487284"><a href="https://github.com/lerna/lerna">lerna</a></font></b> ) follow the rules of the convention. </li><li>  The advantages include preparation for the automatic formation of the Release Notes and Change Log. </li></ol><br>  <b>An example of a commit to this standard:</b> <br><br><pre> <code class="bash hljs">fix(products):             -     .  : SECRETMRKT-578, SECRETMRKT-602</code> </pre> <br><hr><br><h2>  Basic abstracts of Conventional Commits </h2><br><ul><li>  The developer should adhere to the following commit structure: <br><blockquote>  &lt;type&gt; (&lt;scope&gt;): &lt;subject&gt; <br><br>  &lt;body&gt; <br><br>  &lt;footer&gt; </blockquote></li><li>  A commit should have a header, maybe a body and a footer. </li><li>  The commit title should start with a type ( <i>type</i> ) indicating the specifics of the changes made to the code base and end with a description. </li><li>  Along with the mandatory <i>feat</i> , <i>fix</i> (the use of which is strictly regulated), other types are allowed. </li><li>  A commit may have a <i>scope</i> .  It describes the code snippet affected by the changes.  The area follows the type of commit.  The standard does not regulate a clear list of areas.  Examples of domains: eslint, git, analytics, etc. </li><li>  The commit description should be immediately after the type / area. </li><li>  The commit body can be used to detail changes.  The body should be separated from the description by an empty line. </li><li>  The footer should be used to specify external links, commit context, or other meta information.  The footer should be separated from the body by a blank line. </li></ul><br><br><h4>  In addition to the rules listed in the convention, we use the following popular recommendations: </h4><br><ul><li>  In the body of a commit we write <i>what has</i> been changed and <i>why</i> . </li><li>  We use the following types of commits: <br><table><tbody><tr><td>  <b>build</b> </td><td>  Build a project or change external dependencies </td></tr><tr><td>  <b>ci</b> </td><td>  Configuring CI and working with scripts </td></tr><tr><td>  <b>docs</b> </td><td>  Documentation update </td></tr><tr><td>  <b>feat</b> </td><td>  Adding new functionality </td></tr><tr><td>  <b>fix</b> </td><td>  Error correction </td></tr><tr><td>  <b>perf</b> </td><td>  Changes to improve performance </td></tr><tr><td>  <b>refactor</b> </td><td>  Editing the code without correcting errors or adding new features </td></tr><tr><td>  <b>revert</b> </td><td>  Rollback to previous commits </td></tr><tr><td>  <b>style</b> </td><td>  Code style edits (tabs, indents, full stops, commas, etc.) </td></tr><tr><td>  <b>test</b> </td><td>  Adding tests </td></tr></tbody></table></li><li>  We write the description in the <i>imperative mood</i> , just like Git itself. <br><blockquote>  Merge branch 'fix / SECRETMRKT-749-fix-typos-in-titles' </blockquote></li><li>  We do not download the description of the commit with punctuation marks. </li></ul><br><br><img src="https://habrastorage.org/webt/55/ad/m3/55adm3kaxsbufwkyt_ziaxcyxca.png"><br><br>  <i><i>Conventional Commits standard is</i> used by lerna <a href="https://github.com/lerna/lerna"><b>distributors.</b></a></i> <br><br><hr><br><h1>  How easy is it to switch to the correct name of commits? </h1><br>  Need to add automation and convenience.  To solve this issue, we need two tools: a commit generator and a liter commit that is configured to be checked before pushing to the repository. <br><br><hr><br><h1>  Configure the commitizen utility </h1><br>  This tool allows you to generate commits using the built-in wizard.  In addition, commitizen is well supported by the community and, thanks to additional modules, is perfectly customizable. <br><br><ol><li>  Install the <b><font color="#487284"><a href="https://github.com/commitizen/cz-cli">commitizen</a></font></b> utility globally (you may need administrator privileges). <br><br><pre> <code class="bash hljs">npm i -g commitizen</code> </pre> </li><li>  Next install the adapter <b><font color="#487284"><a href="https://github.com/leonardoanalista/cz-customizable">cz-customizable</a></font></b> .  It is needed to set up a template with questions used by the <i>commitizen</i> utility. <br><br><pre> <code class="bash hljs">npm i -D cz-customizable</code> </pre> </li><li>  Create a file commitizen.js, it is needed to configure cz-customizable.  Place the created file in the directory ./config/git.  I recommend not to litter the root of the project with configuration files and try to group the files in the folder prepared for this.  Content: <br><br><div class="spoiler">  <b class="spoiler_title">Show commitizen.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">"use strict"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-comment"><span class="hljs-comment">//         types: [ { value: "build", name: "build:      " }, { value: "ci", name: "ci:  CI    " }, { value: "docs", name: "docs:  " }, { value: "feat", name: "feat:   " }, { value: "fix", name: "fix:  " }, { value: "perf", name: "perf:     " }, { value: "refactor", name: "refactor:         " }, { value: "revert", name: "revert:    " }, { value: "style", name: "style:    (, , ,   ..)" }, { value: "test", name: "test:  " } ], // .    ,    scopes: [ { name: "components" }, { name: "tutorial" }, { name: "catalog" }, { name: "product" } ], //         (  'fix') /* scopeOverrides: { fix: [ {name: 'style'}, {name: 'e2eTest'}, {name: 'unitTest'} ] }, */ //    messages: { type: "   ?", scope: "\n ,    ():", //   allowCustomScopes  true customScope: "  :", subject: "     :\n", body: '   ().  "|"   :\n', breaking: " BREAKING CHANGES ():\n", footer: "    (,   ). : SECRETMRKT-700, SECRETMRKT-800:\n", confirmCommit: "   ?" }, //    allowCustomScopes: true, //   Breaking Changes allowBreakingChanges: false, //     footerPrefix: " :", // limit subject length subjectLimit: 72 };</span></span></code> </pre> <br></div></div><br></li><li>  Add the package.json links to the cz-customizable and previously created configuration file: <br><br><div class="spoiler">  <b class="spoiler_title">Show part package.json</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"config"</span></span>: { <span class="hljs-string"><span class="hljs-string">"commitizen"</span></span>: { <span class="hljs-string"><span class="hljs-string">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/cz-customizable"</span></span> }, <span class="hljs-string"><span class="hljs-string">"cz-customizable"</span></span>: { <span class="hljs-string"><span class="hljs-string">"config"</span></span>: <span class="hljs-string"><span class="hljs-string">"config/git/commitizen.js"</span></span> } }, }</code> </pre> </div></div><br></li><li>  Let's check the resulting result.  Type the following command in the terminal: <br><br><pre> <code class="bash hljs">git cz</code> </pre> </li></ol><br>  The commitizen wizard will first collect information about the type and area of ‚Äã‚Äãthe commit, then sequentially ask for the text that will be in the description, in the body, in the footer, and after your consent will create a commit. <br><br><blockquote>  Be sure to <b><font color="#487284"><a href="https://asciinema.org/a/212473">look</a></font></b> at an example of how the commitizen utility is configured and the cz-cusomizable adapter connected to it. </blockquote><br><hr><br><h1>  Configure the husky and commitlint utilities </h1><br><ol><li>  Install <b><font color="#487284"><a href="https://github.com/typicode/husky">husky</a></font></b> and <b><font color="#487284"><a href="https://github.com/marionebl/commitlint">commitlint</a></font></b> in the project: <br><br><pre> <code class="bash hljs">npm i -D husky @commitlint/cli</code> </pre> </li><li>  With the help of husky we will add check of kommit.  To do this, in package.json immediately after the scripts, add the following hook and specify a link to the commitlint.js file in it: <br><br><div class="spoiler">  <b class="spoiler_title">Show part package.json</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"test"</span></span>: <span class="hljs-string"><span class="hljs-string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span> }, <span class="hljs-string"><span class="hljs-string">"husky"</span></span>: { <span class="hljs-string"><span class="hljs-string">"hooks"</span></span>: { <span class="hljs-string"><span class="hljs-string">"commit-msg"</span></span>: <span class="hljs-string"><span class="hljs-string">"commitlint -E HUSKY_GIT_PARAMS -g './config/git/commitlint.js'"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"devDependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"@commitlint/cli"</span></span>: <span class="hljs-string"><span class="hljs-string">"^7.2.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"husky"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.1.3"</span></span>, }</code> </pre> <br></div></div><br></li><li>  Create a file commitlint.js, necessary for the correct operation of the linter.  Place the created file in the directory ./config/git.  File contents: <br><br><div class="spoiler">  <b class="spoiler_title">Show commitlint.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     @commitlint/config-conventional module.exports = { rules: { //        "body-leading-blank": [2, "always"], //         "footer-leading-blank": [2, "always"], //    72  "header-max-length": [2, "always", 72], //       "scope-case": [2, "always", "lower-case"], //      "subject-empty": [2, "never"], //     '.' "subject-full-stop": [2, "never", "."], //       "type-case": [2, "always", "lower-case"], //      "type-empty": [2, "never"], //      "type-enum": [ 2, "always", [ "build", "ci", "docs", "feat", "fix", "perf", "refactor", "revert", "style", "test" ] ] } };</span></span></code> </pre> <br></div></div><br></li></ol><br>  Everything.  Now all commits will be checked before being sent to the repository :) <br><br><blockquote>  Be sure to <b><font color="#487284"><a href="https://asciinema.org/a/212490">look</a></font></b> at an example of the work of the configured commitlint utility. </blockquote><br><hr><br><h3>  So choose commitizen or commitlint? </h3><br>  Both!  In combination, they bring excellent results: the first generates commits, the second checks them. <br><br><br><h3>  Why do standards recommend imperative use? </h3><br>  This is a very interesting question.  A commit is a change in code; a message in a commit can be interpreted as a guide to changing this code.  Make, change, add, update, fix - all these are specific instructions for the developer. <br><br>  By the way, the imperative is recommended in the <b><font color="#487284"><a href="https://git.kernel.org/pub/scm/git/git.git/tree/Documentation/SubmittingPatches">Git</a></font></b> versioning <b><font color="#487284"><a href="https://git.kernel.org/pub/scm/git/git.git/tree/Documentation/SubmittingPatches">system itself</a></font></b> : <br><br><pre> <code class="bash hljs">[[imperative-mood]] Describe your changes <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> imperative mood, eg <span class="hljs-string"><span class="hljs-string">"make xyzzy do frotz"</span></span> instead of <span class="hljs-string"><span class="hljs-string">"[This patch] makes xyzzy do frotz"</span></span> or <span class="hljs-string"><span class="hljs-string">"[I] changed xyzzy to do frotz"</span></span>, as <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you are giving orders to the codebase to change its behavior.</code> </pre> <br><br><h3>  Why stick to any conventions?  Is it worth spending time on it?  What is the profit in this? </h3><br>  Worth it.  In general, I noticed that we were more willing to detail the changes made to the code base.  In the body of a commit, we describe in detail why we had to use certain solutions.  Understanding the history has become objectively easier.  Plus, our product is developing, and we are waiting for replenishment in the team.  I am sure that thanks to the implementation of the standard and automation, it will be easier for new users to integrate into the development process. <br><br>  Try and share the result. <br><br><br><h2>  Useful links: </h2><br><ul><li>  <b><font color="#487284"><a href="https://github.com/tashbenbetov/make-commit-messages-great-again">Repository</a></font></b> with all the code from this article. </li><li>  Standard <b><font color="#487284"><a href="https://www.conventionalcommits.org/">Conventional Commits</a></font></b> . </li><li>  <b><font color="#487284"><a href="https://marionebl.github.io/commitlint">Commitlint is a</a></font></b> tool for validating commits. </li><li>  Online <b><font color="#487284"><a href="https://commitlint.io/">configurator</a></font></b> correct commits. </li><li>  Good <b><font color="#487284"><a href="https://chris.beams.io/posts/git-commit/">advice</a></font></b> on the name of commits. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/431432/">https://habr.com/ru/post/431432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431414/index.html">Google employees openly opposed the development of a search engine censored for China</a></li>
<li><a href="../431418/index.html">How to teach artificial intelligence common sense</a></li>
<li><a href="../431424/index.html">Carbon M2 3D printers and robots: high-speed 3D printing</a></li>
<li><a href="../431428/index.html">The complete guide to CMake. Part One: Syntax</a></li>
<li><a href="../431430/index.html">Participation in open source projects can be beneficial for companies - why and what it gives</a></li>
<li><a href="../431434/index.html">Three history of modernization in the data center</a></li>
<li><a href="../431436/index.html">Why SRE is important documentation. Part 2</a></li>
<li><a href="../431438/index.html">Julia. Strings and Metaprogramming</a></li>
<li><a href="../431440/index.html">Timofey Bokarev, an interesting Russian game designer</a></li>
<li><a href="../431442/index.html">Updated WD Black NVMe: what is 3D NAND really capable of?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>