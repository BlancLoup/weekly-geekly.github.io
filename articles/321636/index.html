<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automount afuse</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I wanted to tell you about my discovery afuse - automatic mounting of file systems on demand, automatically. Isn't it great just to do: 



ls /mnt/re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automount afuse</h1><div class="post__text post__text-html js-mediator-article">  I wanted to tell you about my discovery afuse - automatic mounting of file systems on demand, automatically.  Isn't it great just to do: <br><br><pre><code class="bash hljs">ls /mnt/remote/web.example.com/var/lib/www/</code> </pre> <br>  And immediately see the files of the web-server, without in any way establishing a connection with it specifically?  I use it for a long time, and most importantly: <br><br><ul><li>  It works from any source: It doesn‚Äôt matter if you make the indicated output in the console, save the link in MC, or switch from your favorite manager‚Äôs favorites such as nautilus or dolphin </li><li>  You can go to any host where you have access by keys (you can also set up a password request, but this is not interesting) </li><li>  You can easily specify which user to log into the server using @: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /mnt/remote/apache@web.example.com/var/lib/www/</code> </pre></li></ul><a name="habracut"></a><br><h2>  What is it and why </h2><br>  It can be used with different systems, but the most convenient course with <a href="https://github.com/libfuse/sshfs">sshfs</a> .  I think many have dealt with it, it is really convenient, but if you need to walk around a remote file system, you have to mount it every time: <br><br><pre> <code class="bash hljs">sshfs hostname: mountpoint</code> </pre> <br>  It becomes extremely tedious when you work with hundreds of remote servers, especially when you need it, for example, to quickly transfer a small config file from one remote server to another (and it‚Äôs better not to download large files via sshfs and rsync or bbcp) . <br><br>  <a href="http://afuse.sourceforge.net/">Afuse</a> open source project is itself a fuse file system.  It is available for most modern distributions. <br><br>  <b>Very good article about its description, and also setup was <a href="https://habrahabr.ru/post/52310/">already on Habr√©</a> .</b>  <b>All those who try it for the first time, send it there.</b> <b><br><br></b>  <b>We, not to repeat, go a little further.</b> <br><br>  The only thing I would like to note is that for distributions based on RPM (Fedora, CentOS, RHEL, Scientific Linux ...) you will need to use yum / dnf: <br><br><pre> <code class="bash hljs">dnf install afuse</code> </pre> <br>  Use yum instead of dnf on older systems such as CentOS. <br><br>  Setting the keys, hosts and mount options is unlikely to be very different, for subtleties you can always refer to the manual. <br><br><h2>  Afuse automount </h2><br>  I believe that you have already played and you liked mounting sshfs on the fly.  Here is only in the above article, well, very crooked way to mount afuse itself.  I suppose that you, too, have a sediment: <b>‚ÄúHow is it that the file system that mounts other file systems needs to be manually mounted each time !?‚Äù</b> <br><br>  Exactly how to do this and I wanted to share. <br><br>  In fact, all the mechanisms are already in the system.  So, since afuse itself is a file system, then why not mount it in the standard way from / etc / fstab !? <br><br>  In principle, this is very possible, but there is no direct way to pass so many desired arguments. <br><br>  Therefore, it is supposed to create a wrapper script /usr/sbin/mount.afuse (laid out as well as the <a href="https://gist.github.com/Hubbitus/c40d986921cbed6a8ad585eee00a7d77">gist</a> is more convenient for someone, there is also a more detailed description of it) of approximately the following content: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Mount under user and group which are owners of mount point su -l $( stat --format=%U "$2" ) -c "afuse -o mount_template='sshfs -o reconnect -o auto_cache -o kernel_cache %r:/ %m' -o unmount_template='fusermount -u -z %m' -o auto_unmount '$2'"</span></span></code> </pre> <br>  Do not forget to make it executable: <br><br><pre> <code class="bash hljs">chmod +x /usr/sbin/mount.afuse</code> </pre> <br><br>  Now we are ready to add a new system mount point in / etc / fstab: <br><pre> <code class="hljs objectivec">afuse<span class="hljs-meta"><span class="hljs-meta"># /mnt/remote afuse auto 0 0</span></span></code> </pre> <br>  Everything, from this point on, even after rebooting the system, afuse is mounted, and all connections to remote hosts will be restored automatically if some programs worked with remote files along such paths.  There will be no errors that something is not available. <br><br>  Of course, you can change the mount point at will, maybe something like / remote.  Do not forget to just create a directory. <br><br>  Update 02/14/2017: According to the <a href="https://habrahabr.ru/users/self_perfection/" class="user_link">Self_Perfection</a> comment, the <a href="https://habrahabr.ru/users/self_perfection/" class="user_link">helper</a> code has <a href="https://habrahabr.ru/users/self_perfection/" class="user_link">been</a> slightly improved to get the user, from which the directory will be mounted.  It has become more simple and understandable. </div><p>Source: <a href="https://habr.com/ru/post/321636/">https://habr.com/ru/post/321636/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321626/index.html">How to start a startup and not break your own life</a></li>
<li><a href="../321628/index.html">Aggressive energy saving when running on Windows on battery</a></li>
<li><a href="../321630/index.html">Another Brainfuck interpreter</a></li>
<li><a href="../321632/index.html">OpenPapyrus: [yet another] ERP-system open source</a></li>
<li><a href="../321634/index.html">PROTEQ - multigigabit exchange protocol for Xilinx FPGA</a></li>
<li><a href="../321638/index.html">Continuous Integration UWP Applications in Visual Studio Team Services</a></li>
<li><a href="../321640/index.html">Facebook Audience Network - a new word in the monetization of sites and applications</a></li>
<li><a href="../321644/index.html">Using expressions to filter data from a database</a></li>
<li><a href="../321646/index.html">Automatic 3CX configuration using the setupconfig.xml answer file</a></li>
<li><a href="../321648/index.html">J-bird</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>