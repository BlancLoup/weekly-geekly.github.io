<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CS Source briefly on the creation of the All in One</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 

 I decided to share, with you, my little experience creating a cheat for Counter-Strike Source v34. This application was written solely fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CS Source briefly on the creation of the All in One</h1><div class="post__text post__text-html js-mediator-article">  Good day. <br><br>  I decided to share, with you, my little experience creating a cheat for Counter-Strike Source v34.  This application was written solely for the sake of sporting interest (it serves only for familiarization), because during his youth (he pretty much killed the time behind this game :() always wondered how these programs were organized, although he theoretically knew how they work. And half a decade later (in 2010), after playing with colleagues on the eve of one of the holidays, I again remembered my long-standing * interest * ... <br><br>  I think with preludes it is worth finishing, it‚Äôs boring, let's move on to practice. <br>  There will be a lot of code. <br>  I will not post full sources, I will only give abstract pieces of code, but these are working fragments. <br>  To unleash, I‚Äôll say that this feature has a function that allows you to shoot at any place and kill opponents who can be anywhere, the main thing is to have a backache (you can run and kill everyone behind you), I called it AssShot - for real cheaters, not accustomed to hiding (as demonstrated in the video).  VAC does not detect it, but this is until someone puts it in free access. <br><a name="habracut"></a><br>  The video was recorded with a low FPS, I apologize for Kamthasia, and the module does not cause any friezes. <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/al7Xrjz3JXM%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhik6IbJb2Ivqn1yp6_KkOdeuP1Ycg" frameborder="0" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And so, for the beginning we need: <br>  <a href="http://msdn.microsoft.com/en-us/directx/aa937788">Microsoft DirectX</a> - menus, esp, name, chels, crosshire to draw. <br>  <a href="http://research.microsoft.com/en-us/projects/detours/">Microsoft Detours</a> - as you might guess for the substitution of calls, <a href="http://habrahabr.ru/search/%3Fq%3Ddetours">how to assemble and work with this lib is on the habr</a> , I will not dwell on this. <br>  <a href="https://developer.valvesoftware.com/wiki/SDK_Installation:ru">Source SDK</a> - The CSS SDK will ease the process. <br><br>  Let's get started  Create a new project from the <a href="https://developer.valvesoftware.com/wiki/Installing_and_Debugging_the_Source_Code:ru">Source SDK</a> .  We remove all the trash in it - all * .cpp, we do not need them. <br>  And so at the entry point we create our own turn, in which we start an infinite loop (for hotkeys) and substitute DX calls: <br><br><h5>  DllMain.cpp </h5><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">DWORD </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MainThread</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( LPVOID lpArgs )</span></span></span><span class="hljs-function"> </span></span>{ HMODULE hClient = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( ; hClient == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ; Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>) ) hClient = GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"client.dll"</span></span>); CreateInterfaceFn IGCCreateInterface = (CreateInterfaceFn)GetProcAddress(GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"gameui.dll"</span></span>), <span class="hljs-string"><span class="hljs-string">"CreateInterface"</span></span>); IGameConsole *m_pIGameConsole = (IGameConsole *)IGCCreateInterface(GAMECONSOLE_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_pIGameConsole-&gt;IsConsoleShown() == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) m_pIGameConsole-&gt;Show(); ConMsg(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"workeDDD!!!\n"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//=========================================================================== //=========================================================================== SetupVariables(); DWORD* VTable; DWORD D3D9ModuleBase; do { D3D9ModuleBase = (DWORD)GetModuleHandle(_T("d3d9.dll")); Sleep(100); } while(!D3D9ModuleBase); DWORD DevicePTR = FindPattern(D3D9ModuleBase,0x128000,(PBYTE)"\xC7\x06\x00\x00\x00\x00\x89\x86\x00\x00\x00\x00\x89\x86","xx????xx????xx"); memcpy(&amp;VTable,(void*)(DevicePTR+2),4); VoidCSS.res = GetGameResources( ); if (VoidCSS.res != NULL) { const char *p0 = VoidCSS.res-&gt;GetPlayerName(3); const char *p1 = VoidCSS.res-&gt;GetPlayerName(4); const char *p2 = VoidCSS.res-&gt;GetPlayerName(5); } pDrawIndexedPrimitive = (DrawIndexedPrimitive_)DetourFunction((PBYTE)VTable[82],(PBYTE)nDrawIndexedPrimitive); cPresent = (iPresent) DetourFunction((PBYTE)VTable[17], (PBYTE)fPresent); cEndScene = (iEndScene) DetourFunction((PBYTE)VTable[42], (PBYTE)fEndScene); for (;;Sleep (500)) { if (GetAsyncKeyState (VK_F12) != 0) { Beep (2000,200); VoidCSS.s_wallhack = !VoidCSS.s_wallhack; } if (GetAsyncKeyState (VK_INSERT)!= 0) { Beep (3000,200); VoidCSS.s_espbox = !VoidCSS.s_espbox; } if (GetAsyncKeyState (VK_DELETE)!= 0) { Beep (4000,200); VoidCSS.s_aimbot = !VoidCSS.s_aimbot; } } return 1; } BOOL WINAPI DllMain( HINSTANCE hinstDLL, DWORD dwReason, LPVOID lpReserved ) { if( dwReason == 1 ) { DLLModule = hinstDLL; DWORD dwThreadID; CreateThread( NULL, NULL, (LPTHREAD_START_ROUTINE)MainThread, NULL, NULL, &amp;dwThreadID); } return TRUE; }</span></span></code> </pre> <br><br>  And here is the dirtiest function, it replaces the CSS calls: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetupVariables</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ HMODULE hModuleClient = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; HMODULE hModuleEngine = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; HMODULE hModuleVGUIFactory = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; HMODULE hMaterialSysFactory = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!hModuleClient) { hModuleClient = GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"client.dll"</span></span>); hModuleEngine = GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"engine.dll"</span></span>); hModuleVGUIFactory = GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"vguimatsurface.dll"</span></span>); hMaterialSysFactory = GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"materialsystem.dll"</span></span>); Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>); } VoidCSS.ClientFactory = (CreateInterfaceFn)GetProcAddress(hModuleClient, <span class="hljs-string"><span class="hljs-string">"CreateInterface"</span></span>); VoidCSS.EngineFactory = (CreateInterfaceFn)GetProcAddress(hModuleEngine, <span class="hljs-string"><span class="hljs-string">"CreateInterface"</span></span>); VoidCSS.VGUIFactory = (CreateInterfaceFn)GetProcAddress(hModuleVGUIFactory, <span class="hljs-string"><span class="hljs-string">"CreateInterface"</span></span>); VoidCSS.MaterialSys = (CreateInterfaceFn)GetProcAddress(hMaterialSysFactory, <span class="hljs-string"><span class="hljs-string">"CreateInterface"</span></span>); VoidCSS.g_pdwEngine = (DWORD*) VoidCSS.EngineFactory( VENGINE_CLIENT_INTERFACE_VERSION , <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pdwClient = (DWORD*) VoidCSS.ClientFactory( CLIENT_DLL_INTERFACE_VERSION , <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pdwModelRender = (DWORD*) VoidCSS.EngineFactory( VENGINE_HUDMODEL_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pEntList = (IClientEntityList*) VoidCSS.ClientFactory( VCLIENTENTITYLIST_INTERFACE_VERSION , <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pEngClient = (IVEngineClient*) VoidCSS.EngineFactory(<span class="hljs-string"><span class="hljs-string">"VEngineClient012"</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); VoidCSS.g_pSurface = (vgui::ISurface *) VoidCSS.VGUIFactory ( <span class="hljs-string"><span class="hljs-string">"VGUI_Surface028"</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pMatSystemSurface = ( IMatSystemSurface* )VoidCSS.g_pSurface-&gt;QueryInterface( <span class="hljs-string"><span class="hljs-string">"MatSystemSurface005"</span></span> ); VoidCSS.g_pDraw = (IMatSystemSurface*) VoidCSS.g_pSurface-&gt;QueryInterface(MAT_SYSTEM_SURFACE_INTERFACE_VERSION); VoidCSS.g_pEffects = (IVEfx*) VoidCSS.EngineFactory( VENGINE_EFFECTS_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pCvar = (ICvar*) VoidCSS.EngineFactory( VENGINE_CVAR_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pEnginetrace = (IEngineTrace*) VoidCSS.EngineFactory( INTERFACEVERSION_ENGINETRACE_CLIENT, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pDebugoverlay = (IVDebugOverlay*) VoidCSS.EngineFactory( VDEBUG_OVERLAY_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pEngineCache = (IVEngineCache*) VoidCSS.EngineFactory( VENGINE_CACHE_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pModelinfo = (IVModelInfoClient*) VoidCSS.EngineFactory( VMODELINFO_CLIENT_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pEnginevgui = (IEngineVGui*) VoidCSS.EngineFactory( VENGINE_VGUI_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pModelRender = (IVModelRender*) VoidCSS.EngineFactory( VENGINE_HUDMODEL_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pRender = (IVRenderView*) VoidCSS.EngineFactory( VENGINE_RENDERVIEW_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); VoidCSS.g_pMaterialSystem = (IMaterialSystem *) VoidCSS.MaterialSys( MATERIAL_SYSTEM_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); VoidCSS.g_pBaseCDll = (IBaseClientDLL*) VoidCSS.ClientFactory(CLIENT_DLL_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); VoidCSS.g_pMRender = (IVModelRender*) VoidCSS.EngineFactory(VENGINE_HUDMODEL_INTERFACE_VERSION, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); VoidCSS.g_pdwBaseCDll = (PDWORD*)VoidCSS.g_pBaseCDll; VoidCSS.g_pdwMRender = (PDWORD*)VoidCSS.g_pMRender; DWORD dwOld; <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>( (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>*) &amp;VoidCSS.g_oldClient,(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>*)*VoidCSS.g_pdwBaseCDll , <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(CClient) ); VoidCSS.gClientFuncs2 = (CClient*)*VoidCSS.g_pdwBaseCDll; VirtualProtect( (LPVOID)&amp;((CClient*)*VoidCSS.g_pdwBaseCDll)-&gt;Init, <span class="hljs-number"><span class="hljs-number">4</span></span>, PAGE_EXECUTE_READWRITE, &amp;dwOld ); VoidCSS.gClientFuncs2-&gt;Init = &amp;new_Init; VirtualProtect( (LPVOID)&amp;((CClient*)*VoidCSS.g_pdwBaseCDll)-&gt;CreateMove, <span class="hljs-number"><span class="hljs-number">4</span></span>, PAGE_EXECUTE_READWRITE, &amp;dwOld ); VoidCSS.gClientFuncs2-&gt;CreateMove = &amp;new_CreateMove; VirtualProtect( (LPVOID)&amp;((CClient*)*VoidCSS.g_pdwBaseCDll)-&gt;HudUpdate, <span class="hljs-number"><span class="hljs-number">4</span></span>, PAGE_EXECUTE_READWRITE, &amp;dwOld ); VoidCSS.gClientFuncs2-&gt;HudUpdate = &amp;new_HudUpdate; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoidCSS.g_pInput == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) { PDWORD pdwAddress = ( PDWORD ) ((( DWORD ) VoidCSS.g_oldClient.CreateMove ) + <span class="hljs-number"><span class="hljs-number">0x20</span></span> ); PDWORD pdwTable = ( PDWORD ) *pdwAddress; VoidCSS.g_pInput = ( CInput* ) *pdwTable; } VoidCSS.g_pGlobals = ( CGlobalVarsBase* )<span class="hljs-number"><span class="hljs-number">0x200D01A4</span></span>; }</code> </pre><br><br>  As you remember, we redefined the <b>iEndScene</b> call, which we will use for drawing the menu, esp, wallHack and Anti flash / smoke / fog: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">HRESULT WINAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fEndScene</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( LPDIRECT3DDEVICE9 nDevice )</span></span></span><span class="hljs-function"> </span></span>{ _asm pushad <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VoidCSS.s_espbox) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (VoidCSS.pLine == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) D3DXCreateLine(nDevice, &amp;VoidCSS.pLine); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { VoidCSS.g_pEsp-&gt;DrawEsp(); VoidCSS.g_pEsp-&gt;DrawMap(); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Red == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { GenerateTexture(nDevice, &amp;Red, D3DCOLOR_ARGB (<span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> )); GenerateTexture(nDevice, &amp;Yellow, D3DCOLOR_ARGB (<span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> )); GenerateTexture(nDevice, &amp;Green, D3DCOLOR_ARGB (<span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> )); GenerateTexture(nDevice, &amp;Blue, D3DCOLOR_ARGB (<span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">255</span></span> )); GenerateTexture(nDevice, &amp;Purple, D3DCOLOR_ARGB (<span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">102</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">153</span></span> )); GenerateTexture(nDevice, &amp;Pink, D3DCOLOR_ARGB (<span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">20</span></span> , <span class="hljs-number"><span class="hljs-number">147</span></span> )); GenerateTexture(nDevice, &amp;Orange, D3DCOLOR_ARGB (<span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">255</span></span> , <span class="hljs-number"><span class="hljs-number">165</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> )); } D3DVIEWPORT9 viewP; nDevice-&gt;GetViewport( &amp;viewP ); DWORD ScreenCenterX = viewP.Width / <span class="hljs-number"><span class="hljs-number">2</span></span>; DWORD ScreenCenterY = viewP.Height / <span class="hljs-number"><span class="hljs-number">2</span></span>; D3DRECT rec16 = {ScreenCenterX<span class="hljs-number"><span class="hljs-number">-20</span></span>, ScreenCenterY, ScreenCenterX+ <span class="hljs-number"><span class="hljs-number">20</span></span>, ScreenCenterY+<span class="hljs-number"><span class="hljs-number">1</span></span>}; D3DRECT rec17 = {ScreenCenterX, ScreenCenterY<span class="hljs-number"><span class="hljs-number">-20</span></span>, ScreenCenterX+ <span class="hljs-number"><span class="hljs-number">1</span></span>,ScreenCenterY+<span class="hljs-number"><span class="hljs-number">20</span></span>}; nDevice-&gt;Clear( <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;rec16, D3DCLEAR_TARGET, D3DXCOLOR(<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> );<span class="hljs-comment"><span class="hljs-comment">//white nDevice-&gt;Clear( 1, &amp;rec17, D3DCLEAR_TARGET, D3DXCOLOR(1.0, 1.0, 1.0, 1.0), 0, 0 ); if(menu_setup == false) { g_pCMenu = new CDXMenu( nDevice, 10, 160 ); g_pCMenu-&gt;addHackBool( "WallHack", &amp;VoidCSS.s_wallhack ); g_pCMenu-&gt;addHackBool( "Aimbot", &amp;VoidCSS.s_aimbot ); g_pCMenu-&gt;addHackInt( "AimBotFOV", &amp;VoidCSS.s_aimfov ); g_pCMenu-&gt;addHackBool( "AssShot", &amp;VoidCSS.s_assshot ); g_pCMenu-&gt;addHackBool( "ESPBox", &amp;VoidCSS.s_espbox ); menu_setup = true; } if(GetAsyncKeyState( VK_END ) &amp;1) { VoidCSS.s_ShowMenu = !VoidCSS.s_ShowMenu; } g_pCMenu-&gt;showMenu( VoidCSS.s_ShowMenu ); g_pCMenu-&gt;updateMenu(); } catch(...){} _asm popad return cEndScene ( nDevice ); }</span></span></code> </pre><br><br>  For wallHack and Anti to / se, we need to receive materials: <br><br><pre> <code class="cpp hljs"> IMaterial* TTeam1 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\t_arctic\\t_arctic"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* TTeam2 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\t_guerilla\\t_guerilla"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* TTeam3 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\t_leet\\t_leet"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* TTeam4 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\t_phoenix\\t_phoenix"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* CTeam1 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\ct_gign\\ct_gign"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* CTeam2 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\ct_gsg9\\ct_gsg9"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* CTeam3 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\ct_sas\\ct_sas"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* CTeam4 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial(<span class="hljs-string"><span class="hljs-string">"models\\player\\ct_urban\\ct_urban"</span></span>, <span class="hljs-string"><span class="hljs-string">"Model textures"</span></span>); IMaterial* SmokeStack = VoidCSS.g_pMaterialSystem-&gt;FindMaterial( <span class="hljs-string"><span class="hljs-string">"SmokeStack"</span></span>, <span class="hljs-string"><span class="hljs-string">"ClientEffect textures"</span></span> ); IMaterial* FlashEffect = VoidCSS.g_pMaterialSystem-&gt;FindMaterial( <span class="hljs-string"><span class="hljs-string">"effects/flashbang"</span></span>, <span class="hljs-string"><span class="hljs-string">"ClientEffect textures"</span></span> ); IMaterial* FlashOverlay = VoidCSS.g_pMaterialSystem-&gt;FindMaterial( <span class="hljs-string"><span class="hljs-string">"effects/flashbang_white"</span></span>, <span class="hljs-string"><span class="hljs-string">"ClientEffect textures"</span></span> ); IMaterial* SmokeParticle = VoidCSS.g_pMaterialSystem-&gt;FindMaterial( <span class="hljs-string"><span class="hljs-string">"particle/particle_smokegrenade"</span></span>, <span class="hljs-string"><span class="hljs-string">"ClientEffect textures"</span></span> ); IMaterial* SmokeParticle1 = VoidCSS.g_pMaterialSystem-&gt;FindMaterial( <span class="hljs-string"><span class="hljs-string">"particle/particle_smokegrenade1"</span></span>, <span class="hljs-string"><span class="hljs-string">"ClientEffect textures"</span></span> ); IMaterial* ScreenSpaceFog = VoidCSS.g_pMaterialSystem-&gt;FindMaterial( <span class="hljs-string"><span class="hljs-string">"particle/screenspace_fog"</span></span>, <span class="hljs-string"><span class="hljs-string">"ClientEffect textures"</span></span> );</code> </pre><br><br>  And we say draw / ignore them or not: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(VoidCSS.s_wallhack) { TTeam1-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); TTeam2-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); CTeam1-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); CTeam2-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); TTeam3-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); TTeam4-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); CTeam3-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); CTeam4-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); FlashEffect-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); FlashOverlay-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); SmokeStack-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); SmokeParticle-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); SmokeParticle1-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); ScreenSpaceFog-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">true</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { TTeam1-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); TTeam2-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); CTeam1-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); CTeam2-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); TTeam3-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); TTeam4-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); CTeam3-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); CTeam4-&gt;SetMaterialVarFlag( MATERIAL_VAR_IGNOREZ, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); FlashEffect-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); FlashOverlay-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); SmokeStack-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); SmokeParticle-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); SmokeParticle1-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); ScreenSpaceFog-&gt;SetMaterialVarFlag( MATERIAL_VAR_NO_DRAW, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); }</code> </pre><br><br>  <b>We'll</b> use the override function <b>new_CreateMove</b> for aimBot and, completely forgot, bunnyHop: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> __<span class="hljs-function"><span class="hljs-function">stdcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_CreateMove</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sequence_number, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> input_sample_frametime, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> active )</span></span></span><span class="hljs-function"> </span></span>{ VoidCSS.g_oldClient.CreateMove( sequence_number , input_sample_frametime , active ); ModelHack(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoidCSS.g_pInput ) { CUserCmd* cmd = VoidCSS.g_pInput-&gt;GetUserCmd( sequence_number ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoidCSS.g_pEngClient-&gt;IsInGame() ) { <span class="hljs-comment"><span class="hljs-comment">//Aimbot Norecoil Nospread if( cmd-&gt;buttons &amp; IN_ATTACK &amp;&amp; VoidCSS.s_aimbot) VoidCSS.g_pAimbot-&gt;AimAtTarget( cmd ); //BunnyHop if ( cmd-&gt;buttons &amp; IN_JUMP ) { int *iMyFlAgs = (int*) ( (DWORD)VoidCSS.g_pMyPlayer-&gt;BaseEnt() + (DWORD)0x2B4 ); int iFlags = *iMyFlAgs; if( !(iFlags &amp;FL_ONGROUND) ) cmd-&gt;buttons &amp;= ~IN_JUMP; } } } }</span></span></code> </pre><br><br>  In the aimbot class, we track the victim (making sure that he is the player of the opposing team), going through the bones, find the desired part of the body (in our case, the head) and move the center of the screen to this point, shoot, retarding the recoil (antiRecoil).  Yes, I forgot to say that if assShot is turned on, then we will return our character to the position before the shooting (and so it works). <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> cCAimbot::AimAtTarget( CUserCmd* c ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( VoidCSS.g_pEngClient-&gt;IsInGame() == <span class="hljs-literal"><span class="hljs-literal">false</span></span> || VoidCSS.g_pEngClient-&gt;IsHLTV() == <span class="hljs-literal"><span class="hljs-literal">true</span></span> || VoidCSS.g_pMyPlayer-&gt;BaseEnt() == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; DropTarget(); <span class="hljs-comment"><span class="hljs-comment">//----------------------------------// player_info_t pinfo; QAngle* pPunchAngle = ( QAngle* )( (DWORD)VoidCSS.g_pMyPlayer-&gt;BaseEnt() + 0xBB0 ); //----------------------------------// //----------------------------------// for( int index = 1; index &lt;= VoidCSS.g_pEntList-&gt;NumberOfEntities( false ); ++index ) { if ( index == VoidCSS.g_pEngClient-&gt;GetLocalPlayer() ) continue; IClientEntity* ClientEntity = VoidCSS.g_pEntList-&gt;GetClientEntity( index ); if ( ClientEntity == NULL || ClientEntity-&gt;IsDormant() ) continue; CBaseEntity* pBaseEntity = ClientEntity-&gt;GetBaseEntity(); //Get Life State int *lifestate = (int*) ( ( DWORD )pBaseEntity + ( DWORD )0x87 ); float fov = (float)VoidCSS.s_aimfov; if (VoidCSS.s_assshot) fov = 360.0f; if( pBaseEntity == NULL/* nothing */ || pBaseEntity-&gt;IsDormant()/* not active */ || !(*lifestate == LIFE_ALIVE)/* not alive */ || VoidCSS.g_pEngClient-&gt;GetPlayerInfo( index, &amp;pinfo ) == false/* not a player!*/ || pBaseEntity-&gt;GetTeamNumber() == VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;GetTeamNumber()/*enemy*/ || !GetBonePosition( 14/*Head*/, vPlayer, c-&gt;viewangles, index ) || GetFov( VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;GetAbsAngles(), VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;EyePosition(), vPlayer ) &gt; fov /*4.0f*/ || !GetVisible( VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;EyePosition(), vPlayer, pBaseEntity )/* not visible */ || flBestDist &lt; GetFov( VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;GetAbsAngles(), VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;EyePosition(), vPlayer )) continue; flBestDist = GetFov( VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;GetAbsAngles(), VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;EyePosition(), vPlayer ); m_nTarget = index; // Calculate the delta origin Vector vDeltaOrigin = vPlayer - vPlayer; // Calculate the Latency float fLatency = VoidCSS.g_pEngClient-&gt;GetNetChannelInfo()-&gt;GetLatency( FLOW_OUTGOING ); // Compensate the latency vDeltaOrigin[0] *= fLatency; vDeltaOrigin[1] *= fLatency; vDeltaOrigin[2] *= fLatency; //Apply the prediction PredictedTargetPosition = vPlayer + vDeltaOrigin; } if( m_nTarget == -1 ) return; CalcAngle( VoidCSS.g_pMyPlayer-&gt;BaseEnt()-&gt;EyePosition(), PredictedTargetPosition, c-&gt;viewangles ); //recoil c-&gt;viewangles.x -= ( pPunchAngle-&gt;x *2.0f ); c-&gt;viewangles.y -= ( pPunchAngle-&gt;y *2.0f ); //aimbot VoidCSS.g_pEngClient-&gt;SetViewAngles( c-&gt;viewangles );//aim //nospread float flNew[3],flOld[3]; flOld[0] = c-&gt;viewangles[0]; flOld[1] = c-&gt;viewangles[1]; flOld[2] = c-&gt;viewangles[2]; //VoidCSS.g_pNoSpread-&gt;GetSpreadFix( c-&gt;random_seed, flOld, flNew ); c-&gt;viewangles[0] += flNew[0]; c-&gt;viewangles[1] += flNew[1]; c-&gt;viewangles[2] += flNew[2]; if (VoidCSS.s_assshot) VoidCSS.g_pEngClient-&gt;SetViewAngles( m_angle ); DropTarget(); }</span></span></code> </pre><br><br>  That's basically the most important parts of the code.  Of course, there is a small bunch of auxiliary functions, as well as classes for drawing menus, reading the settings file (I have setings.ini), and drawing esp, but in them it seems that everything is clear.  I didn‚Äôt have enough enthusiasm for SpeedHack, but I‚Äôll give you a hint - you have to play around with the timings (although it is fraught with hanging on a bad ping). <br><br>  And so we proceed to the injection of our assembly into the game process, 2 variants of c ++ on the window handle or c # on the process <br><br><h4>  s ++ </h4><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"stdafx.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;windows.h&gt; #define MAXINJECTSIZE 4096 typedef HINSTANCE (*LoadLibrary_Ptr)(LPCTSTR); typedef FARPROC (*GetProcAddress_Ptr)(HMODULE, LPCSTR lpProcName); typedef struct _injectionRoutineParam { LoadLibrary_Ptr _call_LoadLibrary; GetProcAddress_Ptr _call_GetProcAddress; HINSTANCE _ret; FARPROC _proc; char _dll_name[1024]; char _proc_name[256]; }InjectionRoutineParam; DWORD __stdcall injectionThreadRoutine(InjectionRoutineParam* param) { HINSTANCE hinstance = param-&gt;_call_LoadLibrary((LPCTSTR)param-&gt;_dll_name); param-&gt;_ret = hinstance; FARPROC proc= param-&gt;_call_GetProcAddress(hinstance, param-&gt;_proc_name); param-&gt;_proc = proc; return 0; } void inject(HANDLE process, char *dllName) { char * procName ="HelloWorld"; InjectionRoutineParam param; DWORD threadId; void *p = VirtualAllocEx(process, 0, MAXINJECTSIZE, MEM_COMMIT, PAGE_EXECUTE_READWRITE ); void *data = VirtualAllocEx(process, 0, sizeof(InjectionRoutineParam), MEM_COMMIT, PAGE_EXECUTE_READWRITE ); HINSTANCE kernel32=LoadLibrary(_T("KERNEL32.DLL")); param._call_LoadLibrary = (LoadLibrary_Ptr)GetProcAddress( kernel32, "LoadLibraryA" ); param._call_GetProcAddress = (GetProcAddress_Ptr)GetProcAddress( kernel32, "GetProcAddress" ); memcpy(param._dll_name,dllName,strlen(dllName)); memcpy(param._proc_name, procName, strlen(procName)); WriteProcessMemory(process, p, (void*)&amp;injectionThreadRoutine, MAXINJECTSIZE, 0 ); WriteProcessMemory(process, data, (void*)¬∂m, sizeof(InjectionRoutineParam), 0 ); HANDLE remoteThread = CreateRemoteThread(process, NULL,0,(DWORD (__stdcall *)(LPVOID))p, data, 0, &amp;threadId); WaitForSingleObject(remoteThread, INFINITE); DWORD read; ReadProcessMemory(process, data, ¬∂m, sizeof(InjectionRoutineParam), &amp;read); VirtualFreeEx(process, p, 0, MEM_RELEASE ); VirtualFreeEx(process, data, 0, MEM_RELEASE ); FreeLibrary( kernel32 ); } void die(char *msg) { fprintf(stderr, msg); exit(-1); } #include &lt;string&gt; #include &lt;windows.h&gt; #define MAXWAIT 10000 bool insertDll(DWORD procID, std::string dll) { //  LoadLibraryA,    ,         HMODULE hLocKernel32 = GetModuleHandle(_T("Kernel32")); FARPROC hLocLoadLibrary = GetProcAddress(hLocKernel32, "LoadLibraryA"); //     HANDLE hToken; TOKEN_PRIVILEGES tkp; if(OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken)) { LookupPrivilegeValue(NULL, SE_DEBUG_NAME, &amp;tkp.Privileges[0].Luid); tkp.PrivilegeCount = 1; tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED; AdjustTokenPrivileges(hToken, 0, &amp;tkp, sizeof(tkp), NULL, NULL); } //     HANDLE hProc = OpenProcess(PROCESS_ALL_ACCESS, FALSE, procID); //      Dll     dll += '\0'; LPVOID hRemoteMem = VirtualAllocEx(hProc, NULL, dll.size(), MEM_COMMIT, PAGE_READWRITE); // DWORD numBytesWritten; WriteProcessMemory(hProc, hRemoteMem, dll.c_str(), dll.size(), &amp;numBytesWritten); //   HANDLE hRemoteThread = CreateRemoteThread(hProc, NULL, 0, (LPTHREAD_START_ROUTINE)hLocLoadLibrary, hRemoteMem, 0, NULL); // cout &lt;&lt; hRemoteThread &lt;&lt; endl; //,    bool res = false; if (hRemoteThread) res = (bool)WaitForSingleObject(hRemoteThread, MAXWAIT) != WAIT_TIMEOUT; //   VirtualFreeEx(hProc, hRemoteMem, dll.size(), MEM_RELEASE); //   :) CloseHandle(hProc); return res; } int _tmain(int argc, _TCHAR* argv[]) { HWND WindowHandle; DWORD processId; WindowHandle = FindWindow(NULL, _T("Counter-Strike Source")); if (WindowHandle) { GetWindowThreadProcessId(WindowHandle, &amp;processId); insertDll(processId, "..\\..\\client.dll"); } system("PAUSE"); return EXIT_SUCCESS; }</span></span></span></span></code> </pre><br><br><h4>  with# </h4><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Diagnostics; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Runtime.InteropServices; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">voidLoader</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Inject</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WINAPI</span></span> { [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenProcess</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> UInt32 dwDesiredAccess, Int32 bInheritHandle, UInt32 dwProcessId</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> Int32 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CloseHandle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IntPtr hObject</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetProcAddress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IntPtr hModule, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lpProcName</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetModuleHandle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lpModuleName</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VirtualAllocEx</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IntPtr hProcess, IntPtr lpAddress, IntPtr dwSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> flAllocationType, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> flProtect</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> Int32 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteProcessMemory</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IntPtr hProcess, IntPtr lpBaseAddress, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] buffer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IntPtr lpNumberOfBytesWritten</span></span></span><span class="hljs-function">)</span></span>; [DllImport(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>, SetLastError = <span class="hljs-literal"><span class="hljs-literal">true</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateRemoteThread</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IntPtr hProcess, IntPtr lpThreadAttribute, IntPtr dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dwCreationFlags, IntPtr lpThreadId</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">VAE_Enums</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> AllocationType { MEM_COMMIT = <span class="hljs-number"><span class="hljs-number">0x1000</span></span>, MEM_RESERVE = <span class="hljs-number"><span class="hljs-number">0x2000</span></span>, MEM_RESET = <span class="hljs-number"><span class="hljs-number">0x80000</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> ProtectionConstants { PAGE_EXECUTE = <span class="hljs-number"><span class="hljs-number">0X10</span></span>, PAGE_EXECUTE_READ = <span class="hljs-number"><span class="hljs-number">0X20</span></span>, PAGE_EXECUTE_READWRITE = <span class="hljs-number"><span class="hljs-number">0X40</span></span>, PAGE_EXECUTE_WRITECOPY = <span class="hljs-number"><span class="hljs-number">0X80</span></span>, PAGE_NOACCESS = <span class="hljs-number"><span class="hljs-number">0X01</span></span> } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DoInject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Process pToBeInjected, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sDllPath, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sError</span></span></span><span class="hljs-function">)</span></span> { IntPtr hwnd = IntPtr.Zero; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!CRT(pToBeInjected, sDllPath, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> sError, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> hwnd)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hwnd != (IntPtr)<span class="hljs-number"><span class="hljs-number">0</span></span>) WINAPI.CloseHandle(hwnd); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> wee = Marshal.GetLastWin32Error(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CRT</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Process pToBeInjected, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sDllPath, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sError, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> IntPtr hwnd</span></span></span><span class="hljs-function">)</span></span> { sError = String.Empty; IntPtr hndProc = WINAPI.OpenProcess( (<span class="hljs-number"><span class="hljs-number">0x2</span></span> | <span class="hljs-number"><span class="hljs-number">0x8</span></span> | <span class="hljs-number"><span class="hljs-number">0x10</span></span> | <span class="hljs-number"><span class="hljs-number">0x20</span></span> | <span class="hljs-number"><span class="hljs-number">0x400</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)pToBeInjected.Id); hwnd = hndProc; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hndProc == (IntPtr)<span class="hljs-number"><span class="hljs-number">0</span></span>) { sError = <span class="hljs-string"><span class="hljs-string">"Unable to attatch to process.\n"</span></span>; sError += <span class="hljs-string"><span class="hljs-string">"Error code: "</span></span> + Marshal.GetLastWin32Error(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } IntPtr lpLLAddress = WINAPI.GetProcAddress( WINAPI.GetModuleHandle(<span class="hljs-string"><span class="hljs-string">"kernel32.dll"</span></span>), <span class="hljs-string"><span class="hljs-string">"LoadLibraryA"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lpLLAddress == (IntPtr)<span class="hljs-number"><span class="hljs-number">0</span></span>) { sError = <span class="hljs-string"><span class="hljs-string">"Unable to find address of \"LoadLibraryA\".\n"</span></span>; sError += <span class="hljs-string"><span class="hljs-string">"Error code: "</span></span> + Marshal.GetLastWin32Error(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } IntPtr lpAddress = WINAPI.VirtualAllocEx( hndProc, (IntPtr)<span class="hljs-literal"><span class="hljs-literal">null</span></span>, (IntPtr)sDllPath.Length, (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)WINAPI.VAE_Enums.AllocationType.MEM_COMMIT | (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)WINAPI.VAE_Enums.AllocationType.MEM_RESERVE, (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)WINAPI.VAE_Enums.ProtectionConstants.PAGE_EXECUTE_READWRITE); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lpAddress == (IntPtr)<span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lpAddress == (IntPtr)<span class="hljs-number"><span class="hljs-number">0</span></span>) { sError = <span class="hljs-string"><span class="hljs-string">"Unable to allocate memory to target process.\n"</span></span>; sError += <span class="hljs-string"><span class="hljs-string">"Error code: "</span></span> + Marshal.GetLastWin32Error(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes = CalcBytes(sDllPath); IntPtr ipTmp = IntPtr.Zero; WINAPI.WriteProcessMemory( hndProc, lpAddress, bytes, (<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>)bytes.Length, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> ipTmp); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Marshal.GetLastWin32Error() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { sError = <span class="hljs-string"><span class="hljs-string">"Unable to write memory to process."</span></span>; sError += <span class="hljs-string"><span class="hljs-string">"Error code: "</span></span> + Marshal.GetLastWin32Error(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } IntPtr ipThread = WINAPI.CreateRemoteThread( hndProc, (IntPtr)<span class="hljs-literal"><span class="hljs-literal">null</span></span>, (IntPtr)<span class="hljs-number"><span class="hljs-number">0</span></span>, lpLLAddress, lpAddress, <span class="hljs-number"><span class="hljs-number">0</span></span>, (IntPtr)<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ipThread == (IntPtr)<span class="hljs-number"><span class="hljs-number">0</span></span>) { sError = <span class="hljs-string"><span class="hljs-string">"Unable to load dll into memory."</span></span>; sError += <span class="hljs-string"><span class="hljs-string">"Error code: "</span></span> + Marshal.GetLastWin32Error(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CalcBytes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sToConvert</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bRet = System.Text.Encoding.ASCII.GetBytes(sToConvert); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bRet; } } }</code> </pre><br><br>  <a href="https://github.com/v01d123/VoidCSS">Well, actually the files themselves.</a>  (reloads on github) </div><p>Source: <a href="https://habr.com/ru/post/143178/">https://habr.com/ru/post/143178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143172/index.html">Saga: check the code coverage tests</a></li>
<li><a href="../143173/index.html">Programming, as we know it, is coming to an end.</a></li>
<li><a href="../143175/index.html">Top 10 pitfalls that you may stumble upon while moving to Vim</a></li>
<li><a href="../143176/index.html">Dawn Haiku OS</a></li>
<li><a href="../143177/index.html">Switch from Google Maps to OpenStreetMap</a></li>
<li><a href="../143179/index.html">How to improve site performance or 5 reasons to start using Google Analytics</a></li>
<li><a href="../143180/index.html">Monetizing Google Play: free games with access to operator billing</a></li>
<li><a href="../143181/index.html">New look at CodePlex</a></li>
<li><a href="../143184/index.html">Shutdown Day 2012</a></li>
<li><a href="../143185/index.html">Apple rejects any applications that use Dropbox</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>