<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dagaz: Kicks to common sense (part 1)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An important part of working on a universal gaming system is the systematization of the rules. For thousands of years of its development, mankind has ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dagaz: Kicks to common sense (part 1)</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/43e/794/3a3/43e7943a3e289a281570ab8b68d347b8.png" alt="image">  An important part of working on a universal gaming system is the systematization of the rules.  For thousands of years of its development, mankind has come up with an incredible number of board games.  Their rules, for the most part, are similar, but some may put the developer at a standstill.  These rules are as important as the rest.  The <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BD_%25D0%259F%25D0%25B0%25D1%2580%25D0%25B5%25D1%2582%25D0%25BE">Pareto principle</a> does not work here - either we implement the game completely, 100%, or ... <br>  it will be a completely different game.  In the process of working on the Dagaz project, I decided to make my own rating of the rules that are most unexpected or inconvenient for the developer.  Meet ... <br><a name="habracut"></a><br><h4>  <b>10. Strange moves</b> </h4><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D1%2585%25D0%25BC%25D0%25B0%25D1%2582%25D1%258B">Chess</a> is, perhaps, the first game, about which we recall speaking of board games, but they did not immediately find the features familiar to us.  In <a href="http://skyruk.livejournal.com/292733.html">Shatranj</a> , their immediate predecessor, the queen was a very weak figure!  He walked just one field, on any of the diagonals.  The elephant was also not long-range, but was able to jump over the figures.  The pawn, having reached the last rank, turned only into a queen (and not into any piece to choose from, as it is now).  Rook went according to our usual rules, but it still needed to bring to the "operational space".  In general, the game was very slow, but this was offset by the presence of a huge number of <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B0%25D0%25B1%25D0%25B8%25D1%258F">tabies</a> - initial positions from which players, by agreement, could begin the game. <br><br><div class="spoiler">  <b class="spoiler_title">First kick</b> <div class="spoiler_text">  Apparently, without knowing about the tabias, the people of Ethiopia decided to overcome the slowness of Shatrange in their own way.  In their <a href="http://en.wikipedia.org/wiki/Senterej">version of</a> this game, the first moves were performed by the players independently of each other (who managed to do it).  Only after the first capture, the normal alternation of moves was established.  This blow to common sense is today out of competition, because I simply cannot imagine how to implement such a requirement in a universal gaming system.  By the way, such a game of ‚Äúspeed‚Äù is very characteristic for the inhabitants of the African continent and is found not only when playing chess. <br></div></div><br>  The horse is another figure that has remained almost unchanged since <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B0%25D1%2582%25D1%2583%25D1%2580%25D0%25B0%25D0%25BD%25D0%25B3%25D0%25B0">Chaturanga</a> .  He has forgotten how to jump figures (both his own and his opponent) into <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%258F%25D0%25BD%25D1%2586%25D0%25B8">Xiangqi</a> and <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B0%25D0%25BD%25D0%25B3%25D0%25B8">Changi</a> , and in <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2591%25D0%25B3%25D0%25B8">Shogi</a> can only move forward (which, in its own way, says a lot about the mentality of the Japanese), but this figure, as before, remains the most recognizable in all games chess family.  It was on the basis of the horse that new types of figures, such as the <a href="http://en.wikipedia.org/wiki/Capablanca_chess">Chancellor and the Archbishop,</a> were "designed" for the first time.  Subsequently, the flow of such <a href="https://ru.wikipedia.org/wiki/%25D0%25A5%25D0%25B8%25D0%25BC%25D0%25B5%25D1%2580%25D0%25B0">chimeras</a> became so intense that a special <a href="http://en.wikipedia.org/wiki/Fairy_chess_piece">classification system was</a> needed for newly invented figures, but not a horse, in my opinion, is the strangest figure. <br><br>  A pawn is the only piece in Chess, the capture of which differs from the usual move.  The ‚Äúchess‚Äù principle familiar to us (the figure that performs the taking is set to the place of the taken figure), so far remains unchanged, but the pawn moves one field forward and hits diagonally.  This is the smallest problem for the developer, the trouble starts next. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to capture the center of the board as quickly as possible, the pawns were given the right of a double move from the starting position (in some variants of chess, with larger boards, the pawn jumps even further).  Since such a jump allowed the enemy to break through the pawn line, as a result, the rule of ‚Äú <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B7%25D1%258F%25D1%2582%25D0%25B8%25D0%25B5_%25D0%25BD%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25BE%25D1%2585%25D0%25BE%25D0%25B4%25D0%25B5">taking on the aisle</a> ‚Äù appeared, and this is already a disgrace.  The chess principle is violated here.  It is not the field on which the enemy figure stands, but the field through which it has been attacked.  Moreover, such a move can be made only on the next move after the "jump" by the opponent's pawn.  Let's see how it affected the developers: <br><br><div class="spoiler">  <b class="spoiler_title">En-Passant (ZoG)</b> <div class="spoiler_text"><pre><code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> En-Passant ( $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> enemy?) (<span class="hljs-name"><span class="hljs-name">verify</span></span> last-to?) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Pawn)) capture n to n (<span class="hljs-name"><span class="hljs-name">verify</span></span> last-from?) add ) )</code> </pre> <br>  looks a little harder than usual taking: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> Pawn-capture ( $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> enemy?) (<span class="hljs-name"><span class="hljs-name">Pawn-add</span></span>) ) )</code> </pre><br></div></div><br>  Shamanism with movements is a small part of the problem.  <a href="http://www.zillions-of-games.com/">ZoG</a> developers had to introduce a new predicate <b>last-from</b> into the core <b>?</b>  that checks for the fact that the previous move (of the opponent) was performed from the current field.  Such a decision is difficult to regard otherwise than the hasty and not very successful "crutch."  It is not universal and does not work in more complex cases.  For example, in <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B5%25D1%2582%25D0%25B2%25D0%25B5%25D1%2580%25D0%25BD%25D1%258B%25D0%25B5_%25D0%25BD%25D0%25B5%25D0%25BC%25D0%25B5%25D1%2586%25D0%25BA%25D0%25B8%25D0%25B5_%25D1%2588%25D0%25B0%25D1%2585%25D0%25BC%25D0%25B0%25D1%2582%25D1%258B">four-sided chess</a> , the rule of capture on the aisle can be applied to the player sitting opposite, but the previous move is performed not by him, but by the player sitting on the side, resulting in <b>last-from?</b>  does not work!  I had to think about a more universal solution: <br><br><div class="spoiler">  <b class="spoiler_title">En-Passant (Dagaz)</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> pawn-jump (<span class="hljs-name"><span class="hljs-name">check</span></span> (<span class="hljs-name"><span class="hljs-name">not</span></span> is-moved?)) (<span class="hljs-name"><span class="hljs-name">set!</span></span> turn-jumped turn-number) (<span class="hljs-name"><span class="hljs-name">check-source</span></span> Pawn) (<span class="hljs-name"><span class="hljs-name">check</span></span> n) (<span class="hljs-name"><span class="hljs-name">check</span></span> is-empty?) (<span class="hljs-name"><span class="hljs-name">check</span></span> n) (<span class="hljs-name"><span class="hljs-name">check</span></span> is-empty?) (<span class="hljs-name"><span class="hljs-name">drop-pieces</span></span> current-pieces) add-move ) (<span class="hljs-name"><span class="hljs-name">define</span></span> (<span class="hljs-name"><span class="hljs-name">en-passant</span></span> piece-type direction) (<span class="hljs-name"><span class="hljs-name">check-source</span></span> piece-type) (<span class="hljs-name"><span class="hljs-name">check</span></span> direction) (<span class="hljs-name"><span class="hljs-name">check</span></span> is-enemy?) (<span class="hljs-name"><span class="hljs-name">check</span></span> (<span class="hljs-name"><span class="hljs-name">&lt;=</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">-</span></span> turn-number turn-jumped))) capture (<span class="hljs-name"><span class="hljs-name">check</span></span> n) (<span class="hljs-name"><span class="hljs-name">check</span></span> is-empty?) (<span class="hljs-name"><span class="hljs-name">drop-pieces</span></span> current-pieces) add-move )</code> </pre><br></div></div><br>  If you think that the strangeness of the chess we are used to are limited to ‚Äútaking on the aisle‚Äù, think again.  There is a move in Chess, during which several pieces move at once!  Yes, it is <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25BE%25D0%25BA%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0">castling</a> .  She also did not appear immediately and not from scratch.  The history of the issue can be found in this wonderful <a href="http://skyruk.livejournal.com/420321.html">article</a> .  The idea is to hide the king in a ‚Äúfortress‚Äù in one move and, at the same time, bring a heavy figure into battle is beautiful, but the developers suffer again: <br><br><div class="spoiler">  <b class="spoiler_title">Castling (ZoG)</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> OO ( (<span class="hljs-name"><span class="hljs-name">verify</span></span> never-moved?) e <span class="hljs-comment"><span class="hljs-comment">; KB1 (verify empty?) e ; KN1 (verify empty?) cascade e ; KR1 (verify (and friend? (piece? Rook) never-moved?) ) from back ; K1 ; Save expensive not-attacked?s for last (verify not-attacked?) e ; KB1 (verify not-attacked?) to (set-attribute never-moved? false) ; We could check if KN1 is attacked too, but this isn't ; really necessary since Zillions doesn't allow any moves ; into check e ; KN1 (set-attribute never-moved? false) add ) )</span></span></code> </pre><br></div></div><br>  And it is only short!  I did not give a long one, for reasons of humanity.  I am grateful to the sky and the whole civilized chess community for the fact that, until today, the ‚Äúfree castling‚Äù, so beloved by the Italians, has not been preserved.  Especially for the implementation of castling, the developers had to enter the <b>cascade</b> command into the ZoG core, allowing them to involve several figures in the execution of the move.  Here, I will not say anything bad, a good universal solution, but I decided not to limit myself at all with stupid conventions.  Castling begins with the king moving, but who said that only one figure should walk? <br><br><div class="spoiler">  <b class="spoiler_title">Castling (Dagaz)</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> OO (<span class="hljs-name"><span class="hljs-name">check</span></span> (<span class="hljs-name"><span class="hljs-name">not</span></span> is-moved?)) (<span class="hljs-name"><span class="hljs-name">check</span></span> not-attacked?) (<span class="hljs-name"><span class="hljs-name">take-piece-to-head</span></span> current-pieces) (<span class="hljs-name"><span class="hljs-name">check</span></span> w) (<span class="hljs-name"><span class="hljs-name">check</span></span> is-empty?) (<span class="hljs-name"><span class="hljs-name">check</span></span> (<span class="hljs-name"><span class="hljs-name">not-attacked</span></span>? King)) (<span class="hljs-name"><span class="hljs-name">check</span></span> w) (<span class="hljs-name"><span class="hljs-name">check</span></span> is-empty?) (<span class="hljs-name"><span class="hljs-name">check</span></span> (<span class="hljs-name"><span class="hljs-name">not-attacked</span></span>? King)) (<span class="hljs-name"><span class="hljs-name">drop-pieces</span></span> current-pieces) (<span class="hljs-name"><span class="hljs-name">check</span></span> w) (<span class="hljs-name"><span class="hljs-name">check</span></span> (<span class="hljs-name"><span class="hljs-name">not</span></span> is-moved?)) (<span class="hljs-name"><span class="hljs-name">set!</span></span> is-moved? true) (<span class="hljs-name"><span class="hljs-name">take-piece-to-head</span></span> current-pieces) ee (<span class="hljs-name"><span class="hljs-name">drop-pieces</span></span> current-pieces) add-move )</code> </pre><br></div></div><br>  The possibility of castling is associated with the performance of a number of interesting conditions.  So castling is impossible if: <br><br><ul><li>  the king or rook already went to the party </li><li>  the king is in check </li><li>  the king as a result of castling falls under the check </li><li>  the field through which the king must pass is attacked by the opponent's figure </li><li>  between the king and the rook, in the direction of which the king swaps, there are other figures </li></ul><br>  Checking the last condition is trivial.  In order to check the first condition, the attributes of the figures were introduced in ZoG (a very useful feature, though I think it would be even more useful if the attributes could store not only boolean values).  As for the rest, this is a topic for a separate and very serious conversation in one of the following sections. <br><br>  As you can see, in the implementation of classical Chess, there is something to break your head, but the real fun begins in chess is not classical.  What will happen if you put together <a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D1%2585%25D0%25BC%25D0%25B0%25D1%2582%25D1%258B">Chess</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%25A5%25D0%25BD%25D0%25B5%25D1%2584%25D0%25B0%25D1%2582%25D0%25B0%25D1%2584%25D0%25BB">Hnefatafl</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D1%2588%25D0%25BA%25D0%25B8">Checkers</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B0%25D0%25BD%25D0%25BE%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B0">Fanoron</a> , add one unique, not like anything else figure, mix it thoroughly, but do not stir it up?  I do not know about you, but <a href="http://tesera.ru/person/5102/">Robert Abbott</a> , in 1962, turned out to be <a href="http://www.chessvariants.org/other.dir/ultima.html">Ultima</a> . <br><br>  In this game, everything is unusual.  Perhaps only the king continues to adhere to chess principles.  Here you can see the illustrated guide of the rules on which the figures walk.  For the developer, in this celebration of life, the most important thing is that, in this game, more often than not, the field to which the figure walks is attacked, and sometimes even several fields at once.  This fact has far-reaching consequences, but this is again a topic of conversation in a subsequent section.  Another example of such a ‚Äúproblem‚Äù game is <a href="http://habrahabr.ru/post/234587/">Ritmomachia</a> . </div><p>Source: <a href="https://habr.com/ru/post/248639/">https://habr.com/ru/post/248639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248621/index.html">Again books at the free price on books.ru</a></li>
<li><a href="../248623/index.html">Visualization of multidimensional data using Andrews charts</a></li>
<li><a href="../248625/index.html">Google AdSense joined the sanctions in the Crimea</a></li>
<li><a href="../248629/index.html">Configuration Management in Drupal 8, developer review</a></li>
<li><a href="../248637/index.html">Hacking time: more than 30,000 NTP servers are still vulnerable</a></li>
<li><a href="../248645/index.html">Social networks in Russia, winter 2014-2015. Numbers, trends, forecasts</a></li>
<li><a href="../248647/index.html">Sample application using the library AQuery</a></li>
<li><a href="../248649/index.html">Access Control Approaches: RBAC vs. ABAC</a></li>
<li><a href="../248653/index.html">Video. Material Design Basic Principles</a></li>
<li><a href="../248657/index.html">Monitoring of servers from Infobox has become more convenient: notifications, monitoring of arbitrary ports, correct work with firewalls</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>