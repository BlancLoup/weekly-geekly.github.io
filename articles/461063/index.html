<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interaction of R with databases on the example of Microsoft SQL Server and other DBMS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since the lion's share of business information is stored in databases. In whatever programming language you write, you have to perform various actions...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interaction of R with databases on the example of Microsoft SQL Server and other DBMS</h1><div class="post__text post__text-html js-mediator-article"><p>  Since the lion's share of business information is stored in databases.  In whatever programming language you write, you have to perform various actions with them. </p><br><p>  In this article I will talk about two interfaces for working with databases in R. Most of the examples demonstrate working with Microsoft SQL Server, however, all code examples will work with other databases, such as: MySQL, PostgreSQL, SQLite, ClickHouse , Google BigQuery, etc. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/925/a23/786/925a23786a89917d9a314a793545cbb1.jpg" alt="image"></p><a name="habracut"></a><br><h1 id="soderzhanie">  Content </h1><br><ul><li>  <a href="https://habr.com/ru/post/461063/">Software required</a> </li><li>  <a href="https://habr.com/ru/post/461063/">DBI package</a> <br><ul><li>  <a href="https://habr.com/ru/post/461063/">List of basic DBI functions</a> </li><li>  <a href="https://habr.com/ru/post/461063/">Database Connectivity</a> <br><ul><li>  <a href="https://habr.com/ru/post/461063/">An example of connecting to Microsoft SQL Server using the odbc package</a> </li><li>  <a href="https://habr.com/ru/post/461063/">An example of connecting to Microsoft SQL Server using the RMSSQL package</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/461063/">Creating tables and writing to the database</a> </li><li>  <a href="https://habr.com/ru/post/461063/">Reading data from a DBMS</a> </li><li>  <a href="https://habr.com/ru/post/461063/">Data manipulation in DBMS (DML)</a> </li><li>  <a href="https://habr.com/ru/post/461063/">Transactions in the DBMS</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/461063/">RODBC Package</a> <br><ul><li>  <a href="https://habr.com/ru/post/461063/">Key features of the RODBC package</a> </li><li>  <a href="https://habr.com/ru/post/461063/">An example of working with RODBC</a> </li><li>  <a href="https://habr.com/ru/post/461063/">Transactional</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/461063/">Conclusion</a> </li></ul><br><h1 id="trebuemoe-programmnoe-obespechenie">  Software required </h1><br><p>  In order to repeat all the examples of working with the DBMS described in the article, you will need the following free software listed below: </p><br><ol><li>  <a href="https://cran.r-project.org/bin/windows/base/">Language R</a> ; </li><li>  <a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a> development environment; </li><li>  Database Management System, to choose from: <br>  3.1.  <a href="https://www.microsoft.com/ru-RU/download/details.aspx%3Fid%3D55994">Microsoft SQL Server</a> <br>  3.2.  <a href="https://dev.mysql.com/downloads/mysql/">MySQL</a> <br>  3.3.  <a href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">PostgreSQL</a> </li></ol><br><h1 id="paket-dbi">  DBI package </h1><br><p> The <code>DBI</code> package is the most popular and convenient way to interact with databases in R. </p><br><p>  <code>DBI</code> provides you with a set of functions with which you can manage databases.  But to connect to databases, you need to install additional packages that are drivers for various database management systems (DBMS). </p><br><h3 id="spisok-osnovnyh-funkciy-dbi">  List of basic DBI functions </h3><br><ul><li>  <code>dbConnect</code> - connection to the database; </li><li>  <code>dbWriteTable</code> - write a table to the database; </li><li>  <code>dbReadTable</code> - loading a table from a database; </li><li>  <code>dbGetQuery</code> - loading the result of query execution; </li><li>  <code>dbSendQuery</code> - sending a query to the database; </li><li>  <code>dbFetch</code> - extract elements from a result set; </li><li>  <code>dbExecute</code> - execution of requests to update / delete / insert data into tables; </li><li>  <code>dbGetInfo</code> - request information about the result of the request or connection; </li><li>  <code>dbListFields</code> - request for a list of table fields; </li><li>  <code>dbListTables</code> - query a list of database tables; </li><li>  <code>dbExistsTable</code> - check for the presence of a table in the database; </li><li>  <code>dbRemoveTable</code> - delete a table from the database; </li><li>  <code>dbDisconnect</code> - disconnect from database. </li></ul><br><h3 id="podklyuchenie-k-bazam-dannyh">  Database Connectivity </h3><br><p>  To interact with databases, you must first connect to them.  Depending on the DBMS you plan to work with, you will need an additional package, below is a list of the most frequently used ones. </p><br><ul><li>  <code>odbc</code> - Driver for connecting via ODBC interface; </li><li>  <code>RSQLite</code> - Driver for SQLite; </li><li>  <code>RMySQL</code> / <code>RMariaDB</code> - Driver for MySQL and MariaDB; </li><li>  <code>RPostgreSQL</code> - Driver for PosrtgreSQL; </li><li>  <code>bigrquery</code> - Driver for Google BigQuery; </li><li>  <code>RClickhouse</code> / <code>clickhouse</code> - Driver for ClickHouse; </li><li>  <code>RMSSQL</code> - Driver for Microsoft SQL Server (MS SQL), <em>at the time of writing this article is present only on GitHub</em> . </li></ul><br><p>  The <code>DBI</code> package comes with the basic R package, but packages that are database drivers must be installed using the <code>install.packages(" ")</code> command <code>install.packages(" ")</code> . </p><br><p>  To install packages from GitHub you will also need an additional package - <code>devtools</code> .  For example, the <code>RMSSQL</code> package is not currently published in the main R package repository, use the following code to install it: </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><h4 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-odbc">  An example of connecting to Microsoft SQL Server using odbc </h4><br><p>  Before using any package in an R session, it must first be connected using the <code>library(" ")</code> function <code>library(" ")</code> . </p><br><p>  It was not without reason that I chose Microsoft SQL Server as the main DBMS, which will provide most of the examples in this article.  The fact is that this is a fairly popular database, but at the same time it still does not have a driver for connecting from R published on CRAN. </p><br><p>  But fortunately, SQL Server, like almost any other database, has an <a href="https://ru.wikipedia.org/wiki/ODBC">ODBC</a> (English Open Database Connectivity) interface for connecting.  There are a number of packages for connecting to the DBMS via the ODBC interface in R.  First, we will look at connecting through the <code>odbc</code> package. </p><br><div class="spoiler">  <b class="spoiler_title">Easy database connection via odbc interface</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   odbc install.packages("odbc") #   library(odbc) #   MS SQL con &lt;- dbConnect(drv = odbc(), Driver = "SQL Server", Server = "localhost", Database = "mybase", UID = "my_username", PWD = "my_password", Port = 1433)</code> </pre> </div></div><br><p>  In the <code>dbConnect()</code> function, you need to pass the function, which is the driver for connecting to the DBMS ( <code>odbc()</code> ), as the first argument to <em>drv</em> .  Such functions are usually called the same as the DBMS, and come with packages that are drivers for <code>DBI</code> . </p><br><p>  Next, you need to list the connection parameters.  To connect to MS SQL via ODBC, you must specify the following parameters: </p><br><ul><li>  Driver - Name of the ODBC driver; </li><li>  Server - IP address of SQL server; </li><li>  Database - The name of the database to connect to; </li><li>  UID - Database username; </li><li>  PWD - Password; </li><li>  Port - The port to connect, with SQL Server, the default port is 1433. </li></ul><br><p>  An ODBC driver for connecting to Microsoft SQL Server is included with Windows, but it may have a different name.  You can view the list of installed drivers in the ODBC Data Source Administrator.  You can start the data source administrator in Windows 10 in the following way: </p><br><ul><li>  32-bit version: <code>%systemdrive%\Windows\SysWoW64\Odbcad32.exe</code> </li><li>  64-bit version: <code>%systemdrive%\Windows\System32\Odbcad32.exe</code> </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c6c/816/934/c6c816934a70e2386a4547d7626d515f.png"></p><br><p>  You can also get a list of all the drivers installed on your PC using the <code>odbcListDrivers()</code> function. </p><br><pre> <code class="plaintext hljs"> name attribute value &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 SQL Server APILevel 2 2 SQL Server ConnectFunctions YYY 3 SQL Server CPTimeout 60 4 SQL Server DriverODBCVer 03.50 5 SQL Server FileUsage 0 6 SQL Server SQLLevel 1 7 SQL Server UsageCount 1 8 MySQL ODBC 5.3 ANSI Driver UsageCount 1 9 MySQL ODBC 5.3 Unicode Driver UsageCount 1 10 Simba ODBC Driver for Google BigQuery Description Simba ODBC Driver for Google BigQuery2.0 # ... with 50 more rows</code> </pre> <br><p>  You can download ODBC drivers for other DBMSs at the following links: </p><br><ul><li>  <a href="https://dev.mysql.com/downloads/connector/odbc/">MySQL</a> </li><li>  <a href="https://odbc.postgresql.org/">PostgreSQL</a> </li><li>  <a href="https://cloud.google.com/bigquery/providers/simba-drivers/">Google bigquery</a> </li></ul><br><p>  For various DBMSs, the name of the parameters for connection may be different, for example: </p><br><ul><li>  PostgreSQL / MySQL / MariaDB - user, password, host, port, dbname; </li><li>  GoogleBigQuery - project, dataset; </li><li>  ClickHouse - user, password, db, port, host; </li></ul><br><p>  Using the ODBC data source administrator, you can run the wizard to create an ODBC data source.  To do this, just open the administrator, go to the "Custom DSN" tab and click the "Add ..." button. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9ae/e92/ba3/9aee92ba30bdc8de811623aae1fb58fa.png"></p><br><p>  When creating a data source using an administrator, you give it a name, DSN (Data Source Name). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b03/a0c/a7c/b03a0ca7c90fa0d5bddccb53575563a3.png"></p><br><p>  In the example above, we created a data source with the DSN "my_test_source".  Now we can use this source to connect to Microsoft SQL Server, and not specify other connection parameters in the code. </p><br><div class="spoiler">  <b class="spoiler_title">Connecting to the database via odbc interface using DSN</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password")</code> </pre> </div></div><br><p>  You can view the names of all ODBC data sources created on your PC using the <code>odbcListDataSources()</code> function. </p><br><pre> <code class="plaintext hljs"> name description &lt;chr&gt; &lt;chr&gt; 1 BQ Simba ODBC Driver for Google BigQuery 2 BQ_main Simba ODBC Driver for Google BigQuery 3 BQ ODBC Simba ODBC Driver for Google BigQuery 4 OLX Simba ODBC Driver for Google BigQuery 5 Multicharts Simba ODBC Driver for Google BigQuery 6 PostgreSQL35W PostgreSQL Unicode(x64) 7 hillel_bq Simba ODBC Driver for Google BigQuery 8 blog_bq Simba ODBC Driver for Google BigQuery 9 MyClientMSSQL SQL Server 10 local_mssql SQL Server 11 MSSQL_localhost SQL Server 12 my_test_source SQL Server 13 Google BigQuery Simba ODBC Driver for Google BigQuery</code> </pre> <br><h3 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-rmssql">  An example of connecting to Microsoft SQL Server using the RMSSQL package </h3><br><p>  <code>RMSSQL</code> not published on CRAN, so you can install it from GitHub using the <code>devtools</code> package. </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Connection example using DBI RMSSQL driver</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#    library(RJDBC) library(RMSSQL) library(DBI) #  RMSSQL con &lt;- dbConnect(MSSQLServer(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase")</code> </pre> </div></div><br><p>  In most cases, using the <code>DBI</code> package to work with databases, you will connect in this way.  Those.  install one of the required driver packages, passing as the value of the <em>drv</em> argument to the <code>dbConnect</code> function, the function is the driver for connecting to the DBMS you need. </p><br><div class="spoiler">  <b class="spoiler_title">An example of connecting to MySQL, PostgreSQL, SQLite and BigQuery</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   MySQL library(RMySQL) con &lt;- dbConnect(MySQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   SQLite library(RSQLite) # connection or create base con &lt;- dbConnect(drv = SQLite(), "localhost.db") #   Google BigQuery library(bigrquery) con &lt;- dbConnect(drv = bigquery(), project = "my_proj_id", dataset = "dataset_name")</code> </pre> </div></div><br><h3 id="sozdanie-tablic-i-zapis-v-bazu-dannyh">  Creating tables and writing to the database </h3><br><p>  Writing to the database is performed by the <code>dbWriteTable()</code> function. </p><br><p>  Arguments to the <code>dbWriteTable()</code> function: </p><br><p>  <em>Required arguments are in bold, italics are optional</em> </p><br><ul><li>  <strong>conn</strong> - DBMS connection object created using the <code>dbConnect</code> function; </li><li>  <strong>name</strong> - the name of the table in the DBMS into which the data will be written; </li><li>  <strong>value</strong> - a table (an object of the data.frame / data.table / tibble_frame class) in R, the data from which will be written to the DBMS; </li><li>  <em>row.names</em> - Adds a row_names column with row numbers to the table, <em>defaults to FALSE</em> . </li><li>  <em>overwrite</em> - Overwrite the table if the table with the name specified in the <em>name</em> argument is already present in the DBMS; <em>the default value is FALSE</em> ; </li><li>  <em>append</em> - Append data if a table with the name specified in the <em>name</em> argument is already present in the DBMS; <em>the default value is FALSE</em> ; </li><li>  <em>field.types</em> - Accepts a named vector, and sets the data type in each field when writing to the DBMS, <em>defaults to NULL</em> ; </li><li>  <em>temporary</em> - Allows you to create temporary tables in the DBMS that will be available until the connection with the database is disconnected; <em>the default value is FALSE</em> . </li></ul><br><div class="spoiler">  <b class="spoiler_title">An example of writing data to a DBMS through DBI</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #     DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     iris,         R  iris dbWriteTable(conn = con, name = "iris", value = iris) #     dbDisconnect(con)</code> </pre> </div></div><br><p>  To view tables in the database, use the <code>dbListTables()</code> function, to delete tables <code>dbRemoveTable()</code> </p><br><div class="spoiler">  <b class="spoiler_title">An example of querying a list of tables and deleting a table from a DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #    dbListTables(con) #   iris dbRemoveTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="chtenie-dannyh-iz-subd">  Reading data from a DBMS </h3><br><p>  Using <code>DBI</code> you can query either entire tables or the result of executing your SQL query.  The functions <code>dbReadTable()</code> and <code>dbGetQuery()</code> are used to perform these operations. </p><br><div class="spoiler">  <b class="spoiler_title">An example of querying an iris table from a DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   iris   iris dbiris &lt;- dbReadTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">An example of loading the result of executing SQL from a DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     setosa &lt;- dbGetQuery(con, "SELECT * FROM iris WHERE Species = 'setosa'") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="manipulirovanie-dannymi-v-subd-dml">  Data manipulation in DBMS (DML) </h3><br><p>  The <code>dbGetQuery()</code> function <code>dbGetQuery()</code> above is used exclusively for querying data samples (SELECT). </p><br><p>  For data manipulation operations, such as UPDATE, INSERT, DELETE, the <code>dbExecute()</code> function exists in <code>DBI</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Sample code for manipulating data in a DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   (INSERT) dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   (UPDATE) dbExecute(con, "UPDATE iris SET [Species] = 'old_value' WHERE row_names = 51") #     (DELETE) dbExecute(con, "DELETE FROM iris WHERE row_names = 51") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="tranzakcii-v-subd">  Transactions in the DBMS </h3><br><blockquote>  A transaction is a sequential read and write operation.  The end of a transaction can be either saving changes (commit, commit) or canceling changes (rollback, rollback).  In relation to the database, a transaction is a series of queries, which are treated as a single query. </blockquote><p>  <em><a href="https://habr.com/ru/post/446662/">Quote from the article "Transactions and the mechanisms of their control"</a></em> </p><br><p>  A transaction encapsulates several SQL statements in an elementary unit.  In <code>DBI</code> start of a transaction is initiated with <code>dbBegin()</code> and then either confirmed with <code>dbCommit()</code> or canceled with <code>dbRollback()</code> .  In any case, the DBMS guarantees that: either all or none of the statements will be applied to the data. </p><br><p>  For example, during the transaction, let's add 51 rows to the iris table, then change the <em>Sepal.Width</em> value to 5 lines, and delete 43 lines from the table. </p><br><div class="spoiler">  <b class="spoiler_title">Transaction code example</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbCommit(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5 8.0 1.4 0.2 setosa # 2 51 7 3.2 4.7 1.4 versicolor # 3 51 5 3.3 1.7 0.3 new_values</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Transaction Cancellation Code Example</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbRollback(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor</code> </pre> </div></div><br><h1 id="paket-rodbc">  RODBC Package </h1><br><p>  The <code>RODBC</code> package provides a stand-alone interface for connecting and working with a DBMS through an ODBC interface. </p><br><p>  <code>RODBC</code> not <code>DBI</code> compatible, i.e.  you cannot use the connection object created using <code>RODBC</code> in the functions provided by the <code>DBI</code> package. </p><br><h3 id="osnovnye-funkcii-paketa-rodbc">  Key features of the RODBC package </h3><br><ul><li>  <code>odbcConnect</code> - Connection to the DBMS via DSN; </li><li>  <code>odbcDriverConnect</code> - Connection to the database through the connection string; </li><li>  <code>sqlQuery</code> - Sending a query to the DBMS, and getting the result of its execution.  It supports any type of query: SELECT, UPDATE, INSERT, DELETE. </li><li>  <code>sqlFetch</code> - Get the whole table from the DBMS; </li><li>  <code>sqlTables</code> - Get a list of tables in the database. </li><li>  <code>sqlSave</code> - Create a new table in the database, or add new data to an existing table; </li><li>  <code>sqlUpdate</code> - Updating data in a table that already exists in the DBMS; </li><li>  <code>sqlDrop</code> - Delete a table in a DBMS; </li><li>  <code>odbcClose</code> - End a connection to a DBMS. </li></ul><br><h3 id="primer-raboty-s-rodbc">  An example of working with RODBC </h3><br><p>  From my point of view, <code>RODBC</code> less functional than <code>DBI</code> , but it has all the necessary functions for working with a DBMS. </p><br><div class="spoiler">  <b class="spoiler_title">An example of interaction with a DBMS through RODBC</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   con_string &lt;- odbcDriverConnect(connection = "Driver=SQL Server;Server=localhost;Database=mybase;UID=my_username;PWD=my_password;Port=1433") #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #     iris sqlSave(con_dsn, dat = iris, tablename = "iris", append = TRUE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #   sqlDrop(con_dsn, sqtable = "iris") #     odbcCloseAll()</code> </pre> </div></div><br><h1 id="tranzakcionnost">  Transactional </h1><br><p>  By default, transactionality in <code>RODBC</code> turned off.  Transaction management is carried out by two functions. </p><br><ul><li>  <code>odbcSetAutoCommit</code> - Switch between the normal and transactional DBMS operation modes; </li><li>  <code>odbcEndTran</code> - Confirm or cancel a transaction. </li></ul><br><p>  Transactional mode is <code>odbcSetAutoCommit</code> and disabled by the <code>odbcSetAutoCommit</code> function using the <em>autoCommit</em> argument. </p><br><div class="spoiler">  <b class="spoiler_title">Example of working in transactional mode in RODBC</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #    odbcSetAutoCommit(con_dsn, autoCommit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #   odbcEndTran(con_dsn, commit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   odbcEndTran(con_dsn, commit = TRUE) #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     odbcClose(con_dsn)</code> </pre> </div></div><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>  The two methods of working with databases in the R, <code>DBI</code> and <code>RODBC</code> languages ‚Äã‚Äãdescribed in the article are quite universal and will work with almost any DBMS. </p><br><p>  The only difference in operation between different DBMSs is the connection process.  For most popular DBMSs, there are separate packages that are drivers.  For the rest of the DBMS, it is necessary to configure the connection through the ODBC interface using <code>odbc</code> or <code>RODBC</code> .  All other manipulations, regardless of which DBMS you have chosen, will be unchanged.  An exception is sending SQL queries, depending on the SQL dialect supported by the DBMS you are working with. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/461063/">https://habr.com/ru/post/461063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461055/index.html">Rekko Challenge 2019: how it was</a></li>
<li><a href="../461057/index.html">Telegram channels about game development</a></li>
<li><a href="../461059/index.html">Writing an Android App for Movie Fans - Part 1 (Prototyping)</a></li>
<li><a href="../46106/index.html">3G communicator in our opinion</a></li>
<li><a href="../461061/index.html">Magnesium alloys, twin boundaries and segregation</a></li>
<li><a href="../461067/index.html">Top 65 SQL questions from job interviews you should be prepared for in 2019. Part I</a></li>
<li><a href="../461069/index.html">Nobelic Outdoor IP Cameras: Tests, Technologies, and Capabilities of Ivideon Video Surveillance Systems</a></li>
<li><a href="../46107/index.html">Booting MS Windows from a USB flash drive</a></li>
<li><a href="../461071/index.html">Optimization of database queries on the example of B2B service for builders</a></li>
<li><a href="../461073/index.html">We connect online maps to the navigator on the smartphone. Part 3 - OverpassTurbo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>