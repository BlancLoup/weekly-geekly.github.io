<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tame ZoG (Part 3: Football of the Kumsk Valley)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="But we say: here in this cave on the edge of the world, dwarves and trolls made peace to go hand in hand under the hand of Death. 

 And we say: our e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tame ZoG (Part 3: Football of the Kumsk Valley)</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/344/ef9/d5d/344ef9d5d1a94f75723e9ee57b40d1a2.png">  <b><i>But we say: here in this cave on the edge of the world, dwarves and trolls made peace to go hand in hand under the hand of Death.</i></b> <b><i><br><br></i></b>  <b><i>And we say: our enemy is not Troll or Dwarf, but malice, slander, cowardice, vessels of disgust, those who do evil under the guise of good.</i></b>  <b><i>That's who we fought today, but the stubbornness of fools forever and say ... that this is a lie</i></b> <b><i><br><br></i></b>  <b><i>sir terry prattchett</i></b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In a previous <a href="http://habrahabr.ru/post/212237/">article</a> , I talked about the original board <a href="http://en.wikipedia.org/wiki/Games_of_the_Discworld">game</a> developed by Trevor Truran, based on the works of the famous English writer Terry Pratchett.  In 2005, Truran developed a new <a href="http://en.wikipedia.org/wiki/Games_of_the_Discworld">game</a> using the same set of pieces on the same board.  The name of this game is " <b>Koom Valley Thud</b> " and, today, I will try to implement it, at the same time talking about the features of the ZRF language, which I did not have time to talk about earlier. <br><br>  Recall that ZRF is a game rules description language (reminiscent of <a href="http://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D1%2581%25D0%25BF">Lisp</a> ) used by <a href="http://www.zillions-of-games.com/">Zillions of Games</a> .  Despite the fact that there are certain difficult points, in general, it is quite simple and can be mastered by anyone, even very far from programming.  The main advantage of the ZoG game core is its versatility.  Having described the rules, we actually get a new game right away.  Although AI ZoG is inferior to specialized game engines, it plays, surprisingly, strongly.  Unfortunately, the free demo version of the application allows you to run only a limited set of games and does not allow you to download self-developed ZRF descriptions. <br><a name="habracut"></a><br>  As usual, I'll start with the rules of the game.  The board for <b>Koom Valley Thud</b> has the only difference from the original board <b>Thud</b> - the central field is available for the moves of the pieces.  "Rock", located on it at the beginning of the game, can move around the field.  The goal of the gnomes game is to drag the "rock" to the last horizontal of the board.  Trolls, in order to win, it is necessary to surround the "Ckala" at least three figures, and, moreover, they must do this on their turn. <br><br>  The moves of the figures have undergone more serious changes.  Trolls, in this game, can move one, two, or three cells in any direction (vertically, horizontally, or diagonally).  Taking enemy pieces is carried out according to the rules of Checkers - the troll jumps over the gnome (located on the next cell) and removes his piece from the board, stopping at the next cell.  As in Checkers, the chain of takes can be continued, but, unlike them, the capture is carried out at the request of the player.  As well as moving, taking can be carried out in any direction.  Trolls cannot jump over their figures and ‚ÄúThe Rock‚Äù. <br><br>  Gnomes, as before, can walk on any number of cells vertically, horizontally, or diagonals (like the Queen in Chess).  In order to remove a troll from the field, the dwarves must "surround" it from two sides (in this respect, the game resembles <a href="http://ru.wikipedia.org/wiki/%25D0%25A5%25D0%25BD%25D0%25B5%25D1%2584%25D0%25B0%25D1%2582%25D0%25B0%25D1%2584%25D0%25BB">Tafl</a> , with the difference that it is possible to "surround" diagonally).  During the turn, several trolls can be removed from the board (if all of them were ‚Äúsurrounded‚Äù by gnomes).  Instead of moving the figure, the dwarves can move the ‚ÄúRock‚Äù one square in any direction.  A prerequisite for such a move is the proximity to the figure of the gnome in both the initial and the final point of the move (the neighbor does not have to be the same gnome).  Dwarfs cannot jump over figures. <br><br>  Having understood the rules, you can proceed to their description on the ZRF.  I will not give here macros of the description of a board and game.  Their differences from <b>Thud are</b> minimal, in addition, the full description of the game can always be viewed on <a href="">GitHub</a> .  Focus on less obvious things.  On the part of the trolls, we need to describe the possibilities of two fundamentally different moves (with and without taking).  At the same time, if a figure is taken, the next move can only be taking.  This is done as follows: <br><br><div class="spoiler">  <b class="spoiler_title">First, we describe the normal troll course.</b> <div class="spoiler_text"><pre><code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> kv-troll ( $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) add $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) add $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) add ) )</code> </pre> <br></div></div><br>  It says here that a figure can walk in empty cells in one, two or three cells in the indicated direction. <br><br><div class="spoiler">  <b class="spoiler_title">Next, we describe the move with taking</b> <div class="spoiler_text"><pre> <code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> kv-troll-capturing ( $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf) ) capture $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">add-partial</span></span> capturing-type) ) )</code> </pre><br></div></div><br>  We move in the indicated direction and, if there is a dwarf on the cage, remove it from the board.  Moving further, if the next cell is empty, and complete the course of the new directory <b>add-partial</b> .  Unlike <b>add</b> , it allows you to perform a partial move.  As a parameter, the move type to which the continuation should belong is passed to the <b>add-partial</b> directive.  Types of moves are defined in the description of the figure: <br><br><div class="spoiler">  <b class="spoiler_title">Types of moves</b> <div class="spoiler_text"><pre> <code class="lisp hljs"> (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">name</span></span> Troll) (<span class="hljs-name"><span class="hljs-name">image</span></span> Trolls <span class="hljs-string"><span class="hljs-string">"images\gluk\T.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">description</span></span> <span class="hljs-string"><span class="hljs-string">"Troll"</span></span>) (<span class="hljs-name"><span class="hljs-name">moves</span></span> (<span class="hljs-name"><span class="hljs-name">move-type</span></span> capturing-type) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> n) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> ne) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> e) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> nw) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> s) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> se) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> w) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> sw) (<span class="hljs-name"><span class="hljs-name">move-type</span></span> non-capturing-type) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> n) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> ne) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> e) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> nw) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> s) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> se) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> w) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> sw) ) )</code> </pre><br></div></div><br>  At the level of the game description ( <b>game</b> ), with the <b>move-priorities directive,</b> you can set priorities for move types, making the take mandatory (as in Checkers), but we will not do this, giving the player a choice.  The course of the gnome is described simply: <br><br><div class="spoiler">  <b class="spoiler_title">Move the gnome</b> <div class="spoiler_text"><pre> <code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> check-troll ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">enemy</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) mark $<span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf $<span class="hljs-number"><span class="hljs-number">1</span></span>) capture ) back ) ) ( <span class="hljs-name"><span class="hljs-name">define</span></span> kv-dwarf ( $<span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-name"><span class="hljs-name">while</span></span> empty? ( <span class="hljs-name"><span class="hljs-name">if</span></span> on-board? (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> n) (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> nw) (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> s) (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> sw) (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> w) (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> ne) (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> e) (<span class="hljs-name"><span class="hljs-name">check-troll</span></span> se) add ) $<span class="hljs-number"><span class="hljs-number">1</span></span> ) ) )</code> </pre><br></div></div><br>  At the end of the turn, we check all directions for the presence of a troll ‚Äúsurrounded‚Äù by the gnome from the opposite side and remove the found figures from the board.  Should pay attention to the fact that the predicate <b>piece?</b>  It can take two parameters - the type of the figure and the direction (which allows you to perform the test without moving to the next cell).  It remains to describe the movement of "Rocks": <br><br><div class="spoiler">  <b class="spoiler_title">Move the "Rock"</b> <div class="spoiler_text"><pre> <code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> rock ( (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">or</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf n) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf nw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf s) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf sw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf w) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf ne) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf e) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf se) ) ) $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">or</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf n) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf nw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf s) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf sw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf w) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf ne) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf e) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf se) ) ) add ) )</code> </pre><br></div></div><br>  The main difficulty, as usual, is related to counting.  We need to define the condition of the victory of the trolls, as the neighborhood of "The Rock" with their three figures.  This could be achieved using the directive <b>relative-config</b> , similarly to how it was done in the implementation of <a href="http://ru.wikipedia.org/wiki/Zillions_of_Games">daggers</a> , but we would need to describe all the relative positions of the four adjacent figures (which is in itself a rather interesting combinatorial task) and, most importantly, such a condition would work both on the course of the trolls and on the course of the dwarves (which contradicts the conditions of the game). <br><br><div class="spoiler">  <b class="spoiler_title">There is another way</b> <div class="spoiler_text"><pre> <code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> check-proximity ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">friend</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-second) change-owner else ( <span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-second true ) ) ) ) ) ( <span class="hljs-name"><span class="hljs-name">define</span></span> check-rock-direction ( <span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-second false ) ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) $<span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> enemy? (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Rock) ) ( <span class="hljs-name"><span class="hljs-name">check-proximity</span></span> $<span class="hljs-number"><span class="hljs-number">2</span></span> ) ( <span class="hljs-name"><span class="hljs-name">check-proximity</span></span> $<span class="hljs-number"><span class="hljs-number">3</span></span> ) ( <span class="hljs-name"><span class="hljs-name">check-proximity</span></span> $<span class="hljs-number"><span class="hljs-number">4</span></span> ) ( <span class="hljs-name"><span class="hljs-name">check-proximity</span></span> $<span class="hljs-number"><span class="hljs-number">5</span></span> ) ( <span class="hljs-name"><span class="hljs-name">check-proximity</span></span> $<span class="hljs-number"><span class="hljs-number">6</span></span> ) ( <span class="hljs-name"><span class="hljs-name">check-proximity</span></span> $<span class="hljs-number"><span class="hljs-number">7</span></span> ) ( <span class="hljs-name"><span class="hljs-name">check-proximity</span></span> $<span class="hljs-number"><span class="hljs-number">8</span></span> ) ) $<span class="hljs-number"><span class="hljs-number">5</span></span> ) ) ( <span class="hljs-name"><span class="hljs-name">define</span></span> check-rock ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> n ne e se s sw w nw) ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> ne e se s sw w nw n) ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> e se s sw w nw n ne) ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> se s sw w nw n ne e) ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> s sw w nw n ne e se) ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> sw w nw n ne e se s) ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> w nw n ne e se s sw) ( <span class="hljs-name"><span class="hljs-name">check-rock-direction</span></span> nw n ne e se s sw w) )</code> </pre><br></div></div><br>  This macro allows, having performed a troll move, to check whether the ‚ÄúRock‚Äù adjacent to the other two trolls is adjacent to the end point of the course.  It is used as follows: <br><br><div class="spoiler">  <b class="spoiler_title">Modified troll moves</b> <div class="spoiler_text"><pre> <code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> kv-troll ( $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">check-rock</span></span>) add $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">check-rock</span></span>) add $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">check-rock</span></span>) add ) ) ( <span class="hljs-name"><span class="hljs-name">define</span></span> kv-troll-capturing ( $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf) ) capture $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">check-rock</span></span>) (<span class="hljs-name"><span class="hljs-name">add-partial</span></span> capturing-type) ) )</code> </pre><br></div></div><br>  If the condition of the neighborhood with three trolls is met, we change the owner of the ‚ÄúRock‚Äù with the command <b>change-owner</b> .  Now we can easily formulate the condition of the defeat of the dwarves, as the loss of all figures of the type "Rock": <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">loss-condition</span></span> (<span class="hljs-name"><span class="hljs-name">Dwarfs</span></span>) (<span class="hljs-name"><span class="hljs-name">pieces-remaining</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> Rock))</code> </pre><br>  In the implementation of the macro, it is also worth paying attention to the flag <b>flag?</b>  and <b>set-flag</b> .  Flags allow you to store state in the process of generating a turn  In addition to global flags, it is possible to associate boolean values ‚Äã‚Äãwith the board positions (with the <b>set-position-flag</b> command), as well as with the figures (with the <b>set-attribute</b> command).  Immediately, I note that any attempts to use flags to store global states, like <a href="http://zillionsofgames.com/discus/messages/3/407.html%3F1336232540">this one</a> , are doomed to failure. <br><br>  First of all, this is due to the fact that flags and position flags are reset at the beginning of each turn, but the main reason is that they can be used only in the course of calculating moves, and the order of macro calls is not defined at this stage (which leads to undesirable side effects).  In addition, ZoG developers recommend not to abuse positional flags, since their use has a negative impact on performance.  In principle, to store the state between moves, you can use the attributes of the figures, but this method is very laborious. <br><br>  It remains to describe the game.  Since we are adding a new version of the game to an already existing ZRF description, the <b>variant</b> keyword is used: <br><br><div class="spoiler">  <b class="spoiler_title">Koom valley thud</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">variant</span></span> (<span class="hljs-name"><span class="hljs-name">title</span></span> <span class="hljs-string"><span class="hljs-string">"Koom Valley Thud"</span></span>) (<span class="hljs-name"><span class="hljs-name">description</span></span> <span class="hljs-string"><span class="hljs-string">"..."</span></span>) (<span class="hljs-name"><span class="hljs-name">history</span></span> <span class="hljs-string"><span class="hljs-string">"..."</span></span>) (<span class="hljs-name"><span class="hljs-name">strategy</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>) (<span class="hljs-name"><span class="hljs-name">players</span></span> Dwarfs Trolls) (<span class="hljs-name"><span class="hljs-name">turn-order</span></span> Dwarfs Trolls) (<span class="hljs-name"><span class="hljs-name">kv-game-defs</span></span>) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">name</span></span> Rock) (<span class="hljs-name"><span class="hljs-name">image</span></span> Dwarfs <span class="hljs-string"><span class="hljs-string">"images\gluk\R.bmp"</span></span> Trolls <span class="hljs-string"><span class="hljs-string">"images\gluk\R.bmp"</span></span> ) (<span class="hljs-name"><span class="hljs-name">description</span></span> <span class="hljs-string"><span class="hljs-string">"Rock"</span></span>) (<span class="hljs-name"><span class="hljs-name">moves</span></span> (<span class="hljs-name"><span class="hljs-name">rock</span></span> w) (<span class="hljs-name"><span class="hljs-name">rock</span></span> sw) (<span class="hljs-name"><span class="hljs-name">rock</span></span> e) (<span class="hljs-name"><span class="hljs-name">rock</span></span> se) (<span class="hljs-name"><span class="hljs-name">rock</span></span> n) (<span class="hljs-name"><span class="hljs-name">rock</span></span> nw) (<span class="hljs-name"><span class="hljs-name">rock</span></span> s) (<span class="hljs-name"><span class="hljs-name">rock</span></span> ne) ) ) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">name</span></span> Dwarf) (<span class="hljs-name"><span class="hljs-name">image</span></span> Dwarfs <span class="hljs-string"><span class="hljs-string">"images\gluk\d.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">description</span></span> <span class="hljs-string"><span class="hljs-string">"Dwarf"</span></span>) (<span class="hljs-name"><span class="hljs-name">moves</span></span> (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> ne) (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> n) (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> nw) (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> s) (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> se) (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> e) (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> sw) (<span class="hljs-name"><span class="hljs-name">kv-dwarf</span></span> w) ) ) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">name</span></span> Troll) (<span class="hljs-name"><span class="hljs-name">image</span></span> Trolls <span class="hljs-string"><span class="hljs-string">"images\gluk\T.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">description</span></span> <span class="hljs-string"><span class="hljs-string">"Troll"</span></span>) (<span class="hljs-name"><span class="hljs-name">moves</span></span> (<span class="hljs-name"><span class="hljs-name">move-type</span></span> capturing-type) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> n) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> ne) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> e) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> nw) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> s) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> se) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> w) (<span class="hljs-name"><span class="hljs-name">kv-troll-capturing</span></span> sw) (<span class="hljs-name"><span class="hljs-name">move-type</span></span> non-capturing-type) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> n) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> ne) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> e) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> nw) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> s) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> se) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> w) (<span class="hljs-name"><span class="hljs-name">kv-troll</span></span> sw) ) ) )</code> </pre><br></div></div><br>  We can add separators to the options menu using the following construction: <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">variant</span></span> (<span class="hljs-name"><span class="hljs-name">title</span></span> <span class="hljs-string"><span class="hljs-string">"-"</span></span>) )</code> </pre><br>  Having started this game for execution, you can see that the dwarves are busy mostly with the running of trolls (as in the previous game, the trolls turned out too strong) and they have no time left to move the ‚ÄúRock‚Äù.  Since I, like old <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25BE%25D1%2580%25D0%25BA%25D0%25BE%25D1%2583_%25D0%2596%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25B7%25D0%25BE%25D0%25B1%25D0%25B5%25D1%2582%25D0%25BE%25D0%25BD%25D1%2581%25D1%2581%25D0%25BE%25D0%25BD">Morkow</a> , advocate peace between dwarves and trolls, I took advantage of the flexibility of ZoG and made minor changes to the rules: <br><br><div class="spoiler">  <b class="spoiler_title">I banned all captures of enemy figures.</b> <div class="spoiler_text"><pre> <code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> shift ( $<span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-name"><span class="hljs-name">while</span></span> empty? add $<span class="hljs-number"><span class="hljs-number">1</span></span> ) ) ) ( <span class="hljs-name"><span class="hljs-name">define</span></span> kvb-troll ( $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) ) (<span class="hljs-name"><span class="hljs-name">check-rock</span></span>) add $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) ) (<span class="hljs-name"><span class="hljs-name">check-rock</span></span>) add $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) ) (<span class="hljs-name"><span class="hljs-name">check-rock</span></span>) add ) )</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">And he allowed the ball to move (let it be a ball) in more than one square.</b> <div class="spoiler_text"><pre> <code class="lisp hljs">( <span class="hljs-name"><span class="hljs-name">define</span></span> ball ( ( <span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">or</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf n) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf nw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf s) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf sw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf w) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf ne) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf e) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf se) ) ) $<span class="hljs-number"><span class="hljs-number">1</span></span> ( <span class="hljs-name"><span class="hljs-name">while</span></span> empty? ( <span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">or</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf n) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf nw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf s) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf sw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf w) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf ne) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf e) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Dwarf se) ) add ) $<span class="hljs-number"><span class="hljs-number">1</span></span> ) ) )</code> </pre><br></div></div><br>  In addition, as you can see, I forbade the trolls to approach the edge of the board.  If this is not done, the trolls will have a win-win strategy - fill the last row with their own figures, arranging the remaining trolls (there will be three of them) to hunt for the ball.  In <b>Koom Valley Thud</b> this is also possible, but there you can eat trolls (by the way, a computer running ZoG, I have never thought of such tactics). <br><br>  The result was, in my opinion, not bad.  The game remained quite complex and positional, becoming more dynamic.  Gnomes (under computer control) now easily cope with the task (which means that I have made life easier for them too) and, after a certain number of dizzying passes through the entire field, roll the ball into the goal.  Those interested can see what it looks like in the video: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/FtCxPQ4DBCg%3Ffeature%3Doembed&amp;xid=17259,15700022,15700043,15700186,15700190,15700253&amp;usg=ALkJrhgElTqyDZhVcGfWg25NIRgvJt5LJg" frameborder="0" allowfullscreen=""></iframe><br></div><p>Source: <a href="https://habr.com/ru/post/212835/">https://habr.com/ru/post/212835/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212821/index.html">Adaptive letters? You are welcome!</a></li>
<li><a href="../212823/index.html">Rusty brains - go over the bridge. The Bridge by Ty Tailor</a></li>
<li><a href="../212825/index.html">Anti-rootkit for Userland-RootKit Azazel "on the knee"</a></li>
<li><a href="../212831/index.html"># 3dprintexpo: Russia's first exhibition of three-dimensional printing</a></li>
<li><a href="../212833/index.html">Lshell instead of chroot ssh</a></li>
<li><a href="../212837/index.html">The basics of creating a 2D character in Godot. Part 2: compiling templates, a little about GDScript, movement and animation of the hero</a></li>
<li><a href="../212839/index.html">SIP Security Essay</a></li>
<li><a href="../212841/index.html">Portal migration from SharePoint 2010 to SharePoint 2013. What has changed and how to live with it</a></li>
<li><a href="../212843/index.html">Monthly digest of interesting IT-projects on Kickstarter ‚Ññ1</a></li>
<li><a href="../212847/index.html">Denormalization of trees</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>