<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Chromium Extension: Creation, Publication, Experience</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In search of new sites for activities, I drew attention to the ‚Äúwidgets‚Äù of chrome, which I have been using for a long time, but never gave them any m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Chromium Extension: Creation, Publication, Experience</h1><div class="post__text post__text-html js-mediator-article">  In search of new sites for activities, I drew attention to the ‚Äúwidgets‚Äù of chrome, which I have been using for a long time, but never gave them any meaning.  Immediately I wanted to try to implement something. <br><br>  The idea was to create a task manager for the developer (and not only) that would be always at hand.  It should display the actual tickets <i>trello</i> and <i>jira</i> , requests in <i>gitlab</i> , etc.  These are the things that I usually searched for by typing keywords in the browser address bar, such as "jira PM-20". <br><br><img src="https://habrastorage.org/webt/uk/1y/qz/uk1yqzybao8vdhc0styudgtb9r0.png"><br>  <font color="gray"><i>Chrome extension</i></font> <br><a name="habracut"></a><br>  I knew for sure that extensions in browsers are normal html pages, fed by js scripts.  But at the same time he had no idea how to create them.  The first thing that gave me Google on this issue is <a href="https://medium.freecodecamp.org/how-to-create-and-publish-a-chrome-extension-in-20-minutes-6dc8395d7153">an article in the medium</a> , and not official documentation.  It was even better, because  This was a review article of the simplest widget from idea to publication. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The article gave me an idea that the development of the "widget" is not too tricky.  I immediately started creating "hello world!". <br><br><h1>  Structure </h1><br><img src="https://habrastorage.org/webt/qy/ur/1k/qyur1knwe_yms0xfwkfgshzy63a.png"><br><br>  It turned out that you need to create <i>mainfest.json</i> at the root of the project.  It describes the extension: name, description, author, icons, permissions, etc.  I did the first version without studying the documentation. <br><br><img src="https://habrastorage.org/webt/ui/yf/q5/uiyfq5fyk9jngrs9wct5qfyf7sg.png"><br>  <font color="grey"><i>First manifest.json</i></font> <br><br>  Extensions allow you to run js scripts in the background, which do something even when the user does not use them.  I felt this functionality very superficially, just to understand how it can work.  He just changed the title in the &lt;h1&gt; widget. <br><br>  Of interest to me was the html page itself, which is shown when I click on the icon in the browser, it is called <i>popup.html</i> in my manifest. <br><br>  This page, by the way, can be opened in a browser like any other website, only as a ‚Äúprotocol‚Äù there will be a chrome-extension, for example <font color="blue"><i>chrome-extension: //id- widget- in- webstore/popup.html</i></font> .  Thus, you can view the source code of any extension that you have installed. <br><br>  It works in the same way as any web site, except for a couple of possibilities, for example: following links only work with <i>target = "_ blank"</i> .  There are also technical limitations managed by the developer, such as the <i>Content Security Policy</i> or <i>permissions</i> to the browser functionality that are requested from the user. <br><br><h1>  Run extension </h1><br>  After creating a folder with <i>manifest.json</i> and <i>popup.html</i> inside, you can already run it as a widget.  On the <i>chrome: // extensions chrome</i> service page there is a <i>Download unpacked extension</i> button.  Use it to select a folder. <br><br><img src="https://habrastorage.org/webt/jg/nc/ha/jgnchavdydr1i6hp1ymjeawu3w4.png"><br><br>  and the extension is immediately displayed in the list of ‚Äúwidgets‚Äù next to the address bar. <br><br>  From this point on, the extension can already be tested: change <i>popup.html</i> , and see the changes by rediscovering the ‚Äúwidget‚Äù by clicking on its icon. <br><br><h1>  Publish to webstore </h1><br>  To begin with, the possibility of publishing the first 20 extensions costs <b>$ 5</b> .  It occurs in the webstars <a href="https://chrome.google.com/webstore/developer/dashboard">dashboard</a> , for this you will need to upload a zip-archive of the contents of the extension folder and work on advertising texts and pictures. <br><br><img src="https://habrastorage.org/webt/hi/wi/mx/hiwimxrg4wexfpgqrokedvq3qnm.png"><br>  <font color="grey"><i>Preparing for the publication of the extension</i></font> <br><br>  The first part of the description of the extension will be displayed from the <i>description</i> property of the extension manifest, the rest is added to Detailed description in the extension management on the webstore. <br><br>  The extension has flexible publishing options: you can select regions of the world to publish, as well as the visibility of the extension. <br><br><img src="https://habrastorage.org/webt/tm/uq/ly/tmuqlyxnqnmgrpm0znpaatcubru.png"><br><br>  It must be remembered that if you choose only RF for publication, the expansion will not appear in other countries.  I came across it while in Thailand: I could not understand why, after 2 days, the extension is not being searched for in the store, even by its direct name. <br><br><h1>  Advanced options </h1><br>  I have described the necessary steps for publishing the simplest extension so that the process is understandable.  Now I want to highlight some of the details for writing a more complex ‚Äúwidget‚Äú. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qq/gw/_j/qqgw_jneinomo-x5se1kxul67qk.png"></div><br>  The essence of my expansion is in using foreign APIs for getting information.  For this, I need at least localStorage to remember authorization tokens. <br><br>  I used <i>"permissions": ["storage"]</i> in my manifest. <br><br><h2>  Oauth2 </h2><br>  In most cases, API developers propose an OAuth2 protocol for authorization. <br><br>  If you are not familiar with this protocol: it offers a secure process of authentication and authorization of the application on behalf of the user without access to the login / password by this application. <br><br>  The protocol describes several <a href="https://tools.ietf.org/html/rfc6749">methods for authorization</a> .  Ideally, use <b>Authorization Code Flow,</b> which assumes <i>that</i> the application has a <i>backend</i> ;  The API redirects the user with the Auth code to the application, and the application on the backend exchanges it for a token. <br><br>  There is also a simplified <i>Implicit Flow</i> , which allows you to log in without a backend: API, after logging in, redirects the user to an application with a token in the URL. <br><br>  How to use this ‚Äúredirect‚Äù authorization in chromium expansion?  Start a website?  It turns out that not necessarily. <br><br><h3>  My crutches </h3><br>  Initially, I undertook to integrate with Gitlalb and Trello.  With Gitlab, everything turned out to be ‚Äúsimple‚Äù: you send the user to the admin area of ‚Äã‚Äãhis Gitlab so that he can make the token and give it to you.  I didn‚Äôt have to bother with this approach for a long time, I just made a field for entering a token and described how to get it. <br><br>  Trello provided OAuth2, I immediately noticed that it has an <i>implicit flow</i> , but a bit strange: the token is displayed on their / approve page in this form <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ob/km/s3/obkms3gmcyih9glliorcwlcyk6y.png"></div><br>  Without becoming deep, I also made a token input field in my extension and described to the user how to do it. <br><br><h3>  The right way </h3><br>  As usual, a good decision does not come immediately.  I stumbled upon it when I started integrating with Jira, which has only Authorization Code Flow. <br><br>  Somehow I accidentally stumbled upon <a href="https://developer.chrome.com/apps/identity">chrome.identity</a> : browser functionality, which has already implemented all the crutches for authorization.  This functionality requires the inclusion of <i>identity</i> in the manifest permissions.  I added my manifest: <i>"permissions": ["storage", "identity"]</i> . <br><br>  As I already said: each extension has a URL of the <i>chrome-extension type: // &lt;id&gt; /</i> .  This address is not suitable for anything, but <i>chrome.identity</i> provides the real URL <font color="blue"><i>https: // &lt;app-id&gt; .chromiumapp.org / *</i></font> , which can be passed to the API with OAuth2 as the redirectUrl.  The API, after authorization, will send the user to it with additional parameters, be it authCode or token, and chrome will pick them up and pass them to your js-callback extensions. <br><br>  To do this, use chrome.identity.launchWebAuthFlow (), which opens the API authorization page in a new window: <br><br><pre><code class="plaintext hljs">chrome.identity.launchWebAuthFlow( { 'url': JiraApi.url(), 'interactive': true }, jira.callback() );</code> </pre> <br>  Immediately I will say: this window does not look quite like the window of the main browser, which would have raised questions for me if I were a regular user, since  it looks like a phishing block, not a window.  Maybe this is just my perception, it can only be so in my <abbr title="Linux mint">OS</abbr> . <br><br><img src="https://habrastorage.org/webt/4i/n5/ld/4in5ldmxa9aanys9f9oq2bwdo2u.png"><br>  <font color="gray"><i>Login window chrome.identity.launchWebAuthFlow</i></font> <br><br><h2>  Other options </h2><br>  When there is an idea to implement any functionality, I recommend google chrome API, since  it already has a lot of similar features that will facilitate your work.  For example, the full <a href="https://developer.chrome.com/apps/manifest">manifest.json is</a> impressive: <br><br><pre> <code class="plaintext hljs">{ // Required "app": { "background": { // Optional "scripts": ["background.js"] } }, "manifest_version": 2, "name": "My App", "version": "versionString", // Recommended "default_locale": "en", "description": "A plain text description", "icons": {...}, // Optional "action_handlers": ["new_note"], "author": ..., "automation": ..., "bluetooth": { "uuids": ["1105", "1006"] }, "commands": {...}, "current_locale": ..., "event_rules": [{...}], "externally_connectable": { "matches": ["*://*.example.com/*"] }, "file_handlers": {...}, "file_system_provider_capabilities": { "configurable": true, "multiple_mounts": true, "source": "network" }, "import": [{"id": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"}], "key": "publicKey", "kiosk": { "always_update": ..., "required_platform_version": ... }, "kiosk_enabled": true, "kiosk_only": true, "kiosk_secondary_apps": ..., "minimum_chrome_version": "versionString", "nacl_modules": [...], "oauth2": ..., "offline_enabled": true, "optional_permissions": ["tabs"], "permissions": ["tabs"], "platforms": ..., "requirements": {...}, "sandbox": [...], "short_name": "Short Name", "signature": ..., "sockets": { "tcp": { "connect": "*" }, "udp": { "send": "*" } }, "storage": { "managed_schema": "schema.json" }, "system_indicator": ..., "update_url": "http://path/to/updateInfo.xml", "url_handlers": {...}, "usb_printers": { "filters": [...] }, "version_name": "aString", "webview": {...} }</code> </pre><br>  Pre-dealing with all the possibilities may be too wasteful, because  their huge amount. <br><br>  Moreover, only the js-side of the expansion itself can increase to large sizes. <br><br><img src="https://habrastorage.org/webt/ei/k1/9y/eik19yftcv2f-rm1uodd98dpblo.png"><br>  <font color="gray"><i>My current scheme</i></font> <br><br><h1>  Promotion </h1><br>  Little is worth mentioning the promotion of its expansion.  A feature of the "widgets" is that they are aimed at desktop users who in recent years have become a minority. <br><br>  I tried contextual advertising and advertising in social networks.  Got a little experience and zero conversion. <br><br><h2>  contextual advertising </h2><br>  My experience has so far limited itself to one site, I cannot speak for the others, but I think the same is there. <br><br>  It turns out that in the contextual advertising of Yandex, you cannot target by devices and browsers.  So if your extension is only for chrome, you‚Äôll also have to show ads to people sitting on other browsers, whose transitions will bring only unnecessary losses. <br><br>  I did not want to make a separate site for my extension, so I advertised its page in the webstore.  The disadvantage of this approach is that you can only trust the statistics of the advertising account and cannot see how users behave on the advertised page. <br><br><h2>  Social networks </h2><br>  They just belong to the category of sites on which the desktop is a dying minority. <br><br>  Vkontakte provides mobile and full version targeting of its site.  But this tick is hidden at the very end of the settings, I personally did not notice it before I leaked the budget and saw sad statistics in the statistics. <br><br><img src="https://habrastorage.org/webt/uv/8-/ck/uv8-ckxr9iw4i_znpploac-1cyy.png"><br><br>  In fact, that day mobile views were much more <br><br><h1>  Last thoughts </h1><br>  I believe that expansion is a powerful tool for people working on the Internet, because  in the browser we spend a lot of time, which sometimes we want to optimize.  For example, a Google translator widget that translates text when selected is a good optimization example.  I also decided to solve the problem of a huge number of open tabs ‚Äúlater‚Äù using a widget. <br><br>  Writing extensions gives you experience in exploring the underwater part of the iceberg ‚ÄúChrome‚Äù and writing the ‚Äúfrontend‚Äù (especially if you are a backend developer).  Extensions can be written on the same React JS from which you can jump on writing applications for mobile devices.  The process of writing is very similar. </div><p>Source: <a href="https://habr.com/ru/post/431830/">https://habr.com/ru/post/431830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431818/index.html">Compare PHP FPM, PHP PPM, Nginx Unit, React PHP and RoadRunner</a></li>
<li><a href="../431820/index.html">Start to the ISS and braking at the asteroid</a></li>
<li><a href="../431822/index.html">De facto closed source: arguments in favor of understandable software</a></li>
<li><a href="../431824/index.html">On the website ‚ÄúM.Video‚Äù accidentally opened information on the smartphone from ‚ÄúYandex‚Äù a few days before the presentation.</a></li>
<li><a href="../431828/index.html">Digital events in Moscow from December 3 to 9</a></li>
<li><a href="../431832/index.html">Technical interakty on fantastic conventions. Part 1</a></li>
<li><a href="../431834/index.html">More coffee, less caffeine: Intel 9th ‚Äã‚ÄãGen (part 4)</a></li>
<li><a href="../431836/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ341 (November 26 - December 2, 2018)</a></li>
<li><a href="../431838/index.html">3CX WebMeeting Video Conferencing - The Complete Guide</a></li>
<li><a href="../431840/index.html">Created the first modular vinyl player printed on a 3D printer; a DIY kit is planned to be mass-produced.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>