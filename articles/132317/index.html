<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fluent Interface Organization in Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspired by a recent post about flowing interfaces in PHP , I immediately wondered how you could implement this on a python easier and more beautiful ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fluent Interface Organization in Python</h1><div class="post__text post__text-html js-mediator-article">  Inspired by a recent post about <a href="http://habrahabr.ru/blogs/php/132115/">flowing interfaces in PHP</a> , I immediately wondered how you could implement this on a python easier and more beautiful (on a python everything is always easier and more beautiful).  I offer several ways in the order of receipt of thoughts. <br><br><img src="https://habrastorage.org/storage1/267e1293/76482eb8/1c03ef31/cb97e1b5.jpg"><br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Method one - in the forehead </h4><br>  To build a chain of operators, we need the function to return an instance of the class.  This can be manually set. <br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,x)</span></span></span><span class="hljs-function">:</span></span> self.val += x <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self</code> </pre> <br><br>  Obviously, this approach works perfectly, but we are looking for a little more. <br><br><h4>  Method two - decorators </h4><br>  This is the first idea that came to mind.  Define a decorator for methods in the class.  We are very good that the instance is passed by the first argument. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chained</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(fn)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*args,**kwargs)</span></span></span><span class="hljs-function">:</span></span> fn(*args,**kwargs) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> args[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsefulClass1</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val = val @chained <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val += val @chained <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val *= val</code> </pre><br><br>  Simply mark the functions to be used in the chain with the decorator.  The return value is ignored and an instance of the class is passed instead. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> UsefulClass1(<span class="hljs-number"><span class="hljs-number">10</span></span>).add(<span class="hljs-number"><span class="hljs-number">5</span></span>).mul(<span class="hljs-number"><span class="hljs-number">10</span></span>).add(<span class="hljs-number"><span class="hljs-number">1</span></span>).val <span class="hljs-number"><span class="hljs-number">151</span></span></code> </pre><br><br>  The method is clearly more readable - you can immediately see which functions can be used in the chain.  However, usually the architectural approach extends to most class methods, which are not interesting to mark one by one. <br><br><h4>  Method three - automatic </h4><br>  We can check the return value when calling a function.  In the absence thereof, we transfer the object itself.  We will do this through __getattribute__, which intercepts any access to the methods and fields of the class.  To begin with, we simply define a class with similar behavior; all working classes will inherit from it. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> types <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MethodType <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Chain</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__getattribute__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,item)</span></span></span><span class="hljs-function">:</span></span> fn = object.__getattribute__(self,item) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fn <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> type(fn)==MethodType: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chained</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*args,**kwargs)</span></span></span><span class="hljs-function">:</span></span> ans = fn(*args,**kwargs) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ans <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ans!=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> self <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> chained <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fn <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsefulClass2</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Chain)</span></span></span><span class="hljs-class">:</span></span> val = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val += val <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val *= val <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">third</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">386</span></span></code> </pre><br><br>  If the method returns a value, it is passed.  If not, then an instance of the class goes instead. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> UsefulClass2().add(<span class="hljs-number"><span class="hljs-number">15</span></span>).mul(<span class="hljs-number"><span class="hljs-number">16</span></span>).add(<span class="hljs-number"><span class="hljs-number">-5</span></span>).val <span class="hljs-number"><span class="hljs-number">251</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> UsefulClass2().third() <span class="hljs-number"><span class="hljs-number">386</span></span></code> </pre><br><br>  Now we don‚Äôt need to modify the working class in any way except for specifying the chain class as one of the parent classes.  The obvious drawback is that we cannot use __getattribute__ for our own purposes. <br><br><h4>  Method Four - Im So Me Meta ... </h4><br>  We can use the metaclass to organize the necessary wrapper of the working class.  When initializing the latter, we will wrap __getattribute__ on the fly (and its absence doesn‚Äôt bother us either). <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> types <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MethodType <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MetaChain</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(type)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls,name,bases,dict)</span></span></span><span class="hljs-function">:</span></span> old = dict.get(<span class="hljs-string"><span class="hljs-string">'__getattribute__'</span></span>,object.__getattribute__) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_getattribute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inst,val)</span></span></span><span class="hljs-function">:</span></span> attr = old(inst,val) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> attr==<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> inst <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> attr <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> type(attr)==MethodType: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*args,**kwargs)</span></span></span><span class="hljs-function">:</span></span> ans = attr(*args,**kwargs) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ans <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ans!=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> inst <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> attr dict[<span class="hljs-string"><span class="hljs-string">'__getattribute__'</span></span>] = new_getattribute <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> type.__new__(cls,name,bases,dict) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsefulClass3</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> __metaclass__ = MetaChain <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__getattribute__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,item)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> item==<span class="hljs-string"><span class="hljs-string">"dp"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">493</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> object.__getattribute__(self,item) val = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val += val <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val *= val</code> </pre><br><br>  It practically does not differ from the previous version - we only control the creation of __getattribute__ with the help of the metaclass.  For a working class wrapper, just enter __metaclass__. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> UsefulClass3().dp <span class="hljs-number"><span class="hljs-number">493</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> UsefulClass3().add(<span class="hljs-number"><span class="hljs-number">4</span></span>).mul(<span class="hljs-number"><span class="hljs-number">5</span></span>).add(<span class="hljs-number"><span class="hljs-number">1</span></span>).mul(<span class="hljs-number"><span class="hljs-number">25</span></span>).add(<span class="hljs-number"><span class="hljs-number">-1</span></span>).val <span class="hljs-number"><span class="hljs-number">649</span></span></code> </pre><br><br>  As you can see, the existing __getattribute__ in the working class works.  When inheriting from the working class, the behavior is preserved - __getattribute__ is also inherited.  If the native __getattribute__ does not return anything (even AttributeError), then we also return the object itself. <br><br><h4>  Instead of conclusion </h4><br>  Although the widespread use of fluid interfaces is doubtful, there are still cases when such structures will be appropriate.  Say, for example, image processing or any entities over which a number of operations are performed. <br><br>  <b>PS</b> The last option, in my opinion, does not contain obvious flaws.  If anyone can offer the best option - I will be glad to hear, as well as pointing out my flaws. <br><br>  <b>PPS</b> At the request of workers links to <a href="http://habrahabr.ru/blogs/php/132115/">the article</a> and <a href="http://ru.wikipedia.org/wiki/Fluent_interface">description on Wikipedia</a> <br><br>  <b>Update</b> <br><br><h4>  Method Five - hot and hearth </h4><br>  Tov.  <a href="http://habrahabr.ru/users/davinchi/" class="user_link">davinchi</a> rightly pointed out that wrapping on every call is at least strange.  Plus to this, we with each reference to the fields of the object run the check. <br>  Now we will process all methods at once, but we will check the modification and creation of methods in order to wrap them. <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewMetaChain</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(type)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls,name,bases,dict)</span></span></span><span class="hljs-function">:</span></span> old = dict.get(<span class="hljs-string"><span class="hljs-string">'__setattr__'</span></span>,object.__setattr__) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wrap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(fn,inst=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*args,**kwargs)</span></span></span><span class="hljs-function">:</span></span> ans = fn(*args,**kwargs) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ans <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ans!=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> inst <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> args[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new special = dir(cls) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item, fn <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dict.items(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> special <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> isinstance(fn,FunctionType): dict[item] = wrap(fn) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_setattr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inst,item,val)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isinstance(val,FunctionType): val = wrap(val,inst) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> old(inst,item,val) dict[<span class="hljs-string"><span class="hljs-string">'__setattr__'</span></span>] = new_setattr <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> type.__new__(cls,name,bases,dict) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsefulClass4</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> __metaclass__ = NewMetaChain <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__setattr__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,item,val)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> val == <span class="hljs-number"><span class="hljs-number">172</span></span>: val = <span class="hljs-string"><span class="hljs-string">"giza"</span></span> object.__setattr__(self, item, val) val = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val += val <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self,val)</span></span></span><span class="hljs-function">:</span></span> self.val *= val <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Besides the fact that we do not wrap methods every time we call (which yielded ~ 30% gain in speed), we still do the necessary checks not on every read of the object fields, but on each record (which happens less often).  If there is no record, it works as fast as the decorator method. </div><p>Source: <a href="https://habr.com/ru/post/132317/">https://habr.com/ru/post/132317/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132309/index.html">TELESAR V - robot for telebeeting</a></li>
<li><a href="../132312/index.html">About unnecessary Spanning Tree</a></li>
<li><a href="../132313/index.html">Cmake - we collect portable applications for Mac Os X and Windows</a></li>
<li><a href="../132314/index.html">Observable.Generate and list listings</a></li>
<li><a href="../132315/index.html">Automatic collection and archiving of photo / video surveillance</a></li>
<li><a href="../132318/index.html">Facebook flight search app</a></li>
<li><a href="../132319/index.html">European investors rules</a></li>
<li><a href="../132320/index.html">Let's hit gadgets on illiteracy (extension for Google Chrome)</a></li>
<li><a href="../132321/index.html">TeamLab CRM Beta - sellers to note: use yourself for a profit, to us for testing</a></li>
<li><a href="../132322/index.html">The final day of the TechEd 2011 conference. Live broadcast of the second day</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>