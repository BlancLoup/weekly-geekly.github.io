<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Javascript panopticon</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the time that I happened to write in Javascript, I got the image that js and its specification is a casket with a secret bottom. Sometimes it s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Javascript panopticon</h1><div class="post__text post__text-html js-mediator-article"><p>  During the time that I happened to write in Javascript, I got the image that js and its specification is a casket with a secret bottom.  Sometimes it seems that there is nothing secret about it, when suddenly the magic knocks into your house: the casket opens, devils jump out, the blues play at home, and briskly hide in the casket.  Later you will know the reason: the table led and the casket tilted by 5 degrees, which caused devils.  Since then, you do not know if this is a feature of the box, or better still, wrap it up with tape.  And so on until the next time, until the casket gives a new story. </p><br><p>  And if you write down every such story, you may have a small article that I want to share. </p><a name="habracut"></a><br><h3 id="summa-pustot">  "The amount of voids" </h3><br><p> When merging an array into a string using the <code>.join()</code> method, some empty types: null, undefined, an array with zero length are converted to an empty string.  And this is true only for the case when they are located in an array. </p><br><pre> <code class="javascript hljs">[<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, []].join(<span class="hljs-string"><span class="hljs-string">""</span></span>) == <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-comment"><span class="hljs-comment">// =&gt; true [void 0, null, []].join("") === "" // =&gt; true //      . void 0 + "" // =&gt; "undefined" null + "" // =&gt; "null" [] + "" // =&gt; ""</span></span></code> </pre> <br><p>  In practice, this behavior can be used to screen out really empty data. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isEmpty = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b, c</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ![a, b, c].join(<span class="hljs-string"><span class="hljs-string">""</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isEmpty = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">...rest</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !rest.join(<span class="hljs-string"><span class="hljs-string">""</span></span>); } isEmpty(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, [], <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-comment"><span class="hljs-comment">// =&gt; true isEmpty(void 0, [], null, 0) // =&gt; false isEmpty(void 0, [], null, {}) // =&gt; false.        //  ,      var isEmpty = (arg) =&gt; { return !([arg] + ""); } isEmpty(null) // =&gt; true isEmpty(void 0) // =&gt; true isEmpty(0) // =&gt; false</span></span></code> </pre> <br><h3 id="strannye-chisla">  "Strange Numbers" </h3><br><p>  Attempting to define types for <code>NaN</code> and <code>Infinity</code> using the <code>typeof</code> operator as the result will return "number" </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> <span class="hljs-literal"><span class="hljs-literal">NaN</span></span> <span class="hljs-comment"><span class="hljs-comment">// =&gt; "number" typeof Infinity// =&gt; "number" !isNaN(Infinity) // =&gt; true</span></span></code> </pre> <br><p>  The humor is that NaN is short for "Not-A-Number", and infinity ( <code>Infinity</code> ) is hardly a number. </p><br><p>  How, then, to determine the numbers?  Check out their limb! </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">isFinite</span></span>(n); } isNumber(<span class="hljs-built_in"><span class="hljs-built_in">parseFloat</span></span>(<span class="hljs-string"><span class="hljs-string">"mr. Number"</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// =&gt; false isNumber(0) // =&gt; true isNumber("1.2") // =&gt; true isNumber("abc") // =&gt; false isNumber(1/0) // =&gt; false</span></span></code> </pre> <br><h3 id="dlya-otstrela-nogi-vozmite-obekt">  "To shoot the feet, take the object" </h3><br><p>  For javascript, <code>Object</code> is one of the very first data structures and at the same time, in my opinion, is the king of the intricacies. </p><br><p>  For example, bypassing an object used as a hash table in a loop, it is advisable to check that the properties being iterated are proper. </p><br><p>  Otherwise, the properties from the extension of the prototype can get into the iteration. </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.prototype.theThief = <span class="hljs-string"><span class="hljs-string">" "</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.prototype.herLover = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">theCook</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">hisWife</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> prop <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> obj) { obj[prop]; <span class="hljs-comment"><span class="hljs-comment">//  : " ", "", " ", "" if (!obj.hasOwnProperty(prop)) continue; obj[prop]; //  : " ", "" }</span></span></code> </pre> <br><p>  Meanwhile, an <code>Object</code> can be created without prototype inheritance. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//      var obj = Object.create(null); obj.key_a = "value_a"; obj.hasOwnProperty("key_a") // =&gt;  .</span></span></code> </pre> <br><p>  "Hey, cap, why do you need it?" </p><br><p>  In such a hash, there are no inherited keys ‚Äî only private keys (hypothetical memory savings).  So, designing APIs to libraries, where the user is allowed to transfer his own data collections, it is easy to forget about it - thereby shooting yourself in the foot. </p><br><p>  And since in this case you cannot control the input data, you need a universal way to check your own keys in the object. </p><br><p>  <strong>Method one.</strong>  You can get all the keys.  Suboptimal if you run <code>indexOf</code> inside a loop: an extra array traversal. </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.keys(obj); // =&gt; ["key_a"]</code> </pre> <br><p>  <strong>The second way</strong> .  Call the <code>hasOwnProperty</code> method with a modified context </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.prototype.hasOwnProperty.<span class="hljs-keyword"><span class="hljs-keyword">call</span></span>(obj, "key_a") // =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre> <br><p>  It would seem that here is the perfect way.  But, Internet Explorer. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   IE //     var obj = Object.create(null); obj[0] = "a"; obj[1] = "b"; obj[2] = "c"; Object.prototype.hasOwnProperty.call(obj, 1); // =&gt; false Object.prototype.hasOwnProperty.call(obj, "1"); // =&gt; false Object.keys(obj); // =&gt; ["0", "1", "2"] obj.a = 1; Object.prototype.hasOwnProperty.call(obj, 1); // =&gt; true Object.prototype.hasOwnProperty.call(obj, "1"); // =&gt; true //        Object obj = Object.create(Object.prototype); obj["2"] = 2; obj.hasOwnProperty("2"); // =&gt; false obj.a = "a"; obj.hasOwnProperty("2"); // =&gt; true delete obj.a; obj.hasOwnProperty("2"); // =&gt; false</span></span></code> </pre> <br><p>  It did not seem to you, IE really refuses to check digital keys in objects created through <code>Object.create()</code> , until at least one lowercase <code>Object.create()</code> appears in it. </p><br><p>  And this fact spoils the whole holiday. </p><br><p>  <strong>UPD:</strong> <br>  <a href="">Solution</a> proposed by Dmitry Korobkin </p><br><p>  <strong>UPD:</strong> <br>  <a href="https://habrahabr.ru/users/bingo347/" class="user_link">bingo347</a> rightly noted that if you do not write scripts for "dinosaurs", then it is more expedient to perform a search of your own properties using <code>Object.keys(obj)</code> and <code>Object.getOwnPropertyNames(obj)</code> </p><br><p>  But, it should be borne in mind that <code>getOwnPropertyNames</code> returns all its own keys, even those that are non-removable. </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]); <span class="hljs-comment"><span class="hljs-comment">// =&gt; ["0", "1", "2"] Object.getOwnPropertyNames([1, 2, 3]); // =&gt; ["0", "1", "2", "length"]</span></span></code> </pre> <br><h3 id="lzhe-undefined">  "False undefined" </h3><br><p>  Often developers check variables for undefined by direct comparison. </p><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arg</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arg === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>; <span class="hljs-comment"><span class="hljs-comment">// =&gt; true })();</span></span></code> </pre> <br><p>  Do the same with assignment </p><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">"undefined"</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> } })();</code> </pre> <br><p>  "Ambush" lies in the fact that undefined can be overridden </p><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arg</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> = <span class="hljs-string"><span class="hljs-string">"Happy debugging m[\D]+s!"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">"undefined"</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-string"><span class="hljs-string">"arg"</span></span>: arg, <span class="hljs-string"><span class="hljs-string">"arg === undefined"</span></span>: arg === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-comment"><span class="hljs-comment">// =&gt; false }; })();</span></span></code> </pre> <br><p>  This knowledge deprives you of sleep: it turns out that you can break the whole project by simply overriding undefined inside the circuit. </p><br><p>  But there are a couple of reliable ways to compare or assign undefined - use the <code>void</code> operator or declare an empty variable. </p><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arg</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> = <span class="hljs-string"><span class="hljs-string">"Happy debugging!"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">"void 0"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"arg"</span></span>: arg, <span class="hljs-string"><span class="hljs-string">"arg === void 0"</span></span>: arg === <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">// =&gt; true }; })(); ((arg) =&gt; { var undef, undefined = "Happy!"; return { "undef": undef, "arg": arg, "arg === undef": arg === undef // =&gt; true }; })();</span></span></code> </pre> <br><h3 id="sravnenie-shryodingera">  Schr√∂dinger Comparison </h3><br><p>  Once colleagues shared with me an interesting anomaly. </p><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-comment"><span class="hljs-comment">// false 0 &gt; null; // false 0 == null; // false 0 &lt;= null; // true 0 &gt;= null // true</span></span></code> </pre> <br><p>  This happens because the more-less comparison is a numerical comparison, where both parts of the expression are reduced to a number. </p><br><p>  While equality of numbers with null always returns false. </p><br><p>  If we take into account that null becomes +0 after being cast to a number, the comparison inside the compiler looks approximately like this: </p><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">0</span></span> &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// false 0 &gt; 0; // false 0 == null; // false 0 &lt;= 0; // true 0 &gt;= 0 // true</span></span></code> </pre> <br><h3 id="sravnenie-chisel-s-boolean">  Comparing Numbers with Boolean </h3><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">-1</span></span> == <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">// =&gt; false -1 == true; // =&gt; false</span></span></code> </pre> <br><p>  In javascript, when comparing <code>Number</code> with <code>Boolean</code> , the latter is reduced to a number, after that, Number == Number is compared. </p><br><p>  And, since <code>false</code> reduced to +0, and <code>true</code> reduced to +1, the comparison inside the compiler takes the form: </p><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">-1</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">// =&gt; false -1 == 1 // =&gt; false</span></span></code> </pre> <br><p>  But. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-string"><span class="hljs-string">"true"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// =&gt; "true" if (0) "false"; // =&gt; undefined if (1) "true"; // =&gt; "true" if (NaN) "false"; // =&gt; undefined if (Infinity) "true" // =&gt; "true"</span></span></code> </pre> <br><p>  Because 0 and NaN always result in false, everything else is true. </p><br><h3 id="proverka-na-massiv">  Check for array </h3><br><p>  In JS, <code>Array</code> inherited from <code>Object</code> and, in fact, are objects with numeric keys. </p><br><pre> <code class="hljs ruby">typeof {<span class="hljs-symbol"><span class="hljs-symbol">a:</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>}; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"object"</span></span> typeof [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"object"</span></span> Array.isArray([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br><p>  The thing is that <code>Array.isArray()</code> only works since IE9 + </p><br><p>  But there is another way </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.prototype.toString.<span class="hljs-keyword"><span class="hljs-keyword">call</span></span>([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]); // =&gt; "[object Array]" //  <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> isArray(arr) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.prototype.toString.<span class="hljs-keyword"><span class="hljs-keyword">call</span></span>(arr) == "[object Array]"; } isArray([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]) // =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre> <br><p>  In general, using <code>Object.prototype.toString.call(something)</code> you can get many other types. </p><br><p>  <strong>UPD:</strong> <br>  <a href="https://habrahabr.ru/users/boldyrev_gene/" class="user_link">boldyrev_gene</a> asked, in my opinion, a good question: why not use <code>instanceof</code> ? </p><br><p>  Array instances created inside frames and other windows will have different constructor instances. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iframe = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"iframe"</span></span>), IframeArray = iframe.contentWindow.Array; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IframeArray() <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>; <span class="hljs-comment"><span class="hljs-comment">// =&gt; false Array.isArray(new IframeArray()); // =&gt; true Object.prototype.toString.call(new IframeArray()); // =&gt; "[object Array]"</span></span></code> </pre> <br><h3 id="arguments--ne-massiv">  arguments is not an array </h3><br><p>  I often forget about it so much that I even decided to write it out. </p><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>, <span class="hljs-comment"><span class="hljs-comment">// =&gt; "object" Array.isArray(arguments), // =&gt; false Object.prototype.toString.call(arguments) // =&gt; "[object Arguments]"; ]; })(1, 2, 3);</span></span></code> </pre> <br><p>  And since arguments is not an array, the usual methods <code>.push()</code> , <code>.concat()</code> , etc. are not available in it. And if we need to work with arguments as a collection, there is a solution: </p><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.prototype.slice.call(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    return [ typeof arguments, // =&gt; "object" Array.isArray(arguments), // =&gt; true Object.prototype.toString.call(arguments) // =&gt; "[object Array]"; ]; })(1, 2, 3);</span></span></code> </pre> <br><h3 id="a-vot-rest--massiv">  but ... rest is an array </h3><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">...rest</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.isArray(rest) <span class="hljs-comment"><span class="hljs-comment">// =&gt; true. Oh, wait... })(1, 2, 3);</span></span></code> </pre> <br><h3 id="poymat-global-ili-opredelyaem-sredu-vypolneniya-skripta">  Catch global.  Or we define the script execution environment. </h3><br><p>  When building isomorphic libraries, for example, from a number of those that are collected via a Webpack, sooner or later, it becomes necessary to determine in which environment the script is running. </p><br><p>  And since JS does not provide a mechanism for defining a runtime environment at the standard library level, you can make a feint using the behavior of the pointer inside anonymous functions in a nonstrict mode. </p><br><p>  In anonymous functions, the <code>this</code> pointer refers to the global object. </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEnv</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> type = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.prototype.toString.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-string"><span class="hljs-string">"[object Window]"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"browser"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-string"><span class="hljs-string">"[object global]"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"nodejs"</span></span>; })(); };</code> </pre> <br><p>  However, in strict mode, <code>this</code> is undefined, which breaks the way.  This method is relevant if <code>global</code> or <code>window</code> declared manually and globally - protection from "tricky" libraries. </p><br><hr><br><p>  Thanks for attention!  I hope someone will find these notes useful and useful. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/313196/">https://habr.com/ru/post/313196/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313182/index.html">On the issue of style</a></li>
<li><a href="../313184/index.html">There are still few female executives in the IT industry.</a></li>
<li><a href="../313188/index.html">Cybergrouping Sednit activities under the microscope</a></li>
<li><a href="../313192/index.html">How to make a server room with your own hands</a></li>
<li><a href="../313194/index.html">Social Architecture: stratagems for success in open source projects</a></li>
<li><a href="../313202/index.html">What are the prospects for the ‚Äúunfashionable‚Äù .NET platform - expert opinions</a></li>
<li><a href="../313206/index.html">Cach√© Localization Manager or i18n in InterSystems Cach√©</a></li>
<li><a href="../313208/index.html">JsTree - building a simple tree using JAVA</a></li>
<li><a href="../313210/index.html">We test not absolutely real (or absolutely unreal) monitoring from New Relic and Appdynamics</a></li>
<li><a href="../313212/index.html">Blockchain ‚â† Cryptocurrency. Blockchain> Cryptocurrency</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>