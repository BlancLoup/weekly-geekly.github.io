<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cloning the system disk using regular Linux tools in 30 seconds</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="They brought me the other day the hard drive right in the package and puzzled us with the operational cloning of the system disk of one of the servers...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cloning the system disk using regular Linux tools in 30 seconds</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/5c7/928/314/5c7928314092652ee20cb0b1478db521.jpg"><br>  They brought me the other day the hard drive right in the package and puzzled us with the operational cloning of the system disk of one of the servers.  The task is, on the whole, rather trivial, and easily doable.  Everyone probably has a technique of this kind of action, I don‚Äôt know better or worse my approach, but I think they should share this. <br>  <u>Introductory:</u> <br>  * <b>linux</b> server <br>  * <u>all</u> partitions on <b>XFS</b> <br>  * <b>GRUB 0.97</b> bootloader <br>  * original disk <b>/ dev / sda</b> , clone to <b>/ dev / sdb</b> <br>  * sections / dev / sda [1,5-7] (general useful information ~ 1GB) <br><br><a name="habracut"></a><br>  In essence, the task is decomposed into its components: <br>  - mark up the new disc as well as the original <br>  - copy data to a new disk <br>  - make a new disk bootable <br>  And this is how it is done: <br><blockquote>  sfdisk -d / dev / sda |  sfdisk / dev / sdb <br>  xfs_copy / dev / sda1 / dev / sdb1 <br>  xfs_copy / dev / sda5 / dev / sdb5 <br>  xfs_copy / dev / sda6 / dev / sdb6 <br>  xfs_copy / dev / sda7 / dev / sdb7 <br>  grub <br>  &gt; root (hd1,0) <br>  &gt; setup (hd1) <br></blockquote><br>  Done!  By time ~ <b>30 seconds</b> . <br><br>  Now in detail with explanations: <br>  1. Copying the partition table to / dev / sdb is done with sfdisk <br>  2. xfs_copy copies useful data and, if necessary, automatically formats partitions that wish to remount partitions in readonly or use xfs_freeze while copying to preserve data integrity. <br>  3. The grub configuration (version <b>0.97!</b> ) In /boot/grub/menu.lst should look something like this: <br><pre> default 0
 timeout 5
 color cyan / blue white / blue
 title Debian GNU / Linux, kernel 2.6.30-2-686
 root (hd0,0)
 kernel /boot/vmlinuz-2.6.30-2-686 root = / dev / sda1 ro
 initrd /boot/initrd.img-2.6.30-2-686
</pre>  With the grub - root, setup commands we make the second disk bootable. <br>  4. When two disks work, the second disk is identified as / dev / sd <b>b</b> , if the original disk is put out, the second disk will be / dev / sd <b>a</b> .  Hence the conclusion that you do not need to change / etc / fstab.  However, on some Linux, in / etc / fstab, instead of / dev / sd <u>XN, there</u> may be partition identification by UUID.  In this case, there are two options: <br>  - we copy xfs_copy with a key- <b>d</b> (we do full cloning, including UUID) <br>  - change in / etc / fstab all UUIDs to the corresponding / dev / sda <b>N</b> (where N is the partition number, the blkid command will help you with this) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      PS grub2 did not set, if someone has a similar experience of replicating the bootloader to the second disk, share. </div><p>Source: <a href="https://habr.com/ru/post/89617/">https://habr.com/ru/post/89617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../89602/index.html">Google changes name to Topeka</a></li>
<li><a href="../89603/index.html">Fools Parade continues</a></li>
<li><a href="../89608/index.html">Coworking center for freelancers with discipline support services</a></li>
<li><a href="../89609/index.html">Ship meatballs in barrels! From April 1 to LinguaLeo.ru</a></li>
<li><a href="../89616/index.html">AlterGeo Augmented Reality - Now Canceling the Who Is There? Question</a></li>
<li><a href="../89620/index.html">Review of HTC Legend from Gizmodo. Darling</a></li>
<li><a href="../89622/index.html">Opera strives into uncharted spaces</a></li>
<li><a href="../89624/index.html">Cool gif-animation</a></li>
<li><a href="../89627/index.html">Open Source Humor, Part 2: Matt Asay</a></li>
<li><a href="../89636/index.html">Wolfram Alpha fixes bugs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>