<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Microsoft Reporting Services tips for beginners. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue to consider useful tips for beginners when creating reports in Microsoft Reporting Services. 
 Start can be found here: Microsoft Reportin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Microsoft Reporting Services tips for beginners. Part 2</h1><div class="post__text post__text-html js-mediator-article">  We continue to consider useful tips for beginners when creating reports in Microsoft Reporting Services. <br>  Start can be found here: <a href="http://habrahabr.ru/post/164143/">Microsoft Reporting Services tips for beginners.</a> <br>  Interested, please under the cat ... <br><a name="habracut"></a><br><br><h5>  0) How to place several controls in a table cell? </h5><br>  Quite often it becomes necessary to place several controls in 1 table cell.  If you simply drag the control to the cell, it fills it completely.  The control called Rectangle helps to get out of this situation. <br><img src="https://habrastorage.org/storage2/89f/fc5/87e/89ffc587e6fa62ad9554dbb400b88fdb.png"><br><br>  Rectangle is an analogue of the Panel control used in WinForms, it is a kind of platform for placing controls.  When placed in a cell, the Rectangle fills the entire table cell creating a ‚Äúpad‚Äù for placing the rest of the controls. <br><img src="https://habrastorage.org/storage2/a30/495/e84/a30495e84d9a006d198b255b6ee34a06.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  1) Set the default report language </h5><br>  When creating reports, try to declare the report language (Report Properties - Language). <br><img src="https://habrastorage.org/storage2/921/954/695/92195469564dc3604c439146f80c07a0.png"><br>  This is very useful if you work with a foreign client whose regional settings differ from yours.  If you do not know what settings your client is using, then you can specify Expression with the following content: <br><pre><code class="sql hljs">=User!Language</code> </pre> <br>  This will avoid irregularities in the formatting of numerical values, dates, times, currencies, etc. that the client expects. <br><br><h5>  2) String concatenation </h5><br>  Sometimes it becomes necessary to ‚Äúinsert‚Äù into static report text, for example, placed in the texbox, field value from the database.  In other words, you need to add text lines to 1 line.  For this SSRS provides operand ‚Äú&amp;‚Äù. <br>  Suppose we have static text in the texbox <pre> <code class="sql hljs">¬´, .  ‚Ä¶¬ª.</code> </pre>  We need instead of Ivan Ivanovich substitute name from the database, from the field fio.  To do this, right-click on the texbox, call the context menu, select the Expression property from the texbox and change the text as follows: <br><pre> <code class="sql hljs">=‚Äù , . ‚Äú &amp; Fields!fio.Value &amp; ‚Äù ‚Ä¶‚Äù</code> </pre><br>  <b>upd:</b> As suggested by the respected <a href="https://habrahabr.ru/users/pokryshkin/" class="user_link">pokryshkin</a> in comments, a more correct way to concatenate strings is to use placeholder. <br>  Using it is simple: in texbox, you need to set the cursor to the place where you want to insert a value from the database field.  Right-click the context menu and select "Create placeholder ..." <br><img src="https://habrastorage.org/storage2/dbd/b13/191/dbdb13191d1232d77076ec43704ec82a.png"><br><br>  Set the Label value (this value will be visible in the text, if you do not specify a value for the Lable field, then the field name from the database will be used) and Value (in our case, this field is from the database) <br><img src="https://habrastorage.org/storage2/f9e/748/b45/f9e748b45142db9b7be4e7c90e032c38.png"><br><br>  The use of placeholder offers additional benefits: <br>  1) You can see the text that is in control (in the method that I described, the user sees only the text <b><code>&lt;&gt;</code> , which introduces a person who sees the report code for the first time in confusion and spends his time searching for the desired Expression.)</b> <b><br></b>  <b>2) Placeholder allows you to format the field (set the data format, change the font, color, alignment, etc.) without changing the formatting of the main text.</b> <b><br><img src="https://habrastorage.org/storage2/a86/e0e/68a/a86e0e68a9112250a41da57b2598081c.png"><br><br></b>  <b>The difference "on the face":</b> <b><br><img src="https://habrastorage.org/storage2/ba0/f98/85d/ba0f9885d228e50af25c468169777879.png"><br><br></b> <h5>  <b>3) Ways to format numeric data</b> </h5> <b><br></b>  <b>SSRS provides several options for formatting data.</b>  <b>The easiest way to format is to specify the format (the Format property) in the properties of the control.</b> <b><br><img src="https://habrastorage.org/storage2/1de/d54/266/1ded54266cbab6970ddcab18e361135d.png"><br><br></b>  <b>This method has 2 drawbacks:</b> <b><br></b>  <b>1) the control contains, in addition to the data that is supposed to be formatted, additional text.</b> <b><br></b>  <b>2) when exporting a report to hml</b> <b><br></b>  <b>This problem can be solved by calling special methods.</b>  <b>Consider an example:</b> <b><br></b>  <b>The textbox contains the following text:</b> <pre> <b><code class="sql hljs"> ‚Äú ,      : ‚Äù &amp; Fields!UserBalance.Value &amp; ‚Äú .‚Äù</code></b> </pre>  <b>.</b> <b><br></b>  <b>If you do not produce formatting, then provided that the value of Fields! UserBalance.Value is 1005.35, it can be displayed to the user as 1005.350000000000.</b>  <b>To avoid such an incident, you must use the <b>Format</b> or <b>FormatNumber method</b> .</b> <b><br></b>  <b>Example of use:</b> <pre> <b><code class="sql hljs">‚Äú ,       ‚Äù &amp; Format(Fields!UserBalance.Value,‚Äù<span class="hljs-comment"><span class="hljs-comment">#,##0.00‚Äù) &amp; ‚Äú .‚Äù</span></span></code></b> </pre> <b><br></b> <pre> <b><code class="sql hljs">‚Äú ,       ‚Äù &amp; FormaNumber(Fields!UserBalance.Value,2) &amp; ‚Äú .‚Äù</code></b> </pre> <b><br></b>  <b>When using Format, you must use a formatting mask; when using FormaNumber, it is enough to specify the number of decimal places.</b> <b><br></b>  <b><i>Note: The Format method is also used for formatting dates, times, money, etc.</i></b> <b><br><br></b> <h5>  <b>4) Export report to hml format setting fields</b> </h5> <b><br></b>  <b>SSRS allows you to export a report in different formats, one of which is CML.</b>  <b>Each report control has 3 properties that are responsible for the behavior when exporting to hml.</b> <b><br><img src="https://habrastorage.org/storage2/e7a/402/b2d/e7a402b2d0be184e078ca1221d417acd.png"><br><br></b>  <b>Consider them closer:</b> <b><br></b>  <b><b>DataElementName</b> - is responsible for the name of the element in the hml, the default value is not satisfied.</b>  <b>If you do not execute this element, the name in the hml will correspond to the name of the control.</b> <b><br></b>  <b><b>DataElementOutput</b> - the property is responsible for whether the element will be exported to HML or not.</b>  <b>Values ‚Äã‚Äãthat can be set:</b> <b><br></b>  <b><u>Auto</u> (default value) - the item will be exported if it has a value, if it is null, it is not exported.</b> <b><br></b>  <b><u>Output</u> - the item is always exported.</b> <b><br></b>  <b><u>NoOutput</u> - the item is not exported to hml</b> <b><br></b>  <b><b>DataElementStyle</b> - is responsible for the style of the element in the hml (it will be an element or an attribute)</b> <b><br></b>  <b>Values ‚Äã‚Äãthat can be used:</b> <b><br></b>  <b><u>Auto</u> (default value) - depending on the control, it will be exported as an element (node) or attribute (attribute).</b>  <b>In fact, only the default texbox is exported as an attribute, the remaining items are in the form of nodes.</b> <b><br></b>  <b><u>Attribute</u> - the value will be represented as an attribute</b> <b><br></b>  <b><u>Element</u> - the value will be represented as an element (node)</b> <b><br></b>  <b>An important trick: the Hidden property does not apply to export to hml. Therefore, if you intend to export an element in hml that is shown or not based on a condition, then this condition must be transferred to the Expression control.</b>  <b>Example: a textbox contains text that is displayed only when the condition = 1 field. Then the Expression will look like this:</b> <b><br></b> <pre> <b><code class="sql hljs">=IIF(Fields!Condition.Value = 1, ‚ÄúSome text‚Äù,‚Äù‚Äù)</code></b> </pre> <b><br><br></b>  <b>That's all for now, to be continued.</b> </div><p>Source: <a href="https://habr.com/ru/post/164383/">https://habr.com/ru/post/164383/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164371/index.html">NIST SP 800: Information Security Library</a></li>
<li><a href="../164373/index.html">Marmalade announces support for Windows Phone 8</a></li>
<li><a href="../164377/index.html">Using Database Connections in Multi-threaded Qt Applications</a></li>
<li><a href="../164379/index.html">How the owner of a team Dropbox account can destroy your Dropbox account</a></li>
<li><a href="../164381/index.html">A simple in-circuit programmer LPC microcontroller. Features in-circuit programming. Part two</a></li>
<li><a href="../164385/index.html">LED Christmas tree on the Arduino in one evening</a></li>
<li><a href="../164391/index.html">Logic - weekly selection of gaming and IT industry news ‚Ññ7</a></li>
<li><a href="../164393/index.html">About torrent and seeders</a></li>
<li><a href="../164397/index.html">Easyweb: New Year Update</a></li>
<li><a href="../164399/index.html">Online thermometer on TP-Link MR3020</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>