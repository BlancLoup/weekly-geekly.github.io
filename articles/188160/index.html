<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About one elegant design</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 I'll start the article by telling you how I became acquainted with this elegant design. Being engaged in Olympiad programming, my teach...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About one elegant design</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  I'll start the article by telling you how I became acquainted with this elegant design.  Being engaged in Olympiad programming, my teacher and I solved many interesting problems.  Then one day I came across the following task: <br><br>  <i><b>Print in ascending order all irreducible fractions whose denominator does not exceed n, n &lt;= 100.</b></i> <br><br>  When I read the condition of the problem to the end, it did not seem difficult to me (it is not).  The first thing that occurred to me was simply to go through all the denominators from 2 to n and for each denominator to go through the numerators from 1 to the denominator, provided that the numerator and the denominator are mutually simple.  Well, then sort them in ascending order. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Such a solution is correct and the task passed all tests assigned to it.  However, my teacher said that the problem can be solved much more beautifully (he has already encountered this construction).  So I met this wonderful construction - <i><b>the Stern-Brocot tree.</b></i> <br><a name="habracut"></a><br><h4>  Stern-Brocot Tree </h4><br>  The Stern-Brocaw tree was discovered independently by the German mathematician Meritz Stern and the French watchmaker Achilles Brockaw.  This tree allows you to build a set of all irreducible, non-negative fractions. <br><br>  <i><b>First we introduce the following term:</b></i> Let two fractions be given <img src="https://habrastorage.org/storage2/fcb/ba9/555/fcbba955516fab12ab1e021756f90d77.png">  .  Then fraction <img src="https://habrastorage.org/storage2/c86/e80/7e3/c86e807e3727d245070b2b348071ab73.png">  - called their <i>mediant</i> . <br>  We will start building a tree with two fictitious fractions: <br><img src="https://habrastorage.org/storage2/c9d/ede/d4e/c9deded4e66a399b3fa0a9c88ee5fec2.png">  - denoting 0; <br><img src="https://habrastorage.org/storage2/d54/cf5/5a5/d54cf55a5d18964803347c41c431b06a.png">  - denoting infinity "in the irreducible form." <br><br>  At each subsequent iteration between fractions, their <i><b>median is</b></i> inserted, and the same operation is repeated for each of the resulting pairs of fractions: <br><img src="https://habrastorage.org/storage2/3a4/445/28c/3a444528cb9a27a4cd63b8d8777cfb39.png"><br><br>  Continuing this process to infinity, we can build the whole set of irreducible, non-negative fractions. <br><br>  The Stern-Brocot tree would not be so interesting, if not for its remarkable features, and he has many of them: <br><br><ol><li>  the irreducibility of fractions; </li><li>  orderliness of fractions; </li><li>  the presence of absolutely all fractions. </li></ol><br>  You can ask questions: why are all fractions irreducible?  Why are ordered?  Why can not one fraction meet more than once?  The answers to these questions are quite simple.  We need only a little more detail to consider the structure of this tree. <br><br>  Let be <img src="https://habrastorage.org/storage2/fcb/ba9/555/fcbba955516fab12ab1e021756f90d77.png">  - two successive fractions of the Stern-Brocot tree.  You can see that for them the equality <i>yz - xt = 1</i> holds (check it yourself for several pairs of fractions).  We prove this statement by induction for all fractions in a tree.  We take fractions as the base of induction. <img src="https://habrastorage.org/storage2/c9d/ede/d4e/c9deded4e66a399b3fa0a9c88ee5fec2.png">  and <img src="https://habrastorage.org/storage2/d54/cf5/5a5/d54cf55a5d18964803347c41c431b06a.png">  for which the equality 1 * 1 - 0 * 0 = 1 - is true. <br><br>  Now we will show that when inserting the mediant between fractions <img src="https://habrastorage.org/storage2/fcb/ba9/555/fcbba955516fab12ab1e021756f90d77.png">  for which the equality <i>yz - xt = 1</i> is true, it will also be true for fractions <img src="https://habrastorage.org/storage2/a49/dc0/485/a49dc048570c33202746000305555506.png">  . <br>  We have: <br><img src="https://habrastorage.org/storage2/154/664/2cf/1546642cf73d1054e499ade1b190cea7.png"><br><br>  As you can see, both of these equations are equivalent to the original one, therefore the condition <i>yz - xt = 1</i> - is an invariant for all successive fractions in a tree.  Well, what does the condition <i>yz - xt = 1</i> mean?  It means that GCD (x, y) = GCD (z, t) = 1. In fact, the numbers x, y and z, t are coprime (If the GCD (x, y) ‚â† 1, then the left-hand side would be divided into GCD , but the right side is divisible only by 1, similarly for the GCD (z, t)). <br><br>  That is why fractions are irreducible, the numerator and denominator are always mutually simple.  The first question answered!  Go to the second! <br><br>  Why fractions will be ordered?  To answer this question, it suffices to show that the median of two fractions always lies between them. <br><br>  Let be <img src="https://habrastorage.org/storage2/fcb/ba9/555/fcbba955516fab12ab1e021756f90d77.png">  - two consecutive fractions in a tree and <img src="https://habrastorage.org/storage2/68e/9ba/5ee/68e9ba5ee74d73a35ff4f98c14de7bee.png">  .  Show that <img src="https://habrastorage.org/storage2/a9f/2d1/deb/a9f2d1deb81e0904e7d9f77f601aabbe.png">  .  Reducing the fraction to a common denominator and taking into account the condition <img src="https://habrastorage.org/storage2/451/98d/0b4/45198d0b401c4dc506af45bf1c26990d.png">  we get: <br><img src="https://habrastorage.org/storage2/3bf/c86/a2f/3bfc86a2f55fc51b7fea31dc71bdcc37.png"><br><br>  Considering that the denominators of the last fractions are positive, the numerators should be negative, and this is the original inequality <i>xt - yz ‚â§ 0</i> .  Hence we conclude that the median of two fractions is always located between them (but not necessarily in the middle).  Thus, we have shown the ordering of fractions in the Stern-Brocot tree. <br><br>  Well and the last!  Why can not we miss at least one fraction, that is, why all fractions are present in the tree? <br><br>  If we had to find a certain fraction in a tree, then how would we do it?  The search process is actually a binary search.  We compare the desired fraction with the mediant and there are 3 cases: <br><br><ol><li>  it is equal to the mediant, the search is completed; </li><li>  the median is greater than a fraction, then we recursively search the left subtree; </li><li>  the median is less than a fraction, then we recursively search the right subtree. </li></ol><br>  Obviously, this process cannot be performed indefinitely.  Thereby someday we will find our fraction <i>(think for yourself why this is so)</i> . <br><br><h4>  Farey sequence </h4><br>  Well, what about the original problem?  It seems that the Stern-Brocot tree suits us, but there are fractions of large units in it that are redundant.  However, what prevents us from taking instead of fictitious fractions <img src="https://habrastorage.org/storage2/c9d/ede/d4e/c9deded4e66a399b3fa0a9c88ee5fec2.png">  and <img src="https://habrastorage.org/storage2/d54/cf5/5a5/d54cf55a5d18964803347c41c431b06a.png">  fractions <img src="https://habrastorage.org/storage2/91c/791/854/91c79185447406160459e0db8bde70ab.png">  ?  Nothing! <br><img src="https://habrastorage.org/storage2/c88/124/2a6/c881242a6f2f2be3983de86537e30e89.png"><br><br>  This particular case of the Stern-Brocot tree is the basis for the Farey sequence. <br><br>  The Farey sequence of order n is the set of all irreducible fractions between 0 and 1, the denominator of which does not exceed n, which are arranged in ascending order.  Denoted by the sequence of the letter F <sub>n</sub> . <br><br>  Strictly mathematically, this sequence can be written as: <br><img src="https://habrastorage.org/storage2/505/88c/e84/50588ce843934abffe685b58210315a0.png"><br>  This is the Farey sequence for n = 1, ..., 5 <br><br><img src="https://habrastorage.org/storage2/b12/eb0/49e/b12eb049e3068e5e07132f2ee5a2646b.png"><br><br>  The sequence is named after the famous geologist John Farey. <br><br>  In fact, the original problem can be reformulated as follows: build an n-order Farey sequence.  C # code for building it looks very simple, just 2 recursive calls: <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FareiSequence</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"{0} / {1}"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); FareiSequence(n, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"{0} / {1}"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FareiSequence</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> t</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = x + z, b = y + t; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b &lt;= n) { FareiSequence(n, x, y, a, b); Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"{0} / {1}"</span></span>, a, b); FareiSequence(n, a, b, z, t); } }</code> </pre> <br>  Farey fractions can also be used to simplify mathematical expressions. <br><br>  For example, you want to count the expression: <br><br><img src="http://habrastorage.org/storage2/106/bde/2bc/106bde2bcc541fc293d1a5cf5442fd52.png"><br><br>  The standard way to bring to a common denominator is not interesting to us.  Imagine fractions in the form of the difference between the neighboring fractions of the Farey series: <br><br><img src="http://habrastorage.org/storage2/e37/c18/4fb/e37c184fb7e49ae44bf74593ec0d34bd.png"><br><br>  Just like that you can count this expression!  On it we will finish with the Farey sequence and once again return to the Stern-Brokaw tree. <br><br><h4>  Tree as a number system </h4><br>  It turns out the Stern-Brocot tree can be used as a number system (symbolic method) to represent rational numbers. <br><br>  But how to compare with each fraction some sequence of characters?  To do this, recall the algorithm for finding a certain fraction in the tree. <br><br>  Let us need to find the fraction. <img src="http://1450827949611393602008">  in a tree.  We start the search with the median <img src="http://habrastorage.org/storage2/d81/e5e/512/d81e5e51227c3e44b2bbfc7f7fd9db97.png">  .  The transition on the left subtree is denoted by the letter L, on the right subtree by the letter R. Thus, the number <img src="http://1450827949611393602008">  matches the LLRL character sequence (see picture). <br><br><img src="http://habrastorage.org/storage2/d6c/4c2/842/d6c4c28422d6cef65e84cdb694104c96.png"><br><br>  Thus, we can associate each sequence of letters R and R with each rational fraction (or we can completely replace them with 0 and 1 to fully match the binary number system). <br><br><h4>  Approximation of real numbers by rational </h4><br>  If in the process of searching for a fraction in the Stern-Brocot tree, instead of a fraction, you transfer a real number, then you can get its approximation by rational fractions. <br><br>  Let's try to bring the number <img src="http://1450827949266059384277">  .  We get this result RRRLLLLLLLRRRRRRRRRRRRRRRRLRRRR ... <br><br>  Based on this view, we can assume that fractions <br><br><img src="http://habrastorage.org/storage2/e8c/160/7fd/e8c1607fd312fa8e712c65ccd1ec323f.png"><br>  serve as the simplest rational approximations to the number <img src="http://1450827949266059384277">  up and down.  Thus, we can conclude that <img src="http://habrastorage.org/storage2/008/219/04f/00821904fe2ed562bae6e82b2a6bb256.png">  . <br><br>  On this, we, perhaps, will complete our acquaintance with the Stern-Brokaw tree.  I hope the article was interesting to read. </div><p>Source: <a href="https://habr.com/ru/post/188160/">https://habr.com/ru/post/188160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../188146/index.html">Google offers to start developing applications for Google Glass before the release of the Glass Development Kit</a></li>
<li><a href="../188150/index.html">Proper adaptive alignment of the site header</a></li>
<li><a href="../188152/index.html">Hash function Stribog or in the city of the new sheriff</a></li>
<li><a href="../188154/index.html">Discovery of highly porous material</a></li>
<li><a href="../188156/index.html">The digest of interesting news and materials from the world of PHP over the last two weeks, No. 22 (July 15, 2013 - July 28, 2013)</a></li>
<li><a href="../188162/index.html">Open tab in Chrome</a></li>
<li><a href="../188168/index.html">Five people accused of committing the largest theft of financial data</a></li>
<li><a href="../188170/index.html">Drawings in SVG format. Part 5. - Draft Standard</a></li>
<li><a href="../188176/index.html">Win64 / Expiro - cross-platform file infector</a></li>
<li><a href="../188178/index.html">What laptop do you program most of the time?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>