<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Oracle 12c. We continue to review new features. SQL Text expansion</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I just found in T. Kite's blog a description of a very useful, in my opinion, new 12-opportunity. 
 Called SQL Text expansion . In fact, it allows you...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Oracle 12c. We continue to review new features. SQL Text expansion</h1><div class="post__text post__text-html js-mediator-article">  I just found in <a href="http://tkyte.blogspot.co.uk/2013/07/12c-sql-text-expansion.html">T. Kite's blog a</a> description of a very useful, in my opinion, new 12-opportunity. <br>  Called <a href="http://docs.oracle.com/cd/E16655_01/appdev.121/e17602/d_util.htm">SQL Text expansion</a> .  In fact, it allows you to get the final query, after all the transformations and additions. <br><br>  1) all subject to view will be disclosed.  Those.  let's say you have, at first glance, a simple query, from one view, but if you dig deeper, you will find that inside this view consists of a complex query, and that one is based on other views, which, in turn, on another set submissions.  Surely many of us have come across this and know how much effort it is to collect the whole picture in one's head, running through the descriptions of each presentation and trying to imagine how it all comes together in one request ... <br><br>  2) Special effort when debugging logic and performance is to work with the virtual private database (dbms_rls).  Now the new feature allows you to greatly facilitate life (who faced - he will definitely appreciate!). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now there is a new function, EXPAND_SQL_TEXT from the DBMS_UTILITY package. <br><a name="habracut"></a>  Some examples (taken from the site of T.Kayta). <br><br>  Let's see what SQL will actually be executed to retrieve data from the standard all_users <br><br><pre><code class="sql hljs">ops$tkyte%ORA12CR1&gt; variable x clob ops$tkyte%ORA12CR1&gt; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> dbms_utility.expand_sql_text <span class="hljs-number"><span class="hljs-number">3</span></span> ( input_sql_text =&gt; <span class="hljs-string"><span class="hljs-string">'select * from all_users'</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> output_sql_text =&gt; :x ); 5 <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; 6 / PL/SQL procedure successfully completed. ops$tkyte%ORA12CR1&gt; print x X <span class="hljs-comment"><span class="hljs-comment">-------------------------------------------------------------------------------- SELECT "A1"."USERNAME" "USERNAME","A1"."USER_ID" "USER_ID","A1"."CREATED" "CREATED","A1"."COMMON" "COMMON" FROM (SELECT "A4"."NAME" "USERNAME","A4"."USER#" "USER_ID","A4"."CTIME" "CREATED",DECODE(BITAND "A4"."SPARE1",128),128,'YES','NO') "COMMON" FROM "SYS"."USER$" "A4","SYS"."TS$" "A3","SYS"."TS$" "A2" WHERE "A4"."DATATS#"="A3"."TS#" AND "A4"."TEMPTS#"="A2"."TS#" AND "A4"."TYPE#"=1) "A1"</span></span></code> </pre> <br><br>  Well, an example of working with VPD: <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--    ops$tkyte%ORA12CR1&gt; create table my_table 2 ( data varchar2(30), 3 OWNER varchar2(30) default USER 4 ) 5 / Table created. ops$tkyte%ORA12CR1&gt; create or replace 2 function my_security_function( p_schema in varchar2, 3 p_object in varchar2 ) 4 return varchar2 5 as 6 begin 7 return 'owner = USER'; 8 end; 9 / Function created. ops$tkyte%ORA12CR1&gt; begin 2 dbms_rls.add_policy 3 ( object_schema =&gt; user, 4 object_name =&gt; 'MY_TABLE', 5 policy_name =&gt; 'MY_POLICY', 6 function_schema =&gt; user, 7 policy_function =&gt; 'My_Security_Function', 8 statement_types =&gt; 'select, insert, update, delete' , 9 update_check =&gt; TRUE ); 10 end; 11 / PL/SQL procedure successfully completed. --       . ops$tkyte%ORA12CR1&gt; begin 2 dbms_utility.expand_sql_text 3 ( input_sql_text =&gt; 'select * from my_table', 4 output_sql_text =&gt; :x ); 5 end; 6 / PL/SQL procedure successfully completed. ops$tkyte%ORA12CR1&gt; print x X -------------------------------------------------------------------------------- SELECT "A1"."DATA" "DATA","A1"."OWNER" "OWNER" FROM (SELECT "A2"."DATA" "DATA", "A2"."OWNER" "OWNER" FROM "OPS$TKYTE"."MY_TABLE" "A2" WHERE "A2"."OWNER"=USER@!) "A1"</span></span></code> </pre></div><p>Source: <a href="https://habr.com/ru/post/189544/">https://habr.com/ru/post/189544/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189526/index.html">NSA will reduce 90% of system administrators</a></li>
<li><a href="../189530/index.html">local compilation without lags</a></li>
<li><a href="../189534/index.html">Lenovo: the third (or fourth) place in the smartphone market</a></li>
<li><a href="../189540/index.html">HP 3PAR StoreServ</a></li>
<li><a href="../189542/index.html">Rhodecode 2.0 Enterprise</a></li>
<li><a href="../189546/index.html">Review Wexler.Tab 7b: tablet "for two rubles"</a></li>
<li><a href="../189548/index.html">Spectral analysis at home</a></li>
<li><a href="../189552/index.html">CUDA 5.5 released</a></li>
<li><a href="../189554/index.html">Holho: pseudo-holographic display for smartphones and tablets</a></li>
<li><a href="../189556/index.html">Creating a Bashkir layout for Mac OS X</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>