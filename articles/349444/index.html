<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Do not fit, kill!" Or the whole truth about the security of automated process control systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most of our customers are industrial and manufacturing companies. No matter how large and significant the front office and corporate network of such c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Do not fit, kill!" Or the whole truth about the security of automated process control systems</h1><div class="post__text post__text-html js-mediator-article">  Most of our customers are industrial and manufacturing companies.  No matter how large and significant the front office and corporate network of such companies are, their main business is the production itself, as well as related tasks and processes.  And often, solving the tasks of monitoring and responding to cyber attacks with customers, we start with a corporate network and a perimeter, and as a result we arrive at closed networks and segments of production and technological networks. <br><br>  We decided to collect our experience in the protection of automated process control systems and talk about the most frequent problems and popular myths about safety in this area. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yw/2x/sr/yw2xsrs0etfeg8swdcmneuodua4.jpeg"></div><a name="habracut"></a><br>  <i>The automated process control system is a set of hardware and software designed to automate the process equipment control at industrial enterprises.</i> <i><br></i> <br>  ACS TP, as a rule, has a multi-level structure: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Operator / dispatch control level (upper level). </li><li>  The level of automatic control (medium level). </li><li>  Level of input / output data of executive devices (low / field level). </li></ul><br>  The number of levels of an automated process control system, as well as its composition at each level, of course, depends on its purpose and the performance of its objective functions.  At the same time, at each level of the automated control system, according to functional, territorial or other signs, other additional segments may be allocated.  However, at the current stage, we limit ourselves to the general representation below. <br><br><img src="https://habrastorage.org/webt/hj/vz/rw/hjvzrwahteng8s-cm3alztezkrq.png"><br><br><h3>  Problem 1: the myth of the "air gap" <br></h3><br>  Many process control systems were built for a long time.  At that time it was believed that technological networks and systems were completely isolated from the outside world, and therefore, ensuring information security in this area was not recognized as relevant or, at best, was not a priority.  However, now the line between technological and corporate networks is more and more erased, and, moreover, Ethernet / IP and, in general, corporate networks are used in technological networks. <br><br>  These processes are due to the needs of the business and, as a result of the need for network connectivity, we usually see one of the scenarios below at the Customer: <br><br><ol><li>  The customer has implemented a project of interfacing and segmentation of corporate and technological networks, providing for an integrated approach to ensuring information security with connected segments.  At the moment, the rarest option, but we met him at several customers. </li><li>  The corporate and technological networks of the customer are connected according to one of the schemes that are available and seem to be fairly secure IT, information security and automated process control systems.  This can be as connectivity using a firewall, using a router with ACL (Access Control List), and other options up to AWP / access servers with multiple network cards (by the way, one of the most common cases).  A large number of accesses are often superimposed on these schemes, including access from outside the corporate network - for ATMs installed on the territory of production, remote work of vendors of automated process control systems and other involved contractors.  As a result, in fact, these schemes over time begin to transform into the following version: </li><li>  Just a PCS in a common network.  It seems incredible, but unfortunately, this option is also widespread. </li></ol><br>  In addition, the effect of the development and mass availability of modern technologies (mobile devices and mobile Internet, USB-modems, etc.), which employees actively use for their own purposes, has an effect.  Starting from operators wishing to access the Internet at the workplace, and ending with IT administrators wishing to save travel time to the final facility, located, for example, 20 km from the office. <br><br><div class="spoiler">  <b class="spoiler_title">Results of Pentest APCS of company A (excerpt from the report)</b> <div class="spoiler_text">  In the course of the work, the auditor obtained access to the remote desktop of the user‚Äôs automated workplace with the IP address 172.28.XX.YY, on which were found: <br><br><ul><li>  Saved settings for VPN connections to segments of the technological infrastructure considered to be isolated (see figure). <br><br><img src="https://habrastorage.org/webt/uc/79/m4/uc79m4j2porei_f0wj-4tdqw7_y.png"></li><li>  The file that contained the access details to the technological infrastructure nodes, including the access and control details of the used SCADA systems of various manufacturers.  The file was available in the general network directory to all users of the corporate network without authentication (see fig.). <br><br><img src="https://habrastorage.org/webt/jx/tu/-k/jxtu-k5vkvffpqgfskeamnawjuy.png"></li></ul><br>  The use of VPN connections with saved credentials allowed the auditor to directly access the management of the network equipment of the technological infrastructure, as well as the equipment at the end objects using the control interfaces of the corresponding SCADA systems, directly from the identified workstations. <br></div></div><br>  Let us complete the picture with the problems of using USB modems in the field mentioned above.  Phones like USB modems.  Home routers, home storage servers and other "possibilities" of modern life.  And even if the corporate and technological networks are connected in the best way - the first of the scenarios, unfortunately, in fact, this does not mean that the situation is as it should be and there are no specific places, for example, own Internet access or uncontrolled access to the corporate network. network and back. <br><br>  The result is a bleak picture of the possibility of easy penetration by an attacker or malware with a connection with C &amp; C inside the automated process control system.  In general, we can formulate it as follows: <i>everything that threatens the corporate network, in fact, threatens and technological segments</i> .  This does not mean that the technological infrastructure and the protection of the corporate network need to be transferred to the technological infrastructure and the automated process control system, but you should be aware that the risks of the information technology segments of the technology segments are no less than those of the corporate ones. <br><br><h3>  Problem 2: information security in automated process control systems and information security <br></h3><br>  Technological networks and segments at the same time are significantly different from corporate networks and systems.  So, unlike a typical IT system, a typical process control system: <br><br><ul><li>  It is a real-time system in which response time is critical, and delays and data loss are unacceptable. </li><li>  Along with widely used operating systems and protocols, it widely uses specialized and specially designed (proprietary). </li><li>  The duration of the life cycle is 10-15-20 years, and for some objects - up to 30 years. </li><li>  Components can be isolated, geographically remote, and physically difficult to access. </li><li>  A reset in the process control system may be unacceptable, incl.  it is often impossible to install any updates, etc. </li></ul><br>  As a result, we often observe a situation at the end objects at the customer when some in-house development is used (neither the manufacturer nor the support of which is left), with the general shift account, the password from which cannot be changed and which coincides with the login (by analogy with famous admin / admin).  If the password can be set at all, in fact, we recall, many process control systems are more than 10-15 years old. <br><br><div class="spoiler">  <b class="spoiler_title">Results of Pentest APCS of company B (excerpt from the report)</b> <div class="spoiler_text">  A study of the technological network diagrams identified by the auditor and the ways of their interfacing with user segments showed that the nodes with IP addresses 10.65.XX.YY, 10.65.XX.ZZ function as a router between the user and technology networks.  Access to these devices is possible via SSH using the credentials of the root user account with an easy-to-use root password.  Nodes with the above IP addresses after gaining access to them were identified and turned out to be PSI system controllers (see fig.). <br><br><img src="https://habrastorage.org/webt/ml/13/d9/ml13d9zm2qooqvtiw31zucyl90k.png"><br><br>  Working on these SSH service devices with the ability to transfer graphical sessions and support for SSH tunnels allowed the auditor to organize traffic tunneling and conduct selective scanning of technological network nodes through the PSI system controllers, a subsequent attack on the technological network password protection subsystem and access to the devices isolated from the user network. segment. <br><br>  In particular, the auditor obtained access to the technological network based on MIKRONIKA equipment, for which access was made via Telnet using the credentials of a root account that does not have a password set up for remote privileged access to devices (see the figure). <br><br><img src="https://habrastorage.org/webt/o9/tm/sb/o9tmsboyxk11gyajow9vawpebiw.png"><br></div></div><br>  Also, while technological systems for the most part circulate information about technological processes and control actions, the emphasis is usually placed on its availability and integrity, while the issue of confidentiality tends to receive less attention.  And this is one of the additional reasons explaining the "delay" with the movement towards ensuring information security in the field of industrial control systems. <br><br>  So, we have a virtually unprotected system running on outdated and unsupported software with a whole fan of vulnerabilities.  Installing updates on such a system, in most cases, is impossible - because of their absence, impossibility of installation, impossibility of rebooting and other numerous reasons.  Hence the conclusion: <i>problems and vulnerabilities in technology networks and systems are even higher than in the average corporate network.</i> <br><br>  At the same time, even in the case of using systems and software supported by the manufacturer, there is usually sustained resistance from the production side to any updates aimed at eliminating security problems.  And almost always, this aversion extends to any superimposed security features (by the way, it may well be justified if blocking mechanisms are somehow declared and implemented in such means, even if they are not intended to be used during implementation and future operation). <br><br>  It is important to note that customers know most of these problems, including possible actions by field staff.  The IS risks associated with them are covered by very tough organizational and physical security measures: prohibition of bringing various devices and external media into the territory, physical limitation of the use of equipment ports, etc.  measures).  However, these measures are not able to fully ensure reliable protection of the process control system. <br><br>  Summarizing the situations and problems described above, the following main points can be noted: regarding the current situation with information security in the process control systems: <br><br><ol><li>  ‚ÄúEverything can be broken‚Äù in the process control system without complex attacks on systems, protocols and controllers. </li><li>  The initial risks of information security in a technological network are not only not less, but also significantly higher than in a corporate network. </li><li>  These risks require their own range of actions and measures, at least taking into account: <br><ul><li>  colossal criticality and continuity of business processes; </li><li>  the practical impossibility of updates; </li><li>  practical inapplicability or inapplicability of traditional IS systems and, in particular, blocking mechanisms. </li></ul></li></ol><br>  But no matter how limiting factors, it is still necessary to protect the process control system.  In the second part of the article, we will describe how, given these problems, to fully monitor and respond to cyber attacks.  Again, with live examples and case studies from customers.  Do not miss! </div><p>Source: <a href="https://habr.com/ru/post/349444/">https://habr.com/ru/post/349444/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349434/index.html">Questions for the interview backend developer</a></li>
<li><a href="../349436/index.html">How to predict an Oscar winner according to social networks or how I spent my day off</a></li>
<li><a href="../349438/index.html">Moscow JS 40 in Avito - announcement</a></li>
<li><a href="../349440/index.html">Creating a game on Lua and L√ñVE - 2</a></li>
<li><a href="../349442/index.html">JBreak 2018 Java Conference Program Overview: Absolute Balance</a></li>
<li><a href="../349446/index.html">DevDay about .NET: lazy authorization & DSL and C # union</a></li>
<li><a href="../349448/index.html">Key transparency & Coniks to protect data structures</a></li>
<li><a href="../349450/index.html">Microsoft Office Security: Document Formats</a></li>
<li><a href="../349452/index.html">[bookmark] Tools for testing javascript projects</a></li>
<li><a href="../349454/index.html">Ring bar graphs in stock</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>