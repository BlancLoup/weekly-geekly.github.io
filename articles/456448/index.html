<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JS framework selection rules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR 



- This article does not cover JS frameworks from the TOP-3 list. 
- When developing on a JS framework not from the TOP-3 list, it is necess...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JS framework selection rules</h1><div class="post__text post__text-html js-mediator-article">  TL; DR <br><br><ul><li>  This article does not cover JS frameworks from the TOP-3 list. </li><li>  When developing on a JS framework not from the TOP-3 list, it is necessary to solve an order of magnitude more technical issues than is expected at the beginning of development. <br></li><li>  The story is based on real events. </li></ul><a name="habracut"></a><br>  The story began with a single mini-project that was originally developed based on the backbone.js and marionette.js libraries.  These are, of course, the great libraries with which the history of the development of one-page applications began.  But already at that time they were of historical rather than practical value.  I will only mention the fact that in order to display a simple table, it was necessary to create: 1) a module with a description of the model, 2) a module with a description of the collection, 3) a module with a view definition of the model, 4) a module with a view definition of the collection, 4) a table row pattern, 5) table template; 6) controller module.  Having about 10 entities in a small application - you already at the very beginning had more than fifty small modules.  And this is just the beginning.  But now is not about that. <br><br>  At some point, after half a year of the application, it still did not appear in the search results.  Adding <a href="https://prerender.io/">prerender.io</a> to the project (which then used the phantom.js engine) helped, but not as much as expected.  And over the application, and clouds began to thicken above me, after which I realized that I needed to do something very quickly and efficiently, preferably today.  The goal I set this: go to the server rendering.  With backbone.js and marionettejs this is almost impossible to do.  In any case, the rendr project on backbone.js, which was developed under the leadership of Spike Brehm (the author of the idea of ‚Äã‚Äãisomorphic / universal applications), gathered 58 contributors and 4184 likes on github.com, was stopped in 2015, and was clearly not intended for a one-day blitz .  I started looking for an alternative.  I excluded the TOP-3 JS framework immediately from consideration because I didn‚Äôt have enough time to master them.  After a brief search, I found a rapidly developing JS framework riot.js <a href="https://github.com/riot/riot">github.com/riot/riot</a> , which today has 13704 likes on github.com, and I hoped it could eventually come to the first position (which, however, did not occur). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And yes, I closed the question (though not on the same day, but for the next two days of the day) by transferring the application to server rendering using riot.js.  And on the same day, when it happened, the site moved to the first ten pages of search results.  And within a week I came out on the first page, from where it hadn't been leaving for several years. <br><br>  At this success story ends and begins the story of defeat.  The next project was much more complicated.  The truth was a positive thing is that 99% of the application screens were in the user's personal account, so there was no need for server rendering.  Inspired by the first successful experience of using riot.js, I began to promote the idea of ‚Äã‚Äãconsolidating success and applying riot.js on the front end.  Then it seemed to me that, finally, a solution was found which combined simplicity and functionality, as promised by the riot.js documentation.  How wrong I was! <br><br>  I ran into the first problem when it was necessary to provide the HTML layout maker with all the necessary tools for development.  In particular, plug-ins were needed for the code editor, an engine in which it would be possible to place components and immediately observe the result obtained, including with hot component reloading (hot-reload).  All this had to be given in the form ready for commercial use in the near future, and all this was not.  As a result, the layout of the application started on one of the traditional templating engines, which as a result led to the ungrateful stage of translating HTML documents into riot.js components. <br><br>  However, the main problem that emerged at this stage is not even connected with the translation of the layout from the template format into the riot.js components.  Unexpectedly, it turned out that riot.js produces completely non-informative template compilation error messages, as well as run-time errors (this is true for all versions of riot.js up to version 4.0, which has been completely redesigned).  There was no information not only about the line in which the error occurred, but even about the name of the file or component in which the error occurred.  It was possible to search for an error for many hours in a row, and still it would not be found.  And then it was necessary to roll back all changes to the last working state. <br><br>  The next one was a problem with routing.  Routing in riot.js goes almost out of the box <a href="https://github.com/riot/route">github.com/riot/route</a> - in any case from the same developer.  It allowed to hope for its trouble-free work.  But at some point I noticed that some pages are unpredictably overloaded.  That is, once a transition to a new route can occur in a single-page application mode, and another time the same transition overloaded the entire HTML document, as when working with a classic web application.  At the same time, naturally, the internal state was lost, if it was not yet stored on the server.  (In the present development of this library is stopped and with the version riot.js 4.0 it is not used). <br><br>  The only component of the system that worked, as expected, was the minimalist flux-like state manager <a href="https://github.com/jimsparkman/RiotControl">github.com/jimsparkman/RiotControl</a> .  However, to work with this component, it was necessary to assign and cancel listeners of state changes much more often than we would like. <br><br>  The original intent of this article was to show the tasks that the riot.js framework has to do with the tasks that the developer, who decided (decided) to develop the application on the JS framework not from the TOP-3 list, will have to solve.  However, in the process of preparation, I decided to refresh some pages from riot.js documentation, and so I learned that a new version of riot.js 4.0 was released, which was completely (from scratch) revised, which can be found in the article by the riot developer. js at medium.com: <a href="https://medium.com/%40gianluca.guarini/every-revolution-begins-with-a-riot-js-first-6c6a4b090ee">medium.com/@gianluca.guarini/every-revolution-begins-with-a-riot-js-first-6c6a4b090ee</a> .  From this article I learned that all the main problems that worried me, and which I was going to talk about in this article, were eliminated.  In particular, in riot.js version 4.0: <br><br><ul><li>  the compiler has been completely rewritten (or rather, it was first written because the engine used regular expressions before) - this affected, in particular, the informativeness of error messages <br></li><li>  In addition to server rendering, hydration was added to the client - this allowed us to finally start writing universal applications without double rendering (the first time on the server and right there on the client due to the lack of the old hydrate () function) </li><li>  Added plugin for hot component overload. <a href="https://github.com/riot/hot-reload">github.com/riot/hot-reload</a> </li><li>  and many other useful changes </li></ul><br>  This is not an advertisement, just a background.  In fact, my conclusions will be quite ambiguous in terms of recommendations for use, and the article is generally devoted not to a specific framework or library, but to tasks that need to be solved in the development process. <br><br>  Unfortunately, the work done by the developers of riot.js has not yet been properly appreciated by the community.  For example, the server rendering library <a href="https://github.com/riot/ssr">github.com/riot/ssr</a> for the six months past from the beginning of its development gathered three distributors and three likes on github.com (not all likes are made by contributors, although one is a contributor). <br><br>  Therefore, in the course of the play I changed the direction of the article, and instead of memoirs I tried again to go all the way, having a little more knowledge and experience, more advanced versions of libraries and unlimited free time. <br><br>  So here we go.  For example, the implementation of the application <a href="https://github.com/gothinkster/realworld">github.com/gothinkster/realworld</a> was made.  This project has been discussed more than once in Habr√©.  For those who are not familiar with him, I will briefly describe his idea.  The developers of this project with the help of different programming languages ‚Äã‚Äãand frameworks (or without them) solve the same problem: developing a blog engine, with functionality similar to the simplified version of medium.com.  This is a trade-off between the complexity of real-world applications that we have to develop every day, and todo.app, which does not always allow us to really appreciate the work with the library or framework.  This project is respected by developers.  In confirmation of this, I can say that there is even one implementation from Rich Harris (major developer sveltejs) <a href="https://github.com/sveltejs/realworld">github.com/sveltejs/realworld</a> . <br><br><h3>  Development environment </h3><br>  Of course, you are ready to rush into battle, but think about the developers around you.  In this case, focus on the question of the development environment in which your colleagues work.  If for the framework with which you are going to work, there are no plug-ins for the main development environments and program code editors, then you are unlikely to be supported.  For example, I use Atom editor for development.  For it there is a riot-tag plugin <a href="https://github.com/riot/syntax-highlight/tree/legacy">github.com/riot/syntax-highlight/tree/legacy</a> , which has not been updated for the last three years.  And in the same repository there is a plugin for sublime <a href="https://github.com/riot/syntax-highlight">github.com/riot/syntax-highlight</a> - it is current and supports the current version of riot.js 4.0. <br><br>  However, the riot.js component is a valid fragment of an HTML document in which the JS code is contained in the body of the script element.  So everything just works if you add the html document type for the * .riot extension.  Of course, this is a forced decision, since otherwise it would have been impossible to continue further here. <br><br>  We got the syntax highlighting in a text editor, and now we need more advanced functionality, what we used to get from eslint.  In our case, the JS code of the components is contained in the body of the script element, I was hoping to find and found a plugin for extracting the JS code from the HTML document - <a href="https://github.com/BenoitZugmeyer/eslint-plugin-html">github.com/BenoitZugmeyer/eslint-plugin-html</a> .  After that, my eslint configuration began to look like this: <br><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"parser"</span></span>: <span class="hljs-string"><span class="hljs-string">"babel-eslint"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"html"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"settings"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"html/html-extensions"</span></span>: [<span class="hljs-string"><span class="hljs-string">".html"</span></span>, <span class="hljs-string"><span class="hljs-string">".riot"</span></span>] }, <span class="hljs-attr"><span class="hljs-attr">"env"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"browser"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"node"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"es6"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"extends"</span></span>: <span class="hljs-string"><span class="hljs-string">"standard"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"globals"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Atomics"</span></span>: <span class="hljs-string"><span class="hljs-string">"readonly"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"SharedArrayBuffer"</span></span>: <span class="hljs-string"><span class="hljs-string">"readonly"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"parserOptions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"ecmaVersion"</span></span>: <span class="hljs-number"><span class="hljs-number">2018</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sourceType"</span></span>: <span class="hljs-string"><span class="hljs-string">"module"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { } }</code> </pre> <br>  The presence of plug-ins for syntax highlighting and eslint is probably not the first thing that a developer begins to think about when choosing a JS framework.  Meanwhile, without these tools, you may encounter opposition from colleagues and their exodus for "valid" reasons from the project.  Although the only and truly valid reason is that they are not comfortable working without having a full developer‚Äôs arsenal.  In the case of riot.js, the problem was solved by the Columbus method.  In the sense that there are actually no plug-ins for riot.js, but thanks to the syntax of the riot.js templates, which looks like a fragment of a regular HTML document, we cover 99% of the necessary functionality using tools for working with an HTML document. <br><br>  In addition to the tools for writing and validating the code that we have just considered, the developer‚Äôs tools include tools for quickly assembling and debugging a project, hot rebooting components and modules in a web browser when making changes to a project.  This part will be covered in the next section. <br><br><h3>  Build project </h3><br>  We have already managed to get used to most of the features that are needed when building a project, and even stop thinking about what could be different.  But otherwise maybe.  And, if you have chosen a new JS framework, it is advisable to first make sure that everything works as you expect.  For example, as I mentioned, the greatest problems in developing on older versions of riot.js were related to the lack of compilation error messages and the run-time information about the component in which this error occurred.  Also important is the compilation speed.  As a rule, to speed up the compilation speed, in correctly built frameworks only the changed part is recompiled, as a result, the response time to changes in the text of the components is minimal.  Well, quite well, if supported by hot reloading components without a full reload of the page in a web browser. <br><br>  Therefore, I will try to list the checklist, on which you need to pay special attention when analyzing the means of assembling a project: <br><br>  1. Availability of development mode and working application <br>  In developer mode: <br>  2. Informative project compilation error messages (source file name, line number in source file, error description) <br>  3. Informative runtime error messages (source file name, line number in source file, error description) <br>  4. Quick rebuild of modified modules <br>  5. Hot reloading of components in the browser. <br>  In operation: <br>  6. The presence of versioned in the file name (for example 4a8ee185040ac59496a2.main.js) <br>  7. The layout of small modules in one or more modules (chunks) <br>  8. Breaking the code into chunks using dynamic import. <br><br>  In riot.js version 4.0, the <a href="https://github.com/riot/webpack-loader">github.com/riot/webpack-loader</a> module has appeared, which fully complies with the given checklist.  I will not list all the features of the assembly configuration.  The only thing I‚Äôll notice is that in this project I use modules for express.js: webpack-dev-middleware and webpack-hot-middleware, which allow you to work on a full-featured server right after the layout.  This, in particular, allows the development of universal / isomorphic web applications.  Please note that the hot component overload module is valid only for a web browser.  At the same time, the component rendered on the server side remains unchanged.  Therefore, it is necessary to listen to its changes, and at the right time, delete all the code cached by the server and load the code of the modified modules.  How to do this for a long time to describe, so just give a link to the implementation: <a href="">github.com/apapacy/realworld-riotjs-effector-universal-hot/blob/master/src/dev_server.js</a> <br><br><h3>  Routing </h3><br>  Slightly paraphrasing Leo Tolstoy, we can say that all the engines of the JS frameworks are alike, while all the routings that are attached to them work in their own way.  I often see conditional classification of routers into two types: declarative and imperative.  Now I will try to figure out how such a classification is justified. <br><br>  We will conduct a brief excursion into history.  In the early days of the Internet, the URL / URI corresponded to the name of the file that is hosted on the server.  Turn over several pages of history and we will learn about the advent of Model 2 (MVC) Architecture.  In this architecture, a front controller appears that performs the function of routing.  I wondered who first decided from the front controller to allocate the routing function into a separate block, which further sends a request to one of many controllers and has not yet found the answer.  It seems that this started to do everything at once. <br><br>  That is, the routing determined the action to be carried out on the server and (transitively through the controller) the view that will be generated by the controller.  When transferring the routing to the client side (web browser), an idea of ‚Äã‚Äãthe routing function in the application has already been formed.  And those who primarily focused on the fact that routing determines action, developed imperative routing, and those who paid attention to the fact that, finally, routing determines the view that should be shown to the user, developed declarative routing. <br><br>  That is, when transferring from server to client to routing, ‚Äúhung‚Äù two functions that were characteristic of server routing (choice of action and choice of twist).  In addition, new tasks have arisen - this is navigating through a one-page application without completely reloading the HTML document, working with the history of visits and much more.  For illustration, I will quote excerpts from the documentation of a router of one mega-popular framework: <br><br>  ... makes it easy to create SPA-applications.  Includes the following features. <br><br><ul><li>  Nested routes / views </li><li>  Modular router configuration </li><li>  Access to route parameters, query, wildcards </li><li>  Animating view transitions based on Vue.js </li><li>  Convenient navigation control </li><li>  Automatic insertion of active CSS class for links </li><li>  HTML5 history or hash modes, with auto-switching in IE9 </li><li>  Customizable page scrolling behavior </li></ul><br>  In this version, routing is clearly overloaded with functionality and needs to be rethought on the client side.  I began to look for a solution suitable for my problem.  As the main criteria, I took into account that the routing: <br><br><ol><li>  should work equally on the web client side and on the web server side for universal / isomorphic web applications; </li><li>  should work with any (including chosen by me) framework or without it. </li></ol><br>  And I found such a library, it is <a href="https://github.com/kriasoft/universal-router">github.com/kriasoft/universal-router</a> .  If you briefly describe the idea of ‚Äã‚Äãthis library, it configures the routes, which accept the URL string as input, and call an asynchronous function at the output, which is passed to the parsed URL as an actual parameter.  To be honest, I wanted to ask: is that all?  And how to continue with this all need to work?  And then I found an article on medium.com <a href="https://medium.com/%40ippei.tanaka/universal-router-history-react-97ec79464573">medium.com/@ippei.tanaka/universal-router-history-react-97ec79464573</a> , which offered a fairly good option, except perhaps rewriting the push () history method, which didn‚Äôt needed and which I deleted from my code.  As a result, client-side router operation is defined like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> routes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UniversalRouter([ { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'/sign-in'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-string"><span class="hljs-string">'login'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-string"><span class="hljs-string">'sign-in'</span></span> } }) }, { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'/sign-up'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-string"><span class="hljs-string">'login'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-string"><span class="hljs-string">'sign-up'</span></span> } }) }, { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-string"><span class="hljs-string">'home'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { req, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-string"><span class="hljs-string">'home'</span></span> } }) }, { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'/page/:page'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-string"><span class="hljs-string">'home'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { req, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-string"><span class="hljs-string">'home'</span></span> } }) }, { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'/feed'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-string"><span class="hljs-string">'home'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { req, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-string"><span class="hljs-string">'feed'</span></span> } }) }, { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'/feed/page/:page'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-string"><span class="hljs-string">'home'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { req, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-string"><span class="hljs-string">'feed'</span></span> } }) }, ... { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'(.*)'</span></span>, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-string"><span class="hljs-string">'notFound'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-string"><span class="hljs-string">'not-found'</span></span> } }) } ]) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> root = getRootComponent() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> history = createBrowserHistory() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> render = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (location) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> route = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> router.resolve(location) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> component = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">`./riot/pages/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${route.page}</span></span></span><span class="hljs-string">.riot`</span></span>) riot.register(route.page, component.default || component) root.update(route, root) } history.listen(render)</code> </pre><br>  Now, any call to history.push () will trigger routing.  To navigate inside the application, you also need to create a component that wraps the standard HTML element a (anchor), not forgetting to cancel its default behavior: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">navigation-link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">props.href</span></span></span><span class="hljs-tag"> } </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag"> }&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">import</span></span></span><span class="javascript"> history </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">from</span></span></span><span class="javascript"> </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'../history'</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">export</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">default</span></span></span><span class="javascript"> { action (e) { e.preventDefault() history.push(</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.props.href) </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.props.onclick) { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.props.onclick.call(</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">, e) } e.stopPropagation() } } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">navigation-link</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h3>  Application State Management </h3><br>  Initially, I included the mobx library in the project.  Everything worked as expected.  With the exception of the fact that it did not quite fit the task - the research that I set at the beginning of the article  So I switched to <a href="https://github.com/zerobias/effector">github.com/zerobias/effector</a> .  This is a very powerful project.  It gives 100% of redux functionality (only without large overheads) and 100% mobx functionality (although in this case it will be necessary to encode a bit more, but still less if compared with mobx without decorators) <br><br>  The description of the store looks like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore, createEvent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'effector'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { request } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../agent'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { parseError } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../utils'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProfileStore</span></span></span><span class="hljs-class"> </span></span>{ get store () { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profileStore.getState() } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> () { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.success = createEvent() <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error = createEvent() <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.updateError = createEvent() <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.init = createEvent() <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.profileStore = createStore(<span class="hljs-literal"><span class="hljs-literal">null</span></span>) .on(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.init, (state, store) =&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ ...store }</span></span></span><span class="hljs-function">)) .</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">on</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.success, (state, data</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ data })) .on(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error, (state, error) =&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ error }</span></span></span><span class="hljs-function">)) .</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">on</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.updateError, (state, error</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ ...state, error })) } getProfile ({ req, author }) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request(req, { <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'get'</span></span>, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">`/profiles/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">decodeURIComponent</span></span></span></span><span class="hljs-string"><span class="hljs-subst">(author)}</span></span></span><span class="hljs-string">`</span></span> }).then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.success(response.data.profile), error =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error(parseError(error)) ) } follow ({ author, method }) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, { method, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">`/profiles/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${author}</span></span></span><span class="hljs-string">/follow`</span></span> }).then( <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.success(response.data.profile), error =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error(parseError(error)) ) } }</code> </pre><br>  This library uses full-fledged reducers (they are called so in effector.js documentation), which many lack in mobx, but with strikingly less coding efforts, compared to redux.  But the main thing is not even that.  Having received 100% of the functionality of redux and mobx, I used only a tenth of the functionality that is incorporated in effector.js.  From which we can conclude that its use in complex projects can significantly enrich the means of developers. <br><br><h3>  Testing </h3><br>  <a href="https://habr.com/ru/users/todo/" class="user_link">Todo</a> <br><br><h3>  findings </h3><br>  So, the work is complete.  The result is presented in the <a href="https://github.com/apapacy/realworld-riotjs-effector-universal-hot">github.com/apapacy/realworld-riotjs-effector-universal-hot</a> repository and in this article on Habr√©. <br>  Demo site on now <a href="https://realworld-riot-effector-universal-hot-pnujtmugam.now.sh/">realworld-riot-effector-universal-hot-pnujtmugam.now.sh</a> <br><br>  And at the end I will share my impressions of development.  Developing on riot.js version 4.0 is quite convenient.  Many constructions are written easier than in the same React.  The development took exactly two weeks without fanaticism in the after-work and on weekends.  But ... One small but ... The miracle did not happen again.  Server rendering in React is 20-30 times faster.  Corporations are winning again.  However, two interesting routing libraries and a state manager have been tested. <br><br>  apapacy@gmail.com <br>  June 17, 2019 </div><p>Source: <a href="https://habr.com/ru/post/456448/">https://habr.com/ru/post/456448/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456436/index.html">A short JS task for Monday</a></li>
<li><a href="../45644/index.html">Usability when designing a site - who is responsible?</a></li>
<li><a href="../456440/index.html">The Adventures of the Elusive Malvari, Part 1</a></li>
<li><a href="../456442/index.html">Recruitment to the St. Petersburg State University undergraduate program with the support of Yandex and JetBrains</a></li>
<li><a href="../456446/index.html">Ceph - from "on the knee" to "production"</a></li>
<li><a href="../456450/index.html">DO-RA.Avia for monitoring cosmic radiation in aviation</a></li>
<li><a href="../456452/index.html">C ++ code examples before and after Ranges</a></li>
<li><a href="../456454/index.html">A review of the new javascript framework Htmlix</a></li>
<li><a href="../45646/index.html">Boyan instead of lowering karma</a></li>
<li><a href="../456462/index.html">Building a library of angular components in the form of web components</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>