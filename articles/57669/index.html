<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The program for working with windows as in Windows 7 - with the help of hotkeys: Win + [Up | Down | Left | Right]</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rarely use what you write yourself. But here is the rare case. 
 In Windows 7, I really liked the ability to position windows using keyboard shortcuts...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The program for working with windows as in Windows 7 - with the help of hotkeys: Win + [Up | Down | Left | Right]</h1><div class="post__text post__text-html js-mediator-article">  Rarely use what you write yourself.  But here is the rare case. <br>  In Windows 7, I really liked the ability to position windows using keyboard shortcuts: <br>  Win + Left - the window is attached to the left edge <br>  Win + Right - the window is attached to the right edge <br>  Win + Up - maximize window <br>  Win + Bottom - window in normal condition. <br>  And the mounting of windows to the right and left, in my opinion, is a very convenient thing, because how many times did you have to have two windows on the screen, with the possibility of comparing or reprinting ... <br> <a href="http://pics.livejournal.com/outcoldman/pic/0000hz05/"><img width="320" height="200" src="https://habrastorage.org/getpro/geektimes/post_images/90e/fa4/b90/90efa4b90d5ca47ebbe1fb7613b9a91e.png"></a> <br>  I do not want to use Windows 7 as the main OS - because beta (or CR, the main thing is not Release), but I want to use the possibility described above.  And now - I was not lazy, and I wrote a program on C # that implements this functionality in Vista (most likely it works even in earlier versions - I just didn‚Äôt check it).  And as it turned out - the task is not so difficult.  I had to import a lot of WinApi functions, and the implementation itself was divided into two: a) a functional that intercepts pressing the necessary shortcut keys b) window positioning. <br><a name="habracut"></a><br>  I solved the first task with the help of the article <a href="http://eknowledger.spaces.live.com/Blog/cns%2521F475D4DE444DB1AB%2521695.entry">Low-Level Keyboard Hook in C #</a> , all I had to do was find the opportunity to find out when the LWin key was pressed: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#2B91AF">IntPtr</font> HookCallback( <br> <font color="#0000ff">int</font> nCode, <font color="#2B91AF">IntPtr</font> wParam, <font color="#2B91AF">IntPtr</font> lParam) <br> { <br> <font color="#0000ff">if</font> (nCode &gt;= 0 &amp;&amp; wParam == ( <font color="#2B91AF">IntPtr</font> )WAKeysHook.WmKeyDown) <br> { <br> <font color="#0000ff">if</font> (( <font color="#0000ff">int</font> )WAKeysHook.GetAsyncKeyState(( <font color="#2B91AF">IntPtr</font> )Keys.LWin) != 0) <font color="#008000">// Left Win Key</font> <br> { <br> Keys key = (Keys) Marshal.ReadInt32(lParam); <br> <font color="#0000ff">if</font> (key == Keys.Left || key == Keys.Right || key == Keys.Up || key == Keys.Down) <font color="#008000">// Arrows keys</font> <br> SetWindowLocation(key); <br> } <br> } <br> <font color="#0000ff">return</font> WAKeysHook.CallNextHookEx(WaKeysHook.HookId, nCode, wParam, lParam); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  The second part of the task is to find the active window and set it to be literate in size (of course you need to take into account that only windows with this capability can be resized (WS_SIZEBOX), as well as some windows have the maximum allowed dimensions of their window, like cmd.exe) : <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> SetWindowLocation(Keys k) <br> { <br> <font color="#008000">//Active Window</font> <br> <font color="#2B91AF">IntPtr</font> window = WAWindows.GetForegroundWindow(); <br> <font color="#008000">// Check SIZEBOX Style (Window can sizable)</font> <br> <font color="#0000ff">if</font> ((( <font color="#0000ff">int</font> )WAWindows.GetWindowLongPtr(window, WAWindows.GwlStyle) &amp; WAWindows.WsSizebox) <br> == WAWindows.WsSizebox) <br> { <br> <font color="#008000">// Show window in normal state (if always maximized)</font> <br> WAWindows.ShowWindow(window, ( <font color="#0000ff">int</font> )WAWindows.WindowShowStyle.ShowNormal); <br> <br> <font color="#008000">//Need Maximazed</font> <br> <font color="#0000ff">if</font> (k != Keys.Down) <br> { <br> WAWindows.ShowWindow(window, ( <font color="#0000ff">int</font> )WAWindows.WindowShowStyle.ShowMaximized); <br> <br> <font color="#008000">// Place Window on left or right</font> <br> <font color="#0000ff">if</font> (k != Keys.Up) <br> { <br> WAWindows.Rect rect, rectDesktop; <br> <font color="#0000ff">if</font> (WAWindows.GetWindowRect(window, <font color="#0000ff">out</font> rect) &amp;&amp; WAWindows.GetWindowRect(WAWindows.GetDesktopWindow(), <font color="#0000ff">out</font> rectDesktop)) <br> { <br> WAWindows.SetWindowPos(window, WAWindows.HwndTop, (k == Keys.Left) ? <font color="#2B91AF">Math</font> .Min(rect.Left, 0) : rectDesktop.Right / 2, rect.Top, <font color="#2B91AF">Math</font> .Min(rect.Width, rectDesktop.Right / 2 - <font color="#2B91AF">Math</font> .Min(rect.Left, 0)), <br> <font color="#2B91AF">Math</font> .Min(rect.Height, rectDesktop.Bottom), WAWindows.SwpShowwindow); <br> } <br> } <br> } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  And finally, in my program, I introduced the option of setting whether it is necessary to display the icon in the tray or not, which helps in closing the program, for this you need to set the value in the corresponding app.config section. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">applicationSettings</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">VistaKeysExtender.Properties.Settings</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">setting</font> <font color="#ff0000">name</font> <font color="#0000ff">="ShowNotifyIcon"</font> <font color="#ff0000">serializeAs</font> <font color="#0000ff">="String"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">value</font> <font color="#0000ff">&gt;</font> False <font color="#0000ff">&lt;/</font> <font color="#800000">value</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">setting</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">VistaKeysExtender.Properties.Settings</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">applicationSettings</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  I just do not need the icon itself, the program is always spinning in the background, and the place in the tray is so crowded.  I described the function keys at the top of the article.  Questions and suggestions are ready to listen and answer them.  I hope that this program will be as useful to someone as me. <br>  <b>UPD:</b> The program received a continuation of this address <a href="http://outcoldman.habrahabr.ru/blog/57792/">http://outcoldman.habrahabr.ru/blog/57792/</a> <br><ul><li>  <a href="">Keys Extender (Win 7 Compatible) - binary</a> </li><li>  <a href="">Keys Extender (Win 7 Compatible) - binary (x64)</a> </li><li>  <a href="">Keys Extender (Win 7 Compatible) - source</a> </li><li>  <a href="http://www.codeproject.com/KB/cs/KeysExtender.aspx">Article on CodeProject</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/57669/">https://habr.com/ru/post/57669/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../57662/index.html">Userjs, accelerating scrolling pages on Habr√©</a></li>
<li><a href="../57663/index.html">Infrastructure of modern office - 3</a></li>
<li><a href="../57664/index.html">The Swedes took to the demonstration in support of Pirate Bay</a></li>
<li><a href="../57666/index.html">And my baby stork brought</a></li>
<li><a href="../57667/index.html">Free CMS for structured data. Exist?</a></li>
<li><a href="../57671/index.html">Remix Conference - What do people say?</a></li>
<li><a href="../57672/index.html">I18n without URL</a></li>
<li><a href="../57673/index.html">We change the cracked screen in the laptop</a></li>
<li><a href="../57674/index.html">MySQL Embedded and License</a></li>
<li><a href="../57676/index.html">Accelerate HD video playback</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>