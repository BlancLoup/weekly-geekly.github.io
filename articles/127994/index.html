<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HTML and SVG: creating an interactive map</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let's create an interactive map. Something. What does interactive mean? Well, it must interact with the user and with the data on the web page on whic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HTML and SVG: creating an interactive map</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/d3217092/09cf7206/63aecca5/548ea7d2.png" align="left">  Let's create an interactive map.  Something.  What does interactive mean?  Well, it must interact with the user and with the data on the web page on which it is located.  I think this is enough to consider it interactive. <br><br>  Well, we take SVG.  Why?  Because it‚Äôs easy to work with someone familiar with HTML.  SVG is an XML-based vector format.  That is, the SVG image has its own DOM, you can apply CSS rules to various elements and manage the good old JavaScript. <br><br>  Well, let's start? <br><a name="habracut"></a><br>  The most impatient, can immediately see the <a href="http://envek.github.com/Amestris/">demo</a> , but I suggest reading about everything in order. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Preparing a map </h4><br>  First we need the essence.  I mean the card itself.  If Google doesn't help, then you can draw it yourself, even though it's not hard to do in <a href="http://www.inkscape.org/">Inkscape</a> . <br><br>  I, for example, will take a map of one round country ( <a href="">source for Wikimedia Commons</a> ) <br><br>  Since, in my plan, the map areas should not have a different color, first I cut out the fill and stroke styles from the &lt;path&gt; tags that interest me, but instead I give these elements the class and id I need.  For example, class = ‚Äúarea‚Äù for regions and class = ‚Äúcity‚Äù for cities. <br><br>  Next, in the &lt;defs&gt; section of the image we place a painfully familiar: <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-class"><span class="css"><span class="hljs-selector-class">.area</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">stroke</span></span></span><span class="css">: black; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">stroke-width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">2px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">fill</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">#E9FFE9</span></span></span><span class="css">; } </span><span class="hljs-selector-class"><span class="css"><span class="hljs-selector-class">.city</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">stroke</span></span></span><span class="css">: black; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">stroke-width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">2px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">fill</span></span></span><span class="css">: red; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Here is the CSS I promised in action.  In principle, this is already enough.  <a href="https://github.com/Envek/Amestris/commit/2b948350d67ac82893313f81cfa06f404cd3706e">Diff</a> . <br><br>  Result: <br><img src="https://habrastorage.org/storage1/a958b7b8/b9793ee8/7966d391/fb52ac86.png"><br><br><h4>  Insert SVG into HTML </h4><br>  This process was covered in sufficient detail in the habratopic <a href="http://habrahabr.ru/blogs/svg/99143/">On the issue of cross-browser use of SVG</a> . <br><br>  We will use HTML5 and use the easiest, most humane and standard way: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"map.svg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/svg+xml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"imap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"500"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"420"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  All browsers that <a href="http://caniuse.com/svg">support SVG</a> correctly "eat" it and show it.  And even give us work with him.  On one condition: if the web server returns it with the MIME type image / svg + xml.  Another MIME type can be very embarrassing to Google Chrome (but not Opera, which from the tag firmly knows what comes after SVG and cannot be provoked). <br><br>  The second correct method is to insert SVG code directly into HTML.  Great in terms of scripting, but browser support <a href="http://caniuse.com/svg-html5">is worse</a> .  By the way, notice that SVG, inserted into ‚Äúliberal‚Äù HTML, still remains ‚Äústern‚Äù XML.  So quotes and closing tags are required. <br><br><h5>  Underwater rake </h5><br>  But not everything is so simple.  Immediately you can see that browsers stubbornly do not want to scale our map, and if it does not fit, then show the scroll bars, like this: <img src="https://habrastorage.org/storage1/8a1d88f3/33e72804/0d1601b1/5ab67979.png"><br><br>  To force browsers to work with SVG in the way we expect, remove the width and height attributes from the &lt;svg&gt; tag in the SVG file (or set them to 100%), and insert the viewBox attribute that is specifically designed for browsers with the coordinates of the upper left and lower right corner of the image: <br><pre> <code class="hljs objectivec">viewBox=<span class="hljs-string"><span class="hljs-string">"0 0 493 416"</span></span></code> </pre>  <a href="https://github.com/Envek/Amestris/commit/dd439055c304a3a76bec993296de273ecda9a7cb">Diff</a> . <br><br>  After that, the situation is much improved, but Google Chrome puts another one on us: it stubbornly seeks to scale the image to the height of the &lt;object&gt; element, rather than increasing the height of &lt;object&gt; according to the tag's width and image proportions like other browsers. <br><img src="https://habrastorage.org/storage1/9bb081c6/c2dc9f79/b6b67d4d/cef9b7bf.png"><br>  It's a pity.  It is necessary to attract JavaScript and adjust the height of the element manually. <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> viewBox = svgdom.rootElement.getAttribute(<span class="hljs-string"><span class="hljs-string">"viewBox"</span></span>).<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(<span class="hljs-string"><span class="hljs-string">" "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> aspectRatio = viewBox[<span class="hljs-number"><span class="hljs-number">2</span></span>] / viewBox[<span class="hljs-number"><span class="hljs-number">3</span></span>]; svgobject.height = parseInt(svgobject.offsetWidth / aspectRatio);</code> </pre>  <a href="https://github.com/Envek/Amestris/commit/794eccdf123849ab6002a6b384aee48a68b93537">Diff</a> . <br><br>  Result: <br><img src="https://habrastorage.org/storage1/6a641d21/9f38b956/f7efea62/59ecb9a6.png"><br><br><h4>  Interact with SVG </h4><br>  In order for us to interact with SVG, written directly in HTML, nothing is needed - it is already part of the DOM web page. <br><br>  Accessing an SVG inserted through &lt;object&gt; is a bit more complicated: <br><pre> <code class="javascript hljs">jQuery(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>).load(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   ,    (   ) ,   window.onload, var svgobject = document.getElementById('svgmap'); //   &lt;object&gt; if ('contentDocument' in svgobject) { //     - ? var svgdom = jQuery(svgobject.contentDocument); //      SVG- //    , : jQuery("#figure1", svgdom).attr("fill", "red"); //    id="figure1"  SVG DOM     } });</span></span></code> </pre> <br>  Yes, jQuery works with SVG, but only partially.  For example, I noticed that the addClass and removeClass functions, as well as the search by class ( <code>jQuery(".class")</code> ), do not work.  <a href="https://github.com/Envek/Amestris/commit/1a79032df63c79b1323992cf609422ca94b2a060">It is necessary to pervert.</a> <br><br>  Notice that I use the window.onload event, since we need to wait until the page is fully loaded, along with all the related elements (including our map).  However, even here Google Chrome is in a hurry to put a pig on us: if the script with window.onload is in the html code before the &lt;object&gt; tag, then the code in the handler is executed BEFORE the map actually loads.  Therefore, the &lt;script&gt; tag must be placed after our map.  Sad but true. <br><br><h5>  Interactivity first: select areas on the map by clicking on the checkbox on the page. </h5><br>  For this interaction, we will need checkboxes in each row of the table with areas, as well as matching or similar id at the lines of the table and areas on the map. <br><br>  Here, when clicking on the checkbox, we will set or remove the <code>selected</code> class from the corresponding area on the map, and already near the line itself.  It is not difficult: <br><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">"#areas input[type=checkbox]"</span></span>).change(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> row = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).parent().parent(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = row.attr(<span class="hljs-string"><span class="hljs-string">"id"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.checked) { row.addClass(<span class="hljs-string"><span class="hljs-string">"selected"</span></span>); $(<span class="hljs-string"><span class="hljs-string">"#"</span></span>+id, svgdom).myAddClass(<span class="hljs-string"><span class="hljs-string">"selected"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { row.removeClass(<span class="hljs-string"><span class="hljs-string">"selected"</span></span>); $(<span class="hljs-string"><span class="hljs-string">"#"</span></span>+id, svgdom).myRemoveClass(<span class="hljs-string"><span class="hljs-string">"selected"</span></span>); } });</code> </pre> <br>  Accordingly, you need to add style definitions for this class.  I give you this to do it yourself, according to your tastes and preferences.  <a href="https://github.com/Envek/Amestris/commit/5d0580dadda850f66ab0d24210f3603082c7874e">Diff</a> . <br><img src="https://habrastorage.org/storage1/db048331/9d1bc708/289356a7/78bbff63.png"><br><br><h5>  Interactivity two: open / show names on the map by clicking on the checkbox on the page. </h5><br>  This interaction is made even easier.  We insert into the <code>&lt;input type="checkbox" id="titleswitch"&gt;</code> and a little javascript that adds / removes the <code>hidden {visibility: hidden;}</code> class to all map-related items on the map: <br><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">"#titleswitch"</span></span>).change(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> elements = $(svgdom.getElementsByClassName(<span class="hljs-string"><span class="hljs-string">"areatitle"</span></span>)) .add($(svgdom.getElementsByClassName(<span class="hljs-string"><span class="hljs-string">"citytitle"</span></span>))) .add($(svgdom.getElementsByClassName(<span class="hljs-string"><span class="hljs-string">"titlebox"</span></span>))) .add($(svgdom.getElementsByClassName(<span class="hljs-string"><span class="hljs-string">"titleline"</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.checked) { elements.myAddClass(<span class="hljs-string"><span class="hljs-string">"hidden"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { elements.myRemoveClass(<span class="hljs-string"><span class="hljs-string">"hidden"</span></span>); } });</code> </pre> <br>  <a href="https://github.com/Envek/Amestris/commit/568eaff575bf08e99a6ab45f39eabb2acedba237">Here it is</a> . <br><img src="https://habrastorage.org/storage1/44f4adb9/3a7515bb/563f1d5a/634f5dc5.png"><br><br><h5>  Third interactivity: highlight areas on the map when you hover over a row in a table (and vice versa) </h5><br>  To do this, you need to hang the onhover event handlers as on the table: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//         .  . $("#areas tr").hover( function () { var id = $(this).attr("id"); $("#"+id, svgdom).myAddClass("highlight"); }, function () { var id = $(this).attr("id"); $("#"+id, svgdom).myRemoveClass("highlight"); } );</span></span></code> </pre> <br>  ... and on the districts on the map: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//         .    $(svgdom.getElementsByClassName("area")).hover( function () { var id = $(this).attr("id"); $("#areas #"+id).addClass("highlight"); }, function () { var id = $(this).attr("id"); $("#areas #"+id).removeClass("highlight"); } );</span></span></code> </pre> <br>  In order for us to see this, add the appropriate CSS rules to the page: <br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">tr</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.highlight</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">tr</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">tr</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:nth-child(even)</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: lightyellow; }</code> </pre>  ... and to the SVG map: <pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.highlight</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.area</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">fill</span></span>: lightyellow; <span class="hljs-attribute"><span class="hljs-attribute">stroke</span></span>: black; }</code> </pre><br>  When you hover the mouse on a row of a table (or on a district on a map) on a corresponding region on a map (on a row of a table), the class required for highlighting is hung.  In order for the above code to work, it is necessary that the areas on the map and the rows of the table have the same (or similar) id.  <a href="https://github.com/Envek/Amestris/commit/23d481eb38bd9ec4740b1bb81b81fc1b60ee2feb">Diff</a> . <br><img src="https://habrastorage.org/storage1/c51c74ba/6cc50090/bbc546f0/770078c3.png"><br><br><h5>  Interactivity fourth: We display data from the page on the map </h5><br>  Well, banal assignment of classes, probably, already bored.  Let the map show us some data on yourself. <br><br>  First things first: data.  Add a couple of columns to our plate, for example, People and Money.  <strong>Attention</strong> : The data are taken from the bald and have nothing to do with the real Amestris.  As well as radio buttons, by which we will switch, what data to show. <br><br>  Secondly, we need a place on the map where the data will be displayed.  Add five &lt;text&gt; blocks to the map (one for each region, matching their id with the regions) and the corresponding styles in &lt;defs&gt;: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"areavals"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"190.29787"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"246.35461"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text3186"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Well, and JavaScript-code, which will take data from the cells of the table and put in blocks of text: <br><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">"input[name=tabledata]"</span></span>).change(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> descnum = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).parent().prevAll().length+<span class="hljs-number"><span class="hljs-number">1</span></span>; $(<span class="hljs-string"><span class="hljs-string">"#areas tbody tr"</span></span>).each(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).attr(<span class="hljs-string"><span class="hljs-string">"id"</span></span>).substring(<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).children(<span class="hljs-string"><span class="hljs-string">":nth-child("</span></span>+descnum+<span class="hljs-string"><span class="hljs-string">")"</span></span>).text(); $(<span class="hljs-string"><span class="hljs-string">"#text"</span></span>+id, svgdom).text(value); }); });</code> </pre> <br>  And by switching radio buttons, the map will show the necessary numbers.  <a href="https://github.com/Envek/Amestris/commit/c567c806a7816dcd49da6d97cdef0b17bacb76f3">Voila</a> ! <br><img src="https://habrastorage.org/storage1/122acb39/5c1b5f91/7a78980b/9fc7d096.png"><br><br><h5>  Interactivity fifth: tooltips </h5><br>  Perhaps this is already superfluous, but let it be.  For even counting. <br><br>  For this interaction, take the <a href="http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/">jQuery.tooltip</a> plugin and tie it to areas on the map.  The text for the tips will be taken, of course, from the table: <br><pre> <code class="javascript hljs">$(svgdom.getElementsByClassName(<span class="hljs-string"><span class="hljs-string">"area"</span></span>)).tooltip({ <span class="hljs-attr"><span class="hljs-attr">bodyHandler</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).attr(<span class="hljs-string"><span class="hljs-string">"id"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> area = $(<span class="hljs-string"><span class="hljs-string">"#areas #"</span></span>+id+<span class="hljs-string"><span class="hljs-string">" td:nth-child(2)"</span></span>).text(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = $(<span class="hljs-string"><span class="hljs-string">"&lt;p&gt;"</span></span>).append($(<span class="hljs-string"><span class="hljs-string">"&lt;strong&gt;"</span></span>).text(area)); $(<span class="hljs-string"><span class="hljs-string">"#areas #"</span></span>+id+<span class="hljs-string"><span class="hljs-string">" td:nth-child(2)"</span></span>).nextAll().each(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pos = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).prevAll().length+<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> title = $(<span class="hljs-string"><span class="hljs-string">"#areas thead th:nth-child("</span></span>+pos+<span class="hljs-string"><span class="hljs-string">")"</span></span>).text(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).text(); result.append($(<span class="hljs-string"><span class="hljs-string">"&lt;p&gt;"</span></span>).text(title + <span class="hljs-string"><span class="hljs-string">": "</span></span> + value)); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } });</code> </pre> <br><img src="https://habrastorage.org/storage1/71bbaa8d/f9d72b55/d54b28c7/88a4f52a.png"><br>  <a href="https://github.com/Envek/Amestris/commit/a202b2960d9f9c198064ad6e49326f3e53e774a1">Diff</a> . <br><br><h5>  And so on‚Ä¶ </h5><br>  Of course, the possibilities of interaction with SVG are not limited to this.  You can do <strong>everything</strong> .  Shuffle the DOM, change the page and SVG for AJAX requests and much, much more.  Dare. <br><br><h4>  Result </h4><br><img src="https://habrastorage.org/storage1/f1344cd5/af543730/5aa9db29/34b1033c.png"><br><br><h5>  The remaining pitfalls </h5><br>  Of the known problems so far it can be noted that Google Chrome does not print SVG-pictures.  This is either <a href="http://code.google.com/p/chromium/issues/detail%3Fid%3D71419">his bug</a> or the <a href="https://bugs.webkit.org/show_bug.cgi%3Fid%3D65478">WebKit bug</a> in general. <br><br><h4>  backward compatibility </h4><br>  Almost all modern browsers support SVG: IE 9+, Opera 8+, Firefox 3+ (in Firefox 1.5+ partial support), all versions of Chrome, Safari 3.2+ ( <a href="http://caniuse.com/svg">more complete list</a> ) <br><br>  But alas, the bright future will not come all the way and we still have to think about the support of the old browsers. <br><br>  The standard and easiest way, if the SVG is just a picture: insert the replacement content (a rendered image and a paragraph of text in the PNG) inside the &lt;object&gt; tag. <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"map.svg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/svg+xml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"imap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"600"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"500"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"map.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"600"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"500"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> ,     ,     .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  If there is no SVG support in the browser, a PNG image and text will be shown to notify users that their browser is out of date.  No interactive.  However, it may not be very necessary.  True, there is one drawback - as I noticed, modern browsers stubbornly download the replacement png-picture for themselves, despite the fact that they will not display it anyway. <br><br>  Those interested can take advantage of the <a href="http://www.modernizr.com/docs/">detection of SVG support</a> using <a href="http://www.modernizr.com/">Modernizr</a> and heap up something more complicated on javascript. <br><br>  In more complex cases, multiple solutions in Flash, VML or Canvas (or all of them) can help.  The list can be found here: <a href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills">HTML5 Crossbrowser Polyfills</a> , but those solutions that I tried, unfortunately, did not help me.  Perhaps because that SVG with CSS that I sketched on my knee turned out to be too tough for them. <br><br><h5>  Convert SVG to PNG </h5><br>  There are many places in the network where you can convert an SVG image into something else.  I will suggest using the <b>rsvg-convert</b> command from the <b>librsvg2-bin</b> package.  Like this: <br><pre> <code class="bash hljs">cat map.svg | rsvg-convert &gt; map.png</code> </pre> <br>  However, it can convert to other formats, as well as increase / decrease the image, see - help. <br>  For mass transformations, you can compose a team more difficult or see examples in the <a href="http://ubuntuforums.org/showthread.php%3Fp%3D5131769">forum thread</a> , where I found this command. <br><br><h4>  Instead of conclusion </h4><br>  Well that's all.  Upon closer inspection, this is not so difficult, and most importantly, everything is close and familiar to the web developer.  See what I wrote above in the form of a <a href="http://envek.github.com/Amestris/">demo page</a> , tear apart the source code from the <a href="https://github.com/Envek/Amestris">repository</a> , if there are any suggestions and improvements - make comments in the comments or send to the repository in the form of <a href="http://habrahabr.ru/blogs/Git/125999/">pull requests</a> .  Enjoy your work with modern web technologies! </div><p>Source: <a href="https://habr.com/ru/post/127994/">https://habr.com/ru/post/127994/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127986/index.html">Program for sending SMS for mobile devices (iOS, Android) on HTML5</a></li>
<li><a href="../127987/index.html">Premature scaling - the main cause of death of startups?</a></li>
<li><a href="../127991/index.html">JavaScript Gaming: Part 1. Box2d and the basics of Physics</a></li>
<li><a href="../127992/index.html">What progress has reached, or c 1C can work on iPod</a></li>
<li><a href="../127993/index.html">Download map of Georgia on OpenStreetMap is over!</a></li>
<li><a href="../127996/index.html">Creating virtual hosts in apache under Linux in Python</a></li>
<li><a href="../127997/index.html">Connecting encrypted TrueCrypt partitions using Asterisk IP telephony server</a></li>
<li><a href="../127998/index.html">Rapid prototyping of a web service on the 1C platform: Enterprise 8</a></li>
<li><a href="../127999/index.html">Finding the minimum distance to a curve using the Yandex.Maps API</a></li>
<li><a href="../128000/index.html">Javascript: "classes" and inheritance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>