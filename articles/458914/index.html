<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What (not) you need to know to create games on Unity</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unity is a game engine, with far from zero entry threshold (comparing with the same Game Maker Studio), and in this article I will tell you what probl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What (not) you need to know to create games on Unity</h1><div class="post__text post__text-html js-mediator-article"><img width="100%" src="https://habrastorage.org/webt/tf/uv/8n/tfuv8nnybrkzyxholyzuoaasafo.png"><br><br>  Unity is a game engine, with far from zero entry threshold (comparing with the same Game Maker Studio), and in this article I will tell you what problems I encountered starting to study it, and what solutions I found.  I will describe these moments on the example of my 2d puzzle game for Android (which, I hope, will be released soon in the Play Market). <a name="habracut"></a><br><br>  I do not pretend to be true, and I do not call to repeat after myself, if you know the best way, I will only show you how I do it myself, and maybe someone who is just starting to get acquainted with Unity will create his indie masterpiece with less effort. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I am an engineer by designing power plants, but coding has always interested me, and I am familiar with some programming languages.  Therefore, we agree that to create games on Unity: <br><ul><li>  You need to know a little C # or JavaScript (at least C-shaped syntax). <br></li></ul><br>  Everything that will be written further, this is not a tutorial on Unity, of which there are enough in the network without me.  Below will be collected the difficult moments that may occur when creating your first project on Unity. <br><br>  It should be warned that in the provided scripts a large part of the game logic (representing ‚Äúcommercial secret‚Äù) is omitted, but their performance has been tested as examples. <br><br><h3>  Problem one - ORIENTATION </h3><br><img align="left" width="40%" src="https://habrastorage.org/webt/-f/za/hw/-fzahwdptbht2vwe1qm4xswgqkm.png"><br>  <b>Orientation lock</b> <br>  The first difficulty I had was that I did not pay enough attention to optimizing the visual interface for screen orientation.  The simplest solution is that if the screen orientation change is not needed for the gameplay, then it is better to block it.  No need for excessive flexibility, you are writing an indie game, not a project on the other side of a million dollars.  Why tons of conditional transitions and change of anchors, if the game looks better in Portrait (for example).  You can lock screen orientation here: <br>  <b>Edit&gt; Project Settings&gt; Player</b> <br clear="all"><br clear="all"><img align="right" width="40%" src="https://habrastorage.org/webt/jb/3u/ot/jb3uotkehyw_t2pa2e__yw0n2ng.png"><br>  <b>Different permissions</b> <br>  It is also important to test the visual interface at different resolutions in the selected orientation, and when testing, do not forget about the existence of devices with 4: 3 aspect ratios (well, or 3: 4), so feel free to add 768x1024 (or 1024x768). <br><br>  <b>Best positioning</b> <br>  To adjust the positioning and scale of game objects it is better to use the Rect Transform. <img align="left" width="40%" src="https://habrastorage.org/webt/rm/gk/ao/rmgkao3ttyvdkj3dbs8zmtxrm2o.png"><br><br clear="all"><br clear="all"><h3>  Problem Two - COMMUNICATION </h3><br>  I had a similar problem due to the fact that I made my first acquaintance with game-devise through Game Maker Studio, where the script is a full-fledged part of the game object, and it immediately has full access to all components of the object.  With Unity, the scripts are shared, and only their instances are added to the object.  Speaking simplistically, the script does not know directly which object is currently being executed.  Therefore, when writing scripts, it is necessary to take into account the initialization of interfaces for working with object components or with components of other objects. <br><br>  <b>We train on cats</b> <br>  In my game there is a GameField object, on the stage there is only one copy of it, there is also a script of the same name.  The object is responsible for displaying the game score and for playing the entire game sound, so in my opinion it is more economical for memory (there are only three Audio Source in the game - one Background Music, two other Sound Effects).  The script solves the issues of storing a game account, choosing an AudioClip to play sound, and for some game logic. <br><br>  We will dwell on the sound in more detail, since with this example it is easy to show the interaction of the script with the components of the object. <br><br><img width="40%" align="left" src="https://habrastorage.org/webt/2y/ll/ab/2yllabokihsyqwabiwnod3tiqyc.png">  Naturally, the object should have the GameField.cs script itself and the AudioSource component, in my case as many as two (later it will be clear why). <br clear="all"><br clear="all">  As it was said earlier, the ‚Äúnot aware‚Äù script that the object has an AudioSource component, therefore we declare and initialize the interface (for the time being we consider that AudioSource is only one): <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioSource Sound; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Sound = GetComponent&lt;AudioSource&gt; (); }</code> </pre> <br>  The method GetComponent &lt;type_type&gt; () will return the first component of the specified type from the object. <br><br>  In addition to AudioSource, you will need several AudioClip: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Header (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Audio clips"</span></span></span><span class="hljs-meta">)</span></span>] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnStart; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnEfScore; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnHighScore; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnMainTimer; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnBubbMarker; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnScoreUp;</code> </pre><br>  Here and further, the commands in square brackets are needed for the Inspector`a, more <a href="https://habr.com/ru/post/331042/">here</a> . <br><br><img width="40%" align="left" src="https://habrastorage.org/webt/wk/t-/k7/wkt-k7spezw5hanfme5xchxexzk.png"><br><br>  Now the script in the Inspector `e has new fields, in which we drag the necessary sounds. <br><br clear="all"><br clear="all">  Next, create a SoundPlay method in the script that accepts AudioClip: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ Sound.clip = Clip; Sound.Play (); }</code> </pre><br>  To play the sound in the game, we call this method at the right time with an indication of the clip. <br><br>  There is one significant disadvantage of this approach; only one sound can be played at a time, but during the game you may need to play two or more sounds, with the exception of background music that plays constantly. <br><br>  To avoid cacophony, I recommend avoiding the possibility of simultaneous playback of more than 4-5 sounds (preferably a maximum of 2-3), I mean playing short sounds of the first plan (jump, coin, player‚Äôs shot ...), for background noise it‚Äôs better to create your own source sound on the object that emits this noise (if you need a 2d-3d sound) or one object responsible for all the background noise (if "volume" is not needed). <br><br>  In my game, there is no need to simultaneously play more than two AudioClips.  For guaranteed reproduction of both hypothetical sounds, I added two AudioSource to the GameField object.  To determine the components in the script, use the method <br><pre> <code class="cs hljs">GetComponents&lt;_&gt;()</code> </pre><br>  which returns an array of all components of a specified type from an object. <br><br>  The code will look like this: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioSource[] Sound; <span class="hljs-comment"><span class="hljs-comment">//    void Start(){ Sound = GetComponents&lt;AudioSource&gt; (); //  GetComponents }</span></span></code> </pre><br>  Most changes will affect the PlaySound method.  I see two variants of this method: ‚Äúuniversal‚Äù (for any number of AudioSource in the object) and ‚Äúclumsy‚Äù (for 2-3 AudioSource, not the most elegant but less resource-intensive). <br><br>  "Clumsy" option for two AudioSource (I used it) <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].isPlaying) { Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].clip = Clip; Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].Play (); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Sound [<span class="hljs-number"><span class="hljs-number">1</span></span>].clip = Clip; Sound [<span class="hljs-number"><span class="hljs-number">1</span></span>].Play (); } }</code> </pre><br>  You can stretch into three or more AudioSource, but the number of conditions will devour all the performance savings. <br><br>  "Universal" option <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (AudioSource _Sound <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Sound) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_Sound.isPlaying) { _Sound.clip = Clip; _Sound.Play (); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } }</code> </pre><br><br>  <b>Appeal to someone else's component</b> <br>  There are several instances of the Fishka prefab on the playing field, like a game chip.  It is built like this: <br><ul><li>  Parent with its SpriteRenderer; <ul><li>  Child objects with their SpriteRenderer. </li></ul></li></ul><br>  Child objects are responsible for drawing the body of the chip, its color, additional variable elements.  The parent object draws a marker edging around the chip (according to the game, you need to select the active chip).  The script is only on the parent object.  Thus, to manage child sprites, you need to specify these sprites for the parent script.  I organized it this way - in the script I created interfaces for accessing the child SpriteRenderer: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Header (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Graphic objects"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SpriteRenderer Marker; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Base; [Space] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Red; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Green; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Blue;</code> </pre><br>  Now the script in the Inspector`e has additional fields: <br><img src="https://habrastorage.org/webt/mq/w9/kp/mqw9kpst-fen-bkdtgp_8jycpck.png"><br><br clear="all">  Dragging the child elements into the corresponding fields we get access to them in the script. <br><br clear="all">  Example of use: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//        Marker.enabled = !Marker.enabled; }</span></span></code> </pre><br><br clear="all">  <b>Appeal to someone else's script</b> <br>  In addition to manipulating other people's components, you can also access the script of a third-party object, work with its Public variables, methods, subclasses. <br><br>  I will give an example on the already known GameField object. <br><br>  The GameField script has a public method, FishkiMarkerDisabled (), which is needed to ‚Äúremove‚Äù a marker from all chips on the field and is used in the process of setting a marker when clicking on a chip, since only one can be active. <br><br>  In the Fishka.cs script, SpriteRenderer Marker is public, that is, it can be accessed from another script.  To do this, in the GameField.cs script, add the declaration and initialization of interfaces for all instances of the Fishka class (when the script is created, a class of the same name is created in it) like it was done for several AudioSource: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Fishka[] Fishki; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Fishki = GameObject.FindObjectsOfType (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Fishka)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Fishka[]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FishkiMarkerDisabled</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (Fishka _Fishka <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Fishki) { _Fishka .Marker.enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre><br>  In the Fishka.cs script, we add the declaration and initialization of the interface of the GameField class instance and when clicking on an object we will call the FishkiMarkerDisabled () method of this class: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameField gf; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gf = GameObject.FindObjectOfType (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(GameField)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameField; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gf.FishkiMarkerDisabled(); Marker.enabled = !Marker.enabled; }</code> </pre><br>  Thus, it is possible to interact between scripts (more correctly, classes) of different objects. <br><br clear="all"><br clear="all"><h3>  Problem Three - KEEPERS </h3><br>  <b>Account keeper</b> <br>  As soon as something like an account appears in the game, immediately the problem of its storage arises, both during and outside the game, you also want to save the record in order to encourage the player to surpass it. <br><br>  I will not consider options when the whole game (menu, game, withdrawal) is built in one scene, because, firstly, this is not the best way to build the first project, secondly, in my opinion, the initial boot scene should be .  Therefore, we agree that the project has four scenes: <br><ol><li>  loader - a scene in which the background music object is initialized (more detailed later), and loading settings from the save; <br></li><li>  menu - a scene with a menu; <br></li><li>  game - game scene; <br></li><li>  score - the scene of the withdrawal of the score, record, leaderboard. <br></li></ol><br><img width="40%" align="right" src="https://habrastorage.org/webt/dy/yl/4t/dyyl4tkmtx6a0ijbnjiy1jgkr9q.png"><br>  <i>Note: Scene loading order is set in File&gt; Build Settings</i> <br clear="all"><br clear="all">  Points scored during the game are stored in the Score variable of the GameField class.  To access the data on the transition to the scores stage, create a public static class ScoreHolder, in which we will declare a variable to store the value and a property to get and set the value of this variable (the method <a href="https://habr.com/ru/post/440718/">found</a> in <a href="https://habr.com/ru/users/apocatastas/" class="user_link">apocatastas</a> ): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ScoreHolder</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _Score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Score { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _Score; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _Score = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } }</code> </pre><br>  The public static class does not need to be added to any object; it is immediately available in any scene from any script. <br><br>  An example of using the GameField class in the transition method to the scores stage: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.SceneManagement; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameField</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     ,         Scores void GotoScores(){ ScoreHolder.Score = Score; //   ScoreHolder.Score   SceneManager.LoadScene (‚Äúscores‚Äù); } }</span></span></code> </pre><br>  In the same way, you can add a storage to the ScoreHolder during the game of a record score, but it will not be saved upon exit. <br><br clear="all">  <b>Settings Keeper</b> <br>  Consider the example of saving the value of a Boolean variable SoundEffectsMute, depending on the state of which the game has sound effects or not. <br><br>  The variable itself is stored in a public static class SettingsHolder: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingsHolder</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _SoundEffectsMute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> SoundEffectsMute{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _SoundEffectsMute; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _SoundEffectsMute = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } }</code> </pre><br>  The class is similar to ScoreHolder, you could even combine them into one, but in my opinion this is a moveton. <br><br>  As can be seen from the script, by default _SoundEffectsMute is declared false, so every time the game starts, the SettingsHolder.SoundEffectsMute will return false regardless of whether the user has previously changed it or not (using the button on the menu menu to change it). <br><br clear="all">  <b>Saving Variables</b> <br>  The most optimal for the Android application will be using the PlayerPrefs.SetInt method for saving (for more, see the <a href="https://docs.unity3d.com/ScriptReference/PlayerPrefs.html">official documentation</a> ).  There are two options to keep the SettingsHolder.SoundEffectsMute value in PlayerPrefs, let's call them ‚Äúsimple‚Äù and ‚Äúelegant‚Äù. <br><br clear="all">  The ‚Äúsimple‚Äù method (for me) is in the OnMouseDown () method of the class of the above button.  The stored value is loaded in the same class but in the Start () method: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ButtonSoundMute</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    ,  PlayerPrefs    bool switch (PlayerPrefs.GetInt ("SoundEffectsMute")) { case 0: SettingsHolder.SoundEffectsMute = false; break; case 1: SettingsHolder.SoundEffectsMute = true; break; default: //    default SettingsHolder.SoundEffectsMute = true; break; } } void OnMouseDown(){ SettingsHolder.SoundEffectsMute = !SettingsHolder.SoundEffectsMute; //    ,  PlayerPrefs    bool if (SettingsHolder.SoundEffectsMute) PlayerPrefs.SetInt ("SoundEffectsMute", 1); else PlayerPrefs.SetInt ("SoundEffectsMute", 0); } }</span></span></code> </pre><br><br clear="all">  "Elegant" way, in my opinion, is not the most correct, because  complicate the maintenance of the code, but there is something in it, and I can not share it.  A feature of this method is that the SettingsHolder.SoundEffectsMute property setter is called at the moment that does not require high performance, and you can load it (oh, horror) using PlayerPrefs (read by writing to a file).  Change public static class SettingsHolder: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingsHolder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _SoundEffectsMute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> SoundEffectsMute{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _SoundEffectsMute; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _SoundEffectsMute = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_SoundEffectsMute) PlayerPrefs.SetInt (<span class="hljs-string"><span class="hljs-string">"SoundEffectsMute"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> PlayerPrefs.SetInt (<span class="hljs-string"><span class="hljs-string">"SoundEffectsMute"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } }</code> </pre><br>  The OnMouseDown method of the ButtonSoundMute class is simplified to: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ SettingsHolder.SoundEffectsMute = !SettingsHolder.SoundEffectsMute; }</code> </pre><br><br clear="all">  Load getter reading from the file is not worth it, because it is involved in the performance-critical process - in the PlaySound () method of the GameField class: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!SettingsHolder.SoundEffectsMute) { <span class="hljs-comment"><span class="hljs-comment">//      ‚Äú‚Äù  (. ) if (!Sound [0].isPlaying) { Sound [0].clip = Clip; Sound [0].Play (); } else { Sound [1].clip = Clip; Sound [1].Play (); } } }</span></span></code> </pre><br><br clear="all">  As described above, you can organize in-game storage of any variable. <br><br clear="all"><br clear="all"><h3>  Problem Five - ONE FOR ALL </h3><br>  <b>This music will be eternal</b> <br>  Everyone faces this problem sooner or later, and I was no exception.  As planned, the background music begins to play in the scene menu, and if it is not turned off, then the menu, game and scores play on the scenes without interruption.  But if the object ‚Äúplaying‚Äù background music is set on the menu stage, when you go to the game scene, it is destroyed and the sound disappears, and if you place the same object on the game scene, then after the transition the music plays first.  The solution turned out to be the use of the DontDestroyOnLoad (Object target) method of the class placed in the Start () method, which has a ‚Äúmusical‚Äù object a script instance.  To do this, create a DontDestroyThis.cs script: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DontDestroyThis</span></span>: <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ DontDestroyOnLoad(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gameObject); } }</code> </pre><br><img width="40%" align="left" src="https://habrastorage.org/webt/ee/cj/hn/eecjhn5uyzoclq7ywnqztl1untu.png">  For everything to work, the ‚Äúmusical‚Äù object must be root (at the same hierarchy level as the main camera). <br clear="all"><br clear="all">  <b>Why background music in loader</b> <br>  The screenshot shows that the ‚Äúmusical‚Äù object is not located on the menu menu but on the loader stage.  This is a measure caused by the fact that the menu scene can be loaded more than once (after the scores scene, the transition to the menu scene), and each time it is loaded, another ‚Äúmusical‚Äù object will be created, and the old one will not be deleted.  It can be done as in the example of <a href="https://docs.unity3d.com/ScriptReference/Object.DontDestroyOnLoad.html">official documentation</a> , I decided to use the fact that the scene loader is guaranteed to be loaded only once. <br><br>  On this, the key problems that I encountered when developing my first game on Unity, before being unloaded in the Play Market (I have not yet registered a developer account), have successfully ended. <br><br>  <b>PS</b> <br>  <i>If the information was useful, you can support the author, and he will finally register an Android account for the developer.</i> </div><p>Source: <a href="https://habr.com/ru/post/458914/">https://habr.com/ru/post/458914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458906/index.html">[Ekaterinburg, Announcement] Flutterton - workshop about the development on Flutter</a></li>
<li><a href="../458908/index.html">Scanning documents online</a></li>
<li><a href="../45891/index.html">Overview of MQ (Messages queue) for use in projects on PHP. Part 2</a></li>
<li><a href="../458910/index.html">Benchmarking PostgreSQL with large Linux pages</a></li>
<li><a href="../458912/index.html">Migrate to Zimbra with imapsync</a></li>
<li><a href="../458916/index.html">Under the hood of React. We write our implementation from scratch</a></li>
<li><a href="../458918/index.html">What can you learn from the design of giperkazualnyh games</a></li>
<li><a href="../45892/index.html">Stages of development of a promotional site. Request</a></li>
<li><a href="../458920/index.html">DevOps Fan Conference</a></li>
<li><a href="../458922/index.html">How to move from ESXi to KVM / LXD and not go crazy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>