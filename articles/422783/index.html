<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Better, faster, more powerful: styled-components v4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the material, the translation of which we publish today, wants to present the beta version of the library styled-components v4 to the we...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Better, faster, more powerful: styled-components v4</h1><div class="post__text post__text-html js-mediator-article"> The author of the material, the translation of which we publish today, wants to present the beta version of the library styled-components v4 to the web developer community.  Speaking on behalf of the creators of the library, he says that now in styled-components there is a new global API for working with styles and native support for the <code>as</code> and <code>ref</code> properties.  The library followed the path of abandoning <code>.extend</code> , it is compatible with StrictMode React v16 and has become better, faster and more powerful. <br><br> <a href="https://habr.com/company/ruvds/blog/422783/"><img src="https://habrastorage.org/webt/tx/xf/6u/txxf6u1rz9jrcize_-uuv7iykni.jpeg"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Features styled-components v4</font> </h2><br>  To install the latest version of styled-components, use the following command: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">npm</span></span> install styled-components<span class="hljs-variable"><span class="hljs-variable">@beta</span></span></code> </pre> <br>  You can familiarize yourself with the library's capabilities, check them out, and if it turns out that something needs to be improved in it, inform the developers about it.  <a href="https://www.styled-components.com/docs/faqs">Here</a> you can find instructions for switching to a new version of the library.  <a href="">Here is the</a> change log for styled-components v4.0.0-beta.0. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider the main features of this styled-components release: <br><br><ul><li>  Reduced size and increased speed.  The library size is reduced from 16.1 Kb to less than 15 Kb (its total size depends on your bandler and on the use of the babel plugin).  The speed of mounting has increased by about 25%, the speed of re-rendering - by about 7.5%. </li><li>  New API <code>createGlobalStyle</code> , which is a replacement for the old API <code>injectGlobal</code> with support for hot reset and themes. </li><li>  Support for the <code>as</code> property ‚Äî a more flexible alternative with <code>.withComponent()</code> . <br></li><li>  Disposal of <code>Comp.extend</code> with support for automatic translation of the code base into a unified <code>styled(Comp)</code> format <code>styled(Comp)</code> . </li><li>  Full compatibility with <a href="https://reactjs.org/docs/strict-mode.html">StrictMode</a> React v16.  This also means that developers had to abandon support for React v15 and other older versions of React (although it is possible to use polyfills for organizing work with styled-components v4 in React v15). </li><li>  Native <code>ref</code> support for any styled components, and, thanks to React v16, no need to use <code>innerRef</code> . </li></ul><br>  The styled-components library was released as a beta version so that those who use it would have enough time for stress testing changes, and so that you can prepare supporting mechanisms like type descriptions and syntax highlighting tools for new API.  The library is expected to remain in beta status for about a month. <br><br><h2>  <font color="#3AC1EF">Performance</font> </h2><br>  When the second version of styled-components was released, we promised, after finalizing the main API, to focus on performance.  Since then, thanks to patches, we have increased the performance of the library, which, in particular, led to a <a href="https://medium.com/styled-components/v3-1-0-such-perf-wow-many-streams-c45c434dbd03">10-fold</a> increase in performance in v3.1. <br><br>  Work on styled-components speed continues.  Due to internal optimizations related to working with memory, due to taking into account the implementation features of the JS engine and code refactoring, the styled-components v4 mount speed for both deep and wide component trees has increased by about 25%.  Dynamic style updates have become faster by about 7%.  Here is a comparison of the performance of styled-components v3 and v4, based on the results of three tests.  The first two relate to the study of mounting component trees, and the third concerns updating components with dynamic styles. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/497/2a7/0ff/4972a70fff6d1beb1a1f5d1bd8970bd4.png"><br>  <i>Performance comparison of styled-components v3 and v4</i> <br><br>  These results, obtained in isolated environments, look impressive.  However, it will be quite interesting to compare styled-components v4 with other libraries of the CSS-in-JS ecosystem, in particular, by mount speed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7df/0d7/5a3/7df0d75a3536f9f1588ab9f1da059604.png"><br>  <i>Performance comparison of styled-components v4 and other libraries</i> <br><br>  As you can see, the performance of the styled-components looks very impressive.  In particular, in comparison with the fastest libraries, the styled-components results are within the standard deviation from their results in terms of mount and update speeds.  All this allows you to officially declare that performance is no longer a problem with this library. <br><br>  Although the performance of styled-components is the result of the development of the library and the considerable time and effort spent on improving it, this does not mean that we will no longer deal with performance improvements.  If we find an opportunity to make the library even faster, we will use this opportunity. <br><br><h2>  <font color="#3AC1EF">New global styling API</font> </h2><br>  We have been engaged in the development of a new global styling API for quite a while.  The old API, <code>injectGlobal</code> , has three major flaws: it does not support dynamic update, hot reboot, and contextual use of themes. <br><br>  Now we are pleased to introduce <code>createGlobalStyle</code> , a new global styling API that supports dynamic updates.  This is how working with it looks like: <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createGlobalStyle } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"styled-components"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GlobalStyle = createGlobalStyle<span class="hljs-string"><span class="hljs-string">` html {   color: red; } `</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">App</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (   <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">     </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">GlobalStyle</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">     This is my app!   </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); }</code> </pre> <br>  Using <code>createGlobalStyle</code> global styles are now part of the React component tree.  Although, at first glance, there is nothing special about this, it makes it possible to dynamically update and hot reload styles, and also allows you to use <a href="https://www.styled-components.com/docs/advanced">contextual themes</a> for global styles.  All this looks exactly the same as when working with any other stylized components. <br><br><pre> <code class="hljs bash">import { createGlobalStyle, ThemeProvider } from <span class="hljs-string"><span class="hljs-string">"styled-components"</span></span>; //  ,       const GlobalStyle = createGlobalStyle` html {   background: <span class="hljs-variable"><span class="hljs-variable">${p =&gt; p.backgroundColor}</span></span>   color: red;   font-family: <span class="hljs-variable"><span class="hljs-variable">${p =&gt; p.theme.fontFamily}</span></span>; } `; <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> default <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">App</span></span></span></span>() { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> (   &lt;ThemeProvider theme={{ fontFamily: <span class="hljs-string"><span class="hljs-string">"Helvetica Neue"</span></span> }}&gt;     &lt;GlobalStyle backgroundColor=<span class="hljs-string"><span class="hljs-string">"turquoise"</span></span> /&gt;   &lt;/ThemeProvider&gt; ); }</code> </pre> <br><h2>  <font color="#3AC1EF">Waiver of .extend and "folding" of components</font> </h2><br>  In this release, the styled-components have an internal mechanism, thanks to which the stylized components in wrappers are now automatically ‚Äúcollapsed‚Äù, which allows rendering only one component. <br><br>  What does this mean for library users?  The point is that the <code>StyledComp.extend</code> API appeared in the library in order to allow for some optimizations to be performed, based on the fact that the extensible components were styled components.  Due to the internal work on the automatic "folding" of components, when using <code>styled(StyledComp)</code> the same optimizations that were used thanks to <code>StyledComp.extend</code> are automatically applied.  This means that there is no special benefit from <code>.extend</code> , which made it possible to abandon this API.  As a result, now library users can write less code and get the opportunity not to waste time on mastering the additional one API.  We believe this is very good. <br><br><h2>  <font color="#3AC1EF">Polymorphic property as</font> </h2><br>  There is another new feature styled-components v4, to which we treat with great enthusiasm.  We are talking about the native support of the <code>as</code> property for any stylized components, which allows us to dynamically influence rendering during the execution of the program.  Consider an example: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styled <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "styled-components" <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Link } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "react-router-dom" // &lt;Component /&gt;   DOM  div const Component = styled.div` color: red; ` &lt;Component&gt;Hello World!&lt;/Component&gt; //     ,      HTML-  ! &lt;Component <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>="span"&gt;Hello World!&lt;/Component&gt; &lt;Component <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>={Link} <span class="hljs-keyword"><span class="hljs-keyword">to</span></span>="home"&gt;Hello World!&lt;/Component&gt;</code> </pre> <br>  If we compare this with the existing <code>.withComponent(something)</code> mechanism, then the new tool is more flexible, since using it does not need to describe the replacement in advance, and, thanks to the new internal ‚Äúfolding‚Äù mechanism, stylization is not lost. component! <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styled <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"styled-components"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> RedColor = styled.div<span class="hljs-string"><span class="hljs-string">` color: red; `</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> BlueBackgroundRedColor = styled(RedColor)<span class="hljs-string"><span class="hljs-string">` background: blue; `</span></span> &lt;BlueBackgroundRedColor <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>=<span class="hljs-string"><span class="hljs-string">"span"</span></span>&gt;Hello!<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">BlueBackgroundRedColor</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="hljs-comment"><span class="hljs-comment">//       `span`   // &lt;RedColor /&gt;,       // !! (.withComponent    )</span></span></code> </pre> <br>  As you can see, the <code>as</code> property is simply a terrific piece that greatly simplifies the rendering of semantic HTML code anywhere in the application.  ‚ÄúSoup‚Äù from <code>&lt;div&gt;</code> tags has nothing more to justify. <br><br>  Please note that until we make sure that the <code>as</code> property is capable of becoming a suitable replacement for <code>.withComponent</code> in all use cases, we will not reject it.  It is assumed that this transitional period will not last too long, and we will remove <code>.withComponent</code> in the next major release. <br><br><h2>  <font color="#3AC1EF">React v16 and ref</font> </h2><br>  During the transition to the React v16 API, we also found that, thanks to the new <code>React.forwardRef</code> API, you can get rid of the <code>innerRef</code> .  We never particularly liked this technique, since it looked like some kind of not very clean hack.  But thanks to the excellent work of the React team, you can now use the native <code>ref</code> : <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styled <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"styled-components"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Component = styled.div<span class="hljs-string"><span class="hljs-string">` color: red; `</span></span> <span class="hljs-comment"><span class="hljs-comment">//    render &lt;Component ref={element =&gt; { this.myRef = element; }}</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Improvements for those writing in TypeScript</font> </h2><br>  We are not doing this directly, but we really like the new <a href="http://twitter.com/babel/preset-typescript">@ babel / preset-typescript</a> .  Its existence means that now everyone who writes in TypeScript can finally use the babel <a href="https://github.com/styled-components/babel-plugin-styled-components">plugin</a> for styled-components with all its usefulness, including simplified debugging using the names of components in classes, support for server rendering and reducing the size of bundles. <br><br>  In addition, we completed the translation of TS-types to DefinitelyTyped.  Now the community can work with them and correct typing errors at their own pace, without becoming attached to the styled-components releases.  Type declarations can be found <a href="https://www.npmjs.com/package/%40types/styled-components">here</a> . <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  From this material you learned about the new features of the beta version of the styled-components v4 library and about the improvements made to it.  We hope all this is useful to those who use styled-components, and, perhaps, will be interesting to those who are just going to try this library. <br><br>  <b>Dear readers!</b>  Do you use styled-components library in your projects? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/422783/">https://habr.com/ru/post/422783/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422771/index.html">Design rules, a new level and design thinking</a></li>
<li><a href="../422773/index.html">Nvidia. Revealing the secrets of the next generation GPU Turing architecture: double Ray Tracing, GDDR6, and more</a></li>
<li><a href="../422775/index.html">Conference DEFCON 22. Andrew "Zoz" Brooks. Don't screw it up! Part 1</a></li>
<li><a href="../422777/index.html">A simple introduction to the ALU for neural networks: an explanation, physical meaning and implementation</a></li>
<li><a href="../422781/index.html">Fintech-digest: SWIFT will continue to work in the Russian Federation, VISA will allow you to transfer funds by phone number, expensive biometrics</a></li>
<li><a href="../422785/index.html">Digitization of the plant: a look from the front</a></li>
<li><a href="../422787/index.html">Major changes in leading chip architectures</a></li>
<li><a href="../422789/index.html">@Pythonetc compilation, august 2018</a></li>
<li><a href="../422791/index.html">How not to learn English: common mistakes</a></li>
<li><a href="../422793/index.html">Conference DEFCON 22. Andrew "Zoz" Brooks. Don't screw it up! Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>