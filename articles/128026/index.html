<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating forms for deeply nested View Model in ASP.NET MVC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Another interesting post by Jimmy Bogard , dedicated to creating forms for deeply nested View Model in ASP.NET MVC. Despite the fact that it constantl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating forms for deeply nested View Model in ASP.NET MVC</h1><div class="post__text post__text-html js-mediator-article">  Another interesting post by <a href="http://twitter.com/">Jimmy Bogard</a> , dedicated to creating forms for deeply nested View Model in ASP.NET MVC.  Despite the fact that it constantly refers to ASP.NET MVC 2, the information is also relevant for the 3rd version.  Under a habrakat an original post in a free translation. <br><br><a name="habracut"></a><br>  ASP.NET MVC 2 introduced a set of strongly typed helpers for creating form elements in strongly typed views.  These strongly typed helpers use lambda expressions to create a complete input element, including the correct name and value for the element. <br><br>  Lambda expressions are quite expressive.  They allow you to create quite complex models for editing and have a model binding in order to put everything together.  An example of a complex type view model: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ProductEditModel <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <font color="#0000ff">public</font> PriceEditModel Price { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> PriceEditModel <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">decimal</font> Value { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Currency { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  It's easy enough to create a presentation for it: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">@using (Html.BeginForm()) { <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Name) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Name) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Price.Currency) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Price.Currency) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Price.Value) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Price.Value) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  As long as we use expressions constructed from the top level of the model to create input elements, the correct HMTL will be obtained.  Suppose you now want to pull the PriceEditModel into a partial view and separate it from the parent view.  In our view, we change the rendering properties to render the partial view: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">@using (Html.BeginForm()) { <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Name) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Name) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.Partial("_PriceEditModel", Model.Price); <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Our partial view is simply a cut-out view code, except that it is now based on the PriceEditModel type: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">@model ProductEditModel.PriceEditModel <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Currency) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Currency) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Value) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Value) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  However, the resulting HTML no longer matches the members of the model correctly.  Despite the fact that everything is fine on the screen: <br><img src="https://habrastorage.org/getpro/habr/post_images/7ac/059/1eb/7ac0591eb60b67c5568fb7a02b8db8c3.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But if we look at the HTML, we will see an error: <br><img src="https://habrastorage.org/getpro/habr/post_images/183/a42/ccf/183a42ccfb544c7843fa9ec96b6afe10.png"><br><br>  Instead of the name of our member who has the correct parent member in his name, like ‚ÄúPrice.Currency‚Äù, we see only ‚ÄúCurrency‚Äù.  Indeed, when we get into the POST action (action), the Price member is null, because  Model binding could not find a match: <br><img src="https://habrastorage.org/getpro/habr/post_images/e6c/925/50e/e6c92550e16e364846c88ce9c51c9276.png"><br><br>  Not exactly what we would like to receive! <br><br>  So what are our options?  To make sure that the model binding works for models with partial representations, we can bring these models in our partial representations to the parent type.  Those.  replace our model types for partial views with ‚ÄúPriceEditModel‚Äù to ‚ÄúProductEditModel‚Äù. <br><br>  Not a very attractive option! <br><br>  We have a better option - template helpers from MVC 2. Template helpers elegantly solve the problem of deeply nested View Model. <br><br><h4>  Working with template helpers </h4><br>  <a href="http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html">Template helpers</a> differ from partial views in that special contextual information in them is passed down from parent to child when we use the Html.EditorXyz () methods from HtmlHelper.  In order to rebuild our views to use template helpers, let's just create an editor template for each view model that we have: <br><img src="https://habrastorage.org/getpro/habr/post_images/a54/4f8/dfd/a544f8dfd982ffc2a5124c5b0f4bbc88.png"><br><br>  These templates are the usual partial views from Razor, except that they are placed in the special folder EditorTemplates.  For our partial view with ProductEditModel, we simply move everything we had in our view: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">@model ProductEditModel <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Name) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Name) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.EditorFor(m = <font color="#0000ff">&gt;</font> m.Price) <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  However, there is one minor detail.  Instead of rendering a partial view of Price, we render the editor for the Price member.  The PriceEditModel template is what we had in our original partial view without any changes: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">@model ProductEditModel.PriceEditModel <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Currency) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Currency) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> @Html.LabelFor(m = <font color="#0000ff">&gt;</font> m.Value) <br> @Html.TextBoxFor(m = <font color="#0000ff">&gt;</font> m.Value) <br> <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  At the moment, the difference is that our templating helper knows that the parent model used the ‚ÄúPrice‚Äù member to create a partial view.  In our parent view, Edit is still simpler: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">@using (Html.BeginForm()) { <br> @Html.EditorForModel() <br> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="submit"</font> <font color="#0000ff">/&gt;</font> <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  ASP.NET MVC will check the model type to make sure that the editor template exists for this type of model when we call the EditorForModel method.  Because  we create editor templates for each individual type of model; it does not matter where these nested types are located in the hierarchy.  ASP.NET MVC will transfer the parent context, so that the deeply nested View Model will have the correct information about it. <br><br>  After reviewing the resulting HTML, we can make sure that everything is in order: <br><img src="https://habrastorage.org/getpro/habr/post_images/e67/31d/9e6/e6731d9e65494cc71846beb8d710a5cd.png"><br><br>  The name of the input element now has the correct name of the parent property as the value.  And debugging the POST action confirms that the model binding now works correctly: <br><img src="https://habrastorage.org/getpro/habr/post_images/e7c/fdf/8d7/e7cfdf8d740b87baf2a637008e6f04f1.png"><br><br>  With the template helpers from ASP.NET MVC 2, we can create nested models in our views and, at the same time, get all the benefits of partial views.  The only caveat is to make sure you create views using templating helpers and Html.EditorXyz methods.  Otherwise, the impact on your submission will be minimal. <br><br>  And just to complain - this method is very annoying in MVC 1.0.  I threw out a bunch of code after I switched to older versions of MVC! </div><p>Source: <a href="https://habr.com/ru/post/128026/">https://habr.com/ru/post/128026/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128020/index.html">Simple zen-wiki engine</a></li>
<li><a href="../128021/index.html">Why Intel loves contests</a></li>
<li><a href="../128023/index.html">Add your tips to the code in Adobe Dreamweaver CS5</a></li>
<li><a href="../128024/index.html">Robotic Operating System Basics</a></li>
<li><a href="../128025/index.html">Conpay ‚îÅ credit service for online stores</a></li>
<li><a href="../128027/index.html">ICQ 7.6: in short</a></li>
<li><a href="../128028/index.html">DarkMaze in your phone!</a></li>
<li><a href="../128030/index.html">Android game development experience</a></li>
<li><a href="../128031/index.html">If you only need to leave one of the ways to deliver goods from the USA / UK, what will you choose?</a></li>
<li><a href="../128033/index.html">A look at the PlayStation Vita, Xperia Arc S, as well as on devices from the Walkman series</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>