<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tiled2Unity: export from Tiled Map Editor to Unity</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A lot of publications on resources for game developers are devoted to creating a simple 2D platformer. Unity is often used as an engine, and Tiled Map...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tiled2Unity: export from Tiled Map Editor to Unity</h1><div class="post__text post__text-html js-mediator-article">  A lot of publications on resources for game developers are devoted to creating a simple 2D platformer.  Unity is often used as an engine, and Tiled Map Editor is used for creating maps.  The interaction of these two environments is carried out using the free utility Tiled2Unity, which creates prefabs in Unity from TME files. <br><br>  How it works, we will tell on the example of the development of our platform ‚ÄúX-Drums‚Äù. <br><br>  We will move according to the following scheme: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Setting export Tiled2Unity </li><li>  Configuring Collisions in Tiled Map Editor </li><li>  Configure the settings that Tiled2Unity supports </li><li>  Setting custom parameters in Tiled Map Editor </li></ol><br><ul><li>  User parameters for layers (objects) </li><li>  User parameters for objects </li></ul><br><h4>  1. Export Setting </h4><br>  So, we have a project in Unity and there is a map created in the Tiled Map Editor.  Run Unity and import the <a href="http://www.seanba.com/tiled2unity">Tiled2Unity.unitypackage</a> . <br><br><img src="https://habrastorage.org/web/4d2/5d5/de4/4d25d5de4e79423fa040d6604feeb0d3.png"><br><a name="habracut"></a><br>  In the Tiled Map Editor we call the command editing window: <br><br><img src="https://habrastorage.org/web/1de/68f/5ff/1de68f5ff71046b78152bed5f43f9a02.png"><br><br>  Add a new command in which the path to the executable file Tiled2Unity.exe is registered.  Instead of% mapfile Tiled automatically substitute the path to the map file.  The final argument of this command is the path to the Tiled2Unity folder, which should have appeared in the project after import. <br><br><img src="https://habrastorage.org/web/577/e94/592/577e9459265949f0ba91e0dfbea556b7.png"><br><br>  Run the command and in the window that appears, press the big button. <br><br><img src="https://habrastorage.org/web/c48/834/304/c48834304f364b90a9bf9fb78eef9fe6.png"><br><br>  As a result of the export, we get the card prefab, which is located in the Tiled2Unity folder.  Place this prefab on stage in Unity.  Now, when working with the map in TME and exporting it, the prefab and the object on the scene will change in accordance with the changes in TME. <br><br><img src="https://habrastorage.org/web/3e7/8bd/20f/3e78bd20febb48b5926b605dae9f475e.png"><br><br>  So we set up exporting a map from Tiled to Unity and created a gaming environment. <br><br>  Now let's do the setting of objects on our map. <br><br><h4>  2. Collision Editor <br></h4><br>  First of all, we define the elements of the playing space, which will be obstacles for the hero.  These are the floor, walls, soffits on the ceiling, as well as drums, protruding platforms on which the hero will jump. <br><br>  Run the collision editor in Tiled: <br><br><img src="https://habrastorage.org/web/39c/ff3/e3c/39cff3e3c5f64dd390648f5c0846ec09.png"><br><br>  Select the tile we need, for example, a part of the drum, and edit the polygons: <br><br><img src="https://habrastorage.org/web/fc8/41b/f3a/fc841bf3a6c24abb8cf1873200eb5770.png"><br><br>  Similarly, we edit other tiles we need (floor, walls, etc.).  As a result, when exporting, Tiled2Unity will automatically create PolygonCollider2D colliders, which will act as obstacles for the hero. <br><br><img src="https://habrastorage.org/web/1ef/b23/3a3/1efb233a3ffb4f19b726cf3848580174.png"><br><br><img src="https://habrastorage.org/web/476/724/ff5/476724ff543e47e9a03ea547e9b2e9fa.gif"><br><br>  However, other game objects with which the hero can interact are more complex.  The behavior of the plates, fans, notes and other elements is controlled by using components and scripts.  To export such objects, you need to specify additional parameters in Tiled and then process them in Unity. <br><br><h4>  3. Parameters that Tiled2Unity supports </h4><br>  However, there is a list of parameters that we can use in Tiled without configuring them in Unity, since Tiled2Unity has already done this for us.  Among them: <br><table><tbody><tr><td>  unity: layer <br>  unity: sortingLayerName <br>  unity: tag <br>  unity: sortingOrder <br>  unity: isTrigger <br>  unity: ignore </td><td>  The (physics) layer name in Unity <br>  The Name of the Sorting Layer in Unity <br>  The Name of the Tag in Unity <br>  The `sorting in layer` value in Unity <br>  Whether collider is a trigger or not <br>  Ignore layer (or parts of it) during import (value = [false | true | collision | visual]) <br></td></tr></tbody></table><br>  Let us set the parameters we need for drumsticks, on which the hero will jump: <br><br><img src="https://habrastorage.org/web/300/4fa/2a7/3004fa2a784e4a6eabff44aba79ad716.png"><br><br>  When exporting to Unity, we get the following result: <br><br><img src="https://habrastorage.org/web/436/59a/a30/43659aa301fc405c9725179fc2a18861.png"><br><br>  The layer is set to the OneWayPlatform parameter, it is used for objects that are permeable to the bottom. <br><br><img src="https://habrastorage.org/web/fcb/bcd/4a1/fcbbcd4a18f5446a918a1295aeb58064.gif"><br><br><h4>  4. User parameters in Tiled </h4><br>  Processing of other parameters, let's call them ‚Äúuser-defined‚Äù, and exporting objects with such parameters, we will configure in Unity.  You can set them in Tiled for both layers (objects) and objects.  In different cases, the first or second option may be convenient.  Consider how to implement this. <br><br>  <b>4.1.</b>  <b>User parameters for layers (objects)</b> <br><br>  Set user parameters for the layer.  We use this option for objects of the same type.  In our game such are cymbals and sheet music.  Their peculiarity is that they interact equally with the hero and do not need to distinguish them from each other. <br><br>  Create a layer of objects in Tiled and place our plates on it.  Then, set the AddObject parameter for the entire layer. <br><br><img src="https://habrastorage.org/web/31b/287/75b/31b28775b62547c392bb97db43d88d3f.png"><br><br>  The field of its parameters for each dish remains empty. <br><br><img src="https://habrastorage.org/web/8a3/283/e1c/8a3283e1c78e4301bdd18b8e83b93ea1.png"><br><br>  Now we move to Unity, where we created a prefab for the plates and tied to it a script that determines their behavior when the hero jumps - they fall and return to their original position. <br><br>  Let's write a code that, when importing plates for each object from Tiled, will create an instance of our prefab.  To do this, create a CustomTiledImporterForHiHats script with a class that inherits the Tiled2Unity.ICustomTiledImporter interface and the [Tiled2Unity.CustomTiledImporter] attribute. <br><br>  This Tiled2Unity script will call for each layer and object imported from Tiled.  And, respectively, will be processed those layers or objects that have among parameters the AddObject parameter with the value ‚ÄúHi-hat‚Äù. <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEditor; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; [Tiled2Unity.CustomTiledImporter] <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> CustomTiledImporterForHiHats : Tiled2Unity.ICustomTiledImporter { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> HandleCustomProperties(GameObject gameObject, IDictionary&lt;string, string&gt; props) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!props.ContainsKey("AddObject")) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props["AddObject"] == "Hi-hat") { //   string prefabPath = "Assets/8 - Prefabs/Hi-hat.prefab"; <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> obj = AssetDatabase.LoadAssetAtPath(prefabPath, typeof(GameObject)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obj == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; //  ,     Tiled, //    //      List&lt;GameObject&gt; childrenToDestroy = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;GameObject&gt;(); //     <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Transform</span></span> child <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> gameObject.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (child.name == "TileObject") { //     childrenToDestroy.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(child.gameObject); //  ,      GameObject objInstance = (GameObject)GameObject.Instantiate(obj); objInstance.name = obj.name; objInstance.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.parent = gameObject.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>; objInstance.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.position = child.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.position; } } //    childrenToDestroy.<span class="hljs-keyword"><span class="hljs-keyword">ForEach</span></span>(child =&gt; GameObject.DestroyImmediate(child)); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> CustomizePrefab(GameObject prefab) { } }</code> </pre> <br>  The script is ready and we can export plates. <br><br><img src="https://habrastorage.org/web/dcf/93d/d01/dcf93dd01748438e92a1a7ecac8c7893.png"><br><br>  And so the hero interacts with them. <br><br><img src="https://habrastorage.org/web/afa/fef/182/afafef1822154f9bb7a4e00cdab830cb.gif"><br><br>  The export of notes is set up just like the export of plates.  The only difference is that the game has several types of notes with different values ‚Äã‚Äãdepending on the color.  Therefore, for each type of note with its nominal value, we created a prefab in Unity and a layer of objects in Tiled, specifying the note type in the AddObject parameter.  The import script that creates prefab instances is identical to the cymbal script. <br><br>  <b>4.2.</b>  <b>User parameters for objects</b> <br><br>  Now we will consider how to export objects of the same type, in which user parameters are not set to the layer, but to the object itself.  These objects include our fans, cupids, moving platforms, etc.  Despite their uniformity, they have their own individual properties: speed, direction, etc. <br><br>  For example, fans differ in color, they move at different speeds at a given distance.  They can stop to blink, and when they meet with the hero, they give a choice of certain emotions.  We set these parameters in Tiled for each object.  ‚ÄúTheir parameters‚Äù for the layer, respectively, remain empty. <br><br><img src="https://habrastorage.org/web/44f/91e/c69/44f91ec69a2b4f52a4ebaedbab5934fc.png"><br><br>  In Unity, for fans, prefabs are created, to which GirlController script is attached, defining their behavior and reaction to the hero.  The import will be similar to the import of plates, but simply creating copies of the prefab in this case will not be enough.  We need to access the GirlController script and set the properties that were set in Tiled individually for each fan. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEditor; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; [Tiled2Unity.CustomTiledImporter] <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> CustomTiledImporterForGirls : Tiled2Unity.ICustomTiledImporter { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> HandleCustomProperties(GameObject gameObject, IDictionary&lt;string, string&gt; props) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!props.ContainsKey("GirlColor")) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; //        Tiled  string prefabPath = "Assets/8 - Prefabs/Girls/Girl_" + props["GirlColor"] + ".prefab"; <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> obj = AssetDatabase.LoadAssetAtPath(prefabPath, typeof(GameObject)); //  ,      GameObject objInstance = (GameObject)<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.Instantiate(obj); objInstance.name = obj.name; objInstance.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.parent = gameObject.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.parent; objInstance.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.position = gameObject.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.position; objInstance.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.localScale = gameObject.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.localScale; objInstance.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.eulerAngles = gameObject.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.eulerAngles; //  ,     //   Tiled     var girlController = objInstance.GetComponent&lt;GirlController&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.ContainsKey("OffsetRight")) <span class="hljs-type"><span class="hljs-type">float</span></span>.TryParse(props["OffsetRight"], <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> girlController.OffsetMax); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.ContainsKey("OffsetLeft")) <span class="hljs-type"><span class="hljs-type">float</span></span>.TryParse(props["OffsetLeft"], <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> girlController.OffsetMin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.ContainsKey("Velocity")) <span class="hljs-type"><span class="hljs-type">float</span></span>.TryParse(props["Velocity"], <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> girlController.Velocity); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.ContainsKey("Stop")) <span class="hljs-type"><span class="hljs-type">float</span></span>.TryParse(props["Stop"], <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> girlController.StopCount); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.ContainsKey("Fatal")) <span class="hljs-type"><span class="hljs-type">bool</span></span>.TryParse(props["Fatal"], <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> girlController.Fatal); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.ContainsKey("HeartType")) { string heartPrefabPath = "Assets/8 - Prefabs/Girls/" + props["HeartType"] + ".prefab"; <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> heartObj = AssetDatabase.LoadAssetAtPath(heartPrefabPath, typeof(GameObject)); girlController.heartPrefab = heartObj; } //    <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.DestroyImmediate(gameObject); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> CustomizePrefab(GameObject prefab) { } }</code> </pre><br>  We export to Unity and see that the parameters specified in Tiled were set to the GirlController script variables: <br><br><img src="https://habrastorage.org/web/daa/e35/b0c/daae35b0c0f6489ba17eb6e2afde0d9b.png"><br><br><img src="https://habrastorage.org/web/676/8fd/c7e/6768fdc7e45142eab623f106a6614626.gif"><br><br>  We repeat the described scheme for objects from other groups, and when exporting to Unity we get customized prefabs for most of the game‚Äôs components. <br><br>  <i>The described approach was used by us to create our platform.</i>  <i>Working in conjunction with the Tiled Map Editor and Unity, it was in this game that accelerated the process of its creation, allowing the TME level designer and the Unity programmer to work simultaneously, without interfering with each other.</i>  <i>In projects like ours, the Tiled2Unity utility can be incredibly useful, and, based on the article, those who wish can apply any of the options in their game development.</i> <i><br></i> </div><p>Source: <a href="https://habr.com/ru/post/328700/">https://habr.com/ru/post/328700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328688/index.html">Discipline, accuracy, attention to detail, part two (OLAP, SSAS)</a></li>
<li><a href="../328690/index.html">SQL vs ORM</a></li>
<li><a href="../328692/index.html">Mitap over SQL Server: waiting only for you</a></li>
<li><a href="../328696/index.html">7 simple steps for successful CRM implementation</a></li>
<li><a href="../328698/index.html">Learning neural network geometry</a></li>
<li><a href="../328702/index.html">State synchronization in multiplayer games</a></li>
<li><a href="../328704/index.html">Why many still do not understand the essence of the blockchain</a></li>
<li><a href="../328706/index.html">Stable income without investments, or How Yandex began the hunt for fake earnings</a></li>
<li><a href="../328708/index.html">Development of a password manager for Android</a></li>
<li><a href="../328710/index.html">Google I / O 2017: notes from the event from the Android developer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>