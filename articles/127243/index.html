<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A little bit about how to organize a web service API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There was a task to organize a web service to which regular clients will turn from a browser and other web services. 

 Suppose I sell theater tickets...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A little bit about how to organize a web service API</h1><div class="post__text post__text-html js-mediator-article">  There was a task to organize a web service to which regular clients will turn from a browser and other web services. <br><br>  Suppose I sell theater tickets to customers.  The client can only be an agency that has an account with me on the service.  Agencies are small, in which the aunt sits and handles in a personal account with the help of a baruser, makes a purchase of a ticket, as well as large ones, in which everything is automated.  The big ones want to be able to connect to me using the API and make a purchase. <br><br>  You can watch prices on tickets, pre-book, redeem reservations, return purchased ones and delete reservations. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Question: what is the best way to organize an API? <br><a name="habracut"></a><br>  I'm going to organize a web service and generally a service on Ruby on Rails, but I will try to set out general principles, where it is possible to bypass the implementation.  I will try to briefly present what I read in the process of preparing for the creation of the API, and also provide references to the original sources. <br><br><h4>  API Organization Principles </h4><br>  By architecture / ideology options: <a href="http://ru.wikipedia.org/wiki/REST">REST</a> , <a href="http://ru.wikipedia.org/wiki/SOAP">SOAP</a> , <a href="http://ru.wikipedia.org/wiki/XML-RPC">XML-RPC</a> and others. <br><br>  After reading a lot, I chose REST, because  it gives less freedom in places where it is not needed: the name of the methods and the method of calling this method.  In short: my tickets now are resources.  Each action with a ticket is available by a unique combination of HTTP-method + URL.  For example, a preliminary reservation (in fact, creating a ticket order): POST / orders.xml, deleting an order for ticket tickets DELETE / order / 1.xml, and viewing prices GET /prices.xml. <br><br>  More about REST <a href="http://habrahabr.ru/blogs/webdev/38730/">on Habr√©</a> and <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">Wikipedia</a> . <br><br>  The best article about the REST API and Ruby on Rails, in the public domain, is the chapter <a href="http://ofps.oreilly.com/titles/9780596521424/activeresource_id59243.html">about ActiveResource</a> in the <a href="http://ofps.oreilly.com/titles/9780596521424/index.html">Rails 3 in a Nutshell</a> book, courtesy of O'Reilly.  It describes the situation from the point of view of both the REST API client and the server.  It is very useful to read to understand why it is necessary to use the RESTful API.  In addition, it describes a very interesting implementation of the REST API client ActiveResource included in Ruby On Rails.  ActiveResource is ported to some other languages ‚Äã‚Äãand will be useful not only for rubists. <br><br>  The rest of the read articles, minus trifles, are invested in the one above. <br><br><h5>  Implementation </h5><br>  By implementation, I really liked the concept offered by Rails by default, and with all its might exploiting the principle of <a href="http://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a> : generating API responses (XML, JSON) in the same controllers as generating responses to the user (html). <br><br>  By the way, for the implementation of DRY, there is a useful plugin <a href="https://github.com/fabrik42/acts_as_api">acts_as_api</a> , which allows to save a lot on XML-templates and a <a href="http://ryandaigle.com/articles/2009/8/6/what-s-new-in-edge-rails-cleaner-restful-controllers-w-respond_with">new feature of</a> Ruby on Rails 3. <br><br>  There are several explanatory branches on Stackoverflow on this topic, for example <a href="http://stackoverflow.com/questions/5798869/build-an-api-using-ruby-on-rails">this one</a> . <br><br><h5>  Implementing API as a separate module </h5><br>  There are several <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">DSL</a> for organizing the API.  For example, <a href="https://github.com/intridea/grape">Grape</a> and, if anyone needs to integrate Grape and Ruby on Rails, then <a href="http://martinciu.com/2011/01/mounting-grape-api-inside-rails-application.html">go</a> here: <a href="http://martinciu.com/2011/01/mounting-grape-api-inside-rails-application.html">martinciu.com/2011/01/mounting-grape-api-inside-rails-application.html</a> <br><br><h4>  Authentication </h4><br>  Authentication options \ authorization mass: <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">Basic</a> , using tokens, using certificates, <a href="http://ru.wikipedia.org/wiki/OAuth">Oauth</a> . <br><br>  As far as I understood Oauth, in our case it does not fit, because  there is no client account on my server that could allow the agent to log in.  There is no end user at all, I don‚Äôt know about it, so the Oauth option is no longer available. <br><br>  The most reliable in terms of security, but apparently the most difficult to implement, both on the client and on the server, is certificate-based authentication. <br><br>  The most basic option is basic (essentially, a username and password: <a href="https://user/">user</a> : password@api.myserver.ru/orders.xml). <br><br>  I chose the authentication option for stateless tokens, because it allows the user to log in to the browser as a username and password and create orders and, at the same time, to create orders using the same user (but using a token) using an automated web service.  I want each of my agents to have exactly one user on my server. <br><br>  Yes, of course, do not forget that since we started to log in, then our API should be wrapped in HTTPS to avoid authorization data leaks.  I plan to give my agents the opportunity to regenerate the API-key in their personal accounts, if they consider that it is time. <br><br>  In addition, I chose the option stateless token, passed as a POST or GET parameter.  There is another option to push the token into HTTP headers, not a parameter (this is a more REST option, but a little more difficult to implement), as is <a href="http://docs.amazonwebservices.com/AmazonS3/2006-03-01/dev/index.html%3FRESTAuthentication.html">done with Amazon</a> .  But it seemed to me that in this case the game of implementation is not worth the candle.  There is no particular gain for this option (well, maybe, except that the structure of the request <br>  It will be a little more RESTful), and there is a trouble. <br><br>  Literature on the organization of authorization / authentication of the web service: <br>  <a href="http://stackoverflow.com/questions/6134082/restful-web-service-how-to-authenticate-requests-from-other-services">stackoverflow.com/questions/6134082/restful-web-service-how-to-authenticate-requests-from-other-services</a> <br>  <a href="http://stackoverflow.com/questions/939836/service-based-authentication-using-tokens">stackoverflow.com/questions/939836/service-based-authentication-using-tokens</a> <br><br><h5>  Implementation </h5><br>  For Ruby on Rails, there is a wonderful <a href="https://github.com/plataformatec/devise">devise</a> plugin for which there is a module <a href="https://github.com/plataformatec/devise/wiki/How-To:-Simple-Token-Authentication-Example">for authentication by token</a> .  Literally, a couple of lines - and everything is ready. <br><br>  UPD.  Colleagues, minus the topic, you can unsubscribe with what you disagree.  And then half the value of the topic - in the discussion, and you keep silent! </div><p>Source: <a href="https://habr.com/ru/post/127243/">https://habr.com/ru/post/127243/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127237/index.html">Simple Twitter bot in Python</a></li>
<li><a href="../127238/index.html">GNU LilyPond - Free Music Kit</a></li>
<li><a href="../127239/index.html">Lessons learned on the road to profit</a></li>
<li><a href="../127240/index.html">Java 6 & 7 ed Irregular Windows</a></li>
<li><a href="../127241/index.html">Legal aspects of the actions of the owners of laptops in case of their theft</a></li>
<li><a href="../127245/index.html">Atomic clocks from the NPL are recognized as the most accurate in the world</a></li>
<li><a href="../127246/index.html">Blackberry on Mobilefest: first public speaking in Russia. What to expect?</a></li>
<li><a href="../127247/index.html">Samsung launches its own messenger</a></li>
<li><a href="../127249/index.html">How to withdraw rubles payment system vKontakte</a></li>
<li><a href="../127251/index.html">GTUG in Omsk. How it was</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>