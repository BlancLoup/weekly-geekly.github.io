<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Comprehend git</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator: this article does not describe git commands, it implies that you are already familiar with it. It describes a completely sensible...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Comprehend git</h1><div class="post__text post__text-html js-mediator-article">  <em>From the translator: this article does not describe git commands, it implies that you are already familiar with it.</em>  <em>It describes a completely sensible, in my opinion, approach to keeping public history clean and tidy.</em> <br><br>  If you don‚Äôt understand what prompted git to do just that, then suffering awaits you.  Using a lot of flags (--flag), you can make git work the way you think it should work, instead of working the way git wants it.  It's like nailing with a screwdriver.  The work is done, but worse, slower, and the screwdriver spoils. <br><a name="habracut"></a><br><br>  Let's look at how the usual approach to development with git is falling apart. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We bud off a branch from master, we work, we merge back when we are done. <br><br>  Most of the time it works, as expected, because the master changes after you have made a branch <em>(It means that your colleagues commit to master - note of the translator.)</em> .  Once you merge the feature branch into master, but the master hasn't changed.  Instead of a merge commit, git simply moves the master pointer to the last commit, fast forward occurs. <br><br>  <em>To explain the fast forward mechanism, I borrowed a picture from one famous article.</em>  <em>Note</em>  <em>translator.</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage/a90013bb/4166845b/d7905ec1/572137b0.png"></div><br><br>  Unfortunately, your feature branch contained intermediate commits ‚Äî frequent commits that back up the work, but capture the code when it‚Äôs not working.  Now these commits are indistinguishable from stable commits in master.  You can easily roll back into such a disaster. <br><br>  So, you add a new rule: ‚ÄúUse --no-ff when merging branches of a feature‚Äù.  This solves the problem and you move on. <br><br>  Then one day you find a critical bug in production and you need to track the moment when it appeared.  You run <a href="http://book.git-scm.com/5_finding_issues_-_git_bisect.html">bisect</a> , but you constantly hit intermediate commits.  You give up and look for your hands. <br><br>  You localize the bug down to the file.  Run blame to see changes in the last 48 hours.  You know that this is not possible, but blame reports that the file has not been changed for several weeks.  It turns out that blame gives the time of the original commit instead of the time of merging the branch <em>(logical, because merge commit is empty - comment of the translator)</em> .  Your first interim commit changed this file a few weeks ago, but the change was only injected today. <br><br>  A no-ff crutch, a broken bisect and slurred blame are symptoms that you hammer nails with a screwdriver. <br><br><h4>  Rethinking version control </h4><br>  Version control is needed for two things. <br><br>  The first is to help write code.  There is a need to synchronize edits with your team and regularly backup your work. <br><br>  The second reason is <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BD%25D1%2584%25D0%25B8%25D0%25B3%25D1%2583%25D1%2580%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2583%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">configuration management</a> .  Includes parallel development management.  For example, work on the next release version and parallel bug-fixes of the existing production version.  Configuration management implies the ability to find out when something has been changed.  An invaluable tool for diagnosing errors. <br><br>  Traditionally, these two reasons come into conflict. <br><br>  When developing some functionality, you will need regular intermediate commits.  However, these commits usually break the build. <br><br>  In a perfect world, every change in version history is concise and stable.  There are no intermediate commits that interfere.  There are no giant commits for 10,000 lines.  A neat story allows you to roll back edits or flip them between branches with the help of <a href="http://gitready.com/intermediate/2009/03/04/pick-out-individual-commits.html">cherry-pick</a> .  A neat story is easier to learn and analyze.  However, maintaining the purity of the story implies bringing all edits to the ideal state. <br><br>  So which approach do you choose?  Frequent commits or a neat story? <br><br>  If you are working together on a pre-release startup, a tidy story doesn‚Äôt bribe a lot.  You can commit everything to master and release releases whenever you like. <br><br>  As soon as the significance of the changes increases, be it the growth of the development team or the size of the user base, you will need tools to maintain order.  This includes automated testing, code review, and a neat story. <br><br>  The feature branches look like a good compromise.  They solve simple parallel development problems.  You are thinking of integration at the least important point in time when you write code, but this will help you for a while. <br><br>  When your project grows large enough, the simple approach of branch / commit / merge will fall apart.  Adhesive tape application time is over.  You need a neat change history. <br><br>  Git is revolutionary because it gives you the best of both worlds.  You can make frequent commits in the development process and clean the history at the end.  If this is your approach, then the git defaults seem more meaningful <em>(by default, fast-forward when merging branches - comment of the translator)</em> . <br><br><h4>  Sequencing </h4><br>  Think about branches in the context of two categories: public branches and private. <br><br>  Public branches are the official history of the project.  A commit to a public branch should be concise, atomic and have a good description.  It must be linear.  It should be unchanged.  Public branches are master and release. <br><br>  Private thread for yourself.  This is your draft at the time of solving the problem. <br><br>  The safest way to store private branches locally.  If you need to push to synchronize work and home computers, for example, tell your colleagues that the branch is yours and that you should not rely on it. <br><br>  It is not necessary to inject a private branch into a public simple merge.  First, clean up your thread with tools like reset, rebase, merge --squash and commit --amend. <br><br>  Imagine yourself a writer, and commits as chapters of a book.  Writers do not publish drafts.  Michael Crichton said: "Great books are not written - they are rewritten." <br><br>  If you come from other VCS, changing the history will be taboo.  You proceed from the fact that any commit is carved in stone.  Following this logic, you need to remove "undo" from text editors. <br><br>  Pragmatists take care of edits only until these edits become annoying.  For configuration management, only global changes are important to us.  Intermediate commits are just a lightweight buffer with the possibility of cancellation. <br><br>  If history is viewed as something clean, then fast-forward merging is not only safe but also preferable.  It maintains a linear history, it is easier to track <br><br>  The only remaining argument for --no-ff is documentation.  You can use merge commits to associate with the latest production code.  This is an anti-pattern.  Use tags. <br><br><h4>  Recommendations and examples </h4><br>  I use 3 simple approaches, depending on the size of the change, the time spent working on it and how far the branch has gone aside. <br><br><h5>  Quick edit </h5><br>  Most of the time cleaning is just a squash commit. <br>  Suppose I created a feature branch and made several intermediate commits within an hour. <br><br><pre><code class="bash hljs">git checkout -b private_feature_branch touch file1.txt git add file1.txt git commit -am <span class="hljs-string"><span class="hljs-string">"WIP"</span></span></code> </pre> <br>  As soon as I finish, instead of a simple merge, I do the following: <br><br><pre> <code class="bash hljs">git checkout master git merge --squash private_feature_branch git commit -v</code> </pre> <br>  Then I spend a minute writing a more detailed comment to the commit. <br><br><h5>  Edit more </h5><br>  At times, the implementation of the feature grows into a multi-day project with many small commits. <br><br>  I decide that my edit should be divided into smaller pieces, so squash is too coarse a tool.  (As a daily rule, I ask myself: ‚ÄúWill it be easy to make a code review?‚Äù) <br><br>  If my intermediate commits were a logical move forward, then you can use <a href="http://book.git-scm.com/4_interactive_rebasing.html">rebase</a> interactively. <br><br>  Interactive mode is powerful.  You can use it to edit old commits, split or organize them and, in this case, to combine several. <br><br>  In feature branch: <br><br><pre> <code class="bash hljs">git rebase --interactive master</code> </pre> <br>  The editor opens with a list of commits.  Each line is: a command to be executed, a SHA1 hash, and a comment to the commit.  Below is a list of possible commands. <br><br>  By default, each commit is ‚Äúpick‚Äù, which means ‚Äúcommit not to change‚Äù. <br><br><pre> <code class="bash hljs">pick ccd6e62 Work on back button pick 1c83feb Bug fixes pick f9d0c33 Start work on toolbar</code> </pre> <br>  I am changing the squash command, which combines the current commit with the previous one. <br><br><pre> <code class="bash hljs">pick ccd6e62 Work on back button squash 1c83feb Bug fixes pick f9d0c33 Start work on toolbar</code> </pre> <br>  I save, now another editor is requesting a comment to the joint commit.  All is ready. <br><br><h5>  Failed branches </h5><br>  Perhaps the feature branch existed for a long time and other branches merged into it to maintain its relevance.  The story is complicated and confusing.  The simplest solution is to take a rough diff and create a new branch. <br><br><pre> <code class="bash hljs">git checkout master git checkout -b cleaned_up_branch git merge --squash private_feature_branch git reset</code> </pre> <br>  Now the working directory is full of my edits and no legacy from the previous branch.  Now we take and add pens and commit edits. <br><br><h4>  We summarize </h4><br>  If you are struggling with defaults in git, ask yourself why. <br><br>  Consider the public history unchanged, atomic and easily traceable. <br>  Consider your private history as changeable and flexible. <br><br>  The procedure is as follows: <br><ul><li>  We create a private branch of the public branch. </li><li>  Methodically commit work to this private thread. </li><li>  Once the code has reached perfection, put the story in order. </li><li>  We merge the ordered branch back to the public one. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/141160/">https://habr.com/ru/post/141160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141154/index.html">Exotic. Overview of the operating system WebOS 3.0.5</a></li>
<li><a href="../141155/index.html">Bitbucket announced pair programming - Spooning</a></li>
<li><a href="../141156/index.html">Canvas with hardware acceleration in Google Chrome</a></li>
<li><a href="../141157/index.html">Quick installation and publication on the server of the open electronic learning platform Moodle</a></li>
<li><a href="../141158/index.html">Adobe will not take royalties from games that brought less than $ 50K</a></li>
<li><a href="../141161/index.html">MTS sues Twitter</a></li>
<li><a href="../141162/index.html">Sovereign: algorithm</a></li>
<li><a href="../141164/index.html">Lightcube (photobox, lightbox) do-it-yourself for 300r</a></li>
<li><a href="../141165/index.html">Testing ExtJS / Sencha components and applications using the PhantomJS engine</a></li>
<li><a href="../141166/index.html">Google Chrome: AdBlock now shows you cats instead of ads!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>