<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Qt + QML on a simple example</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Qt is a convenient and flexible tool for creating cross-platform software. The included QML provides complete freedom of action when creating a user i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Qt + QML on a simple example</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/03b/5d8/c97/03b5d8c974e52c8458c860de0d46bc03.png" align="left">  Qt is a convenient and flexible tool for creating cross-platform software.  The included QML provides complete freedom of action when creating a user interface. <br>  The usability of the Qt and QML bundles has already been mentioned more than once, so I will not go further about the pros and cons, but I‚Äôll give, step by step, an example of a simple Qt application. <br><a name="habracut"></a><br>  It will be a minimalistic application, its meaning is simple - when you press any key on the keyboard, a random image will appear on the screen and a random sound effect will be played again. <br><br>  The user interface will be fully implemented in QML, the software part in Qt. <br><br>  For those who do not have Qt installed, go to the <a href="http://qt.nokia.com/downloads/">qt.nokia.com/downloads</a> download <a href="http://qt.nokia.com/downloads/">page</a> and download the binaries for their platform in the " <i>Qt SDK: Complete Development Environment</i> " section.  And, in fact, install. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Launch Qt Creator, select the menu item <b>File</b> -&gt; <b>New File or Project</b> .  In the newly opened <b>Qt C ++ Project</b> -&gt; <b>Gui application, the Qt application</b> , then the <b>Select</b> button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7f6/a6c/4ec/7f6a6c4ec21beaa05ef5c7249f144b70.png" alt="Qt"><br><br>  In the new window, enter the name of the project, specify the path to the project, click <b>Next</b> . <br><br>  In the next window, uncheck <b>Create Form</b> , it is not useful for us, <b>Next</b> .  And in the latter, just press the <b>Finish</b> button.  Everything, the framework of our application is created. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7f2/28e/98b/7f228e98bc87f434655e1b72235c4341.png" alt="Qt"><br><br>  First we add the <i>qt-declarative</i> module to our project, for this, in the project file ( <i>4Toddler.pro</i> ), to the line <br><br><blockquote><code><font color="black">QT += core gui</font></code> </blockquote> <br>  add <i>declarative</i> <br><blockquote> <code><font color="black">QT += core gui declarative</font></code> </blockquote> <br>  Next, change the base class for our main window, replace <i>QMainWindow</i> with <i>QDeclarativeView</i> and <i>enable the QDeclarativeView</i> header file <br><blockquote> <code><font color="black">#include &lt;QDeclarativeView&gt; <br> <br> <font color="#0000ff">class</font> MainWindow : <font color="#0000ff">public</font> QDeclarativeView <br> { <br> ... <br> }</font> <br></code> </blockquote><br>  We will cut off the implementation of the constructor, which has become unnecessary, the initialization of the base class <i>QMainWindow (parent)</i> . <br><br>  If you now build and run the project, we will see an empty window.  So it should be, because  we have not created or initialized the Qml interface. <br><br>  Add a new QML file to the project. To do this, right-click on the project. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/965/5b3/5aa/9655b35aa2b47ccf2f33cbaef0dd5e3e.png" alt="image"><br><br>  <b>Add a new ...</b> , then select the <b>Qt</b> section, the <b>Qt QML file</b> template.  We give it the name <i>main</i> , then <b>Next</b> and <b>Finish</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e43/76b/484/e4376b4848a4350a51ceaca4b188e730.png" alt="image"><br><br>  The wizard has created us a file containing one <i>Rectangle</i> element, it will be the main element for our user interface.  Add a few new properties and set their value. <br><br><blockquote> <code><font color="black">Rectangle <br> { <br> <font color="#008000">// ,    </font> <br> <font color="#008000">//     </font> <br> id: canvas; <br> <br> <font color="#008000">//  , </font> <br> color: <font color="#A31515">"black"</font> <br> <br> <font color="#008000">//    </font> <br> <font color="#008000">//  </font> <br> anchors.fill: parent <br> <br> <font color="#008000">//    </font> <br> focus: <font color="#0000ff">true</font> <br> }</font> <br></code> </blockquote><br>  So far, nothing special, just a black background.  Add the code to download the QML file to see what we did.  To do this, we add a new method to our window. <br><blockquote> <code><font color="black"><font color="#0000ff">void</font> MainWindow::Init() <br> { <br> <font color="#008000">//   ,  QML </font> <br> QString contentPath; <br> <br> #ifdef QT_DEBUG <br> <font color="#008000">//         </font> <br> contentPath = <font color="#A31515">"D:/MyProjects/QT/4Toddler"</font> ; <br> <font color="#0000ff">#else</font> <br> <font color="#008000">//      ,    </font> <br> contentPath = QApplication::applicationDirPath(); <br> <font color="#0000ff">#endif</font> <br> <br> setFocusPolicy(Qt::StrongFocus); <br> <font color="#008000">//   QML    </font> <br> <font color="#008000">//    ,</font> <br> <font color="#008000">//  QDeclarativeView::SizeViewToRootObject</font> <br> setResizeMode(QDeclarativeView::SizeRootObjectToView); <br> <br> <font color="#008000">//  QML </font> <br> setSource(QUrl::fromLocalFile(contentPath + <font color="#A31515">"/main.qml"</font> )); <br> }</font></code> </blockquote> <br>  Now replace the line in the <b>main.cpp</b> file <br><blockquote> <code><font color="black"><font color="#0000ff">int</font> main( <font color="#0000ff">int</font> argc, <font color="#0000ff">char</font> *argv[]) <br> { <br> ... <br> w.show(); <br> ... <br> }</font></code> </blockquote> <br>  on <br><blockquote> <code><font color="black"><font color="#0000ff">int</font> main( <font color="#0000ff">int</font> argc, <font color="#0000ff">char</font> *argv[]) <br> { <br> ... <br> w.showFullScreen(); <br> ... <br> }</font></code> </blockquote> <br>  The window will expand to full screen.  Before launching the application, let's add a button with which you can close the window.  Looking ahead, I‚Äôll say that there will be two buttons in the window, in order not to write the same code several times, add a new QML file to the project, and call it <i>WindowButton</i> . <br><br>  The <i>WindowButton</i> element will be reused, changing only certain properties of each instance.  The buttons will be made in the form of icons, with each of them we will set the path to the icon file and change the handler for clicking with the left mouse button.  Below is the finished item code with comments. <br><blockquote> <code><font color="black">Image <br> { <br> <font color="#008000">//  </font> <br> id: button <br> <br> <font color="#008000">// ,  "" </font> <br> MouseArea <br> { <br> <font color="#008000">//    </font> <br> <font color="#008000">//  Image</font> <br> anchors.fill: parent <br> <br> id: mouseArea <br> <br> <font color="#008000">//     callback</font> <br> onClicked: callback() <br> } <br> }</font></code> </blockquote> <br>  Add a couple of buttons to our window. <br><blockquote> <code><font color="black"><font color="#008000">//  </font> <br> <font color="#008000">//   </font> <br> Row <br> { <br> <font color="#008000">//    </font> <br> <font color="#008000">//     </font> <br> anchors.right: parent.right; <br> <font color="#008000">//  , 4 </font> <br> anchors.rightMargin: 4; <br> <font color="#008000">//    </font> <br> <font color="#008000">//     </font> <br> anchors.top: parent.top; <br> <font color="#008000">//  , 4 </font> <br> anchors.topMargin: 4; <br> <br> <font color="#008000">//   </font> <br> spacing: 4 <br> <br> WindowButton <br> { <br> <font color="#008000">//    " "</font> <br> id: about; <br> <br> <font color="#008000">//     </font> <br> <font color="#008000">//         ,</font> <br> <font color="#008000">//   QML </font> <br> source: <font color="#A31515">"about.png"</font> ; <br> <br> <font color="#008000">// ,   </font> <br> <font color="#008000">//       </font> <br> <font color="#008000">// onClicked: callback()</font> <br> function callback() <br> { <br> } <br> } <br> <br> WindowButton <br> { <br> <font color="#008000">//   </font> <br> id: exit; <br> <br> source: <font color="#A31515">"exit.png"</font> ; <br> <br> function callback() <br> { <br> } <br> } <br> }</font></code> </blockquote> <br><br>  In order that what we did earns, it remains for us to implement both <i>callback</i> methods for each button.  To close the window, we call the <i>Quit</i> method, which we implement in the window class.  To do this, add the class to the declaration. <br><blockquote> <code><font color="black">Q_INVOKABLE <font color="#0000ff">void</font> Quit();</font></code> </blockquote> <br>  Then we implement this method. <br><blockquote> <code><font color="black"><font color="#0000ff">void</font> MainWindow::Quit() <br> { <br> QApplication::quit(); <br> }</font></code> </blockquote> <br>  It remains to make this method visible from QML.  In the <i>Init</i> method, add one single line that will make an instance of our window visible in QML. <br><blockquote> <code><font color="black">rootContext()-&gt;setContextProperty( <font color="#A31515">"window"</font> , <font color="#0000ff">this</font> );</font></code> </blockquote> <br>  We can access this object by name - <i>window</i> , the name is arbitrary.  Add an implementation for the close window button. <br><blockquote> <code><font color="black">function callback() <br> { <br> window.Quit(); <br> }</font></code> </blockquote> <br>  Note that you can only call methods that are declared as <i>Q_INVOKABLE</i> , i.e.  from the <i>Init</i> method, the main window cannot be called. <br><br>  Done, launch, see the black screen, all we can do now is to close the window by pressing the <i>exit</i> button.  We pressed and we see that the state of the button when you hover the cursor and when pressed does not change at all, it looks like ‚Äúnon-living‚Äù.  Revive it by adding states: <br><blockquote> <code><font color="black">Image <br> { <br> ... <br> states:[ <br> State <br> { <br> <font color="#008000">//  </font> <br> name: <font color="#A31515">"hovered"</font> ; <br> <font color="#008000">//   ,      </font> <br> <font color="#008000">//        </font> <br> when: mouseArea.pressed; <br> <font color="#008000">//       </font> <br> <font color="#008000">//      </font> <br> PropertyChanges { target: button; opacity: 1;} <br> }, <br> State <br> { <br> name: <font color="#A31515">"normal"</font> <br> <font color="#008000">//      </font> <br> <font color="#008000">//      </font> <br> when: mouseArea.pressed == <font color="#0000ff">false</font> ; <br> PropertyChanges { target: button; opacity: 0.7; } <br> } <br> ] <br> }</font></code> </blockquote> <br>  An element can go to a specific state either automatically when the condition specified in <i>when</i> is met, or manually, by changing the <i>state</i> property. <br><br>  Launched, clicked, the transparency changes, it's better, but not enough smoothness.  Add the following code: <br><blockquote> <code><font color="black">Image <br> { <br> ... <br> Behavior on opacity <br> { <br> <font color="#008000">//     100 </font> <br> <font color="#008000">//   100    </font> <br> <font color="#008000">//  0,1</font> <br> NumberAnimation { duration: 100 } <br> } <br> }</font></code> </blockquote> <br>  <i>Behavior is a</i> very useful element for creating animations, allowing you to specify how the specified property will change, in this case the transparency of the button. <br><br>  We start and look, quite another thing, a smooth transition from a semi-transparent to an opaque state. <br><img src="https://habrastorage.org/getpro/habr/post_images/d0e/ad9/d4e/d0ead9d4e755dd433670b05c9172a73c.png"><br><br>  The program window will be implemented entirely in QML.  This will be a modal window that will appear when you click on the <i>about</i> button.  When you click the left mouse button anywhere in the window, it will disappear.  Add a new QML file <i>About.qml</i> to the project. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5f/105/f90/d5f105f9081ea8e8201d869c88a41b10.png"><br><br>  I will give at once all the code of this window with explanations <br><blockquote> <code><font color="black"><font color="#008000">//     </font> <br> Rectangle <br> { <br> id: about <br> <br> <font color="#008000">//    </font> <br> <font color="#008000">//    </font> <br> function show() <br> { <br> about.opacity = 1; <br> } <br> <br> <font color="#008000">//    </font> <br> function hide() <br> { <br> about.opacity = 0; <br> } <br> <br> <font color="#008000">//   </font> <br> color: <font color="#A31515">"transparent"</font> <br> <font color="#008000">//    </font> <br> opacity: 0 <br> <br> <font color="#008000">//     </font> <br> <font color="#008000">//     </font> <br> <font color="#008000">//       id: canvas</font> <br> width: parent.width <br> height: parent.height <br> <br> <font color="#008000">//       </font> <br> <font color="#008000">// opacity &gt; 0</font> <br> visible: opacity &gt; 0 <br> <br> <font color="#008000">//  ,   </font> <br> Rectangle <br> { <br> anchors.fill: parent <br> <br> opacity: 0.5 <br> <br> color: <font color="#A31515">"gray"</font> <br> } <br> <br> <font color="#008000">//      </font> <br> <font color="#008000">// " ..."</font> <br> Rectangle <br> { <br> id: dialog <br> <br> <font color="#008000">//     </font> <br> width: 360 <br> height: 230 <br> <br> <font color="#008000">//     </font> <br> <font color="#008000">//       </font> <br> <font color="#008000">// ,     </font> <br> x: parent.width / 2 - dialog.width / 2; <br> y: parent.height / 2 - dialog.height / 2; <br> <font color="#008000">//  z  ,   </font> <br> <font color="#008000">//  z  ,   </font> <br> <font color="#008000">//   </font> <br> z: 10 <br> <br> border.color: <font color="#A31515">"gray"</font> <br> <br> Text <br> { <br> text: <font color="#A31515">"4 Toddler"</font> <br> <br> font.bold: <font color="#0000ff">true</font> <br> <br> font.pixelSize: 22 <br> <br> <font color="#008000">//    </font> <br> anchors.horizontalCenter: parent.horizontalCenter <br> anchors.verticalCenter: parent.verticalCenter <br> } <br> } <br> <br> Behavior on opacity <br> { <br> NumberAnimation { duration: 100 } <br> } <br> <br> MouseArea <br> { <br> <font color="#008000">//     </font> <br> anchors.fill: parent; <br> <br> <font color="#008000">//       </font> <br> onClicked: hide(); <br> } <br> }</font></code> </blockquote> <br>  First I would like to draw attention to the property <br><blockquote> <code><font color="black">width: parent.width</font></code> </blockquote> <br>  This is not just an assignment of width, if during the display the width of the parent element changes, then the width of the child will be recalculated.  I don‚Äôt know about you, but this feature pleasantly surprised me in the process of ‚Äúpicking‚Äù QML.  The following line is also interesting: <br><br><blockquote> <code><font color="black">visible: opacity &gt; 0</font></code> </blockquote> <br>  The property can be not only defined, but also calculated. <br><br>  It remains to add the dialog and code to display it when you click <i>about</i> .  Add the code to the <i>Main.qml</i> file at the end of the <i>canvas element</i> <br><br><blockquote> <code><font color="black">Rectangle <br> { <br> id: canvas <br> .. <br> About <br> { <br> id: aboutDlg <br> } <br> }</font></code> </blockquote> <br>  In order for the window to be displayed add a line <br><br><blockquote> <code><font color="black">aboutDlg.show();</font></code> </blockquote> <br>  to the <i>callback</i> function of the <i>about</i> button <br><br><blockquote> <code><font color="black">WindowButton <br> { <br> id: about; <br> ... <br> <font color="#0000ff">function</font> callback() <br> { <br> aboutDlg.show(); <br> } <br> }</font></code> </blockquote> <br>  Now we will add, actually the main functionality.  Let's start by displaying a random picture when pressing any key.  The image will be an element of <i>Image</i> , we define this element in a separate file.  Add a <i>Block.qml</i> file to the project <i>.</i> <br><blockquote> <code><font color="black">Image <br> { <br> id: block; <br> <br> <font color="#008000">//   , </font> <br> <font color="#008000">//      </font> <br> property <font color="#0000ff">bool</font> remove: <font color="#0000ff">false</font> <br> <font color="#008000">//   </font> <br> property <font color="#0000ff">bool</font> show: <font color="#0000ff">false</font> <br> <br> opacity: 0; <br> fillMode: Image.Stretch; <br> <br> states: [ <br> State <br> { <br> <font color="#008000">// ,    </font> <br> <font color="#008000">// ,     </font> <br> name: <font color="#A31515">"remove"</font> ; when: remove == <font color="#0000ff">true</font> ; <br> PropertyChanges { target: block; opacity: 0 } <br> StateChangeScript { script: block.destroy(1000); } <br> }, <br> State <br> { <br> <font color="#008000">// ,    </font> <br> <font color="#008000">// ,     </font> <br> name: <font color="#A31515">"show"</font> ; when: show == <font color="#0000ff">true</font> ; <br> PropertyChanges { target: block; opacity: 1 } <br> } <br> ] <br> <br> Behavior on opacity { NumberAnimation { duration: 300 } } <br> }</font></code> </blockquote> <br>  When you press any key on the keyboard, a block with an arbitrary picture will be displayed.  Add a new <i>main.js</i> file to the <i>project</i> .  In it, we define a keystroke handler on the keyboard. <br><blockquote> <code><font color="black"><font color="#008000">//     </font> <br> <font color="#0000ff">var</font> component = Qt.createComponent( <font color="#A31515">"block.qml"</font> ); <br> <br> <font color="#008000">//   </font> <br> <font color="#0000ff">var</font> maxBlocksCount = 10; <br> <br> <font color="#008000">// ,      </font> <br> <font color="#0000ff">var</font> blocksArray    = <font color="#0000ff">new</font> Array(); <br> <br> <font color="#008000">//    </font> <br> function handleKey() <br> { <br> <font color="#008000">//  x -    0   </font> <br> <font color="#0000ff">var</font> x = <font color="#2B91AF">Math</font> .floor( <font color="#2B91AF">Math</font> .random() * canvas.width); <br> <font color="#008000">//  y -    0   </font> <br> <font color="#0000ff">var</font> y = <font color="#2B91AF">Math</font> .floor( <font color="#2B91AF">Math</font> .random() * canvas.height); <br> <br> <font color="#008000">//  ,    </font> <br> <font color="#008000">//   </font> <br> createNewBlock(x, y); <br> } <br> <br> <font color="#008000">//   </font> <br> function createNewBlock(x, y) <br> { <br> <font color="#0000ff">if</font> (component.status != Component.Ready) <br> { <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> } <br> <br> <font color="#008000">//   </font> <br> <font color="#0000ff">if</font> (blocksArray.length &gt; maxBlocksCount) <br> { <br> removeAllBlocks(); <br> } <br> <br> <font color="#0000ff">var</font> newBlock = component.createObject(canvas); <br> <br> <font color="#0000ff">if</font> (newBlock == <font color="#0000ff">null</font> ) <br> { <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> } <br> <br> <font color="#008000">//        </font> <br> <font color="#008000">//  randomIcon</font> <br> <font color="#0000ff">var</font> iconFile = window.randomIcon; <br> <br> newBlock.source = ( <font color="#A31515">"Icons/"</font> + iconFile); <br> <br> newBlock.x = x; <br> newBlock.y = y; <br> <br> <font color="#008000">//     show</font> <br> newBlock.show = <font color="#0000ff">true</font> ; <br> <br> blocksArray.push(newBlock); <br> <br> <font color="#008000">//    </font> <br> window.PlaySound(); <br> <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <br> <font color="#008000">//    </font> <br> function removeAllBlocks() <br> { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt; blocksArray.length; ++i) <br> { <br> blocksArray[i].remove = <font color="#0000ff">true</font> ; <br> } <br> <br> <font color="#0000ff">while</font> (blocksArray.length != 0) <br> { <br> blocksArray.pop(); <br> } <br> }</font></code> </blockquote> <br>  As you can see from the code, we still need to implement the <i>randomIcon</i> property and the <i>PlaySound function of the</i> main window. <br><br>  Add a property to the declaration of the class <i>MainWindow</i> <br><br><blockquote> <code><font color="black">Q_PROPERTY(QString randomIcon READ RandomIcon)</font></code> </blockquote> <br>  And function declaration <br><br><blockquote> <code><font color="black">QString RandomIcon();</font></code> </blockquote> <br>  Then the implementation: <br><br><blockquote> <code><font color="black">QString MainWindow::RandomIcon() <br> { <br> QStringList iconFilesList; <br> QString searchPath = m_ContentPath + <font color="#A31515">"/Icons/"</font> ; <br> <br> QDir directory = QDir(searchPath); <br> QStringList filters; <br> filters &lt;&lt; <font color="#A31515">"*.png"</font> ; <br> directory.setNameFilters(filters); <br> <font color="#008000">//      png</font> <br> iconFilesList = directory.entryList(QDir::AllEntries); <br> <br> <font color="#008000">//    </font> <br> <font color="#0000ff">int</font> fileIdx = qrand() % iconFilesList.count(); <br> <br> <font color="#008000">//   </font> <br> <font color="#0000ff">return</font> iconFilesList.at(fileIdx); <br> }</font></code> </blockquote> <br>  Now add a function to the header file to play the sound effect. <br><blockquote> <code><font color="black">Q_INVOKABLE <font color="#0000ff">void</font> PlaySound();</font></code> </blockquote> <br>  and implementation <br><blockquote> <code><font color="black"><font color="#0000ff">void</font> MainWindow::PlaySound() <br> { <br> QStringList soundFilesList; <br> QDir directory = QDir(m_ContentPath + <font color="#A31515">"/Sounds/"</font> ); <br> QStringList filters; <br> filters &lt;&lt; <font color="#A31515">"*.wav"</font> ; <br> directory.setNameFilters(filters); <br> <br> <font color="#008000">//      wav</font> <br> soundFilesList = directory.entryList(QDir::AllEntries); <br> <font color="#008000">//    </font> <br> <font color="#0000ff">int</font> fileIdx = qrand() % soundFilesList.count(); <br> <br> <font color="#008000">//   </font> <br> QString soundFile = m_ContentPath + <font color="#A31515">"/Sounds/"</font> + soundFilesList.at(fileIdx); <br> <font color="#008000">//  </font> <br> QSound::play(soundFile); <br> }</font></code> </blockquote> <br>  Almost everything, it remains to add a keystroke handler to our root element to call the function of creating a new element.  In the beginning of the file <i>main.qml we</i> make visible our script in the file <i>main.qml</i> <br><br><blockquote> <code><font color="black">import Qt 4.7 <br> import <font color="#A31515">"main.js"</font> <font color="#0000ff">as</font> Main</font></code> </blockquote> <br><br>  and the handler itself inside the <i>canvas element</i> <br><br><blockquote> <code><font color="black">Rectangle <br> { <br> id: canvas <br> ... <br> Keys.onPressed: { <font color="#0000ff">if</font> ( <font color="#0000ff">event</font> .isAutoRepeat == <font color="#0000ff">false</font> ) { Main.handleKey(); } }</font></code> </blockquote> <br>  That's all - we can run and admire. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2f7/a1d/166/2f7a1d16620aa220758ba640aa1c5683.png"><br><br>  As I promised, the program is simple, but, in my opinion, this is a rather interesting ‚Äúgame‚Äù platform for those who are just starting to learn QML.  There is no limit to perfection, who knows, maybe someone will develop it into something more worthwhile. <br><br>  Archive with the project can be downloaded <a href="">here.</a> </div><p>Source: <a href="https://habr.com/ru/post/110544/">https://habr.com/ru/post/110544/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110537/index.html">Profiling python applications</a></li>
<li><a href="../110538/index.html">Making Desire HD from Desire</a></li>
<li><a href="../110540/index.html">Web Worker Wars</a></li>
<li><a href="../110541/index.html">Tutumba: our new user review service</a></li>
<li><a href="../110542/index.html">Do not use human keyboard</a></li>
<li><a href="../110546/index.html">Website Creative Commons translated into Russian at 100%</a></li>
<li><a href="../110547/index.html">The policy of controlling the frequency of the processor "ondemand" and iowait in Ubuntu</a></li>
<li><a href="../110549/index.html">Website launched on Windows Phone 7 for iPhone developers</a></li>
<li><a href="../110553/index.html">Review of the Kingmax Hercules Nano RAM Kit - Ancient Greek Hero in Nano-armor</a></li>
<li><a href="../110555/index.html">Platform 2011: Video of 70 conference reports became available.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>