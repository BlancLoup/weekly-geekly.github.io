<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Not another XSS filter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is Cross Site Scripting? Read about it on Wikipedia :) 

 But know - the browser is to blame for everything. It doesn‚Äôt matter whether it support...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Not another XSS filter</h1><div class="post__text post__text-html js-mediator-article">  What is Cross Site Scripting?  Read about it on <a href="http://ru.wikipedia.org/wiki/Xss">Wikipedia</a> :) <br><br>  But know - the browser is to blame for everything.  It doesn‚Äôt matter whether it supports HTML5 or still does not understand PNG transparency.  Well, since the client is always right, I will tell you how to properly filter the <s>bazaar</s> content. <br><br><a name="habracut"></a><br><h2>  A bit about XSS </h2><br>  The <acronym>XSS</acronym> philosophy is such that the text is not ‚Äúby the rules‚Äù used to inject malicious code onto a page.  What they should be: <br><ul><li>  The tag name is separated from the attributes by \ r \ t \ n \ s characters only: <br><blockquote><code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="http://habrahabr.ru"</font> <font color="#0000ff">&gt;</font> Click <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> <font>&lt;!--  --&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">a</font> \ <font color="#ff0000">href</font> <font color="#0000ff">="XSS"</font> <font color="#0000ff">&gt;</font> Click <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> <font>&lt;!--  --&gt;</font></font></code> </blockquote> <br></li><li>  HTML Entities presented in decimal / hexadecimal forms should be converted to their usual form: <br><blockquote> <code><font color="black">&amp;amp;#106;&amp;amp;#97;&amp;amp;#118;&amp;amp;#97;&amp;amp;#115;&amp;amp;#99;&amp;amp;#114;&amp;amp;#105;&amp;amp;#112;&amp;amp;#116; <br> javascript</font></code> </blockquote> <br></li><li>  There is a set of tags that should not be on the user‚Äôs page.  Here you should not forget about HTML5, in which there are tags (for example, audio, video) that allow an attacker to download the code into the browser by replacing the resource with a scriptlet. <br></li><li>  Prevent use of DOM events. <br></li><li>  The ban on the inclusion of javascript in the inline attribute or (attention!) Vbscript. <br></li><li>  Prohibit the use in style of such IE-crafts as "expression" or CSS3 "behavior" <br></li></ul><br>  It's all from the main, in more detail about the existing types of attacks can be read <a href="http://ha.ckers.org/xss.html">here.</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  How can I defend myself? </h2><br>  Most XSS prevention solutions use hard filtering of potentially hazardous structures. <br>  But let's look at this example: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> = <font color="#ff0000">http:</font> // <font color="#ff0000">habrahabr</font> . <font color="#ff0000">ru</font> <font color="#0000ff">&gt;</font> javascript:alert("Hello"); <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  The danger level of this code is zero.  However, CodeIgniter will return the following (in other frameworks it did not check, it will be useful to read in the comments): <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> [removed]alert("Hello"); <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  So the sparrow from the gun CodeIgniter killed. <br><br><h2>  There is a more flexible filter </h2><br>  Recently, I am developing my <a href="http://code.google.com/p/platcode/">Platcode</a> framework.  But here I did not come to promote it, but to tell about my own <a href="http://code.google.com/p/platcode/source/browse/trunk/system/plugins/XSS.php">XSS filter</a> . <br><br>  The principle of operation is simple - we parse the input string into tags / attributes / values, then apply filters to remove dangerous tags and attribute values.  Thus, we omit redundant filtering throughout the text and make targeted changes in tags / attributes separately.  In this case, the above example will retain its original appearance.  And the customer will be happy. <br><br>  Of the filter features: <br><ul><li>  removing "dangerous" tags </li><li>  remove inline javascript / vbscript </li><li>  removing the style attribute containing the expression behavior </li><li>  converting tag / attribute names to lowercase </li><li>  deletion of empty attributes </li><li>  automatic creation of closing tags </li><li>  conversion of single tags of the form &lt;br&gt; to &lt;br /&gt; </li></ul><br>  The code, however, is very poorly documented, but the functionality is 100% workable.  To whom it is interesting to participate in a project or hack a XSS filter, write in a personal. <br><br>  <b>UPD.</b> <br><br>  <a href="http://dev.plakmag.ru/xss">To test the XSS filter</a> Yes will not descend on a habra effect :) <br><br>  <b>UPD2.</b> <br><br>  Thanks to the habrasoobshchestvu catching and fixing bugs go nostril to the nostril. <br><br>  Respect to users: <a href="https://habrahabr.ru/users/insa/" class="user_link">insa</a> , <a href="https://habrahabr.ru/users/isis/" class="user_link">isis</a> , <a href="https://habrahabr.ru/users/recompileme/" class="user_link">recompileme</a> , <a href="https://habrahabr.ru/users/floppyformator/" class="user_link">floppyformator</a> , ICQ: 32523553 </div><p>Source: <a href="https://habr.com/ru/post/70795/">https://habr.com/ru/post/70795/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../70789/index.html">Test Labs 2009</a></li>
<li><a href="../70790/index.html">Visiting Turbomilk</a></li>
<li><a href="../70792/index.html">PHP & AMQP (Continued) Installing php-rabbit</a></li>
<li><a href="../70793/index.html">Use the Observer pattern to create a process execution indicator in Javascript</a></li>
<li><a href="../70794/index.html">Algorithm: we get rid of passwords for different resources - we use a mailbox</a></li>
<li><a href="../70796/index.html">classic TCP server</a></li>
<li><a href="../70800/index.html">Create an application - "Drum Set"</a></li>
<li><a href="../70801/index.html">UPD: Cisco and 2 providers</a></li>
<li><a href="../70803/index.html">Explore view.yml features</a></li>
<li><a href="../70804/index.html">Just add water: Myna</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>