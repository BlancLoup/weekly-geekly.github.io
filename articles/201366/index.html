<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Radio modem for $ 7</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good time of day! 
 I will tell you how you can assemble a 100mW radio modem at 433 MHz for yourself, at a cost of about 6-7 dollars. Powerful radio m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Radio modem for $ 7</h1><div class="post__text post__text-html js-mediator-article">  Good time of day! <br>  I will tell you how you can assemble a 100mW radio modem at 433 MHz for yourself, at a cost of about 6-7 dollars.  Powerful radio modem for 200 rubles - is it tempting?  Then let's get started. <br><img src="https://habrastorage.org/getpro/habr/post_images/efa/63c/724/efa63c72477f02ccba2403ce6a8cd532.jpg" alt="Appearance"><br>  Wanted soldering skills a little above average and ordering experience in online stores. <br><a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">How it all began</b> <div class="spoiler_text">  I wanted to telemetry on the copter.  But buying a ready-made 3DRadio radio modem - the toad strangled, for a pair costs $ 39.  It was decided to make a functional counterpart, but not so expensive.  On the occasion, I bought the RFM22B radio modules, and tested them on the open-source OpenBee project.  It turned out around $ 22 a pair (google on request "openbee 433 MHz").  Having obtained a satisfactory result, it was decided to make the construction even cheaper, using their cheap Si4432 counterparts instead of expensive RFM22. </div></div><br><h5>  Design </h5><br>  The modem consists of a Si4432 radio module and an ATMega8 / 168/328 based controller that controls it.  Any suitable.  If you use older versions (168 and 328), the modem parameter configurator will be a bit prettier.  The radio module is powered by 3.3 volts through the AMS1117-3.3 stabilizer.  The processor is powered by 5 volts, and operates at 16 MHz, the frequency is stabilized by quartz.  The communication lines with the radio module are matched by the voltage level with the help of zener diodes. <br><div class="spoiler">  <b class="spoiler_title">Component Specification</b> <div class="spoiler_text">  <a href="http://www.aliexpress.com/item/SI4432-wireless-module-1000meters-long-distance-240-960mhz-Special-promotions/929600736.html">Si4432</a> - 100mW 433MHz radio module manufactured by Silabs. <br>  ATMega8 or ATMega168 or <a href="http://www.aliexpress.com/item/100-new-origianl-10PCS-LOT-ATMEGA328-ATMEGA328P-ATMEGA328P-AU-ATMEL-2013-TQFP32-In-stock-Best-price/965441732.html">ATMega328</a> <br>  Quartz <a href="http://www.aliexpress.com/item/Crystal-and-Oscillator-3-2x1-3x0-7mm-16-00MHZ-SMD-CSTCE16M0V53-R0-muRata-16mhz/1174307979.html">Murata CSTCE16M0V53-R0</a> 16MHz.  In principle, output quartz will do, but you will have to install it on the back of the board, and you will need capacitors on the ground. <br>  <a href="http://www.ebay.com/itm/New-10-x-AMS1117-LM1117-1117-3-3V-1A-Voltage-Regulator-/221105133435%3Fpt%3DLH_DefaultDomain_0%26hash%3Ditem337ae4977b">AMS1117-3.3</a> (LM1117) <br>  VD1-VD3 - BZV55C3V3 - 3,3V zener diode, without conclusions <br>  VD4 - LL4148 (DL4148) - rectifying diode, also without pins <br>  C1 - 1000pF (size 0805).  You can not set. <br>  C2, C3 - 4.7 ... 25 uF tantalum (size 1210) <br>  C4 - 0.1uF (0.01 ... 0.2uF) <br>  R1-R3 - 470 Ohms (470 ... 510) <br>  R4, R5 - 4.7 K (4.7 ... 10K) <br>  R6, R7 - 1K (0 ... 2K) <br>  R8, R9 - 330 ohms (220 ... 680) <br>  R0 - 0 Ohm - jumper <br>  All resistors size 0805, in parentheses indicate the possible range of values, however, it is better to adhere to these. <br>  LED1, LED2 - SMD LEDs, size 0805, different colors. <br></div></div><br>  Also, apart from the actual components of the modem, for its repetition you will need: <a href="http://www.ebay.com/itm/New-1pc-USB-ISP-Programmer-For-ATMEL-AVR-ATMega-ATTiny-51-Development-Board-/350796245949%3Fpt%3DLH_DefaultDomain_0%26hash%3Ditem51ad15ebbd">ISP programmer</a> and <a href="http://www.ebay.com/itm/FTDI-Basic-6-PIN-3-3-5V-For-Arduino-usb-to-TTL-FT232-Program-Download-usb-cable-/190871660047%3Fpt%3DLH_DefaultDomain_0%26hash%3Ditem2c70d6660f">FTDI adapter</a> (I did not buy the device by reference, but it looks interesting - supposedly it has an ISP).  You can do only ISP programmer. <br>  The attentive reader will immediately notice, saying, ‚ÄúWhat modem for 7 bucks, if only the 328th mega is 200 rubles?‚Äù And also notice that all references in the specification lead to online stores.  Unfortunately, if you buy components in Russia, the modem will come out gold (as, by the way, everything that is produced in Russia).  Therefore, in order to achieve the minimum cost - it is necessary to order radio components in China.  The negative point - will have to wait for the arrival of the parcels.  However, Si4432 and so ordered in Asia, so it will still have to wait.  Often, a batch of 10 pieces, the same ATMega328, is obtained at a price the same as a batch of 5 pieces.  It is necessary to monitor prices and look for a suitable option. <br>  So after all, from where 7 dollars?  We consider: <br>  Si4432 - $ 4 <br>  ATMega8 - $ 0.8 (only a batch of 10 pcs.) <br>  AMS1117 - $ 1 (in fact, these are 10 stabilizers ($ 0.1) in a batch of 20) <br>  Tumbler - LEDs 2x5 rubles, resistors-capacitors - 10x0.3 + 4x4 rubles (of course, if you are not buying in chipidip) <br>  If we categorically do not want to buy radio parts in lots - well, then the modem will rise in price for a dollar due to the price of mega. <br>  The fee is free or 10 rubles, etching solution, soldering iron, solder, etc. - I do not take into account, because these are not disposable things, and someone probably already has them. <br><br><h5>  Scheme and fee </h5><br>  The schematic diagram of the device is shown in the figure below: <br><img src="https://habrastorage.org/getpro/habr/post_images/40a/0b9/a5b/40a0b9a5bfa42be4a3bc9cdcd450a0f6.gif" alt="Schematic"><br>  The printed circuit board was divorced in Sprint Layout in 2 versions: for the antenna-coil, and for the installation of the RF connector type SMA.  Both options are optimized for LUT.  If you do not like the mesh fill (better for LUT) - you can turn on the solid in the editor. <br><img src="https://habrastorage.org/getpro/habr/post_images/46a/43b/045/46a43b045dfd395b4e2002319404cef8.gif" alt="Layout">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Board assembly </h5><br>  The assembly takes place in 2 stages: <br>  On the first - small parts are installed, stabilizer, processor. <br>  After that, you need to flash the processor using the ISP programmer with Arduino bootloader.  This is done to simplify your life - after uploading the bootloader, there is no need to poke the ISP into the board to fill in the new firmware.  Test firmware is being poured in order not to burn the radio module. <br>  At the second stage, the radio module is installed on the board, after which the ‚Äúcombat‚Äù firmware is poured. <br><img src="https://habrastorage.org/getpro/habr/post_images/25c/fc8/74d/25cfc874dcce453eb862d6ff8628c561.jpg" alt="Assembly"><br>  Actually, in the image 1 - the etched board, 2 - small things are installed, 3 - the test firmware is flooded, 4 - the radio module is installed, the board is varnished, 5 - the screen is installed from interference, from tin. <br><br><h5>  Firmware </h5><br>  The modem firmware is written in Arduino.  No programmer from me (I am an engineer) - therefore the quality of the code is very so-so.  You can tell where to improve something - I will be glad. <br>  The program is based on <a href="https://code.google.com/p/openbee/source/browse/">the OpenBee project</a> .  Actually, my changes are a setup mode that was not made in the original firmware, and a fix for the jamb with clearing the transmission buffer.  Also in the original firmware was a cant - the frequency was not tuned (it was define, but then the data was erased with data from the EEPROM, which was never recorded) and the device‚Äôs RFID tag.  Now everything is set up. <br>  The firmware process is as follows: <br>  A bootloader is recorded using an ISP.  For the board on mega8 - bootloader for the board ‚ÄúArduino NG or older w / ATMega8‚Äù.  For the board on mega 168 and 328 - ‚ÄúArduino Pro or Pro mini (5V, 16MHz) w / ATMega 168‚Äù and ‚ÄúArduino Pro or Pro mini (5V, 16MHz) w / ATMega 328‚Äù, respectively. <br><div class="spoiler">  <b class="spoiler_title">My ISP way</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/72d/5ba/a62/72d5baa622f0a88664ee449d047fd9bb.jpg" alt="image"><br>  The method is called "Voodoo", it's easy to guess why =) </div></div><br>  Test firmware is recorded.  Already directly from Arduino.  It initializes the EEPROM, blinks the LEDs, and sets all the legs of the processor to High-Z mode. <br><div class="spoiler">  <b class="spoiler_title">About pouring in mega 8</b> <div class="spoiler_text">  When uploading to megu8 there is an unpleasant moment - the bootloader starts for a very long time (about 6 seconds).  It may be necessary to force a reset by closing the reset foot to the ground.  This should be done at the moment when the inscription ‚ÄúUploading ...‚Äù appears in the arduino (to close and immediately release the reset - I did this with tweezers so that the legs are near) </div></div><br>  Well, and lastly, the working firmware is recorded.  Also from Arduino. <br><br><h5>  Customization </h5><br>  The modem is configured when the modem is turned on with the ‚ÄúSET‚Äù pin closed at + 5V. <br>  At the same time, a port menu is issued to the port at a speed of 9600 baud, in which you can change the working frequency, the speed of the serial port and the radio module, and so on.  RFID tag (RF Header), in which the modems "interlock" with each other. <br>  Be sure to configure the radio tag to separate your modems from other devices.  The OLRS label is highly discouraged (this is the default label for all Open LRS devices to which the modem belongs). <br><br><h5>  Running a rake </h5><br><div class="spoiler">  <b class="spoiler_title">For those interested</b> <div class="spoiler_text"> Naturally, it was not without jambs.  Carefully looking at the picture of the printed circuit board and the assembled device - it is clear that they are different.  The jamb showed up suddenly - the modem sent the data, but did not receive anything.  It turned out that the foot of the nIRQ radio module is wound up on the D2 mega for a reason.  It causes an interrupt (which I initially overlooked in the code).  Moreover, the interruption is generated only from the feet D2 or D3.  I, for convenience of distributing, got nIRQ on D5.  I had to re-breed.  As a result, nIRQ is running on D3.  It was also a mistake to start the output of the radio module on MISO atmega initially.  When programming mega with a soldered module - there is a real chance to burn the radio module.  Overdone <br></div></div><br>  The test and ‚Äúcombat‚Äù firmware from Arduino is recorded using a standard USB-UART converter on FTDI.  The connector on the modem is not compatible with the standard "Arduinovsky", connect the RX-TX, TX-RX, DTR-Reset, +5, GND.  If there is no FTDI in the farm (as it is ???) - the firmware can be poured using ISP. <br>  There is an unresolved flaw in the firmware.  In theory, the speed of the serial port is limited to 115K.  However, due to the recording in EEPROM uint - in fact, the speed can be no more than 65535 baud.  In this connection, the plug is set up - when 65534 is exceeded - 57600 is recorded. If there is a desire, you can disable the configuration from the computer and set the speed in the firmware.  However, it makes little sense to do this - no, because the maximum speed in the aero channel is 57600. <br>  There is also a limit on the length of the packet received on the serial port.  This is 37 bytes.  This restriction was introduced by the authors of the original project, and, apparently, due to the buffer depth of the radio module (64 bytes).  Here I did not change anything. <br><br><h5>  I want to repeat! </h5><br>  Sources, drawings of the printed circuit board, scheme - are <a href="https://drive.google.com/folderview%3Fid%3D0B1eG0s2wbI2lcERVWlhraDhVSUU%26usp%3Dsharing">in the catalog by reference</a> . <br><br><h5>  Option for bad guys (s) </h5><br>  If 100 mW is not enough for you - there is an option to remake this modem into the RFM23BP module.  Its output power is 1 watt. <br>  It should be understood that the use of such a thing is illegal in this country. <br><br>  UPD. <br>  Based on a comment.  I checked the wave resistance of the track to the SMA connector.  In principle, everything was not bad (60 ohms), however, to heighten the agreement, I slightly changed the width of the track.  Replaced the board file. </div><p>Source: <a href="https://habr.com/ru/post/201366/">https://habr.com/ru/post/201366/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201352/index.html">Development of cross-platform mobile applications in Delphi # 3</a></li>
<li><a href="../201354/index.html">Developing Titanium module for iOS</a></li>
<li><a href="../201358/index.html">IE11: Compatibility List vs. X-UA-Compatible</a></li>
<li><a href="../201360/index.html">Visual effects for Skyforge. Art and technology</a></li>
<li><a href="../201364/index.html">Additional features of Aastra Mobile Client</a></li>
<li><a href="../201368/index.html">Hekslet 5 months later: new online courses in Russian</a></li>
<li><a href="../201370/index.html">AllWinner Processor Development Plans to 2015: A23, A6X, A7X, A8X and A9X</a></li>
<li><a href="../201372/index.html">Notebook Fujitsu Lifebook T902 - for the "white collar" and not only</a></li>
<li><a href="../201374/index.html">Using Screenshots for Testing</a></li>
<li><a href="../201376/index.html">API for the Russian public initiative. Step 2.2: US experience with electronic petition data - White House API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>