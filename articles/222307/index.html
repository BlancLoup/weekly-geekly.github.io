<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mobile application development in Embarcadero FireMonkey (FMX 6)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No one likes to write the same code several times, but this is exactly what has to be done if the mobile application has to be implemented for several...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mobile application development in Embarcadero FireMonkey (FMX 6)</h1><div class="post__text post__text-html js-mediator-article">  No one likes to write the same code several times, but this is exactly what has to be done if the mobile application has to be implemented for several platforms at once.  It is a shame that the programmers of the company, in each case, need to use different tools, skills and approaches.  Of course, there is a desire that, when transferring an application, at least, it was not necessary to change the programming language. <br><br>  So this time, reflecting on the complexities of developing applications for mobile, we could not resist the temptation to try on the ancient Russian dream, and, like the hero of the fairy tale ‚ÄúBy the will of the horse‚Äù, ride the stove.  Looking ahead, we say that the "oven" went, albeit with some squeak. <br><br>  So, as you know, there are several approaches used in the cross-platform development of mobile applications.  Each of these solutions has its drawbacks, and, perhaps, we will present a comparative analysis of various approaches in one of the following publications.  Here we will discuss only one such instrument, which, as it seems to us, is somewhat overlooked by the audience, although it has several unique features. <br><a name="habracut"></a><br>  FireMonkey is a product of the notorious <a href="https://www.embarcadero.com/products/rad-studio/fmx">Embarcadero</a> company.  FireMonkey is part of the RAD Studio development environment.  The underlying FMX engine was once developed by our compatriot and is a Flash Platform-like cross-platform framework for building user interfaces.  At the same time, like the mentioned products, FMX uses vector graphics and hardware acceleration.  The product appeared only a few years ago, but during this time 5 updates have already been released.  I want to believe that the product will not suffer the fate of the infamous Delphi .NET. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Applications are compiled directly into machine code, and this is one of the main distinguishing features of the solution in question.  Due to these remarkable circumstances, Embarcadero, in theory, promises us overall performance at the level of native applications.  Being built into Delphi and C ++ Builder, FireMonkey allows you to implement the logic of applications in Pascal and C ++.  The same FireMonkey (FM) application code can be compiled to work on Windows, iOS, and Android.  We were attracted by the opportunity to develop in C ++, since the company had a large number of programmers in this area.  Therefore, to test the functionality, the C ++ Builder version of RAD Studio XE6 was installed, although the Delphi edition should not differ by anything other than the programming language used. <br><br><h3>  Build applications </h3><br>  Having behind his back a turbulent past associated with the creation of compilers, the manufacturer equipped FireMonkey with native C ++ compilers for x86 and ARMv7.  This allows you to compile directly on the computer running the development environment.  It is the presence of our own compilers that gives us the opportunity to program in C ++ or even Pascal, obtaining the necessary machine code ARM at the output.  However, the original application toolkit from the development tools (SDK) of mobile platforms is <u>still</u> used to build the application (link), sign it, launch it on devices, and debug it.  Thus, before starting work, you still need to do the following: <br><br><table><tbody><tr><th>  iOS </th><th>  Android </th></tr><tr><td>  <i>Have a Mac</i> </td><td>  --- </td></tr><tr><td>  Sign up for iOS Developer Program </td><td>  Register on Android Developer site </td></tr><tr><td>  Get certificates (developer, provisioning) </td><td>  Generate a key for signing applications </td></tr><tr><td>  Download and install iOS SDK </td><td>  Download and install the Android SDK and NDK </td></tr><tr><td>  Download and install PAServer on Mac </td><td>  --- </td></tr><tr><td>  Configure the connection between RAD Studio and PAServer </td><td>  --- </td></tr></tbody></table><br>  Since both RAD Studio and Android toolkit work on PCs, Android development requires slightly less body movements than iOS.  To build iOS applications, you need a Mac OS (since only for it does Apple release an SDK).  Thus, if an application is being developed on a PC, they must somehow communicate.  From the diagram below, you can see how using the supplied Embarcadero PAServer (Platform Assistant Server) you can build iOS applications via a PC: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc0/da7/ad8/bc0da7ad8317d18e031f25c5bde036a5.png"><br><br><h3>  Example </h3><br>  As part of the FireMonkey sample, we developed a simple application (at the Hello world level), by the example of which we wanted to test the functionality of the proposed technology. <br><br>  Below is a screenshot of the version of this application for Windows and a short video so you can see its simple work in dynamics: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ec/18d/73b/9ec18d73b3dd72565f32070b216b3559.png" alt="image" align="left"><br><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/94983675&amp;xid=17259,15700021,15700043,15700186,15700191,15700253&amp;usg=ALkJrhitTsl3COoAkm1jxvVzOuPNjaYs1A" width="196" height="315" frameborder="0" title="FireMonkey Test Windows" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe><br><br>  Our application contains almost no code.  Nevertheless, we will tell you exactly what we did. <br><br>  In this case, we were interested in the mutation of the user interface on different platforms, as well as performance, but in its "everyday" understanding of it.  That is, the user doesn‚Äôt care about the number of floating-point operations per second, but how softly and quickly the application responds to its actions. <br><br>  The application consists of several standard controls and contains a pair of user action handlers.  At the top of the screen is a "twist", moving which you can rotate the image on the left.  This part of the test was needed to test the ability of FMX to draw two-dimensional graphics, or rather, to perform raster operations. <br><br>  The progress indicator located just below displays the current value of the angle on which the wheel is set.  It is needed to test the interactions in the UI stream and, also, to look at the style of this element on different platforms. <br><br>  Handler wheel rotation: <br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//--------------------------------------------------------------------------- void __fastcall TForm1::DialAngleChange(TObject *Sender) { // Every time the angle dialer is spinned, assign // its current value to the Image control... imgLogo-&gt;RotationAngle = 360 - DialAngle-&gt;Value; // The progress bar will get updated with a normalized angle value pbAngle-&gt;Value = (int)fabs(DialAngle-&gt;Value)%360; } //---------------------------------------------------------------------------</span></span></code> </pre> <br>  As you can see, this is the usual C ++, but a bit "soiled" by the legacy of Delphi. <br><br>  Below is the traditional button (which, however, is not so similar to the button) with the following HW handler: <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//--------------------------------------------------------------------------- void __fastcall TForm1::btnHelloClick(TObject *Sender) { // A simple HW assignment btnHello-&gt;Text = "Hello world!"; } //---------------------------------------------------------------------------</span></span></code> </pre><br><br>  To the right you can see the date selection field (DateTimePicker).  We were interested, first of all, in its appearance on mobile operating systems: whether the native control will be used in each case or something drawn.  For the same reason, below is a slider and ON / OFF switch.  This switch, however, gained another function: it includes one of the standard FMX visual effects (radial blur): we wanted to see whether the FMX draws the controls itself or delegates this work to the mobile OS.  <i>Below we will return to this issue, since the result was not obvious</i> . <br><br>  At the bottom is a table with two columns.  The table has distinct features of a desktop application, albeit with inertial scrolling.  We wanted to see what it would use on a mobile phone.  The table is filled at the start of the application, just so that the eye has something to cling to: <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//--------------------------------------------------------------------------- __fastcall TForm1::TForm1(TComponent* Owner) : TForm(Owner) { // Initialize the string grid with a bit of texts // Define the number of items gdDemo-&gt;RowCount = 1000; // Generate the texts for every Row and Column for(int r = 0; r &lt; gdDemo-&gt;RowCount; r++) { gdDemo-&gt;Cells[0][r] = "iResearchFX"; gdDemo-&gt;Cells[1][r] = IntToStr(r+1); } } //---------------------------------------------------------------------------</span></span></code> </pre><br><br><h3>  Compilation </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/9c2/8f1/9ce/9c28f19cea21a045415919bd159db863.png" align="right"><br>  The compilation is very slow - as usual C ++ Builder does it somehow strained.  However, for many years, the C ++ compiler has not made them nearly faster. <br><br>  It's time to see the same application in the version for mobile devices.  You do not need to change the code or user interface of your application.  It is enough to change some of the settings in the project, which, as it were, were created so that the ‚Äúeasy movement‚Äù could change the target platform. <br><br>  Platform switching is carried out effortlessly - in IDE, this aspect of the interface is made deliberately and uncompromisingly.  You must choose: Debug or Release compilation, target platform, simulator or device, and separately mark whether the build is for internal use or for publication.  In the latter case, you will be required to sign certificates.  <i>Certificates Android, if you do not have them yet, you will immediately be kindly offered to generate directly from the development environment;</i>  <i>Well, iOS profiles should be on the Mac where the final build step will be performed.</i> <br><br>  It is easy to see that the Android section lists all simulators configured in the Android SDK, as well as all connected devices. <br><br>  In the iOS section, the options exactly repeat the set of XCode - this is not surprising, given that the build and launch of the simulator will be performed on a remote Mac OS machine. <br><br clear="left"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/242/af2/304/242af2304238b07f91072e1b0f4af50c.png" align="left"><br></a> <br>  The left shows how the applications look on the main mobile platforms. <br><br>  As it is easy to notice - and it is gratifying - the appearance has hardly changed, or rather, on the contrary: the application has changed in an incomprehensible way, but now it looks exactly the same as if we made its interface from scratch for each of the platforms.  This is the temptation for which we wanted to test FMX.  Sounds like the excitement of first using Qt! <br><br>  It can be seen that this is still the same application, but all the controls have changed to ‚Äúnative‚Äù for each of the platforms.  This, in our opinion, could be called a truly cross-platform GUI application development. <br><br clear="left">  Mobile application is ready!  We invite you to look at his work live on the example of a screen video made on a physical Android device (HTC One).  <i>The videos are almost identical, we made two videos for statistics.</i> <br><table><tbody><tr><td><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/95117387&amp;xid=17259,15700021,15700043,15700186,15700191,15700253&amp;usg=ALkJrhiUE7332kg9v21a9a_A2jTvj1LnbA" width="177" height="315" frameborder="0" title="FireMonkey Android Demo 1" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe></td><td><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/95122165&amp;xid=17259,15700021,15700043,15700186,15700191,15700253&amp;usg=ALkJrhg_aSNC_soi0Qi-4ZIi0KsfdOW2RQ" width="177" height="315" frameborder="0" title="FireMonkey Android Demo 2" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe></td></tr></tbody></table><br>  Some aspects of the work of our application are noticeable on the video. <br><ol><li>  <b>Start time.</b>  It is believed that all applications on Android-e do not start very quickly if we are talking about a "cold" start.  It also clearly shows that we lose about 2 seconds at the start (black screen at the very beginning of the video).  Whether it is a lot or not is up to you, but, in our opinion, it strongly depends on the type of application. </li><li>  <b>Work speed</b>  There are no special complaints - the interface works quite well. </li><li>  <b>Controls.</b>  All elements are replaced by native ones and make quite the Androydov impression. </li><li>  <b>Grid.</b>  It looks interesting for a mobile platform and, quite, working - there is even inplace editing of cells. </li></ol><br><br><h3>  Post mortem </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/14f/52a/818/14f52a818f2a6d1f64d832019e8b4f0b.png" align="right"><br>  Let's see what is inside our freshly assembled Android application. <br><br>  APK archive has a very significant size of 6 MB.  Apparently, according to the old Delphi tradition, the entire runtime library was dragged into it. <br><br>  Inside the APK archive, we see the following folder structure (shown on the right).  The presence of dynamic libraries (so) is striking, as if hinting to us what exactly the native ARMv7 compiler and NDK were used for. <br><br>  Note that the lib folder contains subfolders with the name of the architecture, and each of them contains our application, which is named for some reason libProject1.so.  So, only in the folder armeabi-v7a it is real, and has a size of about 21 MB (in unpacked form).  The rest of the library files are ready-made flapper plugs that fire a message in the face of the user if his architecture is different from ARMv7.  In this, the manufacturer honestly admits and leaves us nothing else so far. <br><br>  The classes.dex file contains not our application at all, but the Java loader for the main FMX library application and the implementation of wrappers for Android native controls.  It is this fragment that allows the application to interact with the OS and ‚Äúpretend‚Äù to the usual Android application. <br><br><h3>  Degree of nativeness </h3><br>  As it becomes noticeable on the video, the FMX effects continue to work perfectly on Android‚Äôs ‚Äúnative‚Äù controls, interfering in their rendering (for example, we even turned on the lighting of the contours of the controls, which means that the FMX works with Android controls not just as with pictures, but very tightly). <br><br>  Sebastian Gingter (SEBASTIAN PR GINGTER) in his well-known <a href="http://dotnetninja.de/2013/04/why-firemonkey-is-so-fundamentally-wrong-in-every-aspect-of-its-being/">article</a> on FMX speaks about the framework very unflatteringly, criticizing the fact that the user interface is drawn independently and does not look native to any of the platforms.  Apparently, at some point, this was exactly the case, but now such criticism cannot be considered fair.  The author denies the very idea of ‚Äã‚Äãcross-platform GUI applications, without looking at specific implementations, denying the potential advantages of such an approach. <br><br><h3>  Conclusion </h3><br>  The considered tool, of course, is the successor of all VCL traditions: glorious and inglorious.  We were convinced that the assembly technology of truly cross-platform mobile applications works and shows very good performance.  For a certain class of applications, FMX will be a good help. <br><br>  Negative aspects include a noticeable time delay at the start and not a small size of the resulting application. <br><br><h3>  Used materials: </h3><br><ol><li>  <a href="http://docwiki.embarcadero.com/RADStudio/XE6/en/Category:FMX">Embarcadero Documentation</a> </li><li>  <a href="http://docwiki.embarcadero.com/RADStudio/XE6/en/Android_Mobile_Application_Development">FM Development Process Description</a> </li><li>  <a href="http://docwiki.embarcadero.com/RADStudio/XE6/en/What%27s_New_in_Delphi_and_C%2B%2BBuilder_XE6">ARM plugs in XE6</a> </li><li>  <a href="http://dotnetninja.de/2013/04/why-firemonkey-is-so-fundamentally-wrong-in-every-aspect-of-its-being/">Criticism of non native interface</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/222307/">https://habr.com/ru/post/222307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../222295/index.html">Secrets of buttons in Android. Part 3: Buttons in the main menu</a></li>
<li><a href="../222297/index.html">Organizational report on the conference ‚ÄúJust Sell IT! Effective IT Sales ¬ª</a></li>
<li><a href="../222299/index.html">The most popular trends of SEO-2014 according to Forbes</a></li>
<li><a href="../222303/index.html">Psychology of robots and smart computers: how it works and where to learn it. Lecture of Maxim Musin in Yandex</a></li>
<li><a href="../222305/index.html">PHPCI: Continuous Integration System for PHP Projects</a></li>
<li><a href="../222309/index.html">Dr. Dre has actually confirmed the sale of Apple's Beats</a></li>
<li><a href="../222311/index.html">10 ways to backup in PostgreSQL</a></li>
<li><a href="../222313/index.html">Marketing for Startups: A Quantum Model</a></li>
<li><a href="../222315/index.html">Birdly project: Feel like a bird with Oculus Rift</a></li>
<li><a href="../222317/index.html">Reduce function</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>