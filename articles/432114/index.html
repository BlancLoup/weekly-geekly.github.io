<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using SVG paths in canvas to move objects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If to animate an object on canvas (and not only), you need to move it along some desired path, perhaps even along several paths that can be chosen ran...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using SVG paths in canvas to move objects</h1><div class="post__text post__text-html js-mediator-article">  If to animate an object on canvas (and not only), you need to move it along some desired path, perhaps even along several paths that can be chosen randomly or sequentially, then this can be done using svg paths.  Let's start by starting a simple but green square along the path. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2m/0n/5a/2m0n5adwdozshuqnbv-svgzhtbs.gif" alt="image"></div><br><br>  To do this, make or borrow svg, with one or more paths. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Create an element using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/createElementNS">document.createElementNS</a> function.  MDN informs us that the method has basic support in all modern browsers.  Then add the path to the created element. <br><a name="habracut"></a><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElementNS(<span class="hljs-string"><span class="hljs-string">"http://www.w3.org/2000/svg"</span></span>, <span class="hljs-string"><span class="hljs-string">"path"</span></span>); path.setAttribute(<span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'M148.185,118.975c0,0-92.592,39.507-80.247,79.013,s79.012,143.21,129.629,124.691s64.198-113.856,120.988-100.755s118.518,30.384,116.049,109.397s-82.715,118.519-97.53,201.235,s-92.593,139.505,0,159.259'</span></span>);</code> </pre> <br>  Here, in the attributes, the first path came to my eyes from some svg file, copy-paste.  Of course, this is not the only and moreover, not the most convenient way, but it is quite visual for use in the first example. <br><br>  Now in the loop, we will receive the coordinates of the waypoints and assign them to our object.  For this we need two <a href="https://developer.mozilla.org/en-US/docs/Web/API/SVGGeometryElement">SVGGeometryElement</a> methods: <br><br><pre> <code class="javascript hljs">path.getTotalLength()</code> </pre> <br>  returns the calculated value of the total path length and <br><br><pre> <code class="javascript hljs"> path.getPointAtLength(index)</code> </pre> <br>  Gets the float argument number, and returns an SVGPoint object that has, we are interested in, x and y coordinates.  For argument values ‚Äã‚Äãless than zero or greater than the length of the path, the first or last points will be returned as a result, respectively. <br><br>  When updating the frame, we get a point and use its coordinates for movement. <br><br>  ‚Üí Full code example on <a href="https://codepen.io/citizen55/pen/MzYWGQ%3Feditors%3D0110">codepen</a> <br><br>  But, you can use a more interesting option to move the object along the coordinates of several paths, for example: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ol/-w/ow/ol-wow0ctr6kp4kma26r5l1xy58.gif" alt="image"></div><br><br>  Again, take a svg file with several paths.  The one that was used in the example is made in the Inscape editor.  Now we need to get these paths, it is possible through parsing the object or, if svg was received as a text file, then the following function, using regular expressions, can be obtained as strings. <br><br><pre> <code class="javascript hljs">extractPathsfromSvg: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">svg</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> results = svg.match(<span class="hljs-regexp"><span class="hljs-regexp">/&lt;path\b([\s\S]*?)&gt;&lt;\/path&gt;/g</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> paths = []; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> len = results.length; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; len; i++){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> str = results[i]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data = str.match(<span class="hljs-regexp"><span class="hljs-regexp">/[^\w]d="([\s\S]*?)"/</span></span>); paths.push(data[<span class="hljs-number"><span class="hljs-number">1</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> paths; }</code> </pre><br>  After creating an array of paths, it remains to extract them in turn and process them in the same way as the only path for the movement of the square.  getting interesting effects. <br>  See the full example code below. <br><br>  To add more control when the object moves along the coordinates of the path, you can use tweens.  For the test cases, I took the first GreenSock library that came across, but it could be any other. <br><br>  In the first case, when the square moves along a single path, we create an intermediate helper object, and pass it on when creating the twin. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> helper = {<span class="hljs-attr"><span class="hljs-attr">progress</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>} helper.update = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">)</span></span>{ point = path.getPointAtLength(totalLength * helper.progress); x = point.x; y = point.y; ctx.clearRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, canvas.width, canvas.height); ctx.drawImage(img, x, y ); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tw = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TweenLite.to(helper, <span class="hljs-number"><span class="hljs-number">5</span></span>, {<span class="hljs-attr"><span class="hljs-attr">progress</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, }); tw.eventCallback(<span class="hljs-string"><span class="hljs-string">"onUpdate"</span></span>, helper.update);</code> </pre> <br>  You can see the movement of the square on the way using tween, in the first example on the codepen, you can put a tick use tween. <br><br>  When driving in several ways, we proceed as follows.  As before, we will create a helper object with the progress property.  We calculate the total length of all paths, and assign it to handler.progress.  Create a traversed variable in which the paths already traversed will be summed up. <br><br>  To get a point on the current path, subtract from helper.progress, which is changing in tween, the path already traveled is traversed.  Use the coordinates of the point as usual. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> traversed = <span class="hljs-number"><span class="hljs-number">0</span></span>; helper.progress = totalLenghtAllPath; helper.update = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> localPoint = helper.progress - traversed; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(localPoint &gt; curPath.getTotalLength()){ traversed += curPath.getTotalLength(); curPath = paths[next()]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(curPath){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } localPoint = helper.progress - traversed; } <span class="hljs-comment"><span class="hljs-comment">/*       */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tw = TweenLite.to( helper, <span class="hljs-number"><span class="hljs-number">25</span></span>, {<span class="hljs-attr"><span class="hljs-attr">progress</span></span>: totalLenghtAllPath, <span class="hljs-attr"><span class="hljs-attr">ease</span></span>: Power2.easeOut } ); tw.eventCallback(<span class="hljs-string"><span class="hljs-string">"onUpdate"</span></span>, helper.update);</code> </pre> <br>  The code is simplified, the full code is here: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/citizen55/embed/preview/jQxezO" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/432114/">https://habr.com/ru/post/432114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432104/index.html">IT digest of December events (part one)</a></li>
<li><a href="../432106/index.html">Product Design Digest November 2018</a></li>
<li><a href="../432108/index.html">Registration is open for intensive on Kubernetes on February 1-3 in St. Petersburg</a></li>
<li><a href="../432110/index.html">Web technologies for designers - I return the debt</a></li>
<li><a href="../432112/index.html">Intel XMM 8160 - Universal Multi-Mode 5G Modem</a></li>
<li><a href="../432116/index.html">JS synchronous trend: survey</a></li>
<li><a href="../432118/index.html">A project manager with TK in his hands is not yet a sign of project management.</a></li>
<li><a href="../432120/index.html">Lenovo will pay laptop owners compensation of $ 8.3 million for installing Superfish malware</a></li>
<li><a href="../432122/index.html">Xcode and advanced debugging in LLDB: Part 2</a></li>
<li><a href="../432128/index.html">Crutches, Narnia, Ninja procrusts: three pains of a timlid in a startup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>