<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Frills Opera</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Immediately, I note that this post is not an attempt to add fuel to the fire of browser holivar This is a little story about my opening in Opera brows...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Frills Opera</h1><div class="post__text post__text-html js-mediator-article">  Immediately, I note that this post is not an attempt to add fuel to the fire of browser holivar  This is a little story about my opening in Opera browser. <br>  Many have probably heard that Opera ‚Äúfixes‚Äù the work of some sites (and js libraries), so that in turn they work normally in this browser.  I somehow ran across a page listing which sites and which problems were fixed on them.  But then I did not think about how they "rule" this. <br><a name="habracut"></a><br>  And today one of the users sent us a "bug report" that our service (ajax application) does not work in Opera 9.24, and sent an error message from the "Error console".  The strangeness in this is that until recently everything worked in this and other (younger) versions of Opera, and we have not had new releases for more than a month and a half.  He opened the Opera, went to url - it does not work for me either.  And flies at the very beginning.  Swears on a strange line, looking for in their scripts.  No such.  Then I remembered the ‚Äúpatches‚Äù of the Opera for websites - maybe there?  After a brief search, I found a file with hacks - which is essentially a regular JS file (called browser.js), loads the very first one and does some work.  There it turned out to be an ill-fated line.  I looked around a bit: what is it, what is it.  It turns out this file is updated by itself, and its last update was December 13th (for this version) and it is written in it, and it swayed to me on December 20th, when I ran the opera last time. <br>  For the most part, all the crutches in this file are addressable, that is, they are designed for specific sites (yes! Location.hostname is checked).  But part of the general.  In particular, in my case, the problem was caused by the following code: <br><blockquote><pre>     Array.prototype.concat = function () {// working around incompatibility with prototype, bug 241832
         var array = [];
         for (var i = 0, length = this.length; i &lt;length; i ++) array.push (this [i]);
         for (var i = 0, length = arguments.length; i &lt;length; i ++) {
           if (arguments [i] .constructor == Array) {
         for (var j = 0, arrayLength = arguments [i] .length; j &lt;arrayLength; j ++)
           array.push (arguments [i] [j]);
           } else {
         array.push (arguments [i]);
           }
         }
         return array;
     }
</pre></blockquote><br>  Alarmed.  Somewhere I have already seen.  I look at the commentary (because it‚Äôs not clear what this is for, they stuck here) - exactly: ‚Äúworking around incompatibility with prototype‚Äù.  In prototype, I just saw it.  I looked at prototype, the car turned out to be version 1.5 in which there is: <br><blockquote><pre> if (window.opera) {
   // same code
 }
</pre></blockquote><br>  What kind of nonsense?  At one time, I broke my head by interpreting these lines in prototype.  I do not know what the implementation of the concat in Opera did not suit them, but then I did not find any differences from other implementations in other browsers.  However, in Opera it was decided to do as in prototype, creating a stalemate for applications when arguments [i] is null or undefined (a test would not hurt to do it).  And no matter what you write and what libraries you use, the concat opera works as in prototype. <br>  I am wondering how to fix it (before that there were only small problems with the Array.splice method, but what / how is that ?!). <br>  In general, I recommend everyone to study this browser.js, especially for those who are interested in studying the work of Opera from the inside.  In addition, comments are very interesting, for example: <br><blockquote><pre> // 194334, Y! Mail remove selectSingleNode and selectNodes
 / * because Yahoo Mail is better at emulating proprietary IE functions than we are .. * /
 Node.prototype.selectSingleNode = undefined;
 Node.prototype.selectNodes = undefined;
</pre></blockquote><br>  By the way, all these dances with a tambourine in Opera are called "magic fixes".  Really "magic"! <br><br>  <strong>Threat</strong> While I wrote in some miraculous way, the bug was fixed, but only with me.  File browser.js is the same, but does not give errors.  For the rest, nothing works and writes an error to the console. <br>  <b>UPDATE</b> It turned out why I had a bug fixed.  The fact is that at the beginning of the browser.js file contains the signature of the content.  Accordingly, if you change the contents of the file (I just put the line break in one place), then the signature will already be different and Opera will stop using this file, as it considers broken and waits for the next update.  The browser checks weekly updates for this file, downloads and uses them, unless of course it is disabled in the config file (for example, opera6.ini).  The setting is called Browser Javascript.  Thanks <a href="http://habrahabr.ru/users/rsa2048/" class="user_link">rsa2048</a> for the tip. <br></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/18017/">https://habr.com/ru/post/18017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180161/index.html">About imaginary and real optimizations 10 times, healing SSE, and all that</a></li>
<li><a href="../180163/index.html">Skype - Yes, we read everything you write</a></li>
<li><a href="../180165/index.html">Smart cities are already here</a></li>
<li><a href="../180167/index.html">Universal and cheap mechanical arm from iRobot</a></li>
<li><a href="../180169/index.html">To the question about repost</a></li>
<li><a href="../180173/index.html">Automate the download of only new series of torrent distributions (.bat + curl + aria2c) [HowTo]</a></li>
<li><a href="../180177/index.html">Frequency of mailings sent: often not always better!</a></li>
<li><a href="../180179/index.html">Smartphone with Full HD screen for $ 200? Easy!</a></li>
<li><a href="../18018/index.html">Gifts for the New Year for users and children</a></li>
<li><a href="../180181/index.html">Helping GNU / Linux is easy!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>