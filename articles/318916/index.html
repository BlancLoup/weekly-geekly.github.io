<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing websites in assembler is useful and pleasant.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Of course, many will say that this is not-and-not and writing for the web is needed only in PHP, well, or in one of the modern languages, Python, Ruby...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing websites in assembler is useful and pleasant.</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/c8d/560/5d6/c8d5605d6ba94edbab77e37b3ced1064.png" align="left">  Of course, many will say that this is not-and-not and writing for the web is needed only in PHP, well, or in one of the modern languages, Python, Ruby, Node.js, etc. </p><br><p>  But the fact is that writing sites on an assembler is very useful, and with suitable tools it is easy and pleasant. </p><br><p>  In fact, this statement was only a hypothesis.  To prove or reject it, this spring I started writing a forum in assembler. </p><br><p>  Previously, I already had a web application in assembly language - CMS for a small site.  Only it works in the "one writes, many read" mode.  At the same time, it uses the CGI interface and therefore "many" cannot be read at the same time either. </p><a name="habracut"></a><br><h1 id="tehzadanie">  Terms of Reference </h1><br><p>  And so I decided to write a web application to: </p><br><ol><li>  Respect the principle of "read a lot - write a lot." </li><li>  It worked very quickly and did not load the server. </li><li>  Used very little memory, again not to load the server. </li><li>  Worked on a cheap virtual hosting. </li></ol><br><p>  All these conditions are met by the web forum.  Therefore, the choice stopped on him.  The task looks like this: </p><br><p>  Write a web forum that: </p><br><ol><li>  Uses the FastCGI interface to serve requests faster than CGI and so that there is no limit on the number of simultaneously running processes on the server (my hosting plan has such a limitation in <del>  60 </del>  30 processes). </li><li>  Uses a transactional database to store information in one place and so that several visitors can write at the same time. </li><li>  The functionality must be sufficient to use the product in real life to communicate with users. </li><li>  The forum view could be completely changed from the configuration.  Skins are our everything.  And not everyone can edit the code in assembler. </li></ol><br><p>  In addition to FastCGI, it was possible to use SCGI, which even looks a little simpler for implementation.  It just turned out that my hosting company only supports FastCGI. </p><br><p>  But I did not have to regret about it.  It turned out that despite the complexity of the specification, FastCGI is very well suited for implementation on an assembler.  So the code is simple and straightforward. </p><br><p>  SQLite has been selected for the database.  First of all, I know it very well and often use it in conjunction with an assembler.  Secondly, using virtual hosting, I wanted the whole application to be located in the directories of the site, including the database.  Thirdly, SQLite has the option "Full text search - FTS", which works quickly and will have to be very useful for searching the forum. </p><br><p>  But there was a problem.  I decided to write a forum on a 32-bit assembler for x86, so that you can work on both 32 and 64-bit servers.  But the fact is that 64 bit servers, as a rule, do not provide 32 bit libraries.  For the assembler, this is not important, but I also need 32 bit SQLite, but it needs the standard C library. But glibc (GNU C library) cannot be statically linked. </p><br><p>  But the solution was found - to use the alternative library C - <a href="https://www.musl-libc.org/">MUSL</a> which has a dynamic linker, which can be placed in the application directory.  An additional plus is the fact that the library is very small. </p><br><p>  The implementation of the FastCGI interface was written so that it could be used in other projects. </p><br><p>  For markup of forum posts, it was decided to use markdown like markup, which I had already written for CMS. </p><br><h1 id="i-tak-chto-v-itoge-poluchilos">  And so, what was the result? </h1><br><p>  I wrote in my free time.  Sometimes at work, sometimes at home.  The code, of course <a href="http://asm32.info/fossil/repo/asmbb">open</a> .  Distribution license: <a href="http://asm32.info/fossil/repo/asmbb/artifact/88666a269af0c927">EUPL</a> .  The first version, saved <a href="http://asm32.info/fossil/repo/asmbb/info/16aa42d5565a429f">on March 6, 2016</a> .  Official version 1.0, saved <a href="http://asm32.info/fossil/repo/asmbb/info/9393359c56ec1d18">on the 7th of April 2016</a> . </p><br><p>  All of this took exactly 53 commits. </p><br><p>  Since I know assembler, the most difficult thing during the work was ignorance of web protocols.  I had to read the RFC documents about SMTP and FastCGI. </p><br><p>  My web designer skills are not outstanding either, so it turned out the way it did.  But since the entire design is in the configuration files, then replacing it is simple - there is no need to change the engine code. </p><br><p>  Also, in the beginning I was completely unaware of the XSS attack and other aspects of web security.  In the end, everything more or less expounded.  Especially during the tests, which were conducted by some comrades from the Bulgarian forum.  As a result, protection against bots appeared, as well as a topic in which there were 15,000 posts. </p><br><p>  The application turned out very small.  All files in the distribution of 1.8MB, from which 992KB SQLite and 622KB MUSL library.  The application itself in assembler consists of a single file "engine", the size of 68.5KB (v1.2).  Everything else - templates and images. </p><br><p>  Installation is very simple - the archive is unpacked into the site directory and the '.httaccess' file is configured.  Well or 'lighttpd.conf'.  The site opens in a browser and an administrator user is created. </p><br><p>  At runtime, the application uses approximately 2MB of RAM on the server, on the running process.  Depending on the load, the apache server can run multiple instances of the process. </p><br><p>  Unfortunately I can‚Äôt give you any comparisons with other forums, because data about the memory consumption of popular forums is not published (well, or I didn‚Äôt find it), but typical memory consumption, for example cpanel, is about 20MB for PHP process - about 10 times more. </p><br><p>  <a href="http://board.asm32.info/">The demo installation of the forum</a> is available for visits and tests. </p><br><p>  Hosting plan, which is a demo (the cheapest that I was able to take), virtual (shared).  The limitations are as follows (according to the specification): </p><br><ol><li>  Single core CPU </li><li>  1GB RAM </li><li>  30 minutes of CPU time per day. </li><li>  The maximum number of running processes is 60. </li></ol><br><h1 id="slashdot-effekt-test">  Slashdot effect test. </h1><br><p>  In August, quite by chance I managed to test the system on a real-time load.  Someone (who did not understand who) posted a link to the code storage on Twitter.  Several dozen reposted the link at once, and then published it in reddit and probably in other social networks. </p><br><p>  Much to my regret, the link was to the code repository.  And it works on CGI (fossil) and does not hold the load at all. </p><br><p>  During the day, the forum was visited by several thousand visitors - about 8,000 to the code repository, which happily fell and got up (due to exceeding the limit of processes). </p><br><p>  But a certain number of visitors (about 3000) still got to the forum and made more than 30,000 applications. </p><br><p>  The forum did not feel the load at all and worked all the time without slowing down or losing applications.  About 7 minutes of CPU time is used on this day. </p><br><h1 id="verdikt-gipotezy">  Verdict hypothesis </h1><br><p>  I believe that all this hypothesis formulated at the beginning of my story, has been proven. </p><br><p>  Web programming in assembler may not be very difficult, but the results are very good.  As a result, such work greatly enhances the general culture of the developer and allows him to gain a deep understanding of the Internet protocols and how everything really works. </p><br><p>  Using a web program in assembler can save on hosting and allow you to use cheap virtual hosting where others use dedicated servers and other expensive solutions. </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>  Well that's all.  If someone liked, use on health.  Any kind of vulnerability and performance tests are very welcome.  New code and bug fixes are accepted.  New good skins are also very necessary. </p><br><p>  And at the end of some links: </p><br><p>  ¬ª <a href="http://asm32.info/fossil/repo/asmbb">Project code storage</a> <br>  ¬ª <a href="http://board.asm32.info/">Demo installation</a> <br>  ¬ª <a href="http://board.asm32.info/asmbb_how_to_download_compile_and_install_49/">How to download and install</a> <br>  ¬ª <a href="http://board.asm32.info/email-handling-and-registration-without-valid-email-58/">How to register without mail</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/318916/">https://habr.com/ru/post/318916/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318904/index.html">How I uploaded base in GIT</a></li>
<li><a href="../318906/index.html">How IT professionals work. Anton Karpov, Head of Security at Yandex</a></li>
<li><a href="../318908/index.html">Stretching the OP on the PLO</a></li>
<li><a href="../318910/index.html">Information technology in the New Year musical "The Magicians"</a></li>
<li><a href="../318914/index.html">How to grow old in IT</a></li>
<li><a href="../318918/index.html">Expansion of API from Vk for stickers on Elixir</a></li>
<li><a href="../318922/index.html">We train a neural network written in TensorFlow in the cloud using Google Cloud ML and Cloud Shell</a></li>
<li><a href="../318924/index.html">Problem Statement: Accounting Objects and Modeling Relationships Between Them</a></li>
<li><a href="../318926/index.html">GitLab 8.15 released</a></li>
<li><a href="../318928/index.html">Promotion of new agency on upwork from scratch - personal experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>