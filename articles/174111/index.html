<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setting up IPTV Beeline via WiFi using Mikrotik routers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Being a subscriber of Home Internet + TV from Beeline, you will, willy-nilly, read profile forums, you see problems of subscribers, etc. And among the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setting up IPTV Beeline via WiFi using Mikrotik routers</h1><div class="post__text post__text-html js-mediator-article">  Being a subscriber of Home Internet + TV from Beeline, you will, willy-nilly, read profile forums, you see problems of subscribers, etc. And among these ‚Äúweeping Yaroslavna‚Äù one problem definitely emerges that either no one managed to accomplish or through crutches with cropped functionality.  Namely - the transfer of IPTV to the console via Wi-Fi.  And recently, they turned to me for help with just such a question.  Since our man first does and then thinks, the repair in the new apartment has already been done, there is no cable channels, there are no RJ-45 outlets, no one will spoil the beauty and aesthetics, but you want to watch Beeline TV in the kitchen. <br><a name="habracut"></a><br>  What to do? <br>  The following tasks emerge: <br>  1) Release all client devices (laptops, computers, tablets, etc.) to the Internet via Wi-Fi <br>  2) Put a set-top box leased from Beeline IPTV on the kitchen TV and make it work, while retaining all the functionality. <br>  Well, if the first point does not cause difficulties, then the second makes you wonder. <br>  Since I am an adherent and a long-time user of Mikrotik products, it was decided to solve the problem that arose on the equipment of this vendor.  In addition, the existing certificate MTCNA gave strength and convinced that "the devil is not so bad as he is painted." <br>  So, I recall the principle of connecting Beeline subscribers to the Internet. <br>  The client equipment receives from the DHCP server a ‚Äúgray‚Äù address from the subnet 10.0.0.0/8, which gives access to local resources, L2TP-BRASs, and, in fact, the IP IP multicast is also haunting.  To get access directly to the Internet itself, you need to log in via the L2TP connection at tp.internet.beeline.ru.  This scheme in the terminology of some manufacturers of home routers is called Russian Dual Access. <br>  The choice fell on routers RB / 751G-2HnD. <br><img src="https://habrastorage.org/storage2/aa6/bc0/ef1/aa6bc0ef10ea74714681cd1374e0c88b.jpg"><br>  Their characteristics: <br><br>  - RAM: 64MB DDR SDRAM <br>  - Processor: Atheros AR7241 400MHz CPU <br>  - Hard Drive: 64MB onboard NAND storage chip <br>  - Frequency: 2.4 GHz <br>  - Ethernet: 5 independent 10/100/1000 ports <br>  - USB: 1 port 2.0 <br>  - Power: via ethernet port 1 8-30V DC, through jack 8-30V DC (PSU included) <br>  - Sensitivity: 802.11g: -96dBm @ 6Mbit / s to -81dBm @ 54Mbit / s, 802.11n: ‚Äì96 dBm @ MCS0 to ‚Äì78 dBm @ MCS7 <br>  - Power amplification: 802.11g: 30dBm @ 6Mbps to 27dBm @ 54 Mbps, 802.11n: 30dBm @ MCS0 to 26dBm @ MCS7 <br>  - power of the built-in radio module: 1W <br>  - built-in antenna gain: 2.5dBi <br>  - Power consumption: up to 7W <br>  - OS: RouterOS, Level 4 <br><br>  I will not describe in detail where to find the winbox, what it is and how to use it.  This information is very much in the vast network.  Therefore, I will describe thesis, but with explanations. <br>  At the time of this writing, software version 5.24.  Downloading it here <a href="">download2.mikrotik.com/routeros/5.24/routeros-mipsbe-5.24.npk is</a> thrown into the Files and reloading the router.  On the second we do the same. <br>  So, we define for ourselves that R1 is the router where the cable from our provider comes, and R2 is a Wi-Fi receiver for an IPTV set-top box.  The default device configuration offers us a DHCP client on the eth-1 port, and the eth2-eth5 ports are combined into a switch, plus a bridge to eth2 for wi-fi (wlan2) with a dhcp server in the 192.168.88.0/24 range. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, setting up the router R1 <br><br>  We connect the biline cable to eth1 to the R1 router and the computer to eth2 and run winbox.  We connect to 192.168.88.1 with the admin username and an empty password.  In the RouterOS Default Configuration window, click OK. <br><img src="https://habrastorage.org/storage2/b4c/60a/e9c/b4c60ae9c8de055bb3a1d71499f1a778.png"><br><br>  Since RouterOS does not know how to use dns-names in the Connect-to fields, first, by inserting the Beeline cable into the computer, we define the address tp.internet.beeline.ru.  In my case, it turned out to be 10.255.255.239 <br><pre><code class="hljs pgsql">/interface l2tp-client <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-route=yes allow=pap,chap,mschap1,mschap2 <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>=\ <span class="hljs-number"><span class="hljs-number">10.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.239</span></span> dial-<span class="hljs-keyword"><span class="hljs-keyword">on</span></span>-demand=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> max-mru=<span class="hljs-number"><span class="hljs-number">1460</span></span> max-mtu=<span class="hljs-number"><span class="hljs-number">1460</span></span> \ mrru=disabled <span class="hljs-type"><span class="hljs-type">name</span></span>=l2tp-out1 <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> profile=\ <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-encryption <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">login</span></span></code> </pre> <br>  <i>(You can find scripts in the network that will determine the current address of the brasys tp.internet.beeline.ru and substitute them in the Connect-to field. As the provider uses round-robin dns to determine the less loaded bras)</i> <br><br>  Next, configure two NAT rules.  One for the local network, the other for the Internet. <br>  Go to IP-Firewall-NAT, delete the default configuration configuration, and create our own. <br><pre> <code class="hljs cs">/ip firewall nat <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> action=masquerade chain=srcnat disabled=no dst-address=<span class="hljs-number"><span class="hljs-number">10.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">8</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=ether1-gateway <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> action=masquerade chain=srcnat disabled=no dst-address=!<span class="hljs-number"><span class="hljs-number">10.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">8</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=l2tp-out1</code> </pre><br>  We check both rules: <br><img src="https://habrastorage.org/storage2/bfe/3ac/012/bfe3ac012d1e9e1cb2f463ebe8028251.png"><br><br>  The next step is to remove the wlan1 membership in the bridge with ether2 and enable it in the bridge to ether1.  To do this, open the Bridge, create a new bridge with the name, for example, tv-wifi-bridge, and on the Ports tab, add the wlan1 and ether1-gateway interfaces to it. <br><img src="https://habrastorage.org/storage2/951/e3b/630/951e3b630471f5657161d137ea6231d4.png"><br><br><pre> <code class="hljs pgsql">/interface bridge <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>-mac=D4:CA:<span class="hljs-number"><span class="hljs-number">6</span></span>D:<span class="hljs-number"><span class="hljs-number">20</span></span>:E2:<span class="hljs-number"><span class="hljs-number">49</span></span> ageing-<span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span>m arp=enabled auto-mac=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> \ disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> forward-delay=<span class="hljs-number"><span class="hljs-number">15</span></span>s l2mtu=<span class="hljs-number"><span class="hljs-number">1598</span></span> max-message-age=<span class="hljs-number"><span class="hljs-number">20</span></span>s mtu=<span class="hljs-number"><span class="hljs-number">1500</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>=\ bridge-<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> priority=<span class="hljs-number"><span class="hljs-number">0x8000</span></span> protocol-mode=rstp transmit-hold-count=<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>-mac=<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ageing-<span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span>m arp=enabled auto-mac=yes \ disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> forward-delay=<span class="hljs-number"><span class="hljs-number">15</span></span>s l2mtu=<span class="hljs-number"><span class="hljs-number">1598</span></span> max-message-age=<span class="hljs-number"><span class="hljs-number">20</span></span>s mtu=<span class="hljs-number"><span class="hljs-number">1500</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>=\ tv-wifi-bridge priority=<span class="hljs-number"><span class="hljs-number">0x8000</span></span> protocol-mode=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> transmit-hold-count=<span class="hljs-number"><span class="hljs-number">6</span></span> /interface bridge port <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> bridge=bridge-<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> edge=auto <span class="hljs-keyword"><span class="hljs-keyword">external</span></span>-fdb=auto horizon=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> \ interface=ether2-master-<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-type"><span class="hljs-type">path</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-type"><span class="hljs-type">point</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>-<span class="hljs-type"><span class="hljs-type">point</span></span>=auto priority=\ <span class="hljs-number"><span class="hljs-number">0x80</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> bridge=tv-wifi-bridge disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> edge=auto <span class="hljs-keyword"><span class="hljs-keyword">external</span></span>-fdb=auto horizon=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> \ interface=wlan1 <span class="hljs-type"><span class="hljs-type">path</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-type"><span class="hljs-type">point</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>-<span class="hljs-type"><span class="hljs-type">point</span></span>=auto priority=<span class="hljs-number"><span class="hljs-number">0x80</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> bridge=tv-wifi-bridge disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> edge=auto <span class="hljs-keyword"><span class="hljs-keyword">external</span></span>-fdb=auto horizon=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> \ interface=ether1-gateway <span class="hljs-type"><span class="hljs-type">path</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-type"><span class="hljs-type">point</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>-<span class="hljs-type"><span class="hljs-type">point</span></span>=auto priority=<span class="hljs-number"><span class="hljs-number">0x80</span></span></code> </pre><br><br>  Since  Iptv prefix also receives its address from the dhcp provider, then we need to change the dhcp-client interface.  If you remember, it is assigned only to ether1.  Reassign it to the Bridge tv-wifi-bridge. <br><img src="https://habrastorage.org/storage2/da7/8d1/83c/da78d183cd5a6ad30e31bd734aea5906.png"><br><pre> <code class="hljs cs">/ip dhcp-client <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-route=yes comment=<span class="hljs-string"><span class="hljs-string">"default configuration"</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-route-distance=<span class="hljs-number"><span class="hljs-number">1</span></span> disabled=no <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>=tv-wifi- use-peer-dns=yes use-peer-ntp=yes</code> </pre><br><br>  Now it's time to set up the wireless part of our project.  First of all, we will prepare an access point for iptv console.  There is nothing unusual, typical setting, except for the most important point.  This is Multicast Helper.  It must be in the full position. <br><img src="https://habrastorage.org/storage2/a67/405/32c/a6740532c2129bb02f5eab7415f45566.png"><br><pre> <code class="hljs sql">/interface wireless <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> adaptive-noise-immunity=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-keyword"><span class="hljs-keyword">allow</span></span>-sharedkey=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> antenna-gain=<span class="hljs-number"><span class="hljs-number">0</span></span> antenna-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=\ ant-a area=<span class="hljs-string"><span class="hljs-string">""</span></span> arp=enabled band=<span class="hljs-number"><span class="hljs-number">2</span></span>ghz-b/g/n basic-rates-a/g=<span class="hljs-number"><span class="hljs-number">6</span></span>Mbps basic-rates-b=\ <span class="hljs-number"><span class="hljs-number">1</span></span>Mbps bridge-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=enabled channel-width=<span class="hljs-number"><span class="hljs-number">20</span></span>/<span class="hljs-number"><span class="hljs-number">40</span></span>mhz-ht-above compression=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> \ country=no_country_set <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-ap-tx-<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">authentication</span></span>=yes \ <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">client</span></span>-tx-<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-forwarding=yes dfs-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-running-<span class="hljs-keyword"><span class="hljs-keyword">check</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> <span class="hljs-keyword"><span class="hljs-keyword">disconnect</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">timeout</span></span>=<span class="hljs-number"><span class="hljs-number">3</span></span>s distance=indoors \ frame-lifetime=<span class="hljs-number"><span class="hljs-number">0</span></span> frequency=<span class="hljs-number"><span class="hljs-number">2412</span></span> frequency-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">manual</span></span>-txpower frequency-<span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> \ hide-ssid=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> ht-ampdu-priorities=<span class="hljs-number"><span class="hljs-number">0</span></span> ht-amsdu-<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">8192</span></span> ht-amsdu-threshold=<span class="hljs-number"><span class="hljs-number">8192</span></span> \ ht-basic-mcs=mcs<span class="hljs-number"><span class="hljs-number">-0</span></span>,mcs<span class="hljs-number"><span class="hljs-number">-1</span></span>,mcs<span class="hljs-number"><span class="hljs-number">-2</span></span>,mcs<span class="hljs-number"><span class="hljs-number">-3</span></span>,mcs<span class="hljs-number"><span class="hljs-number">-4</span></span>,mcs<span class="hljs-number"><span class="hljs-number">-5</span></span>,mcs<span class="hljs-number"><span class="hljs-number">-6</span></span>,mcs<span class="hljs-number"><span class="hljs-number">-7</span></span> ht-<span class="hljs-keyword"><span class="hljs-keyword">guard</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">interval</span></span>=\ <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> ht-rxchains=<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> ht-supported-mcs=<span class="hljs-string"><span class="hljs-string">"mcs-0,mcs-1,mcs-2,mcs-3,mcs-4,mcs-5,mcs-6,m\ cs-7,mcs-8,mcs-9,mcs-10,mcs-11,mcs-12,mcs-13,mcs-14,mcs-15,mcs-16,mcs-17,mcs-18,m\ cs-19,mcs-20,mcs-21,mcs-22,mcs-23"</span></span> ht-txchains=<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> hw-fragmentation-threshold=\ disabled hw-<span class="hljs-keyword"><span class="hljs-keyword">protection</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> hw-<span class="hljs-keyword"><span class="hljs-keyword">protection</span></span>-threshold=<span class="hljs-number"><span class="hljs-number">0</span></span> hw-retries=<span class="hljs-number"><span class="hljs-number">7</span></span> l2mtu=\ <span class="hljs-number"><span class="hljs-number">2290</span></span> mac-address=D4:CA:<span class="hljs-number"><span class="hljs-number">6</span></span>D:<span class="hljs-number"><span class="hljs-number">20</span></span>:E2:<span class="hljs-number"><span class="hljs-number">4</span></span>D <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>-station-<span class="hljs-keyword"><span class="hljs-keyword">count</span></span>=<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=ap-bridge mtu=\ <span class="hljs-number"><span class="hljs-number">1500</span></span> multicast-helper=<span class="hljs-keyword"><span class="hljs-keyword">full</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=wlan1 noise-<span class="hljs-keyword"><span class="hljs-keyword">floor</span></span>-threshold=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> \ nv2-cell-radius=<span class="hljs-number"><span class="hljs-number">30</span></span> nv2-noise-<span class="hljs-keyword"><span class="hljs-keyword">floor</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">offset</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> nv2-preshared-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> nv2-qos=\ <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> nv2-queue-<span class="hljs-keyword"><span class="hljs-keyword">count</span></span>=<span class="hljs-number"><span class="hljs-number">2</span></span> nv2-<span class="hljs-keyword"><span class="hljs-keyword">security</span></span>=disabled <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>-fail-retry-<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span>ms \ periodic-calibration=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> periodic-calibration-<span class="hljs-built_in"><span class="hljs-built_in">interval</span></span>=<span class="hljs-number"><span class="hljs-number">60</span></span> preamble-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">both</span></span> \ proprietary-extensions=post<span class="hljs-number"><span class="hljs-number">-2.9</span></span><span class="hljs-number"><span class="hljs-number">.25</span></span> radio-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=D4CA6D20E24D rate-selection=\ <span class="hljs-keyword"><span class="hljs-keyword">advanced</span></span> rate-<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">scan</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">list</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">security</span></span>-profile=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ssid=tv \ station-bridge-<span class="hljs-keyword"><span class="hljs-keyword">clone</span></span>-mac=<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> supported-rates-a/g=\ <span class="hljs-number"><span class="hljs-number">6</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">9</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">12</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">18</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">24</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">36</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">48</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">54</span></span>Mbps supported-rates-b=\ <span class="hljs-number"><span class="hljs-number">1</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">2</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">5.5</span></span>Mbps,<span class="hljs-number"><span class="hljs-number">11</span></span>Mbps tdma-<span class="hljs-keyword"><span class="hljs-keyword">period</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>=<span class="hljs-number"><span class="hljs-number">2</span></span> tx-<span class="hljs-keyword"><span class="hljs-keyword">power</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>-stats-<span class="hljs-built_in"><span class="hljs-built_in">interval</span></span>=disabled wds-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">range</span></span>=<span class="hljs-number"><span class="hljs-number">50</span></span><span class="hljs-number"><span class="hljs-number">-150</span></span> wds-<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-bridge=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> \ wds-<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">100</span></span> wds-<span class="hljs-keyword"><span class="hljs-keyword">ignore</span></span>-ssid=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> wds-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=disabled wireless-protocol=<span class="hljs-keyword"><span class="hljs-keyword">any</span></span> \ wmm-support=disabled</code> </pre><br><br>  Encryption is customized to your taste through Security Profiles, I will not dwell on this. <br><br>  Now we are creating a virtual access point through which all of our other hardware will get on the Internet (phones, tablets, laptops, etc.).  But first add one more security-profile, so as not to get confused. <br><img src="https://habrastorage.org/storage2/26b/94a/aac/26b94aaacfa8dd2c41828777b5e2bcd0.png"><br><pre> <code class="hljs sql">/interface wireless security-profiles add authentication-types=wpa2-psk eap-methods="" group-ciphers=aes-ccm \ group-key-<span class="hljs-keyword"><span class="hljs-keyword">update</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span>m interim-<span class="hljs-keyword"><span class="hljs-keyword">update</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>s <span class="hljs-keyword"><span class="hljs-keyword">management</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">protection</span></span>=allowed \ <span class="hljs-keyword"><span class="hljs-keyword">management</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">protection</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=dynamic-<span class="hljs-keyword"><span class="hljs-keyword">keys</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>=inet-sec \ radius-eap-accounting=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> radius-mac-accounting=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> \ radius-mac-<span class="hljs-keyword"><span class="hljs-keyword">authentication</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> radius-mac-<span class="hljs-keyword"><span class="hljs-keyword">caching</span></span>=disabled \ radius-mac-<span class="hljs-keyword"><span class="hljs-keyword">format</span></span>=XX:XX:XX:XX:XX:XX radius-mac-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>-username \ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-algo<span class="hljs-number"><span class="hljs-number">-0</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-algo<span class="hljs-number"><span class="hljs-number">-1</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-algo<span class="hljs-number"><span class="hljs-number">-2</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-algo<span class="hljs-number"><span class="hljs-number">-3</span></span>=\ <span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span><span class="hljs-number"><span class="hljs-number">-3</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-sta-<span class="hljs-keyword"><span class="hljs-keyword">private</span></span>-algo=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-sta-<span class="hljs-keyword"><span class="hljs-keyword">private</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>-transmit-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">key</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span> supplicant-<span class="hljs-keyword"><span class="hljs-keyword">identity</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> tls-certificate=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> \ tls-<span class="hljs-keyword"><span class="hljs-keyword">mode</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span>-certificates unicast-ciphers=aes-ccm wpa-pre-<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>=<span class="hljs-string"><span class="hljs-string">""</span></span> \ wpa2-pre-<span class="hljs-keyword"><span class="hljs-keyword">shared</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">key</span></span>=blablabla</code> </pre><br><br>  Well, VirtualAP itself <br><img src="https://habrastorage.org/storage2/dcb/828/378/dcb828378542faf5ac9b50b17ff9eba9.png"><br><pre> <code class="hljs pgsql">/interface wireless <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> area="" arp=enabled bridge-mode=enabled <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-ap-tx-<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-authentication=yes <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-client-tx-<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-forwarding=yes \ <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-running-<span class="hljs-keyword"><span class="hljs-keyword">check</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> hide-ssid=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> l2mtu=<span class="hljs-number"><span class="hljs-number">2290</span></span> mac-address=\ D6:CA:<span class="hljs-number"><span class="hljs-number">6</span></span>D:<span class="hljs-number"><span class="hljs-number">20</span></span>:E2:<span class="hljs-number"><span class="hljs-number">4</span></span>D master-interface=wlan1 max-station-count=<span class="hljs-number"><span class="hljs-number">2007</span></span> mtu=<span class="hljs-number"><span class="hljs-number">1500</span></span> \ multicast-helper=<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>=wlan2 proprietary-extensions=post<span class="hljs-number"><span class="hljs-number">-2.9</span></span><span class="hljs-number"><span class="hljs-number">.25</span></span> \ <span class="hljs-keyword"><span class="hljs-keyword">security</span></span>-profile=<span class="hljs-type"><span class="hljs-type">inet</span></span>-sec ssid=<span class="hljs-type"><span class="hljs-type">Inet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>-stats-<span class="hljs-type"><span class="hljs-type">interval</span></span>=disabled \ wds-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>-range=<span class="hljs-number"><span class="hljs-number">0</span></span> wds-<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-bridge=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> wds-<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span> wds-ignore-ssid=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> \ wds-mode=disabled wmm-support=disabled</code> </pre><br><br>  And add the resulting wlan2 to the bridge to ether2 <br><img src="https://habrastorage.org/storage2/3f2/ef7/d8e/3f2ef7d8e11d4710a82d4a08b0754458.png"><br><pre> <code class="hljs pgsql">/interface bridge <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> bridge=bridge-<span class="hljs-keyword"><span class="hljs-keyword">local</span></span> disabled=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> edge=auto <span class="hljs-keyword"><span class="hljs-keyword">external</span></span>-fdb=auto horizon=<span class="hljs-keyword"><span class="hljs-keyword">none</span></span> \ interface=wlan2 <span class="hljs-type"><span class="hljs-type">path</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">cost</span></span>=<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-type"><span class="hljs-type">point</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>-<span class="hljs-type"><span class="hljs-type">point</span></span>=auto priority=<span class="hljs-number"><span class="hljs-number">0x80</span></span></code> </pre><br><br>  This completes the configuration of the R1 router.  Wired devices go to the Internet through ports 2-5, wireless through a wlan2 access point with SSID ‚ÄúInet‚Äù <br><br>  R2 router setup <br><br>  Setting up this router is generally banal.  Since  Having the default configuration, we only need to perform an ether scan, find the point with the ssid ‚Äútv‚Äù and click the Connect button.  If you use encryption, then make the appropriate amendments to the Security profiles.  After that, you need to remove ether2 from the bridge, and add ehter1 instead.  Caution!  After that, you lose the connection with the router and the winbox closes. <br><br><img src="https://habrastorage.org/storage2/51e/448/9a5/51e4489a5ca1fab7d9167deaee723913.png"><br><img src="https://habrastorage.org/storage2/789/598/b8f/789598b8f7376e371ec904257437528f.png"><br><br>  We include the prefix in the eth1 port and everything is ready. <br><br><img src="https://habrastorage.org/storage2/8cf/995/8d3/8cf9958d361df4bd2cf68bd660f94b0e.png"><br><img src="https://habrastorage.org/storage2/f6b/61a/112/f6b61a112e96e960ac18866884912794.jpg"><br><br>  Here we see the recording channel 1HD and simultaneous downloading of the file.  However, according to this scheme, I failed to squeeze more than 7-8 megabits from VirtualAP. <br>  The CPU load of the router used as an access point for such a picture did not exceed 34-37%. The switching speed of the channels per eye does not differ from the cable connection. <br>  During the experiments I tried to start up through IGMP - proxy.  It seems to work, but the HD channels are freezing, entering pin codes does not work, recording does not work. <br>  The method was also tried when the physical AP was used for the Internet, and VirtualAP for television.  In this case, the transfer rate was no more than 1Mbps, which is naturally unacceptably low for watching TV.  Instead of the video series, there were stills, replacing each other every 30 seconds. <br>  On this experiment I consider successful and finished.  There is a wide scope for further tuning.  Ready to answer all questions.  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/174111/">https://habr.com/ru/post/174111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../174095/index.html">New in 2013 already in Russia</a></li>
<li><a href="../174097/index.html">Configurable authorization in Asp.Net MVC</a></li>
<li><a href="../174099/index.html">SharePoint 2013 Application Development with TypeScript</a></li>
<li><a href="../174103/index.html">Ruby on Rails Application Development in Visual Studio</a></li>
<li><a href="../174109/index.html">Writing a SOAP client in C ++ using gSOAP</a></li>
<li><a href="../174115/index.html">Splitting a continuous data stream into structural units</a></li>
<li><a href="../174119/index.html">Accountology vs Accounting. The rules of computer accounting and the consequences of non-compliance</a></li>
<li><a href="../174121/index.html">Does NASA terminate all educational programs?</a></li>
<li><a href="../174123/index.html">RE: Is time travel possible?</a></li>
<li><a href="../174127/index.html">Screenshots of Windows Blue and IE 11 published</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>