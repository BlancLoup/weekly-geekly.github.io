<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C / C +: these insidious string sets.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many ‚Äúknow‚Äù that programming in C / C ++ allows you to get programs that work almost as fast as programs written in the Assembler language, and those,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C / C +: these insidious string sets.</h1><div class="post__text post__text-html js-mediator-article">  Many ‚Äúknow‚Äù that programming in C / C ++ allows you to get programs that work almost as fast as programs written in the Assembler language, and those, in turn, are as fast as possible in theory. <br><br>  In fact, of course, this is not quite the case (and in rare cases it is not at all), but in general, C / C ++ programs are really fast, require a little memory and start up instantly.  If you write them correctly. <br><br>  That's about how to write in C / C ++ and I would like to talk a little.  Today I want to discuss the issue of rowsets.  That is, about procedures that allow you to get a string from a number, and a number from a string. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Where similar lists are found?  Well, for example, it can be lists of html tokens with which your program works.  Or a list of commands that your command interpreter accepts.  But, of course, such sets most often appear as lists of all kinds of errors: strerror, gai_strerror, regerror, etc.  I think every programmer has met with a similar task at least once. <br><br>  I want to make a reservation that the further description is directly applicable only to operating systems using the ELF format: Linux, MacOS, etc.  On Windows or embedded systems, the situation may be slightly different.  Plus, this time I‚Äôll confine myself to the direct problem (by the number of getting a string) because it is, firstly, simpler, and secondly, many solutions to the inverse problem contain a direct problem as part of the solution. <a name="habracut"></a><br><br>  So let's set the task.  We want to have the <b>errstr</b> function, which returns a string by the ‚Äúerror‚Äù number.  How can I write a similar function? <br><br>  Well, for example, in the forehead: <br><br>  <font color="#0000ff">const</font> <font color="#0000ff">char</font> * errstr <font color="#000000">(</font> <font color="#0000ff">int</font> nr <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">switch</font> <font color="#000000">(</font> nr <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">case</font> <font color="#0000dd">0</font> : <font color="#0000ff">return</font> <font color="#666666">"X00000X"</font> ; <br>  <font color="#0000ff">case</font> <font color="#0000dd">1</font> : <font color="#0000ff">return</font> <font color="#666666">"X00001X"</font> ; <br>  ... <br>  <font color="#0000ff">case</font> <font color="#0000dd">9999</font> : <font color="#0000ff">return</font> <font color="#666666">"X09999X"</font> ; <br>  <font color="#0000ff">default</font> : <font color="#0000ff">return</font> <font color="#666666">"Unknown error"</font> ; <br>  <font color="#000000">}</font> <br>  <font color="#000000">}</font> <br><br>  Does this option work?  Full  But how many resources does it require?  Let's get a look: <br>  <i>$</i> <b>gcc -march = native -fPIC -O2 -shared -o libgen1.so gen1.c</b> <br>  <i>$</i> <b>strip --strip-unneeded libgen1.so</b> <br>  <i>$</i> <b>size libgen1.so</b> <br><table><tbody><tr><td>  <i>text</i> </td><td>  <i>data</i> </td><td>  <i>bss</i> </td><td>  <i>dec</i> </td><td>  <i>hex</i> </td><td>  <i>filename</i> </td></tr><tr><td>  <i>201116</i> </td><td>  <i>272</i> </td><td>  <i>28</i> </td><td>  <i>201416</i> </td><td>  <i>312c8</i> </td><td>  <i>libgen1.so</i> </td></tr></tbody></table><br>  We spent 20 bytes on each line.  Moreover, the actual string itself takes 8 bytes.  Can you do better?  Mmm ... Yes, of course!  It is enough to make a list of strings in the form of an array and a simple function for extracting elements.  Pointers in the array will occupy 4 bytes each and instead of 20 bytes per line we get only 12 - saving 40%!  The game is definitely worth the candle. <br><br>  No sooner said than done: <br><br>  <font color="#0000ff">static</font> <font color="#0000ff">const</font> <font color="#0000ff">char</font> * <font color="#0000ff">const</font> msgs <font color="#000000">[</font> <font color="#000000">]</font> = <font color="#000000">{</font> <br>  <font color="#000000">[</font> <font color="#0000dd">0</font> <font color="#000000">]</font> = <font color="#666666">"X00000X"</font> , <br>  <font color="#000000">[</font> <font color="#0000dd">1</font> <font color="#000000">]</font> = <font color="#666666">"X00001X"</font> , <br>  ... <br>  <font color="#000000">[</font> <font color="#0000dd">9999</font> <font color="#000000">]</font> = <font color="#666666">"X09999X"</font> , <br>  <font color="#000000">}</font> ; <br><br>  <font color="#0000ff">const</font> <font color="#0000ff">char</font> * errstr <font color="#000000">(</font> <font color="#0000ff">int</font> nr <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">if</font> <font color="#000000">(</font> nr &lt; <font color="#0000dd">0</font> || nr&gt; sizeof <font color="#000000">(</font> msgs <font color="#000000">)</font> / <font color="#0000dd">sizeof</font> <font color="#000000">(</font> msgs <font color="#000000">[</font> <font color="#0000dd">0</font> <font color="#000000">]</font> <font color="#000000">)</font> <font color="#000000">)</font> <br>  <font color="#0000ff">return</font> <font color="#666666">"Unknown error"</font> ; <br>  <font color="#0000ff">return</font> msgs <font color="#000000">[</font> nr <font color="#000000">]</font> ; <br>  <font color="#000000">}</font> <br><br>  <i>$</i> <b>gcc -march = native -fPIC -O2 -shared -o libgen2.so gen2.c</b> <br>  <i>$</i> <b>strip --strip-unneeded libgen2.so</b> <br>  <i>$</i> <b>size libgen2.so</b> <br><table><tbody><tr><td>  <i>text</i> </td><td>  <i>data</i> </td><td>  <i>bss</i> </td><td>  <i>dec</i> </td><td>  <i>hex</i> </td><td>  <i>filename</i> </td></tr><tr><td>  <i>161110</i> </td><td>  <i>40272</i> </td><td>  <i>28</i> </td><td>  <i>201410</i> </td><td>  <i>312c2</i> </td><td>  <i>libgen2.so</i> </td></tr></tbody></table><br>  Awesome achievement!  Save 6 bytes?  What happened?  80'000 bytes is occupied by the table (it cannot be modified so that it is protected as text), but where did we get another ~ 80'000 bytes of text (we counted on 40'000 bytes) and ~ 40'000 bytes of data (and they should not be at all - do we have all constant tables?).  Let's figure it out: <br>  <i>$</i> <b><a href="http://people.redhat.com/drepper/relinfo.pl">relinfo</a> libgen2.so</b> <br>  <i>libgen2.so: 10007 relocations, 10002 relative (99%), 3 PLT entries, 0 for local syms (0%), 0 users</i> <br>  Yeah.  Now it is clear!  The compiler cannot calculate this table and write it to the library: for this you need to know the address where the library will be located in memory during execution - and this information is unknown to him.  Moreover: as a rule, this information is unknown to the linker - therefore it forms the table not in the text segment, but in the data segment and creates another table - already for the dynamic linker.  Which <b>at the time of launching the program</b> fills it.  Mdaa ... And this is all - for the table, which, most likely, will not be used at all!  Who was talking about instantly running programs? <br><br>  What to do?  Obviously, it would be nice to reorganize the table so that the calculations are not made by the dynamic linker each time the program is started, but by our program - and only where they are needed.  How to do it?  We are not alone with this problem?  How is this done in, say, glibc?  <a href="http://people.redhat.com/drepper/dsohowto.pdf">And so</a> : all the lines are in a separate file that is used by the main program. <br>  The <b>stringtab.h</b> file contains the following: <br>  _S <font color="#000000">(</font> <font color="#0000dd">0</font> , <font color="#666666">"X00000X"</font> <font color="#000000">)</font> <br>  _S <font color="#000000">(</font> <font color="#0000dd">1</font> , <font color="#666666">"X00001X"</font> <font color="#000000">)</font> <br>  ... <br>  _S <font color="#000000">(</font> <font color="#0000dd">9999</font> , <font color="#666666">"X09999X"</font> <font color="#000000">)</font> <br>  And the program is this: <br>  <font color="#339900">#include</font> <font color="#336600">&lt;stddef.h&gt;</font> <br><br>  <font color="#339900">#define MSGSTRFIELD (line) MSGSTRFIELD1 (line)</font> <br>  <font color="#339900">#define MSGSTRFIELD1 (line) str ## line</font> <br>  <font color="#0000ff">static</font> <font color="#0000ff">const</font> <font color="#0000ff">union</font> msgstr_t <font color="#000000">{</font> <br>  <font color="#0000ff">struct</font> <font color="#000000">{</font> <br>  <font color="#339900">#define _S (n, s) char MSGSTRFIELD (__ LINE __) [sizeof (s)];</font> <br>  <font color="#339900">#include</font> <font color="#336600">"stringtab.h"</font> <br>  <font color="#339900">#undef _S</font> <br>  <font color="#000000">}</font> ; <br>  <font color="#0000ff">char</font> str <font color="#000000">[</font> <font color="#0000dd">0</font> <font color="#000000">]</font> ; <br>  <font color="#000000">}</font> msgstr = <font color="#000000">{</font> <font color="#000000">{</font> <br>  <font color="#339900">#define _S (n, s) s,</font> <br>  <font color="#339900">#include</font> <font color="#336600">"stringtab.h"</font> <br>  <font color="#339900">#undef _S</font> <br>  <font color="#000000">}</font> <font color="#000000">}</font> ; <br>  <font color="#0000ff">static</font> <font color="#0000ff">const</font> <font color="#0000ff">unsigned</font> <font color="#0000ff">int</font> msgidx <font color="#000000">[</font> <font color="#000000">]</font> = <font color="#000000">{</font> <br>  <font color="#339900">#define _S (n, s) offsetof (union msgstr_t, MSGSTRFIELD (__ LINE__)),</font> <br>  <font color="#339900">#include</font> <font color="#336600">"stringtab.h"</font> <br>  <font color="#339900">#undef _S</font> <br>  <font color="#000000">}</font> ; <br>  <font color="#0000ff">const</font> <font color="#0000ff">char</font> * errstr <font color="#000000">(</font> <font color="#0000ff">int</font> nr <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">if</font> <font color="#000000">(</font> nr &lt; <font color="#0000dd">0</font> || nr&gt; sizeof <font color="#000000">(</font> msgidx <font color="#000000">)</font> / <font color="#0000dd">sizeof</font> <font color="#000000">(</font> msgidx <font color="#000000">[</font> <font color="#0000dd">0</font> <font color="#000000">]</font> <font color="#000000">)</font> <font color="#000000">)</font> <br>  <font color="#0000ff">return</font> <font color="#666666">"Unknown error"</font> ; <br>  <font color="#0000ff">return</font> msgstr.str + msgidx <font color="#000000">[</font> nr <font color="#000000">]</font> ; <br>  <font color="#000000">}</font> <br>  <i>$</i> <b>gcc -march = native -fPIC -O2 -shared -o libgen3.so gen3.c</b> <br>  <i>$</i> <b>strip --strip-unneeded libgen3.so</b> <br>  <i>$</i> <b>size libgen3.so</b> <br><table><tbody><tr><td>  <i>text</i> </td><td>  <i>data</i> </td><td>  <i>bss</i> </td><td>  <i>dec</i> </td><td>  <i>hex</i> </td><td>  <i>filename</i> </td></tr><tr><td>  <i>121136</i> </td><td>  <i>272</i> </td><td>  <i>28</i> </td><td>  <i>121436</i> </td><td>  <i>1da5c</i> </td><td>  <i>libgen3.so</i> </td></tr></tbody></table><br>  Now - the order.  The only remaining question is: we transferred the calculations from the dynamic linker to our program - how much did it affect the speed?  In other words: can this method be used everywhere where lists of strings are needed, or only where speed is not particularly important (for example, in error handling)? <br><br>  For these purposes, I wrote a small program and, using gcc 4.2.2, explored its behavior on three systems: with the AMD Opteron (tm) Processor 175, with the Intel Core (TM) 2 CPU 6600 and with the Intel Pentium D CPU 3.00GHz. <br><br>  <font color="#339900">#define _GNU_SOURCE</font> <br>  <font color="#339900">#include</font> <font color="#336600">&lt;sched.h&gt;</font> <br>  <font color="#339900">#include</font> <font color="#336600">&lt;stdio.h&gt;</font> <br>  <font color="#339900">#include</font> <font color="#336600">"gen.h"</font> <br><br>  <font color="#339900">#define NUMTESTS 1000</font> <br>  <font color="#339900">#define NUMSTRINGS 10000</font> <br><br>  <font color="#339900">#ifdef __i386__</font> <br>  <font color="#0000ff">static</font> <font color="#0000ff">inline</font> <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> read_tsc <font color="#000000">(</font> <font color="#0000ff">void</font> <font color="#000000">)</font> <br>  <font color="#000000">{</font> <br>  <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> val; <br>  __asm__ __volatile__ <font color="#000000">(</font> <font color="#666666">"rdtsc"</font> : <font color="#666666">"= A"</font> <font color="#000000">(</font> val <font color="#000000">)</font> <font color="#000000">)</font> ; <br>  <font color="#0000ff">return</font> val; <br>  <font color="#000000">}</font> <br>  <font color="#339900">#endif</font> <br><br>  <font color="#339900">#ifdef __x86_64__</font> <br>  <font color="#0000ff">static</font> <font color="#0000ff">inline</font> <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> read_tsc <font color="#000000">(</font> <font color="#0000ff">void</font> <font color="#000000">)</font> <br>  <font color="#000000">{</font> <br>  <font color="#0000ff">unsigned</font> <font color="#0000ff">int</font> __a, __d; <br>  __asm__ __volatile__ <font color="#000000">(</font> <font color="#666666">"rdtsc"</font> : <font color="#666666">"= a"</font> <font color="#000000">(</font> __a <font color="#000000">)</font> , <font color="#666666">"= d"</font> <font color="#000000">(</font> __d <font color="#000000">)</font> <font color="#000000">)</font> ; <br>  <font color="#0000ff">return</font> <font color="#000000">(</font> <font color="#000000">(</font> <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#000000">)</font> __a <font color="#000000">)</font> |  <font color="#000000">(</font> <font color="#000000">(</font> <font color="#000000">(</font> <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#000000">)</font> __d <font color="#000000">)</font> &lt;&lt; <font color="#0000dd">32</font> <font color="#000000">)</font> ; <br>  <font color="#000000">}</font> <br>  <font color="#339900">#endif</font> <br><br>  <font color="#0000ff">int</font> main <font color="#000000">(</font> <font color="#000000">)</font> <br>  <font color="#000000">{</font> <br>  <font color="#0000dd">cpu_set_t</font> affinity; <br>  CPU_ZERO <font color="#000000">(</font> &amp; affinity <font color="#000000">)</font> ; <br>  CPU_SET <font color="#000000">(</font> <font color="#0000dd">1</font> , &amp; affinity <font color="#000000">)</font> ; <br>  sched_setaffinity <font color="#000000">(</font> <font color="#0000dd">0</font> , <font color="#0000dd">sizeof</font> <font color="#000000">(</font> <font color="#0000ff">cpu_set_t</font> <font color="#000000">)</font> , &amp; affinity <font color="#000000">)</font> ; <br>  <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> testresults <font color="#000000">[</font> NUMTESTS <font color="#000000">]</font> ; <br>  <font color="#0000ff">for</font> <font color="#000000">(</font> <font color="#0000ff">int</font> i = <font color="#0000dd">0</font> ; i &lt;NUMTESTS; ++ i <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> start = read_tsc <font color="#000000">(</font> <font color="#000000">)</font> ; <br>  <font color="#0000ff">for</font> <font color="#000000">(</font> <font color="#0000ff">int</font> i = <font color="#0000dd">0</font> ; i &lt;NUMSTRINGS; ++ i <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#ff0000">// Do nothing - measure overhead</font> <br>  <font color="#000000">}</font> <br>  testresults <font color="#000000">[</font> i <font color="#000000">]</font> = read_tsc <font color="#000000">(</font> <font color="#000000">)</font> - start; <br>  <font color="#000000">}</font> <br>  <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> overhead = testresults <font color="#000000">[</font> <font color="#0000dd">0</font> <font color="#000000">]</font> ; <br>  <font color="#0000ff">for</font> <font color="#000000">(</font> <font color="#0000ff">int</font> i = <font color="#0000dd">1</font> ; i &lt;NUMTESTS; ++ i <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">if</font> <font color="#000000">(</font> testresults <font color="#000000">[</font> i <font color="#000000">]</font> &lt;overhead <font color="#000000">)</font> <br>  overhead = testresults <font color="#000000">[</font> i <font color="#000000">]</font> ; <br>  <font color="#000000">}</font> <br>  <font color="#0000ff">for</font> <font color="#000000">(</font> <font color="#0000ff">int</font> i = <font color="#0000dd">0</font> ; i &lt;NUMTESTS; ++ i <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> start = read_tsc <font color="#000000">(</font> <font color="#000000">)</font> ; <br>  <font color="#0000ff">for</font> <font color="#000000">(</font> <font color="#0000ff">int</font> i = <font color="#0000dd">0</font> ; i &lt;NUMSTRINGS; ++ i <font color="#000000">)</font> <font color="#000000">{</font> <br>  errstr <font color="#000000">(</font> i <font color="#000000">)</font> ; <br>  <font color="#000000">}</font> <br>  testresults <font color="#000000">[</font> i <font color="#000000">]</font> = read_tsc <font color="#000000">(</font> <font color="#000000">)</font> - start; <br>  <font color="#000000">}</font> <br>  <font color="#0000ff">unsigned</font> <font color="#0000ff">long</font> <font color="#0000ff">long</font> testrun = testresults <font color="#000000">[</font> <font color="#0000dd">0</font> <font color="#000000">]</font> ; <br>  <font color="#0000ff">for</font> <font color="#000000">(</font> <font color="#0000ff">int</font> i = <font color="#0000dd">1</font> ; i &lt;NUMTESTS; ++ i <font color="#000000">)</font> <font color="#000000">{</font> <br>  <font color="#0000ff">if</font> <font color="#000000">(</font> testresults <font color="#000000">[</font> i <font color="#000000">]</font> &lt;testrun <font color="#000000">)</font> <br>  testrun = testresults <font color="#000000">[</font> i <font color="#000000">]</font> ; <br>  <font color="#000000">}</font> <br>  <font color="#0000dd">printf</font> <font color="#000000">(</font> <font color="#666666">"errstr takes% g CPU cycles per call <b>\ n</b> "</font> , <br>  <font color="#000000">(</font> testrun - overhead <font color="#000000">)</font> / <font color="#000000">(</font> NUMSTRINGS * <font color="#0000dd">1.0</font> <font color="#000000">)</font> <font color="#000000">)</font> ; <br>  <font color="#0000ff">return</font> <font color="#0000dd">0</font> ; <br>  <font color="#000000">}</font> <br>  <i>$</i> <b>gcc -march = native -O2 -std = c99 -o main1 main.c -L.</b>  <b>-lgen1</b> <br>  <i>$</i> <b>gcc -march = native -O2 -std = c99 -o main2 main.c -L.</b>  <b>-lgen2</b> <br>  <i>$</i> <b>gcc -march = native -O2 -std = c99 -o main3 main.c -L.</b>  <b>-lgen3</b> <br>  <i>$</i> <b>LD_LIBRARY_PATH =.</b>  <b>./main1</b> <br>  <i>errstr takes 44.748 CPU cycles per call</i> <br>  <i>$</i> <b>LD_LIBRARY_PATH =.</b>  <b>./main2</b> <br>  <i>errstr takes 12.9996 CPU cycles per call</i> <br>  <i>$</i> <b>LD_LIBRARY_PATH =.</b>  <b>./main3</b> <br>  <i>errstr takes 13 CPU cycles per call</i> <br><table><tbody><tr><th></th><th>  Option 1 </th><th>  Option 2 </th><th>  Option 3 </th></tr><tr><td>  AMD Opteron (32bit): </td><td>  28.13 CPU cycles </td><td>  15 CPU cycles </td><td>  16 CPU CPU cycles </td></tr><tr><td>  AMD Opteron (64bit): </td><td>  30.83 CPU cycles </td><td>  10 CPU cycles </td><td>  11 CPU CPU cycles </td></tr><tr><td>  Intel Core 2 (32 bit): </td><td>  44.67 CPU cycles </td><td>  13 CPU cycles </td><td>  13 CPU CPU cycles </td></tr><tr><td>  Intel Core 2 (64 bit): </td><td>  39.37 CPU cycles </td><td>  9 CPU cycles </td><td>  10 CPU CPU cycles </td></tr><tr><td>  Intel Pentium D (32 bit): </td><td>  111.34 CPU cycles </td><td>  26 CPU cycles </td><td>  26 CPU CPU cycles </td></tr><tr><td>  Intel Pentium D (64 bit): </td><td>  99.05 CPU cycles </td><td>  16 CPU cycles </td><td>  14 CPU CPU cycles </td></tr></tbody></table><br>  The results speak for themselves: the choice from the list has a tendency to conflict with the branch predictor and therefore works very slowly, the ‚Äústandard‚Äù option is usually the fastest, but the ‚Äúeconomical‚Äù variant does not lag behind it in half of cases, and there where it is lagging behind - it loses only one processor cycle, so if you need this function not in the ‚Äúinnermost‚Äù cycle itself, then you can (and if there are a lot of lines, you should recommend it).  It is interesting, by the way, that in one of the variants (Intel Pentium D 64 bit) the ‚Äúeconomical‚Äù option is <b>faster</b> - which is most likely due to the fact that it requires half the memory, and the access speed to the cache is finite ... </div><p>Source: <a href="https://habr.com/ru/post/15504/">https://habr.com/ru/post/15504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../15503/index.html">YouTube PR3</a></li>
<li><a href="../155031/index.html">Robofollower - Instagram promotion automation</a></li>
<li><a href="../155035/index.html">European Union requires Google to change security policy regarding user data</a></li>
<li><a href="../155037/index.html">ZigBee networks. Why and why?</a></li>
<li><a href="../155039/index.html">We send messages to Notification Center from the browser</a></li>
<li><a href="../155041/index.html">Why do we need priests in high school?</a></li>
<li><a href="../155043/index.html">Protection from spam on servers with ISPmanager</a></li>
<li><a href="../155045/index.html">Rotating beatboards: a new round of old ideas</a></li>
<li><a href="../155051/index.html">True Skin: The Neon Future</a></li>
<li><a href="../155053/index.html">IT Compote # 26 Podcast on programming and technology</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>