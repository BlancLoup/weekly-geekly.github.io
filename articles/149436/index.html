<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bookmarks in Media Player Classic Home Cinema</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you choose to keep history and save viewing positions in settings, MPC HC can automatically save up to 20 bookmarks to the last place to watch vide...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bookmarks in Media Player Classic Home Cinema</h1><div class="post__text post__text-html js-mediator-article"> If you choose to keep history and save viewing positions in settings, MPC HC can automatically save up to 20 bookmarks to the last place to watch video files and the same number of bookmarks for DVD.  When resuming viewing, the player will start playback from the last position if it finds information about the file in its database (it is stored together with other settings or in the registry or in the ini-file, depending on the user's choice).  However, there are conditions when 20 bookmarks are not enough.  Someone likes to watch many movies in parallel, sometimes postponing viewing for a while.  Someone listens to music on MPC HC (and the keys for it are the same: one big album - and all the bookmarks are overwritten).  Someone uses the player to test the encoded video repeatedly.  Finally, several members of a family can use the same account (for example, children can watch cartoons while their parents are busy).  In general, I would like to have a reliable way to save a bookmark on the desired movie and then restore it. <br><br>  The registry data is stored in the section <code>HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings</code> .  For video files, the <code>File Name N</code> / <code>File Position N</code> key pairs are used (c <code>N</code> from 0 to 19).  For DVD, one <code>DVD Position N</code> key is used (in the same range; the player manages to save both the DVD ID and the last viewing place in one mysterious digital recording). <br><br>  Three ways of creating custom bookmarks come to mind when working with the registry: from the simplest and least flexible to the more complex and subtle.  Of course, the post does not claim to be rocket science.  Simple and convenient practical tricks are described. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><h4>  I. Export / import settings using the player itself </h4><br><img src="https://habrastorage.org/storage2/75c/617/0b4/75c6170b49129a770668fe48e97bc144.png"><br><br>  It is necessary to start the export after closing the player with the movie by launching MPC again, because only before closing the data on the latest files in the registry are updated.  There is a .reg file with all the settings (and not only the section we need), and this is another disadvantage: when importing the settings, not only the desired tab will be restored, but the entire set of previous settings. <br><br>  Let's try to improve the situation a bit (further solutions were tested only in Windows XP). <br><br><h4>  Ii.  Export / import using batch file </h4><br>  Since the standard registry tools do not allow exporting individual registry entries, we will again have to deal with the whole section, but now the volume can be narrowed down to the desired <code>HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings</code> .  Additional benefits are also in the fact that we do not need to open the player again and do not need to manually enter the name of the bookmark, everything will be done automatically. <br><br><h5>  1. Batch file </h5><br>  There is no place to be easier (save as a text file with a .bat extension): <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off reg export "hkcu\Software\Gabest\Media Player Classic\Settings" "%~dpn1.reg"</code> </pre> <br>  The argument can be the last video file or a folder from a DVD.  In the same directory, a .reg file of the same name is created, which is then conveniently imported with one click before returning to watching a movie. <br><br><h5>  2. Integration into the system interface </h5><br>  In order not to have to contact the command line every time or drag the video onto the batch file label, we will implement a more convenient connection. <br><br><h6>  but.  Implementation for Explorer </h6><br>  Let's add a call to our batch file to the context menu of files and folders.  To do this, it is enough to create the following text file, save it in Unicode with the .reg extension and run for integration (just replace the paths to the program with yours, not forgetting to double the slashes). <br><br><pre> <code class="dos hljs">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span> [HKEY_CLASSES_ROOT\*\shell\* MPC bookmark] [HKEY_CLASSES_ROOT\*\shell\* MPC bookmark\command] @="E:\\DOC\\prg\\bat\\mpc_bm.bat \"%<span class="hljs-number"><span class="hljs-number">1</span></span>\"" [HKEY_CLASSES_ROOT\Folder\shell\* MPC bookmark] [HKEY_CLASSES_ROOT\Folder\shell\* MPC bookmark\command] @="E:\\DOC\\prg\\bat\\mpc_bm.bat \"%<span class="hljs-number"><span class="hljs-number">1</span></span>\""</code> </pre> <br><h6>  b.  Implementation for Total Commander </h6><br>  Those who are more accustomed to this file manager can create a button on the toolbar (you can duplicate it with the previous recipe with the context menu): <br><br><img src="https://habrastorage.org/storage2/105/c96/12d/105c9612d7d3f5efd4603c75151b12e4.png"><br><br>  Then it will be possible to create a bookmark for the file that is in focus of the active tab after watching the video. <br><br><h4>  Ii.  Export / Import with Perl Script </h4><br>  Here we can achieve even greater convenience.  If someone is not familiar with Perl, it is not scary: just <a href="http://www.activestate.com/activeperl/downloads">download and install the implementation of the interpreter for Windows</a> , everything else is also not difficult. <br><br>  With the help of the script, we can save only the necessary keys.  If you bookmark right after watching the video, we will only need the very first recordings in the history, they are also the last ones to watch: <code>File Name 0</code> + <code>File Position 0</code> or <code>DVD Position 0</code> .  In addition, the script will check the identity of the file argument and the last file in the player's history, so that we do not accidentally leave the wrong tab. <br><br><h5>  1. Script </h5><br>  Create the following text file and save it with a .pl extension: <br><br><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">################################################################################ use strict; use warnings; use Win32::TieRegistry; ################################################################################ $Registry-&gt;Delimiter("/"); my $movie = shift(); ################################################################################ if ($movie &amp;&amp; -d $movie) { open(OUTPUT, '&gt;:raw:encoding(UTF16-LE)', $movie . ".DVD.reg") or die "Cannot create the .reg file: $!\n"; print OUTPUT "\x{FEFF}Windows Registry Editor Version 5.00\r\n\r\n[HKEY_CURRENT_USER\\Software\\Gabest\\Media Player Classic\\Settings]\r\n", '"DVD Position 0"="', $Registry-&gt;{'HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings//DVD Position 0'}, "\"\r\n\r\n"; close(OUTPUT) or die "Cannot close the .reg file: $!\n"; } elsif ($movie &amp;&amp; -f $movie) { my $last_file = $Registry-&gt;{'HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings//File Name 0'}; if (lc($movie) eq lc($last_file)) { open(OUTPUT, '&gt;:raw:encoding(UTF16-LE)', $last_file =~ s/\.\w+$/.reg/r) or die "Cannot create the .reg file: $!\n"; print OUTPUT "\x{FEFF}Windows Registry Editor Version 5.00\r\n\r\n[HKEY_CURRENT_USER\\Software\\Gabest\\Media Player Classic\\Settings]\r\n", '"File Name 0"="', $last_file =~ s/\\/\\\\/gr, "\"\r\n", '"File Position 0"="', $Registry-&gt;{'HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings//File Position 0'}, "\"\r\n\r\n"; close(OUTPUT) or die "Cannot close the .reg file: $!\n"; } else { print "The input file does not match the last played one:\n\n$movie\n\n$last_file\n\n"; system('pause'); } } else { my $last_file = $Registry-&gt;{'HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings//File Name 0'}; open(OUTPUT, '&gt;:raw:encoding(UTF16-LE)', $last_file =~ s/^.+\\//r =~ s/\.\w+$/+Last_DVD.reg/r) or die "Cannot create the .reg file: $!\n"; print OUTPUT "\x{FEFF}Windows Registry Editor Version 5.00\r\n\r\n[HKEY_CURRENT_USER\\Software\\Gabest\\Media Player Classic\\Settings]\r\n", '"File Name 0"="', $last_file =~ s/\\/\\\\/gr, "\"\r\n", '"File Position 0"="', $Registry-&gt;{'HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings//File Position 0'}, "\"\r\n", '"DVD Position 0"="', $Registry-&gt;{'HKEY_CURRENT_USER/Software/Gabest/Media Player Classic/Settings//DVD Position 0'}, "\"\r\n\r\n"; close(OUTPUT) or die "Cannot close the .reg file: $!\n"; } ################################################################################</span></span></code> </pre> <br>  If a folder is transferred to a script, it saves only a bookmark on the last DVD in a .reg file with the folder name (it is not possible for me to check if this is a DVD: if someone knows how to do this, please write in the comments; but if you bookmark right after watching a movie and closing the player, you can not worry about its correctness).  If a file is transferred, the script checks the identity of this file and the last file in the history;  if the files are the same, the script creates the same .reg file with the two necessary keys, if they do not match, it gives an error message.  If no arguments are passed to the script at all, it creates a summary .reg file with information about the last DVD and the last video file in the current active folder. <br><br><h5>  2. Integration into the system interface </h5><br>  Everything is almost the same with minimal changes (do not forget to prescribe your paths to the programs). <br><br><h6>  but.  Implementation for Explorer </h6><br>  For some reason, specifying a single script is not enough, you also have to set an interpreter (despite the fact that the .pl extension is added to the PATHEXT variable): <br><br><pre> <code class="dos hljs">Windows Registry Editor Version <span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">00</span></span> [HKEY_CLASSES_ROOT\*\shell\* MPC bookmark] [HKEY_CLASSES_ROOT\*\shell\* MPC bookmark\command] @="C:\\Perl\\bin\\perl.exe E:\\DOC\\prg\\perl\\var\\mpc_bm.pl \"%<span class="hljs-number"><span class="hljs-number">1</span></span>\"" [HKEY_CLASSES_ROOT\Folder\shell\* MPC bookmark] [HKEY_CLASSES_ROOT\Folder\shell\* MPC bookmark\command] @="C:\\Perl\\bin\\perl.exe E:\\DOC\\prg\\perl\\var\\mpc_bm.pl \"%<span class="hljs-number"><span class="hljs-number">1</span></span>\""</code> </pre> <br><h6>  b.  Implementation for Total Commander </h6><br>  Similar button: <br><br><img src="https://habrastorage.org/storage2/0f5/3a5/8fe/0f53a58fef657f0c96445836332854a8.png"><br><br><hr><br>  The described mechanism allows to achieve this state: <br><br><img src="https://habrastorage.org/storage2/5ad/b92/de5/5adb92de5115d5e556fac8a847cec9bb.png"><br><br>  PS Of course, there is still ‚ÄúFavorites‚Äù in the player itself, but for some it may seem less convenient: to update a bookmark, that is, change the transition time in the same movie, you need to delete the old bookmark and create a new one;  when bookmarks are in folders next to movies, they are easier to find and easier to remove as unnecessary along with movies after viewing;  such bookmarks are available from all accounts;  they are easier to edit (even in Notepad) if the file name or the path to it is changed. </div><p>Source: <a href="https://habr.com/ru/post/149436/">https://habr.com/ru/post/149436/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149428/index.html">Microsoft and New York Police will experience a crime tracking system</a></li>
<li><a href="../149430/index.html">Things I didn't know about WebKit inspector</a></li>
<li><a href="../149431/index.html">Examining database changes through checksums</a></li>
<li><a href="../149433/index.html">Casio Protrek PRG-240-1ER watch</a></li>
<li><a href="../149435/index.html">Creating a modular structure using inversion control</a></li>
<li><a href="../149437/index.html">Apple offered Samsung to buy a patent license for $ 30 for a smartphone</a></li>
<li><a href="../149438/index.html">Samsung launches EMMC Pro Class 1500 memory modules</a></li>
<li><a href="../149440/index.html">Possible problems with the provider Network Solutions. (DDOS?)</a></li>
<li><a href="../149441/index.html">CSS3: Box-Sizing property</a></li>
<li><a href="../149444/index.html">Forms Architecture in Symfony2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>