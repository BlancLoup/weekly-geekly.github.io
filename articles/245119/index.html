<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do not worry, we will look after them. Integration of Zabbix into the client‚Äôs personal account</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tantum possumus quantum scimus 
 Perhaps everyone will agree - monitoring is one of the most important components of the IT infrastructure. 
 You need...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do not worry, we will look after them. Integration of Zabbix into the client‚Äôs personal account</h1><div class="post__text post__text-html js-mediator-article"><h4>  Tantum possumus quantum scimus </h4><br>  Perhaps everyone will agree - monitoring is one of the most important components of the IT infrastructure. <br>  You need to know about the status of your charges, because you really do not want to "suddenly" find a scattered RAID, clogged up to the top of the root partition or LA that exceeds all reasonable limits. <br><img src="https://habrastorage.org/files/738/f20/0ba/738f200ba2924d8e9a75c60dbd79a86c.png" alt="image" width="960" height="480"><br><br>  Tools, for continuous monitoring of equipment life, everyone chooses. <br>  Someone like Nagios, someone chooses Munin, as well as there are fans of proprietary or other solutions. <br><br>  We, creating a monitoring service for our customers, chose Zabbix. <br>  But it is not enough just to connect the server to the monitoring, you need to organize the relationship with the ticket system and the user's personal account.  In addition to informing about the presence of a problem, automatically create a request to the technical support service, to respond to the incident as soon as possible, and also notify the client additionally by email. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Under Habrokat we will tell how we did it. <br><a name="habracut"></a><br><h4>  Description. </h4><br>  A little dwell on the procedure for connecting the service. <br>  First of all, you need to select the Monitoring tab. <br><img src="https://habrastorage.org/files/d4d/15a/246/d4d15a2461954d84b7c36f6af6a1feab.png"><br><br>  Read the description of the service and connect it. <br><img src="https://habrastorage.org/files/684/600/836/684600836acb463daf5402ff1f68a26d.png"><br><br>  Out of the box, the most important, in our opinion, important parameters are available for selection. <br><img src="https://habrastorage.org/files/695/cf5/8cd/695cf58cd2404da3bdcc2d6bf286307f.png"><br><br>  Click on "Settings" to set the desired thresholds and notification options. <br>  Thresholds can be set from 10% to 90% in 10% increments. <br>  It is also possible to customize notification options. <br><img src="https://habrastorage.org/files/dd7/486/fd3/dd7486fd3f024f65af432f026a55602d.png"><br><img src="https://habrastorage.org/files/220/a90/a23/220a90a239104ce6a4504d0aee3dae3c.png"><br><br>  What if the set of predefined metrics does not fully comply with the monitoring requirements? <br>  In this case, it is possible to send your wishes via a special form and then we set up monitoring of the server (s) exactly as the client needs. <br><img src="https://habrastorage.org/files/d95/5ff/71b/d955ff71bbf5420bb440cd858298778a.png"><br><br>  For system administrators, an application for service connection and ticket is created, where the client can additionally discuss the details and control the connection. <br><img src="https://habrastorage.org/files/c2e/c3e/d61/c2ec3ed6122949b58e63d171f9650ed8.png"><br><br>  When the threshold values ‚Äã‚Äãspecified earlier are exceeded, the monitoring system reports a problem by highlighting the Monitoring tab in your account in red. <br>  It also sends a notification email to the client and creates a ticket for engineers on duty (if the corresponding checkboxes have been checked). <br><img src="https://habrastorage.org/files/738/f20/0ba/738f200ba2924d8e9a75c60dbd79a86c.png"><br><br>  Clicking on the link "Read" disable the color display. <br>  After the description of the triggered trigger, a link to the ticket in the technical support system is indicated, where you can clarify the details with the engineer on duty. <br><img src="https://habrastorage.org/files/f10/e40/65c/f10e4065c49e48a08b27a6341f3618ed.png"><br><br>  For each of the graphs available to view data in the context of the desired period of time. <br><img src="https://habrastorage.org/files/d7c/254/4c7/d7c2544c72f842b5ad0659dfb83f7ff3.png"><br><img src="https://habrastorage.org/files/b2f/69f/0bb/b2f69f0bb91c4632bfb1bff07ebb0c7f.png"><br><br><h4>  Technical part. </h4><br>  To integrate with our admin panel, we used the <a href="https://github.com/mattiasgeniar/MoZBX/blob/master/class_zabbix.php">class</a> found in the githab open spaces. <br>  The choice criterion was the ability to receive graphics images (there is no such functionality in the API) and the simplicity of the class implementation. <br>  Several others were written in such a way that it was not clear - this is for working with an API or for launching a spacecraft. <br>  This class is designed for Zabbix versions up to 2.2, so I had to modify it a bit.  We added the features we needed, corrected the authorization for the 2.4 versions used by us and some parameters in ZabbixAPI calls. <br>  We also changed the script for creating graphics in zabbix, so that you can cut out the extra data and insert your title. <br><br>  Data exchange goes via http / https, the API returns the json object as an array. <br>  Charts are taken somewhat more cunning - as if the browser is emulated, i.e.  the script through curl is authorized login / password and with the given cookie downloads png-shku with the schedule. <br><br>  The graphs pictures (and their previews) are stored in redis, with a lifetime of 1 hour, if the graph was not updated, for example, they chose a different date or 1 minute passed from the last show of graphs to the user in the personal account, this was done to prevent the user from working at all zabbix creating images with each page refresh. <br>  Images are formed with each unique request, i.e.  if the user does not enter into monitoring, then the system does not twitch about the graphs. <br><br>  All requests to Zabbix are hidden by keys based on md5 hashing with salt.  Query parameters are also stored in redis and are not accessible to the user, i.e.  specific parameters and links to the monitoring server are not visible. <br><br>  The cron script once per minute checks all active triggers and records the date and time of the start of the event and the date and time when the check showed that such a trigger is no longer active (only the triggers selected when connecting the service are logged). <br><br>  Depending on the selected events, the trigger sends a message to the user about the new active trigger and the triggers that he has not yet marked as read in the personal account and / or a trigger with a text of the trigger and / or the ‚ÄúMonitoring‚Äù menu blinks. <br><br>  In Zabbix itself, the trigger templates in the description are set as ‚Äúscm_ID trigger threshold%‚Äù, for example ‚Äúscm_CPU 70%‚Äù, due to which, after ordering, the script itself can find the trigger ID (unique for each host and variant of trigger), and this makes it easy to replace the description ‚Äú scm_CPU 70% "on" CPU load more than 70% "or" CPU load above 70%. " <br><br>  Our admin panel shows all available schedules, triggers and events for this host, and the user can turn them on / off at any time. <br><br>  Templates for monitoring some specific things were created from scratch, or the ones found were modified, the default templates were also slightly corrected for our specifics. <br>  If there is interest, we will be happy to share with the community. <br><br>  <b>That's all !</b> <br>  We thank you for your attention! </div><p>Source: <a href="https://habr.com/ru/post/245119/">https://habr.com/ru/post/245119/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245103/index.html">Equip a hamster or ‚ÄúOpenWrt does firmware from TP-LINK?‚Äù. Part 1 - preparatory</a></li>
<li><a href="../245107/index.html">Bash free space monitoring service</a></li>
<li><a href="../245109/index.html">Announcement of new features Typescript 1.4</a></li>
<li><a href="../245113/index.html">Mobile phones and total NSA surveillance: how it works</a></li>
<li><a href="../245117/index.html">Bylina about how I connected Drupal and Yandex.</a></li>
<li><a href="../245121/index.html">The way of the developer: stories about my fabulous failures, part 2</a></li>
<li><a href="../245123/index.html">Oracle, SQL * Net or ORDER BY saves network resources ...</a></li>
<li><a href="../245125/index.html">The Germans have created a library of drunken audio recordings.</a></li>
<li><a href="../245127/index.html">Fujitsu Optimized Server Solution for VMware EVO: RAIL</a></li>
<li><a href="../245129/index.html">The ninth issue of TsODY.RF magazine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>