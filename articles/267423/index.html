<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Practical training in pentest laboratories. Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúCorporate laboratories‚Äù is a training program in the field of information security, consisting of theoretical (webinar courses) and practical trainin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Practical training in pentest laboratories. Part 3</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/d55/a03/dc8/d55a03dc8b044b2099afc4aefc3e95dd.png"><br><br>  <a href="https://www.pentestit.ru/labs/corp-lab">‚ÄúCorporate laboratories‚Äù</a> is a training program in the field of information security, consisting of theoretical (webinar courses) and practical training (work in pentest laboratories).  This article will consider the content of the practical base, which constitutes about 80% of the total training program.  The article contains a brief analysis of one of the tasks of practical training. <a name="habracut"></a><br><br><h2>  External and internal perimeter </h2><br>  Often, the focus of information security specialists is on the outer perimeter.  However, there is a possibility that the attacker will overcome the external perimeter security systems and end up inside the network.  There are a huge number of such methods, including sociotechnical methods, using manipulating the psychology of a person, the linearity of his actions or other factors. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Internal protection usually comes down to separation of rights and anti-virus protection - either from a misunderstanding of the seriousness of the threats and risks, or poor qualifications and awareness of technical personnel or insufficient budgeting. <br><br><h2>  Insider </h2><br>  Not in last place is the so-called problem.  an insider when an attacker is inside the network and has certain rights and powers that he can try to expand using infrastructure flaws or vulnerabilities. <br><br>  Insiders can be divided into several categories: <br><br><ul><li>  Curious - as you know, many people are distinguished by curiosity and the desire to stick their nose out of their way.  This type of insider is characterized by the fact that even if by the nature of its activities it should not have access to confidential data, it is still, often out of curiosity, wants to read them.  This may concern payroll lists, distribution of premiums, etc. </li><li>  The researcher is a legal employee with the right of access to the main server, but insufficient authority to access confidential information.  Such a person may try to increase the level of authority in the server OS that is insufficient for his non-work purposes to the level of an administrator.  This type of insider is characterized by attempts to explore the company's infrastructure, outside of its professional activities or responsibilities. </li><li>  The Avenger is an offended or dismissed employee who can use a period of time until the administrator revokes his access rights to confidential data, to copy or change them in order to at least somehow ‚Äúwin back‚Äù for his offenses. </li><li>  Motivated - a legal employee of the company, acting purposefully and able to attract significant technical resources to gain access to information of interest to him.  At the same time, he uses social engineering, physical access to the server, and other features, 90% of which are completely legal and necessary for his regular work.  This kind of insider may be motivated by the extraction of profits from the data obtained for himself or by order of a third party. </li></ul><br><h2>  Attack scenario </h2><br>  An example is the <a href="https://labs.mwrinfosecurity.com/blog/2015/04/02/how-to-own-any-windows-network-with-group-policy-hijacking-attacks/">Group Policy Hijacking</a> attack.  Group Policy is a set of rules or settings according to which the receiving / transmitting working environment is configured (Windows, X-unix and other network-supported operating systems).  Group policies are created in the domain and replicated within the domain.  Group Policy Hijacking was opened at the beginning of this year, but the first fully functional implementation of this attack appeared only in <a href="http://sniff.su/">Intercepter-NG</a> (some browsers may mark the site as malicious, however the utility does not carry destructive functionality). <br><br>  Thanks to this vulnerability, in about an hour and a half, you can access any computer in the domain (except the domain controller).  The situation is that approximately every 90 minutes a domain member requests group policies from a domain controller.  This happens via SMB, and if something has changed since the last request, it means that they need to be updated. <br><br>  Every 90+ random number from 0 to 30 minutes a domain member requests group policies with DC.  This happens via SMB, by opening the network address \\ DC \ SYSVOL \ domain.name \ Policies \ UUID \ gpt.ini, containing the following entry: <br><br>  [General] <br>  Version = 12345 <br><br>  This number is a relative version of the current group policies.  If the version has not changed since the last update, the process of receiving group policies is terminated, but if the version is different, it means that they need to be updated.  At this stage, the client requests from the domain active CSE (client-side extensions), which include various logon scripts, tasks for the scheduler, and so on.  Naturally, an attacker, standing in the middle, can replace one of the tasks that is generated by the controller as a file.  In this situation, operation would be quite simple, but all these CSEs are disabled by default and the only thing you can do is modify the registry, because when updating group policies, the client requests another file, GptTmpl.inf, through which you can add or delete an entry. <br><br>  But not everything is so simple, CSE is disabled by default and the only thing you can do is modify the registry.  Therefore, the <a href="http://habrahabr.ru/users/intercepter/" class="user_link">Intercepter</a> author implemented a special mechanism (setting up a debugger for the taskhost.exe process), which allows you to get a shell with the ‚ÄúNT AUTHORITY \ SYSTEM‚Äù rights. <br><br>  Group Policy Hijacking is possible on Windows 7 \ 8.1 systems; server solutions 2008R2 \ 2012R2 can be used as domain controllers with all existing patches today.  It is also worth noting that the attack is fully automated and does not require any additional actions or conditions. <br><br><h2>  Prevention </h2><br>  Specific methods of counteraction depend on the techniques used by the attackers, the tools and experience of the IT / IB departments.  Knowledge of the methods and tactics of attack in modern systems will allow in a timely manner to eliminate possible shortcomings and vulnerabilities, preventing attempts to gain unauthorized access.  Information security specialists need to be familiar with the arsenal of modern tools, master practical exercises and be ready to use them in real situations.  You should also pay attention to the little-known and undocumented features that may be useful for checking your own infrastructure.  It is worth developing the right mindset, which includes thinking outside the box and anticipating the actions of an attacker, careful weighing of risks and time-tested techniques.  These skills will be useful to you repeatedly, regardless of whether you are a professional information security specialist, or you work as a system / network administrator. <br><br><hr><br>  <a href="http://habrahabr.ru/company/pentestit/blog/266349/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/266349/">Part 1</a> <br>  <a href="http://habrahabr.ru/company/pentestit/blog/266945/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/266945/">Part 2</a> <br>  <a href="http://habrahabr.ru/company/pentestit/blog/267949/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/267949/">Part 4</a> <br>  <a href="http://habrahabr.ru/company/pentestit/blog/268843/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/268843/">Part 5</a> </div><p>Source: <a href="https://habr.com/ru/post/267423/">https://habr.com/ru/post/267423/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267413/index.html">Announcement C ++ Core Guidelines</a></li>
<li><a href="../267415/index.html">School programmers HeadHunter - open set 2015/16</a></li>
<li><a href="../267417/index.html">God and the Multiverse. Extended Space Concept</a></li>
<li><a href="../267419/index.html">All-Russian competition "Open Data"</a></li>
<li><a href="../267421/index.html">Huawei Servers: Functional Testing</a></li>
<li><a href="../267425/index.html">Perspex - cross-platform UI framework with XAML and bindings</a></li>
<li><a href="../267427/index.html">Adobe has updated Flash Player</a></li>
<li><a href="../267429/index.html">Sharpening models in modern games</a></li>
<li><a href="../267431/index.html">Crypto-POGOST</a></li>
<li><a href="../267433/index.html">Indoor navigation and positioning - have you ever ‚Äúlost‚Äù cars in the parking lot?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>