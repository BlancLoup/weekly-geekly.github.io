<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cryptography in Java. Class cipher</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! I present to you the translation of the second article "Java Cipher" by Jakob Jenkov from the series of articles for beginners who want to l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cryptography in Java. Class cipher</h1><div class="post__text post__text-html js-mediator-article"><p>  Hi, Habr!  I present to you the translation of the second article "Java Cipher" by Jakob Jenkov from the <a href="http://tutorials.jenkov.com/java-cryptography/index.html">series of articles for beginners</a> who want to learn the basics of cryptography in Java. </p><a name="habracut"></a><br><h2 id="oglavlenie">  Table of contents: </h2><br><ol><li>  <a href="https://habr.com/ru/post/444764/">Java Cryptography</a> </li><li>  Java cipher </li><li>  Java MessageDigest </li><li>  Java Mac </li><li>  Java Signature </li><li>  Java KeyPair </li><li>  Java KeyGenerator </li><li>  Java KeyPairGenerator </li><li>  Java KeyStore </li><li>  Java keytool </li><li>  Java Certificate </li><li>  Java CertificateFactory </li><li>  Java CertPath </li></ol><br><h1 id="java-cipher-shifr">  Java Cipher (Cipher) </h1><br><p>  The Java Cipher class ( <strong>javax.crypto.Cipher</strong> ) is an encryption algorithm.  The term "Cipher" is the standard term for the encryption algorithm in the world of cryptography.  This is why the Java class is called <em>Cipher</em> , not the Encoder / Decoder or something else.  You can use an instance of <em>Cipher</em> to encrypt and decrypt data in Java.  This chapter explains how the Cipher class works. </p><br><h3 id="sozdanie-shifra">  Creating a cipher </h3><br><p>  Before using a cipher, you must create an instance of the <em>Cipher</em> class by calling its <em>getInstance ()</em> method with a parameter indicating which type of encryption algorithm you want to use.  Here is an example of creating an instance of Java Cipher: </p><br><pre><code class="java hljs">Cipher cipher = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"AES"</span></span>);</code> </pre> <br><p>  This example creates an instance of Cipher using the AES encryption algorithm. </p><br><h3 id="rezhimy-shifrovaniya">  Encryption Modes </h3><br><p>  Some encryption algorithms can work in different modes.  Encryption mode determines the details of how the data will be encrypted.  Thus, the encryption mode partially affects the encryption algorithm.  Encryption modes can sometimes be used in several different encryption algorithms ‚Äî as a method that is added to the basic encryption algorithm.  That is why the modes are considered separately from the encryption algorithms themselves, but rather as ‚Äúadditions‚Äù to the encryption algorithms.  Here are some of the most well-known encryption modes: </p><br><ul><li>  EBC - Electronic Codebook (Electronic Codebook <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B6%25D0%25B8%25D0%25BC_%25D1%258D%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25B2%25D0%25BE%25D0%25B9_%25D0%25BA%25D0%25BD%25D0%25B8%25D0%25B3%25D0%25B8" title="Electronic Codebook Mode">Mode</a> ) </li><li>  CBC - Cipher Block Chaining ( <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B6%25D0%25B8%25D0%25BC_%25D1%2581%25D1%2586%25D0%25B5%25D0%25BF%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B1%25D0%25BB%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25B2_%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D1%2582%25D0%25B5%25D0%25BA%25D1%2581%25D1%2582%25D0%25B0" title="Ciphertext block chaining mode">Ciphertext</a> Block Linking <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B6%25D0%25B8%25D0%25BC_%25D1%2581%25D1%2586%25D0%25B5%25D0%25BF%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B1%25D0%25BB%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25B2_%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D1%2582%25D0%25B5%25D0%25BA%25D1%2581%25D1%2582%25D0%25B0" title="Ciphertext block chaining mode">Mode</a> ) </li><li>  CFB - Cipher Feedback ( <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B6%25D0%25B8%25D0%25BC_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B9_%25D1%2581%25D0%25B2%25D1%258F%25D0%25B7%25D0%25B8_%25D0%25BF%25D0%25BE_%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D1%2582%25D0%25B5%25D0%25BA%25D1%2581%25D1%2582%25D1%2583" title="Ciphertext Feedback Mode">Ciphertext</a> Feedback <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B6%25D0%25B8%25D0%25BC_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B9_%25D1%2581%25D0%25B2%25D1%258F%25D0%25B7%25D0%25B8_%25D0%25BF%25D0%25BE_%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D1%2582%25D0%25B5%25D0%25BA%25D1%2581%25D1%2582%25D1%2583" title="Ciphertext Feedback Mode">Mode</a> ) </li><li>  OFB - Output Feedback (Output Feedback <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B6%25D0%25B8%25D0%25BC_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B9_%25D1%2581%25D0%25B2%25D1%258F%25D0%25B7%25D0%25B8_%25D0%25BF%25D0%25BE_%25D0%25B2%25D1%258B%25D1%2585%25D0%25BE%25D0%25B4%25D1%2583" title="Output feedback mode">Mode</a> ) </li><li>  CTR - Counter (Counter <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25B6%25D0%25B8%25D0%25BC_%25D1%2588%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">Mode</a> ) </li></ul><br><p>  When creating a cipher instance, you can add its mode to the name of the encryption algorithm.  You can create an AES Cipher instance using Cipher Block Chaining (CBC) mode, like this: </p><br><pre> <code class="java hljs">Cipher cipher = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"AES/CBC/PKCS5Padding"</span></span>);</code> </pre> <br><p>  Since the cipher block chaining mode also requires an ‚Äúadd-on scheme‚Äù, an add-on scheme ( <em>PKCS5Padding</em> ) is added to the end of the string of the name of the encryption algorithm. <br>  It is important to know that not all algorithms and encryption modes are supported by the default Java SDK encryption provider.  You may need to install a third-party provider, such as Bouncy Castle, to create the required cipher instance with the required mode and filling scheme. </p><br><h3 id="inicializaciya-shifra">  Cipher Initialization </h3><br><p>  Before using a Cipher instance, it must be initialized.  Initialization of the cipher is performed by calling its <em>init ()</em> method.  The <em>init ()</em> method takes two parameters: </p><br><ul><li>  Mode </li><li>  Key </li></ul><br><p>  An example of initializing an instance of Cipher in encryption mode: </p><br><pre> <code class="java hljs">Key key = ... <span class="hljs-comment"><span class="hljs-comment">// /    cipher.init(Cipher.ENCRYPT_MODE, key);</span></span></code> </pre> <br><p>  And here is an example of initializing a Cipher instance already in decryption mode: </p><br><pre> <code class="java hljs">Key key = ... <span class="hljs-comment"><span class="hljs-comment">///    cipher.init(Cipher.DECRYPT_MODE, key);</span></span></code> </pre> <br><h3 id="shifrovanie-i-rasshifrovka--dannyh">  Data Encryption and Decryption </h3><br><p>  To encrypt or decrypt data using an instance of Cipher, one of these two methods is called: </p><br><ul><li> <code>update()</code> </li> <li> <code>doFinal()</code> </li> </ul><br><p>  There are several overridden versions of the <em>update ()</em> and <em>doFinal ()</em> methods that accept different parameters.  Consider the most commonly used here.  If you need to encrypt or decrypt a single data block, simply call <em>doFinal ()</em> with the data to encrypt or decrypt.  Example: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] plainText = <span class="hljs-string"><span class="hljs-string">"abcdefghijklmnopqrstuvwxyz"</span></span>.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] cipherText = cipher.doFinal(plainText);</code> </pre> <br><p>  In fact, the code looks much the same in the case of decrypting data.  Just remember that the Cipher instance must be initialized in decryption mode.  Here is the decryption of a single block of cipher text: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] plainText = cipher.doFinal(cipherText);</code> </pre> <br><p>  If you need to encrypt or decrypt a large file divided into several blocks, <em>update ()</em> is called once for each data block and ends with a call to the <em>doFinal ()</em> method with the last data block.  Here is an example of encrypting multiple data blocks: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data1 = <span class="hljs-string"><span class="hljs-string">"abcdefghijklmnopqrstuvwxyz"</span></span>.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data2 = <span class="hljs-string"><span class="hljs-string">"zyxwvutsrqponmlkjihgfedcba"</span></span>.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data3 = <span class="hljs-string"><span class="hljs-string">"01234567890123456789012345"</span></span>.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] cipherText1 = cipher.update(data1); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] cipherText2 = cipher.update(data2); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] cipherText3 = cipher.doFinal(data3);</code> </pre> <br><p>  The reason why the <em>doFinal ()</em> call is required for the last data block is that some encryption algorithms must complement the data in order to fit a specific cipher block size (for example, an 8-byte boundary).  It is not necessary to supplement intermediate encrypted data.  Consequently, the <em>update ()</em> method is called for the intermediate data blocks and the <em>doFinal ()</em> call for the last data block. <br>  When decoding multiple data blocks, you also call the <em>update ()</em> method for the intermediate data blocks and the <em>doFinal ()</em> method for the last block.  An example of decrypting several data blocks: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] plainText1 = cipher.update(cipherText1); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] plainText2 = cipher.update(cipherText2); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] plainText3 = cipher.doFinal(cipherText3);</code> </pre> <br><p>  Again, the cipher instance must be initialized in decryption mode for this example to work. </p><br><h3 id="shifrovanie--rasshifrovka-chasti-baytovogo-massiva">  Encryption / Decryption of part of a byte array </h3><br><p>  Encryption and decryption methods of the Cipher class can encrypt or decrypt some of the data stored in a byte array.  The <em>update ()</em> and / or <em>doFinal () method</em> needs to pass an offset and length. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offset = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = <span class="hljs-number"><span class="hljs-number">24</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] cipherText = cipher.doFinal(data, offset, length);</code> </pre> <br><p>  In this example, the bytes from 10 index and 24 bytes ahead will be encrypted (or decrypted, depending on the initialization of the cipher). </p><br><h3 id="shifrovanie--rasshifrovka-v-suschestvuyuschiy-baytovyy-massiv">  Encryption / Decryption to an existing byte array </h3><br><p>  All the encryption and decryption examples in this chapter return the encrypted or decrypted data in a new byte array.  However, it is also possible to encrypt or decrypt data into an existing byte array.  This can be useful for reducing the number of byte arrays created.  To do this, transfer the target byte array as a parameter to the <em>update ()</em> and / or <em>doFinal ()</em> method. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offset = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = <span class="hljs-number"><span class="hljs-number">24</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] dest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">1024</span></span>]; cipher.doFinal(data, offset, length, dest);</code> </pre> <br><p>  In this example, the data is encrypted from 10 index to 24 bytes forward in dest byte array with offset 0. If you want to set a different offset for dest byte array, there are versions <em>update ()</em> and <em>doFinal ()</em> that accept an additional offset parameter.  An example of calling the <em>doFinal ()</em> method with an offset in the dest array: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offset = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = <span class="hljs-number"><span class="hljs-number">24</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] dest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">1024</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> destOffset = <span class="hljs-number"><span class="hljs-number">12</span></span> cipher.doFinal(data, offset, length, dest, destOffset);</code> </pre> <br><h3 id="povtornoe-ispolzovanie-ekzemplyara-shifra">  Cipher instance reuse </h3><br><p>  Initializing a Cipher instance is an expensive operation and reusing Cipher instances would be a good idea.  Fortunately, the Cipher class has been designed for reusability.  When you call the <em>doFinal ()</em> method for a Cipher instance, it returns to the state it was in immediately after initialization.  The Cipher instance can then be used to encrypt or decrypt more data. </p><br><p>  An example of a reuse instance of Java Cipher: </p><br><pre> <code class="java hljs">Cipher cipher = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"AES"</span></span>); Key key = ... <span class="hljs-comment"><span class="hljs-comment">///    cipher.init(Cipher.ENCRYPT_MODE, key); byte[] data1 = "abcdefghijklmnopqrstuvwxyz".getBytes("UTF-8"); byte[] data2 = "zyxwvutsrqponmlkjihgfedcba".getBytes("UTF-8"); byte[] cipherText1 = cipher.update(data1); byte[] cipherText2 = cipher.doFinal(data2); byte[] data3 = "01234567890123456789012345".getBytes("UTF-8"); byte[] cipherText3 = cipher.doFinal(data3);</span></span></code> </pre> <br><p>  An instance of Cipher is first created and initialized, and then used to encrypt two blocks of consistent data.  Notice the call to <em>update ()</em> , and then <em>doFinal ()</em> for these two data blocks.  After that, the Cipher instance can be re-used to encrypt data.  This is done by calling <em>doFinal ()</em> with the third data block.  After this <em>doFinal ()</em> call, you can encrypt another data block with the same instance of Java Cipher. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/444814/">https://habr.com/ru/post/444814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444802/index.html">Top 7 Scenarios for Using Data Science in Finance</a></li>
<li><a href="../444804/index.html">The operator of the exchange BTC-e asks to extradite him to Russia</a></li>
<li><a href="../444806/index.html">Moira participates in Google Summer of Code 2019</a></li>
<li><a href="../444808/index.html">Automatic Canary Deploy with Flagger and Istio</a></li>
<li><a href="../444810/index.html">Processors and marketing in computer technology</a></li>
<li><a href="../444816/index.html">Do-it-yourself carpentry workshop: expectations and reality</a></li>
<li><a href="../444820/index.html">Mockdown: the fastest way to create wireframes</a></li>
<li><a href="../444822/index.html">JDK 9 / JEP 280: string concatenation will never be the same again</a></li>
<li><a href="../444824/index.html">What the first Amazon and FedEx courier robots look like</a></li>
<li><a href="../444826/index.html">Tesla filed a lawsuit against a former employee, claiming that he stole company secrets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>