<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Packaging of Boolean variables for storage and search in the database</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Faced with the need to store forms in the database, most of which were ‚Äúticks‚Äù, that is, in fact, Boolean variables. I didn't want to look for another...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Packaging of Boolean variables for storage and search in the database</h1><div class="post__text post__text-html js-mediator-article">  Faced with the need to store forms in the database, most of which were ‚Äúticks‚Äù, that is, in fact, Boolean variables.  I didn't want to look for another method to create thirty INT fields under thirty ticks. <br><br>  And I found - a bitmap. <a name="habracut"></a><br>  More precisely, it is not exactly a bitmap, it is a representation of it in the whole type. <br>  Did so: <br>  - All ‚Äúticks‚Äù numbered from the unit like this: <br><pre> &lt;input type = "checkbox" name = "variable []" value = "1"&gt;
 &lt;input type = "checkbox" name = "variable []" value = "2"&gt;
 &lt;input type = "checkbox" name = "variable []" value = "3"&gt;
 &lt;input type = "checkbox" name = "variable []" value = "3"&gt;
</pre><br>  - Next - made two functions: packing an array into a ‚Äúbitmap‚Äù: <br><br><pre>  function binary_array_pack ($ array) {
	 $ ret = 0;

 // Punchy pun =)
	 if (! is_array ($ array))
	     $ array = array ($ array);	
		
	 foreach ($ array as $ val) {
		 if ($ val&gt; 32 || $ val &lt;1)
			 throw new Exception ("Values ‚Äã‚Äãmust not exceed 32 and be less than 1");
		 $ ret | = bindec ('1'.str_repeat (' 0 ', $ val-1));
	 }
	 return $ ret;
 }

 function binary_array_unpack ($ val) {
	 $ ret = array ();
	 for ($ i = 0; $ i &lt;32; $ i ++) {
		 if ($ val &amp; bindec (str_repeat ('0', 31- $ i). '1'.str_repeat (' 0 ', $ i))) {
			 $ ret [] = $ i;
		 }
	 }
	 return $ ret;
 }
</pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So we get the following: <br>  - The user noted, for example, the first, second and fourth items <br>  - We received the array $ variable = array (1,2,4); <br>  - Next, we fed this array to the binary_array_pack function ($ variable) <br>  - The function returned an integer, which in binary representation looks like this - 1011, and in decimal it is 11 <br><br>  Actually, we have that the i-1 st binary digit indicates the presence of the i-th "tick".  In this case, we have zero, first and third digits, which means the presence of the first, second and fourth tick. <br><br>  Now this number can be written in <b>one</b> base field. <br><br>  <b>The question is - how now to do a sample of these fields?</b> <br>  The answer is very simple.  Bitwise operations that are supported (as far as I know) by all DBMS will help us. <br><br>  For example: <br>  - The user has selected the second tick for the search <br>  - We packed it into our ‚Äúbit array‚Äù, got the number 2. <br>  - Made a query <code>SELECT * FROM t WHERE field &amp; 2 != 0</code> <br>  - That is, we did a bitwise multiplication and, for example, the number 11, which is written in binary representation as 1011 will give us the number 0010 when multiplied by 0010. If the second tick was not recorded in the field, then this operation will give 0. The same the most will be if there is not a single match from the multiple choice. <br><br>  For other types of search, you can use other bitwise operations. <br><br>  This is how you can reduce the number of fields in the database without sacrificing functionality. <br><br>  As for the performance of such a sample, there is no exact data [for now] (tests will follow), although IMHO, bitwise operations are native for the processor and must fly. <br><br>  These functions only reflect the essence of the approach and, of course, do not claim to be the final implementation.  All notes and comments are welcome. <br><br>  The main limitation of this approach is a maximum of 64 ‚Äúticks‚Äù (BIGINT), and with this implementation, a maximum of 32 ‚Äúticks‚Äù (maximum for the php bindec function). <br><br>  <b>UPD</b> <br>  Thanks to all commented.  Comments all on the case (fortunately). <br>  Total: This approach can be used to fix multiple choices (for example, it is not known in advance how many checkboxes a user can put, so it‚Äôs not clear how many fields to drive), but using it will result in fullscan, which is, of course, much worse than normal sampling across the fields.  However, this is deduced from the theory, no experiments were put =) </div><p>Source: <a href="https://habr.com/ru/post/37131/">https://habr.com/ru/post/37131/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../371301/index.html">Convenient services like Uber aggravate traffic jams, taking passengers from public transport</a></li>
<li><a href="../371303/index.html">"Kaspersky Lab" recognized the leak source and handed over the police former employee</a></li>
<li><a href="../371305/index.html">Limiting the spread of knowledge on the example of weapons technology</a></li>
<li><a href="../371307/index.html">Ozobot is a miniature programmable robot for games and training that runs along drawn lines.</a></li>
<li><a href="../371309/index.html">The strange and high-speed world of racing on drones</a></li>
<li><a href="../371313/index.html">How to make a watch from the old navigator on Windows CE</a></li>
<li><a href="../371315/index.html">Work on carriers around the globe</a></li>
<li><a href="../371317/index.html">Alfa-Insurance Leaks Personal Data</a></li>
<li><a href="../371321/index.html">8 ideas - what to print as a gift for March 8</a></li>
<li><a href="../371325/index.html">Monitoring video surveillance systems with Zabbix</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>