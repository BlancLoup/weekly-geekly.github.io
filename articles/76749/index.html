<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Browser loading of several files</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you need to give the user the ability to download multiple files, the traditional solution at the moment is to use Flash for this purpose (more rar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Browser loading of several files</h1><div class="post__text post__text-html js-mediator-article">  If you need to give the user the ability to download multiple files, the traditional solution at the moment is to use Flash for this purpose (more rarely, Java applet or ActiveX).  In case the corresponding plugin is not available, the user is usually shown a standard HTML element for downloading the file. <br><br>  The latter situation can be improved by using the built-in browsers ability to download multiple files.  Of all browsers, now this feature does not support only Internet Explorer (however, we have not yet seen version 9, something may change there), other browsers are Opera 9 and higher (as well as versions 3.5‚Äì6.05), Firefox 3.6+, Chrome 3.0.191.0+ and Safari 4.0.1+ provide this feature. <br><br>  It is enough to write something like <blockquote><code><a href="http://s-c.me/4170/s"></a> <a href="http://s-c.me/4170/h"></a> <font color="black">Copy Source | Copy HTML <font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">enctype</font> <font color="#0000ff">="multipart/form-data"</font> <font color="#ff0000">method</font> <font color="#0000ff">="post"&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="file"</font> <font color="#ff0000">min</font> <font color="#0000ff">="1"</font> <font color="#ff0000">max</font> <font color="#0000ff">="9999"</font> <font color="#ff0000">name</font> <font color="#0000ff">="file[]"</font> <font color="#ff0000">multiple</font> <font color="#0000ff">="true" /&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="submit"</font> <font color="#ff0000">name</font> <font color="#0000ff">="submit" /&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font></font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/4170/s"></a> <a href="http://s-c.me/4170/h"></a> Copy Source | Copy HTML <font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">enctype</font> <font color="#0000ff">="multipart/form-data"</font> <font color="#ff0000">method</font> <font color="#0000ff">="post"&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="file"</font> <font color="#ff0000">min</font> <font color="#0000ff">="1"</font> <font color="#ff0000">max</font> <font color="#0000ff">="9999"</font> <font color="#ff0000">name</font> <font color="#0000ff">="file[]"</font> <font color="#ff0000">multiple</font> <font color="#0000ff">="true" /&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="submit"</font> <font color="#ff0000">name</font> <font color="#0000ff">="submit" /&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/4170/s"></a> <a href="http://s-c.me/4170/h"></a> Copy Source | Copy HTML <font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">enctype</font> <font color="#0000ff">="multipart/form-data"</font> <font color="#ff0000">method</font> <font color="#0000ff">="post"&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="file"</font> <font color="#ff0000">min</font> <font color="#0000ff">="1"</font> <font color="#ff0000">max</font> <font color="#0000ff">="9999"</font> <font color="#ff0000">name</font> <font color="#0000ff">="file[]"</font> <font color="#ff0000">multiple</font> <font color="#0000ff">="true" /&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="submit"</font> <font color="#ff0000">name</font> <font color="#0000ff">="submit" /&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/4170/s"></a> <a href="http://s-c.me/4170/h"></a> Copy Source | Copy HTML <font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">enctype</font> <font color="#0000ff">="multipart/form-data"</font> <font color="#ff0000">method</font> <font color="#0000ff">="post"&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="file"</font> <font color="#ff0000">min</font> <font color="#0000ff">="1"</font> <font color="#ff0000">max</font> <font color="#0000ff">="9999"</font> <font color="#ff0000">name</font> <font color="#0000ff">="file[]"</font> <font color="#ff0000">multiple</font> <font color="#0000ff">="true" /&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="submit"</font> <font color="#ff0000">name</font> <font color="#0000ff">="submit" /&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/4170/s"></a> <a href="http://s-c.me/4170/h"></a> Copy Source | Copy HTML <font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">enctype</font> <font color="#0000ff">="multipart/form-data"</font> <font color="#ff0000">method</font> <font color="#0000ff">="post"&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="file"</font> <font color="#ff0000">min</font> <font color="#0000ff">="1"</font> <font color="#ff0000">max</font> <font color="#0000ff">="9999"</font> <font color="#ff0000">name</font> <font color="#0000ff">="file[]"</font> <font color="#ff0000">multiple</font> <font color="#0000ff">="true" /&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="submit"</font> <font color="#ff0000">name</font> <font color="#0000ff">="submit" /&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font></font></code> </li> </ol></blockquote>  PHP turned out to be ready for such a construction (square brackets are in the ‚Äúname‚Äù parameter for it), it will simply decompose the downloaded files into the elements of the $ _FILES array, unless we use ‚ÄúOpera‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Unfortunately, ‚ÄúOpera‚Äù (since version 3.5) sends, when using multiboot, files in the ‚Äúmultipart / mixed‚Äù container, which PHP does not understand. <br><br>  I tried to correct this situation. <br><a name="habracut"></a><br>  Fortunately for us, PHP, accepting such a request, will put its contents into the $ _POST array (in this case, it will go to $ _POST ['file'] [0], then all we have to do is parse it and put it in $ _FILES (I hope the directive <a href="http://ru2.php.net/manual/en/info.configuration.php">your magic_quotes_gpc is</a> disabled). <br><br>  As a parser, I used the <a href="http://pecl.php.net/package/mailparse">mailparse</a> PECL module (there is a <a href="http://downloads.php.net/pierre/">binary for Windows</a> ). <br><br>  In my example, the parameter ‚Äúfile‚Äù is expected, but this value is easy to put into configuration.  The code seems simple enough to me not to comment on it, but if something is not clear, ask, I will add comments. <blockquote> <code><a href="http://s-c.me/4169/s"></a> <a href="http://s-c.me/4169/h"></a> <a href="http://www.php.net/manual/en/function.strpos.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.ob-start.php"></a> <a href="http://www.php.net/manual/en/function.tempnam.php"></a> <a href="http://www.php.net/manual/en/function.filesize.php"></a> <a href="http://www.php.net/manual/en/function.ob-end-clean.php"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#0000ff">if</font> ( <font color="#0000ff">isset</font> ( <font color="#cc6633">$ _POST</font> [ <font color="#008000">'file'</font> ], <font color="#cc6633">$ _POST</font> [ <font color="#008000">'file'</font> ] [ <font color="#008000">0</font> ])) { </li><li></li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ idx</font> = strpos ( <font color="#cc6633">$ _POST</font> [ <font color="#008000">'file'</font> ] [ <font color="#008000">0</font> ], <font color="#008000">"\ n"</font> )) { </li><li>  <font color="#cc6633">$ bound</font> = substr ( <font color="#cc6633">$ _POST</font> [ <font color="#008000">'file'</font> ] [ <font color="#008000">0</font> ], <font color="#008000">2</font> , <font color="#cc6633">$ idx</font> - <font color="#008000">2</font> ); </li><li></li><li>  <font color="#cc6633">$ body</font> = <font color="#008000">"MIME-Version: 1.0 \ nContent-type: multipart / form-data; boundary = {$ bound} \ n \ n"</font> . </li><li>  <font color="#cc6633">$ _POST</font> [ <font color="#008000">'file'</font> ] [ <font color="#008000">0</font> ]; </li><li></li><li>  <font color="#0000ff">unset</font> ( <font color="#cc6633">$ _POST</font> [ <font color="#008000">'file'</font> ] [ <font color="#008000">0</font> ]); </li><li>  <font color="#cc6633">$ f</font> = &amp; <font color="#cc6633">$ _FILES</font> [ <font color="#008000">'file'</font> ]; </li><li></li><li>  <font color="#cc6633">$ f</font> [ <font color="#008000">'name'</font> ] = <font color="#cc6633">$ f</font> [ <font color="#008000">'type'</font> ] = <font color="#cc6633">$ f</font> [ <font color="#008000">'tmp_name'</font> ] = <font color="#cc6633">$ f</font> [ <font color="#008000">'error'</font> ] = <font color="#cc6633">$ f</font> [ <font color="#008000">'size'</font> ]; </li><li></li><li>  <font color="#cc6633">$ msg</font> = mailparse_msg_create (); </li><li></li><li>  <font color="#0000ff">if</font> (mailparse_msg_parse ( <font color="#cc6633">$ msg</font> , <font color="#cc6633">$ body</font> )) { </li><li>  <font color="#cc6633">$ i</font> = <font color="#008000">0</font> ; </li><li></li><li>  <font color="#0000ff">foreach</font> (mailparse_msg_get_structure ( <font color="#cc6633">$ msg</font> ) <font color="#0000ff">as</font> <font color="#cc6633">$ st</font> ) { </li><li></li><li>  <font color="#cc6633">$ section</font> = mailparse_msg_get_part ( <font color="#cc6633">$ msg</font> , <font color="#cc6633">$ st</font> ); </li><li></li><li>  <font color="#cc6633">$ data</font> = mailparse_msg_get_part_data ( <font color="#cc6633">$ section</font> ); </li><li></li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ data</font> [ <font color="#008000">'content-type'</font> ] == <font color="#008000">'multipart / form-data'</font> ) { </li><li>  <font color="#0000ff">continue</font> ; </li><li>  } </li><li></li><li>  ob_start (); </li><li>  <font color="#0000ff">if</font> (mailparse_msg_extract_part ( <font color="#cc6633">$ section</font> , <font color="#cc6633">$ body</font> )) { </li><li>  <font color="#cc6633">$ tmp</font> = tempnam (sys_get_temp_dir (), <font color="#008000">'php'</font> ); </li><li>  file_put_contents ( <font color="#cc6633">$ tmp</font> , ob_get_clean ()); </li><li></li><li>  <font color="#cc6633">$ f</font> [ <font color="#008000">'name'</font> ] [ <font color="#cc6633">$ i</font> ] = <font color="#cc6633">$ data</font> [ <font color="#008000">'disposition-filename'</font> ]; </li><li>  <font color="#cc6633">$ f</font> [ <font color="#008000">'type'</font> ] [ <font color="#cc6633">$ i</font> ] = <font color="#cc6633">$ data</font> [ <font color="#008000">'content-type'</font> ]; </li><li>  <font color="#cc6633">$ f</font> [ <font color="#008000">'tmp_name'</font> ] [ <font color="#cc6633">$ i</font> ] = <font color="#cc6633">$ tmp</font> ; </li><li>  <font color="#cc6633">$ f</font> [ <font color="#008000">'error'</font> ] [ <font color="#cc6633">$ i</font> ] = <font color="#008000">0</font> ; </li><li>  <font color="#cc6633">$ f</font> [ <font color="#008000">'size'</font> ] [ <font color="#cc6633">$ i</font> ] = filesize ( <font color="#cc6633">$ tmp</font> ); </li><li></li><li>  <font color="#cc6633">$ i</font> ++; </li><li>  } <font color="#0000ff">else</font> { </li><li>  ob_end_clean (); </li><li>  } </li><li>  } </li><li>  } </li><li>  <font color="#0000ff">unset</font> ( <font color="#cc6633">$ f</font> ); </li><li></li><li>  mailparse_msg_free ( <font color="#cc6633">$ msg</font> ); </li><li>  } </li><li>  } </li></ol></blockquote>  I'm not quite sure about the publication of this article in the blog "PHP", perhaps the "HTML" would be more suitable, on the other hand, here is considered a way to use multiple downloads together in PHP. <br><br>  <b>PS</b> transferred to "Web Development", as suggested in the comments, really the blog is much closer to the topic. </div><p>Source: <a href="https://habr.com/ru/post/76749/">https://habr.com/ru/post/76749/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../76738/index.html">Code style</a></li>
<li><a href="../76742/index.html">Organization of on-line payments on the site. For those who have never done this, but are afraid that they will have to. Part 2: Architecture</a></li>
<li><a href="../76743/index.html">Dynamic promo in Magento</a></li>
<li><a href="../76744/index.html">Robots are dancing</a></li>
<li><a href="../76747/index.html">Transitional age, reality, reality or reality?</a></li>
<li><a href="../76750/index.html">Why does nothing change?</a></li>
<li><a href="../76752/index.html">Google Wave Invite</a></li>
<li><a href="../76756/index.html">10 TOPs of the Runet blogosphere, who with what came to the closure of TOP Yandex</a></li>
<li><a href="../76757/index.html">Using deb-packages for code distribution</a></li>
<li><a href="../76759/index.html">SmartyPDT 0.9.0 released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>