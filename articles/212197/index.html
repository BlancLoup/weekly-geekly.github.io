<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to set up Google Analytics to track user behavior broken down by User ID</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The work of the company EastBanc Technologies often faces the task of not just analyzing the statistics of attendance and behavior according to geogra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to set up Google Analytics to track user behavior broken down by User ID</h1><div class="post__text post__text-html js-mediator-article">  The work of the company EastBanc Technologies often faces the task of not just analyzing the statistics of attendance and behavior according to geographical, platform and demographic characteristics, but according to the principle that a particular user does on the portal, in the smallest detail.  For us, as for developers of corporate systems, this information is critical from the point of view of system development. <br><br>  For example, we now have a SharePoint portal in our work, which is used for remote settlement and financial services for contractors of the customer company.  Each counterparty has several users - from 1 to 10. We wanted to understand how they handle this or that functionality.  To describe their behavior for themselves, we used Google Analytics. <br><br><a name="habracut"></a>  Why we did not interview the focus group?  In our experience, polls are useless, as a result you always get distorted information, because  A certain percentage of people can get rid of a formal reply, dramatize or, on the contrary, put everything in a more rosy light, and finally, just lie unmotivated (and that, anything can happen :)).  An accurately tracked chain of user actions on the portal is what gives objective, relevant, useful information.  Also, good analytics help differently evaluate different groups of counterparties, among which there are both large enterprises and very small ones, and it is impossible to level them with the same brush. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Restrictions </h5><br>  As you know, Google prohibits to save data that can uniquely identify the user. <br><br>  We quote user agreement: <br><br>  <i>7.PRIVACY.</i>  <i>If you want to use your site, it‚Äôs not a problem. (or such third parties' website (s)).</i>  <i>It is your responsibility to ensure that your site has access to all websites.</i>  <i>Anonymous? Traffic?</i> <br><br>  To overcome these limitations and extend data for a more comprehensive analysis, Justin Cutroni, Analytics Evangelist at Google, <a href="http://cutroni.com/blog/2011/05/05/merging-google-analytics-with-your-data-warehouse/">suggests adding a user ID to Google Analytics</a> . <br><br>  In essence, it is proposed to identify the user with some unique GUID, then use <a href="http://ga-dev-tools.appspot.com/intl/ru-RU/explorer/%3Fcsw%3D1">Data Query Feed to</a> upload data to your system, match one-to-one correspondence with users and build analytics on your own. <br><br>  The big and most important ‚Äúbut‚Äù of such a decision is difficult, expensive and inconvenient.  Obviously, it‚Äôs not easy to implement something like Google Analytics for viewing reports on your side, and is simply an inefficient waste of money. <br><br><h5>  Decision </h5><br>  That is why, we began to look for another way, and as a result we got the following: <br><br>  1. All contractors are identified by a contract number or a number in the accounting system, all users are equal to it.  Thus, it is possible to use this number, which is not personal data, to identify users. <br><br>  2. By default, the <a href="https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables%3Fhl%3Dru">variable "visitor"</a> is selected. <br><br>  Any analytics can now be carried out in the context of all user counterparties.  To do this, on the pages of Google Analytics, in the sections that require filtering / grouping / adding to the display, you must select the My variables-&gt; My variable parameter (value 01). <br><br>  Additionally, we divided users by language and divided counterparties and employees of the client company.  Tracking on language goes automatically due to the choice of a standard method of installation of a location of the user. <br><br>  The division into users into contractors and employees of the client company occurs using the ‚Äúuser token‚Äù: <br><br><pre><code class="cs hljs">authenticated = Tools.IsUserIdentified(<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> agencyCode); marker = authenticated ? (agencyCode ?? <span class="hljs-string"><span class="hljs-string">""</span></span>):<span class="hljs-string"><span class="hljs-string">""</span></span>;%&gt;     -: _gaq.push([<span class="hljs-string"><span class="hljs-string">'_setCustomVar'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;%=marker%&gt;'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre> <br><br>  Thus, we look at the attempt to authorize the user and get / do not get the counterparty code.  If you are not logged in, we regard it as an anonymous;  logged in, but the agent code did not return - as an employee;  the counterparty code returned is the counterparty. <br><br>  3. Added page level tracking.  In each master page of our SharePoint portal, we added code that tracks this variable: <br><br><pre> <code class="cs hljs">_gaq.push([<span class="hljs-string"><span class="hljs-string">'_setCustomVar'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;%=marker%&gt;'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre><br><br>  4. Added tracking on WCF-services damage: we linked the counterpart codes to the page view, but within one page the counterpart can perform many actions.  Calls to WCF go through a special layer of services.  Until now, this has given us two advantages: you do not need to copy the cumbersome code by organizing ajax calls and you can do error handling in a single style at the expense of the error handler in the base class.  That is, the code that needs data is not polluted by small technical details. <br><br>  Through the same services, we also posted event tracking in case of successful completion of the call.  All this works on promises, so the introduction of this functionality in the service did not require any changes in the code-consumer. <br><br>  We have created the following custom categories and types of events within the category (this is done according to the GA standard). <br><br>  Category List: <br><br>  a.  MakeToDo <br>  b.  Exchange rates <br>  c.  Dashboard <br>  d.  Payments <br>  e.  Accounts <br><br>  List of events that we track: <br><br>  a.  View list <br>  b.  View object <br>  c.  Deleting an object <br>  d.  Object change <br>  e.  File upload <br>  f.  Acceptance of a settlement document <br>  g.  Cancellation / renewal of an account. <br><br>  (Recall that this system, which we consider as an example, regulates the settlement and financial relationship between contractors and the customer company, this is due to the names of categories and events). <br><br>  Take for example one event: <br><br><pre> <code class="cs hljs">getDocumentsList = function (data) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dispatcher.call( { method: ETR.HttpVerb.POST, data: data, relativeUrl: serviceRelativePath + <span class="hljs-string"><span class="hljs-string">'/documentsList'</span></span> }) .fail(dispatcher.faultHandler) .done(function () { ETR.gatc.track(ETR.gatc.categories.JustificationDocuments, ETR.gatc.actions.ListBrowsing); }); };</code> </pre><br><br>  5. In order to see which agents have what actions and in what scope were performed on the portal, you need to go to the Behavior-&gt; Events-&gt; Event Map and in the left corner of the screen in the green drop-down list select My Variables-&gt; My Variable (value 01 ).  We get about the following picture: <br><br>  Clickable image <br>  <a href="">&lt;</a> <a href=""><img src="//habrastorage.org/files/26b/74f/d8e/26b74fd8e2fe47fca260a83254504b29.png"></a>  <a href="">"&gt;</a> <br><br><h5>  What we got in the end: </h5><br><ol><li>  We track visits to all pages of the customer‚Äôs settlement and financial system. </li><li>  Analytics, among other things, is conducted in the context of languages ‚Äã‚Äã(there are two of them now - Russian and English). </li><li>  Analytics is conducted in the context of counterparties.  In order to see the history of visits, go to the section Personalized-&gt; Variables, there we see the section Users.  Going into it, we see about the following image: </li></ol><br><br>  Clickable image <br>  <a href="">&lt;</a> <a href=""><img src="//habrastorage.org/files/973/0c1/0a0/9730c10a05b24e4c9689d17c5f79d72e.png"></a>  <a href="">&gt;</a> <br><br>  Analytics is conducted, first of all, by counterparties.  Also, separate items are anonymous users and employees of the customer company. <br><br>  Why was it important for us to get a solution that will allow us to accurately assess how users behave on the portal?  Because it is important for us to understand whether people use, the interfaces we create, the modules, the business processes as it was intended. <br><br>  And don't forget about another important factor: we spent very reasonable time and effort on setting up Google Analytics properly, using completely standard tools.  Everything, as we love :) </div><p>Source: <a href="https://habr.com/ru/post/212197/">https://habr.com/ru/post/212197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212175/index.html">Wallet words around us</a></li>
<li><a href="../212177/index.html">Curiosity crossed the sand dunes without problems</a></li>
<li><a href="../212179/index.html">FAQ about solution centers - how big companies in Russia choose software so as not to step on a rake</a></li>
<li><a href="../212185/index.html">Found the oldest known stars</a></li>
<li><a href="../212195/index.html">February 11 protest against NSA mass surveillance</a></li>
<li><a href="../212203/index.html">Dialogues without cuts: the first informal meeting of application developers in Moscow</a></li>
<li><a href="../212207/index.html">Kinnex Element - a platform for WebRTC conferences</a></li>
<li><a href="../212209/index.html">Upgrade Java Development Tools for Windows Azure</a></li>
<li><a href="../212211/index.html">Prevalence of servers and server programming languages ‚Äã‚Äãin Runet</a></li>
<li><a href="../212213/index.html">Injector RMIP48-8LP with integrated lightning protection, replenishment in the family of multiport PoE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>