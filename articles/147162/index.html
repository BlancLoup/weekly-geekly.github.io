<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Publishing an ASP.NET MVC site to updated Windows Azure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It's no secret to anyone that on July 6th, Microsoft expanded Russian capabilities to work with Windows Azure and provided access to preview technolog...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Publishing an ASP.NET MVC site to updated Windows Azure</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/37b/965/4e6/37b9654e66f4fd21c75a90340feab637.png" alt="image"><br>  It's no secret to anyone that on July 6th, Microsoft expanded Russian capabilities to work with Windows Azure and provided access to preview technologies.  I want to tell about one of these technologies in this post. <br>  Just want to say that most of the information is taken from the official manual and adapted to the perception by example.  The original is written in English, so the Russian version does not hurt. <br><a name="habracut"></a><br><h4>  Step 1. Getting access </h4><br>  In order to use the new features of Windows Azure, you must first subscribe to a regular subscription.  Now there is an opportunity to get a <a href="http://www.windowsazure.com/ru-ru/pricing/free-trial/">free subscription</a> for 90 days, which includes some amount of computing power and functions. <br><br>  After receiving a subscription, you need to add new features to it.  This is done on your account page in the <a href="http://account.windowsazure.com/PreviewFeatures">Preview Components</a> section.  At the moment we are interested in the possibility of using websites, so feel free to click the Try It Now button in the appropriate section, after which you will be asked to choose a subscription to which you want to add this feature.  We choose our subscription, click on the check mark and this is done - you will receive a confirmation email, and a new section will appear in the cloud control panel. <br><br>  Here it is worth making retreats and say a little about the <a href="https://manage.windowsazure.com/">updated interface of</a> the Windows Azure subscription control panel.  If you used it before, then you must have been unhappy that it was written in Silverlight, which slowed down, was tangled, ugly, etc.  (well, at least I was unhappy).  Now it's all in the past.  The new subscription management portal is written using modern web technologies and does not require any plug-ins.  One word - HTML5 to the masses :) <br><img src="https://habrastorage.org/storage2/1b9/708/397/1b9708397ba845fcd736dd31e82e388b.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Step 2. Creating a website </h4><br>  So, after we entered the subscription management portal, we can now select the Web Sites section in the left pane.  Now there will be empty, that we will try to fix it.  At the bottom of the page there is a large + New button, when clicked, a menu opens with a selection of resources available for creation.  Go to the section <i>WEB SITE</i> and select the item <i>CREATE WITH DATABASE</i> : <br><img src="https://habrastorage.org/storage2/f3a/8b4/f12/f3a8b4f1234cbb2025349c73d59fb4d9.png"><br><br>  A wizard window will open to us, which will prompt us to choose the name of the future site, as well as the database settings - use an existing one or create a new one (SQL Server or MySQL): <br><img src="https://habrastorage.org/storage2/01c/fca/821/01cfca8216db3edc5ea658c905ecebc8.png"><br><br>  In the second and third steps, we will have to specify the parameters of our future database, the default encoding, the login and password, and the geographical area where our virtual machine will be located.  I chose Western Europe, more options are available from North Europe and US. <br><br>  After you finish entering the settings for the new site and database and click the tick in the last step of the wizard, you will return to the subscription control panel, which will now contain information about your new resources: <br><img src="https://habrastorage.org/storage2/a11/00c/3bc/a1100c3bc57e9881342b323791ce3c5c.png"><br><br>  Pay attention to the Status column.  If everything went well, then after some time (I had a couple of minutes) the web site will be in the Running state, and the database will be in the Online state.  This means that now you can safely publish your application to the cloud. <br><br><h4>  Step 3. Publishing the site </h4><br>  In the official documentation for publishing sites in Windows Azure Web Sites, before this section there is still a rather extensive instruction for creating ASP.NET MVC 4 applications, which takes up almost half of the entire text.  I will not describe in detail the process of creating a web application in Visual Studio, and I will confine myself to a simple spell: <br>  <i>File -&gt; New -&gt; Project -&gt; Web -&gt; ASP.NET MVC 4 Web Application -&gt; Internet Application</i> <br>  Who understood, he understood, and who did not understand, at the end of the article there will be links to original materials, where all this is described in pictures. <br><br>  After we created the site, we can start publishing it in Azure.  First we need to get information about which connection parameters to use in our project.  Windows Azure carefully provides us with the ability to import all the necessary settings into our application in a couple of clicks.  Go to the subscription control panel in the Web Sites section and select our new site in the list.  You will see a control panel similar to this: <br><img src="https://habrastorage.org/storage2/851/d86/461/851d86461fcbd76164a1ba2331420f00.png"><br><br>  On the right side, where Quick Glance is written, there is the Download publish profile item.  After clicking on it, we will be prompted to save the file with the .PublishSettings extension, which we will do.  Go back to Visual Studio and right click on the web application project, Publish item: <br><img src="https://habrastorage.org/storage2/2a9/833/203/2a9833203f318e9c101bf4f7ddcf0500.png"><br><br>  In the window that appears, click the Import button and select the freshly downloaded file.  Go ahead.  In the next step, you do not need to change the settings, but you should click the Validate Connection button to make sure that everything is connected correctly: <br><img src="https://habrastorage.org/storage2/e06/aaa/ce4/e06aaace43a836a21f1be759ec98509b.png"><br><br>  In the next step of the wizard, select the configuration that we want to upload to the server.  This is usually Release, although some prefer to use Debug.  If you belong to such people, do not forget to change the setting.  We will not touch the connection string to the database, as our application does not use the database yet. <br><br>  Go to the next and last step of the wizard: <br><img src="https://habrastorage.org/storage2/dc6/d2c/256/dc6d2c2569d0857ed763b8f70416d470.png"><br><br>  If you click on the Start Preview button, you can see a list of all the files that will go on publication at this moment.  For example, the screenshot below shows that only one file was changed and only one file will be sent to the server: <br><img src="https://habrastorage.org/storage2/075/0de/5a0/0750de5a08a8efca1d30c844874d11de.png"><br><br>  We press the Publish button, after which Visual Studio forms the necessary package and sends it to our server in Azure.  When the process is complete, the website with your application should automatically open. <br><br><h4>  Step 4. Adding DB </h4><br>  And again in the official manual a large number of pictures and descriptions are devoted to this section.  I hope that most of you know how to work with databases in .NET and are familiar with the Entity Framework (because I used it and Windows Azure also implies it). <br><br>  We assume that you have added EF-based database functionality to your application.  We must somehow start it now.  Remember when publishing a site, we missed the section responsible for working with the database?  It's time to return to it and consider in more detail: <br><img src="https://habrastorage.org/storage2/bd3/124/311/bd31243119da127c950431730c0d0a80.png"><br><br>  In the Databases section, you can see all your connection strings that are declared in the Web.config file.  I have two lines here.  The first is the connection string for EntityFramework.  And there is an interesting option called Apply Code First Migrations.  Who is following the EF update knows that the migration function has been added to the new version of EF, which allows the code to determine the difference between the two versions of the database and apply the necessary changes to an existing database without recreating it.  So, when publishing to Windows Azure, you have the opportunity to use migrations and create a database in the same way as you publish your application.  To do this, you just need to allow migration in your application and check the box (I‚Äôm not enabled, so the daw is inactive). <br><br>  In the connection string field, you can select the required string that will appear in the published application.  Windows Azure itself has already formed the necessary string in the publication profile, so you just have to select it from the list of available connection strings and use it.  However, you have the right to modify it in any way you like or to choose any other row if you decide to use a database outside Azure. <br><br><h4>  Conclusion </h4><br>  Here are all the simple and few steps that you need to take in order to publish your ASP.NET MVC application to the new Windows Azure Web Sites.  Absolutely nothing complicated, the whole procedure takes no more than 10-20 minutes (if everything went smoothly and without bugs). <br><br>  It is worth saying about some limitations that currently exist in Windows Azure (translated from the documentation): <br><ul><li>  The application should use only .NET 4. Unfortunately, .NET 4.5 is not supported yet, which is a pity (I ran into this item personally and caught the error while publishing) </li><li>  The application will work in integrated mode (not classic) </li><li>  Application should not use Windows authentication </li><li> If you want to use various provider-based capabilities, then use ASP.NET Universal Providers (System.Web.Providers package from NuGet). </li><li>  If the application writes to files, then these files should be located in the application's content folder. </li></ul><br><br>  That's probably all that is worth saying.  I hope the article will be useful and you will publish your site in the Windows Azure cloud as easily as I did. <br><br>  You can see how the application works in the cloud at <a href="http://prog-facts.azurewebsites.net/">http://prog-facts.azurewebsites.net/</a> .  I would be glad to habra testing and using the site (I wrote for training, but it would be nice if the idea developed further). <br><br><h4>  useful links </h4><br>  <a href="http://www.windowsazure.com/">Windows Azure official website</a> <br>  <a href="http://www.windowsazure.com/ru-ru/pricing/free-trial/">Free subscription info</a> <br>  <a href="http://account.windowsazure.com/PreviewFeatures">Component preview</a> <br>  <a href="https://manage.windowsazure.com/">Windows Azure Subscription Management Portal</a> <br>  <a href="https://www.windowsazure.com/en-us/develop/net/">Materials for .NET developers for Windows Azure</a> <br>  <a href="https://www.windowsazure.com/en-us/develop/net/tutorials/web-site-with-sql-database/">Instructions for publishing web applications in Azure</a> </div><p>Source: <a href="https://habr.com/ru/post/147162/">https://habr.com/ru/post/147162/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147155/index.html">Webit Startup Challenge 2012 in Istanbul. Will there be Russian startups?</a></li>
<li><a href="../147156/index.html">Microsoft engineer revealed spam botnet on Android</a></li>
<li><a href="../147157/index.html">GMC-4 microcomputer</a></li>
<li><a href="../147160/index.html">PC / Mac sales ratio drops to 1985 level</a></li>
<li><a href="../147161/index.html">Debriefing - Episode 22 - Regardless of Dependencies</a></li>
<li><a href="../147164/index.html">Remote computer RESET using a mobile phone</a></li>
<li><a href="../147165/index.html">Transparent pixels also have png's feelings or artifacts with transparency.</a></li>
<li><a href="../147167/index.html">Review of a mouse combine Canon X Mark I Mouse</a></li>
<li><a href="../147168/index.html">Musical piracy is NOT a problem, it's an excuse.</a></li>
<li><a href="../147170/index.html">Innovation KYOCERA (Part 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>