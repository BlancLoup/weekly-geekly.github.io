<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Auto-generation of powershell scripts</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All sooner or later come to the desire to shift boring and monotonous work on the "shoulders" of the computer. For example, this feeling came to me wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Auto-generation of powershell scripts</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a2f/5ed/ec8/a2f5edec88094666b328f3691ef2c427.jpg" align="left">  All sooner or later come to the desire to shift boring and monotonous work on the "shoulders" of the computer.  For example, this feeling came to me when I began to implement Active Directory in an organization for 100+ employees.  Adding and filling in all the fields for a large number of users manually is a terribly tedious and long task.  Of course, the first thing I did was turn to powershell, but the process of writing the script somehow took too long and in the end nothing good came out.  Dreams to have a beautiful and neat catalog of users remained dreams.  Until I got excited about the idea of ​​automating the creation of powershell scripts. <br clear="left"><a name="habracut"></a><br>  Millions of administrators around the world, like me, catch the same bugs in thousands of identical scripts for the same standard tasks.  It's amazing that before me, none of them decided to close this question once and for all, creating an automatic generator of poweshell scripts.  If we can deploy a dozen servers a day, then teaching a computer to write a script without errors is definitely not a problem. <br><br><h4>  Closer to the point </h4><br>  In short, I put together such a script autogenerator and it is ready for beta testing.  It is called <i>d-lera</i> ( <a href="http://d-lera.com/">d-lera.com</a> ) and its main function is to eliminate the stage of writing script code, the longest and most tedious process when using powershell.  Instead, the administrator fills out a fairly simple form — from this data, a ready-made powershell script is generated and saved automatically. <br><br>  The project has just hatched, and now it is able to generate a simple and convenient script for creating users in Active Directory.  I admit, I would like to hear from the commentators in the comments that they are now working incorrectly and what functions are needed “on the fields” in the first place.  Go? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  RTFM.txt </h4><br>  On a simple example, I will show how everything works.  Suppose we have an organization with the uncomplicated name "Koteikins Firewood".  There are two departments in it: “Shaggy sawmill” and “Mustached accounting”. In the first section there is one telephone number, and the second one is located in two offices at once, each with its own telephone. <br><br>  It turns out this structure: <br><br><img src="https://habrastorage.org/files/c42/c21/b7e/c42c21b7e213406d82bd6bbf15119410.PNG"><br><br>  It is worth paying attention.  that this structure does not necessarily have to repeat the structure of divisions in Active Directory. <br><br>  Open the page <a href="http://d-lera.com/adusercreate">http://d-lera.com/adusercreate</a> , click "Create organization", enter the name.  A root unit is created in which the “Organization” attribute is automatically filled: <br><br><img src="https://habrastorage.org/files/5d4/2fd/e17/5d42fde17f9a40b4a6454f5403dde8ce.PNG"><br>  In the field "Address in the directory" enter the address of the root unit (Organization Unit) in the directory Active Directory, where we store users.  Do not add the domain address.  We configure attributes that are the same for the whole organization: address, website address, account settings. <br><img src="https://habrastorage.org/files/cae/507/ddd/cae507dddc0b4e7ca49db9b71ac64651.PNG"><br><img src="https://habrastorage.org/files/920/4f6/a04/9204f6a0438d42259080f429ec50d5d7.PNG"><br>  After that, we add two departments, “Shaggy power-saw bench” and “Mustache accounting”.  When creating departments, all the settings of the parent are copied, but some attributes are updated automatically: <br><img src="https://habrastorage.org/files/1a7/b4d/862/1a7b4d862b5641fe94585283e9ec4638.PNG"><br>  Fill in the same way the heads of departments (you need to enter the login of the account of the head of the department without the domain prefix) and shadow groups, and for “Shaggy power-saw benches” we also fill out the telephone and the office: <br><div class="spoiler">  <b class="spoiler_title">Shadow groups</b> <div class="spoiler_text">  Sometimes it is necessary that the accounts of employees of the entire department are members of any security group.  When the “Shadow group” parameter is filled in, after creating an account, the generated script will automatically add it to the specified group. </div></div><br><img src="https://habrastorage.org/files/059/dfb/078/059dfb07875a44f5b8be2fc78fbccf6d.PNG"><br><img src="https://habrastorage.org/files/835/8c9/82d/8358c982dc8144ff9d928409348be47f.PNG"><br>  And now let's use the fact that when creating a script, the structure of divisions does not have to correspond to the structure of divisions in the Active Directory.  In the “mustache accounting” we create two subsidiary divisions: “Mustached accounting: sour cream room” and “Mustached accounting: room with threads” and each of them fill in your phone and office: <br><img src="https://habrastorage.org/files/84f/0d9/893/84f0d989361f4e6cabe3ac5efa26e78e.PNG"><br>  Do not forget that when creating subsidiaries, some fields are filled in automatically.  Manually delete the added address levels, and for the name of the department, select “update all subsidiary units” in “Usatoy accounting”: <br><img src="https://habrastorage.org/files/3ae/628/dfa/3ae628dfaee44f1d9afd9aa928487775.PNG"><br>  And here we suddenly remember that when creating an account we want to enter an e-mail, and of course a password.  Therefore, in Koteikins Firewood, check the checkbox for manual entry of a post and password and update all of its subsidiaries (only immediate heirs are updated, therefore, for Mustache Accounting, you must also press the update button): <br><img src="https://habrastorage.org/files/9df/cf7/0b5/9dfcf70b51ed424cba90eae9cc05d2fb.PNG"><br><img src="https://habrastorage.org/files/124/a43/76c/124a4376c54645ccb24f85dc76dbd233.PNG"><br>  And lastly: we’ll tick the “Resolve creation of users in this department” checkbox in “Kotekins Firewood” and “Usatoy Accounting”, so that the script would not suggest creating users there: <br><img src="https://habrastorage.org/files/bde/c79/306/bdec79306fbf4f759f9d05ae2ff2a56e.PNG"><br>  No one wants to immediately disclose all information about the organization's domain on the first website on the Internet, so after saving the script, you must open it with any text editor and correct the first two lines by entering the name of your Active Directory domain.  Save, run: <br><img src="https://habrastorage.org/files/691/95c/f2b/69195cf2b3414451b8f9d7b523263444.PNG"><br><img src="https://habrastorage.org/files/acd/a89/4e6/acda894e69504ab4a96aea1aa631f5f9.PNG"><br><img src="https://habrastorage.org/files/30e/684/af0/30e684af089e4b83bd6cff20071a217b.PNG"><br><br><h4>  Plans for the near future </h4><br><ul><li>  Ability to save configuration </li><li>  Script signing.  Now they are generated unsigned.  How to sign yourself can be read, for example, <a href="http://habrahabr.ru/post/137884/">here</a> </li><li>  Attribute constructors: so that, for example, a login is automatically compiled from a template based on a first and last name and translated from Russian into translit </li><li>  Combined input of multi-valued attributes: entered value + preset value (for example, input of an individual internal phone number + common city number) </li><li>  Scripts to update existing users, create users from Excel or .CSV </li><li>  Add custom Active Directory user attributes </li><li>  Exchange, SharePoint support </li><li>  Exploring and adding scripts for various other standard tasks. </li></ul><br><br>  PS I invite everyone to <a href="http://d-lera.com/">potestit</a> and I will be very grateful for any suggestions / suggestions / comments.  You can write to <a href="">admin@d-lera.com</a> , in a personal, in the comments and generally anywhere - we are still on the Internet <br><br>  Since  information about the organization's Active Directory is information of a rather intimate nature, then your opinion is very important: </div><p>Source: <a href="https://habr.com/ru/post/234979/">https://habr.com/ru/post/234979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234965/index.html">Google sued $ 1.3 million from the patent troll</a></li>
<li><a href="../234969/index.html">Yandex.Money decanting inactive user accounts</a></li>
<li><a href="../234971/index.html">Alibaba IPO: what investors will actually buy</a></li>
<li><a href="../234975/index.html">Make bittorrent better</a></li>
<li><a href="../234977/index.html">PowerToFly - search for remote work for women</a></li>
<li><a href="../234981/index.html">Zephyr-7 solar-powered unmanned aircraft stayed in the air for 11 days in winter conditions</a></li>
<li><a href="../234983/index.html">E-commerce platform. Part 2. What is Demandware and what is it eaten with?</a></li>
<li><a href="../234985/index.html">Rospotrebnadzor is going to regulate the physical parameters of electronics</a></li>
<li><a href="../234987/index.html">A little creative - calendar with antipatterns</a></li>
<li><a href="../234993/index.html">Let's talk for Hadoop</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>