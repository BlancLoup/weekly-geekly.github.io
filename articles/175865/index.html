<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability contest, or Break me completely!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On March 19, we announced the start of the vulnerability search month ‚ÄúCheck Badoo for Strength‚Äù . Today, we would like to take the first results and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability contest, or Break me completely!</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/5a6/c83/af1/5a6c83af14b2d8192b68d643e548adc6.jpg" align="left">  On March 19, we announced the start of the vulnerability search month <a href="http://habrahabr.ru/company/badoo/blog/173393/">‚ÄúCheck Badoo for Strength‚Äù</a> .  Today, we would like to take the first results and share with you intermediate results, tell you how we prepared for a strength test, examine the most interesting vulnerabilities, and make a feyspalm. <br><br>  <b>And first, some statistics:</b> <br><ul><li>  in the first two weeks, participants sent us almost 500 applications with potential vulnerabilities; </li><li>  about 50 applications were duplicates; </li><li>  every tenth application contained a real vulnerability (the most dangerous were corrected within a few hours); </li><li>  More than 150 applications amounted to errors that are not related to the security of the site, and about 10% of them are related to platforms that do not participate in the competition. </li><li>  most of the vulnerabilities accounted for the most important component of the system ‚Äî the profile (as soon as the contestants did not mock user accounts: they deleted and uploaded photos, manipulated comments, interests, personal data and email addresses). </li><li>  More than half of the submitted vulnerabilities are various CSRFs, mainly affecting content uploaded or written by users (deleting and uploading photos and comments, working with a blacklist, favorites, etc.). </li></ul><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Graph of types of vulnerabilities and their distribution by components on the site</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/b05/17f/eb6/b0517feb6ee1d47c114a9969a0358c2f.png"><br><br><img src="https://habrastorage.org/storage2/480/935/59c/48093559c8579adacb23b27e370f78bc.png"><br></div></div><br><h3>  How we prepared for the contest ... </h3><br>  A few months ago, we embedded global XSS protection throughout the site.  Immediately make a reservation that it is not a panacea and does not cover 100% of vulnerabilities.  Its goal is to help the developer prevent a random error.  The essence of the method lies in the automatic screening of absolutely all variables that are output through the <a href="http://alexeyrybak.com/blitz/blitz_ru.html">blitz</a> , except for those moments when the developer specifically allows the output data to appear in unshielded form. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The most interesting and the only full-fledged XSS recognizability was found in the output of additional SEO content in an unauthorized profile.  Some profile data (mainly the ‚ÄúAbout Me‚Äù field) for various SEO needs was added to one of the meta tags.  At this point, the output of raw data was once allowed, which allowed for an attack.  Since the vulnerability worked only for unauthorized users, we assigned the first (least dangerous) category to it: it was impossible to get any confidential data through it.  The only sensible uses that come to mind are to use account data as an <a href="http://cwe.mitre.org/data/definitions/601.html">open redirect</a> for further phishing, but in this case you need to be sure that the user is not currently on the site. <br><br><h3>  ... and how not prepared. </h3><br>  In 2013, the <a href="https://www.owasp.org/">OWASP</a> project lowered the CSRF attack rating by three points, despite the general growth of its popularity and the lack of protection of many large web projects.  The essence of the attack is simple: when you go to a special page with a form containing a POST or GET request, you can change the content or account settings under a user session.  In this place, everything was not as good as we would like.  Only part of the functionality on the site (authorization, exit, change of personal information, etc.) was protected by unique session tokens.  As soon as the first ten reports about this bug arrived, it became obvious that the problem had to be solved entirely.  Within a few days after the start of the competition, we posted another global protection: all web services on the authorized part of the site began to check for the presence of tokens in POST or GET requests to them.  With this fix, we closed most of the CSRF applications. <br><br>  Next we look at some of the most interesting vulnerabilities and give comments to the participants <a href="http://corp.badoo.com/security-board">who found them</a> . <br><br><h4>  Vulnerability in processing the number of credits at purchase (BSI-13) <br>  The author: <a href="http://ru.linkedin.com/pub/%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25BE%25D0%25BB%25D0%25B0%25D0%25B9-%25D0%25B5%25D1%2580%25D0%25BC%25D0%25B8%25D1%2588%25D0%25BA%25D0%25B8%25D0%25BD/69/983/83">Nikolai Ermishkin</a> (Asd) <br>  Category: 5 </h4><br>  Why did we assign this vulnerability a fifth, highest degree of importance?  Because it turned out to be so easy to use that it did not require any special skills and tools other than the browser and any debug console for it.  The form for selecting the number of credits looked like this in the HTML code: <br><br><pre><code class="html hljs xml">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-ga-ev</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100  - 45,00."</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-ga-ev</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"550  (50 !) - 200,00."</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"550"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">selected</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"selected"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-ga-ev</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1250  (250 !) - 450,00."</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1250"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-ga-ev</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2750  (750 !) - 900,00."</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2750"</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre> <br>  It turned out that the value of the value field was used directly!  Replacing it with almost any number, it was possible to make a payment in the amount of 220 rubles and get this amount of credits to your account.  The vulnerability was fixed in a few hours, and the user with the nickname Asd came in first place in our internal top as the first to discover the vulnerability of the highest degree of significance. <br><br><div class="spoiler">  <b class="spoiler_title">Comment asd</b> <div class="spoiler_text"><blockquote>  ‚ÄúAt first, I simply walked through different sections of the site, tried to change the values ‚Äã‚Äãof the parameters in the queries, but it was expected that a serious vulnerability such as sql injection could not be found in a project of this level.  I remembered the study <a href="http://habrahabr.ru/post/117039/">habrahabr.ru/post/117039</a> , in which the authors searched for vulnerabilities not directly on the sites, but even Amazon had not survived during their interaction with third-party services and during it.  Searching for similar interactions on badoo, I found them in several places - import of contacts, account confirmation, payment of credits and super powers.  Having visited the credit purchase page, I discovered the possibility of payment in several ways, and the schemes of interaction with payment systems differed very much. <br>  I decided that it was quite realistic to make a mistake in one of them and began to investigate in more detail.  First I chose webmoney, since I had a wallet at hand with a small amount of money.  As far as I understand, the purchase is made as follows: the user selects one of the possible options (100, 550, 1250, 2750), his choice is saved somewhere in the internal account on the site, after which the user makes a payment on the webmoney site, during which the paid account It is compared with the saved one, and if they match and the payment is successful, the user receives his credits.  Having looked at what parameters are transmitted when saving the account, I noticed that the number of paid loans is transferred directly, and not a certain value, denoting one of 4 possible options.  Replacing it with a large number, I received a correct response from the server, with an invoice of 7.5wmz (standard price for 550 credits) and the number of credits I indicated.  I paid it - and the credits turned out to be on my account, though in a slightly reduced form - only 2147483647 ‚Äù. <br></blockquote><br></div></div><br><br><h4>  Misconfiguration when changing profile data (BSI-12) <br>  Posted by: <a href="http://whitebureau.ru/">whitebureau</a> <br>  Category: 5 </h4><br>  On the same day, another serious breach was found by the whitebureau user.  When interacting with profiles of other users (displaying additional information, performing any actions), the cuid (current user id) parameter, which indicated the ID of this user, was passed in the request parameters. <br><br><pre> <code class="hljs objectivec">GET http:<span class="hljs-comment"><span class="hljs-comment">//badoo.com/ws/profile-ws.phtml?section=pimore&amp;cuid=31337</span></span></code> </pre><br>  These interactions were carried out through the same controller that was responsible for editing the profile, the differences were only in the action action, and whitebureau tried to add this userid parameter with an arbitrary value to the user editing request. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">POST</span></span> http://badoo.com/ws/profile-ws.phtml ... section=interested_in&amp;interested_in_text=cats&amp;cuid=<span class="hljs-number"><span class="hljs-number">31337</span></span></code> </pre><br>  It turned out that checking this parameter against the current user ID was skipped when editing a profile.  So we have a second critical vulnerability. <br><br><div class="spoiler">  <b class="spoiler_title">Comment whitebureau</b> <div class="spoiler_text"><blockquote>  Such errors are often found on large projects.  And in particular on projects actively working with ajax.  There is a confusion with superglobal php variables: developers use $ _REQUEST with all http request variables, instead of the more accurate $ _GET, $ _POST or $ _COOKIE.  As a result, an attacker can very simply disorient the code by replacing the desired variable in a post or get request.  The script will not notice the substitution. </blockquote><br></div></div><br><br><h4>  Clickjacking on all pages of the site (BSI-9) <br>  By: Eugene Farfel <br>  Category: 1 </h4><br>  We also received reports of non-critical, but interesting vulnerabilities.  One of them was the possibility of so-called clickjacking (English clickjacking) on ‚Äã‚Äãall pages of the site. <br>  This term was first used by Jeremiah Grossman (English Jeremiah Grossman) in 2008, but so far few people thought about the significance and consequences of this vulnerability.  What is clickjacking?  As the OWASP says, ‚ÄúIt‚Äôs a redistress attack‚Äù, it‚Äôs not a problem. top level page. <br><br>  Simply put, you can show the site inside an iframe by blocking some of its elements with transparent div tags containing click handlers.  In this way, it is possible to force an unsuspecting authorized user to perform arbitrary actions. <br><br>  One of the most well-known methods of protection is called "framebusting".  It checks the opening of the page inside the iframe using Javascript.  If the address of the current page is different from what is written in the address bar of the browser, the redirection is performed: <br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> frameBusted = (top != <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (frameBusted) top.location.href = <span class="hljs-string"><span class="hljs-string">'/index.htm'</span></span>;</code> </pre><br>  As it turned out later, this method can be circumvented in most modern browsers: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sandbox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://badoo.com/&gt;&lt;/iframe&gt;</span></span></span></span></code> </pre><br>  Therefore, since 2009, all modern browsers (even IE) support the X-Frame-Options header, in which you can completely prohibit inserting a site into an iframe, or allow this functionality only for a specific list of domains. <br><br>  Is your site protected from clickjacking? <br><br><div class="spoiler">  <b class="spoiler_title">Comment by Eugene Farfel</b> <div class="spoiler_text"><blockquote>  Today, almost all Internet resources are subject to similar Clickjacking vulnerabilities.  The process of finding them is not particularly difficult, there is a general rule - if a resource does not use the X-Frame-Options header in its responses, then the existence of the possibility to embed it in a frame with the subsequent creation of various kinds of phishing pages is almost guaranteed.  Thus, the vulnerability can be considered found by the results of viewing HTTP-headers. <br>  A study of the .js files used by Badoo showed that a common but erroneous method of replacing the window.top.location property was used to exit the frame.  When using this method, the page that embeds Badoo in a frame received an onload event and could take action to counteract it.  One of such measures is browser redirection to the address returned with response code 204. A request to such a URL does not lead to navigation in the browser (the page with the frame remains open), but also cancels the attempt of the Badoo code to replace location. <br>  The first patch introduced by Badoo supplemented this code by replacing the body of the page inside the frame with a blank line.  This fix, although it did not solve the problem of embedding in a frame, removed all the contents from it and made it impossible to create phishing pages.  This fix was also easily managed using the sandbox attribute of the iframe tag, which disables javascript in the frame. <br>  In principle, the only way to protect against Clickjacking attacks is to use the X-Frame-Options header for all pages for which it is not supposed to embed a frame and confirm all actions that change the state of the system on pages that imply embedding in a frame. </blockquote></div></div><br><br><h4>  CSRF and Custom Email Changes (BSI-38) <br>  Posted by: <a href="http://habrahabr.ru/users/graphite/" class="user_link">graphite</a> <br>  Category: 3 <br>  (partly about this vulnerability is in BSI-21, author Ilya Kiel) </h4><br>  This is what we did not expect, so these are descriptions of how to change the email address for an arbitrary user.  But in one day, as many as three descriptions of various vulnerabilities related to the re-send password component came, with which it was possible to change the user's mailbox, that is, to ‚Äúhijack‚Äù his account. <br>  There is a form for re-sending the password during registration, in which you can change your email if a typo crept into it.  It turned out that the user can even change the already confirmed email address using the CSRF: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">http://eu1.badoo.com/not_confirmed/</span></span></span><span class="hljs-tag">" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"newemail"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"attacker@somemail.com"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">$(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#form'</span></span></span><span class="javascript">).submit();</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  There were several ways to fix the vulnerability: <br>  1. Add a verification for confirmation. <br>  2. Add a CSRF token. <br>  3. Add a captcha. <br>  Since the module is critical, all three methods were applied, and users who found vulnerabilities were rewarded. <br><br><div class="spoiler">  <b class="spoiler_title">Comment Graphite</b> <div class="spoiler_text"><blockquote>  Since  I had never been acquainted with Badoo before, in the first place, I decided to find out what can be done here.  Immediately attention was attracted by the possibility of importing contacts from different mail services - I wanted to check whether such an address is included in the list of additional e-mail for password recovery.  Alas, not paid.  But my thoughts had already gone in this direction, and after a while I came across a form for resending an e-mail to confirm registration with the possibility to enter another e-mail, instead of the wrong one.  In this form, there was a CSRF, but what was most surprising was that if an authenticated user filled out this form, he changed the e-mail in the profile.  Obviously, in this scenario there was no check on whether the user has already confirmed his e-mail. </blockquote><br></div></div><br><br><h4>  CSRF and Linking External Social Networking Account (BSI-44) <br>  Posted by: chipik <br>  Category: 4 </h4><br>  Also found vulnerabilities in the interaction of the site with external resources.  We have a functionality that allows you to associate a profile on a site with external Facebook, VK or Google+ accounts.  Through them, users can log in to the site without memorizing a username and password.  A chipik participant checked this algorithm for strength and found a way to deceive him. <br>  With the help of the Tamper Data plug-in for Firefox, you can intercept a request to bind an external account and get an Authorization Token.  If an attacker forces an authorized user to click on a link with this token using CSRF, his account will be tied to the attacker's external account and allow the latter to log in with this user.  The most correct decision was to add a session-unique CSRF token to all transactions with an account link. <br><br><div class="spoiler">  <b class="spoiler_title">Comment chipik</b> <div class="spoiler_text"><blockquote>  Thank you, E.H.  for the vector :) </blockquote><br></div></div><br><br>  We remind you that applications are accepted until April 19 and you still have a chance to take part in the competition, get a reward, and also help make our platform more secure. <br>  After the end of the competition, we will select the 3 most active participants and give them an additional ¬£ 1,000. <br>  We also have 50 cool T-shirts with the symbols of the contest and thank-you letters signed by the jury, which we will distribute to the most active participants. <br><br>  Keep testing us for strength! <br><br>  Stanislav Eremin and the team Badoo Development </div><p>Source: <a href="https://habr.com/ru/post/175865/">https://habr.com/ru/post/175865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175853/index.html">SCRUM board + Eisenhower quadrant for product management</a></li>
<li><a href="../175855/index.html">Open source code repositories for open data and open state</a></li>
<li><a href="../175857/index.html">Continuation of "Planescape: Torment" raised a record amount on Kickstarter</a></li>
<li><a href="../175859/index.html">An algorithm has been developed that allows a significant increase in the capacity of fiber-optic networks.</a></li>
<li><a href="../175861/index.html">Female look at PocketBook Surfpad</a></li>
<li><a href="../175867/index.html">A cool developer should not write code, others write for him</a></li>
<li><a href="../175869/index.html">Content applications: on the way to the reader</a></li>
<li><a href="../175871/index.html">Architecture of a highly loaded Dyadok system</a></li>
<li><a href="../175873/index.html">Where is the money: look for advertising (and competitors)</a></li>
<li><a href="../175875/index.html">Application Competition on open police data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>