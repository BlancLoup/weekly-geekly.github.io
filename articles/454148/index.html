<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SOC performance review</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will talk about Security Operations Center (SOC) by people who do not create and customize it, but check how others have done it. Under the t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SOC performance review</h1><div class="post__text post__text-html js-mediator-article">  Today we will talk about Security Operations Center (SOC) by people who do not create and customize it, but check how others have done it.  Under the test gets the efficiency of the SOC, built for your company independently or by someone from the outside.  The check answers the question ‚ÄúDoes SOC fulfill the tasks assigned to it or not, and how effective is it?‚Äù.  After all, the presence of SOC does not mean that it works as it should and you are aware of any possible incidents and other security problems.  We will talk about our experience in checking SOC in different companies within our projects. <br><br><img src="https://habrastorage.org/webt/k8/8j/aw/k88jawtmbartkria690_ycsumny.jpeg"><br><a name="habracut"></a><br>  For those who already know what SOC is and what they drink it with, we suggest you immediately go to the second <a href="https://habr.com/ru/company/dsec/blog/454148/">part of the</a> article.  The rest offer to read the entire article. <br><br><h1>  Part 1. A bit about SOC for beginners </h1><br>  Protection of information systems comes out on top in almost any industry.  Any unauthorized access to information can lead to serious problems for the company. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The information system of any, even the smallest company, is complex, and all its parts must be protected according to the same principle - first organizational, then preventive measures, then observation tools detecting anomalies, and response tools.  At last, but not least, the stage of fighting threats is people, although it happens that the security problem can be solved without attracting people, for example, by automatically blocking ports or disconnecting the machine from the public network.  The tools used to protect each of the components of the system may be different from company to company, but there is a general trend - companies gradually, regardless of their size, come to the idea of ‚Äã‚Äãimplementing the SOC - Security Operation Center. <br><br>  There are several reasons for this: <br><br><ul><li>  using SOC reduces the cost of manually tracking security incidents; </li><li>  system events are collected in one place, less likely that some of them will be lost; </li><li>  SOC allows you to customize the rules for classifying security incidents according to the needs and peculiarities of a particular company; </li><li>  SOC allows you to minimize the time it takes to detect and respond to security incidents, thereby reducing the potential damage to the company; </li><li>  logs that fall into SOC are reduced to a single view, which allows you to effectively investigate security incidents, even if an attacker attempts to sweep away traces of his presence in the system. </li></ul><br>  SOC is an infrastructure with many interrelated components, its basis is SIEM (Security information and event management).  SIEM is a system for collecting, normalizing and correlating data, which collects logs from web servers, host machines, and other infrastructure components, as well as information security tools installed on organization's network devices, correlates and processes them to bring them to a normalized look.  This is the main task of SIEM - to bring to a single format a huge number of logs from different sources for the convenience of detecting the relationships between them.  This is necessary for one more component of SOC, SOC analysts, who, looking at the huge lists of logs from SIEM, should respond to some of the events themselves or transfer them to the work of security specialists. <br><br>  There are no two identical SOCs because its setting is individual for each organization.  The main stages of creating a SOC are as follows: <br><br><ul><li>  definition of the protected infrastructure, both at the organizational and at the technical level; </li><li>  installation of all possible / necessary means of protection and monitoring, as well as their setting; </li><li>  Selection of a suitable SIEM and its adjustment depending on the company‚Äôs features; </li><li>  creating event correlation rules; </li><li>  SOC team selection - people whose job will be to monitor events and make corrections to correlation rules, as well as to respond to security events. </li></ul><br>  Even after everything is determined, installed and configured, no one guarantees that SOC now works as you would like, or as shown in the beautiful presentations from SIEM developers.  The fundamental problem with the use of any means of protection is that almost no one knows how effectively they work.  It is important not only to install and run them, but also to make sure that the measures taken are effective.  Also extremely important is the level of maturity of the company in matters of security. <br><br>  Since SOC is a complex and complex structure, it is important to understand that at each of the listed stages of its creation something may go wrong.  And this is likely to affect the overall security of the system and the efficiency of the SOC itself. <br><br><h1><a name="part2"></a>  Part 2. What happens if you don‚Äôt check the effectiveness of SOC, but leave everything as it is? </h1><br><img src="https://habrastorage.org/webt/nt/w-/d6/ntw-d6ttjy2mokg71gpq7nzye7e.jpeg"><br><br>  Let's start with the fact that something can go wrong, even with the slightest <b>changes in the infrastructure of the</b> organization.  And they occur quite often - someone leaves, new people come, something breaks, hardware and software are updated, and much more.  In this case, the GIS settings and correlation rules should be quickly changed, but they often forget about it, and when they remember, it is too late. <br><br><img src="https://habrastorage.org/webt/i8/5z/r-/i85zr-bggvrlkbclbmsjiqocawu.jpeg"><br><br>  The next part of the SOC, where errors can occur - the <b>means of protection</b> from which information enters the SIEM, can be configured incorrectly and skip actions directed at the system from the outside.  And if the attacker's action is not detected by any of the existing SZIs, then it will not fall into the logs and will not appear in the SIEM, and most likely the security service will not know about it soon. <br><br><img src="https://habrastorage.org/webt/mc/gz/yz/mcgzyzfaqjul-mne8abzfesqnnk.jpeg"><br><br>  The problem may be in the <b>SIEM</b> .  It may not work as you would like.  Events that fall into it may be correlated incorrectly due to errors in the correlation rules, which will lead to the omission of the attacker's actions.  It is worth clarifying here that data from one source is not always enough.  There are cases when to determine security incidents it is necessary to combine data from several sources at once in order to get a complete picture of what is happening in the system.  But it may turn out that the rule is set up in such a way that to determine the incident that happened, there may not be enough data from one source, which indicate the fact of its occurrence.  Those.  There will be a puzzle consisting of data from several sources.  Also, the rules for some security events may be absent altogether. <br><br>  <b>At the stage of correlation of</b> events in the SIEM several problems can arise at once.  One of them may be the delay in the transmission of events from some sources, which may interfere with the successful correlation. <br><br>  <b>The rules for assigning events to incidents</b> in the SIEM may be configured incorrectly by themselves, or they may be missing for any events.  Also, incidents are usually of a level of importance, the incorrect definition of which can lead to big problems. <br><br><img src="https://habrastorage.org/webt/lp/i_/_b/lpi__b8kyefqpytkx1pvmfkdxw0.jpeg"><br><br>  <b>People</b> working with the SIEM, whose task is to respond to security incidents, can also cause missed attacks and subsequent information security problems.  They may skip some signals from the SIEM or respond incorrectly to the attacker's actions for various reasons.  There is also a problem that people leave sooner or later, and new employees need time to study. <br><br>  Given the above, SOC testing to test performance is extremely important both during the implementation phase of a SOC and over time.  Since the specialists of our company already have experience in this matter, we decided to describe the main points and nuances. <br><br><h1>  Part 3. SOC Performance Review </h1><br>  SOC testing in a company can be conducted in several scenarios.  We will tell about those that seem to us the most effective. <br><br>  SOC testing tasks include checking security by replicating typical behavioral scenarios of intruders.  These include: <br><br><ul><li>  brute forceing accounts of other users using brute force, as well as using the password spraying technique.  The use of this technique is possible if you have access to the list of existing accounts in the system, for example, through the address book of the mail client.  In our experience, often the password spraying technique is forgotten and, accordingly, the SOC rules are difficult to detect for such an attack; </li><li>  downloading data from a web resource, whether it is a corporate wiki or task manager.  Such an attack can be carried out including using various web crawling and directory brute mechanisms.  Separately, auditors pay attention to API services and their capabilities; </li><li>  repeated attempts to access resources or projects that are outside the competence of the role on whose behalf the attacker works.  A simple example is attempts to authorize a user from the group of developers on the resources of network administrators and security services; </li><li>  attempts to download a large amount of information from the corporate network using techniques of filtering the transmitted data.  This is primarily about dns and icmp tunnels, but sometimes it makes sense to start with simpler checks, for example, try to look for an open tcp or udp port, as well as an additional gateway (gateway).  To search for gateways, by the way, there is a modified implementation of one popular <a href="https://github.com/whitel1st/gateway-finder-imp">tool</a> from one of the employees. </li></ul><br>  This list of checks can be continued for a long time.  The most important thing is to be guided by the real needs of the client and the checks implemented by him. <br><br>  SOC testing can be done in two ways: <br><br><ul><li>  blindly - blackbox; </li><li>  with knowledge of infrastructure - whitebox. </li></ul><br>  More about each of them. <br><br>  First of all, you should check the SOC operation in the blackbox testing mode.  Its essence is that employees of the SOC department are not aware of the work being done and react to all events in combat mode.  Auditors / pensters are given access to the corporate network, and accounts from the most widely used services in the company can be given. <br><br>  Such a model assumes that an attacker who does not have any additional information has obtained access to the company‚Äôs network and any of its accounts in an unknown way.  The actions of such an attacker are characterized by a high degree of randomness and ‚Äúnoise‚Äù.  He actively scans the network, iterates through directories, accounts, sends to all ports all the known exploits, throws XSS, SQLi, RCE, SSTI, NoSQLi, etc web applications.  In general, he behaves extremely aggressively in the hope of hacking at least something.  During the audit, the auditors imitate the actions of such an intruder, maintaining a given degree of insanity, but are ready to stop at any time at the request of the SOC or in case of technical problems.  By the way, an unexpected and pleasant result can be the discovery of vulnerable services and applications in the company's infrastructure. <br><br>  Another testing model is the whitebox.  In this case, the script is unfair employee.  Usually at this point auditors are well-versed in the customer‚Äôs network and can play such a role.  The behavior of a potential intruder in this case can be characterized by high selectivity of both the means and the targets of the attack.  Here you can already draw some parallels with <a href="https://ru.wikipedia.org/wiki/APT">APT attacks</a> .  The auditors attack only the weakest places in their view and use thoughtful and narrowly focused attack vectors, as well as trying to gain access to sensitive information outside the competence of the role of their account with a subsequent attempt to pump it out of the protected perimeter.  All the actions they are trying to perform in such a way as to go unnoticed by the company's security service. <br><br>  After testing, usually begins the analysis and comparison of the results obtained by the auditors and incidents detected by SOC employees.  This stage will provide an overall picture of the effectiveness of the current work of the SOC and can serve as a starting point for all future plans to expand the existing checks and approaches. <br><br>  Finally, when the idea of ‚Äã‚Äãthe security of the tested infrastructure is developed, the auditors can use the whitebox testing to analyze the existing set of rules, as well as the events on the basis of which these rules are formed.  Such interaction between auditors and SOC analysts can be very productive, and during the consultation it will help to detect logical errors and omissions in setting up SOC components.  Their root is usually a lack of insight from SOC analysts on how a real attacker can act and what tricks he can perform on systems. <br><br><h1>  Conclusion </h1><br>  The most critical services that deserve closer attention are tested separately using two models of offenders. <br><br>  Such a complex of activities allows you to: <br><br><ul><li>  significantly increase the awareness of security managers about the state of their infrastructure; </li><li>  conduct combat exercises for the SOC department with the opportunity to receive advice from experts in the field of auditing; </li><li>  to detect and correct existing errors in the work of SOC, as well as generally improve the security of the company. </li></ul><br>  For assistance in writing this article, I express my gratitude to <a href="https://twitter.com/_ttffdd_">Denis _ttffdd_ Rybin</a> and <a href="https://twitter.com/igc_iv">Ivan Chalykin</a> . </div><p>Source: <a href="https://habr.com/ru/post/454148/">https://habr.com/ru/post/454148/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454132/index.html">Video surveillance on orange pi zero - cheap and not at all angry</a></li>
<li><a href="../454136/index.html">The most beautiful theorem of mathematics: Euler's identity</a></li>
<li><a href="../454138/index.html">June 10, Deworkacy - Q High-quality communication.</a></li>
<li><a href="../454140/index.html">From lawyer to tester in Yandex. The history of my internship</a></li>
<li><a href="../454144/index.html">In Java 13, they want to add "blocks of text"</a></li>
<li><a href="../454154/index.html">Branches of Hell: Cloud Control of Illegal Dumps and Dangerous Polygons</a></li>
<li><a href="../454156/index.html">Tires and protocols in industrial automation: how it all works</a></li>
<li><a href="../454160/index.html">Using PowerShell to elevate local account privileges</a></li>
<li><a href="../454164/index.html">How does A / B testing in Avito</a></li>
<li><a href="../454166/index.html">June 6 - VeeamON Forum in Moscow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>