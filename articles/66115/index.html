<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OS and web server - more fun together</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all. At first, I thought that it would be best to continue the nginx theme with the example of a cleaned up and commented out config from one...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OS and web server - more fun together</h1><div class="post__text post__text-html js-mediator-article">  Hello to all.  At first, I thought that it would be best to continue the nginx theme with the example of a cleaned up and commented out config from one of the combat servers, but then I realized that this would require a rather large amount of additional information.  Therefore, I decided to try, for starters, to tell in general about how nginx works, and why it works so fast. <br><br><a name="habracut"></a><br>  You need to start by understanding how a server with a single conditional processor can handle more than one network request at a time.  Everything has long been aware of the division of CPU time between tasks and about timer switching tasks in modern operating systems.  But if there was only one CPU in the computer, he could not carry out more than one request at the same time.  The division of tasks into quanta, and their alternation would not lead to a decrease, but to an increase in the total time spent on all tasks. <br><br>  The thing is that in modern computers there is not one processor.  :) Even if your CPU has just one core, a lot of other chips help it.  The main ones are the DMA controller (s), a specialized controller on the network board, a hard disk controller, a video card processor (although it is not yet used in web servers), and so on. All these devices can take on a lot of highly specialized work, freeing the CPU to perform other tasks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The operation of the operating system is to correctly distribute the load among the devices found in your computer.  For example, a processor might say to a DMA controller that ‚Äúthey transferred this data from a disk, into this section of memory,‚Äù and do something else.  What exactly is the ‚Äúother‚Äù determines one of the special planning algorithms, each with its own advantages and disadvantages (I advise you to read about a very good book by Mr. Tannenbaum ‚ÄúModern Operating Systems‚Äù).  But it is not about that now. <br><br>  I would like to draw your attention to the fact that the architecture of modern x86 computers itself imposes asynchronous execution of tasks to increase the performance of the system as a whole.  The operating system can hide this asynchrony from users by providing synchronous <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B2%25D1%258B%25D0%25B7%25D0%25BE%25D0%25B2">system calls</a> , but you can win a lot by writing a program, taking into account what happens under the hood. <br><br>  The truth is there is a small problem.  Operating systems, traditionally, were designed in such a way that the executed programs could not even suspect that "they are not alone here."  And even the means to perform fast asynchronous system calls appeared relatively recently in Linux, FreeBSD and Windows (I do not mean select and poll). <br><br>  As a matter of fact, I think you already understood what I am leading to.  Nginx works very quickly because it does not spawn a separate process (thread) for each request processed by the user, but performs all tasks in one process, using asynchronous system calls for I / O operations (networking, and hard disk).  This approach has several advantages: <br><br>  - all work can be performed by one process, or, in general, N processes, where N is the number of cores in your server; <br>  - the number of switching between execution contexts is minimized; <br>  - there is almost no need to synchronize processes or threads; <br>  - decreases memory usage; <br><br>  This approach has its drawbacks, the main of which are the need for a very careful approach to server programming, and the inability to use blocking I / O operations.  More precisely, of course, you can use blocking operations, but this will stop the ALL web server process and the maintenance of all connections until the blocking is complete.  In particular, this is one of the problems with the use of Perl embedded in nginx.  With any I / O operation, it can be blocked - and this slows down all the work. <br><br>  In conclusion, I would like to add that the speed of your server with nginx largely depends on the operating system and its settings.  Proper tuning of the OS, under heavy loads, you can increase server performance by many tens of percent. <br><br>  PS Thanks to my friends and colleagues for beta-testing the text.  :) </div><p>Source: <a href="https://habr.com/ru/post/66115/">https://habr.com/ru/post/66115/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../66109/index.html">MonoTouch: write for iPhone on C # and Silverlight</a></li>
<li><a href="../66110/index.html">Search engines can kill copy-pasteing! Why not?</a></li>
<li><a href="../66111/index.html">Warm welcome from Google Notebook</a></li>
<li><a href="../66112/index.html">Racism and Depeche Mode in Left 4 Dead 2</a></li>
<li><a href="../66113/index.html">Trojan.win32.vkhost.an - about stealing Vkontakte accounts and Odnoklassniki</a></li>
<li><a href="../66117/index.html">Exploring ASP.NET + ADO.NET + Silverlight</a></li>
<li><a href="../66118/index.html">How does DHL work?</a></li>
<li><a href="../66119/index.html">Windows 7 - shit!</a></li>
<li><a href="../66121/index.html">Genetic algorithms, image recognition</a></li>
<li><a href="../66122/index.html">Should music be distributed freely?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>