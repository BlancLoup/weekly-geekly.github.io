<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Duck says ‚Äúquack-krya‚Äù, the cow says ‚Äúmu-mu‚Äù, ‚ÄúRunn Me!‚Äù - another PHP framework * tells us. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúOh no!‚Äù, The reader exclaims, tired of various mini-micro-slim frameworks and QueryBuilders, and will be right. 

 There is nothing more boring than ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Duck says ‚Äúquack-krya‚Äù, the cow says ‚Äúmu-mu‚Äù, ‚ÄúRunn Me!‚Äù - another PHP framework * tells us. Part 1</h1><div class="post__text post__text-html js-mediator-article">  ‚ÄúOh no!‚Äù, The reader exclaims, tired of various mini-micro-slim frameworks and QueryBuilders, and will be right. <br><br>  There is nothing more boring than another PHP framework.  Is that "fundamentally new" CMS <s>or new dating</s> . <br><br><img src="https://habrastorage.org/files/170/152/b2f/170152b2fa2d4ffab43fb6b1af339435.PNG">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So why do I, with perseverance, worthy of a better use, step on uncomfortable pitfalls and <s>present</s> my work <s>to the public of the</s> court of comrades?  Knowing in advance that the anger of the critics, how powerful the tsunami will overwhelm this post and bury it at the very bottom of Habr? <br><br>  I do not know.  As Columbus did not know in his time, why did he sail from the cozy shores of Spain.  Did he hope to find a way to India?  Of course yes.  But I didn‚Äôt know for sure - will he swim? <br><br>  Apparently, PHP programmers, for whom I have been counting myself for 13 years, have the same internal need - to expose my code and squeeze my eyes, waiting for the reaction of colleagues. <br><br>  What awaits you under the cut? <br><br><ul><li>  Open source license LGPL </li><li>  Code fully compatible with PHP 7.0-7.2 </li><li>  100% coverage with unit tests </li><li>  Time-tested libraries in real projects (and only damn procrastination prevented me from publishing them earlier!) </li></ul><br>  Well, of course, the history of the invention of the next <s>bike on the</s> framework's <s>crutch drive</s> *! <br><br>  <i>* generally speaking, this is not yet a framework, but just a set of libraries, it will become a framework later</i> <br><br><a name="habracut"></a><br><img src="https://habrastorage.org/files/55c/423/47a/55c42347a1d7494ea878f01dd2dfa195.png" align="left"><ul><li>  <b>Brand Name:</b> Runn Me! </li><li>  <b>Vendor:</b> Runn </li><li>  <b>GitHub:</b> <a href="https://github.com/RunnMe">github.com/RunnMe</a> </li><li>  <b>Composer:</b> <a href="https://packagist.org/packages/runn/">packagist.org/packages/runn</a> </li></ul><br><h2>  A bit of history or where did the idea of ‚Äã‚Äã‚Äúwrite another framework come from?‚Äù </h2><br>  Yes, actually, from nowhere.  She always was. <br><br>  Various interesting projects in which I had the opportunity to participate during my programmer career put standard solutions for the standard tasks into my personal piggy bank - so I, like any normal programmer, had my own library of functions, classes and libraries. <br><br>  About six years ago, the management of the company I worked for then set the task: to develop my own framework.  Make a lightweight MVC framework, taking only the most necessary, add specific domain libraries (believe me - very specific!) And build some universal solution.  The solution, it should be noted, turned out, but the specificity of the subject area did not allow it to become massive - the code was not published, installations on the client‚Äôs platform were sold.  It's a pity.  Some things were really ahead of their time: suffice it to say that even if it was a primitive, but still quite similar composer, the team and I did it completely independently and a little before the public public stable composer appeared :) <br><br>  Thanks to this experience, I had the opportunity to study almost all the frameworks that existed then in the PHP ecosystem.  Along the way, another event occurred, the next ‚Äútransition from quantity to quality‚Äù - I began to teach programming.  First, in a well-known online school, then focused on the development of its own service.  He began to "grow into" teaching methods, teaching materials and, of course, students.  The idea of ‚Äã‚Äãsome ‚Äúlearning framework‚Äù, intentionally simplified for beginners to understand, but at the same time allowing to successfully develop simple web applications in accordance with modern standards and trends, arose in this get-together. <br><br>  Three years ago, as the implementation of this ‚Äúlearning framework‚Äù idea, a small MVC framework called ‚ÄúT4‚Äù * was born.  There is nothing special in the title, just an abbreviation for "Technological layout, version 4".  I think it is clear that the previous three versions came out unsuccessful and only from the fourth attempt we, together with my students of that time, managed to create something really interesting. <br><br>  <i>* I later found out that this was how the program to sterilize and kill incurably sick people was called so in the Third Reich ... of course, the question of changing the name immediately came up</i> <br><br>  T4 successfully developed and grew, became known, as they say, ‚Äúin narrow circles‚Äù (very narrow), a number of quite large projects were made on it, but internal discontent with this decision grew. <br><br>  At the beginning of this year, I finally matured to reformat the accumulated code.  Together with a group of like-minded people who also actively used T4, we adopted a number of basic principles for building a new framework: <br><br><ol><li>  We make it a loosely coupled set of libraries, so that each lib can be connected and used separately. </li><li>  We try to keep healthy minimalism where it is possible. </li><li>  The framework itself for web and console applications is also one of the libraries, thus we avoid solidity. </li><li>  We try not to reinvent the wheel and maximally save the approaches and the code that have already proven themselves in T4. </li><li>  We refuse support for outdated versions of PHP, write code for the most current version. </li><li>  We try to make the code as flexible as possible.  If possible, instead of classes and inheritance, we use interfaces, traits, and code composition, leaving the framework users with the ability to replace the reference implementation of any component with their own. </li><li>  We cover the code with tests, achieving 100% coverage. </li></ol><br>  So the project was born, which was first called ‚ÄúRunning.FM‚Äù, and then finally renamed to <b>‚ÄúRunn Me!‚Äù</b> <br><br>  That's what I imagine today. <br><br><blockquote>  <i>By the way, the word ‚Äúrunn‚Äù is artificially constructed: on the one hand, to be clear to everyone and to cause associations with ‚Äúrun‚Äù, on the other - so that it does not coincide with any of the vocabulary words.</i>  <i>I generally like the ‚Äúrun‚Äù letter combination: I still had time to participate in RunCMS :)</i> <br></blockquote><br>  At the moment, the project ‚ÄúRunn Me!‚Äù Is in the middle of the way - some libraries can already be used in production, some in the process of transferring from old projects and refactoring, and some have not yet begun to transfer. <br><br><h2>  In the beginning was Core </h2><br>  It is impossible to fit in one post the story about each library of the ‚ÄúRunn Me!‚Äù Project: there are many of them, I want to tell in detail about each, and besides, this is a living project in which everything changes for the better literally every day :) <br><br>  So I decided to break the story about the project into several posts.  In today's talk about the base library, which is called "Core". <br><br><ul><li>  <b>Purpose:</b> implementation of the base classes of the framework </li><li>  <b>GitHub:</b> <a href="https://github.com/RunnMe/Core">github.com/RunnMe/Core</a> </li><li>  <b>Composer:</b> <a href="https://github.com/RunnMe/Core">github.com/RunnMe/Core</a> </li><li>  <b>Installation:</b> composer command require runn / core </li><li>  <b>Versions:</b> as in any other library of the ‚ÄúRunn Me!‚Äù Project, three versions are supported, corresponding to previous, current and future versions of PHP: <br>  7.0. *, 7.1. * And 7.2. * </li></ul><br><h3>  An array?  An object?  Or all together? </h3><br>  The blessed idea of ‚Äã‚Äãan object consisting of arbitrary properties that can be created and deleted on the fly, as elements in an array, comes to mind to every PHP programmer.  And every second implements this idea.  I was not an exception with my team: your acquaintance with the Runn \ Core library I want to start with a story about the ObjectAsArray concept. <br><br>  <b>Do it once:</b> define an interface that allows you to cast your object to an array and vice versa: turn an array into an object, not forgetting in this interface a couple of useful methods (merge () to merge an object with external data and recursive casting to an array) <br><br>  <a href="https://github.com/RunnMe/Core/blob/master/src/Core/ArrayCastingInterface.php">github.com/RunnMe/Core/blob/master/src/Core/ArrayCastingInterface.php</a> <br><pre><code class="php">namespace Runn\Core;

interface ArrayCastingInterface
{
    public function fromArray(iterable $data);
    public function merge(iterable $data);
    public function toArray(): array;
    public function toArrayRecursive(): array;
}
</code></pre><br>
<b> :</b>  ,     --  ,    : , ,   ,     ,     ¬´-¬ª.<br>
<br>
<a href="https://github.com/RunnMe/Core/blob/master/src/Core/ObjectAsArrayInterface.php">github.com/RunnMe/Core/blob/master/src/Core/ObjectAsArrayInterface.php</a><br>
<pre><code class="php">namespace Runn\Core;

interface ObjectAsArrayInterface
  extends \ArrayAccess, \Countable, \Iterator, ArrayCastingInterface, HasInnerCastingInterface, \Serializable, \JsonSerializable
{
  ...
}
</code></pre><br>
<b> :</b>  ,     . . <a href="https://github.com/RunnMe/Core/blob/master/src/Core/ObjectAsArrayTrait.php">github.com/RunnMe/Core/blob/master/src/Core/ObjectAsArrayTrait.php</a><br>
<br>
      ¬´--¬ª.   ObjectAsArrayInterface   ObjectAsArrayTrait     :<br>
<br>
<pre><code class="php">class someObjAsArray implements \Runn\Core\ObjectAsArrayInterface 
{
  use \Runn\Core\ObjectAsArrayTrait;
}

$obj = (new someObjAsArray)-&gt;fromArray([1 =&gt; 'foo', 2 =&gt; 'bar']);
$obj[] = 'baz';
$obj[4] = 'bla';

assert(4 === count($obj));
assert([1 =&gt; 'foo', 2 =&gt; 'bar', 3 =&gt; 'baz', 4 =&gt; 'bla'] === $obj-&gt;values());

foreach ($obj as $key =&gt; $val) {
  // ...
}

assert('{"1":"foo","2":"bar","3":"baz","4":"bla"}' === json_encode($obj));
</code></pre><br>
    ObjectAsArrayTrait       ¬´ -¬ª    -,     :<br>
<br>
<pre><code class="php">class customObjAsArray implements \Runn\Core\ObjectAsArrayInterface 
{

  use \Runn\Core\ObjectAsArrayTrait;

  protected function getFoo() 
  {
    return 42;
  }

  protected function setBar($value)
  {
    echo $value;
  }

}

$obj = new customObjAsArray;
assert(42 === $obj['foo']);

$obj['bar'] = 13; //  13,   
</code></pre><br>
<h3>: null is set!</h3><br>
,  -,   null,  . <br>
<br>
    ,  -  . ,     ,     ,     ORM:<br>
<br>
<pre><code class="php">class someObjAsArray implements \Runn\Core\ObjectAsArrayInterface 
{
  use \Runn\Core\ObjectAsArrayTrait;
}

$obj = new someObjAsArray;
assert(false === isset($obj['foo']));
assert(null === $obj['foo']);

$obj['foo'] = null;
assert(true === isset($obj['foo']));
assert(null === $obj['foo']);
</code></pre><br>
<h3>   ?</h3><br>
  ! ,      ‚Äî   .   \Runn\Core\ObjectAsArrayInterface      ,    ¬´ ¬ª: Collection  Std.<br>
<br>
<h3></h3><br>
  Runn Me! ‚Äî  -,      :<br>
<br>
<div class="spoiler"><b class="spoiler_title">    </b><div class="spoiler_text"><pre><code class="php">namespace Runn\Core;

interface CollectionInterface
    extends ObjectAsArrayInterface
{
    public function add($value);
    public function prepend($value);
    public function append($value);
    public function slice(int $offset, int $length = null);
    public function first();
    public function last();
    public function existsElementByAttributes(iterable $attributes);
    public function findAllByAttributes(iterable $attributes);
    public function findByAttributes(iterable $attributes);
    public function asort();
    public function ksort();
    public function uasort(callable $callback);
    public function uksort(callable $callback);
    public function natsort();
    public function natcasesort();
    public function sort(callable $callback);
    public function reverse();
    public function map(callable $callback);
    public function filter(callable $callback);
    public function reduce($start, callable $callback);
    public function collect($what);
    public function group($by);
    public function __call(string $method, array $params = []);
}
</code></pre><br>
</div></div><br>
,               CollectionTrait,      ( )  \Runn\Core\Collection,        .<br>
<br>
        :<br>
<br>
<pre><code class="php">$collection = new Collection([1 =&gt; 'foo', 2 =&gt; 'bar', 3 =&gt; 'baz']);
$collection-&gt;prepend('bla');

$collection
  -&gt;reverse()
  -&gt;map(function ($x) { 
    return $x . '!'; 
  })
  -&gt;group(function ($x) {
    return substr($x, 0, 1);
  });

/*
 - 
[
  'b' =&gt; new Collection([0 =&gt; 'baz!', 1 =&gt; 'bar!', 2 =&gt; 'bla!']),
  'f' =&gt; new Collection([0 =&gt; 'foo!'),
),
]
*/
</code></pre><br>
    ?<br>
<br>
<ol>
<li>     ,   .</li>
<li>      .</li>
<li>   ‚Äî        .</li>
</ol><br>
<h4> </h4><br>
 ¬´¬ª    Runn\Core   ,    ,     .   .<br>
<br>
    :<br>
<br>
<pre><code class="php">class UsersCollection extends \Runn\Core\TypedCollection 
{
  public static function getType()
  {
    return User::class; //       , 
  }  
}

$collection = new UsersCollection;

$collection[] = 42; // Exception: Typed collection type mismatch
$collection-&gt;prepend(new stdClass); // Exception: Typed collection type mismatch

$collection-&gt;append(new User); // Success!
</code></pre><br>
<h3>Std</h3><br>
 ¬´¬ª ,  -  ,  ¬´ ¬ª.    :<br>
<br>
<b> :</b>    ¬´¬ª.<br>
<br>
<pre><code class="php">namespace Runn\Core;

interface StdGetSetInterface
{
    public function __isset($key);
    public function __unset($key);
    public function __get($key);
    public function __set($key, $val);
}
</code></pre><br>
<b> :</b>     (. <a href="https://github.com/RunnMe/Core/blob/master/src/Core/StdGetSetTrait.php">github.com/RunnMe/Core/blob/master/src/Core/StdGetSetTrait.php</a> )<br>
<br>
<b> :</b>   ¬´¬ª ,   StdGetSetInterface    . <a href="https://github.com/RunnMe/Core/blob/master/src/Core/Std.php">github.com/RunnMe/Core/blob/master/src/Core/Std.php</a><br>
<br>
         ,     .    :<br>
<br>
<pre><code class="php">$obj = new Std(['foo' =&gt; 42, 'bar' =&gt; 'bla-bla', 'baz' =&gt; [1, 2, 3]]);
assert(3 === count($obj));

assert(42 === $obj-&gt;foo);
assert(42 === $obj['foo']);

assert(Std::class == get_class($obj-&gt;baz));
assert([1, 2, 3] === $obj-&gt;baz-&gt;values());

// , ,      :
$obj = new Std;
$obj-&gt;foo-&gt;bar = 42;
assert(Std::class === get_class($obj-&gt;foo));
assert(42 === $obj-&gt;foo-&gt;bar);
</code></pre><br>
, ¬´¬ª  Std   chaining-,   ,      ,    .    :    ,       ..    ,    .<br>
<br>
<h3> ?</h3><br>
  !     :<br>
<br>
<ul>
<li></li>
<li>  </li>
<li> ,   </li>
<li>  Value Objects  Entities</li>
<li> HTML      </li>
<li>   DBAL, ,  , QueryBuilder!</li>
<li> ORM</li>
<li>   ‚Äî MVC-</li>
</ul><br>
     .     , ! , , ! :)<br>
<br>
<img src="https://habrastorage.org/files/d90/5e8/471/d905e8471188421890f60543d1c16b5b.jpg"><br>
<br>
<b>P.S.</b>       ,       -  .    ¬´¬ª.          .<br>
<br>
<b>P.P.S.</b>           .<br>
<br>
<h3>¬©</h3><br>
 () Mart Virkus 2016<br>
      </div><p>Source: <a href="https://habr.com/ru/post/326960/">https://habr.com/ru/post/326960/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326948/index.html">Bad advice on setting up a backup and a few tales</a></li>
<li><a href="../326952/index.html">Brainstorming for the lazy or Individual intellectual activity, or Basics of divergent thinking in practice</a></li>
<li><a href="../326954/index.html">Open broadcast of the main conference room Mobius 2017: Let's talk about the architecture of mobile applications and something else</a></li>
<li><a href="../326956/index.html">The uWSGI Spooler</a></li>
<li><a href="../326958/index.html">From weekly sysadmin: unpack NetApp FAS 9000</a></li>
<li><a href="../326962/index.html">Reactive applications with the RxPM pattern. Goodbye MVP and MVVM</a></li>
<li><a href="../326964/index.html">Mobile Device Manager Plus - long-awaited perfection or is it still not?</a></li>
<li><a href="../326966/index.html">Hallucinate like Trump, or mini-analysis of Recurrent Neural Networks</a></li>
<li><a href="../326968/index.html">Network Attacks with Kali Linux</a></li>
<li><a href="../326970/index.html">Domestic Linux distribution - ‚ÄúOS‚Äù for server and desktop systems: the new BolgenOS of the national scale?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>