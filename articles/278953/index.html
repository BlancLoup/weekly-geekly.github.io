<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Web merge sync on MS SQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It was decided to write this instructional article to help my friends and colleagues, since most of them did not encounter setting up web synchronizat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Web merge sync on MS SQL</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/325/f69/032/325f690326fc43889a7c81f1ed4c9dce.png"><br><br>  It was decided to write this instructional article to help my friends and colleagues, since most of them did not encounter setting up web synchronization in MS SQL, and I hope that it will allow you to avoid some minor problems that I myself encountered while setting up .  I hope you, dear habrasoobschestvu, it can be useful. <br><br>  Information on tuning on the Internet is available, but it seemed to me that everything is very fragmented and for the most part there is no practical part in tuning.  Maybe I was looking bad. <br><a name="habracut"></a><br><h3>  Why and for what </h3><br>  And so we need to synchronize information between the two stores, so that they always receive the actual quantities of goods, reference books, etc., and that this is all regulated from one back office, and the stores would only have front offices. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Why not set up replication with white IP or via VPN: <br><br><ol><li>  The provider does not provide white IP. </li><li>  Used mobile Internet with bad speed. </li><li>  When using PPTP, providers block GRE. </li><li>  VPN has a feature of breaking off, although it restores the connection afterwards. </li><li>  Due to a slight loss of communication, the SQL Server agent does not always have time to connect to the subscriber, and the next attempt is scheduled according to a certain time schedule; if it is not frequently synchronized, this can be quite critical. </li><li>  With a large number of publications and subscribers connecting to the server, again, the agent does not always ‚Äúmanage‚Äù to connect to the subscriber.  It usually helps to set up a schedule so that synchronization does not take place for everyone at the same time, which is also not always convenient. </li></ol><br>  When working with web synchronization in merge replication, data synchronization is via HTTPS and updates are sent as XML, this will avoid the problems described above, perhaps not everything, but still: <br><br><ol><li>  We do not need a permanent IP and, accordingly, the user is not tied to the workplace and can be with his laptop anywhere. </li><li>  The connection uses a secure protocol. </li><li>  It is unlikely that the provider will block port 443. </li><li>  With a slow Internet connection, synchronization is faster and there are much fewer cliffs, according to my observations. </li><li>  The merge agent is located at the subscriber, which reduces the load on the server itself. </li></ol><br><div class="spoiler">  <b class="spoiler_title">A small digression from the main topic:</b> <div class="spoiler_text">  In our work, very often we have to deal with merge replication, we set up replication for one product-accounting system of a Bulgarian developer.  Basically, the entire replication setup is reduced using white IP addresses and forwarding port 1433 to the outside or setting up a VPN channel, and here everyone is setting up their capabilities and knowledge. <br><br>  The first option can be easily and quickly set up, but in terms of security, it loses, attacks start with it mostly from Chinese IPs, of course, it is saved by the firewall, but ‚Äúhonest‚Äù users love to disable it. <br><br>  The second option is more secure (although not always), but requires partners who are engaged in the automation of a great deal of customization, mainly using Hamachi, SoftEther or the next in polarity is OpenVPN or Windows Server functionality (mainly PPTP). <br><br>  For the most part, I myself used Windows Server (SSTP) and / or OpenVPN features when working with replication for the time being. </div></div><br><h3>  Training </h3><br>  You can work with web synchronization starting with MS SQL 2005 and later, on a central server you will need Standard edition or older, for the subscriber, Express edition is enough. <br><br>  In this example, are used: <br><br><ul><li>  Microsoft SQL Server 2014 Standard as a publisher. </li><li>  Microsoft SQL Server 2014 Express as a subscriber. </li><li>  Installed on a central <abbr title="Internet Information Services">IIS</abbr> server </li><li>  Deployed the main database of our store on the publisher. </li><li>  Created an empty subscriber database. </li><li>  Windows user with IIS_IUSRS group permissions </li><li>  A little patience. </li></ul><br><h3>  IIS Setup </h3><br><ol><li>  First of all, let's prepare IIS for work, create a directory for the C: \ inetpub \ wwwroot \ WebSQL service.  If the server is supposed to work with several publications, create separate directories in WebSQL \ RCU. </li><li>  Copy replisapi.dll from C: \ Program Files \ Microsoft SQL Server \ 120 \ COM to the directory created in the first step in WebSQL, when working with several publications, copy to WebSQL \ RCU. </li><li>  It is recommended to register the library on many Internet resources, but in my case, oddly enough, this was not required.  To register, use the regsvr32 "C: \ inetpub \ wwwroot \ WebSQL \ RCU \ replisapi.dll" command as an administrator. </li><li>  Create a new website through the IIS Manager.  Physical path specify the directory created in the first step, if there are subdirectories inside, leave in any case the root directory. <br><br><div class="spoiler">  <b class="spoiler_title">Adding a website</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/169/c4e/416/169c4e4166aa434d8520858f8c475ebd.png"><br></div></div><br></li><li>  After we add a virtual directory to our site.  We specify the alias according to the name of the directory and specify the physical path to it.  If the directory is one path you can point to the root directory. <br><br><div class="spoiler">  <b class="spoiler_title">Add virtual directory</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/3ee/c18/baa/3eec18baa9b846969d5137f79928f17f.png"><br></div></div><br></li><li>  The next step is to configure the resolution for executing replisapi.dll for this in the IIS Manager, select the virtual directory and in the central panel in the IIS category, find the item matching handlers.  Next, in the action panel, select the item to add a module mapping. <br><br><div class="spoiler">  <b class="spoiler_title">Handler mapping</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/bbe/cc0/b04/bbecc0b041494b5b985c46fc0132576e.png"><br></div></div><br><ul><li>  In the field the path of the request we specify replisapi.dll </li><li>  In the list of modules, select IsapiModule.  If this module is not listed, then in the Windows components for IIS services, you need to add ISAPI extensions. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Adding Windows Components</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/c3d/d10/274/c3dd102748ca46c7909b510c312ed29a.png"><br></div></div><br><ul><li>  For the executable file, specify the path to the library in the virtual directory C: \ inetpub \ wwwroot \ WebSQL \ RCU \ replisapi.dll.  I want to note that again, if there are several publications, then you add a handler for each virtual directory with its own path. </li><li>  In the field name indicate Replisapi </li><li>  Click the limit button and go to the access tab and select the execution. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Request Restrictions</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b76/fda/96e/b76fda96e8e644fdbcfe90ff7c144d40.png"><br></div></div><br><ul><li>  We confirm the changes in the request restriction window and in the module mapping.  Upon confirmation, we will get a warning about whether we really want to allow this ISAPI extension, click yes. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Allow this extension</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/788/cd8/0f4/788cd80f4f1443c5814370d40bd041d0.png"><br></div></div><br><ul><li>  Add a handler required to enable it, since by default it will not be launched, for this we will find and select it in the list of handlers and in the action panel click the change of function permissions and in the opened window check the execution and confirm the changes. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Change function permissions</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/00e/973/d59/00e973d59b374877a90b530334ff66e5.png"><br></div></div><br></li><li> To work properly, you need to configure authentication for the entire site in IIS.  In the central pane, in the IIS category, select authentication and disable anonymous authentication and enable basic authentication.  Again, if this item is absent in IIS, you need to add this feature in Windows components. <br><br><div class="spoiler">  <b class="spoiler_title">Authentication</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/a78/441/671/a784416710de4f6a81a3478f5251b610.png"><br></div></div><br></li><li>  The next step we need to bind the SSL certificate to the site, I will not describe the procedure for obtaining the certificate, since there is plenty of this information everywhere, including in Habrahabr. <br><br><ul><li>  We get an SSL certificate for example, on startssl and form a PFX file. </li><li>  In IIS Manager for the IIS server itself, select server certificates in the central pane and select import in the action pane, specify the path to the stored certificate and its password. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Import certificate</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/99e/e25/097/99ee250972074153a65fb397048628de.png"><br></div></div><br><ul><li>  After importing, we again select the site in the dispatcher and in the action panel we select bindings and in the opened window we select to add.  Select the https type and in the list the SSL certificate select the one that you imported in the previous step and confirm the changes.  Binding for http can be removed as unnecessary. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Add a binding</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/2e9/884/d65/2e9884d65e3f43e4ae6fe7e16cbe7b6d.png"><br></div></div><br></li><li>  The last step in configuring IIS is to check the service. To do this, go to this address <a href="">https://server.domain.com/rcu/replisapi.dll?diag</a> and enter the Windows username and password (I recommend creating a separate user for each publication).  If the connection is successful, diagnostic information should appear, as in the screenshot below. <br><br><div class="spoiler">  <b class="spoiler_title">Diagnostic information</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/005/4e0/e21/0054e0e21fd54df1ac3b1b8069098982.png"><br></div></div></li></ol><br><h3>  Creating and setting up a publication </h3><br><ol><li>  Connect to the central server with Microsoft SQL Server 2014 Standard via Management Studio in Object Explorer -&gt; Replication -&gt; Local Publication -&gt; New Publication (in the context menu), then follow the steps of the New Publication Wizard.  At this stage, setting up merge replication using web synchronization is no different from setting on the local network. <br><br><ul><li>  Select a database for publication. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Base selection</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/d42/247/a1e/d42247a1eee34f87bac57e603df97882.png"><br></div></div><br><ul><li>  Select the type of replication - merge replication (Merge) </li></ul><br><div class="spoiler">  <b class="spoiler_title">Replication type</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/8e1/503/61b/8e150361b9c04019b359bbcfcc17f9c7.png"><br></div></div><br><ul><li>  Choose which versions of SQL Server replication is compatible with.  I usually use SQL Server 2005 and SQL Server 2008 and older, as there are quite weak machines. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Compatibility</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/3f2/b1d/bc7/3f2b1dbc758e4236bb9ed46622001d03.png"><br></div></div><br><ul><li>  Specify which tables will participate in the synchronization.  I would like to additionally note if synchronization will take place infrequently, and there will be a lot of records on some tables, I recommend increasing the values ‚Äã‚Äãfor Publisher range size and Subscriber range size, for example, to 1,000,000. It is not recommended to set more, because the range can quickly will end with a large number of subscribers and frequent re-creation, I also want to note if Automatically manage identity ranges are used, increase the percentage to highlight the new range when the threshold reaches a threshold, for example, 90-95. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Tables</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b0d/bf8/873/b0dbf887322e45cd845951b51e80ca88.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Publisher and Subscriber Range</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/27c/d14/30c/27cd1430cea940efb51bd5fff9ef6258.png"><br></div></div><br><ul><li>  We leave this step unchanged for all tables. A column with a unique identifier will be added. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Unique identifier (optional)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/243/d64/b8f/243d64b8f9eb4664a63e9703dd64b772.png"><br></div></div><br><ul><li>  We leave the filtering of synchronized data unchanged, if you need filtering, you can add it at any time. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Filtering (optional)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/a99/827/beb/a99827bebe7940e5a0d1578aacf4e0ff.png"><br></div></div><ul><li>  Specifying a schedule for taking a snapshot, this step can also be left as default or you can change its schedule as you like. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Snapshot (optional)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/e32/d8f/823/e32d8f8233164b73839ddd6c976746c4.png"><br></div></div><br><ul><li>  Specify security settings for the snapshot agent.  Select in the settings ‚ÄúExecute SQL Server Agent with service account‚Äù and connect with the publisher ‚ÄúBy impersonating the process account‚Äù and confirm the changes. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Agent security</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/7d7/f6c/93f/7d7f6c93f7cc4fc9bc7f0052e514b1ae.png"><br></div></div><br><ul><li>  We leave the next step without a default in it to confirm the creation of the publication and generate a script for the completed steps to create the publication. </li><li>  Specify the name of the publication and click Finish.  Usually, for convenience, I write the name like ‚Äúdatabase_name_pub‚Äù </li></ul><br><div class="spoiler">  <b class="spoiler_title">Publication name</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/f9d/830/07f/f9d83007f7564c9c92f8c9f71bc8e28e.png"><br></div></div><br><ul><li>  We wait until the creation of the publication is completed and check that all the items are completed correctly. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Creating a publication</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/695/102/2e2/6951022e2a9a40a5b518570339baa363.png"><br></div></div><br></li><li>  After creating the publication we need to make additional settings.  To do this, select the created publication in the Object Explorer -&gt; Replication -&gt; Local Publication -&gt; publication_name and open the settings. <br><br><ul><li>  In the basic settings, we point out that subscriptions never expire, this is necessary if it is planned that subscribers can be offline for a long time and there will not be many transactions.  Otherwise, specify after what period the replication metadata will be deleted. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Subscription Term</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/6e1/214/4e3/6e12144e3cc74e3cab97ac94343f2833.png"><br></div></div><br><ul><li>  In the snapshot settings, we specify an alternative location for storing the snapshot, while the directory must be available for public access on the network and the path to the directory must be indicated as network.  In this example, it will be \\ Replication \ ftproot.  Also set the compression for the snapshot in this folder. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Snapshot Location</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/31d/40d/533/31d40d5332ad4311ab55a8847fdd3708.png"><br></div></div><br><ul><li>  Next, in the FTP and Internet settings for the snapshot (FTP Snapshot and internet), we allow synchronization of subscribers via the web server, and also specify the address of the previously created site <a href="">https://server.domain.com/rcu/replisapi.dll</a> </li></ul><br><div class="spoiler">  <b class="spoiler_title">Subscribers Sync</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/4bf/573/b43/4bf573b439e943a7b4a68631a4000a98.png"><br></div></div><br><ul><li>  The final step in setting up a publication is to add a user to the Publication Access List.  We create the user in advance for each publication, then add it to the MSSQL Server, match it with the database for publication and indicate membership in the db_owner role. </li></ul><br><div class="spoiler">  <b class="spoiler_title">User mapping</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/144/a67/64e/144a6764ef9b48448df6773d4962d4da.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Publication Access List</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/77c/e7d/659/77ce7d659fbb4d9bb86351d630e060ad.png"><br></div></div></li></ol><br><h3>  Subscription creation and synchronization </h3><br><ol><li>  It is necessary to create subscriptions for web synchronization using scripts, not through a wizard, because we will have to perform synchronization with the subscription on demand, and also because the agent cannot be started on MSSQL Server Express.  Scripts in any case turns out much faster. <br><br><ul><li>  In the beginning we will add the subscriber on the central server with the publication </li></ul><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> EXEC sp_addmergesubscription @publication = N<span class="hljs-string"><span class="hljs-string">'Microinvset_pub'</span></span>, <span class="hljs-comment"><span class="hljs-comment">--    @subscriber = 'Kassa01-PC', --     @subscriber_db = N'MicroinvestFront', --        @subscription_type =N'pull';</span></span></code> </pre> <br><ul><li>  Next, add a subscription on request already on the subscriber </li></ul><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> EXEC sp_addmergepullsubscription @publisher = <span class="hljs-string"><span class="hljs-string">'MainServer'</span></span>, <span class="hljs-comment"><span class="hljs-comment">--      @publication = N'Microinvset_pub', --    @publisher_db = N'Microinvest'; --     </span></span></code> </pre><br><ul><li>  Also on the subscriber we add the task for the agent to synchronize the subscription on demand </li></ul><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> EXEC sp_addmergepullsubscription_agent @publisher = <span class="hljs-string"><span class="hljs-string">'MainServer'</span></span>, <span class="hljs-comment"><span class="hljs-comment">--      @publisher_db = N'Microinvest', --      @publication = N'Microinvest_pub', --    @distributor = 'MainServer', --      @use_web_sync = 1, --  WEB . @internet_security_mode = 0, --   ,        (    ,    HTTP). @internet_url = 'https://server.domain.com/rcu/replisapi.dll', --      @internet_login = '  Windows,          ', @internet_password = '  Windows,          ', @internet_timeout = 9999; --           -</span></span></code> </pre><br></li><li>  Finally we get to the most important one before the first synchronization, as the Express edition of MSSQL has already written before, it doesn‚Äôt allow the built-in agent to be launched, but nobody forbids you to make your agent using RMO, we‚Äôll go more simply and start the merge agent manually using which then simply put in the Windows scheduler. <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> OFF <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> Publisher=MainServer <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> Subscriber=Kassa01-PC <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> PublicationDB=Microinvest <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> SubscriptionDB=MicroinvestFront <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> Publication=Microinvest_pub <span class="hljs-built_in"><span class="hljs-built_in">REM</span></span> --    REPLMERG.EXE      MSSQL Server "C:\Program Files\Microsoft SQL Server\<span class="hljs-number"><span class="hljs-number">120</span></span>\COM\REPLMERG.EXE" -Publication <span class="hljs-variable"><span class="hljs-variable">%Publication%</span></span> -Publisher <span class="hljs-variable"><span class="hljs-variable">%Publisher%</span></span> -Subscriber <span class="hljs-variable"><span class="hljs-variable">%Subscriber%</span></span> -Distributor <span class="hljs-variable"><span class="hljs-variable">%Publisher%</span></span> -PublisherDB <span class="hljs-variable"><span class="hljs-variable">%PublicationDB%</span></span> -SubscriberDB <span class="hljs-variable"><span class="hljs-variable">%SubscriptionDB%</span></span> -DistributorSecurityMode <span class="hljs-number"><span class="hljs-number">1</span></span> -SubscriptionType <span class="hljs-number"><span class="hljs-number">1</span></span> -SubscriberSecurityMode <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br></li><li>  Upon completion of synchronization, you will see approximately the following information in the CMD, as in the screenshot. <br><br><div class="spoiler">  <b class="spoiler_title">Total Sync Start</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/5d7/be7/f67/5d7be7f672df4ceb9d87fda13f0e28db.png"><br></div></div><br></li><li>  You can monitor the progress of replication, as before through the replication monitor. <br><br><div class="spoiler">  <b class="spoiler_title">Replication monitor</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/adf/6d0/dbd/adf6d0dbdf9b46f1ad41bd0f7da74392.png"><br></div></div></li></ol><br><h3>  Afterword </h3><br>  Web synchronization is configured, we can only place the batch file created above into the Windows scheduler and run it automatically, for example, once every 5-10 minutes, of course, if required.  When you start the batch file and the synchronization will constantly pop up a window from the CMD, to avoid this, you can run the batch file through WScript.exe, for example, like this: <br><br><pre> <code class="hljs vbscript"><span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> WshShell = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>) WshShell.Run <span class="hljs-string"><span class="hljs-string">"startsync.bat"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> WshShell = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> WScript.Quit</code> </pre><br>  After that, this script is specified to run in the scheduler.  In addition to synchronization, I‚Äôll note that if you plan on quite large data transfers, you may need to increase the value for WebSyncMaxXmlSize.  This parameter is configured in the registry HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Microsoft SQL Server \ 120 \ Replication \, be careful with this setting, since as the value increases, the amount of virtual memory consumed also increases. <br><br><h3>  Links </h3><br><ol><li>  <a href="https://msdn.microsoft.com/ru-ru/library/ms151763(v%3Dsql.120).aspx">Web synchronization for merge replication</a> </li><li>  <a href="https://msdn.microsoft.com/ru-ru/library/ms147343(v%3Dsql.105).aspx">How to synchronize a subscription on demand (replication programming)</a> </li><li>  <a href="https://msdn.microsoft.com/ru-ru/library/ms147890(v%3Dsql.105).aspx">How to synchronize a subscription on demand (programming RMO objects)</a> </li></ol><br>  I tried to point out all the nuances that I myself had to face, even if they could not be very commonplace, but such banality sometimes can take a lot of time, especially if you don‚Äôt know where to look. <br><br>  Thanks to everyone who has mastered the article to the end, I will be glad to any of your comments. </div><p>Source: <a href="https://habr.com/ru/post/278953/">https://habr.com/ru/post/278953/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278943/index.html">OpenConfig - a standardized approach to configuring network equipment</a></li>
<li><a href="../278945/index.html">Android runtime permissions. Why, why, and how</a></li>
<li><a href="../278947/index.html">Speed ‚Äã‚ÄãDevelopment Unity3D games for the competition</a></li>
<li><a href="../278949/index.html">Spiceworks research: insider threats will be the biggest information security challenge in 2016</a></li>
<li><a href="../278951/index.html">We collect Electron.js rake or desktop JS-applications in practice</a></li>
<li><a href="../278955/index.html">An error in the AMD processor microcode allows virtual machine users to access the hypervisor host system</a></li>
<li><a href="../278957/index.html">ScribeJava - even your grandma can work with OAuth</a></li>
<li><a href="../278959/index.html">A fresh look at the Oracle VM VirtualBox code</a></li>
<li><a href="../278961/index.html">Reinforced.Typings - TypeScript Angular services directly from your MVC controllers</a></li>
<li><a href="../278963/index.html">"Festive Chef" at FBD, step by step</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>