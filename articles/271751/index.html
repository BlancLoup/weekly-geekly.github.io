<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deploy Drupal 8 with Docker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In honor of the long-awaited release of Drupal 8, today I will tell you how to install it using Docker . 



 First, why briefly do it at all, what ad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deploy Drupal 8 with Docker</h1><div class="post__text post__text-html js-mediator-article">  In honor of the long-awaited <a href="https://www.drupal.org/ru/8">release of Drupal 8,</a> today I will tell you how to install it using <a href="https://ru.wikipedia.org/wiki/Docker">Docker</a> . <br><br><img src="https://habrastorage.org/files/efa/ccc/d87/efacccd8718547298ddc664fb5048624.png"><br><a name="habracut"></a><br>  First, why briefly do it at all, what advantages does it give: <br><br><ul><li>  <u>Independence from the host.</u>  If you need to migrate the site to another hosting, it will be much easier to do, because  in fact, the whole site is a set of containers, which no matter where they are launched </li><li>  <u>Cloning.</u>  If you need to create a new instance of the site, for example for development or testing, it will be enough to clone the containers. </li><li>  <u>Compatibility of the server environment.</u>  Often, the difference in package versions or the absence of some kind of extension on different environments leads to non-obvious bugs.  Using the same containers in different environments helps to avoid this. </li><li>  <u>Insulation.</u>  Isolation of the docker by design is useful when you have several sites or instances of a site on one server (a high load on one site will not affect the others).  Although it is somewhat peculiar </li><li>  <u>Optimum server environment</u> .  It's not a secret that the same nginx, php and mysql / mariadb need to be able to optimally configure, in the case of the docker you can find public containers on the <a href="https://hub.docker.com/">docker hub</a> , collected by other people specifically for your version of drupal </li><li>  <u>Scaling</u> .  Each container can be scaled both vertically (add resources) and horizontally (clone and distribute the load via load balancer) </li></ul><br>  A short remark for those who are not familiar with drupal: any experienced drupist (I have been working with drupal for 6 years already) knows that the flexibility and architectural beauty of drupal has to be paid for with performance, so all this talk about the need for optimization, scaling and caching did not appear flat spot 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, let's start.  Since the eight does not have normal modules for integration with redis / memcached (for storing the internal cache) and varnish (cache reversing proxy server), we will assemble the environment without them, we will manage with only two containers: a web server (php + apache2) and database (mariadb aka fork mysql). <br><br>  For the demonstration, we will raise the smallest droplet (VPS) on DigitalOcean with Ubuntu 14.04 x64. <br><br>  We connect to the virtual machine via ssh under the root, for ease of demonstration, we chop off the default ufw firewall in order to avoid its configuration: <br><br><pre><code class="bash hljs">root@drupal8-docker:~<span class="hljs-comment"><span class="hljs-comment"># ufw disable Firewall stopped and disabled on system startup</span></span></code> </pre> <br>  Install the docker: <br><br><pre> <code class="bash hljs">root@drupal8-docker:~<span class="hljs-comment"><span class="hljs-comment"># wget -qO- https://get.docker.com/ | sh</span></span></code> </pre><br>  Check that everything is OK: <br><br><pre> <code class="bash hljs">root@drupal8-docker:~<span class="hljs-comment"><span class="hljs-comment"># docker -D info Containers: 0 Images: 0 Server Version: 1.9.1 Storage Driver: aufs Root Dir: /var/lib/docker/aufs Backing Filesystem: extfs Dirs: 0 Dirperm1 Supported: false Execution Driver: native-0.2 Logging Driver: json-file Kernel Version: 3.13.0-68-generic Operating System: Ubuntu 14.04.3 LTS CPUs: 1 Total Memory: 490 MiB Name: drupal8-docker ID: GUMM:PUBZ:VJOF:52B7:ZIEN:UCJC:4QA2:BSP5:UGSW:FGPV:AZY6:ASZD WARNING: No swap limit support</span></span></code> </pre><br>  Here we see that not a single container has been launched yet, not a single image has been downloaded, the docker version and so on.  By default, the <a href="https://docs.docker.com/engine/userguide/storagedriver/aufs-driver/">AUFS</a> file system is <a href="https://docs.docker.com/engine/userguide/storagedriver/aufs-driver/">used</a> , which allows the docker to use the versioning of his images as a gita.  Those.  When you update the image, you will not download everything from scratch, but only a new layer will be downloaded. <br><br>  We go further, now we need to download our images.  If you do not specify an absolute path, then by default the image will be searched on <a href="https://hub.docker.com/">hub.docker.com</a> , download the <a href="https://hub.docker.com/_/mariadb">official mariadb image</a> .  Since we do not specify a tag (version), the latest tag is used. <br><br><pre> <code class="bash hljs">root@drupal8-docker:~<span class="hljs-comment"><span class="hljs-comment"># docker pull mariadb</span></span></code> </pre><br>  In the output, you will see how all the layers (versions) of the image are downloaded: <br><br><img src="https://habrastorage.org/files/7f5/1a7/f21/7f51a7f213dc4548b6f84fa2d7a52bf9.png" alt="docker pull" title="docker pull"><br><br>  Now we download the <a href="https://hub.docker.com/_/drupal/">official image of the drupal</a> , indicating the tag we need.  According to the <a href="https://github.com/docker-library/drupal/blob/898b3178e7d1737347fe0602726b38c4bb300330/8/Dockerfile">Dockerfile</a> from which the image is assembled, we see that the image is taken as the basis of the <a href="https://hub.docker.com/_/php/">official php 5.6 image with Apache</a> , then additional libraries and php extensions are installed, such as gd, pdo and opcache.  Then the recommended opcache settings are set and the drupal itself is downloaded. <br><br><pre> <code class="bash hljs">root@drupal8-docker:~<span class="hljs-comment"><span class="hljs-comment"># docker pull drupal:8.0.0</span></span></code> </pre><br>  See the list of docker images: <br><br><pre> <code class="bash hljs">root@drupal8-docker:~<span class="hljs-comment"><span class="hljs-comment"># docker images REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE drupal 8.0.0 ddddc055c2c2 5 days ago 570.9 MB mariadb latest b8ba0befc716 6 days ago 302.1 MB</span></span></code> </pre><br>  They weigh quite a lot, because both images are compiled under Debian Jessie with their APT package system, which pulls in a lot of heavy dependencies. <br><br>  Now we start the container with mariadb, with the key v (--volume) we tell the docker to create a mounted partition from the host node where the database data will be stored, by default if this is not done, the data will be stored inside the container and lost when the container is rebuilt (this can will need to apply new mariadb updates).  In response to the command launch, the hash (identifier) ‚Äã‚Äãof the running container is displayed. <br><br><pre> <code class="bash hljs">root@drupal8-docker:~<span class="hljs-comment"><span class="hljs-comment"># docker run -e MYSQL_ROOT_PASSWORD=admin -e MYSQL_DATABASE=drupal8 -e MYSQL_USER=drupal8 -e MYSQL_PASSWORD=drupal8 -v mariadb:/var/lib/mysql -d --name mariadb mariadb 5a288bef768a000a28c0e482b8424007c606e8d0967703099f967ff6617ceb34</span></span></code> </pre><br>  Now we start the drupal with a link to the mariadb just launched and binding to port 80.  A link is essentially an entry in / etc / hosts, pointing to the IP of the container with mariadb in the virtual network created by the docker during installation. <br><br><pre> <code class="bash hljs">docker run --name drupal8 --link mariadb:mysql -p 80:80 -d drupal:8.0.0</code> </pre><br>  Check out docker ps to make sure that both containers are running: <br><br><img src="https://habrastorage.org/files/ec1/e1d/19d/ec1e1d19db1e4407a2f83542fae7ef8a.png" alt="docker ps" title="docker ps"><br><br>  Go to our IP address in the browser and see the Drupal installer: <br><br><img src="https://habrastorage.org/files/4b4/eb7/be0/4b4eb7be086041cb89cf3f2df3e44a52.png" alt="drupal 8 installation" title="drupal 8 installation"><br><br>  There should be no problems with the installation, the only thing is that on the settings page of the database you need to specify mysql instead of localhost in the place of the host, by this name we created a binding above. <br><br><img src="https://habrastorage.org/files/51a/b27/000/51ab270002824fbaa137ce3cfb6a473e.png" alt="drupal 8 installation" title="drupal 8 installation"><br><br>  Hooray!  Enjoying a freshly installed drupal. <br><br><img src="https://habrastorage.org/files/a27/e9a/a31/a27e9aa3156b48b7a027e5f44e640ca2.png" alt="drupal 8 installation" title="drupal 8 installation"></div><p>Source: <a href="https://habr.com/ru/post/271751/">https://habr.com/ru/post/271751/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271739/index.html">PostCSS quick start</a></li>
<li><a href="../271741/index.html">Welcome to GDG DevFest Omsk 2015</a></li>
<li><a href="../271745/index.html">Successful implementation of SIEM. Part 1</a></li>
<li><a href="../271747/index.html">Asterisk: Prioritizing VoIP traffic and reserving Internet access from two providers on MikroTik</a></li>
<li><a href="../271749/index.html">DotNext - Conference on .NET-technologies, Moscow, December 11</a></li>
<li><a href="../271755/index.html">MultiSim: technological SIM-phony for several operators and one subscriber</a></li>
<li><a href="../271757/index.html">Comparative analysis of shopping carts</a></li>
<li><a href="../271759/index.html">Creating The Blacksmith: Staging, Shading and Lighting</a></li>
<li><a href="../271761/index.html">Development of fast mobile applications on Android. Part one</a></li>
<li><a href="../271763/index.html">Give us a flash revolution! How to quickly and safely go to flash drives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>