<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How medical routing works - we tell on the example of the DOC + application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Every smartphone has GPS sensors, sensors, and an internet connection - they dramatically reduced the technological threshold for solving logistics pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How medical routing works - we tell on the example of the DOC + application</h1><div class="post__text post__text-html js-mediator-article">  Every smartphone has GPS sensors, sensors, and an internet connection - they dramatically reduced the technological threshold for solving logistics problems.  Now we are confronted with complex routing systems almost every day, even if we do not even notice it.  With their help, we drive around traffic jams, order a taxi, get food delivery.  Each of these yuzkeys has its own characteristics - routes must be rebuilt as data is updated, drivers must find passengers, food must remain hot. <br><br>  At DOC +, we also faced a routing task ‚Äî we had to ensure the efficiency of our field doctors.  That's how we solved it. <br><br> <a href="https://habr.com/company/docplus/blog/433032/"><img src="https://habrastorage.org/webt/4k/xb/lb/4kxblbnvlnahocisxpynjoqh5k0.png"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>"If you get sick, you can not go to the clinic - the doctor <a href="https://docplus.ru/">DOC +</a> will come to your home"</i></font> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  At the start: call the doctor </h2><br>  We are not just ‚Äúdriving people down‚Äù with doctors according to the Uber principle.  We are a full-fledged medical company, with a staff of physicians and limited human resources.  When a call comes to us, we, first of all, determine how to help the client: in some cases, our specialists can provide advice remotely, in other situations (if it is a matter of too serious an accident) we explain that our service is not a complete replacement ambulance or emergency room.  If it seems to you that something threatens your life, we will tell you who to address. <br><br>  In all other cases, the application is considered valid and is confirmed by the dispatcher.  Users of the application can call any available doctor with the necessary specialization, or his beloved doctor, if he is working that day and has the opportunity to reach the patient at a convenient time for him.  For an emergency call, the doctor arrives in the next two hours.  In a normal call, the doctor will arrive either within the next four hours from the moment of the call, or - if the patient chooses the inspection time in advance - at a time interval chosen by the client (in this case, the interval can be reduced to two hours - the system will help you choose a specific time interval taking into account the doctors' load ). <br><br><h2>  Road to patient </h2><br>  Time, as a doctor, and patients - a valuable resource that is important to use wisely.  Therefore, in order to minimize the cost of travel and the intervals between receptions, the full route of his movements and work is built for each shift of the doctor.  The route begins and ends with a specialist at home and automatically changes as orders arrive.  At the same time, we try to calculate the route so that the movements are as convenient as possible, without abrupt movements between distant points on the map.  Roughly speaking, a doctor is sent to the other end of Moscow only if someone specifically ordered his or her services (which explains the premium of this option), or an urgent call has come that no one else can accept. <br><br>  Doctors move around the city in a convenient way for them, which they determine at the beginning of the shift.  Owners of a driver's license can use a private car, car sharing or corporate car for this, the rest - public transport or taxi. <br><br>  The waiting time for the doctor is calculated by our <b>MIRA</b> auto <b>-dispatching system</b> .  All applications in the system are displayed on a map of the city and are marked with different markers.  Statuses can be as follows: <br><br><ul><li>  a doctor is appointed; </li><li>  accepted the application; </li><li>  on my way; </li><li>  leads reception; </li><li>  finished reception. </li></ul><br>  The doctor changes these statuses independently in his application, and MIRA monitors and takes them into account when rebuilding the routes of other specialists. <br><br>  Technologically, the MIRA system (Mildly Intellectual Routing Algorithm) solves the ‚Äú <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25B4%25D0%25B0%25D1%2587%25D0%25B0_%25D0%25BA%25D0%25BE%25D0%25BC%25D0%25BC%25D0%25B8%25D0%25B2%25D0%25BE%25D1%258F%25D0%25B6%25D1%2591%25D1%2580%25D0%25B0">traveling salesman problem</a> ‚Äù, in which you need to choose the optimal sequence of visits to cities and then return to the original city, but with some differences. <br><br><blockquote>  In particular, we do not have one traveling salesman, but many doctors (each has his own shift, starting and finishing points), while all the challenges at the beginning of the day are unknown - the situation changes dynamically (new doctors come out, applications come in or change). <br><br>  Also in our case, additional restrictions are introduced, for example, the doctor must get to the application in a certain time window, plus you have to take into account the wishes of the patients and the doctors themselves. </blockquote><br>  The closest to our task, found in the scientific literature, is called "The problem of dynamic routing of a fleet of vehicles, taking into account time intervals" ( <a href="https://www.researchgate.net/publication/272011756_Multi-depot_vehicle_routing_problem_with_time_windows_under_shared_depot_resources">PDF</a> ).  Its essence is to minimize the total transportation costs when calculating car routes with constantly changing parameters: time windows, the length of the path, the number of cars and the number of parking spaces at destination points. <br><br>  Our MIRA system also faces the challenge of minimizing the cost of making all calls in constantly changing conditions.  When resolving it, the system takes into account the cost of all doctor transfers (including arriving home), doctor‚Äôs salaries, the cost of being late for calls and the doctor‚Äôs downtime without a call, the waiting time for customers.  At the same time, MIRA has to handle unforeseen situations (for example, the patient has an urgent business at the time of the call) - in this case, the operator enters new data, and the system recalculates everything. <br><br>  When calculating the doctor‚Äôs route, the doctor‚Äôs <b>home address</b> is chosen as the starting and ending point.  The remaining points are <b>patient addresses</b> .  During the day, the system regularly calculates and updates each route.  To assess the time it takes for the doctor to reach the patient, the following factors are taken into account: <br><br><ul><li>  Some patients need more attention than others.  And sometimes the doctors themselves have a force majeure situation.  This may cause delays, which are counted first. </li><li>  The time that the doctor spends on preparing for departure is added.  Since external factors do not affect the performance of this task, this time is the same for all employees. </li><li>  The waiting time for a taxi or public transport is the same average rate, which was experimentally detected, and it grows with distance from the Moscow Ring Road. </li><li>  Using the data of OpenStreetMap and OSM Routing Machine, the time that the route you would take without traffic jams is calculated. </li><li>  The Machine Learning model trained on historical data adjusts this number depending on the location of the doctor, the projected traffic situation, time of year and time of day.  The model uses the history of travel of our doctors in a taxi. </li><li>  Finally, a fixed time is added to this, which the doctor can spend on finding a patient‚Äôs apartment. </li></ul><br>  Estimation of the ‚Äútime to reach‚Äù is optimized by the meta-heuristic algorithm once a minute, taking into account new data, new calls and cancellations. <br><br><blockquote>  We use metaheuristics, since our problem is NP-complete, and the search for an exact solution in a reasonable time is a problem that has not been solved yet.  Metaheuristic algorithms allow you to do a search (but not a complete search) and find, perhaps, not the best, but ‚Äúgood‚Äù solutions. </blockquote><br>  As an algorithm, we chose <a href="https://en.wikipedia.org/wiki/Tabu_search">TabuSearch</a> because of its good speed.  When searching for the optimal path, TabuSearch takes into account the prehistory of the search and does not consider those routes that he had once viewed and found to be non-optimal. <br><br>  In order not to disappoint customers, we predict the arrival time of the doctor with a margin.  If, for an unforeseen reason, we do not comply with these deadlines, we notify the client in advance (and if the call was listed as urgent, then we do not take an extra charge for urgency in a situation where we do not have time to arrive within two hours of the call). <br><br><img src="https://habrastorage.org/webt/ab/2j/7p/ab2j7p4szafwimxxy8niqz-rhf8.png"><br>  <font color="#A9A9A9"><i>Illustration from our blog ‚Äú <a href="https://tolkosprosit.docplus.ru/blog/posts/intensive-care">Just Ask</a> ‚Äù</i></font> <br><br><h2>  While the doctor is driving ... </h2><br>  Responsibility for communication with the client before the arrival of the doctor are dispatchers.  They are the links between the doctor and the patient.  Half of the contact center employees have medical education, and the rest studied social disciplines.  Their work is governed by strict internal standards, and no algorithms will replace them.  This is what they do while the doctor goes to you: <br><br><ul><li>  Working with a consulting physician, dispatchers perform an initial assessment of the severity of the client‚Äôs condition.  At the same time, they do not just interrogate the client, but also try to provide him with psychological support, if necessary. </li><li>  While the doctor is on the way, they take questions of a medical nature and refer them to the staff of the medical department.  They can ask the deputy head doctor or the doctor who is now free from calling. </li><li>  If the client needs to contact the doctor who visits him, the dispatchers, monitoring the doctor‚Äôs workload, organize a call back. </li><li>  If the system is heavily loaded, and there are not enough specialists for everyone, such as during epidemics, dispatchers invite non-scheduled doctors who are not on the schedule. </li></ul><br>  But perhaps most importantly, they are responsible for "settling" the most problematic situations that may arise in the process of planning medical schedules. <br><br><h2>  Emergency situations </h2><br>  If everything goes smoothly, the doctor arrives on time, fills out a medical card, examines the patient and switches to a new client.  But in order to boldly guarantee people such a streamlined service, you need to have systems that provide it. <br><br>  In the early days of the service dispatchers just followed the doctors on the map.  On it you could see who is where and what he does - with the client, on the road or just doing nothing.  The current load does not allow this, so the resolution of most problem situations is automated. <br><br>  Thanks to the efforts of the dispatcher team and data analysis team, more than 90% of the appointments are done using an automated system.  In the remaining cases (the client urgently asked to change the time of the reservation, force majeure from doctors, strong unplanned traffic jams), the operator himself makes the appointment. <br><br>  An example of an emergency situation is the following scenario: <br><br><blockquote>  <i>The doctor has a shift from 8 to 20. He is scheduled for a morning call with a reservation from 8 to 10. At 8 in the morning the doctor did not open the shift.</i>  <i>The system understands this and at 8:05 creates the corresponding ticket.</i>  <i>Operators should contact the doctor and decide whether to move the shift a bit or remove it from the doctor.</i>  <i>If nothing is done before 8:15, and the doctor hasn‚Äôt succeeded, then when building the routes, MIRA stops counting on it (until the doctor replaces or the operator makes manual adjustments).</i> </blockquote><br>  Situations that affect the deadlines for the execution of an application are also automatically detected and converted into standard tickets.  These ticket operators are allowed manually.  For example, if a doctor is delayed at the reception, his other patients will know about it even before he is released.  If the doctor does something wrong - he is late for the shift, ‚Äúfreezes‚Äù, or does not follow the contents of the first-aid kit and the presence of forms, the dispatcher immediately receives the corresponding report form. <br><br>  In particular, we have an order that standardizes the styling composition ‚Äî the equipment in the doctor‚Äôs first-aid kit and the number of inspection forms ‚Äî at the beginning of each shift, and the doctor is obliged to follow it.  To replenish the package, the doctor must call in the office once a week.  All this is controlled by the 1C ERP system. <br><br>  If for some reason an employee leaves for a shift without the necessary equipment, the operator will remove it from the line and send it to the office.  Although we have not yet had a single case when the doctor reported the end of the "consumables" right in front of the client's door. <br><br><hr><br>  <i>At first glance, such nuances as the contents of the first-aid kit do not affect the ‚Äúconstruction of the path from point A to point B‚Äù.</i>  <i>However, they are directly related to the movements of doctors, and therefore, with their routing.</i>  <i>Therefore, for us, routing is quite a complex set of logistic tasks.</i> <i><br><br></i>  <i>The work of our service is provided both by <b>technologies</b> (applications, artificial intelligence systems and machine learning), and by <b>specialists</b> who can speak and listen: only when all these elements work in conjunction, service is at a height.</i> <br><br><hr><br>  <i>We have the thematic magazine ‚Äú <a href="https://tolkosprosit.docplus.ru/blog/">Just ask</a> ‚Äù - there we discuss the most popular questions about modern medicine:</i> <i><br><br></i> <ul><li>  <i><a href="https://tolkosprosit.docplus.ru/blog/posts/zakon-i-poryadok">7 patient rights that everyone needs to know</a></i> </li><li>  <i><a href="https://tolkosprosit.docplus.ru/blog/posts/privivki-na-domu">There is a question: why vaccinations are not done at home?</a></i> </li><li>  <i><a href="https://tolkosprosit.docplus.ru/blog/posts/second-opinion">What is a "second opinion" and when to apply for it</a></i> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/433032/">https://habr.com/ru/post/433032/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433012/index.html">Maybe I'm only alive because of her: why do apnea patients rely on a program written by a hacker?</a></li>
<li><a href="../433014/index.html">Jokes about the recent astronauts in outer space</a></li>
<li><a href="../433016/index.html">Interface changes, multi-layer animation and structured visual chaos: a review of web trends for 2019</a></li>
<li><a href="../433018/index.html">UDB. What is it? Part 2. Datapath</a></li>
<li><a href="../433030/index.html">Live: front end performance</a></li>
<li><a href="../433034/index.html">SpEL injection</a></li>
<li><a href="../433036/index.html">Tips for organizing IT in small business</a></li>
<li><a href="../433038/index.html">Why do marketers learn programming?</a></li>
<li><a href="../433042/index.html">Intel will release the processor with three-dimensional architecture Foveros in 2019</a></li>
<li><a href="../433044/index.html">OpenJDK source code contains too many expletives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>