<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JavaScript Cross Site (XSS) POST</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, Dojo has the opportunity to make cross site POST requests, i.e. sending POST requests to other sites with other domain names. This event wen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JavaScript Cross Site (XSS) POST</h1><div class="post__text post__text-html js-mediator-article">  Recently, Dojo has the opportunity to make cross site POST requests, i.e.  sending POST requests to other sites with other domain names.  This event went unnoticed in our community of JavaScript developers.  At least no one said a word about it.  And in vain ... <br><br>  At one fine moment <a name="habracut"></a>  needed the ability to make cross-site POST requests.  Naturally understanding that at the moment browser security prohibits cross-site AJAX, the option to use Flash-AJAX bundle was chosen.  But all the same, I personally like ‚Äúclean‚Äù JavaScript solutions.  Therefore, until the end we are still not satisfied.  Recently in the morning being in the alpha state of sleep, I dreamed of the principle on the basis of which, XSS POST can be implemented using only JavaScript.  The essence of XSS POST implementation is based on the data storage features in the window.name property.  Thoughts came through the recent series of articles on the Internet about window.name.  Having rummaged in Google, at once there was already ready implementation.  (Looks like a dream, not only me).  Dojo as always ahead of the rest of the planet <a href="http://www.sitepen.com/blog/2008/07/22/windowname-transport/">www.sitepen.com/blog/2008/07/22/windowname-transport</a> .  Well done. <br><br><br><h1>  How it works </h1><br>  The principle of operation is described in some detail by the previously mentioned link.  In a nutshell: if you change the window.name property, it remains changed while the browser (tab tab) is open.  If you change a property on one site, you can then read it on another.  Those.  when moving from site to site, the browser does not clear window.name.  Moreover, this window.name value storage mechanism works in all browsers.  XSS POST transport uses this great feature.  In other words: when sending data to another server, the following happens: <br><ol><li>  load the page from another site / domain </li><li>  this page leaves its mark in window.name </li><li>  back to your website / domain </li><li>  read left trace from window.name </li></ol><br>  In addition, to send a POST request, use the trick with the target attribute of the form element (principle of the AJAX Uploader, Gmail Uploader files). <br>  The response from the site to which the request is sent should be in the following format: <br> <code>&lt;script&gt; <br> window.name = '  ,   '; <br> &lt;/script&gt;</code> <br>  Accordingly, this approach does not allow taking data without the knowledge of the owner of another site, because the answer must be formed in a specific format.  This circumstance keeps safety and protects from XSS scrabing.  Those.  in fact, this is somewhat similar to the mechanism for resolving cross-domain requests (cross-domain.xml) in Flash. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <br><h1>  In more detail </h1><br><ol><li>  An iframe is created and the handler is hung on the onload event. </li><li>  If you just need a GET request, then the iframe in the src attribute is set to the URL address of the resource.  If a POST request is needed, a form is dynamically created.  The address of the resource is already indicated in the action attribute of the form object, and the parameters are passed in the input elements (name = parameter name, value = parameter value).  To associate an iframe with a form (form), it has the same identifier (id attribute) as iframe.  After the form is generated, the form form method is simply called.  Request made. </li><li>  The callback function specified in the iframe works after the data has loaded.  In our case, a <code>&lt;script&gt;window.name=''&lt;/script&gt;</code> structure is loaded and the data falls into the name property of the contentWindow object.  The task handler is to retrieve this data.  And if you make an appeal to iframe.contentWindow.name, it will be denied access.  To get around this problem you need to return to your domain, this is done by changing the value of the attribute of the location of the contentWindow object.  For example, you can specify an address on an empty blank.html from your own domain or simply write ‚Äúabout: blank‚Äù (iframe.contentWindow.location = 'about: blank').  After that, you can read the data from the name attribute. </li></ol><br><br><h1>  Regarding the current implementation from Dojo </h1><br>  After analyzing their development <br>  <a href="">dojox.io.windowName.js</a> we found a number of significant flaws: <br><ol><li>  Strong dependence on the core, which weighs quite "sour." </li><li>  The need for a "resources / blank.html" file. </li></ol><br>  In addition: <br><ol><li>  we didn‚Äôt like the code, our subjective opinion is a dirty code. </li><li>  for FireFox, additional ‚Äúgestures‚Äù are applied (comment in the source code regarding this: FF2 allows unsafe sibling frame modification) - to be honest, we didn‚Äôt understand what exactly ... </li></ol><br>  We wanted to improve the current state of XSS POST and, accordingly, wrote our implementation, which is much smaller in volume, self-contained and not tied to any of the libraries, the code is cleaner and more optimal.  Compare and judge for yourself: <br><ul><li>  <a href="http://code.google.com/p/fullajax/downloads/detail%3Fname%3Dsrax.xss.js">source code srax.xss.js</a> </li><li>  <a href="http://fullajax.ru/temp/xss/">Usage example</a> </li></ul><br>  Call example: <br><blockquote> <code><font color="black">SRAX.XSS.post( <font color="#A31515">'http://okarta.ru/scripts/post-xhr.php'</font> , <font color="#A31515">'a=a1&amp;b=b2'</font> , <font color="#0000ff">function</font> (text){ <br> alert(text) <br> })</font> <br> <br></code> </blockquote><br><br>  XSS POST in our implementation will be further refined and developed, respectively, will acquire more methods and parameters.  Who is interested, can always download a newer version. <br>  As always, there is a common drawback: when using an iframe to transfer data, a history appears in the browser, i.e.  Activates the back button.  Can anyone know how to insert an iframe without triggering a story?  It was great to eliminate this flaw. <br><br><br><h1>  Why do you need it </h1><br>  For a long time there are mechanisms for XSS GET data request.  To this day, they are often enough to solve more problems.  But still, sometimes there are times when the limitations of GET requests do not allow to solve the necessary problem qualitatively.  For example, the Google AJAX Language API is implemented on XSS GET requests and has a limit on the number of characters to be translated per request ‚Äî 500 characters.  Now with XSS POST, this restriction can be safely removed.  There are other cases where XSS POST is vital.  XSS POST transport even very useful to competent specialists. <br><br><h6>  The author of the article is Ruslan Sinitsky, the co-author is KM Aleksandrov. ( <a href="http://m007.habrahabr.ru/">M007</a> ) <br></h6></div><p>Source: <a href="https://habr.com/ru/post/41669/">https://habr.com/ru/post/41669/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../41662/index.html">DES encryption compression feature on JRuby</a></li>
<li><a href="../41663/index.html">Announcement YUI 2.6.0</a></li>
<li><a href="../41664/index.html">Habrakat RSS</a></li>
<li><a href="../41665/index.html">Speed ‚Äã‚Äãup your site. Table of contents</a></li>
<li><a href="../41668/index.html">We are dreaming about phones</a></li>
<li><a href="../41672/index.html">What annoys you in Gmail?</a></li>
<li><a href="../41673/index.html">The behavior of the windows when you click the mouse.</a></li>
<li><a href="../41674/index.html">FPPP - and can we give gifts too?</a></li>
<li><a href="../41677/index.html">Live broadcasts with HighLoad ++</a></li>
<li><a href="../41678/index.html">Spam defense for sites: alternative methods</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>