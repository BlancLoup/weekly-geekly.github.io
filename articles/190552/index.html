<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fluid Dynamics Simulation: Lattice Boltzmann Method</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Simulation of a volcanic eruption 
 using Lattice Boltzmann Method. (c) Source 

 In this article I will talk about the numerical method for modeling ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fluid Dynamics Simulation: Lattice Boltzmann Method</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b4e/1c6/1e4/b4e1c61e4b80bae70599ef1d82c093a8.jpg" alt="Eruption"><br>  Simulation of a volcanic eruption <br>  using Lattice Boltzmann Method.  (c) <a href="http://www.palabos.org/gallery/incompressible-isothermal-flow/22-volcanic-eruption">Source</a> <br><br>  In this article I will talk about the numerical method for modeling hydrodynamics <a href="http://en.wikipedia.org/wiki/Lattice_Boltzmann_methods">Lattice Boltzmann Method</a> , LBM.  In Russian, the Boltzmann method of lattice equations.  It is superior to other well-known methods (for example, the <a href="http://en.wikipedia.org/wiki/Finite_element_method">finite element method</a> ) in ease of parallelization, the ability to simulate multiphase flows, modeling flows in porous media.  In addition, the computational algorithm contains only the simplest arithmetic operations.  The method is very new, the first commercial products based on it began to appear around 2010. <br><a name="habracut"></a><br>  On Habr√© has already been a <a href="http://habrahabr.ru/post/178145/">series of articles</a> on the physics of fluid, and this article may be its logical continuation.  It is written in such a way as to be useful to people who know hydrodynamics and modeling methods well, and understandable to beginners in this area (for example, people with education software engineer).  Of course, in this regard, many things will be too detailed for experts, and some will not have enough space.  The article was quite large, but I would not want to break it into several parts. <br><br>  Why is all this necessary?  More precisely, in which branches it is necessary to model hydrodynamics: <br><ul><li>  aircraft, rocket, automotive (body characteristics, engine performance, nozzles) </li><li>  industrial chemistry (separation of substances, chemical reactors) </li><li>  meteorology, geology (fluid flows through porous media, sandstones, dams) </li><li>  other engineering industries (wind power) </li><li>  medicine (blood flow, lymph) </li></ul><br>  The article will include the following sections: <br><ul><li>  Physics Review - High-level overview of basic equations needed </li><li>  The main idea ‚Äî the description of the basic principle of the algorithm </li><li>  Technical details ‚Äî a more detailed explanation of the initial equations, the derivation of a computational scheme <br><ul><li>  Navier-Stokes equation </li><li>  Boltzmann equation </li><li>  Discrete boltzmann equation </li><li>  Illustration of computational scheme </li><li>  Spatial lattices </li><li>  Equilibrium distribution functions </li><li>  Incompressibility </li><li>  Viscosity and reynolds number </li><li>  Once again all together </li></ul><br></li><li>  miscellanea <br><ul><li>  Additions to the algorithm </li><li>  Underwater rocks </li><li>  Existing solutions </li><li>  What to read </li></ul><br></li></ul><br><h4>  Physics review </h4><br>  Hydro and aerodynamics are macroscopically described <a href="http://en.wikipedia.org/wiki/Navier%25E2%2580%2593Stokes_equations">by the Navier-Stokes equation</a> .  It shows what the pressure, density and velocity of the fluid will be at each point in space at each moment in time ‚Äî depending on the initial and boundary conditions and environmental parameters. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      On the other hand, for rarefied gases, <a href="http://en.wikipedia.org/wiki/Boltzmann_equation">the Boltzmann equation is</a> true, which describes how the density of the particle velocity distribution varies at each point in space with time.  If we integrate the distribution of particles over the velocities at a given point, we can obtain the density and macroscopic velocity at a given point.  In other words, macroscopically, the Boltzmann equation is equivalent to the Navier-Stokes equation. <br><br><h4>  main idea </h4><br>  Despite the fact that for dense liquids, the Boltzmann equation is not applicable, if we learn to model it, we can also model the Navier-Stokes equation for these fluids.  That is, we thereby replace the underlying level of abstractions (microscopic equation for dense liquids) with a physically incorrect implementation (microscopic equation for rarefied gases), but so that the upper level (the macroscopic Navier-Stokes equation) is described correctly. <br><br>  The situation is illustrated in the picture below. <br><img src="https://habrastorage.org/getpro/habr/post_images/298/583/c22/298583c2233d6c3cd1cd872974357eaa.png" alt="Lattice Boltzmann Method Idea"><br><br>  The question mark in it symbolizes the fact that I do not know which equation describes the behavior of dense liquids at the microscopic level.  Sometimes, instead of ‚Äúmicroscopic,‚Äù they say ‚Äúmesoscopic‚Äù ‚Äîin the sense that a microscopic description is a description of the behavior of individual atoms and molecules, and the Boltzmann equation describes flows of molecules. <br><br>  Since the computer does not know how to work with continuous values, we need to discretize the Boltzmann equation: by time, by spatial coordinates (we get spatial nodes for modeling) and by possible directions of particles in each spatial node.  Directions are chosen in a special way, and always point to some neighboring nodes. <br><br><h4>  Technical details </h4><br>  This large section contains a more detailed explanation of the initial equations and the derivation of a computational scheme.  Really important equations should be clear to all readers with technical education (the basics of linear algebra, integral calculus are required).  Those equations that are incomprehensible, most likely, are not important (they are those where there is <a href="http://en.wikipedia.org/wiki/Nabla_symbol">nabla</a> ).  Vectors are indicated in bold. <br><br><h5>  Navier-Stokes equation </h5><br>  A variant of the equation for the macroscopic dynamics of incompressible liquids and gases is as follows: <br><img src="https://habrastorage.org/getpro/habr/post_images/f63/094/e6a/f63094e6a874fe5c89101731ea2afcde.png" alt="Navier-Stokes equation">  (one) <br><br>  here v is the flow velocity, œÅ is the density of the fluid, p is the pressure in the fluid, f is the external forces (for example, gravity). <br><br>  If you do not know what inverted triangles and partial derivatives are ‚Äî do not worry, we will not need them later, and the computational algorithm contains only the simplest arithmetic operations. <br><br>  A detailed conclusion and the physical meaning can be studied on <a href="http://en.wikipedia.org/wiki/Navier%25E2%2580%2593Stokes_equations">Wikipedia</a> and <a href="http://habrahabr.ru/post/171327/">Habr√©</a> , but I will give the main idea here. <br><br>  Mentally allocate a certain small volume in a liquid and follow its movement.  The acceleration acting on a given volume of fluid is determined by (i) the pressures of the left, right, top, bottom, etc.  (besides, they partially compensate each other), (ii) by the action of internal friction forces in a liquid (iii) by external forces.  On the other hand, the acceleration can be expressed in terms of the velocity difference at the initial moment of time at the initial point and at some next moment in time at the new point where the fluid volume will be. <br><br>  If we now substitute these values ‚Äã‚Äãinto the Newton equation F = ma, after some simple transformations, we get the equation above.  On the left is ma, on the right ‚Äî F. <br><br><h5>  Boltzmann equation </h5><br>  This equation operates on the function of the probability density distribution of particles in terms of coordinates and velocities, f (r, v, t).  The value of f (x, y, z, v <sub>x</sub> , v <sub>y</sub> , v <sub>z</sub> , t) dx dy dz dv <sub>x</sub> dv <sub>y</sub> dv <sub>z</sub> shows what proportion of particles at time t is in a cube from x to x + dx, from y to y + dy, from z to z + dz with speeds in the range from v <sub>x</sub> to v <sub>x</sub> + dv <sub>x</sub> , from v <sub>y</sub> to v <sub>y</sub> + dv <sub>y</sub> , from v <sub>z</sub> to v <sub>z</sub> + dv <sub>z</sub> .  It can also be written as <img src="https://habrastorage.org/getpro/habr/post_images/fff/632/522/fff632522c1ed76267458a760d95c4f4.png" alt="f (r, v, t) d ^ 3r d ^ 3v">  . <br><br>  This function is usually normalized to the mass of gas in the system under study, therefore the macroscopic gas density at each point is defined as the sum (integral) of the probability density at a given point over all possible values ‚Äã‚Äãof velocity, <br><img src="https://habrastorage.org/getpro/habr/post_images/460/ea4/1b0/460ea41b04293cdd1cc2acf748e5497f.png" alt="Density">  .  (2) <br>  Similarly, macroscopic speed can be determined by <br><img src="https://habrastorage.org/getpro/habr/post_images/a56/5f3/0df/a565f30df6e731cd28e03f025272d796.png" alt="Velocity">  .  (3) <br><br>  The basic idea for deriving an equation is similar to the derivation of the Navier-Stokes equation.  Let's mentally select at a given time in a given small volume a bundle of molecules flying in a given direction (more precisely, a narrow cone of directions).  After a short period of time dt, they will be at the next point (due to the presence of speed), their speed itself will change due to the acceleration of molecules by external forces.  In addition, on this segment of the path, some molecules will collide with others, change their speed, and we can no longer include them in the original beam.  On the other hand, as a result of collisions of molecules in the same volume, flying in the other direction, some of them will acquire the desired direction of speed, and we will add them to the beam. <br><br>  This can be written in the following form: <br><img src="https://habrastorage.org/getpro/habr/post_images/75b/64e/8a3/75b64e8a39ee08b4d701767e6168f63f.png" alt="Boltzmann derivation, f \ left (\ mathbf {r} + \ mathbf {v} dt, \ mathbf {v} + \ frac {\ mathbf {F}} {m} dt, t + dt \ right) \, d ^ 3 \ mathbf {r} \, d ^ 3 \ mathbf {v} - f (\ mathbf {r}, \ mathbf {v}, t) \, d ^ 3 \ mathbf {r} \, d ^ 3 \ mathbf {v} = dN_ {coll}">  ,          (four) <br>  where F is the external force, m is the mass of the molecule, dN <sub>coll is the</sub> change in the number of particles in the beam due to collisions. <br><br>  As the value of dN <sub>coll</sub> is determined in general terms, it will remain hidden from the reader.  We need only its standard approximation, <a href="http://en.wikipedia.org/wiki/Bhatnagar%25E2%2580%2593Gross%25E2%2580%2593Krook_operator">Batnagar-Gross-Crook</a> (BGK).  In this approximation, dN <sub>coll</sub> equals <br><img src="https://habrastorage.org/getpro/habr/post_images/b77/e39/0d1/b77e390d1c1a1e8652f94bff584d5b54.png" alt="BGK approximation, - \ frac {f - f ^ {eq}} {\ tau} d ^ 3 \ mathbf {r} \, d ^ 3 \ mathbf {v} dt">  ,          (five) <br>  where f <sup>eq is the</sup> equilibrium distribution function, the <a href="http://en.wikipedia.org/wiki/Maxwell-Boltzmann_distribution">Maxwell-Boltzmann distribution</a> , and œÑ is the so-called <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D1%2580%25D0%25B5%25D0%25BC%25D1%258F_%25D1%2580%25D0%25B5%25D0%25BB%25D0%25B0%25D0%25BA%25D1%2581%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8">relaxation time</a> . <br><br>  As a result, we get <br><img src="https://habrastorage.org/getpro/habr/post_images/c57/925/70b/c5792570b29bc9ac5e900c2a0ee6f47a.png" alt="Boltzmann derivation, f \ left (\ mathbf {r} + \ mathbf {v} dt, \ mathbf {v} + \ frac {\ mathbf {F}} {m} dt, t + dt \ right) \ - f ( \ mathbf {r}, \ mathbf {v}, t) \ = - \ frac {f - f ^ {eq}} {\ tau} dt">  .  (6) <br>  Note that f <sup>eq</sup> depends on the macroscopic density and velocity at a given point (that is, implicitly on the coordinate and time).  It is this equation that we will need in the future, but usually it is divided by dt and lead to <br><img src="https://habrastorage.org/getpro/habr/post_images/5ad/31e/dda/5ad31eddaf91d2228811ebff5ff9c3cf.png" alt="Boltzmann equation, \ frac {\ partial f} {\ partial t} + \ mathbf {v} \ cdot \ nabla f + \ frac {\ mathbf {F}} {m} \ cdot \ nabla _ {\ mathbf {v}} f = - \ frac {f- f ^ {eq}} {\ tau}">  , (7) <br>  where <a href="http://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B0%25D0%25B1%25D0%25BB%25D0%25B0">nabla</a> with index v is nabla in variable speeds. <br><br><h5>  Discrete boltzmann equation </h5><br>  In order to be able to model the dynamics of the continuous Boltzmann equation on a computer, we need to sample it.  To do this, we first introduce a uniform grid of spatial coordinates ‚Äî let the grid step be the same across all axes.  The behavior of the fluid, we will determine it in the grid nodes.  In fact, we only allow molecules to exist in certain spatial nodes.  In addition, we must discretize time ‚Äî we will determine the state of the fluid at equidistant moments of time.  In addition, we will allow the molecules to have only certain values ‚Äã‚Äãof speed ‚Äî such that they have time to move to some neighboring node in a time step.  These allowed directions will be the same for all spatial nodes.  It is obvious that in the diagonal directions the speed of the particles will be greater than in the non-diagonal. <br><br>  Intuitively, it can be concluded that with an infinitely small time step and a spatial lattice step, this discrete system transforms into the usual Boltzmann equation, which, in turn, passes to the Navier-Stokes equation in the macroscopic limit.  Oddly enough, this is not such a simple question, and we will postpone it for now. <br><br>  In the following exposition it is assumed everywhere that the system of units is such that the lattice spacing is a unit of length, and the time step is a unit of time. <br><br>  For simplicity, below we assume that there are no external forces.  We enumerate the allowed speed directions from 1 to Q with the index i.  If now the mass of particles flying from a given node in the direction of i in a time step is designated as f <sub>i</sub> , then equation (6) will go to <br><img src="https://habrastorage.org/getpro/habr/post_images/974/921/60f/97492160f412794dbdf0a84938bae549.png" alt="Discrete Boltzmann, f_i \ left (\ mathbf {r} + \ mathbf {v} _i, t + 1 \ right) \ - f_i (\ mathbf {r}, t) \ = - \ frac {f_i - f_i ^ {eq }} {\ tau}">  .  (eight) <br>  Here we took into account that the time step is equal to one, and replaced all dt from (6) by one.  f <sub>i</sub> <sup>eq</sup> denotes a discrete equilibrium distribution density, depending on the macroscopic mass and velocity at a given node.  We did not specify from which node we would use f <sub>i</sub> <sup>eq ‚Äî</sup> from r + v <sub>i</sub> t at time t + 1 or from r at time t.  For the computational scheme, it is more convenient to use the node r + v <sub>i</sub> t at the moment of time t + 1. Then the equation above can be decomposed into two components, the distribution (streaming step) and the collision (collision step). <br><br>  Streaming step: <br><img src="https://habrastorage.org/getpro/habr/post_images/974/921/60f/97492160f412794dbdf0a84938bae549.png" alt="Streaming, \ tilde {f} _i \ left (\ mathbf {r} + \ mathbf {v} _i, t + 1 \ right) \ = f_i (\ mathbf {r}, t) \,">  .  (9) <br>  Collision step: <br><img src="https://habrastorage.org/getpro/habr/post_images/40b/c9b/ddd/40bc9bddd236e39fa92a641af1acf8b3.png" alt="Collision, f_i \ left (\ mathbf {r}, t \ right) \ = \ tilde {f} _i (\ mathbf {r}, t) \ - \ frac {\ tilde {f} _i - f_i ^ {eq} } {\ tau}">  .  (ten) <br><br>  Here f <sub>i</sub> with a tilde denotes the mass of particles that have come to the node in the direction i, but have not yet collided with the rest of the particles.  Streaming step is sometimes called advection step. <br><br>  For discrete velocity directions, the mass and macroscopic velocity at each node will be calculated as <br><img src="https://habrastorage.org/getpro/habr/post_images/064/e2f/25b/064e2f25b3c82bd230579cd5553577aa.png" alt="Density and velocity discrete, \ rho = \ sum_ {i} f_i, \ rho \ mathbf u = \ sum_ {i} f_i \ mathbf v_i">  .  (eleven) <br><br>  Hereinafter, we write density everywhere instead of mass, since with a single spatial lattice spacing there is a unit volume for each node, and the mass and density coincide in value. <br><br>  We will show that the equilibrium distribution functions depend on the mass in the nodes and the macroscopic velocity.  Therefore, after the streaming step, it is necessary to recalculate the masses and velocities at each node, recalculate the equilibrium distribution functions, and then perform a collision. <br><br>  Thus, at each step of the computational scheme, it is necessary to ‚Äúdistribute‚Äù particles, that is, to move particles flying from node r in direction i to node r + v <sub>i</sub> (do this for all particles and directions).  After this, it is necessary to recalculate masses, velocities, and equilibrium distribution functions.  Finally, it is necessary to ‚Äúcollide‚Äù particles that have flown into a given node ‚Äî that is, to redistribute the particles in directions. <br><br><h5>  Illustration of computational scheme </h5><br>  We illustrate the computational scheme on the example of a two-dimensional system.  The discretization into spatial nodes and the relations between them (that is, the allowed directions of velocity) are shown in the figure below.  Spatial nodes are indicated by circles, the connections between them are thin lines. <br><img src="https://habrastorage.org/getpro/habr/post_images/12a/ad2/68c/12aad268cc8066da2675ab30412713c3.png" alt="D2Q9"><br><br>  The following image shows one iteration of the streaming / collision pair.  Colored arrows represent the flow of flying molecules.  The intensity of the color encodes the mass of molecules flying in a given stream, the length of the arrows roughly corresponds to the path that the stream passes over the time step (only approximately, since the arrows must go from the center of the node to the center of the node). <br><img src="https://habrastorage.org/getpro/habr/post_images/73c/77d/42b/73c77d42b80426b0b1af7c0a58d5616f.png" alt="CollisionAdvection"><br><br><h5>  Spatial lattices </h5><br>  In LBM, lattice (lattice) refers to the set of allowed velocity vectors (the same for each spatial node).  This is consistent with the standard <a href="http://en.wikipedia.org/wiki/Crystal_structure">mathematical definition</a> of the lattice as an entity, with the help of which the entire spatial grid can be obtained by means of parallel translations. <br><br>  In LBM, any lattice must contain a zero vector from a node to itself ‚Äî it describes particles that do not fly anywhere from a given node.  In LBM, lattices are usually denoted by the abbreviation DnQm, where n is the dimension of space, m is the number of vectors in the lattice.  For example, D2Q9, D3Q19, etc. <br><br>  In a two-dimensional LBM space, the lattice can consist, for example, of 5 vectors (2 vertical, 2 horizontal and zero vector from a node into itself), and maybe 9 vectors, as in the illustration above (2 vertical, 2 horizontal, 4 diagonal, one null).  These are the D2Q5 and D2Q9 grids, respectively. <br><br>  Obvious factors for the choice of gratings are: 1. modeling accuracy (intuitively, the more vectors in the grid, the more accurate the modeling) 2. computational costs (calculation on the D2Q5 grid will be faster than the calculation on D2Q9).  Oddly enough, these are not the most important factors.  The most important factors are the reproducibility of the Navier-Stokes equations and the symmetry of some tensors built on lattice vectors. <br><br>  The gratings D2Q9, D3Q15, D3Q19 are commonly used.  The grilles D2Q9 and D3Q19 are shown below.  The basis vectors of the lattice are usually denoted as e <sub>i</sub> or c <sub>i</sub> (they coincide with the velocities v <sub>i</sub> , introduced earlier at a single time step).  Below we will use the notation e <sub>i</sub> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a8f/422/f7d/a8f422f7db993e7a2e875f851b0e6a3c.png" alt="D2Q9"><img src="https://habrastorage.org/getpro/habr/post_images/cd6/3cb/94e/cd63cb94ec45376d1ca03a32de586324.png" alt="D3Q19"><br><br>  We write the basic vectors for D2Q9: <br><img src="https://habrastorage.org/getpro/habr/post_images/d9a/04d/43d/d9a04d43d148b81ec33e920299bcc5a5.png" alt="D2Q9 vectors \ bold {e} _i = \ begin {cases} (0,0) &amp; i = 0 \\ (1,0), (0,1), (- 1,0), (0, -1) &amp; i = 1,2,3,4 \\ (1,1), (- 1,1), (- 1, -1), (1, -1) &amp; i = 5,6,7,8 \ \ \ end {cases}">  (eleven) <br><br>  and for D3Q19: <br><img src="https://habrastorage.org/getpro/habr/post_images/82c/994/f55/82c994f55cee7eefc3975630867d57d7.png" alt="D3Q19 vectors \ bold {e} _i = \ begin {cases} (0,0,0) &amp; i = 0 \\ (\ pm 1,0,0), (0, \ pm 1,0), (0, 0, \ pm 1) &amp; i = 1,2, ..., 5,6 \\ (\ pm 1, \ pm 1,0), (\ pm 1,0, \ pm 1), (0, \ pm 1, \ pm 1) &amp; i = 7,8, ..., 17,18 \\ \ end {cases}">  (12) <br><br>  Let me remind you once again that everywhere we assume that the time step is equal to one, therefore v <sub>i</sub> = e <sub>i</sub> . <br><br><h5>  Equilibrium distribution functions </h5><br>  In the continuous case, the equilibrium distribution function ( <a href="http://en.wikipedia.org/wiki/Maxwell-Boltzmann_distribution">Maxwell-Boltzmann distribution</a> ) is equal to <br><img src="https://habrastorage.org/getpro/habr/post_images/d52/9a6/d49/d529a6d497034922d95892b09d0512fb.png" alt="Maxwell distribution, f ^ {eq} = \ frac {\ rho} {(2 \ pi RT) ^ {D / 2}} e ^ {- \ frac {(\ bold {v} - \ bold {u}) ^ 2} {2RT}}">  .  (13) <br><br>  Here there are no previously encountered quantities: R is the <a href="http://en.wikipedia.org/wiki/Gas_constant">universal gas constant</a> , T is the temperature, D is the dimension of space, v is the velocity vector, the probability density for which we find.  Here, the molar mass of the gas is taken equal to unity (it is not important for us ‚Äî only macroscopic density is important).  It can be considered a change in the unit of mass in our simulation.  In addition, the function is normalized to local macroscopic density, and not per unit.  Note also that usually the macroscopic gas velocity u is not subtracted from v.  This is because the distribution is usually investigated in the case of a stationary gas, we also need to go to a local inertial reference system moving with the current gas velocity at a given point at a given time to use the Maxwell-Boltzmann distribution.  Subtracting u is such a transition. <br><br>  Suppose that at a given point in space, the velocity distribution of molecules turned out to be equilibrium.  This distribution depends on the macroscopic mass œÅ and the velocity u.  On the other hand, we can calculate œÅ and u from the distribution function (see formulas (2) and (3)).  Obviously, this calculation should give correct œÅ and u (that is, in a sense, this is an additional restriction on the distribution function): <br><img src="https://habrastorage.org/getpro/habr/post_images/e75/e62/e34/e75e62e34a9175160d8132c3758e49a2.png" alt="Density equilibrium, \ rho = \ int f ^ {eq} d \ mathbf v">  , <img src="https://habrastorage.org/getpro/habr/post_images/807/88c/d77/80788cd7738d0483a2befacaa23bab21.png" alt="Velocity equilibrium, \ rho \ mathbf u = \ int f ^ {eq} \ mathbf v d \ mathbf v">  .  (14) <br><br>  We impose the same requirement on the density and velocity calculations in the discrete case: <br><img src="https://habrastorage.org/getpro/habr/post_images/441/4c0/20c/4414c020c045dd14fb00e80692502db0.png" alt="Density and velocity discrete equilibrium, \ rho = \ sum_ {i} f ^ {eq} _i, \ rho \ mathbf u = \ sum_ {i} f ^ {eq} _i \ mathbf v_i">  .  (15) <br><br>  The main requirement for discrete equilibrium distribution functions is the reproduction of the Navier-Stokes equation in the limit of an infinitely small time step and lattice step.  This is equivalent to the fact that if, for given œÅ and u, we try to calculate them again from the equilibrium distribution functions in the continuous and discrete case, the results will coincide (see the remark above that in the discrete case instead of density we mean mass), t. e. <br><img src="https://habrastorage.org/getpro/habr/post_images/0d2/ff5/7a6/0d2ff57a6b41a5d3042462138ac23d7e.png" alt="Density and velocity equality, \ rho = \ int f ^ {eq} d \ mathbf v = \ sum_ {i} f ^ {eq} _i, \ rho \ mathbf u = \ int f ^ {eq} \ mathbf vd \ mathbf v = \ sum_ {i} f ^ {eq} _i \ mathbf v">  .  (sixteen) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order to unambiguously determine the equilibrium discrete distribution function, we will also need to include the analogous requirement of equality of macroscopic thermal energies at a given point; we omit it for brevity. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we sum up in the directions of the velocity equation (10) for a collision step, then, taking into account formula (16), it can be shown that the collision step does not change the macroscopic masses and velocities of the molecules in the node. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It turns out that if we simply substitute the discrete velocity vectors e </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from (11) and (12) into the continuous equilibrium distribution function (13), equalities (16) will not be fulfilled.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It also turns out that we can force equalities (16) to hold if we decompose the Maxwell-Boltzmann distribution (13) into a Taylor series to a second order macroscopic velocity. This corresponds to the fact that the value of u / sqrt (RT) is very small. This restriction must always be met during the modeling process on all nodes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But even decomposing into a Taylor series is not enough. We must also introduce </font><font style="vertical-align: inherit;">specially chosen factors w </font><sub><font style="vertical-align: inherit;">i</font></sub><font style="vertical-align: inherit;"> into the sampled functions f </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></sub> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eq</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (the details of the calculations can be found in </font><a href="http://pre.aps.org/abstract/PRE/v56/i6/p6811_1"><font style="vertical-align: inherit;">this</font></a><font style="vertical-align: inherit;"> excellent article ‚Äî there is also a </font><a href="http://research.nianet.org/~luo/Reprints-luo/1997/He-Luo_PRE-1997.pdf"><font style="vertical-align: inherit;">free version</font></a></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><a href="http://pre.aps.org/abstract/PRE/v56/i6/p6811_1"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><a href="http://research.nianet.org/~luo/Reprints-luo/1997/He-Luo_PRE-1997.pdf"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font><font style="vertical-align: inherit;">Of course, everything will turn out to be a little more complicated than in our superficial description ‚Äî in fact, the calculation takes place through tensors, up to the fourth rank, built on lattice vectors). </font><font style="vertical-align: inherit;">Finally we get</font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/7e9/e13/ae6/7e9e13ae6acdbd711bbb65b6ca232d53.png" alt="Maxwell distribution discrete, f^{eq}_i = w_i \rho (1+\frac{\vec{v_i} \cdot \vec{u}}{RT}+\frac{(\vec{v_i} \cdot \vec{u})^2}{2(RT)^2}-\frac{\vec{u}^2}{2RT})">  .  (17) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here lies the catch: we always assume that the lattice spacing and time are units of length and time, respectively. </font><font style="vertical-align: inherit;">Therefore, we cannot take the value of R from SI, and the temperature here is not equal to the temperature of the simulated liquid in Kelvin.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To determine their values, note the following. Suppose there is a disturbance in the fluid ‚Äî that is, there is an excess mass in some nodes. This mass will begin to ‚Äúspread out‚Äù in space, moreover, in the rightmost node in the area of ‚Äã‚Äãperturbation, it will also move in the direction (1, 0, 0) in 3D or (1, 0) in 2D. For a unit of time, molecules along these directions will pass a unit of length, that is, their speed will be equal to unity. This means that the speed of sound as the speed of propagation of disturbances in our system is also equal to one. On the other hand, the speed of sound is equal to sqrt (Œ≥ RT / Œº), where Œ≥ is the </font></font><a href="http://en.wikipedia.org/wiki/Adiabatic_index"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adiabatic constant</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Œº is the molar mass, which we took equal to unity earlier. The adiabatic constant Œ≥ is 1 + 2 / d, where d is the </font></font><a href="http://en.wikipedia.org/wiki/Degrees_of_freedom_(physics_and_chemistry)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">number of degrees of freedom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">molecules. </font><font style="vertical-align: inherit;">In ideal gas it is equal to the dimension of space. </font><font style="vertical-align: inherit;">In our gas, molecules can only move along straight lines connecting nodes, therefore the dimension is not three (or two), but one. </font><font style="vertical-align: inherit;">That is, Œ≥ = 3 and sqrt (3 RT) = 1. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usually in the literature on LBM, ‚Äúspeed of sound‚Äù is understood as</font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/847/67c/7b4/84767c7b4f0e2000c1674f28c11c5743.png" alt="Speed of sound, c_s = \sqrt{RT}=1/\sqrt{3}">  .  (18) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now, finally, </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/197/1e9/08b/1971e908bd925a54d1c51045ba64262b.png" alt="Maxwell distribution discrete, f^{eq}_i = w_i \rho (1+3\mathbf{e}_i \cdot \mathbf{u}+\frac{9}{2}(\mathbf{e}_i \cdot \mathbf{u})^2-\frac{3}{2}\mathbf{u}^2)">  .  (nineteen) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We write the values ‚Äã‚Äãof the coefficients w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for the most common lattices. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For D2Q9:</font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/5f7/d3f/26c/5f7d3f26c9b51a8659a2748860c5909b.png" alt="D2Q9 weights w_i = 
\begin{cases} 
  4/9    &amp; i = 0 \\
  1/9    &amp; i = 1,2,3,4 \\
  1/36   &amp; i = 5,6,7,8 \\
\end{cases}">  (20) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For D3Q19: </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/e2c/cf5/783/e2ccf5783d369ac0463eb5de8ae89217.png" alt="D3Q19 weights w_i = 
\begin{cases} 
  1/3    &amp; i = 0 \\
  1/18    &amp; i = 1,2,...,5,6 \\
  1/36   &amp; i = 7,8,...,17,18 \\
\end{cases}"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(21)</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Incompressibility </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The limitation on the small macroscopic velocity of a fluid can now be written as </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/490/faa/c4d/490faac4d8d37b980b1fbf3b68d3155a.png" alt="Incompressibility, u << speed\ of\ sound = 1">  .  (22) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recall that </font></font><a href="http://en.wikipedia.org/wiki/Mach_number"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Mach number</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the ratio of the characteristic gas velocity in the system to the speed of sound. </font><font style="vertical-align: inherit;">Then the limit above corresponds to small Mach numbers or incompressible fluid. </font><font style="vertical-align: inherit;">Indeed, if the speed of sound (the velocity of propagation of density perturbations) is large, then any density perturbation will quickly spread to the entire system, and the density will again become the same. </font><font style="vertical-align: inherit;">That is, to compress the liquid in any one local area you will not succeed. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A good maximum value for macroscopic speed in nodes will be, for example, 0.01.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Viscosity and reynolds number </font></font></h5><br> <a href="http://en.wikipedia.org/wiki/Viscosity"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The kinematic viscosity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ŒΩ in LBM (as usual in lattice units) is calculated as</font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/860/620/b7f/860620b7f7b54dcc1c887a816d888535.png" alt="Viscosity, \nu = (\tau - 1/2)c^2_s = (\tau - 1/2)/3">  .  (23) <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here œÑ is the relaxation time introduced earlier in formula (5), c </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 1 / sqrt (3) is the ‚Äúspeed of sound‚Äù introduced in (18). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When modeling hydrodynamics exclude any system temperature changes with prescribed geometry (e.g., a pipe with a square cross-section) is completely described by only one parametrom- dimensionless </font></font><a href="http://en.wikipedia.org/wiki/Reynolds_number"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reynolds number</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , equal to </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/b5b/cbe/78a/b5bcbe78a8e00f03d328561b44a99cc8.png" alt="Reynolds, Re = v L / \nu"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, (24) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where v-speed characteristic in the system (e.g., velocity at the center of the pipe ), L is the characteristic length in the system (for example, the length of the side of the square of the section). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For standard geometries, the relationship between characteristic velocity and external force (which provides flow) is usually known. Therefore, for modeling with a given Reynolds number,</font></font><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">choose characteristic speed v. </font><font style="vertical-align: inherit;">As we found out, it should be much less than the speed of sound. </font><font style="vertical-align: inherit;">For example, 0.01.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calculate the required external force for this speed </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calculate the viscosity by (23) so as to obtain the desired Reynolds number </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> calculate the relaxation time by (24) so ‚Äã‚Äãas to obtain the desired viscosity </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If the modeling problem is composed in SI units (they say, the side of the square of the pipe section is 1 m, the pressure at the pipe inlet is X Pascal, and the output is Y Pascal), then you must first find the dimensionless Reynolds number and use the algorithm above. </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Once again all together </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Before modeling it is necessary to set the initial macroscopic masses and velocities at each node. </font><font style="vertical-align: inherit;">Then specify the mass flows in each allowed direction e </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at each node (see Reefs). </font><font style="vertical-align: inherit;">The easiest way is to indicate the flows from the equilibrium distribution. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To simulate in a loop commit</font></font><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streaming step by the formula (9) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recalculation of macroscopic masses and speeds in each node by formulas (11), recalculation of equilibrium flows in all directions according to formula (19) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collision step by the formula (10) </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulation usually occurs until the system is in a stationary state. </font><font style="vertical-align: inherit;">Stationarity can be checked, for example, through the difference in macroscopic velocities and masses at each node between adjacent steps, the maximum among all nodes.</font></font><br><br><h4>  miscellanea </h4><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Additions to the algorithm </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have not touched upon the inclusion of external forces in modeling (for example, gravity). They will lead to a </font></font><a href="http://en.wikipedia.org/wiki/Lattice_Boltzmann_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">small addition</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to equation (9) for the streaming step. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We also did not touch the boundary conditions ‚Äî on the surface of bodies and on the system inlet and outlet (for example, if a constant pressure or velocity field is specified at the pipe inlet). LBM has great freedom in modeling such conditions, since the method is formulated at the microscopic level (molecular flows), and such boundary conditions at the macroscopic level. There are many ways to set boundary conditions at the microscopic level ‚Äî and </font></font><a href="http://wiki.palabos.org/_media/models:boundary_review.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">many algorithms</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The boundary conditions at the boundary of solids in hydrodynamics are usually chosen as the no-slip boundary conditions (that is, when the velocity of the liquid on the surface of the bodies is zero). Usually they are realized through bounce-back conditions (when the flows of molecules are reflected in the opposite direction when crossing a solid wall). This can be read </font></font><a href="http://www.ndsu.edu/fileadmin/physics.ndsu.edu/Wagner/LBbook.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , section 4.6. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The model of the collisions we presented is called single relaxation time. There are more advanced models, for example, </font></font><a href="http://research.nianet.org/~luo/Reprints-luo/2002/dHumieres_PhilTranA-2002.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multiple relaxation time</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (in particular, double relaxation time). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LBM also </font></font><a href="http://www.sciencedirect.com/science/article/pii/S0021999199962575"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">supports multiphase</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (simulating the flow of a mixture of liquids or gases with different parameters).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The presence of heat conduction (that is, heat transfer in the system, temperature changes at different points in the system and, as a result, changes in system parameters ‚Äî for example, density) is </font></font><a href="http://en.wikipedia.org/wiki/Lattice_Boltzmann_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">also </font></font></a> <a href="http://www.sciencedirect.com/science/article/pii/S0021999199962575"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">supported by </font></font></a> <a href="http://journals.cambridge.org/action/displayAbstract%3FfromPage%3Donline%26aid%3D271744"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LBM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Temperature is modeled as a separate "gas", also according to the LBM algorithm, but the velocity of this gas is determined by the velocity of the main fluid. It is said that the temperature in this sense is passive scalar. There are quite a few </font></font><a href="http://www.sciencedirect.com/science/article/pii/S0021999199962575"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">articles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on LBM modeling of </font></font><a href="http://en.wikipedia.org/wiki/Rayleigh%25E2%2580%2593B%25C3%25A9nard_convection"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rayleigh ‚Äì Benard convection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> phenomena </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We didn‚Äôt touch upon the issues of efficient implementation and parallelization.</font></font><br><br><h5>  Underwater rocks </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you are modeling a system with thermal conductivity, then it will be described by two dimensionless quantities. In the case of Rayleigh-Benard convection, </font></font><a href="http://en.wikipedia.org/wiki/Prandtl_number"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Prandtl </font></font></a><font style="vertical-align: inherit;"></font><a href="http://en.wikipedia.org/wiki/Rayleigh_number"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">number</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font><a href="http://en.wikipedia.org/wiki/Rayleigh_number"><font style="vertical-align: inherit;">the Rayleigh number</font></a><font style="vertical-align: inherit;"> are usually chosen </font><font style="vertical-align: inherit;">. In order to reproduce this system in lattice units, it is not enough just to reproduce both of these dimensionless quantities, by correctly setting the internal parameters of the system (characteristic speed, external force, thermal conductivity). The fact is that between the internal parameters there will be hidden dependencies. You can read more </font></font><a href="http://wiki.palabos.org/_media/howtos:lbunits.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As we have already said, when choosing the characteristic speed in the system, do not forget that the Mach number must be much less than one (formula (22)).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LBM can become unstable in some systems at high Reynolds numbers (when the flow, however, is still laminar). </font><a href="http://en.wikipedia.org/wiki/Galilean_invariance"><font style="vertical-align: inherit;">Galilean invariance is </font></a><a href="http://citeseerx.ist.psu.edu/viewdoc/download%3Fdoi%3D10.1.1.9.1032%26rep%3Drep1%26type%3Dpdf"><font style="vertical-align: inherit;">not satisfied</font></a></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in LBM </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">However, it usually does not matter. </font><font style="vertical-align: inherit;">At the beginning of the simulation, it is necessary to specify the flows of molecules from each node in all allowed directions. </font><font style="vertical-align: inherit;">Often choose the equilibrium distribution of flows (formula (19)). </font><font style="vertical-align: inherit;">It is important to remember that equilibrium does not imply stationarity. </font><font style="vertical-align: inherit;">That is, stationary distributions in the presence of velocity gradients, external forces, etc. </font><font style="vertical-align: inherit;">differ from equilibrium. </font><font style="vertical-align: inherit;">Their calculation is given </font><a href="http://wiki.palabos.org/_media/models:boundary_review.pdf"><font style="vertical-align: inherit;">here</font></a><font style="vertical-align: inherit;"> (formulas 12, 19, 20 by reference).</font></font><a href="http://citeseerx.ist.psu.edu/viewdoc/download%3Fdoi%3D10.1.1.9.1032%26rep%3Drep1%26type%3Dpdf"><font style="vertical-align: inherit;"></font></a> <a href="http://en.wikipedia.org/wiki/Galilean_invariance"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><a href="http://wiki.palabos.org/_media/models:boundary_review.pdf"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Existing solutions </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is a large and very mature open-source project entirely dedicated to LBM ‚Äî </font></font><a href="http://www.palabos.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Palabos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (PA Parallel LAttice BOLtzmann). </font><font style="vertical-align: inherit;">The project has a </font></font><a href="http://wiki.palabos.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Developers provide </font></font><a href="http://www.flowkit.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paid advice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on hydrodynamic modeling. </font></font><br><br> <a href="http://wiki.palabos.org/numerics:matlab_samples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are excellent teaching examples of modeling typical MATLAB systems. </font><font style="vertical-align: inherit;">For example, </font></font><a href="http://wiki.palabos.org/numerics:matlab_samples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rayleigh ‚Äì Benard convection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (external force is available, thermal conductivity, boundary conditions, correct translation of quantities). </font><font style="vertical-align: inherit;">Only 160 lines in MATLAB. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are many commercial solutions, for example, </font></font><a href="http://www.exa.com/powerflow.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="http://www.fluidyna.com/content/lbultra"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A detailed list of commercial and non-commercial packages can be found on </font></font></font></font><a href="http://en.wikipedia.org/wiki/Lattice_Boltzmann_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia</font></font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What to read </font></font></font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, you can recommend these lists of </font></font></font></font><a href="http://wiki.palabos.org/literature:articles"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">articles</font></font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font></font></font><a href="http://wiki.palabos.org/literature:books"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">books</font></font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basically a list of books is on </font></font></font></font><a href="http://en.wikipedia.org/wiki/Lattice_Boltzmann_methods"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia</font></font></font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That's all,</font></font></font></font><br><h4>  Thanks for attention! </h4></div><p>Source: <a href="https://habr.com/ru/post/190552/">https://habr.com/ru/post/190552/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../190542/index.html">Course lectures "Startup". Peter Thiel. Stanford 2012. Session 19</a></li>
<li><a href="../190544/index.html">Data Center Risks: Engineering System Redundancy</a></li>
<li><a href="../190546/index.html">Creating a patch on Wix with PatchWiz</a></li>
<li><a href="../190548/index.html">We write our synchronous / asynchronous client-server</a></li>
<li><a href="../190550/index.html">Choosing a Voice VoIP Gateway</a></li>
<li><a href="../190556/index.html">Localization of projects on .NET with an interpreter of functions</a></li>
<li><a href="../190560/index.html">Apportable SDK - Objective-C / Cocoa Touch for Android</a></li>
<li><a href="../190562/index.html">Meetings of the Meet Magento Russia 2013 Conference</a></li>
<li><a href="../190564/index.html">Support for Advanced Format - optimal work with high-capacity disks</a></li>
<li><a href="../190566/index.html">HHVM: testing performance and compatibility with Joomla, Bitrix and Wordpress</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>