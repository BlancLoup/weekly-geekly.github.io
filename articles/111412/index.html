<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Excel is my financial auditor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all. A little background. 
 Like, for sure, any wife, my loves to count money. Moreover, it is not easy: "how much they earned and how much t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Excel is my financial auditor</h1><div class="post__text post__text-html js-mediator-article">  Hello to all.  A little background. <br>  Like, for sure, any wife, my loves to count money.  Moreover, it is not easy: "how much they earned and how much they spent."  No, she divides them into groups and counts them every day.  This business is quite tedious and takes quite a lot of time, which is why I often see my beloved sitting with my back to me.  To make her work easier, and because of my mercenary motives, I made a small accountant. <br><a name="habracut"></a><br>  For several days I was asking what she wanted from the reader.  At the cost of unthinkable efforts turned out to be a rather small list: <br><br><h5>  Requirements </h5><br><ul><li>  Revenue Accounting <br><ol><li>  receipt date </li><li>  Amount received </li><li>  On whose card or cash </li></ol><br></li><li>  Cost Accounting <br><ol><li>  Date of expenses </li><li>  Amount of expenses </li><li>  What to spend </li></ol><br></li><li>  How much money we have left </li><li>  What do we spend money on (graph) </li></ul><br><h4>  Selection </h4><br>  Like any programmer, I had a question: ‚ÄúWhat should I write on?‚Äù.  There were many options from Python to Java.  But, since I am a rather lazy person, I didn‚Äôt want to draw buttons.  And here I looked at Excel more closely.  ‚ÄúSo here is the interface,‚Äù I said to myself.  And the truth is that it can explain even more clearly where your money has gone, than the table (I'm not talking about infographics), and everyone can work with it. <br><br><h4>  Process </h4><br>  So, we create an Excel workbook, there are three sheets by default, that‚Äôs enough for us. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  The first sheet ("Sheet 1") </h5><br>  In the line "1" we enter the date, amount, card / cash, total <br><br><img src="http://img703.imageshack.us/img703/5669/88447253.png" alt="image"><br><br>  So, the column "Date" has the format "Date", "Amount" - Money, rounded to the whole.  With the "Card / Cash" column you have to tinker a bit.  To begin with we will make the list which will fall out in this column. <br>  Press "Ctrl" + "Right Arrow", and we will be in the rightmost column of the sheet.  Here we write the list: <br><ul><li>  My card </li><li>  Wife's card </li><li>  Cash </li></ul><br>  Now we will get on the ‚ÄúD2‚Äù cell and press ‚ÄúCtrl‚Äù + ‚ÄúDown arrow‚Äù.  So we select the entire column without a cap. <br>  Create a drop-down list for these cells.  ‚ÄúData‚Äù -&gt; ‚ÄúVerification ...‚Äù.  In the open window, select "Data Type": "List", and in the "Source" indicate the column in which the list was written, I have an example of "= $ IV: $ IV". <br>  We select the entire column so that if we add an item, we will not need to reassign the menu. <br>  Now our cells have a drop-down list. <br><br><img src="http://img713.imageshack.us/img713/4287/59100596.png" alt="image"><br><br>  And finally, in the column ‚ÄúTotal‚Äù in cells ‚ÄúD2‚Äù: the formula will be like this - "= SUM (B2: B65536)" <br>  The first sheet is ready.  Here will be our income. <br><br><h5>  The second sheet ("Sheet 3") </h5><br>  Here everything is the same, only instead of the column ‚ÄúCard / Cash‚Äù there will be a column ‚ÄúFor what‚Äù, and the drop-down list will change, mine, for example, so far contains such entries. <br><ul><li>  Products </li><li>  Cigarettes </li><li>  Directions </li><li>  Beer </li></ul><br><h5>  The third sheet ("Data") </h5><br>  The most interesting.  Sheet looks like this: <br><img src="http://img407.imageshack.us/img407/6518/92394665.png" alt="image"><br><br>  In cell A2, the formula is "= Sheet1! D2-Sheet3! D2", and add another graph to the sheet. <br><br><img src="http://img833.imageshack.us/img833/9568/82560965.png" alt="image"><br><br>  It seems to me that the circular is clearer. <br><br>  Now create a panel to make it easier to run macros.  Right-click on ToolBar `-&gt;" Settings "button" Create ".  My menu is called ‚ÄúMyToolBar‚Äù, this name will be used in the macro, so if you change, do not forget to change it there. <br>  We have ToolBar, press "Alt" + "F11". <br>  <b>Macro for creating buttons in ToolBar`e:</b> <br><br> <code>Public Sub InitToolBar() <br> Dim cmdBarSm As CommandBar <br> Dim ctlNewbtn As CommandBarButton <br> 'Application.CommandBars("MyToolBar").Controls(" ").Delete <br> 'Application.CommandBars("MyToolBar").Controls(" ").Delete <br> 'Application.CommandBars("MyToolBar").Controls(" ").Delete <br> Set cmdBarSm = Application.CommandBars("MyToolBar") <br> Set ctlNewbtn = cmdBarSm.Controls.Add(msoControlButton) <br> ctlNewbtn.Caption = " " <br> ctlNewbtn.FaceId = 26 <br> ctlNewbtn.OnAction = "getMonth" <br> Set ctlNewbtn = cmdBarSm.Controls.Add(msoControlButton) <br> ctlNewbtn.Caption = " " <br> ctlNewbtn.FaceId = 28 <br> ctlNewbtn.OnAction = "getDay" <br> Set ctlNewbtn = cmdBarSm.Controls.Add(msoControlButton) <br> ctlNewbtn.Caption = " " <br> ctlNewbtn.FaceId = 31 <br> ctlNewbtn.OnAction = "GetGroup" <br> End Sub <br></code> <br>  In the code behind the command to remove these buttons.  For the first time, the macro will have to be run like this, otherwise it swears that it cannot find the buttons. <br>  We created three buttons for calculating costs: By Day, By Month, By Group;  Icons are set in FaceId, called macros in OnAction. <br><br>  <b>So the getMonth macro:</b> <br><br> <code>Sub getMonth() <br> Dim ActSheet As Worksheet <br> Dim BeginCell As Integer <br> Dim SumCell As Integer <br> Dim CurSumCell As Integer <br> Dim NewData As Boolean <br> Dim CurData As Date <br> Dim ValueP As Integer <br> Dim MonthNow As String <br> <br> '   <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Range("A5", "D65536").Select <br> Selection.Clear <br> '   <br> Set ActSheet = Worksheets.Item("3") <br> BeginCell = 2 <br> CurSumCell = 5 <br> ActSheet.Activate <br> <br> While ActSheet.Cells(BeginCell, 1).Value &lt;&gt; Empty <br> NewData = True <br> SumCell = 5 <br> CurData = ActSheet.Cells(BeginCell, 1).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ' <br> While ActSheet.Cells(SumCell, 1).Value &lt;&gt; Empty <br> If MonthName(Month(CurData)) = ActSheet.Cells(SumCell, 1).Value Then <br> NewData = False <br> End If <br> SumCell = SumCell + 1 <br> Wend <br> '   <br> If NewData Then <br> ActSheet.Cells(CurSumCell, 1).Value = MonthName(Month(CurData)) <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Cells(CurSumCell, 3).Value = ActSheet.Cells(CurSumCell, 3).Value + ValueP <br> CurSumCell = CurSumCell + 1 <br> End If <br> ' <br> If Not NewData Then <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Cells(CurSumCell - 1, 3).Value = ActSheet.Cells(CurSumCell - 1, 3).Value + ValueP <br> End If <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> BeginCell = BeginCell + 1 <br> Wend <br> <br> '   <br> Set ActSheet = Worksheets.Item("1") <br> BeginCell = 2 <br> CurSumCell = 5 <br> ActSheet.Activate <br> <br> ' A   <br> While ActSheet.Cells(BeginCell, 1).Value &lt;&gt; Empty <br> NewData = True <br> SumCell = 5 <br> CurData = ActSheet.Cells(BeginCell, 1).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ' <br> MonthNow = ActSheet.Cells(SumCell, 1).Value <br> While ActSheet.Cells(SumCell, 1).Value &lt;&gt; Empty <br> If MonthName(Month(CurData)) = ActSheet.Cells(SumCell, 1).Value Then <br> NewData = False <br> End If <br> SumCell = SumCell + 1 <br> Wend <br> '   <br> If NewData Then <br> ActSheet.Cells(CurSumCell, 1).Value = MonthName(Month(CurData)) <br> Set ActSheet = Worksheets.Item("1") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Cells(CurSumCell, 2).Value = ActSheet.Cells(CurSumCell, 2).Value + ValueP <br> CurSumCell = CurSumCell + 1 <br> End If <br> ' <br> If Not NewData Then <br> Set ActSheet = Worksheets.Item("1") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> If ActSheet.Cells(CurSumCell - 1, 1).Value &lt;&gt; MonthName(Month(CurData)) Then <br> ActSheet.Cells(CurSumCell, 4).FormulaR1C1 = "=RC[-2]-RC[-1]" <br> CurSumCell = CurSumCell + 1 <br> End If <br> ActSheet.Cells(CurSumCell - 1, 2).Value = ActSheet.Cells(CurSumCell - 1, 2).Value + ValueP <br> End If <br> Set ActSheet = Worksheets.Item("1") <br> ActSheet.Activate <br> BeginCell = BeginCell + 1 <br> Wend <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> End Sub</code> <br> <br>  <b>GetDay macro:</b> <br><br> <code>Sub getDay() <br> Dim ActSheet As Worksheet <br> Dim BeginCell As Integer <br> Dim SumCell As Integer <br> Dim CurSumCell As Integer <br> Dim NewData As Boolean <br> Dim CurData As Date <br> Dim ValueP As Integer <br> Dim MonthNow As String <br> <br> '   <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Range("F5", "G65536").Clear <br> '   <br> Set ActSheet = Worksheets.Item("3") <br> BeginCell = 2 <br> CurSumCell = 5 <br> ActSheet.Activate <br> <br> While ActSheet.Cells(BeginCell, 1).Value &lt;&gt; Empty <br> NewData = True <br> SumCell = 5 <br> CurData = ActSheet.Cells(BeginCell, 1).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ' <br> While ActSheet.Cells(SumCell, 6).Value &lt;&gt; Empty <br> If CurData = ActSheet.Cells(SumCell, 6).Value Then <br> NewData = False <br> End If <br> SumCell = SumCell + 1 <br> Wend <br> '   <br> If NewData Then <br> ActSheet.Cells(CurSumCell, 6).Value = CurData <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Cells(CurSumCell, 7).Value = ActSheet.Cells(CurSumCell, 7).Value + ValueP <br> CurSumCell = CurSumCell + 1 <br> End If <br> ' <br> If Not NewData Then <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Cells(CurSumCell - 1, 7).Value = ActSheet.Cells(CurSumCell - 1, 7).Value + ValueP <br> End If <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> BeginCell = BeginCell + 1 <br> Wend <br> <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> End Sub <br></code> <br>  <b>And finally the last getgroup</b> <br> <code>Sub GetGroup() <br> Dim ActSheet As Worksheet <br> Dim BeginCell As Integer <br> Dim SumCell As Integer <br> Dim CurSumCell As Integer <br> Dim NewData As Boolean <br> Dim CurGroup As String <br> Dim ValueP As Integer <br> <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Range("I5", "J65536").Clear <br> Set ActSheet = Worksheets.Item("3") <br> BeginCell = 2 <br> CurSumCell = 5 <br> ActSheet.Activate <br> <br> While ActSheet.Cells(BeginCell, 3).Value &lt;&gt; Empty <br> NewData = True <br> SumCell = 5 <br> CurGroup = ActSheet.Cells(BeginCell, 3).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ' <br> While ActSheet.Cells(SumCell, 9).Value &lt;&gt; Empty <br> If CurGroup = ActSheet.Cells(SumCell, 9).Value Then <br> NewData = False <br> CurSumCell = SumCell + 1 <br> End If <br> SumCell = SumCell + 1 <br> Wend <br> '   <br> If NewData Then <br> If ActSheet.Cells(CurSumCell, 9).Value &lt;&gt; Empty Then <br> CurSumCell = CurSumCell + 1 <br> End If <br> ActSheet.Cells(CurSumCell, 9).Value = CurGroup <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Cells(CurSumCell, 10).Value = ActSheet.Cells(CurSumCell, 10).Value + ValueP <br> CurSumCell = CurSumCell + 1 <br> End If <br> ' <br> If Not NewData Then <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> ValueP = ActSheet.Cells(BeginCell, 2).Value <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActSheet.Cells(CurSumCell - 1, 10).Value = ActSheet.Cells(CurSumCell - 1, 10).Value + ValueP <br> End If <br> Set ActSheet = Worksheets.Item("3") <br> ActSheet.Activate <br> BeginCell = BeginCell + 1 <br> Wend <br> Set ActSheet = Worksheets.Item("") <br> ActSheet.Activate <br> ActiveSheet.Shapes("Chart 1").Select <br> ActiveChart.SetSourceData Source:=Sheets("").Range("I5:J" + CStr(CurSumCell - 1)), PlotBy:= _ <br> xlColumns <br> End Sub <br></code> <br><br>  Here is an interesting moment. <br> <code>ActiveSheet.Shapes("Chart 1").Select <br> ActiveChart.SetSourceData Source:=Sheets("").Range("I5:J" + CStr(CurSumCell - 1)), PlotBy:= _ <br> xlColumns <br></code> <br>  In the Range, do not forget to specify your range, if you, of course, changed the formatting of the "Data" sheet. <br><br><h4>  Conclusion </h4><br>  Now everything is ready.  I, of course, do not pretend to the ideal macro code, but it copes well with its task.  I think that this reader will be useful to many and will save some time to spend it with their loved ones on these New Year holidays. <br></div><p>Source: <a href="https://habr.com/ru/post/111412/">https://habr.com/ru/post/111412/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111401/index.html">How to design programs and their user interfaces, or DISC theory for ‚Äúnon-licenses‚Äù</a></li>
<li><a href="../111402/index.html">Bicubic interpolation, theory and practical implementation</a></li>
<li><a href="../111404/index.html">Answering machine for calls to Skype for Python</a></li>
<li><a href="../111408/index.html">Creating your own archetypes and directories in Maven</a></li>
<li><a href="../111411/index.html">Habr's favorites in PDF</a></li>
<li><a href="../111413/index.html">Molecular Dynamics Programming</a></li>
<li><a href="../111415/index.html">We write our handler task on .NET</a></li>
<li><a href="../111416/index.html">"Vkontakte" - a paradise for the spammer</a></li>
<li><a href="../111417/index.html">Genetic Algorithms in MATLAB</a></li>
<li><a href="../111418/index.html">Basics of JavaScript execution and interaction with sites within Qt programs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>