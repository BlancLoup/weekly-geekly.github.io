<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Source codes of the neural network library on F # for the .NET Framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Periodically, I receive requests for the source codes of neural networks used in my works on the analysis of tonality , text generation , as well as i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Source codes of the neural network library on F # for the .NET Framework</h1><div class="post__text post__text-html js-mediator-article">  Periodically, I receive requests for the source codes of neural networks used in my works on the <a href="http://www.dialog-21.ru/digests/dialog2015/materials/pdf/TarasovDS.pdf">analysis of tonality</a> , <a href="http://www.dialog-21.ru/digests/dialog2015/materials/pdf/TarasovDS2.pdf">text generation</a> , as well as in articles on Habr√©.  Therefore, I decided to post them all in the open access, together with the library on which they rely, despite the rather crude code.  In this article I will write where to get what can be done and a little about how to use.  The library is written in F #, but it can be used from any .NET language. <br><a name="habracut"></a><br>  <b>Implementation</b> <br>  The library for neural networks is written by me in the <a href="http://fsharp.org/">F #</a> language.  Why f #?  In short, F # as a language has the advantages of now popular Python (for example, such as: simple syntax, the ability to run scripts interactively, cross-platform) and is very well suited for rapid prototyping of programs.  But the essential (for me) difference is static strong typing.  F # has such a function as automatic type inference, i.e.  the compiler, without explicitly declaring the types of variables, can determine the type at compile time.  I used to use Python and I can say that I personally switch to F # saves a lot of sleepless debugging nights.  Python has its advantages of course, but for me they did not outweigh the disadvantages. <br><br>  One problem, if today for Python neural network libraries you can choose for every taste and color, then on F #, there are not so many of them.  And at the time of development, the situation was even worse - there were several libraries for the .NET Framework of the Encog type, for example, but new architectures could not be implemented without significant changes.  So I wrote mine from scratch.  This is, in any case, a very useful exercise for anyone who wants to deal with the topic seriously, because it allows a deeper understanding of the basic principles. <br><br>  <b>Opportunities</b> <br>  To date <br><ul><li>  Direct propagation neural networks, arbitrary combinations of layers </li><li>  Recurrent layers.  Training back propagation of the error through time </li><li>  Bidirectional recurrence networks </li><li>  Various activation functions, including softmax and relU, the ability to define its functions </li><li>  Dropout, Noise layers, (you can make autoencoder) </li><li>  Projection layers (for word vectors) </li><li>  One-dimensional text processing convolutional layers, k-max pooling support </li><li>  Training: SGD, SGD + Momentum, RMSProp, RPROP </li><li>  Useful functions for working with texts, counting F1, etc. </li><li>  Save any model to disk and read from disk </li><li>  Work from any .NET language </li><li>  Small size.  In addition to the .Net framework or mono, you do not need to put anything extra. </li><li>  There is an example of code how to make the selection of terms from the text </li><li>  Various experimental additions </li></ul><br>  <b>Minuses:</b> <br><ul><li>  Not high speed work.  True for many applications in the field of language analysis, where the samples are small, this is not essential. </li><li>  The code is not always written beautifully and conveniently (and often just in a hurry).  A lot of things need to be changed. </li><li>  Almost no documentation </li><li>  Some functions do not work as they should, because they were changed to experience and not returned. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I really have no opportunity to bring everything into its proper form, to write and keep up-to-date beautiful documentation and all that.  There is, of course, a weak hope that someone will be interested in this development and will help. <br><br>  What can be useful for?  As a simple library of neural networks to integrate functionality into .NET applications (I recently used to export a branded model from keras to a .NET project).  For experiences.  For those wishing to use F #.  For educational purposes - all code is implemented from scratch on F #, nothing is hidden in various other libraries.  Anyone who asked me for source codes. <br><br>  The tool is suitable for extracting terms from text, classifying texts, and also for generating texts (although this example is not included in the set, but the necessary tools are in the library). <br><br>  <b>Where to get?</b> <br>  <a href="https://github.com/Durham/NeuThink">https://github.com/Durham/NeuThink</a> <br><br>  <b>How to start using?</b> <br>  Here is an example of implementing a simple neural network for the X # function on F #: <br><br><pre><code class="hljs ruby">open NeuThink.Neuron open NeuThink.NeuronTraining let() = let nn = new GeneralNetwork() nn.AddPerceptronLayer(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,[<span class="hljs-params"><span class="hljs-params">|1|</span></span>],<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) nn.AddPerceptronLayer(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,[<span class="hljs-params"><span class="hljs-params">|-1|</span></span>],<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) nn.FinalizeNet() let outputs = [<span class="hljs-params"><span class="hljs-params">|[|</span></span>-<span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-params"><span class="hljs-params">|];[|</span></span>-<span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-params"><span class="hljs-params">|];[|</span></span><span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-params"><span class="hljs-params">|];[|</span></span><span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-params"><span class="hljs-params">|]|</span></span>] let inputs = [<span class="hljs-params"><span class="hljs-params">|[|</span></span><span class="hljs-number"><span class="hljs-number">1.0</span></span>;<span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-params"><span class="hljs-params">|];[|</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>;<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-params"><span class="hljs-params">|];[|</span></span><span class="hljs-number"><span class="hljs-number">1.0</span></span>;<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-params"><span class="hljs-params">|];[|</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>;<span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-params"><span class="hljs-params">|]|</span></span>] MomentumSGD <span class="hljs-number"><span class="hljs-number">100</span></span> nn (new NeuThink.DataSources.SimpleProvider(inputs)) (new NeuThink.DataSources.SimpleProvider(outputs)) <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> (Some([<span class="hljs-params"><span class="hljs-params">|0;0;0;0|</span></span>])) None nn.SetInput([<span class="hljs-params"><span class="hljs-params">|1.0;1.0|</span></span>]) System.Console.WriteLine(nn.Compute().[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br><br>  A neural network with one hidden layer of 4 neurons and one output layer of 1 one neuron is created here.  In fact, for XOR, 2 neurons in the hidden layer are enough, but the minimal network often falls into the local minimum when learning.  Instead of 0 and 1, for the XOR output, -1 and 1 are used, because by default the activation function in all tanh layers, with an output range from -1 to 1. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">nn</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.AddPerceptronLayer</span></span>(4,2,<span class="hljs-selector-attr"><span class="hljs-selector-attr">[|1|]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">true</span></span>,0)</code> </pre><br>  Means adding one fully connected layer (also called Dense or MLP layers).  4 - the number of neurons in the layer, 2 - the number of inputs.  [| 1 |] is an array of numbers of layers to which this layer will be connected (inconvenient, yes. But it works and you can define an arbitrary graph).  If the data does not need to be supplied anywhere, you need to specify -1 (why not an empty array? So historically it turned out ...).  The next parameter means that the input data will flow into this layer, and 0 indicates the processing order of the layer. <br><br>  After adding all the necessary layers, you need to call the FinalizeNet () method; it performs some service calculations. <br><br>  The input data is organized as an array of float arrays, each internal array corresponds to one learning example.  The output is organized as well.  To train a network from an array, you need to make a Data Source for a neural network.  This should be a class that implements the IInputProvider interface (for output) or IOutputProvider.  So hard to do for the case when data is generated dynamically or read from disk, because it does not fit into memory.  In the simple case, there is no need for complications and we use the built-in class SimpleProvider, initializing it with data from the array. <br><br>  Next, the learning function of the neural network itself is called with an initial learning rate of 0.2 and the number of iterations 100 pieces.  Then the trained network can be used to predict the results on the new data. <br><br>  It is worth noting that F # has an interactive console, you can work from it: <br><br><img src="https://habrastorage.org/files/484/3ea/dd1/4843eadd1500466d8304ecf620cddd0d.jpg"><br><br>  So far, in short, everything.  If you have any questions or suggestions, please contact. </div><p>Source: <a href="https://habr.com/ru/post/276115/">https://habr.com/ru/post/276115/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276101/index.html">Well, this day has come: quick joint editing in ONLYOFFICE editors</a></li>
<li><a href="../276103/index.html">Data Center Experience and Problems: How to Verify Data Center Reliability</a></li>
<li><a href="../276105/index.html">SEO-tools - an extension for Opera (webmaster and optimizer tools)</a></li>
<li><a href="../276107/index.html">Who celebrated the New Year with the Russians?</a></li>
<li><a href="../276109/index.html">Domains: is there life after death?</a></li>
<li><a href="../276117/index.html">Samsung fixed vulnerabilities in their Galaxy devices</a></li>
<li><a href="../276119/index.html">Ad networks 3.0: how a developer to stop annoying users and earn more</a></li>
<li><a href="../276123/index.html">On some TP-LINK router models, the default password is the last 8 characters of the device‚Äôs MAC address.</a></li>
<li><a href="../276125/index.html">Chrome Cleanup Tool: a program for cleaning Chrome from garbage</a></li>
<li><a href="../276129/index.html">Security Week 04: Lenovo's WiFi Hotspot Conf-Call Backdoor, Amazon Distributes HTTPS for Free</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>