<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TempusJS - working with the date in javascript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 I often have to work with statistics and there is a lot of tied up on dates. Moreover, the same date can be used on the page in different for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TempusJS - working with the date in javascript</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  I often have to work with statistics and there is a lot of tied up on dates.  Moreover, the same date can be used on the page in different formats (for example, convenient for the machine and convenient for the person).  I think most of you are perfectly aware of all this horrifying code that comes from using a Date object. <br>  For example, to get the current date in the format DD.MM.YYYY we need to do the following: <br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(), fd = d.getDate() + <span class="hljs-string"><span class="hljs-string">'.'</span></span> + (d.getMonth()+<span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-string"><span class="hljs-string">'.'</span></span> + d.getFullYear();</code> </pre> <br>  And when such lines becomes a lot?  Is it easy to remember that in javascript the month starts from scratch when you develop not only on it?  Or that there are milliseconds, not seconds, like almost everywhere on the backend?  Some of the tasks can be solved <a href="http://momentjs.com/">using the</a> popular library <a href="http://momentjs.com/">Moment.js</a> , but it works very slowly. <br>  The library in question solves these problems. <br>  If interested, I suggest you read this short review. <br><br><a name="habracut"></a><br><br>  TempusJS is largely composed of syntactic sugar on the Date object, so it works very quickly.  The syntax of the library itself is quite simple.  For example, to write the previous example, you can: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fd = tempus().format(<span class="hljs-string"><span class="hljs-string">'%d.%m.%Y'</span></span>);</code> </pre><br>  Now about the speed.  In the spoiler you can see a comparison of Tempus with Moment and the native way of formatting the date (see above): <br><div class="spoiler">  <b class="spoiler_title">Comparison of native JS, MomentJS and TempusJS</b> <div class="spoiler_text"><h5>  We get the current date </h5><br><pre> Native JS x 2,175,575 ops / sec ¬± 0.75% (96 runs sampled) 
 Moment x 284,864 ops / sec ¬± 0.85% (96 runs sampled) 
 Tempus x 2,086,081 ops / sec ¬± 0.73% (97 runs sampled)
</pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Formatting </h5><br><pre> Native JS x 1,637,517 ops / sec ¬± 0.61% (100 runs sampled) 
 Moment x 8,808 ops / sec ¬± 1.07% (100 runs sampled) 
 Tempus x 942,815 ops / sec ¬± 0.68% (94 runs sampled) 
</pre><br><br><h5>  Autodetect date and parsing </h5><br><pre> Native JS x 11,204,316 ops / sec ¬± 0.81% (88 runs sampled) 
 Moment x 38.511 ops / sec ¬± 1.41% (95 runs sampled) 
 Tempus x 93,973 ops / sec ¬± 1.06% (85 runs sampled) 
</pre><br><h5>  Parsing date by format </h5><br><pre> Moment x 46,293 ops / sec ¬± 0.63% (100 runs sampled) 
 Tempus x 109,947 ops / sec ¬± 0.93% (99 runs sampled) 
</pre><br><h5>  Parsing and validation </h5><br><pre> Moment x 44,588 ops / sec ¬± 1.09% (90 runs sampled) 
 Tempus x 103,439 ops / sec ¬± 0.90% (94 runs sampled)
</pre><br>  The results are obtained on my laptop in Google Chrome 30.0.1599.114.  In other browsers, the results are different, but the ratio remains about the same. <br>  The benchmark library was used for tests. <br>  Benchmarks on other features, you can see <a href="https://github.com/crusat/datelibbenchmark">here</a> . <br></div></div><br><br>  So, in the advantages of this library, you can write the following: <br><ul><li>  Supports IE6 +, Chrome, Firefox, Opera; </li><li>  Supports call chains; </li><li>  Months can begin with 1 (default), not zero; </li><li>  Milliseconds can be disabled (default) or enabled; </li><li>  Fast work (Since, in many cases, the native Date object is used for the browser, the implementation of which is written in faster languages); </li><li>  Supports <a href="http://docs.tempusjs.org/documentation/docs/tempus/tempus.global:registerFormat">custom formats</a> and <a href="http://docs.tempusjs.org/documentation/docs/tempus/tempus.global:classes">plugins</a> </li><li>  <a href="http://docs.tempusjs.org/documentation/docs/tempus/TempusDate.global:valid">Validation of the</a> date is very fast and depends only on the functions establishing the date (since validation takes place already when the values ‚Äã‚Äãare entered, and not calculated separately); </li><li>  There is <a href="http://docs.tempusjs.org/documentation/docs/tempus/tempus.global:generate">a date array generator</a> ; </li><li>  Multilingual and autodetection of user language. </li></ul><br><br>  All functions of this library are described in the <a href="http://docs.tempusjs.org/documentation/docs/tempus/index">documentation</a> .  Also, there are <a href="http://tempusjs.org/tests/index.html">tests</a> on the site (if you find any error, please report it <a href="https://github.com/crusat/tempus-js/issues">here</a> . <br><br>  Here we will discuss only some of the functions. <br><br><h4>  Formatting and parsing </h4><br><br>  So, for starters, another example of formatting a date.  Here we also use a call chain.  At the end of each value setting, we get back a TempusDate object, which we can use further in the chain.  Example: <br><pre> <code class="javascript hljs">tempus(). <span class="hljs-comment"><span class="hljs-comment">//    calc({month: -1}). //      format('%d.%m.%Y'); //    </span></span></code> </pre><br>  Thus, we get the same day, hour and second, but a month ago.  This is useful for receiving reports for the last month. <br><br>  The next example is date parsing. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   TempusDate  "2013-11-18" tempus('18.11.2013'); //   TempusDate  "2013-12-12" tempus('2013-12-12', '%Y-%m-%d'));</span></span></code> </pre><br>  Tempus can automatically detect certain known formats.  Also, you can specify a specific format, then the parsing will be faster.  Plus, you can set the date to be returned if the parsing fails: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// .. "123"     '%d.%m.%Y',  //   ,   2013-01-01 tempus('123', '%d.%m.%Y', tempus([2013, 1, 1]));</span></span></code> </pre><br>  The list of default formats can be found <a href="http://docs.tempusjs.org/documentation/docs/tempus/TempusDate.global:format">here.</a> <br><br>  And now we will change the format of the already formatted date. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// '2013-11-05' tempus('05.11.2013').format('%Y-%m-%d'); //   // 'October, 12' tempus('2013-10-12 12:31:01', '%Y-%m-%d %H:%M:%S').format('%B, %d');</span></span></code> </pre><br><br>  Also, you can use localization for formatting.  By default, the user's language will be selected (taken from the browser) or the default language if the user's language is not found among the available Tempus languages. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   tempus.lang('ru'); //   format // ', 05' tempus(1383609600).format('%B, %d');</span></span></code> </pre><br>  At the moment there are only two languages ‚Äã‚Äã- Russian and English, so I will be glad to help. <br><br><h4>  Validation </h4><br>  Validation of the date is as follows: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  false tempus('32.08.2013', '%d.%m.%Y').valid(); //  true tempus('00:00 01.01.2012', '%H:%M %d.%m.%Y').valid();</span></span></code> </pre><br><br>  In case of an error, you can look at the fields in which it originated - wherever the value is not false: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  {"year":-5,"month":false,"day":false,"hours":false, // "minutes":false,"seconds":false,"milliseconds":false} tempus(). year(-5). //  =-5, ..  errors(); //    </span></span></code> </pre><br><br><h4>  Date ranges </h4><br>  Sometimes we need to get the number of years (for example, age), months, days, etc.  between two dates.  To do this, we can use the between method, which finds the difference between two dates and returns in the required format ('year', 'month', 'day', 'hours', 'minutes', 'seconds', 'milliseconds'). <br>  Here is a simple example of obtaining the number of months between November 1, 2013 and May 5, 2014: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  6 tempus([2013, 11, 1]).between(tempus([2014, 5, 5]), 'month');</span></span></code> </pre><br>  Or how many hours are left until the new year <br><pre> <code class="javascript hljs">tempus().between(tempus([<span class="hljs-number"><span class="hljs-number">2014</span></span>]), <span class="hljs-string"><span class="hljs-string">'hours'</span></span>);</code> </pre><br>  In the last example, you can see that I have only indicated a year.  When set by an array or object, missing values ‚Äã‚Äãwill be <br>  filled with the minimum.  The list of constants with minimum values ‚Äã‚Äãcan be seen in the documentation. <br><br>  Also, we can change any date using the calc function: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  TempusDate   2012-01-01 tempus([2011, 5, 2]).calc({year: 1, month: -4, day: -1});</span></span></code> </pre><br><br><h4>  Own formats </h4><br>  We apply our format for the month, which can take values ‚Äã‚Äãfrom 1 to 12 (and not 01 to 12): <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    tempus.registerFormat('%q', //  - %q function(date) { //    , ..     %q return date.month(); }, function(value) { //     var v = Number(value); return {month: (isNaN(v) ? undefined : v) }; }, 1, //  ,     2, //   'number' //  ); //  //  "01.1.2013"; tempus({year: 2013, month: 1, day: 1}).format('%d.%q.%Y'); //  {"year":2013,"month":2,"day":10,"hours":0,"minutes":0,"seconds":0}; tempus('10.2.2013', '%d.%q.%Y').get();</span></span></code> </pre><br>  When registering, you will notice that some parameters are set separately, while you could use a regular expression.  In fact, there it was originally there, but after abandoning it, the speed increased several dozen times. <br>  If you need to remove some format, use unregisterFormat: <br><pre> <code class="javascript hljs">tempus.unregisterFormat(<span class="hljs-string"><span class="hljs-string">'%d'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  "%d.01.2013", ..  %d   . tempus.format({year: 2013, month: 1, day: 1}, '%d.%m.%Y');</span></span></code> </pre><br><br><h4>  Getters / Setters </h4><br>  You can get / set some values ‚Äã‚Äãusing the functions year (), month (), day (), hours (), minutes (), seconds (), milliseconds (), dayOfWeek (), utc (), timestamp () or set ()  For example: <br><pre> <code class="javascript hljs">tempus(). <span class="hljs-comment"><span class="hljs-comment">//    year(1900). //    ,   1900  leapYear(); // ,    ,    false tempus().year(); //        </span></span></code> </pre><br><br><h4>  Date generation </h4><br>  You can generate a date in many ways, the full list of parameters is in the documentation.  Here is a minimal example. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// returns ["29.03.2013", "30.03.2013", "31.03.2013", "01.04.2013", "02.04.2013"]; tempus.generate({ dateFrom: '20130329', formatFrom: '%Y.%m.%d', dateTo: '20130402', period: {day: 1}, format: '%d.%m.%Y' });</span></span></code> </pre><br>  This can be useful for displaying graphs by dates and changing the display format directly on the client, without queries to the backend.  The date can be generated as an array, as well as objects, where the dates themselves will be the keys (this is useful when we need to attach an event to a date, for example, when we make our calendar).  Also, dates can be grouped by day, week, month, hour, year - anything.  This can also be applied to the calendar. <br><br><h4>  Plugins </h4><br>  And finally - plugins.  Here we are expanding the factory to generate a random date.  Also, we need the TempusDate class, which can be found in tempus.classes ().  Here is an example of a plugin: <br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">tempus</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> TempusDate = tempus.classes(<span class="hljs-string"><span class="hljs-string">'TempusDate'</span></span>); tempus.randomDate = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> date = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TempusDate(); date.year(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()*(tempus.MAX_YEAR - tempus.MIN_YEAR)) + tempus.MIN_YEAR)). month(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()*(tempus.MAX_MONTH - tempus.MIN_MONTH)) + tempus.MIN_MONTH)). day(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()*(date.dayCount() - tempus.MIN_DAY)) + tempus.MIN_DAY)). hours(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()*(tempus.MAX_HOURS - tempus.MIN_HOURS)) + tempus.MIN_HOURS)). minutes(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()*(tempus.MAX_MINUTES - tempus.MIN_MINUTES)) + tempus.MIN_MINUTES)). seconds(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()*(tempus.MAX_SECONDS - tempus.MIN_SECONDS)) + tempus.MIN_SECONDS)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> date; }; })(tempus); <span class="hljs-comment"><span class="hljs-comment">//        var someRandomDate = tempus.randomDate();</span></span></code> </pre><br>  I think that this way you can conveniently write widgets using jQuery + Tempus, Angular + Tempus, etc. <br><br><h4>  Sources </h4><br>  You can install by downloading the sources from the githab: <br>  <a href="https://github.com/crusat/tempus-js/releases">https://github.com/crusat/tempus-js/releases</a> <br>  Or through bower: <br><pre> <code class="javascript hljs">$ bower install tempus</code> </pre><br>  You only need one file - tempus.js or tempus.min.js. <br><br>  I hope that this library will be useful, and it would also be interesting to find out what is missing in it to further develop the library in the right direction.  Thanks for attention! <br>  PS Thanks for the invite! </div><p>Source: <a href="https://habr.com/ru/post/204162/">https://habr.com/ru/post/204162/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../204148/index.html">SAP Enterprise Portal Hacking</a></li>
<li><a href="../204150/index.html">DotNetFiddle - JsFiddle for .Net developers</a></li>
<li><a href="../204154/index.html">SPS IPC Drives 2013 Visit Report - a bit about real industrial robots</a></li>
<li><a href="../204156/index.html">Pump controller</a></li>
<li><a href="../204160/index.html">How to facilitate the installation of .apk on Android or GUI for adb install</a></li>
<li><a href="../204164/index.html">How users interact with mobile devices</a></li>
<li><a href="../204166/index.html">Magento. Process of loading configuration files</a></li>
<li><a href="../204168/index.html">Is it possible to become a programmer after 30?</a></li>
<li><a href="../204170/index.html">Will Angular.js and Facebook Login be able to make friends?</a></li>
<li><a href="../204172/index.html">Simple GStreamer audio player</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>