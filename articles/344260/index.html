<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Generation of natural speech in a 3CX call center based on deep learning</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Often we need to reproduce audio information that has not been recorded in advance and is dynamically extracted from the data source: t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Generation of natural speech in a 3CX call center based on deep learning</h1><div class="post__text post__text-html js-mediator-article"><h2>  Introduction </h2><br>  Often we need to reproduce audio information that has not been recorded in advance and is dynamically extracted from the data source: the name of the person, the name of the city, the status of the order, etc.  Especially this feature is in demand in call centers and self-service portals. <br><br>  For this, it is best to use TTS (text-to-speech) technology, since it dynamically creates the necessary audio files, and the voice application running on the 3CX server loses them to the subscriber.  To generate audio files, a certain web service is used, after which a local WAV file is created.  When the conversation with the subscriber is completed, the file is deleted to free up disk space. <br><br>  For this feature, 3CX should register an account with Amazon Web Services.  3CX uses the Amazon Polly TTS web service.  After exploring various TTS services, we found that Amazon Polly has excellent generation quality, <a href="http://docs.aws.amazon.com/polly/latest/dg/SupportedLanguage.html">good language coverage</a> , many different <a href="http://docs.aws.amazon.com/polly/latest/dg/voicelist.html">voices</a> and a very affordable price.  It is also free for the first year of use!  On the other hand, in the future we plan to add support for TTS from other global manufacturers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Please note - for TTS generation, you must use 3CX v15.5 SP2 and higher. <br><br>  <a href="https://www.3cx.com/phone-system/call-flow-designer/">3CX Call Flow Designer</a> has received a new type of audio message Text to Speech Audio Prompt.  You can choose it in any place where you want to play the message, for example, in components Prompt Playback, Menu, User Input and others. <br><br>  In this article, we‚Äôll show you how to create an Amazon Web Services account, enable Amazon Polly, and start using the Text to Speech Audio Prompt component to generate natural speech in your call center. <a name="habracut"></a><br><br>  Please note - the 3CX CFD development environment is free.  But voice applications will be run only on <a href="https://www.3cx.ru/ip-pbx/edition-comparison/">3CX Pro and Enterprise editions</a> .  Download CFD <a href="">from here</a> . <br><br>  For your convenience, a demo project of this voice application comes with the 3CX CFD distribution and is located in the Documents \ 3CX Call Flow Designer Demos folder. <br><br><h2>  Create an Amazon Web Services (AWS) account </h2><br>  Before you start working with a CFD application, create an Amazon Web Services account.  To do this, read the <a href="https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/">manual</a> from Amazon. <br><br><h2>  Creating an Identity and Access Management (IAM) Service User </h2><br>  After creating an AWS account, create a user whose credentials our voice application uses to access AWS.  Follow <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html">the</a> Amazon <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html">manual</a> .  Specify the type of access Programmatic access.  When setting permissions, select Attach existing policies directly, then find and tick AmazonPollyFullAccess. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3bf/68d/2b9/3bf68d2b936804b6b6c6a008222ab54b.png"><br><br>  Then go to the user settings in the Security credentials section and click Create access key.  Fix the Access key ID and Secret access key - this data will be required when setting up the TTS service in the voice application. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45c/1cd/d69/45c1cdd69433d745ea1ab4a6ebe5521f.png"><br><br>  Attention!  Check out the <a href="http://docs.aws.amazon.com/polly/latest/dg/limits.html">Amazon Polly TTS restrictions</a> .  These restrictions should not create problems in most CFD applications, but keep them in mind. <br><br><h2>  Project creation </h2><br>  To create a CFD project, go to File ‚Üí New ‚Üí Project, specify the project location folder and its name, for example, TextToSpeechDemo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1d9/ead/f5f/1d9eadf5ff5325cac73bef96da69019e.png"><br><br>  Select the project in the Project Explorer section.  Consider the project parameters (section Properties), which must be specified for the operation of TTS: <br><br><ul><li>  AmazonClientID - Access key ID generated above. <br></li><li>  AmazonClientSecret - Secret access key, generated above. <br></li><li>  AmazonRegion ‚Äî select <a href="http://docs.aws.amazon.com/general/latest/gr/rande.html">the AWS geographic region</a> nearest to the 3CX server location. <br></li></ul><br>  These parameters will be used in any message of the Text To Speech Audio Prompt type in this project. <br><br><h2>  Adding the Prompt Playback component </h2><br>  As mentioned earlier, TTS is usually used to generate speech from text obtained from a database or web service.  But to simplify our example, we will prepare a short phrase, add a variable from our voice application to it and convert it all into speech.  We will define the AccountBalance variable and set its value to 100. Then we will prepare the phrase: ‚ÄúYour account balance is $ 100‚Äù. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/252/35a/613/25235a6138c235aba97643c883ce14df.png"><br><br>  To add the Prompt Playback component: <br><br><ol><li>  Move the Prompt Playback component to the Main callflow application window.  Select a component and in the properties section rename it to playPrompt. <br></li><li>  In the same place, open the Prompt Collection Editor by clicking the button next to the Prompts property. <br></li><li>  Click Add to add a new message to the collection and change the message type to Text to Speech Audio Prompt. <br></li><li>  Select the voice you want to use.  The list of votes is sorted by language.  The voices available for Amazon Polly are listed <a href="http://docs.aws.amazon.com/polly/latest/dg/voicelist.html">here</a> .  If Amazon releases a new voice that is not listed, you can start using it by entering an identifier from the Name / ID column.  If you want a certain voice to always be installed in the application by default, select it in the 3CX CFD Tools&gt; Options&gt; Component Templates&gt; Text To Speech menu.  For our example, we will use the voice of Joanna (English - US, Female). <br></li><li>  Select text type: Text and SSML (Speech Synthesis Markup Language).  Typically, you will use Text.  At the same time, the value of the Text property is a normal character set (plain text), and the TTS service will synthesize it as is.  If you specify the SSML type, the Text property value is an XML file in accordance with the SSML specification.  SSML allows you to set various speech parameters: pronunciation, volume, speed.  For more information, see the manual <a href="http://docs.aws.amazon.com/polly/latest/dg/ssml.html">Using SSML</a> .  In our example, the Text type is used. <br></li><li>  Specify an expression for the Text option.  Depending on the type of text selected in the previous step, the expression should return plain text for synthesis or XML data, in accordance with the SSML specification.  For our example, we use the following expression: <br></li></ol><br><pre><code class="hljs lisp">CONCATENATE(<span class="hljs-string"><span class="hljs-string">"Your account balance is $"</span></span>,callflow$.AccountBalance)</code> </pre> <br><h2>  Compiling and installing the application on the 3CX server </h2><br>  Voice application is ready!  Now it should be compiled and uploaded to the 3CX server.  For this: <br><br><ol><li>  Go to Build&gt; Build All, and the CFD will create the PredictiveDialerDemo.tcxvoiceapp file. <br></li><li>  Go to the 3CX management interface, in the Call Queues section.  Create a new Call Queue, specify the name and extension number of the Queue, and then set the Voice Applications option and download the compiled file. <br></li><li>  Save changes to the queue.  Call the Queue extension number to test the application.  Please note - at the very first call to the application, TTS generation can be performed with a delay of several seconds.  This is related to the authentication process and occurs only once. <br></li></ol><br><h2>  Conclusion </h2><br>  Typically, synthesized speech uses several static messages, for example, a greeting for users or a choice of a menu option, and several dynamic messages ‚Äî for example, an account balance.  It is advisable to use the Polly TTS service only for variable data - this will avoid the additional cost of synthesizing duplicate phrases.  On the other hand, it is necessary that all phrases be pronounced in the same voice.  To do this, it‚Äôs best to create ready-made voice files for static phrases via the <a href="https://console.aws.amazon.com/polly">Amazon Polly console</a> and upload them as WAV files to a voice application.  Use these files in regular Audio File Prompt messages instead of repeated dynamic generation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f04/1b9/4fd/f041b94fdb264f20b22300ea4cad0654.png"><br><br>  In the Amazon Polly console, select your language, region, desired voice, enter the desired text, and click Download MP3.  Please note, 3CX uses the audio format WAV, Mono, 8.000 Hz, 16 bit.  Therefore, after downloading the file, convert it to a supported format, as indicated <a href="https://habrahabr.ru/company/3cx/blog/322570/">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/344260/">https://habr.com/ru/post/344260/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344250/index.html">We invite you to December 15 at the Moscow CocoaHeads Meetup in Mail.Ru Group</a></li>
<li><a href="../344252/index.html">Prospects for the evolution of hard drives: advanced technology and implementation challenges</a></li>
<li><a href="../344254/index.html">Atos IT Challenge Launch Report</a></li>
<li><a href="../344256/index.html">‚Äú3 classes of parish school‚Äù or study at Microsoft Virtual Academy (MVA)</a></li>
<li><a href="../344258/index.html">10 most trendy and dead technologies, frameworks and languages ‚Äã‚Äãaccording to Stack OverFlow. Short</a></li>
<li><a href="../344262/index.html">ESET participated in the elimination of the Gamarue botnet</a></li>
<li><a href="../344264/index.html">Business doesn‚Äôt need internet marketers or why ‚ÄúDismissing your internet marketer‚Äù is the best advice for 2017</a></li>
<li><a href="../344266/index.html">Transition from tester to project managers</a></li>
<li><a href="../344268/index.html">On the results of the MERC-2017 contest: an interview with the winners</a></li>
<li><a href="../344270/index.html">Webpage interaction with Ethereum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>