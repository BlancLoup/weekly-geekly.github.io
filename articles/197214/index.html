<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Session API in Yii with the ability to store in Redis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, I needed to write an API on the Yii Framework, one of the functional requirements of which is authorization. For the authorization me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Session API in Yii with the ability to store in Redis</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago, I needed to write an API on the Yii Framework, one of the functional requirements of which is authorization.  For the authorization mechanism, I decided to use sessions. <br><a name="habracut"></a><br><h3>  Implementation option homemade sessions </h3><br>  Before that, I had seen quite a few API implementations written in PHP, but at the same time I had never seen an implementation that would use the built-in PHP session mechanism.  The fact that I mostly came across was the implementation of self-made sessions.  In most cases, it looked like this: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b56/a74/422/b56a74422db75feedcfb0342906246b3.png" alt="image"></div><br>  1. The client sends a request to the server with data for authorization. <br>  2. In case of successful authorization, the server generates a unique identifier (random hash), stores it in its repository (database, cache, etc.), records information about the client‚Äôs ownership of this identifier, and records the time of the last access to the server.  After that, it sends a response with the identifier to the client. <br>  3. The client, having received the session identifier and saving it for further requests, sends a request to the server with the transmitted session identifier (as a parameter or header) to receive data. <br>  4. Having checked the session identifier, the server sends the data to the client and updates the time of the last call to the server with the given identifier. <br><br>  The interaction between the client and the server in clauses 3 and 4 may occur until the session record on the server is destroyed.  In the case of session destruction, it is necessary to perform items 1 and 2 again before further performing items 3 and 4. Periodically, you have to do checks of session identifiers for the last time the server was accessed and delete those that have exceeded their lifespan if the session storage used does not know how to destroy records automatically for a given lifetime.  In this method, quite a lot of actions that require implementation. <br><br><h3>  Option using standard PHP sessions </h3><br>  And what do we get using standard <a href="http://www.php.net/manual/ru/book.session.php">PHP sessions</a> ? <br>  1) Automatic generation of a unique session identifier. <br>  2) Access to the data stored in the session, as well as its management from anywhere in the application. <br>  3) Using standard PHP functions for working with sessions, including wrappers over them.  For example, class <a href="http://www.yiiframework.com/doc/api/1.1/CHttpSession">CHttpSession</a> Yii framework. <br>  4) Automatic recovery of a previously saved environment.  For example, automatic user login when receiving an identifier of a previously created session. <br>  5) Automatic deletion of sessions that have expired. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's take a look at how cookie-based sessions work. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2e6/f7c/6db/2e6f7c6db7b6d8bec1401f9555d60e25.png" alt="image"></div><br>  1. The browser sends a request to the server to receive information at the specified URL. <br>  2. The server returns a response with the ‚ÄúSet-Cookie‚Äù header, which tells the browser to write the session ID in the cookie.  Example of the ‚ÄúSet-Cookie‚Äù header: <br> <code>Set-Cookie: PHPSESSID=p2799jqivvk8gnruif1lvtv5l5; path=/</code> <br>  3. The browser, having successfully recorded the session identifier in the cookie, sends a request for a new URL, but with the ‚ÄúCookie‚Äù header: <br> <code>Cookie: PHPSESSID=p2799jqivvk8gnruif1lvtv5l5</code> <br>  4. The server gives the page to the browser. <br><br>  All subsequent requests from the browser come with a ‚ÄúCookie‚Äù header, which contains information about the session identifier.  All this automatically works in your browser, unless cookies are disabled.  But what to do if cookies are disabled, or if the client is not a browser?  In this case, everything will not be so simple.  Of course, you can use the receive and send headers ‚ÄúSet-Cookie‚Äù and ‚ÄúCookie‚Äù on the client side, but let's consider another solution to this problem, presented below. <br><br><h3>  Using PHP sessions in the API </h3><br>  Before you start using sessions, you need to pay attention to the <a href="http://www.php.net/manual/ru/session.configuration.php">parameters in php.ini</a> related to the sessions.  Pay particular attention to the following parameters: <a href="http://www.php.net/manual/ru/session.configuration.php">session.use_cookies</a> , <a href="http://www.php.net/manual/ru/session.configuration.php">session.use_only_cookies</a> , <a href="http://www.php.net/manual/ru/session.configuration.php">session.use_trans_sid</a> .  In order to start using the PHP session mechanism for the API, you need to configure these parameters as follows: <br><br><pre> <code class="bash hljs">session.use_cookies = 0 session.use_only_cookies = 0 session.use_trans_sid = 1 session.name = session</code> </pre><br><br>  Of course, it is not necessary to set these settings directly in php.ini, it is enough to set them through the PHP function <a href="http://php.net/manual/ru/function.ini-set.php">ini_set</a> .  With these settings, we disable the ability to use cookies to store identifiers on the client side, since it implies the use of the API not only by the browser, but also by other applications, mobile devices, etc.  Enabling the <b>session.use_trans_sid</b> parameter will enable us to pass the session identifier as a GET or POST parameter.  If you are going to develop a REST API, then passing an identifier through a POST parameter is not the best option, since REST still uses methods such as PUT and DELETE, which will not work for the session identifier.  Therefore, it is better to pass the identifier as a GET parameter that will work with any of the methods in the REST API.  We will also set the name of the GET parameter in the session.name parameter, which by default is called PHPSESSID.  A URL with a passed session ID will look like this: <br><br>  <a href="https://api.example.com/action%3Fsession%3Dl2kkl7c9sm2dfedr767itc9966">https://api.example.com/action?session=l2kkl7c9sm2dfedr767itc9966</a> <br><br><h3>  Using PHP sessions in the Yii Framework </h3><br>  Now let's look at how this mechanism can be used in the Yii Framework.  To work with sessions in Yii provides the class <a href="http://www.yiiframework.com/doc/api/1.1/CHttpSession">CHttpSession</a> .  To use it, you need to register the following settings in the components array: <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">'session'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'autoStart'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'cookieMode'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-string"><span class="hljs-string">'useTransparentSessionID'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'sessionName'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'session'</span></span>, <span class="hljs-string"><span class="hljs-string">'timeout'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">28800</span></span>, ),</code> </pre><br><br>  Where <br>  <b>'cookieMode' =&gt; 'none'</b> sets the php.ini settings in <b>session.use_cookies = 0</b> and <b>session.use_only_cookies = 0</b> <br>  <b>'useTransparentSessionID' =&gt; true</b> puts php.ini in <b>session.use_trans_sid = 1</b> <br><br>  For an API with a not very large number of hits, this would be enough, but by default sessions are stored as a ‚ÄúPlain text‚Äù file on disk, which can become a weak link when intensively reading and writing sessions in high-loaded APIs.  In this case, you can use one of the following solutions: <br>  1) replace the drive on the SSD; <br>  2) put a raid level 10 of SSD drives; <br>  3) use a ram disk.  For example, the Tmpfs file system in Linux; <br>  4) storage of sessions in <a href="http://memcached.org/">Memcached</a> (data storage in RAM); <br>  5) storage of sessions in <a href="http://redis.io/">Redis</a> (data storage in RAM). <br><br><h3>  Storing Sessions in Redis </h3><br>  I would like to turn my attention to Redis, due to its diverse data storage structures.  I also want to note the important possibility of data recovery (sessions in our case) after rebooting the server.  Before you can use Redis as a session repository, you need to install the <a href="http://redis.io/download">Redis server</a> and the <a href="https://github.com/nicolasff/phpredis">PHP Extension for Redis</a> .  How to install both of them can be found <a href="http://anton.logvinenko.name/ru/blog/kak-ustanovit-redis-i-redis-php-klient.html">here</a> .  After successful installation, you will be able to use the <a href="https://github.com/nicolasff/phpredis">PHP Session handler</a> from the PHP Extension for Redis.  In order to use PHP Session handler Redis without directly changing php.ini and being able to set Redis as a session store in the Yii config, I had to change the CHttpSession a bit, inheriting from it and writing my <a href="https://github.com/luxurydab/yii-redis-session-manager">RedisSessionManager</a> class. <br><br>  Now the config for the session component will look like this: <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">'session'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'application.components.RedisSessionManager'</span></span>, <span class="hljs-string"><span class="hljs-string">'autoStart'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'cookieMode'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'none'</span></span>, <span class="hljs-string"><span class="hljs-string">'useTransparentSessionID'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'sessionName'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'session'</span></span>, <span class="hljs-string"><span class="hljs-string">'saveHandler'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'redis'</span></span>, <span class="hljs-string"><span class="hljs-string">'savePath'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'tcp://localhost:6379?database=10&amp;prefix=session::'</span></span>, <span class="hljs-string"><span class="hljs-string">'timeout'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">28800</span></span>, ),</code> </pre><br><br><h3>  Using sessions for authorization in the API </h3><br>  Now you can use sessions to authorize users in the API.  You can do this as follows: <br><br>  Login method: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionLogin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $params = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getRequestParams(); $identity=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UserIdentity($params[<span class="hljs-string"><span class="hljs-string">'username'</span></span>],$params[<span class="hljs-string"><span class="hljs-string">'password'</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($identity-&gt;authenticate()){ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sendResponse(Status::OK, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'session'</span></span>=&gt;Yii::app()-&gt;session-&gt;getSessionID(), <span class="hljs-string"><span class="hljs-string">'message'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'Successful login'</span></span>, )); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sendResponse(Status::UNAUTHORIZED, $identity-&gt;errorMessage); } }</code> </pre><br><br>  What's going on here?  First we get the username and password that came from the request.  Then we try to log in using this login and password and in case of successful login we return the session identifier for further use when accessing other API methods. <br><br>  This is what the UserIdentity class looks like: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserIdentity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CUserIdentity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authenticate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $account = Yii::app()-&gt;account-&gt;getByName(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;username); $password = Yii::app()-&gt;account-&gt;hashPassword(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;password); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!$account || <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;username !== $account-&gt;username){ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;errorCode = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ERROR_USERNAME_INVALID; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;errorMessage = <span class="hljs-string"><span class="hljs-string">'User with username '</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;username.<span class="hljs-string"><span class="hljs-string">' not found'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($password !== $account-&gt;password) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;errorCode = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ERROR_PASSWORD_INVALID; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;errorMessage = <span class="hljs-string"><span class="hljs-string">'Wrong password'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;errorCode = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ERROR_NONE; Yii::app()-&gt;user-&gt;login(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>); Yii::app()-&gt;user-&gt;setId($account-&gt;id); Yii::app()-&gt;user-&gt;setName($account-&gt;nickname); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } }</code> </pre><br><br>  In the case of successful authentication, the user component is entered into the user information, which will be automatically substituted during the following calls to api with the specified session identifier. <br><br>  Logout method: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionLogout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Yii::app()-&gt;session-&gt;destroySession()){ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sendResponse(Status::OK, <span class="hljs-string"><span class="hljs-string">'Successful logout'</span></span>); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sendResponse(Status::BAD_REQUEST, <span class="hljs-string"><span class="hljs-string">'Logout was not successful'</span></span>); } }</code> </pre><br><br>  Everything is simple here.  Just destroy the current session with all its contents. <br><br>  I also want to note a few tips on using sessions in the API: <br><br>  1) It is important to use an encrypted connection to communicate between the client and the server, in order to prevent the attacker from intercepting the session identifier for further use.  For example, you can use the HTTPS protocol. <br><br>  2) You can use additional session authentication algorithms in case the session was intercepted by an attacker.  For example, to bind a session to the user's IP, additionally saving the IP within the session and checking if it has changed during the next call.  If the previously saved IP does not match the current one, you need to destroy the session. <br><br>  3) Set a limit on the lifetime of the session.  Since this time is updated automatically during the next request to the API, I would set, for example, 2 hours.  Thus, if the user is inactive for 2 hours, the session is automatically destroyed.  This will reduce the chance of overflowing the session repository. <br><br>  Finally, a short demo video about how authorization works in the REST API, written in Yii, c storing sessions in Redis. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Hk73hCmP9rM%3Ffeature%3Doembed&amp;xid=17259,15700002,15700021,15700186,15700191,15700253&amp;usg=ALkJrhj7tj8AG8hwUUKI7G2nKRLbZkxyFA" frameborder="0" allowfullscreen=""></iframe><br><br>  Article author: <a href="https://habrahabr.ru/users/luxurydab/" class="user_link">luxurydab</a> </div><p>Source: <a href="https://habr.com/ru/post/197214/">https://habr.com/ru/post/197214/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197202/index.html">OPPO Clover R815. Emphasis on music</a></li>
<li><a href="../197204/index.html">Offline OSX Recovery from Recovery HD</a></li>
<li><a href="../197206/index.html">New Acer Chromebook for $ 249.99</a></li>
<li><a href="../197208/index.html">The cosmonauts of the ISS will test a mini-brewery created by an 11-year-old schoolboy.</a></li>
<li><a href="../197212/index.html">Introduction to data visualization when analyzing with Pandas</a></li>
<li><a href="../197216/index.html">PicUntu 4.5 installer: an easy way to install Ubuntu on devices with Rockchip RK3188</a></li>
<li><a href="../197218/index.html">Mail.Ru Group was fined for compliance with the Constitution of the Russian Federation</a></li>
<li><a href="../197220/index.html">Pages to PDF or service in 2 hours</a></li>
<li><a href="../197222/index.html">Buy any game on the GOG and get the Witcher as a gift!</a></li>
<li><a href="../197224/index.html">Due to total NSA surveillance, the US economy could lose up to $ 35 billion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>