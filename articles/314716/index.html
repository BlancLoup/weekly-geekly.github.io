<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Now ONLYOFFICE can do everything: add plugins to document editors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What if you could add to the editors of your documents any functions you want? Now you can: in the editors ONLYOFFICE the opportunity to connect plug-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Now ONLYOFFICE can do everything: add plugins to document editors</h1><div class="post__text post__text-html js-mediator-article">  What if you could add to the editors of your documents any functions you want?  Now you can: in the editors ONLYOFFICE the opportunity to connect plug-ins.  We wrote a few examples ourselves - all of them can be viewed in our open repository on GitHub.  Now your move - write what you lacked. <br><br>  Details below. <br><br><img src="https://habrastorage.org/files/c5e/98b/a86/c5e98ba86ac44240b5d2b2c00128f07b.jpg"><br><a name="habracut"></a><br><h1>  Why did we do this? </h1><br>  So, we decided to give developers the opportunity to add the necessary (but not directly related to OOXML formats) functionality to ONLYOFFICE editors. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It all started with one company, in which they really wanted to write their own button to generate content and insert the resulting data into the editor.  Okay, we thought, that makes sense.  There is a functionality that only certain people need and no one else.  We can not do everything for everyone, but we can give the opportunity to steal everything that is needed.  Therefore, here is the API for working with the editor, the first version. <br><br>  So there were plugins. <br><br>  They can use the code that we ourselves can not take because of licensing restrictions.  We make a commercial product and sell it, you can‚Äôt just take it and (* in this moment the author of the text is interrupted to brush off the ghost of Sean Bean from the depths of the subconscious) you cannot just take and use any code from the Internet.  That is, we can not.  And you can.  Those things that we, for objective reasons, cannot, our users can. <br><br><h1>  Types of plugins </h1><br>  We divide them into three types: <br><br>  <b>Visuals</b>  When we use such an extension of the editor, a window opens and a certain interface is drawn.  For example, Glavred, who asked our PR. <br><br>  A visual plugin can change something in the document itself, or it can change nothing.  Glavred does not change anything - he only highlights a certain part of the text (stamps, extra words, etc.). <br><br>  You can write a plugin that searches on Google. Pictures and inserts your favorite into the text.  This plugin changes the document. <br><br>  <b>Non-visual</b>  For example, a simple button, when clicked, performs manipulations with the document.  The simplest example of such a plugin is an extension that, when a button is pressed, adds the words Hello World! <br><br><pre><code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">window, undefined</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Asc.plugin.init = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sScript = <span class="hljs-string"><span class="hljs-string">'var oDocument = Api.GetDocument();'</span></span>; sScript += <span class="hljs-string"><span class="hljs-string">'var oParagraph = Api.CreateParagraph();'</span></span>; sScript += <span class="hljs-string"><span class="hljs-string">'oParagraph.AddText(\'Hello world!\');'</span></span>; sScript += <span class="hljs-string"><span class="hljs-string">'oDocument.InsertContent([oParagraph]);'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Asc.plugin.info.recalculate = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.executeCommand(<span class="hljs-string"><span class="hljs-string">"close"</span></span>, sScript); }; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Asc.plugin.button = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ }; })(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>, <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>);</code> </pre> <br>  You can also add your own Bold button to your document, for example.  Or a button, when clicked, a report is generated. <br><br>  <b>OLE objects</b> .  These are our favorite plugins.  And the only way for a third-party developer to ‚Äúget into‚Äù the format part of the document, i.e.  write your information not only while the editor is working, but also directly into the file.  This, for example, our chess. <br><br><h1>  What solution are plugins connected to and how is this done? </h1><br>  In fact, to anyone. <br><br>  <b>For server version</b> <br><br>  Plug-ins need to register in the configs of editors - they will automatically appear in all users of the portal. <br><br>  <b>For desktop</b> <br><br>  We archive plugins, change the file extension to .plugin and drop it on the main page.  They immediately pick up, we promise.  In addition, if you connect the application to the portal with plug-ins enabled, they will automatically work in the desktop. <br><br>  <b>For web version</b> <br><br>  In the near future, we will write down something like a store or gallery, where plug-ins from users will be added (after moderation). <br><br>  While there is no ‚Äústore‚Äù, plugins can be added via an extension in the browser.  This path only works for Chrome for now.  We on GitHub have a folder with a talking name chrome_extension_example: this is a sample, how to make an extension in Chrome on our plugins. <br><br>  Here, by the way, is a short video about what our plugins can do and how to add them to an existing installation (desktop, server). <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tRhyTYvJxBI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h1>  How to write your plugin? </h1><br>  Here we wanted to write detailed instructions on how to do this.  But we remembered that we already have good and detailed documentation, where the structure of the plug-in is described in all the necessary details.  So everything is <a href="https://api.onlyoffice.com/plugin/structure">here</a> .  You can also explore the device add-ons that we personally posted on <a href="https://github.com/ONLYOFFICE/sdkjs-plugins/tree/develop">GitHub</a> . <br><br>  On this, perhaps, everything.  And yes - we hope over time to see the riot of plug-ins created by the community.  In any case, it is very curious what functions our users will add. </div><p>Source: <a href="https://habr.com/ru/post/314716/">https://habr.com/ru/post/314716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314702/index.html">Release Rust 1.12.1</a></li>
<li><a href="../314706/index.html">7 useful plugins for Sketch</a></li>
<li><a href="../314708/index.html">We are waiting for everyone at GeekWeek 2016: learn and have fun</a></li>
<li><a href="../314710/index.html">Odin a year later: Oleg Melnikov - about what happened after the purchase of Parallels cloud division</a></li>
<li><a href="../314712/index.html">Recall everything: how to quickly recover data that was mistakenly changed by the user.</a></li>
<li><a href="../314718/index.html">"Transparent" Squid with access control</a></li>
<li><a href="../314720/index.html">The release of mobile games in China is more complicated than ever.</a></li>
<li><a href="../314722/index.html">Google and Samsung fixed Dirty COW vulnerability in Android firmware</a></li>
<li><a href="../314724/index.html">One scientifically based way to rationally manage your busy and busy schedule</a></li>
<li><a href="../314726/index.html">JRuby + Ratpack = ‚ù§Ô∏è</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>