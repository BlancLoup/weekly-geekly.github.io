<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASA: access lists (continued cycle of articles about ASA)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pretty simple chapter. Access lists (ACL, Access Control List) are the rules for checking the ip header of a packet up to level 4 of the OSI model. Ac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASA: access lists (continued cycle of articles about ASA)</h1><div class="post__text post__text-html js-mediator-article">  Pretty simple chapter.  Access lists (ACL, Access Control List) are the rules for checking the ip header of a packet up to level 4 of the OSI model.  Access lists are simply constructs consisting of lines.  In each line - the rule to allow (permit) or deny (deny).  The lines are viewed from top to bottom for exact match of the package header with the line of the access list.  Access lists on the ASA can perform several roles: <br><br>  1. Filtering on the interface of incoming or outgoing traffic <br>  2. Description of NAT Rules (Policy NAT) <br>  3. Description of the rules of route redistribution (in the route-map) <br>  4. The criterion for entering the traffic class for further processing (Modular Policy Framework, MPF) <br>  5. Description of "interesting traffic" for encryption.  Applies the crypto map access list <br>  6. Description of the rights of the remote user when connecting via IPSec or SSL VPN <br>  Important: at the end of any access list there is an invisible ‚Äúdeny all‚Äù, so no packet will pass by the access list. <br><a name="habracut"></a><br><br>  Access lists are divided into standard and extended. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Standard access lists check only source addresses.  On the ASA, such access lists have very narrow application (for example, to describe traffic for a remote VPN user, which needs to be wrapped in a tunnel. Split Tunneling technology) <br><br>  Command format <br><br><pre> access-list {NAME} [line #] standard {permit | deny | remark} {NETWORK} {MASK}
</pre><br><br>  The keyword <b>remark is</b> used to insert comments into access lists. <br>  The <b>line #</b> parameter is used to insert a line at a specific location in the access list.  For example, if an access list already exists and you need to insert a new line between lines 4 and 5, then it‚Äôs enough to write <br><br><pre>   access-list {NAME} line 5 {new line}
</pre><br>  all lines of a line starting from 5 will move down by 1. <br>  You can remove a specific line from the access list by explicitly writing <br><br><pre>   no access-list {NAME} {specific entire access list line}
</pre><br>  write only the line number like this <br><br><pre>   no access-list {NAME} line #
</pre><br>  no way - the ASA will say that ‚Äúincomplete command‚Äù. <br>  You can delete the entire access list line by line :) But not very convenient for large lists, so there is a command <br><br><pre>   clear configure access-list {NAME}
</pre><br>  Ignorance of this team spoils the blood of the ASA tuners and is a powerful argument for their caustic remarks :) <br><br>  <b>Important:</b> the <b>clear configure</b> command is quite powerful and can lead to unpleasant consequences, because it kills all lines from the current configuration starting with the keywords specified after the words clear configure.  For example, you can kill the entire current configuration with the command <br><br><pre>   clear configure all
</pre><br>  The network mask in the access lists on the ASA uses a direct one (and not a wildcard like on routers).  For the convenience of specifying addresses there are a number of abbreviations that are convenient to use.  So, if it is necessary to describe "all networks", then instead of cumbersome recording <br><br><pre>   0.0.0.0 0.0.0.0
</pre><br>  You can use the keyword <br><br><pre>   any
</pre><br>  instead of a host description with a mask of 32 bits <br><br><pre>   1.2.3.4 255.255.255.255
</pre><br>  You can use the host keyword in front of the address itself. <br><br><pre>   host 1.2.3.4
</pre><br>  The order of the rows in access lists is very important, since  viewing goes from top to bottom and stops at the first coincidence.  Therefore, the most accurate guidance should be put higher. <br>  Example: if we want to allow traffic to a specific host 10.1.1.100, prohibit the subnet 10.1.1.0/24 and allow everything except this network, then we must write <br><br><pre>   access-list SPLIT remark - = ACL for VPN users = -
   access-list SPLIT permit host 10.1.1.100
   access-list SPLIT deny 10.1.1.0 255.255.255.0
   access-list SPLIT permit any
</pre><br>  In this case, the indication of the host is more accurate than the indication of the network.  A network is a more accurate indication than ‚Äúall addresses‚Äù. <br><br>  The format of extended access lists is somewhat more complicated, because it also takes into account the protocol, the destination addresses and can also take into account the source and destination TCP / UDP ports (in the format of the command - one <br>  line): <br><br><pre>   access-list {NAME} [line #] {permit | deny] {protocol} {source net} {source mask} [{operator} {port #}] {destination net} {destination mask} [{operator} {port # }]
</pre><br>  <b>protocol</b> - TCP / IP stack protocol (ICMP, TCP, UDP, OSPF, IGMP, ESP, etc.) If you need to specify all IP packets, then you should write the word ‚Äúip‚Äù as a protocol <br>  <b>operator</b> - a literal entry of mathematical operators (eq - equal, gt - more, lt - less, <b>range</b> - range) <br>  <b>port</b> - the number or name of the TCP or UDP port. <br>  Example: <br><pre>   access-list ANTISPOOF deny ip host 0.0.0.0 any
   access-list ANTISPOOF deny ip host 255.255.255.255 any
   access-list ANTISPOOF permit tcp any host 1.2.3.4 eq 80
   access-list ANTISPOOF permit tcp any host 1.2.3.4 eq https
   access-list ANTISPOOF permit udp any any range 16384 32768
   access-list ANTISPOOF permit icmp any any unreachable
</pre><br>  As a convenient debugging method, you can use the <b>log</b> keyword at the end of the access list line.  Then every time a match occurs on this line, a syslog message will be generated.  You can adjust the frequency of generating such a message. <br><br>  <b>Important:</b> do not get carried away with logging!  This is a very laborious process for the ASA (and not only for it) process.  Use it only for debugging.  I personally consider it a bad tone to shove the obvious at the end everywhere (although in textbooks such a line is very much loved) <br><br><pre>   deny ip any any log
</pre><br>  It is also convenient to use the <b>inactive</b> keyword (starting with version 8.0) to temporarily disable the access list line without deleting it at all. <br><br><pre>   access-list ANTISPOOF permit icmp any any unreachable inactive
</pre><br>  To bring this line back to life, you need to type it again without the word <b>inactive</b> <br><br>  Another useful addition is the indication of the time range of the access list line.  To do this, use the construction of <b>time-range</b> <br><br><pre> time-range {NAME}
   {absolute | periodic} {running time}
</pre><br>  For example: <br><pre> time-range WORKTIME
   periodic weekdays 10:00 to 19:00
</pre><br>  The next step is to apply time-range to the access list line. <br><br><pre>   access-list {NAME} {string} time-range {NAME}
</pre><br>  For example: <br><pre>   access-list ANTISPOOF permit ip any host 198.133.219.25 time-range WORKTIME
</pre><br>  You can view the received access lists with the command <br><br><pre>   show run access-list {NAME}
</pre><br>  In this case, you will see the lines of the config, which begin with the words <b>access-list {NAME}</b> . <br>  If, however, you need to look at the access list with line numbers and line matches, it is better to use the command <br><br><pre>   show access-list {NAME}
</pre><br>  <b>Important:</b> Unlike routers that check each packet on the access list, the ASA checks the packet on the access list only if the session record is not in the session cache (for sessions, see the chapter ‚ÄúProcessing packets and creating a session‚Äù).  Therefore, the number of matches (hit) for session protocols (TCP and UDP) rather means the number of open sessions on this row. <br><br>  <b>Tip:</b> I recommend everyone to use not too long, but ‚Äúspeaking‚Äù names of access lists and write them in capital letters.  You can even work out your own names for different cases and always stick to them, for example, the access list for the backup interface would look like FROMBACKUP, and for forwarding by NAT on the dmz interface, NONATDMZ.  It often happens that the configuration is created by several administrators or a part is made using the Web interface, which creates its own list names (how inconvenient they are!) And then there is a poorly readable mess in the settings.  You can rename an access list with an ugly name using the <b>rename</b> command <br><br><pre>   access-list {UGLYNAME} rename {PRETTYNAME}
</pre><br><br>  ______________ <br>  UPD 01.01.2010 00:18 <br>  Sorry, a piece fell out <br><br>  On the interface, access lists can be applied both to the input and to the output of the interface.  The entry access list is like a nightclub security guard, who may keep you out of sight because of an unpresentable appearance.  And the list of access to the exit of the interface is similar to the turnstiles at the exit from the boutique, which begins to hysterically scrape if the glamorous strings hidden behind their bosoms smile <br><br><pre>   access-group {NAME} {in | out} interface {INTERFACE NAME}
</pre><br>  Example: <br><br><pre> access-group FROMOUTSIDE in interface outside
</pre><br>  ______________ <br><br>  <b>Object groups</b> <br><br>  If there are many similar objects in your network (for example, networks of users, servers with the same set of services, etc.), then when setting up access lists you will definitely encounter the fact that they become hard to read and poorly expandable.  To simplify the writing of large access lists on the ASA, the so-called object groups are used.  Using them, you can group similar network elements (protocols, networks, services, icmp messages). <br><br><pre> object-group network {NAME}
   network-object host {ip}
   network object {net} {mask}
 !
 object-group service {NAME} {tcp | udp}
   port-object {operator} {port}
 !
 object-group protocol {NAME} 
   protocol-object {PROTOCOL}
 !
 object-group icmp {NAME} 
   icmp-object {icmp type}
</pre><br><br>  Example: <br><pre> object-group network SERVERS
   network-object host 192.168.100.100
   network-object host 192.168.100.101
   network-object host 192.168.100.102
 !
 object-group service WEBTCP tcp
   Port object eq 80
   Port-object eq 443
   Port-object eq 1494
</pre><br><br>  The object groups themselves are used instead of explicitly specifying an element of the same type in the access list.  For example, instead of the source or destination addresses, you can apply an object group of a network type (object-group network), and instead of explicitly specifying a TCP service (ssh, http), you can apply a group of service type TCP. <br><br>  Example: <br><pre>  access-list FROMOUTSIDE permit tcp any object-group SERVERS object-group WEBTCP
</pre><br>  At the same time, the ASA will still expand your groups in the access lists line by line, but all the rows in the list with the object group will have the same row number. <br><br><pre>   asa # show access-list FROMOUTSIDE
 access-list FROMOUTSIDE line 1 permit tcp any object-group SERVERS object-group WEBTCP
 access-list FROMOUTSIDE line 1 permit tcp any host 192.168.100.100 eq 80 (hit 5)
 access-list FROMOUTSIDE line 1 permit tcp any host 192.168.100.100 eq 443
 access-list FROMOUTSIDE line 1 permit tcp any host 192.168.100.100 eq 1494
 access-list FROMOUTSIDE line 1 permit tcp any host 192.168.100.101 eq 80 (hit 2)
   &lt;output omitted&gt;
</pre><br>  Notice that the number of matches (hit) will be on each line, and not just the total number of matches. <br>  You can view object groups with the command <br><br><pre>   show run object-group [{type}]
</pre><br><br>  <b>Network Address Translation</b> (coming soon :)) </div><p>Source: <a href="https://habr.com/ru/post/81396/">https://habr.com/ru/post/81396/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../81390/index.html">Why study other people's mistakes?</a></li>
<li><a href="../81391/index.html">Project Portfolio Management and Macros for Google Spreadsheets</a></li>
<li><a href="../81392/index.html">GSmart Android Photos and Specs Published</a></li>
<li><a href="../81393/index.html">Rockstar released GTA Chinatown Wars on iPhone and iPod Touch</a></li>
<li><a href="../81394/index.html">Automatic sorting of rows with auxiliary ordinal column - using MySQL</a></li>
<li><a href="../81399/index.html">A patch for Internet Explorer will appear on January 21st (Operation Aurora)</a></li>
<li><a href="../81402/index.html">Opera Software acquired AdMarvel</a></li>
<li><a href="../81405/index.html">"Sirius" - car navigator GLONASS / GPS</a></li>
<li><a href="../81406/index.html">The newspaper FOSS News # 1 (13) and January FOSS Fest in Odessa</a></li>
<li><a href="../81408/index.html">BumpTop - 3D Desktop</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>