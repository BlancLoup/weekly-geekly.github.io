<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WebDav and Nginx</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings, gentlemen. 

 Not so long ago, in one of my projects I needed to be able to transfer files using the PUT method, without a script handler o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WebDav and Nginx</h1><div class="post__text post__text-html js-mediator-article">  Greetings, gentlemen. <br><br>  Not so long ago, in one of my projects I needed to be able to transfer files using the PUT method, without a script handler on the receiving side, the server itself had to accept and process the file.  There was also a task to implement it not on Apache, but on his colleague - Nginx. <br><br>  As a result of my research, I got such a scheme - the PHP script receives the file address and makes a request to the server, and he, in turn, receives the file and puts it into the required daddy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I will give further examples on installing, configuring and testing interactions, starting from debian-based OS. <br><br><a name="habracut"></a><br><br><h1>  Server side, Nginx </h1><br>  Download, compile and install the server with the required <a href="http://wiki.nginx.org/HttpDavModule">module</a> : <br><br> <code><a href=""></a> wget nginx.org/download/nginx-1.1.1.tar.gz <br> tar -xvf nginx-1.1.1.tar.gz <br> cd nginx-1.1.1 <br> <br> ./configure --sbin-path=/usr/sbin --conf-path=/etc/nginx/nginx.conf \ <br> --error-log-path=/var/log/nginx/error.log \ <br> --pid-path=/var/run/nginx.pid \ <br> --lock-path=/var/lock/nginx.lock \ <br> --http-log-path=/var/log/nginx/access.log \ <br> --http-client-body-temp-path=/var/lib/nginx/body \ <br> --http-proxy-temp-path=/var/lib/nginx/proxy \ <br> --http-fastcgi-temp-path=/var/lib/nginx/fastcgi \ <br> --with-http_stub_status_module \ <br> --with-http_ssl_module \ <br> <strong>--with-http_dav_module</strong> <br> <br> make &amp;&amp; make install</code> <br> <br>  Configuring the configuration: <br>  When compiling, we indicated that the configuration file will be in /etc/nginx/nginx.conf <br><br>  We are registering a new server section, as it is necessary for webdav to work on another port - this is both safer and more convenient. <br><br> <code>server { <br> listen 7500; #     nginx <br> server_name ip--; <br> charset utf-8; <br> <br> location /{ <br> expires max; <br> root ////; #      PUT'  <br> client_max_body_size 20m; <br> client_body_temp_path /usr/local/nginx/html/; <br> dav_methods PUT; # ,    PUT <br> <br> create_full_put_path on; #   ,   , nginx    <br> dav_access user:rw group:r all:r; #   <br> <br> limit_except GET { <br> allow all; <br> } <br> } <br> }</code> <br> <br>  <em>I also want to note that with the configured module, the other WebDav directives specified in the Nginx configuration file are also implemented: DELETE, MKCOL, COPY, MOVE.</em> <br><br><h1>  The side of the "client", the second server, PHP script </h1><br>  Let's stipulate that the $ namefile variable already contains the file name of the form file.zip obtained in one way or another. <br><br> <code>$url = "ip--:7500/$namefile"; <br> $file = "/files/$namefile"; <br> <br> $fp = fopen($file, "r"); <br> $curl = curl_init(); <br> <br> curl_setopt($curl, CURLOPT_VERBOSE, 1); <br> curl_setopt($curl, CURLOPT_URL, $url); <br> curl_setopt($curl, CURLOPT_PUT, 1); <br> curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); <br> curl_setopt($curl, CURLOPT_INFILE, $fp); <br> curl_setopt($curl, CURLOPT_INFILESIZE, filesize($file)); <br> <br> curl_close($curl); <br> fclose($fp);</code> <br> <br><h1>  Total </h1><br>  Now that everything is installed and configured, we can access the script, pass the path to the file, and the script will transfer our file to the server, which in turn without PHP, Perl, or written in another handler language will be able to receive and place the file on another server. <br><br>  I hope that the written text was interesting to you, I will take my leave for this. </div><p>Source: <a href="https://habr.com/ru/post/127232/">https://habr.com/ru/post/127232/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127225/index.html">LiveInternet.ru: how user passwords are stored</a></li>
<li><a href="../127227/index.html">Quick and automatic launch of Django on IIS 7.x in a production environment (+ performance tests)</a></li>
<li><a href="../127229/index.html">We write letters from iOS applications</a></li>
<li><a href="../127230/index.html">Internetbank on iPhone and iPad from Bank24.ru</a></li>
<li><a href="../127231/index.html">Your mobile operator may be at fault for quickly discharging a smartphone's battery</a></li>
<li><a href="../127233/index.html">3rd .NET Developer Conference</a></li>
<li><a href="../127234/index.html">Yii-debug-toolbar extension</a></li>
<li><a href="../127235/index.html">Practice radio as it is</a></li>
<li><a href="../127236/index.html">Integration of SMF 2.0 forum and CMS Livestreet 0.4.2</a></li>
<li><a href="../127237/index.html">Simple Twitter bot in Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>