<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Improving the Flyweight Pattern in Bio-Calculations</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 

 Immediately I apologize for the complexity, but both the situation itself is difficult to apply and the solution, but the result is beau...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Improving the Flyweight Pattern in Bio-Calculations</h1><div class="post__text post__text-html js-mediator-article">  <b>Prehistory</b> <br><br>  Immediately I apologize for the complexity, but both the situation itself is difficult to apply and the solution, but the result is beautiful and effective :) <br><br>  It began with the fact that he described one problem <a href="http://habrahabr.ru/blogs/net/138594/">about the problems of the PLO</a> .  Then, by chance, thanks to the conversations, I began to think about design patterns.  And in connection with the topic ‚Äúfull copying of an object‚Äù I went on the Flyweight pattern.  Who does not know - please first read about it in <a href="http://ru.wikipedia.org/wiki/Design_Patterns">Object-oriented design techniques.</a>  <a href="http://ru.wikipedia.org/wiki/Design_Patterns">Design patterns</a> (Not in the wiki, but in the original). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basic idea there is this: <br><br>  <i>The Flyweight pattern describes how to jointly share very small objects without excessively high costs.</i>  <i>Each adaptive object has two parts: the internal and external states.</i>  <i>The internal state is stored (shared) in the opportunist and consists of information that does not depend on its context.</i>  <i>The external state is stored or calculated by client objects and passed to the opportunist when calling his methods.</i> <br><br>  <b>Task</b> <br><br>  We will look at how to improve on a concrete example.  I will say very little about bio-computations - but an example will be built on this.  I will try to completely erase the essence of bio-calculations, leaving only the scheme. <br><br>  PS If someone is interested in the problems of bio-calculations on the task of folding RNA / proteins - place an order and then write a separate article. <br><br><a name="habracut"></a><br><br>  So there is an RNA object (RNA).  He is the heir to the more general object Chain (Chain of molecules) (for example, there may be DNA, proteins, etc.).  Each RNA consists of a variety of molecules (nucleotides) (Molecule).  In this case, the molecule can be of four types (the heirs of Molecule) - Cytosine, Uracil, Guanine, Adenine.  Each molecule, depending on the type, consists of 28-33 atoms (Atom).  Each atom has three calculated angles. <br><br><blockquote>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> Angles <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">float</font> phi <font color="#008080">;</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">float</font> theta <font color="#008080">;</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">float</font> d <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br></blockquote><br><br>  Required on the basis of the primary structure of the chain, for example, aagaggucggcaccugacgu - to build a three-dimensional model.  Those.  create about 1000 interconnected atoms, which in general form represent a graph.  Creating this graph takes a lot of time. <br><br>  Next you need to perform bioassays.  This chain takes a certain 3D configuration.  The coordinates of each atom and its angles with respect to the other atom are calculated.  The calculations are carried out according to the scheme - we take the last "good" state of RNA and try to "improve" it.  We make, say, 1000 attempts to rotate one molecule in one corner.  From this 1000, only one best option is selected ‚Äî fixed (becomes a ‚Äúgood‚Äù state) and the calculations are repeated. <br><br>  <b>Solution to the forehead</b> <br><br>  Actually, it was decided at the beginning, it was inherited from the code of the Rosseta @ home project. <br><br>  As you can see, to spend 1000 attempts to rotate, you need to copy the initial state.  Those.  there are objects <br><br><blockquote>  RNA BestRNA <font color="#008080">;</font> <br>  RNA CurrentRNA <font color="#008080">;</font> </blockquote><br><br>  And you need to do <br><br><blockquote>  CurrentRNA <font color="#008000">=</font> BestRNA.  <font color="#0000FF">Clone</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#008000">;</font> <br>  Calculate <font color="#000000">(</font> CurrentRNA <font color="#000000">)</font> <font color="#008000">;</font> <br></blockquote><br><br>  The problem is precisely this Clone ().  Remember that constructing a graph of all atoms is a very resource-intensive procedure. <br>  And if you do not build, then we wipe the corners of all atoms in a ‚Äúgood‚Äù state. <br><br>  <b>Classic Flyweight</b> <br><br>  Classic Flyweight suggests that we extend the properties of the corners from atoms and place them in the objects above.  To the extent that the array to be located in the RNA object.  This array will be indexed in some way so that the index can unambiguously get into the desired atom. <br><br>  Then, during cloning, only this array will need to be cloned, and the atomic graph is not needed. <br><br>  But all this seriously violates the principles of the PLO.  In essence, the properties of an object are selected from objects in order to increase the speed of calculations.  The model loses its essence - the corners are no longer properties of atoms, but properties of the whole chain.  Not serious.  This is a sign of structured programming, not an object. <br><br>  <b>What to do?</b> <br><br>  The main thing to realize first is that we actually do the calculations <b>in time</b> .  Those.  we need to maintain the trajectory of atoms over time.  The object picture is then restored. <br><br>  Further there will be a lot of code with a minimum of comments, which is not clear, ask. <br><br>  So, the first thing we are doing is replacing single angles with arrays of time, but with access by the current time. <br><br><blockquote>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> Angles <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">float</font> <font color="#008000">[</font> <font color="#008000">]</font> phi <font color="#000080">=</font> <font color="#0000dd">new</font> <font color="#0000ff">float</font> <font color="#008000">[</font> Chain.  <font color="#007788">TimeHistory</font> <font color="#008000">]</font> <font color="#008080">;</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">float</font> <font color="#008000">[</font> <font color="#008000">]</font> theta <font color="#000080">=</font> <font color="#0000dd">new</font> <font color="#0000ff">float</font> <font color="#008000">[</font> Chain.  <font color="#007788">TimeHistory</font> <font color="#008000">]</font> <font color="#008080">;</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">float</font> <font color="#008000">[</font> <font color="#008000">]</font> d <font color="#000080">=</font> <font color="#0000dd">new</font> <font color="#0000ff">float</font> <font color="#008000">[</font> Chain.  <font color="#007788">TimeHistory</font> <font color="#008000">]</font> <font color="#008080">;</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">float</font> phi <br>  <font color="#008000">{</font> <br>  get <font color="#008000">{</font> <font color="#0000ff">return</font> phi <font color="#008000">[</font> Chain.  <font color="#007788">Time</font> <font color="#008000">]</font> <font color="#008080">;</font>  <font color="#008000">}</font> <br>  set <font color="#008000">{</font> phi <font color="#008000">[</font> Chain.  <font color="#007788">Time</font> <font color="#008000">]</font> <font color="#000080">=</font> value <font color="#008080">;</font>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">float</font> theta <br>  <font color="#008000">{</font> <br>  get <font color="#008000">{</font> <font color="#0000ff">return</font> theta <font color="#008000">[</font> Chain.  <font color="#007788">Time</font> <font color="#008000">]</font> <font color="#008080">;</font>  <font color="#008000">}</font> <br>  set <font color="#008000">{</font> theta <font color="#008000">[</font> Chain.  <font color="#007788">Time</font> <font color="#008000">]</font> <font color="#000080">=</font> value <font color="#008080">;</font>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">float</font> D <br>  <font color="#008000">{</font> <br>  get <font color="#008000">{</font> <font color="#0000ff">return</font> d <font color="#008000">[</font> Chain.  <font color="#007788">Time</font> <font color="#008000">]</font> <font color="#008080">;</font>  <font color="#008000">}</font> <br>  set <font color="#008000">{</font> d <font color="#008000">[</font> Chain.  <font color="#007788">Time</font> <font color="#008000">]</font> <font color="#000080">=</font> value <font color="#008080">;</font>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> SetInitial <font color="#008000">(</font> <font color="#0000ff">int</font> argTime <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  Phi <font color="#000080">=</font> phi <font color="#008000">[</font> argTime <font color="#008000">]</font> <font color="#008080">;</font> <br>  Theta <font color="#000080">=</font> theta <font color="#008000">[</font> argTime <font color="#008000">]</font> <font color="#008080">;</font> <br>  D <font color="#000080">=</font> d <font color="#008000">[</font> argTime <font color="#008000">]</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> </blockquote><br><br>  Then time is controlled at the circuit level, i.e.  the topmost object.  I give a piece of code and gradually explain.  The whole idea will be clear only at the end (the presentation is like in mathematics - at first it is not clear what is needed, and only at the end it is clear why all this is). <br><br><blockquote>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> Chain <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">static</font> Chain instance <font color="#008080">;</font> <br>  <font color="#0000ff">public</font> Chain <font color="#008000">(</font> <font color="#0000ff">int</font> MolCount <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  instance <font color="#000080">=</font> <font color="#0000dd">this</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#666666">/// Current time</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">int</font> <font color="#0000dd">time</font> <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">int</font> Time <br>  <font color="#008000">{</font> <br>  get <font color="#008000">{</font> <font color="#0000ff">return</font> instance.  <font color="#0000dd">time</font> <font color="#008080">;</font>  <font color="#008000">}</font> <br>  set <font color="#008000">{</font> instance.  <font color="#0000dd">time</font> <font color="#000080">=</font> value <font color="#008080">;</font>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">int</font> OldTime <br>  <font color="#008000">{</font> <br>  get <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">int</font> oldTime <font color="#000080">=</font> instance.  <font color="#0000dd">time</font> <font color="#000040">-</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> oldTime <font color="#000080">==</font> <font color="#000040">-</font> <font color="#0000dd">1</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  oldTime <font color="#000080">=</font> TimeHistory <font color="#000040">-</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">return</font> oldTime <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#666666">/// The number of time steps that the object stores</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">int</font> TimeHistory <font color="#000080">=</font> <font color="#0000dd">5</font> <font color="#008080">;</font> <br><br>  <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">int</font> generation <font color="#008080">;</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">int</font> Generation <br>  <font color="#008000">{</font> <br>  get <font color="#008000">{</font> <font color="#0000ff">return</font> generation <font color="#008080">;</font>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#666666">/// Setting the time one step further.</font> <br>  <font color="#0000ff">protected</font> <font color="#0000ff">void</font> NextTime <font color="#008000">(</font> <font color="#0000ff">int</font> argGeneration <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  Time <font color="#000040">++</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> Time <font color="#000080">&gt; =</font> TimeHistory <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  Time <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  generation <font color="#000080">=</font> argGeneration <font color="#000040">+</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  CurrentMaxTimeID <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> CheckTime <font color="#008000">(</font> <font color="#0000ff">int</font> argTimeID, <font color="#0000ff">int</font> argGeneration <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  <font color="#666666">// There can be no generation more than 2 times older, and if this is the current generation,</font> <br>  <font color="#666666">// then the time stamp cannot be longer than the stamps issued</font> <br>  <font color="#666666">// (this can only be between current and past generation)</font> <br>  <font color="#666666">// there can be no more generation than current</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> argGeneration <font color="#000080">&lt;</font> <font color="#008000">(</font> generation <font color="#000040">-</font> <font color="#0000dd">1</font> <font color="#008000">)</font> <font color="#000040">||</font> <br>  <font color="#008000">(</font> argGeneration <font color="#000080">==</font> generation <font color="#000040">&amp;&amp;</font> CurrentMaxTimeID <font color="#000080">&lt;</font> argTimeID <font color="#008000">)</font> <font color="#000040">||</font> <br>  argGeneration <font color="#000080">&gt;</font> generation <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  Console.  <font color="#007788">WriteLine</font> <font color="#008000">(</font> <font color="#FF0000">"ErrorGenerationRNA"</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  Console.  <font color="#007788">ReadLine</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> Time <font color="#000040">!</font> <font color="#000080">=</font> argTimeID <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  Time <font color="#000080">=</font> argTimeID <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">int</font> CurrentMaxTimeID <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">int</font> GetNextTimeID <font color="#008000">(</font> <font color="#0000ff">int</font> argCurrentTimeID, <font color="#0000ff">int</font> argGeneration <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">int</font> NextTime <font color="#000080">=</font> <font color="#000040">-</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br><br>  <font color="#0000ff">if</font> <font color="#008000">(</font> argGeneration <font color="#000080">==</font> generation <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  NextTime <font color="#000080">=</font> argCurrentTimeID <font color="#000040">+</font> <font color="#0000dd">1</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> argGeneration <font color="#000080">==</font> generation <font color="#000040">-</font> <font color="#0000dd">1</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  NextTime <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> CurrentMaxTimeID <font color="#000080">&lt;</font> NextTime <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  CurrentMaxTimeID <font color="#000080">=</font> NextTime <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">return</font> NextTime <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> </blockquote><br><br>  Chain performs the Singleton pattern, but not quite classically.  First, when the first RNA object (the successor of the Chain) is created, through a specific constructor, the link to the instance is replaced.  Those.  this is not the only object at all, but the last one created.  And actually, the link to the object is not provided.  You can get only the current time Time.  Thus, ‚Äúold objects‚Äù from RNA may still exist, but not in time. <br><br>  Arrays are created by the TimeHistory value.  This is a relative value, the number of steps in the trajectory of states, which is important to have SIMULTANEOUSLY.  In our example there could be two in general: Best and Current.  But for optimality, slightly increased to 5. <br><br>  Further, what is being done.  You need to fully control access to RNA properties / methods in order to make it work in time.  We use the ‚ÄúMediator‚Äù pattern (but so that the using class does not understand this ‚Äî that is, transparently) <br><br>  RNA class is renamed to RNARealise.  And instead of a real RNA, we create a ‚Äúmiddleman‚Äù: <br><br><blockquote>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> RNA <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">private</font> RNARealise body <font color="#008080">;</font> <br><br>  <font color="#0000ff">private</font> <font color="#0000ff">int</font> TimeID <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br>  <font color="#0000ff">private</font> <font color="#0000ff">int</font> GenerationID <font color="#000080">=</font> <font color="#0000dd">0</font> <font color="#008080">;</font> <br><br>  <font color="#0000ff">public</font> molecule <font color="#008000">[</font> <font color="#008000">]</font> molecules <br>  <font color="#008000">{</font> <br>  get <br>  <font color="#008000">{</font> <br>  body  <font color="#007788">CheckTime</font> <font color="#008000">(</font> TimeID, GenerationID <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#0000ff">return</font> body.  <font color="#007788">Molecules</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">public</font> RNA <font color="#008000">(</font> RNASeq argSeq <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  body <font color="#000080">=</font> <font color="#0000dd">new</font> RNARealise <font color="#008000">(</font> argSeq <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#0000ff">public</font> RNA Clone <font color="#008000">(</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  body  <font color="#007788">CheckTime</font> <font color="#008000">(</font> TimeID, GenerationID <font color="#008000">)</font> <font color="#008080">;</font> <br>  RNA NewRNA <font color="#000080">=</font> <font color="#008000">(</font> RNA <font color="#008000">)</font> <font color="#0000dd">this</font> .  <font color="#007788">MemberwiseClone</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  NewRNA.  <font color="#007788">body</font> <font color="#000080">=</font> NewRNA.  <font color="#007788">body</font>  <font color="#007788">Clone</font> <font color="#008000">(</font> <font color="#0000dd">this</font> . <font color="#007788">GenerationID</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  NewRNA.  <font color="#007788">TimeID</font> <font color="#000080">=</font> Chain.  <font color="#007788">GetNextTimeID</font> <font color="#008000">(</font> <font color="#0000dd">this</font> . <font color="#007788">TimeID</font> , <font color="#0000dd">this</font> . <font color="#007788">GenerationID</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  NewRNA.  <font color="#007788">GenerationID</font> <font color="#000080">=</font> Chain.  <font color="#007788">Generation</font> <font color="#008080">;</font> <br><br>  <font color="#0000ff">return</font> NewRNA <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> Refold <font color="#008000">(</font> <font color="#0000ff">int</font> argPosition <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  body  <font color="#007788">CheckTime</font> <font color="#008000">(</font> TimeID, GenerationID <font color="#008000">)</font> <font color="#008080">;</font> <br>  body  <font color="#007788">Refold</font> <font color="#008000">(</font> argPosition <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> </blockquote><br><br>  What is important here?  An identifier is added to the object ‚Äî the TimeID time stamp and the generation of GenerationID objects.  And before each access to the property and before each time call we check whether the body.CheckTime object (TimeID, GenerationID) is in that time. <br><br>  And consider how public cloning is emulated by public RNA Clone (). <br><br>  in reality, only the mediator shell is cloned, in which a new time and generation stamp is assigned.  Inside there will be another translation time clone NextTime (argGeneration).  And at the level of molecule cloning, the initialization of the angles will be the previous value <br><br><blockquote>  <font color="#0000ff">for</font> <font color="#008000">(</font> <font color="#0000ff">int</font> i <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> i <font color="#000080">&lt;</font> FullAngles. <font color="#007788">Length</font> <font color="#008080">;</font> i <font color="#000040">++</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  FullAngles <font color="#008000">[</font> i <font color="#008000">]</font> .  <font color="#007788">SetInitial</font> <font color="#008000">(</font> Chain. <font color="#007788">OldTime</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br></blockquote><br><br>  That is significantly less than full cloning.  And all the calling code doesn‚Äôt change at all - there, as was done, the cloning is done.  The calculation had something like this. <br><br><blockquote>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> BlockFolding <font color="#008000">(</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  RNA saveRNA <font color="#000080">=</font> CurrentRNA.  <font color="#007788">Clone</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  locScore <font color="#000080">=</font> NucFluctuation <font color="#008000">(</font> saveRNA <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#666666">// save the best state found</font> <br>  save <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#0000ff">public</font> <font color="#0000ff">double</font> NucFluctuation <font color="#008000">(</font> RNA argRNA <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  <font color="#0000ff">for</font> <font color="#008000">(</font> <font color="#0000ff">int</font> j <font color="#000080">=</font> <font color="#0000dd">1</font> <font color="#008080">;</font> j <font color="#000080">&lt;</font> FragmentCount <font color="#008080">;</font> j <font color="#000040">++</font> <font color="#008000">)</font> <br>  <font color="#008000">{</font> <br>  RNA locRNA <font color="#000080">=</font> argRNA.  <font color="#007788">Clone</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#666666">// Making a turn</font> <br>  Rotate.  <font color="#007788">AtomAngleRotate</font> <font color="#008000">(</font> locRNA <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#666666">// Calculate the profitability of the turn</font> <br>  RNAScore.  <font color="#007788">Score</font> <font color="#008000">(</font> locRNA <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br></blockquote><br><br>  Try to guess how it happens that angles are not confused at different times, although no one controls the time from above directly?  (in general, I will leave it to the ‚Äúhomework‚Äù to the reader, if it is still difficult to understand, I will understand by the comments). </div><p>Source: <a href="https://habr.com/ru/post/140046/">https://habr.com/ru/post/140046/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140041/index.html">Tactoom. What about middle blogging?</a></li>
<li><a href="../140042/index.html">HTC announced a new technology for the manufacture of housing for the smartphone</a></li>
<li><a href="../140043/index.html">AWS in Northern Virginia: Network Problems</a></li>
<li><a href="../140044/index.html">Protection in a virtual environment: checklist of threats</a></li>
<li><a href="../140045/index.html">Cloudpaging is a new technology for migrating applications to the cloud.</a></li>
<li><a href="../140047/index.html">10 most popular games for Ubuntu version UALinux</a></li>
<li><a href="../140049/index.html">Forced movement and / or installation of applications on a memory card without Root</a></li>
<li><a href="../140050/index.html">A few problems when creating your own programming language</a></li>
<li><a href="../140051/index.html">Asterisker's Notes - Exchange of Works and Services on VoIP - Telephony</a></li>
<li><a href="../140052/index.html">Transparent proxy server Squid with a password on Ubuntu 11.04</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>