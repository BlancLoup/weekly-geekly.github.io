<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IPhone game development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IPhone game development 

 Start 
 In October 2008, at a regular meeting with two friends, I learned that both of them are engaged in the development ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IPhone game development</h1><div class="post__text post__text-html js-mediator-article"><h4>  IPhone game development </h4><br><br><h5>  Start </h5><br>  In October 2008, at a regular meeting with two friends, I learned that both of them are engaged in the development of games for the iPhone.  At that time, I already had an almost finished shareware project under Windows. <br>  Burning with the desire to port it to the iPhone, I started working in this direction. <br><br><h5>  Goals </h5><br>  Create and customize development tools for Windows platform without buying the device itself, Mac and related development tools.  The purchase of a Mac has been postponed until the moment of complete understanding of what and how it works. <br>  Almost finished project and tools for it were under Windows, so it was decided to do everything under Windows. <br>  A few days to search the Internet and I started to implement this idea. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Step One - Setting up the environment and compiler for Windows, or rather, for Cygwin </h5><br>  It took about a month to build a toolchain under Cygwin.  The result was a huge makefile for the assembly toolchain and the compiled HelloWorld application, which had nowhere to run, since I did not have a device.  When I say that it took a month, it does not mean that I worked on it for 8 hours a day, mostly work was done on weekends and after work.  It took a lot of time to recompile, fix problems with paths, fix compile problems, and set up the CygWin environment (I only rearranged Cygwin three times). <br><br><a name="habracut"></a><h5>  Step Two - Recompilation of the finished Windows project under the iPhone toolchain </h5><br>  This step also took about 1 month.  I first met GCC, the command line, makefile, as a Windows programmer learned a lot of interesting and useful things.  Separately, I want to highlight the time spent on changing the code for the needs of the GCC and iPhone SDK.  It took a lot of time to disassemble the header files, to search for functions under the Unix environment (sometimes they did not coincide or were absent).  Bringing your code into a portable form via #define and interfaces went pretty painlessly, as well as building the Third Party libraries that I needed, such as Lua.  Very much with saving time on the fact that the project was originally tied to OpenGL and OpenAL.  Both my friends warned me that there were a lot of problems when working with sound on the iPhone, in my case, OpenAL started working right away; moreover, I didn‚Äôt even touch the audio code.  It also helped that at one time the engine core (each game programmer should have its own home engine) was tested under Embeded Visual Studio for smartphones.  During this period, the development and testing process itself is less established.  It is very convenient to make changes in Far or Visual Studio and check the compilation for iPhone toolchain.  Check the performance of the game after changing the code was checked in Windows.  At some point, it was decided to test the performance under Linux, for which Fedora Linux was installed on VirtualBox.  I would especially like to note that the presence of Unit tests allowed us to quickly identify and fix most of the problems (I could only run on Linux, but this was already enough).  I also want to advise you to include the maximum level of varnings and stop compiling if there are varnings (-Werror for GCC), and fix them all, only because of this a few cunning bugs were fixed.  Objective-C was used only in 3x files, everything else is written in C ++.  So it was not possible to understand the processing of dependencies between source files (.cpp) and header files (.h) for correct recompilation if only .h files are modified. <br>  Total: <br><ul><li> The game runs under Windows is compiled for the iPhone platform.  Using so-called configs platforms, I could launch a game that behaved almost like a real device, including device resolution, landscape orientation, texture dimension, etc. <br>  Config.cfg config example <br> <code>[PLATFORM_] <br> ; COMMON <br> [PLATFORM_IPHONE] <br> ;   <br> maxTextureSize = 256 <br> touchInput = 1 <br> hideArrowCursor = 1;     <br> defines = PLATFORM=IPHONE <br> fixedVideoResolution = 1 <br> [PLATFORM_IPHONE_WIN32] <br> ;     ‚Äú ‚Äù <br> maxTextureSize = 256 <br> SupportNonPower2 = 0 ;      <br> touchInput = 1 <br> #hideArrowCursor = 1 ;    <br> fixedVideoResolution = 1 <br></code> <br></li><li>  Windows version <br><img src="https://habrastorage.org/getpro/habr/post_images/688/965/5b0/6889655b002248e452467cd68f8077a3.png" alt="Windows version"><br></li><li>  A workable toolchain for compiling a program on an iPhone.  Here, quite unexpectedly, I found CygwinPutty - a modification of PuTTy to work under Cygwin, made it Portable and rendered a link to Quick Launch <br><img src="https://habrastorage.org/getpro/habr/post_images/487/3da/a70/4873daa705e3b42206d6c4e2c420bad8.png" alt="CygwinPutty"><br></li></ul><br><h5>  Step three - buying a device and developing it for the device itself </h5><br>  To check the performance on the iPhone, the iPod Touch 3g 8GB was purchased (as it turned out later, the 8gb version of the iPod Touch is 2g hardware).  A jailbreak was made, and it all worked the first time.  Added a few lines in the makefile so that he uploaded the compiled project to the device.  For apload, scp was used from the command line, in order not to enter passwords, authorization via keys was constantly enabled. <br><br><h5>  Step Four - Optimization and Debugging </h5><br>  Almost immediately it turned out that the processor on my iPod Touh 2g does not cope with the simulation of physics, while it does not cope so much that the question of ending the development of this game for iPhone really became.  On large scenes, the simulation could take up to 300 ms per frame, which is naturally unacceptable.  In the end result, I separated the rendering from the physics simulation.  Rendering went with a maximum FPS if the detonation of the charges was not started, and was limited to 10 FPS at the start of the detonation.  Physics after launch was considered to be ahead and to the maximum, that is, as soon as you pressed the explosion button and you started playing the sound of a siren, physics could already have been calculated 1-2 seconds ahead.  Of course, I had to reconfigure the simulation of physics in order to somehow get into performance, as a result I got a small slow motion.  For the future, activity was planned for the final setting of physics, so that there was exactly as much performance on my iPod Touh 2g.  Accordingly, iPod Touch 2g devices were taken as the minimum base.  After playing around with the GCC optimizer settings, -O3 was selected.  Of course, the 3D scene was optimized, the number of DrawCall was reduced, a proxy was added for OpenGL states, the buffer vertex (VBO) was bolted, the number of drawings with AlphaTest turned on was almost zero. <br>  Debugging was done through logs and gdb installed on the device.  Taking into account that the code under Windows was licked and well tested, there were no problems.  Memories were cleaned under Windows through Visual Leak Detector.  Possible problems with OpenGL and profiling with geDebugger. <br><br><h5>  Step Five - MacOS and xCode </h5><br>  In principle, in this state it is already possible to upload a project for sale on Cydia, but I very much wanted to get on the AppStore, for this, of course, you need to collect it under a Mac and compile xCode.  MaOS 10.6.5 and xCode were installed on VirtualBox. <br>  A few days were spent on the assembly under the iPhone simulator and the project was completed. <br><br><h5>  Step Six - Buying a Certificate and Passing Certification </h5><br>  In order for xCode to build an application for a device, a developer must purchase the ‚ÄúiOS Developer Program‚Äù - this privilege costs $ 99 per year.  I ordered and received a credit card, and in full confidence that everything would start to register well as a developer for the iPhone. <br>  Apple does not accept credit cards from Ukraine.  They need to fill out a form and fax it (for Russia, as I understand it, the situation is similar). <br><ul><li>  January 28, 2011 - Completed and sent through PamFax </li><li>  February 2, 2011 came the answer </li></ul><br><h5>  Step Seven - Mac Mini </h5><br>  After a while, the Mac Mini was purchased. <br>  For several reasons: <br><ul><li>  The compilation speed under the virtual machine was very small. </li><li>  The stage of searching and checking was over - one had to start doing everything in a legal way. </li></ul><br>  Nevertheless, I did not refuse to use the toolchain.  The main development is carried out on a Windows machine.  Tulchain is used to check compilation. <br><br><h5>  Step Eight - Release Lite Version </h5><br>  Since the game mechanic is not at all casual, it was decided to release the Lite version first. <br><ul><li>  June 1, 2011 - Laid out for review. </li><li>  June 8, 2011 - Ready for Sale </li></ul><br><h5>  Step Nine - Feedback on the Lite Version </h5><br>  As it turned out, some of my user interface solutions were not as intuitive as I thought. <br>  For example: <br><img src="https://habrastorage.org/getpro/habr/post_images/026/af6/af0/026af6af060e0c7b65bfba939abeccad.png" alt="Windows version"><br><br>  The picture is old and new interfaces <br>  The Play button (arrow below) was clearly incomprehensible to the players, many simply did not guess to press it.  Solution - click on the level starts the level immediately, the Play button has been removed.  The page switching buttons were redrawn and replaced with simple arrows. <br><br><h5>  Technical details </h5><br><h6>  Gamecenter Integration </h6><br>  Passed without problems thanks to the example of GKTapper - <a href="http://developer.apple.com/library/ios/">developer.apple.com/library/ios/#samplecode/GKTapper/Introduction/Intro.html</a> <br>  GameCenterMenager.h and GameCenterMenager.m passed to my code without changes <br><br><h6>  OpenFeint Integration </h6><br>  I spent the day searching for the problem because of which the OpenFeint dashboard did not show up, after reading the documentation it turned out - I forgot to hide my window by event <br> <code>- (void)dashboardWillAppear <br> { <br> self.hidden=YES; <br> } <br> - (void)dashboardDidDisappear <br> { <br> self.hidden=NO; <br> } <br></code> <br><h6>  Facebook integration </h6><br>  It was made as written in <a href="http://developers.facebook.com/docs/guides/mobile">developers.facebook.com/docs/guides/mobile</a> . <br>  But there were problems due to the fact that OpenFeint already used some old Facebook sdk and there were errors during linking.  The solution was very simple - in the Facebook headers of the sdk, I had to add the following defaines #define FBDialog MFBDialog <br>  Also in the process of testing, it turned out that Facebook shows a captcha if your links to images are outside of the facebook domain. <br><br><h6>  Twitter integration </h6><br>  MGTwitter was used - <a href="https://github.com/mattgemmell/MGTwitterEngine">github.com/mattgemmell/MGTwitterEngine</a> <br>  I also had to add a dialogue for a pre-show on Twitter (it was not in this sdk).  I got out through UIWebView in which the page was shown in the input form, pressing the Post and Skip buttons were intercepted and then forwarded to MGTwitter. <br><br><h6>  Rate me </h6><br>  A small library was chosen <a href="https://charcoaldesign.svn.beanstalkapp.com/source/cocoa/iRate/trunk/">https://charcoaldesign.svn.beanstalkapp.com/source/cocoa/iRate/trunk/</a> <br>  For the light version, an interval of 7 days and 7 launches was chosen. <br>  For a full 20 days and 20 launches. <br><br><h6>  Multi touch </h6><br>  To debug multitouch under Windows, a small server was written for the device, to which the Win32 game joined at the start and received all the touch events of the device. <br><br><h6>  Control of faith </h6><br>  Svn for code and data.  On Mac, the code is taken from a shared directory from a Windows machine.  While I work alone this is not a problem and saves time. <br><br><h5>  Expenses </h5><br><ul><li>  iPod Touch 2g 8GB - $ 270 </li><li>  iOS developer - $ 100 </li><li>  MacMini - $ 800 </li><li>  Free time </li></ul><br><h5>  Result </h5><br><ul><li>  Lite version in the AppStore </li><li>  Full version in the AppStore </li><li>  Experience </li></ul><br><h4>  What was good </h4><br><ul><li>  Selection of the main Windows platform.  The ability to quickly start up and by pressing the R button to reload / load resources saves a lot of time.  My experience as a programmer on this platform for about 10 years is to relearn for xcode for a long time.  Very convenient and easy to shoot video. </li><li>  Goals are one of the few home projects that have been completed.  Often, all my home projects go on the back burner due to lack of time.  This time I had a clear goal. </li></ul><br><h5>  What was bad </h5><br><ul><li>  I did art by myself and partly turned out not very. </li><li>  The interface was originally designed for windows and was quite complex, for the iPhone I had to remove all the screens and leave only the main menu. </li><li>  Playtests - playtests were carried out on themselves.  The main problem is ‚Äúblurring the eyes‚Äù - I could not notice the obvious problems that a simple player could see immediately. </li><li>  The rhythm of work - working at such a pace is very difficult. </li></ul><br><br>  References: <br><ul><li>  Useful link about registration in iOS Developer Program - <a href="http://www.iphones.ru/forum/index.php%3Fshowtopic%3D31536%26st%3D0%3Fs%3D3988650a9a235fc5021ea885f11572f5">www.iphones.ru/forum/index.php?showtopic=31536&amp;st=0?s=3988650a9a235fc5021ea885f11572f5</a> </li><li>  Very good instruction from buying a certificate to building an application - <a href="http://habrahabr.ru/blogs/macosxdev/86597/">habrahabr.ru/blogs/macosxdev/86597</a> </li><li>  <a href="http://stackoverflow.com/">stackoverflow.com</a> - almost all solutions to my code problems were taken from here </li><li>  <a href="http://www.raywenderlich.com/">www.raywenderlich.com</a> - primary sources for the integration of tweeter and facebook. </li><li>  <a href="http://www.saurik.com/id/4">www.saurik.com/id/4</a> - A variant of the toolchain that earned </li></ul><br><br><h4>  <a href="http://habrahabr.ru/blogs/macosxdev/123919/">Part two</a> </h4><br><h4>  <a href="http://habrahabr.ru/blogs/gdev/128953/">Part Three</a> </h4><br><br><habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/122351/">https://habr.com/ru/post/122351/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122342/index.html">What is a ‚Äúwork registration‚Äù?</a></li>
<li><a href="../122344/index.html">New rules for domains .RU and .–†–§</a></li>
<li><a href="../122346/index.html">Remote debugging of .NET assemblies on the Nokia N900 in Visual Studio is just</a></li>
<li><a href="../122348/index.html">Password Recovery on Cisco Routers</a></li>
<li><a href="../122349/index.html">Welcome to Pointe in St. Petersburg and Moscow!</a></li>
<li><a href="../122353/index.html">Developers! Have questions? Interview on MeeGo and bada</a></li>
<li><a href="../122354/index.html">How good are VeriSign EV SSL certificates</a></li>
<li><a href="../122358/index.html">Creating language extensions in RASE. Part 1. Language Intentions</a></li>
<li><a href="../122359/index.html">SharePoint Online Overview</a></li>
<li><a href="../122361/index.html">The problem with reading files more than 1Mb in Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>