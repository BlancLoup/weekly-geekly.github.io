<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"The second life of a 40-bit encryption key"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago I had to deal with the design and implementation of the authentication protocol. A side effect of this work was the protocol, let's call...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"The second life of a 40-bit encryption key"</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/c3cfedae/c5b334eb/e6bf9582/5dd6d1d7.jpg" alt="Combination lock" align="left">  Some time ago I had to deal with the design and implementation of the authentication protocol.  A side effect of this work was the protocol, let's call it for brevity MAuth, which uses symmetric encryption with a key length of only 40 bits, the secret key of which cannot be obtained.  Today it will be about him ... <a name="habracut"></a><br><br><h4>  What for? </h4><br>  MAuth is a development of the <a href="http://en.wikipedia.org/wiki/Encrypted_key_exchange">EKE</a> family of protocols proposed in 1992 by Stephen Bellow and Michael Merritt.  Warning the criticism of such a ‚Äúsecret‚Äù protocol, I‚Äôll make a reservation right away that the scope of MAuth is limited to the transfer of information that is relevant only at the time of the transfer.  To put it mathematically - during the time T since it was sent by one of the parties. <br><br>  An example of a task that is successfully solved by this protocol is the protection of the connection when remotely controlling an object.  It is required to ensure that it is impossible to manage without knowing the secret key and reliable client authentication systems.  Object management commands are not something secret and are described in its technical documentation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  How? </h4><br>  Let's use the <a href="http://en.wikipedia.org/wiki/Security_protocol_notation">following notation of the</a> description of the protected protocols.  The MAuth handshake mode involves just three steps: <br>  <b>I. C -&gt; S: C</b> <b><br></b>  <b>Ii.</b>  <b>S -&gt; C: {Ns} Kcs</b> <b><br></b>  <b>Iii.</b>  <b>C -&gt; S: {K'cs} Kcs</b> <br>  , where C and S are identifiers of the client and authentication server, respectively; <br>  Ns is a pseudo-random number generated by the server; <br>  Kcs is a secret key known to the client and server; <br>  K'cs is the session key, K'cs = H (Kcs + Ns).  Here H is a cryptographic hash function. <br><br>  In the transfer mode, all messages are encrypted with a session key, which has the same length as the secret - 40 bits.  This is the narrowest place of MAuth. <br><br>  Suppose that the attacker knows the first command that the client sends to the server.  In this case, using brute force, he can pick up a session key in time T. When using modern symmetric encryption algorithms whose vulnerability has not yet been found (for example, <a href="http://ru.wikipedia.org/wiki/Blowfish">Blowfish</a> ), we have enough time left before T expires to perform all the operations we need and break the connection. <br><br>  This protocol is resistant to all types of both passive and active attacks.  Listening to the attacker will give nothing except receiving the client ID.  Using a strong pseudo-random number generator does not allow to guess Ns.  Hacking a session key will also not give an opportunity to get Kcs, since it is not possible to pick up a hash of a random number (Kcs + Ns). <br><br>  Replaying messages will stumble upon server failure.  For this reason, a pseudo-random number must be unique in the context of a server communicating with a given client. <br><br>  Substitution of messages will also lead to a disconnection.  Moreover, the mutual authentication of the server by the client is deliberately omitted here to increase the speed and simplicity of the protocol.  If an attacker tries to impersonate a server, the client, having received the answer encrypted with the wrong session key at the 4th step, will simply break the connection. <br><br><h5>  Bonuses </h5><br>  In accordance with <a href="http://www.fsb.ru/fsb/supplement/contact/lsz/post957.htm">Government Decree No. 957</a> ‚ÄúOn Approving Regulations on Licensing Certain Types of Activities Related to Encryption (Cryptographic) Means‚Äù in accordance with clause 1 of the provisions on developing encryption tools, MAuth can be freely used in commercial applications. <br><br>  In addition, the use of symmetric encryption gives us the opportunity to get rid of a third party (certification center).  A secure transmission of 5 bytes of information when registering a client is a fairly simple task (you can transfer at a meeting, or by phone). <br><br>  <i>Thank you very much for reviewing the article to Ivan Ruchkin and Dmitry Tilik.</i> <br><br><h5>  UPD from 12/07/2010 </h5><br>  A day after the publication of the MAuth protocol description, it was hacked by the NeverWalkAloner <a href="http://habrahabr.ru/users/neverwalkaloner/" class="user_link">habraiser</a> .  He noticed that after hacking the K'cs session key during T (assuming that the attacker knows the contents of one of the messages), having {K'cs} Kcs on hand, one can get the secret key Kcs by brute force.  As a result, after 2T of the session, the attacker takes control of the control object at his disposal. <br><br><h5>  UPD from 12/10/2010 </h5><br>  How to treat?  Change the handshake mode as follows: <br>  <b>I. C -&gt; S: C</b> <b><br></b>  <b>Ii.</b>  <b>S -&gt; C: {Ns} H (Kcs)</b> <b><br></b>  <b>Iii.</b>  <b>C -&gt; S: {H (Kcs - Ns)} H (Kcs)</b> <br>  where H is a cryptographic hash function (hash size is 40 bits). <br>  All subsequent messages are encrypted with the session key K'cs = H (Kcs + Ns). <br><br>  One more bonus is added to the bonuses: the variable length of the Kcs secret key. <br><br>  Coauthor of the revised version of MAuth: <a href="http://habrahabr.ru/users/neverwalkaloner/" class="user_link">NeverWalkAloner</a> . </div><p>Source: <a href="https://habr.com/ru/post/109403/">https://habr.com/ru/post/109403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../109394/index.html">Flags / proc / cpuinfo for x86 architecture</a></li>
<li><a href="../109395/index.html">UART and what it eats</a></li>
<li><a href="../109396/index.html">Dmitry Sklyarov cracked digital signature in Canon cameras</a></li>
<li><a href="../109398/index.html">The Men Who Stole the World (translation of the article)</a></li>
<li><a href="../109402/index.html">Phylo: an online game that helps genetic research</a></li>
<li><a href="../109404/index.html">Saved to .WWF - saved a tree!</a></li>
<li><a href="../109406/index.html">Algorithm of ghost behavior in the game Pac-Man</a></li>
<li><a href="../109407/index.html">XUI: a simple javascript framework for mobile web application development</a></li>
<li><a href="../109408/index.html">Why are Pinky and Inky acting differently when Pac-Man moves up?</a></li>
<li><a href="../109410/index.html">December 5, 2010 three GLONASS satellites sank</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>