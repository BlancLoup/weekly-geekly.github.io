<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Subtleties of designing the power board of the inverter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! With modest steps, I continue the cycle of articles about the development of iron electric bait. Let's start with the most interesting thing - ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Subtleties of designing the power board of the inverter</h1><div class="post__text post__text-html js-mediator-article">  Hello!  With modest steps, I continue the cycle of articles about the development of iron electric bait.  Let's start with the most interesting thing - the inverter that controls the motor.  I want to tell you more about the intricacies of building a power board and about the temperature regime of transistors. <br><br><img src="https://habrastorage.org/files/45b/d9d/9ac/45bd9d9ac8924ffb98df8b26a515613e.PNG"><br>  <i>Warp core model electric bait</i> <br><a name="habracut"></a><br>  The main problem in designing a board for high high-frequency currents is the inductance of conductors, capacitors, transistors, or rather the resulting emissions due to it and the need to lay a supply of parameters for the keys, which leads to higher design costs and increased switching losses. <br><br>  In the process of work on an inductive load, when the current is broken, voltage surges on the key occur, which are ‚àÜV = -L (dI / dt), where ‚àÜV is the magnitude of the voltage change, L is the inductance, dI / dt is the rate of current change (rise or decrease). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Take the special case of PWM of two phases, where the current initially flows through the closed switch Q2, and then the current builds up in the motor circuit through the upper switch Q1.  The Q6 key for simplicity is always on. <br><img src="https://habrastorage.org/files/5b2/95c/ab8/5b295cab866d446096ca044a23b5bc78.png"><br>  The red direction indicates the path of the initial current flow.  At the moment of switching, the key Q2 opens, but at the same time, the voltage on this key goes to minus by the amount of incidence on the parasitic MOSFET diode.  This is due to the fact that the inductance of the motor, in which energy is stored, tries to "save" its current, and creates a negative voltage.  Next, the Q1 key starts to turn on, the current gradually increases on the inductances L_DC +, L_Q1D, L_Q1S, L_DC.  Where L_QnD is the inductance of the drain of the transistor case, and L_QnS is the inductance of the source, and L_DC is the inductance of the board.  In the process of current transfer from one part of the circuit to another, the transistor Q2 can suddenly detect on itself a voltage greater than that supplied through the power supply bus and installed on the input capacitance. <br><br><img src="https://habrastorage.org/files/558/5ef/9b5/5585ef9b5f97417fac965bf07d530983.png"><br>  <i>An example of switching at a current of 100A</i> <br><br>  The magnitude of this voltage will be proportionally greater than the switching speed.  We do not want to allocate a lot of heat on the keys in the process of switching, so the ideal option is when the key switches instantly, but this is not achievable in reality.  Simply put, the faster this transition occurs, the less active losses will be in the key, but at the same time, the faster the transition occurs, the greater will be the surges in voltages arising at L_DC, L_Q1D, L_Q1S.  Another rarely mentioned, but perhaps the most parasitic phenomenon in this process is the charge of the diode Q2.  Since there is a delay between the switching off of Q2 and turning on Q1, the dead time, the charge recovery charge accumulates on the diode Q2, in the documentation for the transistor is specified as Qrr, measured in nanocolons.  In the process of switching on Q1, a through current arises which restores the parasitic diode Q2.  The magnitude of this current will be higher, the faster it is required to turn on Q1 and the more current passes through the transistor.  This additionally causes a surge voltage on L_Q2D, L_Q2S.  Such a switch is called ‚Äúhard‚Äù from English.  hard commutation. <br><br>  If the transistor was chosen without voltage margin, such a surge could lead to avalanche current (avalanche), which would greatly reduce the life of the transistor, and with long-term exposure it could completely disable it. <br><br><img src="https://habrastorage.org/files/951/826/341/9518263419dc45f3a96c673dac5bbc55.png"><br><br>  In the process of such switching, RF oscillations (‚Äúringing‚Äù, of the order of a pair of MHz) can occur, inductance L_Q (1,2) S and parasitic capacitances between the gates of Q1 / 2 transistors and their drain are involved in their occurrence.  As in the conventional TO220 3pin case, the control signal is actually fed through the power leg, which introduces its own interference.  To solve this problem, a separate pin source for the control signal, which has no power pickup, is displayed in the power assemblies-modules.  At the moment of opening of the transistor Q1, the current starting to flow through the source creates a voltage drop on the inductance of the source-legs of the transistor, which slows down the opening.  In addition, this process is hampered by a sharp voltage drop, which also dampens the gate control signal through the parasitic capacitance.  On the other hand, on the transistor Q2, a sharp rise in the voltage Vds occurs, which pulls the gate to open through the parasitic capacitance between the drain and the gate.  The combination of all these factors leads to the appearance of HF oscillations, the fight against them is usually done by reducing the steepness dI / dt and dVds / dt, but there is an optimum between the opening speed, the opening loss, and the ringing loss of the transistor. <br><br><img src="https://habrastorage.org/files/c2c/8e1/ea1/c2c8e1ea14b846c2982ff66e30ac279e.png"><br>  <i>An example of a "soft" off Q1 with a view from Q2.</i> <br><br>  Negative voltage on Vds (1) - inductance of legs Q2.  At the gate (3) only half of this outlier is visible, since  in this case, in the oscilloscope connection circuit, the current changes only on the source leg. <br><br><h3>  Techniques to combat parasitic inductance </h3><br>  Consider the option of two conductors of the same width, but with a different location on the board. <br><br><img src="https://habrastorage.org/files/68e/4b3/554/68e4b35542014721939d486ec3d4f0c4.png"><br><br>  Suppose we have a track width of 10mm, length 100mm, and the distance between them is 0.5mm.  For option <b>a,</b> mutual inductance will be ~ 6.3 nH.  For option <b>b, the</b> inductance will be ~ 132nH.  What does it mean?  Take the current change rate of 1.25A / nS, as in the screenshot above, following the formula ‚àÜV = -L (dI / dt), we obtain the voltage change for option <b>a</b> ‚àÜV = -6.3 nH * 1.25A / ns = 7.8V.  For option <b>b,</b> this value will be 132nH * 1.25A / ns = 165V.  This is much higher than our supply voltage!  In fact, a breakdown will occur, and the voltage will rest on the voltage limit of the transistor, and the current will flow through it, despite the fact that it is closed.  Therefore, there will be no sense from your good capacitors if they hang on long ‚Äúinductances‚Äù :) <br><br><img src="https://habrastorage.org/files/42e/5fe/772/42e5fe77225a408a9f900faf4d4e21fb.jpg"><br>  <i>What could possibly go <b>this way</b> ?</i> <br><br>  As for the parasitic components of the transistor case, they will not particularly deal with them, the shortest legs to the board, no long wires.  High-frequency ringing well shunts ceramic capacitors, they should be placed directly next to the keys along the power bus, but you can completely get rid of the ringing by eliminating the parasitic diode of the transistor, using SiC transistors or adaptive control, but this is a different price range.  Another option for reducing the inductance of the case are SMD transistors, the so-called.  DirectFet, PowerQFN and the like.  But they also have their drawbacks, they can be attributed to a worse heat sink, the complexity of the layout with SMD installation and, of course, the price. <br><br><h3>  <b>About heat sink</b> </h3><br>  Anyway, the inverter in work will generate heat.  More current - more heat.  Since  in the motor, the current may briefly exceed the average value at the moments of acceleration and deceleration, for transistors it is required to ensure normal thermal conditions for such load peaks.  Standardly for a silicon crystal, the maximum temperature Tj = 175 ¬∞ C is indicated. <br><br><img src="https://habrastorage.org/files/39c/d70/44e/39cd7044e85143f3a725ebb84f8d8b55.png"><br><br>  At the moments of switching transistors there are sharp large emissions of heat - active losses.  Passive losses are losses on the drain-source channel resistance in the open state, are more constant in time and easier to calculate.  For short-term thermal bursts, the copper substrate of the transistor itself acts as a good heat buffer, another minus of the SMD components ‚Äî they are noticeably smaller.  The thermal resistance from the crystal to the case at the transistor chosen by me is 0.57 ¬∞ C / W, which means that by releasing it 50 watts of heat constantly, a temperature gradient of 29 ¬∞ C is formed.  For thermal emissions, it is also required to leave a certain margin and take into account a certain delay on the thermocouple, therefore, the final optimum value of the transistor case was chosen to be 100 ¬∞ C.  The question arises - how long can the maximum current be given before overheating?  Various thermal interfaces have been tested, even boards with an aluminum base.  On the quality of heat transfer from the base of the transistor to the radiator, I would arrange the materials in this order, in descending order of thermal conductivity: <br><br>  <i>Direct contact through thermal grease</i> <i><br></i>  <i>Aluminum nitride substrates + thermal grease (2sl)</i> <i><br></i>  <i>Board with aluminum base</i> <i><br></i>  <i>Aluminum oxide substrates + thermal grease (2sl)</i> <i><br></i>  <i>Silicone flexible supports + thermal grease</i> <i><br></i>  <i>Silicone flexible substrates without thermal paste</i> <br><br>  Direct contact is not our option, as it does not provide electrical insulation of the transistor housing from the radiator.  With a small margin from the aluminum board was a substrate of aluminum oxide.  Nitride was noticeably more expensive and less affordable.  According to the tests between the silicone substrate and the ceramic of aluminum oxide, the difference was almost 2 times; in the duration of the full load, 1 minute and 30 seconds, respectively.  Of course, this test does not pretend to high scientific accuracy, but with a penny price difference, it is twice as long to ‚Äútumble‚Äù on a bike?  The final choice, of course, was ceramics based on aluminum oxide!  As it turned out, mounting is even easier with it, and another bonus is that the transistor is bent much less when the screw is tightened.  The clamp, judging by the trace of the thermal paste, has always been uniform.  What can not be said about the flexible substrate. <br><img src="https://habrastorage.org/files/751/2b8/c6e/7512b8c6e4e04dfea96cf7f433d53fa8.png"><br>  With standard mounting to the radiator through the eye using a screw, the silicone gasket tends to shrink, which can lead to uneven surface contact.  Therefore, the last item is ‚Äúsubstrate without thermal paste‚Äù, since  she, thermal paste, in this case somewhat compensated for this effect.  Of course, in such cases, it is recommended to use a special spring that will evenly press the entire body of the transistor, but we did not have the opportunity to accommodate those to fit into the envelope. <br><br>  Riding a Chinese controller, I often noticed that he had only one side hot, and the other remained cold.  Therefore, the final layout of the power switches was made so as to warm up the entire body as equally as possible.  The keys were installed on both sides, through a small aluminum adapter. <br><br><h3>  <b>Epilogue</b> </h3><br>  In this article, I described the most interesting things in my opinion.  Of course, the choice of the MOS transistor itself according to its characteristics, the calculation of heat losses on the chip and the heating of electrolytic capacitors under the influence of a pulsating current remained behind the scenes.  In the next article we will touch on the device circuitry, current digitization options and the implementation of current protection. </div><p>Source: <a href="https://habr.com/ru/post/399693/">https://habr.com/ru/post/399693/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../399683/index.html">Ten Brightest Stars in the Sky</a></li>
<li><a href="../399685/index.html">ESA and Roskosmos published the first results of scientific observations "ExoMars-2016"</a></li>
<li><a href="../399687/index.html">Android 7.0 Nougat will be available on Sony smartphones in December</a></li>
<li><a href="../399689/index.html">MediaTek Labs invites wearable electronics developers to a free webinar</a></li>
<li><a href="../399691/index.html">If you evaluate a person, the first impression may be the last</a></li>
<li><a href="../399695/index.html">Close contact: what your smartphone is capable of with NFC</a></li>
<li><a href="../399697/index.html">Pain in the hands when working at the computer. Part 4: Integrating past lessons with a round pronator</a></li>
<li><a href="../399701/index.html">OpenAI Universe. Open platform for training strong AI</a></li>
<li><a href="../399707/index.html">Rumor: Fitbit, a manufacturer of smart watches and bracelets, plans to buy its competitor Pebble for $ 40 million</a></li>
<li><a href="../399709/index.html">What kind of disease: acquired immunodeficiency syndrome</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>