<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Touch radio switch on batteries. Livolo + z-uno</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I loved the touch switches! I like their appearance, shiny glass, illuminated buttons, look elegant! 
 Since Since my apartment is automated with Z-Wa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Touch radio switch on batteries. Livolo + z-uno</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4a3/cf5/ca1/4a3cf5ca10744bc4927521822daaa242.jpg"><br>  I loved the touch switches!  I like their appearance, shiny glass, illuminated buttons, look elegant! <br>  Since  Since my apartment is automated with Z-Wave technology, then the touch switches must support this technology.  With the <a href="https://geektimes.ru/company/zwave/blog/274122/">alteration of the push-button radio switch in the touch</a> I handled the last time.  Now I need a remote with batteries in the form of a touch switch, which I can glue onto double-sided tape in the kitchen so that the children can reach it. <br><div class="spoiler">  <b class="spoiler_title">Vitrum Touch Z-Wave Switches</b> <div class="spoiler_text">  If you can afford a switch for 20K ‚ÇΩ, turn your attention to Z-Wave <a href="http://rus.z-wave.me/shop/brand/Vitrum/">Vitrum</a> products <br><img src="https://habrastorage.org/files/f45/c36/0ae/f45c360ae73a425b89d5c59eb02e58f1.jpg"><br></div></div>  If you want your own unique touch switch, and even no more than 4K ‚ÇΩ, welcome under cat. <br><a name="habracut"></a><ol><li>  As a decorative panel, I used the glass from the switch Livolo (Aliexpress - 250‚ÇΩ) <br><img src="https://habrastorage.org/files/c92/b47/fea/c92b47fea594422d9fe70315d74c74df.jpg"></li><li>  Fastening glass Livolo (Aliexpress - 50‚ÇΩ) <br><img src="https://habrastorage.org/files/66c/75e/c7c/66c75ec7c0d0461ebeeda8f3f55a024b.jpg"></li><li>  Z-Wave Z-Uno board (Rus.Z-Wave.Me - 3500‚ÇΩ) <br><img src="https://habrastorage.org/files/42f/d1b/5c7/42fd1b5c7765449eba5cb43a41f38082.jpg"></li><li>  Radio details (Chipdip.ru - 50‚ÇΩ) </li></ol><br>  The brain of the switch is the Z-Wave Z-Uno board.  With the help of LUT, I made a shield of the desired size with two conductive surfaces that act as a touch panel.  To measure the capacitance of the touch surface, the <a href="http://www.seeedstudio.com/depot/datasheet/TTP223_SPEC.pdf">TTP-223</a> chip is used. <br><img src="https://habrastorage.org/files/3ed/663/942/3ed6639425934933acb484dfec914885.jpg"><br><br>  Z-Uno is powered by 4 CR2032 batteries.  With the active radio exchange, the voltage of the batteries quickly subsides and if you continuously press the buttons for 3 minutes, the voltage drops to a critical 2.6V and the Z-Wave chip turns off, the batteries will recover in a minute, but to prevent this from happening, 2 tantalum capacitors are added to the power circuit 47 microfarads each (yellow cubes in the photo).  According to preliminary calculations, the switch will work more than a year from one set of batteries. <br><img src="https://habrastorage.org/files/29e/223/a1f/29e223a1f2c64691adb237e44bb9a54c.jpg"><br><br>  Two touch buttons are connected to pins 0 and 20, and to pin 18 via diodes.  When a low level is applied to pin 18, an interrupt occurs that wakes up Z-Uno and triggers the button poll code.  If the lower button has been triggered, the OFF command is sent, if the upper button is turned ON.  After polling the buttons, we send Z-Uno to sleep, so as not to waste battery power. <br><img src="https://habrastorage.org/files/493/fa2/07e/493fa207e9264b759cd05a952ff0af75.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The sketch is written in the Arduino environment and takes only 45 lines, nothing complicated even for a novice Arduinschik.  You can read about specific Z-Uno functions here <a href="http://z-uno.z-wave.me/reference/">http://z-uno.z-wave.me/reference</a> <br><img src="https://habrastorage.org/files/50b/5c5/bb0/50b5c5bb07324bb581447472f41ea8f6.jpg"><br><div class="spoiler">  <b class="spoiler_title">Z-Uno battery-operated switch sketch</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> BTN_INT_PIN 18 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// INT pin #define BTN_PIN1 0 // button pin #define BTN_PIN2 20 // button pin #define CONTROL_GROUP 1 // number of Association Group #define SWITCH_ON 0xff #define SWITCH_OFF 0 ZUNO_SETUP_ASSOCIATIONS(ZUNO_ASSOCIATION_GROUP_SET_VALUE); // Send Turn On/Off command to associated devices ZUNO_SETUP_SLEEPING_MODE(ZUNO_SLEEPING_MODE_SLEEPING); // SLEEPING MODE byte lastValue1 = HIGH; byte lastValue2 = HIGH; // the setup routine runs once when you press reset: void setup() { pinMode(BTN_PIN1, INPUT_PULLUP); pinMode(BTN_PIN2, INPUT_PULLUP); } // the loop routine runs over and over again forever: void loop() { byte currentValue1 = digitalRead(BTN_PIN1); byte currentValue2 = digitalRead(BTN_PIN2); // Button Down if (currentValue1 != lastValue1) { // if state changes lastValue1 = currentValue1; // save new state if (lastValue1 == LOW) { zunoSendToGroupSetValueCommand(CONTROL_GROUP, SWITCH_OFF); // if button pressed - send switch OFF command } } // Button Up if (currentValue2 != lastValue2) { // if state changes lastValue2 = currentValue2; // save new state if (lastValue2 == LOW) { zunoSendToGroupSetValueCommand(CONTROL_GROUP, SWITCH_ON); // if button pressed - send switch ON command } } // Go to sleep after release the button if (digitalRead(BTN_INT_PIN)){ zunoSendDeviceToSleep(); } }</span></span></span></span></code> </pre> <br></div></div><br>  After assembling the device and filling the sketch, the switch needs to be added to the Z-Wave controller network, I have <a href="https://geektimes.ru/company/zwave/blog/257872/">RaZberry</a> , I want to control the device switches I want to control, I have the light in the kitchen. <br><img src="https://habrastorage.org/files/e00/f0e/c7a/e00f0ec7a36a4cbf8417cdcb11d8a74e.png"><br><br>  Sculpt on double-sided tape in a convenient place and enjoy! <br><img src="https://habrastorage.org/files/a08/f40/57a/a08f4057a2ca42bbb41262403fc17ebc.jpg"><br><br>  Due to the fact that the Z-Uno board has very compact dimensions, namely: 21x40x6 mm, it turned out to be placed entirely inside the Livolo mounting plate and glass.  The thickness of the finished switch with the battery is 12 mm.  Neighboring Legrand sockets with a frame are 13 mm behind the wall.  The switch fits perfectly into the design of my kitchen, and the child learns to turn off the light behind him. <br>  Z-Uno can be purchased for <b>3500‚ÇΩ</b> in the retail store <a href="http://www.5smart.ru/collection/z-waveme/product/z-uno-2">http://5smart.ru</a> or from the manufacturer <a href="http://rus.z-wave.me/shop/adapters/z-uno/">http://rus.z-wave.me</a> <br><br>  UPDATED 08.28.2016 <br>  Fixed circuit design and optimized sketch.  Tested on Z-Uno version 2.0.5. <br><br>  UPDATED 08/30/2016 <br>  2 tantalum power capacitors are added to the circuit. <br><br>  UPDATED 02.10.2016 <br>  Practice has shown that a single CR2032 battery is not enough, so now 4 CR2032 batteries are used.  Made on the 3D printer case, where the battery compartments are located and conveniently mounted to the wall. <br><img src="https://habrastorage.org/files/c1f/bb3/348/c1fbb3348c7841439712e6118d54b168.JPG"><br><img src="https://habrastorage.org/files/6e2/66b/89c/6e266b89c63e47379cfc4a8b5d1afdc9.JPG"><br><img src="https://habrastorage.org/files/24b/b7d/774/24bb7d774f224c0593e3e0cd8d534408.JPG"><br><img src="https://habrastorage.org/files/1b6/bd8/a3e/1b6bd8a3e7194142b0c6010faee94124.JPG"><br><img src="https://habrastorage.org/files/b86/814/8c9/b868148c99694207b0e66b49f5d0ec19.JPG"></div><p>Source: <a href="https://habr.com/ru/post/372041/">https://habr.com/ru/post/372041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../372031/index.html">Scientists have found that vegetarianism is fixed in the genes</a></li>
<li><a href="../372033/index.html">Kingston Introduces Memory Card for Industry and Extreme Conditions</a></li>
<li><a href="../372035/index.html">RoboAir - the world's first lawn mower robot rental service</a></li>
<li><a href="../372037/index.html">German court defended the right to use Adblock Plus for the fifth time</a></li>
<li><a href="../372039/index.html">Video review laptop MSI GT72S 6QF Dragon Edition</a></li>
<li><a href="../372043/index.html">Vertical micro-farms with fresh greens appeared in Berlin stores</a></li>
<li><a href="../372045/index.html">VR Sex: what was before Pornhub</a></li>
<li><a href="../372047/index.html">Dangerous mind safe intelligence</a></li>
<li><a href="../372049/index.html">Smart watch or smart bracelet? Weigh the pros and cons of the example of Xiaomi and LG</a></li>
<li><a href="../372051/index.html">Rutracker returns: first official "mirror" launched</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>