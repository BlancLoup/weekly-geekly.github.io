<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Working environment for "lazy" web developers (Vagrant + Scotchbox)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. In this article I will describe one of the simplest options, how to quickly raise a full-fledged work environment under the virtual machine, re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Working environment for "lazy" web developers (Vagrant + Scotchbox)</h1><div class="post__text post__text-html js-mediator-article">  Hello.  In this article I will describe one of the simplest options, how to quickly raise a full-fledged work environment under the virtual machine, ready to work and further expand. <br>  ‚Äú <a href="http://www.vagrantup.com/downloads.html">Vagrant</a> ‚Äù (for managing virtualization) and ‚Äú <a href="http://box.scotch.io/">Scotchbox</a> ‚Äù (box for Vagrant - an image with ubuntu and pre-installed software, prepared by the guys from scotch.io) are at the forefront. <br><br>  First of all, the publication is designed for those who customize their working environment under Windows, heard about Vagrant, but so far have not tried it in combat.  I hope this simple example will help save some time when you get acquainted with Vagrant-based virtualization. <br><br><img src="https://habrastorage.org/files/178/ff8/465/178ff8465be94c97a091e964d706a345.png"><br><a name="habracut"></a><br>  Out of the box on board ‚ÄúScotchbox‚Äù there is Apache, PHP, MySQL, NPM, Git, Grunt, Gulp, Bower, Yeoman, Ruby, Memcached, Composer and other web developer tools, if you miss something, you can easily install it yourself. and then create your own image. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The link <a href="https://box.scotch.io/">https://box.scotch.io</a> provides detailed instructions for installing and running a virtual machine with the Scotchbox environment, as well as a list of what will be installed.  This could be the end - they say, see the instructions, but we will automate the creation of virtual hosts for apache (by expanding the Vagrant configuration) and I will briefly describe what is happening there. <br><br>  For convenience, I created a <a href="https://github.com/WebDevArchive/webdev-env">repository</a> with an example of the vagrant configuration, which we will use. <br><br><h4>  <b>So, the sequence of actions:</b> </h4><br><ol><li>  Install ‚Äú <a href="https://www.vagrantup.com/downloads.html">Vagrant</a> ‚Äù and ‚Äú <a href="https://www.virtualbox.org/wiki/Downloads">Virtual Box</a> ‚Äù if they are not already installed. </li><li>  Clone the repository: <br><pre><code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/WebDevArchive/webdev-env.git</code> </pre>  (or download the <a href="">archive</a> and unzip it manually if you are on a clean machine without git) </li><li>  Go to the ‚Äúwebdev-env‚Äù folder where ‚ÄúVagrantfile‚Äù is located and execute the command: <br><pre> <code class="bash hljs">vagrant up</code> </pre></li></ol><br><br>  The first launch can take a lot of time - the image will be downloaded, on subsequent launches this step will not be, the image will cling from the cache.  Next, start the virtual machine. <br><br>  Having waited for its loading, we will write a line in the hosts file (in windows) <pre> <code class="hljs css">192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">webdev</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.local</span></span></code> </pre>  and go to the local address <a href="http://webdev.local/">http: //webdev.local</a> <br>  If everything went as expected, then we will see a page with the text ‚Äúwebdev.local‚Äù loaded from our virtual machine and we can immediately proceed directly to the development. <br><br><h5>  <b>Consider the example of adding your host using the example of ‚Äúhabrahabr.ru‚Äù.</b> </h5><br><ol><li>  In the folder ‚Äúwww‚Äù we create the folder ‚Äúhabrahabr.ru‚Äù and in it the file ‚Äúindex.html‚Äù with any content. </li><li>  In the folder "www" create the file "habrahabr.ru.conf" with the following contents: <br><pre> <code class="hljs pgsql">&lt;VirtualHost *:<span class="hljs-number"><span class="hljs-number">80</span></span>&gt; ServerAdmin webmaster@localhost ServerName habrahabr.ru ServerAlias www.habrahabr.ru DocumentRoot /var/www/habrahabr.ru ErrorLog ${APACHE_LOG_DIR}/error.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> CustomLog ${APACHE_LOG_DIR}/<span class="hljs-keyword"><span class="hljs-keyword">access</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> combined &lt;/VirtualHost&gt;</code> </pre><br></li><li>  In the file "hosts" in windows add <pre> <code class="hljs css">192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">habrahabr</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ru</span></span></code> </pre> </li><li>  Restart the virtual machine: <pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vagrant</span></span> destroy vagrant up</code> </pre><br></li><li>  Now when switching to <a href="http://habrahabr.ru/">http://habrahabr.ru</a> , the site will be loaded from our host on a virtual machine. </li></ol><br><br><h4>  <b>Let's run through the configuration (Vagrantfile)</b> </h4><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">config</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.vm</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.network</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">private_network</span></span>", <span class="hljs-selector-tag"><span class="hljs-selector-tag">ip</span></span>: "192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.33</span></span>"</code> </pre>  Here we set the internal IP for our virtual machine to 192.168.33.33 <br>  At this address we can connect via SSH, the default username and password is <b>vagrant</b> <br><br><pre> <code class="hljs javascript">config.vm.synced_folder <span class="hljs-string"><span class="hljs-string">"www"</span></span>, <span class="hljs-string"><span class="hljs-string">"/var/www"</span></span>, :<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mount_options</span></span></span><span class="hljs-function"> =&gt;</span></span> [<span class="hljs-string"><span class="hljs-string">"dmode=777"</span></span>,<span class="hljs-string"><span class="hljs-string">"fmode=666"</span></span>]</code> </pre>  Synchronization of the working directory ‚Äú <b>www</b> ‚Äù in windows and ‚Äú <b>/ var / www</b> ‚Äù in ubuntu (with access rights set). <br>  Synchronization implies the ability to access files in the ‚Äúwww‚Äù folder, both from the main OS and from the guest OS.  Those.  shared file share - for example, we can edit files in any convenient editor or IDE under windows, and these changes will be available for building the project under the virtual machine. <br>  Thus, the code and structure of the project are separated from the virtual machine itself and will be forwarded there every time it is launched. <br><br>  Here it is worth noting that there are some problems when using watch'erov (for example, when using gulp) - the event does not trigger the project reassembly when changing the contents of files, if these changes were not made from the same OS in which watch was launched Ery. <br>  Since  I work with a ‚Äúwebpack‚Äù which has a ‚Äúpoll‚Äù (i.e. a change poll), then it doesn't bother me much, but if someone knows how to solve this moment, I will be happy to read in the comments and add to publication. <br><br><pre> <code class="hljs lua"><span class="hljs-built_in"><span class="hljs-built_in">config</span></span>.vm.network <span class="hljs-string"><span class="hljs-string">"forwarded_port"</span></span>, guest: <span class="hljs-number"><span class="hljs-number">8008</span></span>, host: <span class="hljs-number"><span class="hljs-number">8008</span></span></code> </pre>  This is how port forwarding is done (using the example of port 8008 ‚Äî I use it for webpack-dev-server, which I plan to write about in the future). <br><br><pre> <code class="hljs lua"><span class="hljs-built_in"><span class="hljs-built_in">config</span></span>.vm.provision <span class="hljs-string"><span class="hljs-string">"shell"</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: <span class="hljs-string"><span class="hljs-string">"vm.provision.sh"</span></span></code> </pre> <br>  Execute commands from the vm.provision.sh file immediately after booting the virtual machine. <br>  Everything is simple there - we add / register hosts, install mc and do any other actions we need: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      ¬´www¬ª: for vhFile in /var/www/*.conf do #           apache sudo cp /var/www/*.conf /etc/apache2/sites-available/ -R vhConf=${vhFile##*/} #   sudo a2ensite ${vhConf} vhost=${vhConf%.*} #    /etc/hosts sudo sed -i "2i${vmip} ${vhost}" /etc/hosts done #     apache sudo chmod -R 755 /var/www sudo service apache2 restart #  mc: sudo apt-get --assume-yes install mc #    node/npm: sudo npm cache clean -f sudo npm install -gn sudo n stable</span></span></code> </pre><br><br><h5>  <b>Creating your own image</b> </h5><br>  In order to save your box (for example, if you have installed and configured a lot of software and want to fix the state), you need to run the command: <br><br><pre> <code class="hljs cs">vagrant package --<span class="hljs-keyword"><span class="hljs-keyword">base</span></span> my-<span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span>-machine</code> </pre><br>  Convenient to no longer bother with the setting or when there is a need to transfer to other developers a specific working environment for your project. <br><br>  Here, in fact, in brief all the main and stated. <br><br>  Play with the configuration, learn the more subtle features of Vagrant. <br><br>  Good design! </div><p>Source: <a href="https://habr.com/ru/post/262395/">https://habr.com/ru/post/262395/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262381/index.html">AOP or how to write your bike for analytics</a></li>
<li><a href="../262383/index.html">Manage ReSharper settings in the team</a></li>
<li><a href="../262387/index.html">Databene Benerator - Benefit from it.</a></li>
<li><a href="../262389/index.html">Accelerate angular.js or how not to shoot yourself in the foot</a></li>
<li><a href="../262393/index.html">Video Switch for TV</a></li>
<li><a href="../262397/index.html">Your cloud hosting in 5 minutes. Part 2: Service Discovery</a></li>
<li><a href="../262401/index.html">PHP Digest number 66 - interesting news, materials and tools (June 28 - July 12, 2015)</a></li>
<li><a href="../262403/index.html">40+ useful tools for the developer of applications for Android</a></li>
<li><a href="../262407/index.html">Entity Framework 6 (7) vs NHibernate 4: a DDD perspective</a></li>
<li><a href="../262409/index.html">Introduction to Octopus Deploy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>