<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solitaire sorting</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the comments to the previous articles, occasionally there are reproaches - why bother to study any other sorting at all, if you already have the fa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solitaire sorting</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img width="700" height="420" src="https://habrastorage.org/webt/mz/at/0f/mzat0flvov5qixshl-awj9xffne.jpeg"></div><br><a name="habracut"></a><br>  In the comments to the previous articles, occasionally there are reproaches - why bother to study any other sorting at all, if you already have the fastest Quick sort in the world.  Mol-de, all this pretentious exotic has no use and no one needs. <br><br><img width="330" height="185" align="right" src="https://habrastorage.org/webt/ep/x5/pz/epx5pzwetbrzejtl0oukkvduozm.jpeg"><br clear="left">  <a href="https://en.wikipedia.org/wiki/Persi_Diaconis">Percy Diaconis</a> , who has studied solitaire sorting along and across, believes that it is the fastest way to manually organize a deck of cards. <br><br>  So, if a respected mathematician (and an experienced card magician) does not lie, then the practical value of the algorithm is all right. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now watch your hands. <br><br><h1>  Stage 1. Spoon in stacks. </h1><br><br>  So, take the worms from the deck.  They will represent an array of thirteen random elements. <br><br><img src="https://habrastorage.org/webt/j_/ik/zg/j_ikzgnokw8bkhj9_frik-mai_e.png"><br><br>  We need to decompose the cards in several piles so that in each pile the cards are an ordered sequence. <br><br>  In other words, our task at this stage is to quickly create several ordered sub-arrays from an existing unsorted array.  At the same time, it is highly desirable that the number of these subarrays be smaller, which means that we should strive to ensure that the subarrays are more authentic.  This is done as follows. <br><br>  The first card is the start of the first pile. <br><br><img src="https://habrastorage.org/webt/d9/sp/bn/d9spbncxz30rhzxqrzfvywhhm6k.png"><br><br>  In this pile, we shift the cards one by one, until the next card being transferred is smaller than the top one in the pile. <br><br>  In addition, each stack is a stack - we do not work with the whole stack, but only with the top card in it, which we put last. <br><br><img src="https://habrastorage.org/webt/gf/gd/q-/gfgdq-oqzknwkou2dbcncafersa.png"><br><br>  If the current card is more than the minimum in the stack, then you have to create a new handful, the current card opens a new stack. <br><br><img src="https://habrastorage.org/webt/ab/97/z3/ab97z3z2dfaobk9tqveawpybhis.png"><br><br>  Stack sequence is important!  If their number is already more than one, then we place the next card not in the last pile, but in the leftmost pile in which we can put. <br><br>  Right now, after the lady, you need to attach a nine somewhere.  Mechanically, I want to put the card in the second pile, but in the first pile the top card is greater than nine.  So, we can continue the first pile, without violating its orderliness.  The next three, which comes after the nine, is also incidentally sent to the first pile. <br><br><img src="https://habrastorage.org/webt/-4/ww/it/-4wwit3yrqc3gjywezucwhyh9lo.png"><br><br>  Seven and six cannot be added to the first pile (they are larger than the top card in it), but they still have a place in the second pile. <br><br><img src="https://habrastorage.org/webt/zp/su/yc/zpsuycgew4jezzv44p3axcytg_i.png"><br><br>  Ace starts a new stack.  The remaining fines fall into different trays, depending on how far to the left was the stack, where you could insert. <br><br><img src="https://habrastorage.org/webt/uw/qw/r6/uwqwr6gzjdpdyogbzcts-whxoae.png"><br><br>  As a result, the cards are spread out in several piles.  In each pile of cards are a decreasing sequence, at the top - the smallest card.  Stacks are stacks. <br><br>  Since we tried first to fill those piles that were to the left, we have the smallest possible quantity.  If we just walked through the array and extracted diminishing subarrays from it, then heaps, naturally, will get much more. <br><br><img src="https://habrastorage.org/webt/yb/wi/op/ybwiopvdmkgw_xhzswumhhpsy-c.png"><br><br><h1>  Stage 2. Bottom row </h1><br><br>  Shift the available top cards down a bit so that they stand in a separate row.  If the stacks are stacks, then we will work with the bottom row as with a queue. <br><br><img src="https://habrastorage.org/webt/-p/wo/sl/-pwosl95hk_iiqivtdkoypbk0oc.png"><br><br>  What is important - the available top cards in the stacks are also an ordered sequence.  The bottom row is already sorted in ascending order.  No wonder - when forming stacks of cards, smaller ones were sent as far as possible to the left. <br><br>  In the future, until the end of the sorting, we are not interested in all the cards that are laid out on the table.  Only these are needed: <br><br><ul><li>  The leftmost card (let's call it current) in the bottom row queue. </li><li>  In stacks of stacks we work only with the top available cards.  In this case, only those piles that are directly on the current map and to the left are needed.  Stacks that are to the right at this moment are not needed. </li></ul><br><br>  In the bottom row we go over cards from left to right cards.  The left most is the current minimum, we return it to the original top row.  At the same time, each time we return another card to the base, it is necessary to put another one in its place.  Where to get it from?  Of those stacks that are above the current card and to the left of it - among the available cards, the minimum is selected, which moves to the vacant position of the current left card in the bottom row, and from there to the main array. <br><br>  Two in the array is returned immediately.  The vacant space is occupied by a triple (we move it from the first stack to the bottom row), and from the bottom row the troika as the current minimum goes to the main array.  In the first two piles, the minimum is searched again - this is the four - which also goes home.  The current minimum is five, etc. <br><br><img src="https://habrastorage.org/webt/gi/ej/3x/giej3x5chmm4aggloxtewxvutem.png"><br><br>  By combining work with an ordered queue in ascending order and stacks arranged in descending order, we very quickly get all the elements from minimum to maximum.  Something like that, in general. <br><br>  Animation of this process. <br><br><img src="https://habrastorage.org/webt/gh/ks/gj/ghksgjmfx72fmeugocim2gnvmsm.gif"><br><br>  If all of the above translate into Python, then you get this: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> functools <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> total_ordering <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> bisect <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> bisect_left <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> heapq <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> merge @total_ordering <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(list)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__lt__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, other)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self[<span class="hljs-number"><span class="hljs-number">-1</span></span>] &lt; other[<span class="hljs-number"><span class="hljs-number">-1</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__eq__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, other)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self[<span class="hljs-number"><span class="hljs-number">-1</span></span>] == other[<span class="hljs-number"><span class="hljs-number">-1</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">patience_sort</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> piles = [] <span class="hljs-comment"><span class="hljs-comment"># sort into piles for x in n: new_pile = Pile([x]) i = bisect_left(piles, new_pile) if i != len(piles): piles[i].append(x) else: piles.append(new_pile) # use a heap-based merge to merge piles efficiently n[:] = merge(*[reversed(pile) for pile in piles])</span></span></code> </pre> <br><br><h2>  Links </h2><br> <a href="https://en.wikipedia.org/wiki/Patience_sorting"><img width="30" height="30" src="https://habrastorage.org/webt/3y/wq/mh/3ywqmhuo7fv68jggkc416kbzuw4.png"></a>  <a href="https://en.wikipedia.org/wiki/Patience_sorting">Patience sorting</a> ( <a href="https%253A%252F%252Fen.wikipedia.org%252Fwiki%252FPatience_sorting%26edit-text%3D%26act%3Durl">Google-translate</a> ) <br><br> <a href="https://rosettacode.org/wiki/Sorting_algorithms/Patience_sort"><img width="30" height="30" src="https://habrastorage.org/webt/m8/db/1t/m8db1tyvn-pmm4ugyopcyiv7k4i.png"></a>  <a href="https://rosettacode.org/wiki/Sorting_algorithms/Patience_sort">Patience sorting source</a> <br><br> <a href="https://www.cs.princeton.edu/courses/archive/spring13/cos423/lectures/LongestIncreasingSubsequence.pdf"><img width="84" height="30" src="https://habrastorage.org/webt/yv/lm/2t/yvlm2t2kl5affkpm0hzqh7qw5ly.png"></a>  <a href="https://www.cs.princeton.edu/courses/archive/spring13/cos423/lectures/LongestIncreasingSubsequence.pdf">Princeton CS: Longest increasing subsequence</a> <br><br> <a href="http://www.emis.ams.org/journals/SLC/wpapers/s54Aburlank.pdf"><img width="84" height="30" src="https://habrastorage.org/webt/yv/lm/2t/yvlm2t2kl5affkpm0hzqh7qw5ly.png"></a>  <a href="http://www.emis.ams.org/journals/SLC/wpapers/s54Aburlank.pdf">Combinatorics of patience sorting piles</a> ( <a href="http%253A%252F%252Fwww.emis.ams.org%252Fjournals%252FSLC%252Fwpapers%252Fs54Aburlank.pdf%26edit-text%3D%26act%3Durl">Google-translate</a> ) <br><br>  <a href="https://neerc.ifmo.ru/wiki/index.php%3Ftitle%3D%25D0%25A2%25D0%25B5%25D1%2580%25D0%25BF%25D0%25B5%25D0%25BB%25D0%25B8%25D0%25B2%25D0%25B0%25D1%258F_%25D1%2581%25D0%25BE%25D1%2580%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0">Wiki notes: patient sorting</a> <br><br>  <a href="http://wordaligned.org/articles/patience-sort.html">Word Aligned</a> ( <a href="http%253A%252F%252Fwordaligned.org%252Farticles%252Fpatience-sort.html%26edit-text%3D%26act%3Durl">Google-translate</a> ) <br><br><h3>  Articles series: </h3><br><ul><li>  <a href="https://habr.com/post/414447/">Excel application AlgoLab.xlsm</a> </li><li>  <a href="https://habr.com/post/414653/">Exchange sorting</a> </li><li>  <a href="https://habr.com/post/415935/">Sorting inserts</a> <ul><li>  <a href="https://habr.com/post/416653/">Librarian sort</a> </li><li>  <b>Solitaire sorting</b> </li><li>  <a href="https://habr.com/post/431694/">Sort "Tower of Hanoi"</a> </li><li>  Sort by Young table </li><li>  Inversion Sort </li><li>  Comparing sorting inserts </li></ul></li><li>  <a href="https://habr.com/post/422085/">Sort by selection</a> </li><li>  <a href="https://habr.com/post/431964/">Merge sort</a> </li></ul><br><br>  In the AlgoLab application, this sorting is now active.  At the same time, visualization is possible in two modes: in the form of maps (the default mode) and simply in the form of numbers.  However, for the card style, it is necessary that the difference between the maximum and minimum elements in the array be less than 54 (the number of cards in the deck, including two jokers).  If this condition is not fulfilled or the card mode is turned off altogether (for this, card = 0 must be entered in the comment to the cell with the sort name), then the visualization will be in the form of dull digits. <br><br><img width="646" height="259" src="https://habrastorage.org/webt/n3/pi/1f/n3pi1fc-7itlw2fecr4tyoqzw7e.gif"><br><br>  Suits are considered in order of preference seniority: <nobr>peaks &lt;clubs &lt;diamonds &lt;hearts.</nobr> <br><div style="text-align:center;"><img width="690" height="150" src="https://habrastorage.org/webt/jn/ih/9w/jnih9wxmqom6d1yo_hukglkzwc0.png"></div><br>  That is, <i>any</i> diamonds suit card is more than <i>any</i> club suit card, <i>any</i> heart suit card is greater than <i>any</i> peak suit card, etc.  If we draw an analogy with numbers, the peaks are from 0 to 9, clubs are from 10 to 19, diamonds are from 20 to 29, hearts are from 30 to 39 (yes, of course, inside the suit the number of cards is not exactly ten, but you understand what I mean).  As for the seniority <i>inside the suit</i> , it will be normal: from two to ace.  You can even take jokers that are older than all the other cards.  At the same time, the red joker is more powerful than black. <br><br><blockquote> <a href="https://www.edsd.com/" title="EDISON Software - web-development"><img align="left" width="153" height="75" src="https://habrastorage.org/webt/w0/zl/to/w0zltoxvysbr0yeinstkfvw1wbg.png" alt="EDISON Software - web-development"></a> <br clear="right">  The article was written with the support of EDISON Software, which is professionally engaged <a href="https://www.edsd.com/portfolio/software-development">in web development</a> and recently <a href="https://www.edsd.com/">redesigned its website.</a> </blockquote></div><p>Source: <a href="https://habr.com/ru/post/431094/">https://habr.com/ru/post/431094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431084/index.html">In any incomprehensible situation - write scripts</a></li>
<li><a href="../431086/index.html">Everything you wanted to know about PVS-Studio and did not hesitate to ask</a></li>
<li><a href="../431088/index.html">File management done wrong - Part 1: Hailing from the 90s</a></li>
<li><a href="../431090/index.html">One VC bot, one C # and an orange</a></li>
<li><a href="../431092/index.html">ROS: Map of the depths on the Raspberry Pi "little blood"</a></li>
<li><a href="../431096/index.html">How to build a chat bot product</a></li>
<li><a href="../431098/index.html">Even a fire is not an obstacle, or Zimbra speed recovery after a disaster</a></li>
<li><a href="../431102/index.html">How the physical address is displayed in rows and banks DRAM</a></li>
<li><a href="../431104/index.html">How we at Neoflex develop the expertise of DevOps</a></li>
<li><a href="../431106/index.html">How much money did Americans spend on this Black Friday, and what does smartphones mean?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>