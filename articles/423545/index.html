<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Artificial intelligence in the network security service. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 2. Part 1 by reference. 
 
 In our case, the Introspect behavior analytics system from the User and Entity Behavior Analytics product class (UEBA...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Artificial intelligence in the network security service. Part 2</h1><div class="post__text post__text-html js-mediator-article">  Part 2. <a href="https://habr.com/company/hpe/blog/423537/">Part 1 by reference.</a> <a href="https://habr.com/company/hpe/blog/423537/"><br></a> <br>  In our case, the Introspect behavior analytics system from the User and Entity Behavior Analytics product class (UEBA for short) is a single entry point for a large amount of various machine information collected from the existing infrastructure, including from SIEM systems, and on the basis of machine analytics algorithms and artificial intelligence to help security staff automate the routine work of analyzing a large number of incidents. <br><br>  Moreover, the system can be integrated with existing infrastructure access control systems (NAC) to perform various actions with sources of abnormal behavior in the network ‚Äî turn off, slow down, move to another VLAN, etc. <br><br><img src="https://habrastorage.org/webt/me/my/sl/memyslw3le6boig3iqlug8subge.jpeg"><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What kind of data should Introspect receive as baseline information?  The most diverse, up to network traffic.  For this purpose, the system has specialized components for processing traffic - Packet Processor (PP). <br><br>  The advantage of receiving data from SIEM systems can be the fact that they have already passed preliminary analysis (parsing) by these systems.  Introspect works with such SIEM systems as SPLUNK, QRadar, ArcSight.  The next step is the implementation of LogRhythm (raw syslog), Intel Nitro.  In addition, the system collects a huge array of data: <br><br>  MS Active Directory (AD Security Logs, AD user, group, group user), MS LDAP logs, <br>  <b>DHCP logs</b> <br>  MS DHCP, Infoblox DHCP, dnsmasq DHCP <br>  <b>DNS logs</b> <br>  MS DNS, Infoblox DNS, BIND <br>  <b>Firewall logs</b> <br>  Cisco ASA (syslog), Fortinet (via SPLUNK), Palo Alto (via SPLUNK), Checkpoint (via SPLUNK), Juniper (via SPLUNK). <br>  <b>Proxy logs</b> <br>  Bluecoat, McAfee, ForcePoint <br>  Alert <br>  Fireeye <br>  MS ATA <br>  <b>VPN logs</b> <br>  Cisco Anyconnect / WebVPN <br>  Juniper VPN (via SPLUNK) <br>  Juniper Pulse Secure (via SPLUNK) <br>  Fortinet VPN (via SPLUNK) <br>  Checkpoint VPN <br>  Palo alto vpn <br>  <b>Flow logs</b> <br>  Netflow v5, v7, v9 <br>  <b>Email logs</b> <br>  Ironport ESA <br>  Bro logs <br>  Connection logs <br><cut></cut><br>  The competitive advantage of the system is the ability to work at the transaction level, i.e.  with network traffic that complements the information received in the log messages.  This gives the system additional analytical capabilities ‚Äî analyzing DNS queries, tunnel traffic, and efficiently searching for attempts to transfer sensitive data outside the organization‚Äôs perimeter.  In addition, the system provides analytics of packet entropy, analysis of HTTPS headers and files, as well as analysis of the work of cloud applications. <br><br>  The above-mentioned packet processors (PP) have a virtual and hardware implementation, operate at speeds up to 5-6 Gbps and perform DPI ‚Äúraw‚Äù data, extract context information or packet metadata from it and transfer it to another component of the system - the analyzer. <br><cut></cut><br>  If analysis decisions are made not only for logs, but also for traffic using SPAN / TAP methods or using a package broker or repeaters, such as Gigamon or Ixia, PP should be located in the right place on the network.  For maximum efficiency, it is necessary to capture all network traffic going in each user VLAN to / from the Internet, as well as traffic going from / to users to protected resources or servers containing critical information. <br><br>  A necessary and key component of the system is the Analyzer.  It processes data from logs, flows, packet metadata, alerts from third-party systems, threat intelligence feeds and other sources. <br><br>  An analyzer can be a single 2RU appliance or a horizontally scalable scale-out solution consisting of a set of 1RU appliance as well as a cloud solution. <br><br>  <b>Logical structure</b> <br><br>  Logically, the Analyzer is a horizontally scalable Hadoop platform consisting of several types of nodes - Edge Nodes, Index and Search nodes, Hadoop data nodes. <br>  Edge Nodes receive data and record to Flume channels with HDFS receivers. <br><br>  Index and Search nodes extract information from three types of bases - Hbase, Parquet, ElasticSearch. <br>  Hadoop data nodes are intended for data storage. <br><br>  Logically, the system works as follows - packet metadata, flows, logs, alerts, threat feeds are parsed, cached, distilled, correlated.  The system performs a link between the user and his data, caching fast-moving user data in HDFS. <br><br>  Then the data goes to the discrete analytics module, where, based on the received information on any fixed event or field, the so-called discrete alarms are sifted out.  For example, the operation of the DNS DGA algorithm or an attempt to log into a blocked account does not obviously require any computer analytics to detect a potentially dangerous event.  The behavior analytics module is connected at this stage only for reading potential events on the network. <br><br>  The next step is the correlation of events, indexing and storage in the above mentioned bases.  The behavior mechanism of analytics is enabled based on the stored information and can work on the basis of certain periods of time or on the basis of the behavior of this user in comparison with another user.  This is the so-called baselining mechanism of behavior profiling.  Models of behavior profiling are built on the basis of machine analytics algorithms SVD, RBM, BayesNet, K-means, Decision tree. <br><br>  The integrated model of the behavior of the analytics product is shown in Figure 1. <br><br><img src="https://habrastorage.org/webt/u1/hp/3m/u1hp3mbjjbtsa6xycyubexgzbao.jpeg"><br>  <i>Pic1</i> <br><br>  The diagram shows that the behavior analytics mechanism is based on four blocks: <br><br><ul><li>  data sources; </li><li>  conditions of work with data (access time, the amount of downloaded or downloaded data, the number of e-mail messages, information about the geolocation of the source or receiver of information, VPN connection, etc.); </li><li>  mechanisms for profiling user behavior (evaluation of behavior after some time or in relation to another employee, time window during which the analysis is performed, mathematical model of behavior profiling - SVD, Restricted Boltzmann Machine (RBM), BayesNet, K-means, Decision tree and others); </li><li>  detection of anomalies in traffic using mathematical models of machine analytics, such as mahalanobis distance, energy distance and the generation of events in the system with a certain priority and stage. </li></ul><br>  Aruba Introspect has more than 100 supervised and unsupervised models designed to detect targeted attacks at each stage of the CKC model.  For example, the implementation of the Introspect Advanced level detects <br><br><ul><li>  Suspicious network activity types: Abnormal Asset Access, Abnormal Data Usage, Abnormal Network Access, Adware Communication, Bitcoin Application in the form of Bitcoin Mining, Botnet (TeslaCrypt, CryptoWall), Cloud Exfiltration, HTTP Protocol Anomaly (Header Misspellings, Header Misordering), Hacker tool Download, IOC attack types (IOC-STIX Abuse-ch, IOC-STIX CybercrimeTracker, IOC-STIX EmergingThreatsRules and others), Network Scan, P2P Application, Remote Command Execution, SSL Protocol Violation, Spyware Comm, Suspicious Data Usage, Suspicious External Access , Suspicious File, Suspicious Outbound Comm, WebShell, Malware communication, Command and Control, Lateral movement, Data Exfiltration, Browser exploit, Beaconing, SMB execution, Protocol violation, Internal Reconnaissance and more. </li><li>  Suspicious access to accounts such as Abnormal Account Activity, Abnormal Asset Access, Abnormal Logon, Privilege Escalation, Suspicious Account Activity, Suspicious User Logon and others </li><li>  Data access via VPN: Abnormal Data Usage, Abnormal Logon, Abnormal User Logon, </li><li>  DNS data analysis: Botnet work through various DNS DGA algorithms </li><li>  Email Analysis: Abnormal Incoming Email, Abnormal Outgoing Email, Suspicious Attachment, Suspicious Email </li></ul><br>  Further, on the basis of the identified anomalies, an event is assigned a risk assessment associated with a particular stage of hacking the system, as determined by Lockheed Martin's Cyber ‚Äã‚ÄãKill Chain (CKC).  Risk assessment is determined by the Hidden Markov Model, unlike competitors, which linearly increase or decrease the risk assessment in their calculations. <br><br>  As the attack develops on the CKC model, i.e.  stages of infection, internal reconnaissance, command &amp; control, privilege escalation, lateral movement, exfiltration, risk assessment increases.  See fig.2 <br><br><img src="https://habrastorage.org/webt/1x/j4/_o/1xj4_oqnwa0yweb--gynbzoq2jk.jpeg"><br>  <i>Pic2</i> <br><br>  The system has the functions of adaptive learning, when the results of the analytics module are subject to revision or adaptation, in assessing risk scoring or when placed on a white list. <br><br>  Information about threats or Threat Feeds can be downloaded from external sources, using the mechanisms of STIX, TAXII.  Anomali resource is also supported.  Introspect can also download ‚ÄúWhitelist‚Äù domain names from the Alexa service to reduce false positives in the generation of alerts. <br><br>  The competitive advantages of the system are: <br><br><ul><li>  a variety of input data used, </li><li>  DPI function, </li><li>  correlation of security events with the user, not the IP address, without additional software, </li><li>  Using Hadoop / Spark big data as the basis of the system with unlimited clustering capabilities </li><li>  the results of the system, obtained on the basis of analytics, the ability to investigate incidents using full-context forensics, threat hunting, </li><li>  integration with the existing NAC Clearpass solution, </li><li>  work without an agent at Endpoint, </li><li>  practical independence from the type of network infrastructure manufacturer </li><li>  On-premise work, without having to send data to the cloud </li></ul><br>  The system has two delivery options - Standard Edition and Advanced Edition.  The Standard Edition is adapted for Aruba Network equipment and receives log information from AD, AMON, LDAP, Firewall, VPN logs. </div><p>Source: <a href="https://habr.com/ru/post/423545/">https://habr.com/ru/post/423545/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423535/index.html">Why should trash can access the Internet</a></li>
<li><a href="../423537/index.html">Artificial intelligence in the service of network security. Part 1</a></li>
<li><a href="../423539/index.html">The digest of fresh materials from the world of the frontend for the last two weeks ‚Ññ330 (September 3 - 16, 2018)</a></li>
<li><a href="../423541/index.html">Kodi addons are used to distribute crypto miners</a></li>
<li><a href="../423543/index.html">Obtaining a morphic 3D face model based on a photo from an arbitrary perspective</a></li>
<li><a href="../423547/index.html">How to make big changes on the backend: reports from speakers from Wrike, Yandex.Money and Nexign</a></li>
<li><a href="../423549/index.html">Digital events in Moscow from September 17 to September 23</a></li>
<li><a href="../423551/index.html">TREND conference overview</a></li>
<li><a href="../423553/index.html">New in Spring 5. Project migration to Spring 5</a></li>
<li><a href="../423555/index.html">About motivation with the prefix "Super"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>