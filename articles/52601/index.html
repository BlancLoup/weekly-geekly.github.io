<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dances with a tambourine, part 2 - tabbed menu in Drupal</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Actually, the continuation of this Habratopik , as they say, ‚Äúat the request of the workers‚Äù. And before I begin, I bring a bunch of sincere thanks to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dances with a tambourine, part 2 - tabbed menu in Drupal</h1><div class="post__text post__text-html js-mediator-article">  Actually, the continuation of <a href="http://habrahabr.ru/blogs/css/52547/">this Habratopik</a> , as they say, ‚Äúat the request of the workers‚Äù.  And before I begin, I bring a bunch of sincere thanks to the habrousers who were not lazy to send bug reports and thus helped to ‚Äúlick‚Äù the result.  Let there be no limit to perfection, and I still have to fix a couple of rough edges - but in any case, it is better than it was originally.  And now I will tell you how I pulled the whole kitchen on the menu system in Drupal. <br><a name="habracut"></a><br>  To begin with - we will formulate the task.  We need to: <br><ol><li>  the menu item becomes active when you select the appropriate page (well, this is a no brainer, and the corresponding class on the link is automatically attached by Drupal) </li><li>  each menu item has a unique ID for hanging styles on it </li><li>  the menu item remained active when choosing any node from this page or when choosing a print version (the link to which has the form "print-page name") </li><li>  By default, on other pages that are not related to the catalog, the menu "Apartments" should be active. </li></ol><br>  Well, to make it all look, respectively, like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/b2e/7ec/3b9/b2e7ec3b934917c808d6c479e2151457.png" alt="image"><br><br>  Create a new menu (‚ÄúManagement‚Äù - ‚ÄúSite Design‚Äù - ‚ÄúMenu‚Äù).  We push the necessary links into it.  Go to ‚ÄúManagement‚Äù - ‚ÄúSite Design‚Äù - ‚ÄúBlocks‚Äù and substitute a block with a new menu in one of the visible areas (do not forget to check if this area is displayed in the template, and if the working divs of the area correspond to the ID, that spelled out in the style sheet).  We get a "naked" menu, which we will now customize. <br><br>  So, since task 1 is solved out of the box by Drupal and is already registered in our style sheet from the previous topic, let's move on to point 2. How can I attach unique attributes to each menu item, for example, ID?  It's very simple - we put the <a href="http://drupal.org/project/menu_attributes">Menu Attributes</a> module, turn it on on the module management page, and now, going into editing the menu item, we will see a separate section for adding attributes.  In our case, we assign an ID to each link: for the menu ‚ÄúApartments‚Äù - ‚Äúapartments‚Äù, for ‚ÄúHouses and cottages‚Äù - ‚Äúhouses‚Äù, for ‚ÄúLand plots‚Äù - ‚Äúground‚Äù, and for ‚ÄúIndustrial real estate‚Äù - ‚Äú business ".  And after this procedure, we will see that now the menu at least on the pages of directories (generated with Views, if anything) looks like it should. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's go further.  Now we need to keep the menu item active in the case of selecting any node from the appropriate section of the directory, or the version for printing the page.  I must say that I have every type of property - it is a separate type of node, with the appropriate parameters, therefore.  making the binding, I will check exactly the type of the node, although in general it can be anything (taxonomy, CCK field ... but how many).  We climb into the folder of our template and open the file template.php, adding the following lines to it: <br><br><pre> <code class="hljs ruby">function phptemplate_menu_item($link, $has_children, $menu = <span class="hljs-string"><span class="hljs-string">''</span></span>, $in_active_trail = FALSE, $extra_class = NULL) { $class = ($menu ? <span class="hljs-string"><span class="hljs-string">'expanded'</span></span> : ($has_children ? <span class="hljs-string"><span class="hljs-string">'collapsed'</span></span> : <span class="hljs-string"><span class="hljs-string">'leaf'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!empty($extra_class)) { $class .= <span class="hljs-string"><span class="hljs-string">' '</span></span>. $extra_class; } preg_match(<span class="hljs-string"><span class="hljs-string">"/node\/\d+/"</span></span>, request_uri(), $nid); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,    ,      .    preg_match - -  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!empty($nid[<span class="hljs-number"><span class="hljs-number">0</span></span>])) { $nid[<span class="hljs-number"><span class="hljs-number">0</span></span>] = ereg_replace(<span class="hljs-string"><span class="hljs-string">"node/"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, $nid[<span class="hljs-number"><span class="hljs-number">0</span></span>]); $tmp = node_load($nid[<span class="hljs-number"><span class="hljs-number">0</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ereg(<span class="hljs-string"><span class="hljs-string">'apartments'</span></span>,$link) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> !(preg_match(<span class="hljs-string"><span class="hljs-string">"/houses|ground|business/"</span></span>, request_uri()) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> preg_match(<span class="hljs-string"><span class="hljs-string">"/house|place|for_business/"</span></span>, $tmp-&gt;type) )) {$in_active_trail = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ereg(<span class="hljs-string"><span class="hljs-string">'/houses'</span></span>,$link) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (ereg(<span class="hljs-string"><span class="hljs-string">"/houses"</span></span>, request_uri()) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $tmp-&gt;type==<span class="hljs-string"><span class="hljs-string">'house'</span></span>) ) {$in_active_trail = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ereg(<span class="hljs-string"><span class="hljs-string">'/ground'</span></span>,$link) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (ereg(<span class="hljs-string"><span class="hljs-string">"/ground"</span></span>, request_uri()) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $tmp-&gt;type==<span class="hljs-string"><span class="hljs-string">'place'</span></span>) ) {$in_active_trail = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ereg(<span class="hljs-string"><span class="hljs-string">'/business'</span></span>,$link) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (ereg(<span class="hljs-string"><span class="hljs-string">"/business"</span></span>, request_uri()) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> $tmp-&gt;type==<span class="hljs-string"><span class="hljs-string">'for_business'</span></span>) ) {$in_active_trail = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($in_active_trail) { $class .= <span class="hljs-string"><span class="hljs-string">' active-trail '</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;li class="'</span></span>. $class .<span class="hljs-string"><span class="hljs-string">'"&gt;'</span></span>. $link . $menu .<span class="hljs-string"><span class="hljs-string">"&lt;/li&gt;\n"</span></span>; }</code> </pre> <br>  Wow ... scared?  And do not be afraid.  Now I will explain to you what is happening here.  By itself, the function overrides the standard Drupal menu output.  Since the global variable $ node here (FIG knows why, there was no time to figure it out) is not visible, then the number of the active node, if there is one, we get from the current URL with a regular expression.  And if there is one, load the parameters of the node. <br><br>  Then we check several conditions - just whether the address of the current page is contained in the menu link (this is necessary so that print versions containing the page name are processed correctly), and if not, whether the type of the current node corresponds to the corresponding page for the real estate type.  <b>Everything!</b>  <b>:)</b> <br><br>  I know that this is certainly not the most beautiful, fast, scalable, etc.  way to.  But, first, this is my first more or less serious project on drupal, and, secondly, I was promised that the structure of the menu and materials will continue to remain unchanged.  Although, in principle, if you correctly approach the naming of types of materials and pages, so that they all correspond to a specific pattern, then with the same regulars this task can be extrapolated to more serious conditions ... </div><p>Source: <a href="https://habr.com/ru/post/52601/">https://habr.com/ru/post/52601/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../52589/index.html">Mirror's Edge 2D - full version</a></li>
<li><a href="../52591/index.html">Example of a (budget) Managed VPS: Under-VPS or Mega-VPS</a></li>
<li><a href="../52594/index.html">Legal advice is required in the field of software copyright</a></li>
<li><a href="../52596/index.html">Facebook Developer Garage (Palo Alto, February 19, 2009)</a></li>
<li><a href="../52600/index.html">Is it reasonable to link links in alerts from the site to the user?</a></li>
<li><a href="../52602/index.html">Scandal with Price YuA</a></li>
<li><a href="../52604/index.html">All congratulations on the holiday of February 23!</a></li>
<li><a href="../52606/index.html">Facebook as the biggest photo site: facts and comments</a></li>
<li><a href="../52607/index.html">"Solar batteries"</a></li>
<li><a href="../52608/index.html">Audio Blog</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>