<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigation of the Slovak spam campaign</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we want to talk about the campaign for the distribution of malware, which uses the theme of the timing of the filing of tax returns in Slovakia....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Investigation of the Slovak spam campaign</h1><div class="post__text post__text-html js-mediator-article">  Today we want to talk about the campaign for the distribution of malware, which uses the theme of the timing of the filing of tax returns in Slovakia.  Despite the fact that this attack is more local, such a case shows how dangerous social engineering methods used by attackers, in which the self-invoking topic is used, can be dangerous. <br><br><a name="habracut"></a><img src="https://habrastorage.org/storage2/fa2/498/cbd/fa2498cbd311aee49d7a65b05a686f61.jpg"><br><br>  <b>Distribution campaign</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the attack vector we recorded, we used the method of delivering malicious code using messages sent by e-mail.  These letters were allegedly sent from the Slovak tax service.  Below are the screenshots of such messages. <br><br><img src="https://habrastorage.org/storage2/d43/d88/e14/d43d88e14d56e4b8e6cff5361351aeb7.jpg"><br><br><img src="https://habrastorage.org/storage2/eaf/739/866/eaf739866997d9429cd8a6fdfbd9c33d.jpg"><br><br>  The topic of these messages can be translated as: <i>Notification of a change in property tax</i> .  Further, the text written in the message body informs that instructions for making a payment can be found in the attachment attached to the letter.  Interesting is the fact that the attackers focused on a specific tax subject in Slovakia.  That is, for each of such entities or enterprises their details were sent to pay a certain amount.  The attacker not only knew the Slovak language well, but also turned out to be quite well acquainted with local tax laws.  The above factors have made this scam much more plausible. <br><br>  The attacker slightly changed the way messages were delivered in the two campaigns, but the malware that was delivered as a result remained the same. <br><br>  The first campaign to spread this spam included malicious links in the messages sent.  In this case, the user could receive two files: one as an attachment in the letter, and the second through a link to download.  The file could be an RTF document or be executable.  The RTF file contained an exploit for CVE-2010-3333, which installed the installation of malicious code into the system.  Links to download messages led to the popular file-sharing services. <br><br>  The second campaign was simpler and was more successful according to the number of downloads of the malware object.  Hypertext link in the letter pointed to the executable file with the extension .SCR. <br><br>  <b>Malicious code</b> <br><br>  Malicious software that was delivered using an attack was a Trojan program aimed at stealing credentials of various user accounts.  ESET detects this Trojan as <a href="http://www.virusradar.com/en/Win32_Sazoora.A/description">Win32 / Sazoora.A.</a> <br><br>  <b>Win32 / Sazoora is</b> focused on stealing all sorts of data forms entered into the browser.  In particular, the Trojan program contains special libraries for implementation in MS Internet Explorer, Mozilla Firefox and Google Chrome, and also implements the following methods for stealing these forms. <br><ul><li>  Intercepts any information entered into the HTML forms of browsers that were mentioned above. </li><li>  Retrieves user credential information stored there from the browser‚Äôs memory. </li><li>  Carries out the introduction of special malicious HTML-code in the web page in order to steal credit card data. </li></ul><br>  The stolen data is then periodically sent to a remote server, the URLs of which are hardcoded in the executable file itself.  The following screenshots show web injections used to lure a potential victim and then enter credit card information. <br><br><img src="https://habrastorage.org/storage2/aaa/8e7/859/aaa8e78594684fd68f35d6b788b44d5c.png"><br><br><img src="https://habrastorage.org/storage2/85d/fa8/3b2/85dfa83b2f7ac3ca16d5367dec8e04ee.png"><br><br><img src="https://habrastorage.org/storage2/10d/14a/f8b/10d14af8b5af7ea7a3633b13797846b7.png"><br><br><img src="https://habrastorage.org/storage2/ae2/545/1c1/ae25451c19a777859b7bd036823332e0.png"><br><br><img src="https://habrastorage.org/storage2/f00/23f/459/f0023f4597ec9f1c442772bb5eb2269c.png"><br><br><img src="https://habrastorage.org/storage2/afa/11c/deb/afa11cdeb20fdf2d1201359fa391eb90.png"><br><br>  The last screenshot is especially interesting because it uses the form of payment for OS updates.  Please note that none of the above methods are new and all of them have been used for a long time in various families of banking Trojans, such as Zeus and SpyEye.  But unlike them, Win32 / Sazoora.A has less flexible options for configuring malicious code with respect to the addresses of command C &amp; C servers and web injections for HTML, which are simply hardcoded in the executable threat file. <br><br>  According to ESET LiveGrid statistics, the region where Win32 / Sazoora prevails is Slovakia (more than 60% of all detected detections).  It leaves no doubt that such prevalence was the result of these ongoing spam campaigns.  The next in terms of the prevalence of this threat is Switzerland.  It is worth noting that Win32 / Sazoora is a generic (verdict) for the family of this threat, therefore various modifications of this code, which is found under this name, are possible.  It is quite possible that another modification is detected in Switzerland, that is, a modification that was not used in this particular spam campaign. <br><br>  <b>The victims</b> <br><br>  The data of our telemetry system shows that the attack has reached its goal, since a sufficient number of computers were infected with malicious code, and the e-mails sent were not intended for random recipients.  Obviously, a prepared list of Slovak addresses was used to send these messages.  Among the victims that could be identified were doctors, accountants and employees of several scientific institutes.  Most likely, the letters they received contained a topic from their profession, which was the reason for the discovery of these letters with the subsequent transition to a malicious link. <br><br>  At the request of one of the users, we conducted a detailed analysis of his infected system, after they had noticed suspicious activity related to logging into his bank account.  During the investigation, it turned out that the user was infected with a modification of Win32 / Sazoora.A, besides that, the user's credit card information was stolen.  Interestingly, the attacker could not access the bank account in the online banking system due to the presence of a two-factor authentication system.  Later on, the attacker sent the user another message to receive the second code necessary to access the account, which was the reason for seeking help.  It is possible that other victims were less fortunate.  This case once again confirms the need for users to be more vigilant when opening extraneous e-mail messages, especially when it comes to corporate security. </div><p>Source: <a href="https://habr.com/ru/post/181490/">https://habr.com/ru/post/181490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../181474/index.html">Semantic Forms for MediaWiki</a></li>
<li><a href="../181476/index.html">The cost of upgrading the satellite system has increased 2.5 times</a></li>
<li><a href="../181478/index.html">There is a set of future leaders of Computer Science in AU and CSC</a></li>
<li><a href="../181486/index.html">Installing Debian Wheezy on Buffalo Linkstation Pro</a></li>
<li><a href="../181488/index.html">Optimum parallelization of unit tests or 17,000 tests in 4 minutes</a></li>
<li><a href="../181494/index.html">Overview of the new Violin - flash storage system operating at a speed close to DRAM</a></li>
<li><a href="../181496/index.html">Overview of the smartphone on Android, which works for a week! Highscreen boost</a></li>
<li><a href="../181498/index.html">How we studied project management in the mountains</a></li>
<li><a href="../181502/index.html">Mobile art trends on the example of top-grossing games</a></li>
<li><a href="../181504/index.html">Common layout error: test horizontal scrolling</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>