<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Shopping list</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Description 
  I always suddenly run out of food. It seemed that yesterday there was a strategic stock of beer, but today it is already gone. And, of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Shopping list</h1><div class="post__text post__text-html js-mediator-article"><h4>  Description </h4><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/ee3/474/3bb/ee34743bb05411434c47a436e87583d1.jpg" align="left"></a>  I always suddenly run out of food.  It seemed that yesterday there was a strategic stock of beer, but today it is already gone.  And, of course, when you discover that something is missing, you have neither a phone nor a notebook at hand.  Not surprising, since it usually happens in the kitchen in the midst of cooking. <br><br>  I decided to create an apparatus that would allow one touch of a button to note what was missing.  The device transmits information about the missing products to the phone and responds if something has been purchased. <br><br>  In this article I would like to tell you how I collected this thing, what difficulties I encountered and how I came out of the situation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h4>  Demonstration of work </h4><br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/vUY4kJ4B_pg%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700253&amp;usg=ALkJrhjLHd3TFx5iPnZGS_mPGbbd3oBoxQ" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  Reminder history </h4><br>  I'm not the first to come up with a shopping list on the wall.  About the same thing was used at the beginning of the 20th century in America.  The hostess noted that ended by inserting pegs into the holes in front of the product name.  Assistants in the kitchen bought the necessary and took out the pegs.  These reminders looked like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/518/e70/a63/518e70a634f24bcef3d815afdd37d3c1.jpg"></div><br>  I realized that it was absolutely necessary for me to transfer this idea to the 21st century, and I set to work. <br><br><h4>  System architecture </h4><br>  The system consists of three components: <br><ol><li>  Board with buttons </li><li>  Server processing requests </li><li>  iOS application </li></ol><br>  When you press the button, the board sends a request to the server.  The server saves the status and uses Apple Push Notifications to notify the application.  The application requests a status from the server and sends updates about purchased products there.  Every 5 minutes the board updates its status from the server. <br><br><h5>  Board with buttons </h5><br>  The basis of the system is the <a href="http://www.st.com/web/catalog/mmc/FM141/SC1169/SS1574/LN7">STM32F051</a> microcontroller.  I use it because of the ease of connection and operation. <br>  As a Wi-Fi module, I chose the <a href="https://www.sparkfun.com/products/11048">RN-XV WiFly</a> .  This module is extremely easy to program and use: all you need is power, reset and UART connection. <br>  The board has 35 buttons without latching (that is, the button lets current through only while you hold your finger).  Each button contains a small LED. <br><br>  I used the <a href="http://www.mouser.com/ds/2/140/TL1265-26217.pdf">TL1265</a> buttons.  Each button connects through a separate transistor.  This was necessary in order not to exceed the maximum current strength of the shift registers: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/140/04f/2d5/14004f2d53ba3e1dc5955d72025b196b.png"></a> <br><br>  Buttons (and their LEDs) are connected using shift registers.  <a href="http://www.nxp.com/documents/data_sheet/74HC_HCT165.pdf">74HC165A</a> for reading the status of buttons: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/e25/54e/425/e2554e425bf02e2aa28f993f5290e29b.png"></a> <br><br>  <a href="http://www.ti.com/lit/ds/symlink/sn74hc594.pdf">74HC594</a> for controlling LEDs: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/749/0eb/9ba/7490eb9ba666bdcf80ef584cc98b1548.png"></a> <br><br>  Unfortunately, the free version of the Eagle CAD program imposes a limit on the size of one scheme.  So I had to make several small schemes with buttons, the main control module and connect all this with wires: <br><img src="https://habrastorage.org/getpro/habr/post_images/0fb/f24/75d/0fbf2475df7bd6f053b03891feed5745.jpg"><br><br>  On the other hand, the main layer looks like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/e03/eb6/238/e03eb6238c07890bfeae1d2ec476d1bc.jpg"><br><br>  Previously, I hunted schemes at home, but this time I decided to order from <a href="http://oshpark.com/">OSH Park</a> .  Schemes were made in 10 days.  There are no complaints about the quality: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/ef9/243/02bef9243ffd4b1a08dca8422874f930.jpg"></div><br>  In the house there were a lot of old transistors and resistors installed in the through hole, almost all went to this project: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f79/4c9/b02/f794c9b02063b7693a4888d83ce248d7.jpg"></div><br><br><h5>  Server processing requests </h5><br>  Perhaps this was the easiest part.  The server is written in PHP, uses MySQL for storing state and <code>stream_socket_client('ssl://gateway.sandbox.push.apple.com:2195', ...)</code> for sending Apple Push Notifications. <br><br><h5>  iOS application </h5><br>  Here, too, nothing complicated.  Two screens, one with finished products, the other with a complete list: <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/9ee/55a/853/9ee55a85325856baa1b7a93dc24a6a9c.png"></a> </div><br><br><h4>  Housing assembly </h4><br>  I really like the neat corps of amateur projects.  The basis of the case for this project was the usual photo frame.  Solid glass had to be replaced with custom-cut transparent plastic: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b61/06e/d0a/b6106ed0a44a331fb39c8e65bf56f868.jpg"></div><br>  With the inscriptions the case was more complicated.  I could not manage either to sign it neatly, or to carefully cut out the buttons for the buttons.  As a result, I found, it seems to me, a very elegant solution.  Using a laser cutter, I first made holes for the buttons.  Then, at a lower power, cut the grooves for the letters.  I filled the grooves using pen and white ink.  Here is the work process: <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/635/225/a5a/635225a5aa9659d839e04d7a2d7f264e.jpg"></a> </div><br>  So I got three layers: <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/6d1/999/7d7/6d19997d7f5506a509e55777130a91b3.jpg"></a> </div><br><br><h4>  Result </h4><br>  Here is what happened as a result: <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/611/248/81c/61124881c00f49162139f72be98da32c.jpg"></a> </div><br><br>  Here is how it looks in the room: <br><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/d48/88f/6a0/d4888f6a02fa5ccf6889f096f1312a2a.jpg"></a> </div><br>  I will be happy to answer any questions about this thing.  It would also be great to serve opinions on what can be improved, what you should pay attention to. <br><br>  In any case, now I am sure that with such a thing the strategic supply of beer in my fridge will not run out! </div><p>Source: <a href="https://habr.com/ru/post/202550/">https://habr.com/ru/post/202550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202536/index.html">Making Hyperboria hotspot. Allowance for picking the router</a></li>
<li><a href="../202538/index.html">Dual Standards for Account Encryption</a></li>
<li><a href="../202540/index.html">Love in pixels or what is Love2d</a></li>
<li><a href="../202544/index.html">KUB-Pico / 220 Socket Controller from Technotronics</a></li>
<li><a href="../202548/index.html">New mitigation mechanisms in Windows 8.1</a></li>
<li><a href="../202554/index.html">Dmitry Sklyarov: ‚ÄúAttentiveness and some logic. How complicated is simple. ‚Äù</a></li>
<li><a href="../202556/index.html">JavaScript race (30 lines of code)</a></li>
<li><a href="../202560/index.html">English idioms with names</a></li>
<li><a href="../202562/index.html">Migrating an application from Windows 8 to Windows 8.1</a></li>
<li><a href="../202564/index.html">Microsoft has released a 3D printing program for a mass audience.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>