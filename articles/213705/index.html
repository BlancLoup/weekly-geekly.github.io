<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Splitting an AngularJS application into isolated modules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing a large enough application, there inevitably comes a moment when the application finally becomes large enough to slow down. For Angula...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Splitting an AngularJS application into isolated modules</h1><div class="post__text post__text-html js-mediator-article"> When developing a large enough application, there inevitably comes a moment when the application finally becomes large enough to slow down.  For AngularJS, there are many techniques to achieve the desired performance: <a href="https://github.com/Pasvaz/bindonce">bindonce</a> , filtering lists, using $ digest instead of $ apply, ng-if instead of ng-show (or vice versa), and <a href="http://blog.scalyr.com/2013/10/31/angularjs-1200ms-to-35ms/">others</a> .  But they all allow you to do only local improvements without helping out globally: you can‚Äôt get rid of the $ rootScope calls completely. $ Digest doesn‚Äôt work, and it can take a very long time to check the status of the entire application. <br><br>  In this article I want to propose an architectural solution: splitting the application into several parts unrelated from the framework point of view and self-realizing the connections between them. <a name="habracut"></a><br><br>  In Angular, there is the concept of <a href="http://docs.angularjs.org/guide/bootstrap">bootstrap</a> .  This is the method that is usually called after the page loads if there is an element with the ng-app attribute.  It associates this element with the module specified in the attribute value.  This element must be one, otherwise the documentation does not guarantee anything.  However, you can use it manually: <code>angular.bootstrap(element, [/*Module*/]);</code>  This will launch the specified module, all its dependencies, as well as the ng module and its dependencies.  Therefore, the new application (let's call it an isolated module) will have its $ injector, $ rootScope, $ compile, etc.  - the entire internal kitchen of Angular will be recreated.  The parent isolation module will not know about the existence of nested into it, no events (emit and broadcast) will pass between the modules, and $ digest called in one isolation module will not leak into the other.  For loosely coupled components, this is what is needed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For easy creation of new applications, the following directive can be used: <pre> <code class="javascript hljs">directive(<span class="hljs-string"><span class="hljs-string">'newApp'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>{ <span class="hljs-attr"><span class="hljs-attr">restrict</span></span>: <span class="hljs-string"><span class="hljs-string">'EA'</span></span>, <span class="hljs-attr"><span class="hljs-attr">transclude</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">scope</span></span>: { <span class="hljs-attr"><span class="hljs-attr">module</span></span>: <span class="hljs-string"><span class="hljs-string">'='</span></span> }, <span class="hljs-attr"><span class="hljs-attr">link</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">scope, element, attr, ctrl, transclude</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> div = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'app'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> = angular.module(scope.$id, [scope.module]).run([<span class="hljs-string"><span class="hljs-string">'$rootScope'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$rootScope</span></span></span><span class="hljs-function">) </span></span>{ scope.$on(<span class="hljs-string"><span class="hljs-string">'$destroy'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $rootScope.$destroy(); angular.module(scope.$id, []); }); transclude($rootScope, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">) </span></span>{ angular.element(div).append(el); element.append(div); }); }]); angular.bootstrap(div, [scope.$id]); } }; });</code> </pre><br>  Using: <pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">new-app</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">module</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" 'SomeModule' "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">some-module-directive</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">new-app</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  To compare the performance before and after, you can see a synthetic example: a <a href="http://jsfiddle.net/cY5Wj/13/">slow version</a> and a <a href="http://jsfiddle.net/cY5Wj/12/">fast version</a> . <br><br>  We should also mention memory leaks.  For their absence, the $ destroy event handler is responsible for the directive.  It sends this event inside an isolated module so that everyone knows about it and overwrites the module to remove registered directives, controllers, etc. However, the memory still leaks, for example, because of the cache of elements in angular.element.cache and many other things .  This question deserves a separate study and article. <br><br>  Another problem found is the $ location service.  Among other things, he observes the address of the page, and when it changes, makes some gestures, for example, updates the contents of ngView.  In the case of several isolated modules, several instances of $ location will be created, several url change handlers, which is not good.  So far, I have come up with the following workaround: <pre> <code class="javascript hljs">.config(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$locationProvider</span></span></span><span class="hljs-function">) </span></span>{ $locationProvider.$get = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> angular.element(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).injector().get(<span class="hljs-string"><span class="hljs-string">'$location'</span></span>); }; })</code> </pre><br>  Now I spend testing and design code in the form of a library, interested in the opinion of the community. </div><p>Source: <a href="https://habr.com/ru/post/213705/">https://habr.com/ru/post/213705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213683/index.html">We change a lot</a></li>
<li><a href="../213685/index.html">Samsung introduced the second generation of "smart" watches - Gear 2 and Gear 2 Neo</a></li>
<li><a href="../213695/index.html">Schneider floor hatches - office workplace solutions</a></li>
<li><a href="../213697/index.html">Hide and Seek: Code Generation vs. JSON</a></li>
<li><a href="../213701/index.html">Django forms field - nested table</a></li>
<li><a href="../213709/index.html">Ruby 2.1.1, happy birthday!</a></li>
<li><a href="../213711/index.html">Hello Ruby, or how to teach a child to program?</a></li>
<li><a href="../213713/index.html">Free PHP Basics course in Russian translation by LendWings</a></li>
<li><a href="../213715/index.html">Computer control without hands (a gyro in my head!)</a></li>
<li><a href="../213717/index.html">Introducing the Nokia X family with support for Android apps.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>