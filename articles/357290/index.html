<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Helpful (?) Tips from the CIA hacker school</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The new data leak on WikiLeaks contains tips on how you need and how not to write exploits. 


 The data posted on WikiLeaks , contains thousands of f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Helpful (?) Tips from the CIA hacker school</h1><div class="post__text post__text-html js-mediator-article"><h2>  The new data leak on WikiLeaks contains tips on how you need and how not to write exploits. </h2><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f28/f9b/b43/f28f9bb4319c93d2be2791fac71127c3.png" alt="image"><br><br>  The data <a href="https://geektimes.ru/post/286702/">posted on WikiLeaks</a> , contains thousands of files belonging to the group of developers of the CIA (Engineering Development Group, EDG).  This organization from the CIA Cyber ‚Äã‚ÄãIntelligence Center is responsible for creating tools for hacking digital devices around the world - to achieve the goals of the CIA.  Leaked documents from the server used to track and document projects. <br><br>  Many of these documents are not classified - there, for example, you can find instructions from Lockheed Martin and other manufacturers.  Most of them are classified as ‚Äúsecret‚Äù, including such harmless things as the manual for beginners in Microsoft Visual Studio - it seems to be the favorite tool of the EDG division of the Applied Engineering Department (AED).  Also there you can find some components for creating memes and animated gifs from the <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D1%2580%25D0%25B8%25D0%25B3%25D0%25B0%25D0%25BD">Trigan</a> manga series. <br><a name="habracut"></a><br>  A small part of the documents is ‚Äútop secret‚Äù.  The section with these documents is marked as ‚Äúspecial data‚Äù (Special Intelligence, SI) and NOFORN (do not distribute outside the country).  From the first group, consisting of more than 1000 documents, only two paragraphs are classified at this level.  This data describes the details of how the cryptographic functions of the tools of the CIA network division tools should work and how the CIA gets and prepares phones for use in its exploit lab. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The damage caused by the documents for the most part is not that they tell about the CIA's capabilities in hacking and network espionage.  The problem is how detailed these documents describe the technical specifications, rules and other details of the work of teams developing hacking tools.  Now, after examining the documents, any person can find out how EDG uses techniques peeped in other people's malicious programs to write their own, and what, according to the CIA, should and should not be done when developing attacks and espionage tools.  In other words, the details of the professional work of the scouts from the hacking teams leaked from the CIA server. <br><br>  However, most of these details look like a beginners malware instruction.  Some comments made by the CIA developers in 2013 tell us how far these rules are lagging behind.  Many of these technologies are no longer secret. <br><br>  To demonstrate this, we commented on some excerpts from the secrets of malware development from AED.  Many of these rules apply to the development of any computer security application.  Most of them are connected with the difficulty of researching these applications - so that the enemy team is more difficult to determine and understand how the malware works.  Among some banal things about the rules of writing code, there are such: <br><br><h2>  1. Do not leave business cards </h2><br>  Developers were advised not to do anything that would allow the enemy to determine where the tool, bookmark, or malware came from. <br><br>  "Do not leave time and date stamps, such as compiler, linker, builder time, access time, etc., corresponding to the working time in the US (from 8 am to 6 pm Eastern time)."  Such artifacts are often used by analysts to identify as part of the process of determining the country of origin of the malware. <br><br>  Developers are advised to use UTC time for all time-dependent operations.  This will ensure a coherent work and the absence of hints at any particular time zone. <br><br>  "Delete all debug information, manifests [from Microsoft Visual C ++], build paths, developers' names from the final binary file assembly."  Such things can also be used to establish authorship.  For the same reasons, documents persuade developers to "not leave data in binaries indicating their involvement in the development or use of this tool by the CIA, the US government, or their partner companies." <br><br>  One of the main security warnings is encountered: ‚ÄúDo not store data containing terminology of the CIA or the US government, department names, code names of operations or other terminology in the binary.‚Äù <br><br>  There is another warning that you should not use in the development of tools - obscene language.  ‚ÄúDo not use obscene words in a binary.  Such words or hacking terms can lead to overly thorough checks of a binary file. ‚Äù <br><br><h2>  2. Do not disturb the victim‚Äôs computer </h2><br>  Then the developers are warned about the mistakes of beginners, facilitating the reverse-engineering tools.  The first rule of the Malicious Club is not to disrupt the victim‚Äôs computer, so as not to draw unnecessary attention to the presence of malware. <br><br>  ‚ÄúDo not perform operations that can cause the computer to stop responding to user requests (bursts of CPU usage, screen flicker, freeze, etc.,‚Äù the document says. <br><br>  ‚ÄúDo not perform disk operations that may cause the computer to stop responding to user requests or give a signal to the system administrator.‚Äù  The last thing you need in this situation is if someone looks at the system inspector and finds out that the Notepad.exe program is running out all the resources of the CPU, the network and the I / O of the drive. <br><br>  ‚ÄúSet the maximum size and number of files to be recorded.‚Äù  This, for example, will prevent the computer's drive from filling up, after which the risk of computer inspection is increased by a specialist from the support service. <br><br>  For the same reason, the document recommends: ‚ÄúDo not create crashdump and coredump files, do not call the blue screen, the pop-up dialogs of Dr Watson and other artifacts in case of a program crash.‚Äù  Error messages work in both directions - they will be useful both to developers and program researchers.  AED developers are advised to specifically drop their programs to make sure that they do not show themselves in this case. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/ee7/bd6/93a/ee7bd693a82a66b6d327c771394d9973.jpg"><br>  <i>These manuals are as modern as this IBM System / 370 mainframe.</i> <br><br><h2>  3. Use encryption </h2><br>  Another feature of the invisible work is the encryption of the data used by the tool;  in memory, on disk, on the network.  One of the documents contains the following tips: <br><br>  "Protect with obfuscation or encryption all string data and settings directly related to the operation of the tool."  Someone who studies the settings file or the executable file in the editor should not be able to figure out what your tool does and where it sends its data only on the basis of textual data.  Developers are encouraged to write code that decrypts only the information required at the moment, and remove it from memory immediately after use.  "Do not rely on the fact that the operating system will do this at the end of the program." <br><br>  ‚ÄúDo not write data to disk in plain text‚Äù, this can quickly lead to uncomfortable situations.  ‚ÄúEncrypt all the data written to disk‚Äù and ‚Äúuse safe mashing [overwrite data with zeros] when deleting data from disk‚Äù.  Files deleted this way cannot be restored. <br><br>  ‚ÄúUse end-to-end encryption for all network communications‚Äù - after all, passive collection of unencrypted data leaving the network will ruin everything. <br><br>  Use standard Internet protocols so that your communications merge with other network traffic - and not your own protocol, trying to pass for something else.  Incorrectly implemented protocols will look like the wrong traffic on a network monitor such as Wireshark, which may attract attention. <br><br>  Do not rely solely on SSL / TLS for data security "- because SSL proxies are vulnerable to the MitM attack. This went sideways even for the safest messaging applications. <br><br>  ‚ÄúUse variable size and random times to send [jitter] network messages.  Do not send predictable packets of fixed size and time to send.  Clean up network connections correctly.  Do not reserve residual compounds. ‚Äù  In short, changing the size and time of sending messages will help your tool to advertise its presence less. <br><br><h2>  4. Do not facilitate the work of the research team of the enemy </h2><br>  In the matter of creating tools for espionage, a lazy programmer is a bad programmer.  The recommendations speak of various aspects of programming hygiene that are designed to protect against untidy actions that can uncover CIA operations. <br><br>  ‚ÄúRemove the debug system output from the final build‚Äù - because there is nothing more convenient for a third party trying to figure out what the program is doing than the debugging tools it leaves. <br><br>  "Do not call explicitly and do not import functions that do not correspond to the explicit purpose of the program."  In other words, if you are pretending to be a notepad.exe program, it should not trigger processes that notepad.exe would not cause ‚Äî this can be suspicious and make it easier for you to recognize the true purpose of your program using static analysis. <br><br>  ‚ÄúDo not export functions with obvious names;  if work is required to export, use an ordinary or non-suspicious name. ‚Äù  Since the code like "__declspec (dllimport) void DoVeryBadThings ()" can attract the attention of the analyst. <br>  "Do not read, write or cache data on a disk without need."  Enthusiasm records can leave traces. <br><br>  Do not exceed the required size: ‚Äútake reasonable efforts to minimize the size of all the binaries intended for downloading to the victim‚Äôs computer (without the use of packers or compression).  The ideal binary of a full-featured tool should not be more than 150 KB. " <br><br>  "Do not allow the possibility of a retransmission of data over the network."  This means that the connection between the program and the managing server must depend on the date and time so that it is impossible to record the traffic and send it to the instrument in an attempt to figure out what it is doing. <br><br><h2>  5. Check the reaction of antivirus software </h2><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a4d/a91/4a9/a4da914a9a544721291528b4fbac9a5c.jpg"><br>  <i>Everything worked in development</i> <br><br>  Some of the recommendations contained in the documents of the CIA, refers to the products of "PSP / AV" - "personal security products", products for personal security.  This name has already been found in the documents of the CIA, published by hackers Shadowbrokers. <br><br>  Part of the AED development cycle, according to the documents, includes extensive testing in a virtual DART environment.  This system was created in Lockheed Martin based on VMware and several programs for automatic testing and deployment.  But such an environment will not always be ideal for comprehensive testing of programs developed in AED, especially in terms of checking for their detection by antivirus. <br><br>  As a result, the developer needs to customize tests using real products - and not just free ones.  ‚ÄúDo not assume that a free PSP is identical to a paid one,‚Äù the document warns.  "Check for paid versions whenever possible." <br><br>  In addition, for reliability, these tests should be performed on recently updated antivirus software, since their manufacturers regularly send new data to customers.  ‚ÄúCheck out how to work with a PSP with a working (or recently operated) Internet connection,‚Äù the document says.  He also warns: ‚Äúa balance must be struck between the benefit and the risk, which must be carefully weighed.  It is well known that antiviruses download examples of the investigated programs. ‚Äù <br><br>  In other words, testing a tool while the Internet connection is working may result in the tool being tested being uploaded to the antivirus vendor‚Äôs threats library - and maybe then shared with a threat prevention platform like VirusTotal.  This can make the tool useless. <br><br><h2>  Outdated data </h2><br>  It is not known how carefully the developers of the CIA adhered to the recommendations of the leaked document - in particular, because they themselves understood how these recommendations were outdated.  In 2013, two system users wrote about this in the comments section: ‚ÄúMany of the intelligence tips on this page are incorrect.‚Äù  Another added: "To be honest, all this is likely to be outdated."  It is not known how long these recommendations were updated. <br><br>  Four years later, some of the recommendations were even more expired.  This is mainly due to the development of malware detection tools, including those built into the OS.  But it also played a role that the techniques used by the authors of malicious programs that work without government support, have surpassed all these tips.  Of course, with the help of the CIA or without it, there are no guarantees that all programmers use modern techniques. </div><p>Source: <a href="https://habr.com/ru/post/357290/">https://habr.com/ru/post/357290/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357280/index.html">How Google blocked itself</a></li>
<li><a href="../357282/index.html">US Prosecutor's Office abandoned the claim on child pornography, so as not to declassify the exploit for the browser Tor</a></li>
<li><a href="../357284/index.html">Hacking as cheating</a></li>
<li><a href="../357286/index.html">Spammers have a database of 1.37 billion email addresses because of a backup error.</a></li>
<li><a href="../357288/index.html">CIA hacker tools collection published</a></li>
<li><a href="../357292/index.html">For the Russian hacker Evgeny Bogachev, the FBI has appointed an award of $ 3 million</a></li>
<li><a href="../357294/index.html">USA accuses hackers from Russia and Kazakhstan of hacking Yahoo servers in 2014</a></li>
<li><a href="../357296/index.html">Study: sound attack on accelerometers replaces readings</a></li>
<li><a href="../357298/index.html">The court of Minnesota ordered Google to provide the police with search logs of residents of the whole city</a></li>
<li><a href="../357300/index.html">WikiLeaks is ready to share information about the CIA tools so that companies close vulnerabilities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>