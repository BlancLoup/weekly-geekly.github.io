<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Android Go is the next billion devices and 50 MB limit. Yandex lecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="New directions for the development of an already familiar platform are always interesting. On the one hand, you are expanding your client base, on the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Android Go is the next billion devices and 50 MB limit. Yandex lecture</h1><div class="post__text post__text-html js-mediator-article">  New directions for the development of an already familiar platform are always interesting.  On the one hand, you are expanding your client base, on the other hand, you are not investing in creating software from scratch, but using existing practices.  But if the direction is really new, with its own specifics, then it will not be possible to manage with very little blood.  At the next meeting of the Mosdroid community in our office, developer Artur Vasilov <a href="https://habr.com/users/arturka/" class="user_link">Arturka</a> told about the adaptation of the Yandex application to the Android Go system. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/VYcLRPoA4Bk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  On average, if you don‚Äôt write a calculator, an alarm clock, etc., then either you are very cool, well done, and you did everything well, or your application is 150‚Äì170 megabytes. </blockquote><br><a name="habracut"></a>  - My name is Arthur, I am an Android developer, working on the Yandex application.  Today I will share with you the story of how we adapted for Android Go.  I'll tell you what kind of rake we stumbled upon, what we did not succeed in and how it all works, why it is necessary. <br><br>  A small digression about what this is all about.  Android Go is a special version of Android, which is designed for cheap devices.  They cost 60-100 dollars, and therefore they are very weak, slow, inhibited.  So, Google decided for them to make their system so that they somehow worked normally.  It was announced on Google I / O in 2017, that is, a year and a few months have passed.  Therefore, when the mitap was announced, there was a logical question: ‚ÄúAre you still alive or what?‚Äù.  I then said that everything is fine, everything is fine, I will tell.  And now, as a typical Internet hero, I will answer after the fact why this happened. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/h2/qw/6g/h2qw6gttth_hx-niydwklvvcb8u.jpeg"><br>  What exactly happened?  Google said: "We make such a system."  Then he said: ‚ÄúOkay, we need time for refinement‚Äù and all that.  After that, vendors always have some delay in adapting this version for themselves.  And the new version with us, and so goes no earlier than a year, so there is nothing surprising.  In addition, they needed to decide whether it was necessary to do such a thing at all: it is a question of cheap devices and it is not clear whether there will be a profit from them or not.  In addition, this device should be new, it must be done, learn how to sell, understand how it will work. <br><br>  The first smartphone with Android Go appeared not so long ago.  Somewhere in April, sales probably began, or maybe in May.  This is Nokia 1, it is sold everywhere.  I'm lying around here.  Now, in my opinion, there are a total of nine such smartphones on the market, but by the end of the year they are promised more than a hundred.  In principle, none of the major players like Huawei, Samsung and others have said their word, so they will add something else, they will not be able to stay away from such a large market. <br><br>  Before the report, I went to the Android Go page and saw that they had made Android Pie Go Edition.  But they didn‚Äôt do anything there, they just reduced the number of installed applications and their weight in advance.  They said: - "You now have twice the amount of free space."  And standard excuses: bug fix, performance improvements, everything.  But at least they called, and therefore did not forget. <br><br>  What are the limitations of these devices, specifically?  First, they have 512 megabytes or 1 gigabyte of RAM, 8 or 16 gigabytes of storage.  It is clear that under such conditions they are extremely slow and all normal applications will work on them in about the same way.  In order for applications to work on them with minimal adequacy, Google said: "Let's introduce the following requirements."  They are quite logical, stemming from what was on the previous slide. <br><br><img src="https://habrastorage.org/webt/ci/xm/ht/cixmhtwrdwbu_gkczbo0vk3-k8e.jpeg"><br><br>  First of all, this is an abstract good performance.  Your application should be well and quickly run and run on such a device.  We are like, ‚ÄúGreat.  We work. <br><br>  Then there are specific numbers that need to be consistent.  The space occupied after unpacking and installing the APK is no more than 40 megabytes.  Sometimes this is a problem, because someone and the APK weighs all 80 megabytes.  It will hurt.  Moreover, it cannot be adequately taken and measured.  That is, you cannot say: ‚ÄúI know that my APK weighs so much, so after installation the application will take up so much.‚Äù  All this very much depends on the vendor, the version of the device, Android, etc. But if your APK is 10 megabytes, then, in principle, everything is fine and you will never exceed this number. <br><br>  And now the most fun and cool requirement: consumed RAM while working with the application should not exceed 50 megabytes. <br><br>  Who knows how much memory his application takes on average during operation?  Who ever was interested in this question?  Are there those who have less than 100 megabytes?  Pretty boy.  But maybe you're lying.  In general, on average, if you don‚Äôt write a calculator, an alarm clock, etc., then either you are very cool, well done and done well, or your application is 150‚Äì170 megabytes.  Putting it in 50 megabytes is very difficult.  Therefore, the rest of the time we will talk about it, we will discuss how to shove a globe into an owl, etc. <br><br><img src="https://habrastorage.org/webt/6k/el/g1/6kelg1qxjmzqgltficsia2dk1p0.jpeg"><br>  What does our memory conversation include?  You need to directly understand what we are measuring, then what is the best way to measure it.  Also for Android Go devices there is a specificity that needs to be taken into account, and we'll talk about it too.  And I will also tell you some general things, general tips that you might not have guessed, but they can really eat a lot of memory from you. <br><br>  In 2018, after Google I / O has passed, it‚Äôs necessary to begin a story about memory with reference to <a href="https://youtu.be/w7K0jio8afM">this report</a> .  Who watched it? <br><br>  Fine.  All the other 180 people know what to do in the near future.  In my opinion, this is one of the best reports on Google I / O.  Dude told unrealistically cool stuff.  He told everything on the shelves, well, and with many deep details.  Those who looked at him and remembered well would surely notice that I copied some things from there, because it is impossible otherwise, he told everything, so I will repeat. <br><br>  What do we measure?  There was such a thing called PSS (Proportional Set Size).  That is, the RAM in Android is represented by some blocks of 40 kilobytes each, and these blocks may either belong entirely to the application or be framed between processes and applications. <br><br>  And the question is: how exactly to understand, to which application to assign this shared memory?  There are several approaches, they are quite logical.  PSS says that if memory is fumbled between N processes, then we will assume that your application owns 1 / N of this memory.  And there is absolutely similarly the Residential Set Size and Unique Set Size, which says that ‚ÄúNothing from the shared memory does not belong to me‚Äù and ‚ÄúEverything belongs to‚Äù.  In principle, PSS is the most logical. <br><br>  How exactly can you measure memory consumption?  Everything is simple here.  Either this is a profiler in Android Studio, or it is dumpsys.  There are, of course, other tools.  They can give you more detailed results, something more complicated, but the problem is that to understand their results, to use them, all this is very, very difficult.  Often you need either root or a custom build of Android.  And by and large you don‚Äôt need them, the first two tools are enough. <br><br><img src="https://habrastorage.org/webt/0r/--/pr/0r--prgyak0-hltivshg-dxeuqc.jpeg"><br><h5>  <sub><sup><a href="http://developer.android.com/studio/profile/memory-profiler">Link from the slide</a></sup></sub> </h5><br>  I will not speak on the profiler in Android Studio, I think many people used it.  Who have not used, be sure to poke.  In particular, I gave the link below - just a good article from the documentation from the video, how to use it, with demos.  And, in principle, everything is clear.  It shows where your memory goes, shows it in real time.  The only thing to remember is that it still imposes certain errors that arise from the fact that we constantly measure this memory.  But they are within acceptable limits. <br><br><img src="https://habrastorage.org/webt/gb/fv/wn/gbfvwnjxm6fcggr66eoyzmcvnni.jpeg"><br><h5>  <sub><sup><a href="http://developer.android.com/studio/command-line/dumpsys">Link from the slide</a></sup></sub> </h5><br>  Dumpsys is a simple console piece that doesn't require anything from you, just the connected phone and adb.  And you can execute the following command: call dumpsys meminfo, give it a packet, and it will return something like this to you.  And if we are interested in exactly how much our application consumes, then we can look specifically at TOTAL, which says that "your application is eating about 168 megabytes."  A lot, but what to do? <br><br><img src="https://habrastorage.org/webt/lm/yo/xw/lmyoxwiahsbeey_ru-3zvdtd8y0.jpeg"><br><h5>  <sub><sup><a href="http://developer.android.com/studio/command-line/dumpsys">Link from the slide</a></sup></sub> </h5><br>  He also shows you a breakdown of how much space it takes in this consumed memory.  There are various sections here, they are complex, we will talk about them further, but for now we can notice the main thing - this is the Java Heap, our java objects, and all that is further is more complicated. <br><br>  What else is important?  Memory is a very sensitive thing to all kinds of tests and all kinds of external conditions.  That is, all the tests you need to perform as much as possible in the same conditions.  It is clear that this should ideally be one device, because the memory depends on the version of Android.  Here it is enough to recall the differences between the fours and the fives.  It depends on the size or resolution of the screen, because the larger the screen, the more content it fits, the more memory it takes to draw all this.  The resolution is larger, the more pixels your bitmap occupies, and the more memory is required to store them. <br><br>  The application scenario also affects the tests.  You can read the text or you can scroll the gallery with a bunch of pictures.  And it is clear where the memory will be more. <br><br>  Another important thing is the load on the device.  That is, you may be all the same, but in one case your application is the only one that works, and in another case you have a lot of applications that still do something in the background, download something, delete it, work on the foreground , and at the same time, your application just squeezes the memory, because you have to give it to other applications.  Therefore, ideally, it is better to take and first kill all other applications that work, not yours.  All that you can reach, then kill.  Just in this case, PSS will thank you exactly, because there will be no need to fumble memory between processes. <br><br><img src="https://habrastorage.org/webt/lm/yo/xw/lmyoxwiahsbeey_ru-3zvdtd8y0.jpeg"><br>  You can, for example, take and see the current information on free memory, on occupied memory.  He will print you something like this, which says that "Here I have so much free memory, so much cached memory, so much occupied memory."  And if you have 200‚Äì250 megabytes of free memory there for yourself, then this is good, most likely, then nothing will affect your tests. <br><br>  Perhaps someone now has the question "Why do I need all this?".  This is such a break in which I will additionally say the motivation for all this. <br><br>  Firstly, even if you are not going to do anything under Android Go now and think that it is dead, it may well develop, come to you, and you will have to deal with all this at some point. <br><br>  The second thing that I think is very important is that you can simply do regression tests from memory.  That is, you can simply write a script that will launch the application, do dumpsys, perform such measurements, and watch how these indicators change between releases.  Such a script can be written in a couple of hours, the infrastructure can be configured longer, but it seems to me that this is a good thing. <br><br>  If we talk about the specifics of Android Go - our third item in the fight against memory - then there is some good news.  Firstly, no one really demands for you to follow these restrictions.  That is, you can use the app as you have it, put it on the device with Android Go, and everything is fine.  The problem is that the user is very likely to delete you, because you occupy a lot of space.  Also, your application may run slowly and have a lot of memory, yes.  But so far no one forbids it, because otherwise there would not be a single application, except for Google on Android Go.  But if this thing develops further, many will adapt to such conditions, then in the end, your application can simply be reduced in the output of Android Go, or say how the user would install the application on their Android Go smartphone, they can show Alert : ‚ÄúDude, the app doesn't work well with Android Go.  Maybe you will not put it? ". <br><br>  There is one more thing - you can exclude Android Go devices from Google Play, that is, say that the application cannot be installed on Android Go devices.  It appeared not so long ago. <br><br>  And Google is also quite smart, and the 50 megabytes that sounded in the title of the report is not a fixed number, it depends on the resolution of the device, on the screen size, and, besides, on the type of application.  For example, games are allocated more, in my opinion, 115 megabytes.  In principle, this is quite understandable. <br><br><img src="https://habrastorage.org/webt/gu/yj/0s/guyj0sbre79wfwrlzgupt009xn0.jpeg"><br><h5>  <sub><sup><a href="http://medium.com/googleplaydev/how-to-optimize-your-app-for-android-go-edition-f0d2bedf9e03">Link from the slide</a></sup></sub> </h5><br>  What if we talk directly about this test?  There is one more thing that particularly concerns us in particular - working with presets.  When vendors make a new phone, they often put some sort of pre-installed applications there.  In particular, we are very involved in this, and the problem is that there they chase away such things as the Compatibility Test Suite.  These are google tests, they chase them away.  And there, if your application does not correspond to this 50 megabytes, then everything is bad, and your application cannot be pre-installed on such a device. <br><br>  Unfortunately, the tests that Google does are not from open source, I cannot tell them, they are under NDA, but Google‚Äôs good developers wrote such an article about Android Go, and there, in principle, there are recommendations that are good enough <br><br>  That is all trite.  Run the application.  We are waiting for 5 seconds until everything is loaded.  We do dumpsys, write the value TOTAL, execute a bunch of times, we get the result.  Everything is very simple and trite. <br><br><img src="https://habrastorage.org/webt/zq/ma/de/zqmadexusg3whja0-dsz0d4w7gk.jpeg"><br>  The only thing is that they did not take into account such a small feature in their article, or perhaps they didn‚Äôt talk about it - there is such a thing as work in another process, and they often do it to fight, including memory consumption. <br><br>  Who thinks it's good for Android Go?  And who thinks it's bad?  Boldly. <br><br><img src="https://habrastorage.org/webt/_c/4p/h5/_c4ph5f7gcnhakefypwspum8d_y.jpeg"><br>  The problem is that, yes, this is bad, because in the end your application consumes memory counts for all processes.  If we make such an empty process without anything and take the dumpsys of this particular process, we will see that it takes 7 megabytes.  5-8 megabytes is such an overhead from process creation.  Therefore, when we fight for every megabyte in order to squeeze it all into 50, then such a thing is given to us very badly.  In particular, for example, Yandex has the most popular Yandex.Metrica library, it also works in a different process, and this can also give us pain. <br><br><img src="https://habrastorage.org/webt/qu/os/fu/quosfu3kccdztjv7cp6ujn4rxhg.jpeg"><br>  Therefore, if some external libraries come to you, for example, you can simply say: ‚ÄúDude, please work in the main process.  I agree that it may be slower, but it will not eat extra memory. ‚Äù  So this is also a subtle point. <br><br><img src="https://habrastorage.org/webt/ci/6b/9c/ci6b9cbpebgounzlbc87xids-xi.jpeg"><br><br>  If we talk about memory consumption, let's move on to this label, which is there.  We take an empty project, and run this dumpsys, set it on this matter, and see that 23 megabytes out of 50 are already taken.  Empty ‚ÄúHello, world!‚Äù Without anything, just activate with text.  It gets pretty sad.  It becomes even sadder because of the fact that we can directly influence such a parameter as the Java Heap, that is, it is our own Java objects that can be tracked explicitly, which we can delete, reduce and somehow interact. <br><br>  And with this whole thing, it is difficult to interact normally, because this is just any framework code and you simply don‚Äôt have normal tools directly from Java to understand how all this is used.  But the good news is that we can influence the whole thing indirectly, so let's talk about what it is. <br><br><img src="https://habrastorage.org/webt/pa/p_/qp/pap_qprhxuqhr59pnjx8kxrqwos.jpeg"><br>  What is Java Heap is understandable.  What is Native Heap is also quite logical to assume.  These are the same allocations, only plus.  They come from the framework and from your native libraries, .so files and so on. <br><br>  The code is directly related to the storage of the code.  This is the size of your .dex, these are your .so, these are resources, mmap-files and all that.  That is, the less code, the better.  The simplest truth that works at all about everything. <br><br>  Stack is a stack of Java / C ++ threads.  That is, each thread has its own call stack, so each thread is created such a specific area of ‚Äã‚Äãmemory to store the whole thing. <br><br>  Graphics is the UI drawing.  There are partially stored and bitmaps that are drawn, and what is connected with it. <br><br>  Private other, System is something that we cannot influence at all, and, in fact, everything else that is not very categorical. <br><br><img src="https://habrastorage.org/webt/ut/mv/ft/utmvfteatf-vvzdda5_a8f-iyvi.jpeg"><br><br>  If we talk about native libraries, then, let's say, you can take an empty application ... you can take the usual application that we have, and take dumpsys from it, see that it takes 146 megabytes.  And if you go and cut something ... in particular, I took and cut out the two largest native libraries, which we have in total for 15 megabytes, and take the dumpsys after that, you can easily see that we have lost consumption from Native Heap and from the code.  That is, with such a simple gesture, we saved about 35 megabytes.  Not bad enough. <br><br><img src="https://habrastorage.org/webt/zn/9r/9v/zn9r9v35dja5ndfyz4nwinzshys.jpeg"><br><br>  Streams.  Let's do the easiest test.  There is an empty application, and there is the same empty application, where we take and make a loop that will do new Thread (), sleep in it for five seconds, and start this thread.  You can see that in this case we have a big stack.  That is, we can influence the whole thing, but indirectly, reducing the number of threads in the Java code.  That is, through Java objects, including influencing all these locations that exist in other elements. <br><br><img src="https://habrastorage.org/webt/4i/ed/mo/4iedmo77bys7vs6hv-f65oiuta0.jpeg"><br><br>  If you continue to talk about threads, you can easily see what you have for threads, what they do in the application.  There are different tools.  You can use the same systrace, you can simply find the id of your process with the console, and ps to understand what threads are in the system at all. <br><br>  If you do well and use all sorts of ThreadFactory to name your threads, then you can understand what you should have, what you should not have, and thus reduce the whole thing, because it is especially meaningless to have 100 threads in the application. <br><br>  What else can you do?  There is a completely well-known set of bayan tips: watch for leaks, use pools, do not create objects when not needed, and all this nonsense, all this applies.  Fine. <br><br>  There is a good relationship between how much your application consumes memory and how big it is.  That is, the more your application, the more memory it will eat, so, in a simple way, reduce the weight of the APK, reduce the weight of .dex, reduce the .so, remove everything that can be removed. <br><br>  Memory reduction is incredibly poorly matched with optimization.  Suppose we want to make the simplest case, when the user scrolls the tape of pictures, the pictures are downloaded from the network.  What are we doing in this case so that the user sees the pictures faster?  We in advance - while he has not yet scrolled up to these pictures - are starting to load the necessary pictures so that he does not see the gray squares.  In this case, if we are talking about memory, then we will simply occupy the memory with these pictures.  Therefore, memory and optimization are extremely poorly combined.  In the sense of optimization of this type. <br><br><img src="https://habrastorage.org/webt/3s/mv/wk/3smvwkzryvrsm1klctrsmnxtx4i.jpeg"><br>  If you look at dumpsys, then it is good, it brings you a lot of interesting things, besides the memory consumption itself.  For example, the number of your objects, such as the number of View, the number of WebView, the number of Assets, information on databases. <br><br><img src="https://habrastorage.org/webt/yd/m_/92/ydm_92wzagxi-1a9zpwzkeqbe8o.jpeg"><br>  Basically, the databases do not occupy much, but, perhaps, if every kilobyte is critical for you, you will have to use SharedPreference instead of SQLite in some cases, and perhaps this will help you. <br><br><img src="https://habrastorage.org/webt/1f/fs/ct/1ffsctcvhhohxpwiysekmopqwzk.jpeg"><br><br>  Also, for example, it is very pleasant to look at the selected Assets.  In particular, the most popular thing to see is fonts.  And these fonts occupy 1.5 megabytes.  Again, when we fight for every megabyte, delicate design feelings are sent far in the first place.  Forgive me colleagues. <br><br><img src="https://habrastorage.org/webt/q5/7g/ki/q57gkiv47412jj1q9_aye3k_4e8.jpeg"><br>  Unexpectedly the disgusting thing is WebView.  If you create an empty activation, launch WebView, load a Yandex page, take dumpsys, it will be 100 megabytes, just right away.  If you open, say, some pictures, skip a couple of times, then 300 megabytes is easy.  Even though WebView is chrome, and the process is considered yours.  So that. <br><br><img src="https://habrastorage.org/webt/o9/pj/z8/o9pjz8exyayhtg1varn-wtsmw8i.jpeg"><br><br>  Google knows this.  They made a little hack.  That is, they have a WebView, they have a Google application in which you can search for something.  Search results are opened in WebView.  Fine. <br><br><img src="https://habrastorage.org/webt/nt/lp/-q/ntlp-qwbjnysaljhmmahewkcdeq.jpeg"><br><br>  And there is a Google Go app that is designed for Android Go devices.  And here they open the output already natively, that is, they create some kind of layout to display this output, they display all this with native components.  And everything that needs to be opened directly in the browser is not opened in its internal browser, but in Chrome Tabs, so that Chrome can deal with this matter.  Such are the tricks. <br><br>  If we talk about the application directly under the Android Go, then what's so interesting?  There are certain specifics how to develop an application for Android Go, and let's talk a little bit about it. <br><br><img src="https://habrastorage.org/webt/rm/jz/cf/rmjzcfwjkfponuuzuljvu0r088q.jpeg"><br>  There are several ways.  First of all, everything can be cool with you, the application can work well, and you can give it to Android Go without any modifications.  The same in case you write an alarm clock, a calculator.  But more often than not, everything is complicated with you, so you need, let's say, to do some build flags, disable some modules, features at the compilation stage, something else to do.  And in this way you will have two APKs, and you can load one as usual, the second - use the use-feature "low-memory", and it will be like two APKs. <br><br>  Or you can make two applications, that is, one application is normal, the other application is specifically sharpened for Android Go.  So does Google.  In particular, they released Go versions of many of their applications. <br><br>  What is good, what is bad?  The good thing is that you initially make a new application, and if you initially write something in it and exceed memory consumption, then you say: ‚ÄúYeah, you did something wrong.  Went to do fine. "  And you do not need to immediately reduce this memory four times.  In addition, it is good and it is easy, but the bad thing is that you need to make a new application, besides, it must be supported somehow, the same with features with the main application, and somehow it must be combined.  This requires a huge pile of resources, and, in principle, it is not necessary to do this, if you are not Google, because if Google does not make such applications, then no one will do them.  And now you don‚Äôt need to make such an application, because it requires a lot of resources, and it‚Äôs unclear whether Android Go really shoots well, and there will really be a lot of such devices, or it will be quite a niche share. <br><br>  In any case, a multi-modular approach will help you very well here, because you can easily disable modules, something else.  It is very good. <br><br><img src="https://habrastorage.org/webt/6r/wd/i-/6rwdi-8mzeuwfvvw00dh0nmdf48.jpeg"><br><h5>  <sub><sup><a href="https://www.youtube.com/watch%3Fv%3Dw7K0jio8afM">Link from the slide</a></sup></sub> </h5><br>  Another rather important point from the report that was on Google I / O: the guys correctly say that you should not be afraid to turn off some of your features for such weak devices in runtime.  Perhaps you have a very cool photo editor who can do anything, apply any filters, but it requires a lot of memory and on a weak device it will work poorly.  Therefore, do not be afraid to say that ‚ÄúLet's not launch a photo editor on your device, because you have a weak device.  Buy normal. "  So this is a good schedule.  This is a graph of the dependence of the number of features on the memory consumed, and vice versa.  And this can be followed, in principle. <br><br>  What else is worth considering?  It is clear that the issue here is not only memory.  Memory is the most difficult, the most interesting, and that with which we were busy 98% of the time.  But it is clear that we need to think about the speed of work, start-up, battery consumption, etc. In addition, you can make some additional features for Android Go-applications.  In particular, YouTube Go has the ability to download an application for viewing offline.  This was not the case in the main YouTube application, and maybe not even now.  I do not know.  The fact is that devices with Android Go will be used in countries where, perhaps, not very good Internet - so let's download in advance.  There are other good examples - Facebook Lite, Twitter Lite, and also Yandex Browser Lite, because not everyone needs some fully functional features.  Someone, maybe, needs only correspondence or only posts.  There is no need to download a huge Facebook when you can put a little one.  And all this should be for users, you should think and make sure that they feel good.  In general, this is a cool challenge - to make such an application so that it works under Android Go. <br><br>  What else on the references?  There is a <a href="https://stackoverflow.com/a/2299813/3637200">cool answer</a> to Stack Overflow, which got almost 1000 likes.  You can help him dial more.  The answer clarifies that in general with memory, what is responsible for what, what is in memory.  And, in principle, this whole answer is dumpsys. <br><br>  Whether many people know this or not, but Android can work with devices that have 512 megabytes of RAM, only starting from Android 4.4.  There just appeared a <a href="https://source.android.com/devices/tech/perf/low-ram">special API</a> for interacting with such devices, and this can help you. <br><br>  It could be finished here, it would be beautiful.  And now about how it really was with us.  In short - not so beautiful, not so beautiful at all. <br><br>  They came to me in May, said: "We must do."  I said, "Good."  Let's go figure it out.  Read - all is well, except for the memory.  Memory somewhere 170 megabytes.  Great start.  We need to somehow reduce.  What is the easiest to do?  Take and disable all disconnected modules, see what happens, because you need to make sure that it somehow works.  If there aren't any features there - well, okay.  105 megabytes left.  It was painful. <br><br><img src="https://habrastorage.org/webt/mv/qk/gj/mvqkgjfuippyzhhhcv0tmkosqzw.jpeg"><br>  Therefore, a big refactoring went on.  On the basis of the build-flag began the alteration of everything.  densitySplit,     , resConfig,       .   ,  ,    ‚Äî . ProGuard   .  ,  ProGuard  ,     ,  , ,  ,       stacktraces. <br><br>      .     ,      ,      Android Go-       . <br><br>    - 64 .  : ¬´,   ¬ª.  14 ,  4 ,  60 .     ,   .  .  ,     .         ‚Äî    ,  ,  ,     ,    .     , ,  ,     Android Go,    . 10 , APK     ,  , .   ,    ,      . <br><br>  ,    ‚Äî   .        ,    . ,      ,     - ,    ,     .    .     , ,   .  Thanks to all. </div><p>Source: <a href="https://habr.com/ru/post/423493/">https://habr.com/ru/post/423493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423483/index.html">Finding the right way to split site content with a Webpack</a></li>
<li><a href="../423485/index.html">Lazy loading images using IntersectionObserver</a></li>
<li><a href="../423487/index.html">Node.js without node_modules</a></li>
<li><a href="../423489/index.html">I'm an emergency doctor, and I want to talk about the new Apple Watch electrocardiogram</a></li>
<li><a href="../423491/index.html">PHP Digest number 139 (September 3 - 17, 2018)</a></li>
<li><a href="../423495/index.html">What's inside XGBoost, and where does Go</a></li>
<li><a href="../423497/index.html">Let's try to talk about hierarchical finite automata in general and their support in SObjectizer-5 in particular</a></li>
<li><a href="../423499/index.html">DevBoy - how I created a project with an open source device and launched a project on Kickstarter</a></li>
<li><a href="../423501/index.html">Search and create a visual style design project</a></li>
<li><a href="../423503/index.html">My experience of moving, living and studying in Germany</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>