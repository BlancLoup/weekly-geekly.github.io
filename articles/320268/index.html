<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Generating documents in doc, excel, pdf and other formats on the server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Downloading reports in various formats is a typical task for many projects. And now there are a lot of tools for this. Among them there is an interest...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Generating documents in doc, excel, pdf and other formats on the server</h1><div class="post__text post__text-html js-mediator-article">  Downloading reports in various formats is a typical task for many projects.  And now there are a lot of tools for this.  Among them there is an interesting option that is used, it seems to me, not often, but it is definitely worth the attention.  Because it allows you to get the document in the right format with just one command.  About him and tell. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a94/e75/5ca/a94e755ca6cf74a4d0fe664be3815070.jpg" alt="image"></div><br><a name="habracut"></a><br>  I will not be wordy and immediately say that this is a converter built into the LibreOffice package.  You can run the conversion from the console to see how it works: <br><br><pre><code class="bash hljs">libreoffice --headless --writer --convert-to pdf html.html</code> </pre> <br>  This command converts the html.html file to a pdf file.  The number of formats supported is <a href="https://wiki.openoffice.org/wiki/Framework/Article/Filter/FilterList_OOo_3_0">impressive</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The benefit of using such a tool is obvious.  Instead of writing code to generate documents in each of the required formats, we simply create a regular html representation.  Next, run the generated page through the converter. <br><br><h3>  Running conversion from PHP </h3><br>  To install the converter on the server, you will have to install the libreoffice-core package: <br><br><pre> <code class="bash hljs">sudo apt-get install libreoffice-core --no-install-recommends</code> </pre> <br>  That it was convenient to work with the utility from PHP, I wrote a <a href="https://github.com/mnvx/lowrapper">wrapper</a> . <br><br>  The wrapper allows you not to think about working with temporary files, inserts some default parameters into the command, contains constants describing the available formats, and also gives you the opportunity to set a timeout for conversion. <br><br>  To work with the wrapper we connect it to your project via composer: <br><br><pre> <code class="bash hljs">composer require mnvx/lowrapper</code> </pre> <br>  You can use it like this: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Mnvx</span></span>\<span class="hljs-title"><span class="hljs-title">Lowrapper</span></span>\<span class="hljs-title"><span class="hljs-title">Converter</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Mnvx</span></span>\<span class="hljs-title"><span class="hljs-title">Lowrapper</span></span>\<span class="hljs-title"><span class="hljs-title">LowrapperParameters</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Mnvx</span></span>\<span class="hljs-title"><span class="hljs-title">Lowrapper</span></span>\<span class="hljs-title"><span class="hljs-title">Format</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    $converter = new Converter(); //     $parameters = (new LowrapperParameters()) //      HTML -&gt;setInputData('&lt;html&gt;My html file&lt;/html&gt;') //      -&gt;setOutputFormat(Format::TEXT_DOCX) //     -&gt;setOutputFile('path-to-result-docx.docx'); //   $converter-&gt;convert($parameters);</span></span></code> </pre><br>  As a result, a docx file will be generated.  More examples can be found on the <a href="https://github.com/mnvx/lowrapper/tree/master/examples">githaba</a> . <br><br>  Of course, as a bonus, you can run the conversion in the other direction - from doc to html and display the contents of office documents in the browser.  The quality of the conversion will not always be at its best, but for some cases it is quite suitable. <br><br><h3>  Few rakes </h3><br>  It will be useful to tell about several features that I encountered when working with this utility. <br><br>  1. Apply CSS styles.  When converting html to the required format, keep in mind that such a record is perceived correctly: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùsomeclass‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  And such records will be processed in the same way as if the class we did not specify at all: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùsome_class‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span>Some text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùclass1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class2</span></span></span><span class="hljs-tag">‚Äù&gt;</span></span>Some text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  2. When converting html to the desired format, style sheets do not always work and sometimes you have to experiment to make it work.  For example, this does not work: <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">td</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">th</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border</span></span>: <span class="hljs-number"><span class="hljs-number">1px</span></span> solid black; }</code> </pre><br>  But it works like this: <br><br><pre> <code class="xml hljs">.td { border: 1px solid black; } ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùtd‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  3. The same conversion can be performed using different converters.  The result will be significantly different.  If your output is a not very nice document, try forcing the module to be used, for example: <br><br><pre> <code class="php hljs">$parameters = (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LowrapperParameters()) -&gt;setDocumentType(DocumentType::WRITER);</code> </pre><br>  4. Is it possible to adjust the width of the rows in the table - for me it's still a mystery.  And in general, with the stylization of the table when converting html to docx or pdf, I had difficulty.  Therefore, in my opinion, the approach will be difficult to apply for the generation of complex printing forms, such as an invoice. <br><br><h3>  Conclusion </h3><br>  The tool is universal and very good if you have documents that are not very complex in layout.  Then at the exit you get documents in the right formats by writing just a few lines of code. </div><p>Source: <a href="https://habr.com/ru/post/320268/">https://habr.com/ru/post/320268/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320258/index.html">We become professional PHP developers. Part 4: Teamwork in practice</a></li>
<li><a href="../320260/index.html">Return H.264 support in Vivaldi in openSUSE Leap 42.2</a></li>
<li><a href="../320262/index.html">RIGHT kitchen</a></li>
<li><a href="../320264/index.html">We write a wrapper over the API, make a PIP packet out of it, connect Travis CI testing and look at open source licenses</a></li>
<li><a href="../320266/index.html">JunOS update on EX4500 switches in VirtualChassis - what could go wrong? Part 1</a></li>
<li><a href="../320270/index.html">Internet intelligence in action: who is Mr./Ms. Habraman?</a></li>
<li><a href="../320278/index.html">Hard parting with Net-Tools</a></li>
<li><a href="../320280/index.html">Javascript Video Refactoring</a></li>
<li><a href="../320282/index.html">Hijacking Whatsapp accounts using the web version</a></li>
<li><a href="../320284/index.html">Qt 5.8 framework release</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>