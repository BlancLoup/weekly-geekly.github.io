<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Slow software</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator: the problem of slow software has become one of the main topics of discussion at Habr√© and Hacker News in recent weeks. For exampl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Slow software</h1><div class="post__text post__text-html js-mediator-article">  <i><font color="gray">From the translator: the problem of slow software has become one of the main topics of discussion at Habr√© and Hacker News in recent weeks.</font></i>  <i><font color="gray">For example, see Nikita Prokopov <a href="https://habr.com/post/423889/">‚Äôs</a> article <a href="https://habr.com/post/423889/">‚ÄúMy Disappointment in Software‚Äù</a> and 2432 comments to it.</font></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ef/8be/c2b/5ef8bec2bc0b5518423dc49f921b1f77.png" align="left">  We spend a lot of time at the computer.  We are waiting for each time you launch applications and download web pages.  Everywhere icons with spinner or hourglass.  The hardware is more powerful, but the software still seems slow.  Why is that? <br><br>  If you use a computer to do important work, then you deserve fast software.  Too often, modern software does not meet these requirements.  In the <a href="https://www.inkandswitch.com/">research lab of Ink &amp; Switch,</a> we studied the reasons for this situation, the software eventually became better.  This article has published the results of our research. <br><a name="habracut"></a><br><h1>  Table of contents </h1><br><ul><li>  <a href="https://habr.com/ru/post/431282/">Where exactly is the slowness</a> <br><ul><li>  <a href="https://habr.com/ru/post/431282/">Delay is not bandwidth</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Touch interfaces</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Keyboard</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Mouse</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Applications</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/431282/">Where does the slowdown come from</a> <br><ul><li>  <a href="https://habr.com/ru/post/431282/">Input device</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Sampling frequency</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Displays and GPUs</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Overlay cycles</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Runtime overhead</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Intentional delay</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Hostile agents</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Application code</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Putting it all together</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/431282/">To fast software</a> </li><li>  <a href="https://habr.com/ru/post/431282/">Literature</a> </li></ul><br><a name="1"></a><h1>  Where exactly is the slowness </h1><br>  What do users perceive as a ‚Äúslow‚Äù program?  All of us sometimes the software annoys delays and lags.  But in order to better understand these problems, one should supplement the intuitive sensations with academic studies that strictly answer this question. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Perceived speed is closely related to the concept of latency.  A comparison of the research of ‚Äúwhat seems slow‚Äù with the measurement of the real delay in real applications makes it clear how bad everything is. <br><br><a name="2"></a><h4>  Delay is not bandwidth </h4><br>  When discussing software performance, we often hear about bandwidth.  For example, "this web server can perform 10,000 requests per second."  But this is not how users perceive things.  They care about how long their specific web request takes or how long it takes to open a document, or how quickly the application responds to mouse clicks.  These interactions are associated with latency.  Delay is a critical metric that we will explore in this article. <br><br>  <font color="gray"><b>User Perception</b></font> <font color="gray"><br></font>  <font color="gray">Read more about the importance of latency in interactive systems <a href="https://scholar.google.com/scholar%3Fcluster%3D10535754908454057825">here</a> .</font> <font color="gray"><br><br></font>  <font color="gray">Other factors also affect the feel of software speed.</font>  <font color="gray">For example, the frame rate and feedback during long tasks.</font>  <font color="gray">But we believe that the delay is a fundamental metric, and with a very low delay, any software will feel extremely fast.</font> <br><br><a name="3"></a><h4>  Touch interfaces </h4><br>  To begin, consider the human sensitivity to touch screen delays. <br><br>  Researchers test this with tests that determine exactly what kind of delay users perceive.  First, the subjects are offered an interface that has (say) a delay of 1 ms, and then (say) 70 ms, and is asked to perform operations like pressing a button.  If an interface of 70 ms consistently shows a worse result than an interface of 1 ms, then 70 ms is called a "noticeable difference." <br><br>  <font color="gray"><b>Minimal noticeable difference</b></font> <font color="gray"><br></font>  <font color="gray">For details on the minimum noticeable delay difference and the associated experimental installations, see, for example, <a href="https://scholar.google.com/scholar%3Fcluster%3D8942755275099535739">this paper</a> .</font> <br><br>  The minimum noticeable difference is the budget, after which the concrete operation will start to feel slow for the user. <br><br>  For example, when dragging items on the screen, users perceive delays of only ~ 2 ms.  The least noticeable delay depends on the user and the action taken, but it is always very low. <br><br>  <font color="gray"><b>Perception of delay while dragging</b></font> <font color="gray"><br></font>  <font color="gray"><a href="https://scholar.google.com/scholar%3Fcluster%3D8942755275099535739">A perception report of 2‚Äì16 ms when dragging with the stylus</a> .</font> <font color="gray"><br></font>  <font color="gray"><a href="https://scholar.google.com/scholar%3Fcluster%3D17905801937419740410">2‚àí11 ms when dragging with your finger</a> .</font> <font color="gray"><br></font>  <font color="gray"><a href="https://scholar.google.com/scholar%3Fcluster%3D16992791481343673285">An average of 11 ms when dragging with your finger</a> .</font> <br><br>  Similar results were obtained when drawing with the stylus on the tablet.  Here, researchers suggested users notice a delay of 20 to 80 ms.  In our own unofficial tests, a delay of about 80 ms is perceived as very noticeable, and it takes something much closer to 20 ms to make the stylus seem responsive during handwriting. <br><br>  <font color="gray"><b>Perception delay stylus</b></font> <font color="gray"><br></font>  <font color="gray"><a href="https://scholar.google.com/scholar%3Fcluster%3D8942755275099535739">Report on the perception of the delay 10‚àí70 ms when writing with a stylus</a> .</font> <font color="gray"><br></font>  <font color="gray"><a href="https://scholar.google.com/scholar%3Fcluster%3D15159574178009198437">21‚Äì82 ms for various actions with the stylus</a> .</font> <br><br>  The difference between low and high latency handwriting is obvious when comparing: <br><br>  <i><font color="gray">Left: iPad Pro and Notes application with a latency of about 15 ms.</font></i>  <i><font color="gray">Right: Samsung S3 and OneNote application with a delay of about 70 ms.</font></i>  <i><font color="gray">Video is slowed down 16 times.</font></i> <br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://www.inkandswitch.com/media/slow-software/inking-side-by-side.mp4" type="video/mp4"></video></div></div></div><br>  Another typical operation on touch devices is clicking on buttons or links.  Here, tests have determined that users notice a delay of approximately 70 ms at the turn (although for some individual users it is probably lower). <br><br>  <font color="gray"><b>Perception of delayed tapping the screen</b></font> <font color="gray"><br></font>  <font color="gray"><a href="https://scholar.google.com/scholar%3Fcluster%3D16992791481343673285">This study</a> revealed an average minimum distinguishable delay of 69 ms.</font> <br><br>  Here is an example comparing two different delays: <br><br>  <i><font color="gray">Left: opening the settings tab on the iPhone 6s with a delay of about 90 ms.</font></i>  <i><font color="gray">Right: switch settings on the Samsung S3 with a delay of about 330 ms.</font></i>  <i><font color="gray">Video is slowed down 16 times.</font></i> <br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://www.inkandswitch.com/media/slow-software/settings-tap.mp4" type="video/mp4"></video></div></div></div><br>  How do modern applications meet these thresholds?  If we talk about dragging with your finger, then no commercial system can consistently correspond to a delay of several milliseconds to satisfy all consumers. <br><br>  <font color="gray"><b>Drag and Drop performance</b></font> <font color="gray"><br></font>  <font color="gray">As we will see below, even displays and equipment for data entry do not fit into the budget of 10 ms, not to mention several layers of software.</font> <br><br>  Thus, when using all current touchscreen operating systems, at least some of the users will feel that the object is lagging behind the finger while dragging. <br><br>  When drawing with a stylus, a small number of systems approach an acceptably low level of latency.  But most of them are much higher than these values, which is expected by users as a significant delay: <br><br>  Below are the results of the Ink &amp; Switch tests on the delay in drawing with a stylus on a tablet for various devices.  Average delays, measured from contact with the screen before the beginning of the color change of the corresponding pixel, are rounded to the nearest 5 ms. <br><br><table><tbody><tr><th>  Device </th><th>  Program </th><th>  Delay (ms) </th></tr><tr><td>  iPad Pro </td><td>  Notes </td><td>  20 </td></tr><tr><td></td><td>  GoodNotes </td><td>  thirty </td></tr><tr><td></td><td>  Flutter </td><td>  35 </td></tr><tr><td>  Surface pro </td><td>  Onenote </td><td>  25 </td></tr><tr><td></td><td>  Sketchpad </td><td>  thirty </td></tr><tr><td></td><td>  Canvas </td><td>  60 </td></tr><tr><td>  Pixelbook </td><td>  Squid </td><td>  40 </td></tr><tr><td></td><td>  Canvas </td><td>  60 </td></tr><tr><td>  Samsung S3 </td><td>  Squid </td><td>  60 </td></tr><tr><td></td><td>  Flutter </td><td>  65 </td></tr><tr><td></td><td>  Canvas </td><td>  75 </td></tr><tr><td></td><td>  Liveboard </td><td>  80 </td></tr></tbody></table><br>  Although we have no data on delays on all devices, but we assume that they are comparable with the stylus drawing delays observed above. <br><br>  <font color="gray"><b>Drawing delays versus pressing delays</b></font> <font color="gray"><br></font>  <font color="gray">We expect that these delays are comparable, because in both cases touch input is used, that is, the screen refresh cycle is activated.</font>  <font color="gray">However, there are some differences, so the values ‚Äã‚Äãare unlikely to be exactly the same.</font> <br><br>  Since here there is a delay of about 70 ms, most systems are able to respond well to depression.  But it is also easy to find applications that work much worse than the theoretical capabilities of the system. <br><br>  In general, sensory systems should have very low delays so that they feel responsive.  Most devices and applications are not able to provide this level of performance, and, therefore, they all feel at different degrees slow for users. <br><br><a name="4"></a><h4>  Keyboard </h4><br>  There is some evidence that the increase in typing delays worsens users. <br><br>  <font color="gray"><b>Effect of input delay</b></font> <font color="gray"><br></font>  <font color="gray">In <a href="https://scholar.google.com/scholar%3Fcluster%3D15159574178009198437">this study,</a> random delays were added to the keystrokes, which reduced input performance.</font>  <font color="gray">However, it evaluated only one range of delays.</font>  <font color="gray">In addition, the study authors suggest that experienced typesetters can adapt to increased latency.</font> <br><br>  However, we do not know about studies that specifically measure the least noticeable input delays.  A touch delay on the touch screen (noticeable at about 70 ms) can be a useful guide, because it also measures the time between a discrete finger touch and a visual screen update. <br><br>  Below are some informal measurements of the pass-through delay of the keyboard from the start of a keystroke to the appearance of a symbol on various machines.  Sources: <a href="https://danluu.com/input-lag/">‚ÄúComputer Delay: 1977‚àí2017‚Äù</a> , tests Ink &amp; Switch. <br><br><table><tbody><tr><th>  Computer </th><th>  Delay (ms) </th></tr><tr><td>  Apple IIe </td><td>  thirty </td></tr><tr><td>  Commodore Pet 4016 </td><td>  60 </td></tr><tr><td>  iMac g4 OS 9 </td><td>  70 </td></tr><tr><td>  Macbook Pro 2014 </td><td>  100 </td></tr><tr><td>  Custom Haswell-e 24Hz </td><td>  140 </td></tr><tr><td>  Samsung S3 </td><td>  150 </td></tr><tr><td>  Powerspec g405 Linux </td><td>  170 </td></tr><tr><td>  Symbolics 3620 </td><td>  300 </td></tr></tbody></table><br>  Accurate measurements of the assessment of the effects of keyboard delays would be a great experiment for adventurous researchers.  In any case, it seems likely that for many users the threshold value for a noticeable delay when entering from the keyboard is below 100 ms.  Perhaps much lower. <br><br><a name="5"></a><h4>  Mouse </h4><br>  The last type of input devices in our review.  <a href="https://link.springer.com/chapter/10.1007/978-3-319-58475-1_4">One experiment</a> made it possible to determine that users perceive mouse delay from 34 to 137 ms with an average value of 65 ms. <br><br>  Different mice have very different delay values.  Some systems show values ‚Äã‚Äãless than 10 ms by combining high-performance equipment with careful low-level programming ( <a href="https://link.springer.com/chapter/10.1007/978-3-319-58475-1_4">an</a> installation with a delay of about 8 ms <a href="https://link.springer.com/chapter/10.1007/978-3-319-58475-1_4">is</a> described <a href="https://link.springer.com/chapter/10.1007/978-3-319-58475-1_4">here</a> ).  In addition, it is possible to go beyond 100 ms with a combination of mediocre hardware and applications that introduce additional delays, or buffers between the mouse and the display. <br><br><a name="6"></a><h4>  Applications </h4><br>  Application-level delays measure how long it takes to perform specific application actions, such as loading web pages.  An example of such a delay is loading the NYTimes webpage, which takes about 3000 ms. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://www.inkandswitch.com/media/slow-software/nytimes-load.mp4" type="video/mp4"></video></div></div></div><br>  When does application activity seem fast?  It is difficult to say for sure, because their actions are more complex and diverse than simple data entry.  Probably, the answer also depends on user expectations (at present, people usually work with slower software).  But we can calculate the approximate number. <br><br>  <font color="gray"><b>Delay literature</b></font> <font color="gray"><br></font>  <font color="gray">See a <a href="https://scholar.google.com/scholar%3Fcluster%3D15646007677492381636">review of the literature</a> on the effect of latency on users of different applications.</font>  <font color="gray">This is a good starting point for a deeper dive into the subject.</font> <br><br>  One of the reference values ‚Äã‚Äãis a typical metric of 70 ms, as mentioned above, the least noticeable delay when the screen is pressed.  If you notice a delay between clicking the link and displaying the click indicator, you should notice a similar delay between clicking and opening the web page. <br><br>  Another reference value is <a href="https://developers.google.com/web/fundamentals/performance/rail">the Google RAIL model</a> for developers.  Although the authors of this model do not substantiate their assertions, however, the model claims that the response within 100 ms ‚Äúfeels like an instant‚Äù, and the higher delay ‚Äú[breaks] the link between action and reaction‚Äù. <br><br>  You can unofficially check your own sensitivity in the terminal.  Take your favorite command line programs and run them with the 'time' parameter, which measures the execution time.  You will surely notice the difference between the responses in 15 ms (great!) And 500 ms (obviously slow). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ea/71d/b46/6ea71db46fe39835f37416fe5a90a260.png"><br><br>  As an end reference point, we take into account that the typical human response time to a visual stimulus is <a href="http://biae.clemson.edu/bpc/bp/Lab/110/reaction.htm">about 220 ms</a> . <br><br>  This value is significantly greater than the noticeable delay, because the reaction includes not only observation, but also subsequent action. <br><br>  It is also necessary to take into account the <a href="https://scholar.google.com/scholar%3Fcluster%3D3612836859261052030">conclusions of some researchers</a> that a person is able to perceive an increase in delay at an unconscious, physiological level. <br><br><h4>  Real applications </h4><br>  How do real applications match these landmarks?  Some cope.  For example, many Unix command line programs run faster than 100 ms. <br><br>  But most of the Internet applications are out of range.  Google search in about 1000 ms is much faster than most web applications, but it is still noticeably slower compared with the interaction of less than 100 ms on the command line.  And it's easy to find examples of pages that load longer than 5000 ms even on a good mix. <br><br>  In the case of mobile and desktop computers, there are some applications that consistently demonstrate a delay of less than 100 ms, such as the built-in calculator on iOS.  But it is easy to find examples of applications that significantly exceed this threshold, even if they have all the data available (or should be) locally.  Consider the Slack example. <br><br>  The video below shows that switching between two small-sized channels in the same workspace on the iPad Pro takes about 220 ms, although there is no need for network calls, and the iPad Pro is possibly the highest-performing mobile device in the world (video is slowed down 8 times ): <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="https://www.inkandswitch.com/media/slow-software/slack-select.mp4" type="video/mp4"></video></div></div></div><br>  It is difficult to make a general conclusion for all programs in such a wide area as delayed action.  However, it seems obvious that some applications perform actions fairly quickly and seem instant to users (less than 100 ms), but many applications do not. <br><br><a name="7"></a><h1>  Where does the slowdown come from </h1><br>  Thus, we have established that many programs are actually slow.  Where does all this time go and what can we optimize?  Consider this question, starting with the first component in the chain: input devices. <br><br><a name="8"></a><h4>  Input device </h4><br>  The first step in the pipeline that converts the physical input data into updates on the screen is the processing of the input data: converting a contact with a touch screen, keyboard, or mouse into a digital signal for the operating system.  Here we look at how long this step takes. <br><br>  Let's start with the keyboards.  The table shows the measured delays from the start of a key press to a signal on a USB hub, rounded to 5 ms ( <a href="https://danluu.com/keyboard-latency">source</a> ). <br><br><table><tbody><tr><th>  Keyboard </th><th colspan="2">  Delay (ms) </th></tr><tr><td>  Apple magic </td><td>  15 </td></tr><tr><td>  Das 3 </td><td>  25 </td></tr><tr><td>  Kinesis freestyle2 </td><td>  thirty </td></tr><tr><td>  Ergodox </td><td>  40 </td></tr><tr><td>  Kinesis advantage </td><td>  50 </td></tr><tr><td>  Logitech MK360 </td><td>  60 </td></tr></tbody></table><br>  As you can see, these keyboards easily select tens of milliseconds from the budget at the very first step in the processing pipeline.  This is from a total budget of 100 ms or less!  Much more detail about this topic is covered in the article <a href="https://pavelfatin.com/typing-with-pleasure">"Printing with pleasure</a> . <a href="https://pavelfatin.com/typing-with-pleasure">"</a> <br><br>  Mice likewise take tens of milliseconds from the budget.  Although the most high-performance gaming mice have a delay of less than 10 ms.  Data on the response to pressing differ, here too, individual instances show a result of less than 10 ms ( <a href="https://www.gamersnexus.net/guides/2594-wireless-mouse-click-latency-analysis-vs-wired">example</a> ). <br><br>  In mobile devices, it is more difficult to measure the fraction of the delay that is incurred on input devices, because they are tightly integrated with other hardware components.  However, we can use some of the common patterns in input device equipment to evaluate their latency, as well as stand-alone devices. <br><br><a name="9"></a><h4>  Sampling frequency </h4><br>  One of the common patterns is the sampling rate.  In many input devices, equipment ‚Äúscans‚Äù or ‚Äúsamples‚Äù input at a periodic interval.  For example, a typical consumer touchscreen operates at a frequency of 60 Hz, that is, it polls sensors approximately every 17 ms.  This means that in the worst case, the delay of the input device will be at least 17 ms, and on average no more than 8 ms. <br><br>  Other things being equal, a higher scanning frequency will reduce the input delay.  For example, Apple's advanced touchscreens and styluses operate at frequencies above 60 Hz (information from the <a href="https://developer.apple.com/library/archive/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/Displays/Displays.html">Apple documentation archive</a> ). <br><br><table><tbody><tr><th>  Device </th><th>  Touchscreen (Hz) </th><th>  Stylus (Hz) </th></tr><tr><td>  iPhone 6 </td><td>  60 </td><td></td></tr><tr><td>  iPhone 7 </td><td>  60 </td><td></td></tr><tr><td>  iPhone 8 </td><td>  60 </td><td></td></tr><tr><td>  iPhone X </td><td>  120 </td><td></td></tr><tr><td>  iPad Air 2 </td><td>  60 </td><td></td></tr><tr><td>  iPad Mini 4 </td><td>  60 </td><td></td></tr><tr><td>  iPad Pro </td><td>  120 </td><td>  240 </td></tr></tbody></table><br>  A similar source of delay is USB polling.  The USB protocol receives input from the keyboard, so the keyboard needs to wait for a USB poll to send information about the presses.  Low-speed USB polling operates at 125 Hz, introducing the inevitable ~ 8 ms max.  and ~ 4 ms of average delay.  Later versions of USB scan with a frequency of 1000 Hz or more, minimizing the effect of delay. <br><br>  There are many other potential sources of delay in input devices, for example, contact bounce (for more details, see the article <a href="https://summivox.wordpress.com/2016/06/03/keyboard-matrix-scanning-and-debouncing/">‚ÄúScanning the Keyboard Matrix and Contact Bounce‚Äù</a> on the software and hardware effects of bounce). <br><br>  We will not consider all these nuances here, but we emphasize the main point: a) the input devices themselves can cause a considerable delay before any processing takes place in the software;  b) this may be due to several discrete reasons, and the time delay is added up. <br><br><a name="10"></a><h4>  Displays and GPUs </h4><br>  The hardware at the other end of the pipeline is displays and video cards. <br><br>  One of the sources of delay here is the frame rate of the display.  Since displays cannot be redrawn continuously, this leads to an inevitable delay, similar to the polling of input devices described above.  If the screen is updated (say) every 20 ms, then it adds a 20 ms delay in the worst case and 10 ms on average. <br><br>  <font color="gray"><b>Motion perception</b></font> <font color="gray"><br></font>  <font color="gray">Other factors influence our perception of objects moving on the screen.</font>  <font color="gray"><a href="https://www.blurbusters.com/">Blur Busters</a> is a great resource on this topic.</font>  <font color="gray">For example, see <a href="https://www.blurbusters.com/faq/lcd-motion-artifacts/">LCD Motion Artifacts 101</a> .</font> <br><br>  Most displays operate at 60 Hz, although professional devices and game displays operate at 120 Hz, 144 Hz and 240 Hz.  Thus, only the frame rate of the display usually adds about 8 ms to the delay, although in displays with the highest frame rate it can be reduced to a few milliseconds. <br><br>  Another contribution to the delay from displays is the time it takes to physically change the color of pixels after receiving new data.  This time ranges from a few milliseconds in high-end gaming displays to double-digit values ‚Äã‚Äãin less responsive LCD displays. <br><br>  <font color="gray"><b>Display response time</b></font> <font color="gray"><br></font>  <font color="gray">This parameter is difficult to measure, but some illustrative data is available on the <a href="https://www.notebookcheck.net/">Notebook Check</a> website.</font>  <font color="gray">For example, see the example of <a href="https://www.notebookcheck.net/Google-Pixelbook-Chromebook-Review.262418.0.html">slow</a> and <a href="https://www.notebookcheck.net/Asus-ROG-Chimera-G703GI-i9-8950HK-GTX-1080-Full-HD-Laptop-Review.308366.0.html">fast</a> displays.</font> <br><br>  On modern high-end devices, the display is connected to a special graphics processor (GPU).  GPUs create an array of pixels to display, for example, by composing 2D layers or rendering 3D virtual scenes.  Graphic processors produce frames at a rate that depends on the GPU hardware, interaction with the application and the platform code, and sometimes from the logic of synchronization with the displays. <br><br>  A related problem occurs when the application code is very slow and does not send instructions to the GPU fast enough to make full use of it.  This can lead to the fact that the graphics processor will create unique frames at a lower speed than if it really had frequent instructions from the application.  This is a common source of lags that we see in 2D applications that display less than 60 frames per second. <br><br>  <font color="gray"><b>Lagi</b></font> <font color="gray"><br></font>  <font color="gray">Lags like 'jank' are difficult to describe in words, but they are easily recognizable.</font>  <font color="gray">Nathan Gitter in the <i><a href="https://medium.com/%40nathangitter/designing-jank-free-apps-9f66d43b9c87">Designing Jank-Free Apps</a></i> article defines them as "visual faults that are unexpected or distracting."</font> <br><br><a name="11"></a><h4>  Overlay cycles </h4><br>  We discussed at least three parts of the pipeline where a delay occurs due to periodic activity: input scanning, GPU rendering cycles, and display refresh cycles.  It is important to note that they can be combined in such a way that in fact all delays are added: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/594/148/e7b/594148e7bc9e3eba7a9084eb689e7996.png"><br>  <i><font color="gray">Waiting for several cycles.</font></i>  <i><font color="gray">The hypothetical delay cascade shows how waiting for consecutive hardware cycles can accumulate latency.</font></i>  <i><font color="gray">Dotted vertical lines indicate the cycles that the pipeline should expect.</font></i> <br><br>  To proceed to the next step in the pipeline, we must wait for the next cycle.  And the cycles may not be aligned with each other.  Inconsistent cycles and an unfavorable initial entry time can cause an additional delay of 10 milliseconds.  This is a large amount compared to the latency budgets described above. <br><br><a name="12"></a><h4>  Runtime overhead </h4><br>  On the software side, execution time delays are inherent in operating systems and other code that is not directly related to the application.  Consider two important examples: garbage collection and scheduling. <br><br>  First comes the garbage collection (GC).  GC is crucial in the two most widely used platforms in the world: the web (JavaScript) and Android (Java). <br><br>  In some cases, garbage collection can lead to a large delay, especially regarding the requirements for low input delay.  For JavaScript or Java environments, delays in garbage collection on the order of 10 ms are not surprising.  But this is completely the entire budget for dragging and dropping objects on the touch screen! <br><br>  Garbage collection can delay just one frame.  But as is the case with lags due to frame loss, such jerks annoy users. <br><br>  There are ways to reduce GC latency.  They include moving as much of the GC work as possible beyond the limits of the main flow, as well as optimizing the GC operation only in small separate pauses.  See, for example, the <a href="https://v8project.blogspot.com/2016/04/jank-busters-part-two-orinoco.html">efforts of V8</a> to move as much garbage collection operations as possible beyond the limits of the main flow and the <a href="https://blog.golang.org/ismmkeynote">efforts of the Go developers</a> to ensure that the maximum GC lags are significantly less than 1 ms. <br><br>  There is another option to use a programming language that partially sacrifices the convenience of the GC, but has more predictable performance.  Languages ‚Äã‚Äãlike Swift avoid arbitrary garbage collection using <a href="https://docs.swift.org/swift-book/LanguageGuide/AutomaticReferenceCounting.html">automatic reference counting</a> . <br><br>  Another potential source of overhead is scheduling in the operating system.  Our application (and its OS dependencies) do not necessarily work all the time.  Other programs can be scheduled for launch, and ours are forcibly suspended, albeit for a very short time.  Each program asks for time, and the number of processor cores is limited. <br><br>  A CPU load is associated with a dispatch issue.  If your application meets its performance goals, but it requires almost 100% of computing resources, this may well annoy users.  The battery consumption will increase, the device will heat up and, probably, will start to make noise with the fan.  In other words, other things being equal, low CPU utilization is better for the user. <br><br><a name="13"></a><h4>  Intentional delay </h4><br>  A typical source of delays in mobile interfaces is the design of the OS itself and applications.  There are some important interactions that can be accomplished only by real expectation. <br><br>  Android and iOS largely use ‚Äúlong press‚Äù to access the context menu.  They require the user to wait hundreds of milliseconds to execute the command. <br><br>  Delays are associated with this to eliminate ambiguities.  For example, in mobile Safari there is a default delay of 350 ms between when the user clicks on the link and when the browser starts loading a new page.  This is necessary to determine the difference between clicking on a link and double-tapping (zoom).  For details on this particular delay, see <a href="https://webkit.org/blog/5610/more-responsive-tapping-on-ios/">here</a> .  There's also information about the latest changes that allow application developers to get around this problem. <br><br><a name="14"></a><h4>  Hostile agents </h4><br>  A common source of latency for users on the Internet is malicious activities, such as activity trackers, that track user activity and download intrusive ads. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58f/f84/2df/58ff842df940c60f2b1514da3aae733a.png"><br>  <i><font color="gray">An article of 500 words on the Washington Post site requires about a hundred HTTP requests and loads approximately 4400 ms.</font></i>  <i><font color="gray">Many requests are needed for trackers and ads.</font></i>  <i><font color="gray">Shown a small part of them</font></i> <br><br>  There are many great articles about obesity on the web: see <a href="https://pxlnv.com/blog/bullshit-web/">The Bullshit Web</a> , <a href="https://habr.com/post/278655/">‚ÄúThe Crisis of Obesity Websites‚Äù</a> , <a href="https://danluu.com/web-bloat/">Web bloat</a> , etc. <br><br>  We simply emphasize that the biggest source of delay on many sites is the loading of any nonsense against the desire of users. <br><br><a name="15"></a><h4>  Application code </h4><br>  The last source of the delay that we mention is perhaps the most obvious one: this is the application itself.  If an application spends a lot of processor time processing input or performing an action, it will be slow. <br><br><a name="16"></a><h4>  Putting it all together </h4><br>  Consider an example of what makes up the total delay: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/70f/12c/599/70f12c5998fbdb26514bd662cece660f.png"><br>  <i><font color="gray">A hypothetical example of pass-through delay from input to display on screen.</font></i>  <i><font color="gray">Dotted vertical lines indicate the cycles that the conveyor should expect.</font></i> <br><br>  The above example is hypothetical, but indicative.  It demonstrates how many layers add latency, so the application can be quite slow, even if it runs at full frame rate. <br><br><a name="17"></a><h1>  To fast software </h1><br>  For the response of the modern computer interface to the actions of the user meets a deep stack of technologies.  Even a simple keystroke on the keyboard and the appearance of the corresponding character in the text input field is an operation that goes through a lengthy complex sequence of steps: from scanning the keyboard, through the OS processing layers and the framework, through rendering the video card and the display refresh rate. <br><br>  There is a reason for such complexity, and yet we are sad that computer users who are trying to work productively, so often stay on hold, watching the hourglass icon and feeling that their devices simply do not keep up with them. <br><br>  We believe that fast software empowers users and makes them more productive.  ,      ,  ,     . ,            . <br><br><a name="18"></a><h1>  Literature </h1><br> 1. , , , . <a href="https://scholar.google.com/scholar%3Fcluster%3D10535754908454057825">¬´      ¬ª</a> , <i>Proceedings of the USENIX 2nd Symposium on Operating Systems Design and Implementation</i> , 1996. <br><br> 2. , , , , . <a href="https://scholar.google.com/scholar%3Fcluster%3D8942755275099535739">¬´  :       ¬ª</a> , <i>Proceedings of the 32nd Annual ACM Conference on Human Factors in Computing Systems</i> , 2014. <br><br> 3. , , , , . <a href="https://scholar.google.com/scholar%3Fcluster%3D17905801937419740410">¬´    -   ¬ª</a> , <i>Proceedings of the 25th Annual ACM Symposium on User Interface Software and Technology</i> , 2012. <br><br> 4. , , , . <a href="https://scholar.google.com/scholar%3Fcluster%3D16992791481343673285">¬´  ?           -¬ª</a> , <i>Proceedings of the 33rd Annual ACM Conference on Human Factors in Computing Systems</i> , 2015. <br><br> 5. , , , , . <a href="https://scholar.google.com/scholar%3Fcluster%3D15159574178009198437">¬´    ?     ¬ª</a> , <i>Proceedings of Graphics Interface 2014</i> , 2014. <br><br> 6. , , , . <a href="https://link.springer.com/chapter/10.1007/978-3-319-58475-1_4">¬´  100 ?        ¬ª</a> , <i>Engineering Psychology and Cognitive Ergonomics: Cognition and Design</i> , 2017. <br><br> 7. , . <a href="https://scholar.google.com/scholar%3Fcluster%3D15646007677492381636">¬´40       ¬ª</a> , <i>Interacting with Computers</i> , 2011. <br><br> 8. -, , , , . <a href="https://scholar.google.com/scholar%3Fcluster%3D3612836859261052030">¬´           ¬ª</a> , <i>38th International ACM SIGIR Conference on Research and Development in Information Retrieval</i> , 2015. </div><p>Source: <a href="https://habr.com/ru/post/431282/">https://habr.com/ru/post/431282/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431272/index.html">The optimal temperature in the house or how to install the thermostat in the far room without wires</a></li>
<li><a href="../431274/index.html">Himself Santa Claus: As a developer of the application to earn maximum during the holiday period?</a></li>
<li><a href="../431276/index.html">Why Intel processors consume more than expected: requirements for heat sink and turbo mode</a></li>
<li><a href="../431278/index.html">In the robotic car you can get pumped up - but there is a solution for this problem.</a></li>
<li><a href="../431280/index.html">Night Sight: how Pixel phones are seen in the dark</a></li>
<li><a href="../431284/index.html">Centenary Holivar: creativity versus usability</a></li>
<li><a href="../431286/index.html">Forgotten Fraud: The World Power Systems Scam</a></li>
<li><a href="../431288/index.html">The battle for consumer check: an analysis of Walmart and Amazon</a></li>
<li><a href="../431290/index.html">Black Friday week at Madrobots 2: three days time</a></li>
<li><a href="../431292/index.html">Implement GTD based on new Google Keep and Calendar features</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>