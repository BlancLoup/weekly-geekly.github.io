<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Almost linear increase in bzip2 performance on multiprocessor systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Linux often uses gzip and bzip2 compression. They both provide good tightness and are comfortable to use. In this case, bzip2 compresses most files mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Almost linear increase in bzip2 performance on multiprocessor systems</h1><div class="post__text post__text-html js-mediator-article"> Linux often uses gzip and bzip2 compression.  They both provide good tightness and are comfortable to use.  In this case, bzip2 compresses most files more efficiently - but, on the other hand, it works slower than more traditional gzip or zip. <br><br>  But you can get the effectiveness of bzip2, while significantly increasing the speed.  This is a <a href="http://compression.ca/pbzip2/">pbzip2</a> - Parallel BZIP2 utility.  In the usual case, when using bzip2, only one processor core is involved, while on modern systems there may be 2, 4, or, for example, 8. <br><br>  Pbzip2 can use several processor cores at once, which, according to the authors, leads to an almost linear increase in performance.  The compressed files that pbzip2 creates are fully compatible with <b>bzip2 1.0.2</b> and newer versions of bzip2 (there is also a <a href="http://www.zlib.net/pigz/">pigz</a> utility, which, in turn, is a multithreaded gzip implementation - thanks to <a href="https://habrahabr.ru/users/altexxx/" class="user_link">altexxx</a> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Below is the result of testing the compression rate of a 1000M portion of the SQL file (dd if = dump.sql of = testfile bs = 1M count = 1000) on a computer with two Intel Xeon E5520 processors (4 cores, 8 threads, 2.26 GHz) : <br><br><img src="https://habrastorage.org/storage1/a2da6937/44b24f31/79a22327/2470ce61.png" alt="Test results"><br><br>  As can be seen from the test results, pbzip2, working in 4 threads, is about 3.6 times faster than bzip2, working in one thread - which is almost a linear increase in performance. <br><br>  At the same time, pbzip2, operating in 16 threads, was slower than pbzip2, using 4 threads, probably because of the speed of I / O operations.  See also additional tests <b>in the comments</b> (thanks to <a href="https://habrahabr.ru/users/tristan/" class="user_link">tristan</a> and <a href="https://habrahabr.ru/users/bliznezz/" class="user_link">bliznezz</a> ) - including using the tmpfs-section in RAM. <br><br>  Pbzip2 is used in much the same way as bzip2, but there are some additional functions, such as <b>displaying the progress of</b> an operation as a percentage. <br><br><a name="habracut"></a><br>  To compress a file: <br> <code>pbzip2 -k -p4 filename <br></code> <br>  Where <b>filename</b> is the name of the file.  By default, the compressed file is named the same as the source, but at the end .bz2 is added (that is, in this case, <b>filename.bz2</b> ). <br><br>  The -k option is needed so that pbzip2 does not delete the source after it has finished compressing.  You can also add the -v option to display detailed information, including the progress of the operation as a percentage. <br><br>  The -p option sets the number of threads (in this case, 4). <br><br>  To unzip the file: <br> <code>pbzip2 -dk -p4 filename.bz2 <br></code> <br>  Where <b>filename.bz2</b> is the file name.  By default, the unpacked file is named the same as compressed, but at the end .bz2 is removed (that is, in this case, the <b>filename</b> ). <br><br>  The -d option is needed to decompress. <br><br>  Accordingly, together with the output of detailed information and the progress of the operation, the compression will look like this: <br> <code>pbzip2 -kv -p4 filename <br></code> <br>  And you can unpack the file like this: <br> <code>pbzip2 -dkv -p4 filename.bz2 <br></code> <br>  If you need to compress the whole directory, then, as in the case of gzip and bzip2, a so-called tarball is made (which itself does not have a compression) containing the desired directory, and it is compressed by the necessary utility. <br><br>  In the case of pbzip2, you can do it in one line like this: <br> <code>tar cf myfile.tar.bz2 --use-compress-prog=pbzip2 directory_to_compress/ <br></code> <br>  Or so: <br> <code>tar -c directory_to_compress/ | pbzip2 -c &gt; myfile.tar.bz2 <br></code> <br>  In the second case, respectively, you can also add -p4 (to set the number of threads to be 4). <br></div><p>Source: <a href="https://habr.com/ru/post/134747/">https://habr.com/ru/post/134747/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134741/index.html">Prevent reloading libraries or remake jQuery.html ()</a></li>
<li><a href="../134742/index.html">Debian and Ubuntu remove the jvm oracle and sun implementations from the distros</a></li>
<li><a href="../134743/index.html">Mozilla invites developers to test an experimental version of an app store.</a></li>
<li><a href="../134744/index.html">HTML.next or ideas for HTML6</a></li>
<li><a href="../134746/index.html">Petersburg has identified the best Internet startups in 2011</a></li>
<li><a href="../134751/index.html">Copyright for the Good</a></li>
<li><a href="../134753/index.html">Lua 5.2.0 released</a></li>
<li><a href="../134754/index.html">Google Android Development Tutorial</a></li>
<li><a href="../134755/index.html">US House of Representatives Starts SOPA Discussion</a></li>
<li><a href="../134756/index.html">Portal: No Escape</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>