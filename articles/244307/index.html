<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>REST / CRUD. Am I cooking it wrong? Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In the first part, I began to share my observations about the implementation of HTTP / GET in REST. In this one, let's try to consider ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>REST / CRUD. Am I cooking it wrong? Part 2</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  In the <a href="http://habrahabr.ru/post/242179/">first</a> part, I began to share my observations about the implementation of HTTP / GET in REST.  In this one, let's try to consider the issues of versioning and architecture.  Let's start? <br><a name="habracut"></a><br><h4>  Versioning is something your API is useless without. </h4><br>  Remember past publication? <br>  URL / URN / URI / resource / slug - we have considered all these concepts.  What is more? <br>  All addressing from the first article is synthetic, it has nothing to do with the real project. <br>  <b>THIS IS <u>NOT TO</u> WRITE API!</b> <br>  It is impossible because the URI is completely missing such an important thing as <b>versioning</b> . <br>  Why URI?  Why not a URL?  Why not URN?  Because our API provides access to the states of objects within collections.  Those.  it doesn't matter to us which URL (read ‚Äúon which server‚Äù) or which URN (read ‚Äúwhat kind of backend‚Äù) the object will have, it is important for us to know what version of the object we are using. <br>  The API versioning theme flashes in various sources, but, in my opinion, it is modeled not very well.  It is believed that versioning will allow not to mix different implementations of API (i.e. versions associate with URL / URN). <br>  And now the <b>revelation</b> : And who forbade the daemon (URN) running on the server (URL) serving the collection (resource), version v2, to accept objects of version v1?  From the fact that the object has version v1, has it ceased to be valid?  User object ceased to be a user?  Unclear?  OK.  Let's take it in order. <br><br><h4>  Architecture </h4><br>  From the materials of <a href="https://ru.wikipedia.org/wiki/REST">Wikipedia</a> in the section "REST architecture" there are the following lines: <br><blockquote>  The client can interact not directly with the server, but with an arbitrary number of intermediate nodes.  In this case, the client may not be aware of the existence of intermediate nodes, except for the cases of transfer of confidential information. </blockquote><br>  there is a list of goals that we are trying to achieve <br><blockquote><ul><li>  scalability </li><li>  portability of components </li><li>  ease of change </li><li>  ability to evolve </li></ul><br></blockquote><br>  What did the author want to achieve?  No, "world peace" is understandable, but still ... <br><br>  Let's try to decompose the problem and use the ‚Äútypical‚Äù horizontal scaling solutions: <br><ol><li>  We implement many servers serving client requests via DNS. </li><li>  In each server we have balancing on sets of backends on different internal servers. </li><li>  In each backend from 1 to n collections </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now the question for a million: how the collections communicate with each other?  The logical question is ‚ÄúWHY?‚Äù, But is ready to answer with a ‚Äúsynthetic‚Äù example: <br>  <i>Given</i> : <br><ul><li>  Server # 1 with backend in which there is a collection of users </li><li>  Server # 2 with backend in which there is a collection of groups </li></ul><br>  <i>Task</i> : When adding a user to the groups collection, check that the user is present in the users collection.  When users are received from groups, this user still exists in the users collection, and if not, remove them from the groups collection and not pass information about the user to the user. <br><br>  Let us leave the subtleties of the URL / URN / URI / etc and what is transmitted over them.  The question is how to achieve a consistent state in a distributed system?  The first thing that comes to mind is to use the same REST to the next collection, but where can I get a fault-tolerant server with caching and load balancing ?!  STOP!  So everything is already there!  Take it and use it! <br><br>  Hmm ... ok, we have a scalable http-cluster (yes, I know that this is not a cluster in the strict sense of the word), but what about the versioning?  Moreover, it‚Äôs not rational in a distributed system that supports communication between the participants to make a garden with the stack of the old API (read ‚Äúmake another cluster for less‚Äù).  And, in some cases, drag backends between versions.  For example, in version 2, only the user collection has changed and contacts has been added.  How will groups move to version 2? <br><br><h4>  To critics </h4><br>  Predicting questions, I will try to clarify some points. <br><br>  <b>What is it all about?</b>  <b>What kind of nonsense?</b> <br>  The thing is that versioning is a collection property and not an API.  Otherwise, no scaling. <br><br>  <b>You have a problem in architecture.</b>  <b>It should be something like this: / groups / group_name / users / user_name</b> <br>  Yes, it is, but: <br>  ... as long as the user can be in the same group, otherwise you will have 2 or more URIs returning the same object. <br>  ... as long as the user is obliged to have a group, otherwise you will have to enter fake groups (default, global, system, all - is it really informative?) <br><br>  <b>REST for communications in a distributed system?</b>  <b>Are you out of your mind ?!</b> <br>  Do not worry, I know that ‚Äúwhite people‚Äù for this purpose use asynchronous clustered message brokers over transport channels with a guaranteed band and other delights of corporate systems.  This is a "synthetic" example, and not so bad in 3-5 servers. <br><br>  <b>Is that all you have for versioning?</b> <br>  Oh no!  I just began! <br><br>  PS Friends, at 3:00, which means it's time to sleep.  I ask everyone to speak in comments.  Without your feedback, writing is sooo hard. </div><p>Source: <a href="https://habr.com/ru/post/244307/">https://habr.com/ru/post/244307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244295/index.html">Prospects for data centers</a></li>
<li><a href="../244297/index.html">All-metal line of smartphones Samsung GALAXY A got to Russia</a></li>
<li><a href="../244301/index.html">Some facts about frode</a></li>
<li><a href="../244303/index.html">Digest of Russian programs to support IT startups # 1</a></li>
<li><a href="../244305/index.html">When A / B Testing - Need</a></li>
<li><a href="../244309/index.html">The benefits and harm of deadlines in programming</a></li>
<li><a href="../244311/index.html">Collect the best of two worlds - frameworks and CMS (part 1)</a></li>
<li><a href="../244315/index.html">Connect ("Russia") seminars in Moscow - for those who want to understand what has happened over the past couple of months in the Microsoft ecosystem</a></li>
<li><a href="../244317/index.html">Useful and pleasant for the developer in Mojolicious</a></li>
<li><a href="../244319/index.html">Modeling an object as a whole and as a composition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>