<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to properly explore mobile Trojans at home</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the editor: Today, Roman Unuchek, expert of Kaspersky Lab, an expert on mobile threats, is on the line. 

 This post continues the theme raised b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to properly explore mobile Trojans at home</h1><div class="post__text post__text-html js-mediator-article">  <i>From the editor: Today, Roman Unuchek, expert of Kaspersky Lab, an expert on mobile threats, is on the line.</i> <br><br>  This post continues the theme raised by the <a href="http://habrahabr.ru/users/rootes/" class="user_link">rootes</a> user in the post ‚Äú <a href="http://habrahabr.ru/post/235713/">SMS-virus under Android OS or‚Äú Hello :) You have a photo ...</a> ‚Äù.  I enjoyed reading comments about how viruses differ from Trojans, and how to properly investigate malware.  That's just about the correct study, and I want to talk, as doing this every day for 4 years.  Is it right to run malware on a ‚Äúlive‚Äù device?  Do I have to use a virtual machine?  How not to harm yourself and other users during such experiments?  At the same time let's talk about a specific Trojan Trojan-SMS.AndroidOS.Opfake.a. <br><br>  But perhaps I'll start with the topic, just raised in the original post - as antivirus treats an already infected device.  Our product was not tested, but in vain: the Trojan is quietly detected and removed by the trial version of our product ( <a href="http://bit.ly/1pW0NuZ">link to Google Play</a> ), both now and at the time of the original research (judging by the screenshots, it was September 3).  Proofpik: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/da1/4fd/9a4/da14fd9a4a5c42c693eb8fa1b0db80ad.png"><br><a name="habracut"></a><br>  <b>Treatment</b> <br>  When you click the Delete button, the user is automatically transferred to the device administrators management menu, where the Device Admin rights for the trojan can be canceled.  Then you will go to the menu of removing the malware in the settings. <br><br><img src="https://habrastorage.org/files/5d8/13d/11c/5d813d11c1154aa680bff196b48afe6d.png"><br><br>  As you can see, the process is not fully automated, as it happens on Windows.  Our solution consistently displays the user with the necessary menu items to remove the Trojan and does all the hidden work, but you have to press a couple of buttons: this is Android‚Äôs specificity.  Will an inexperienced user cope with this task?  Well, this is a good reason for the additional protection of the smartphone by this inexperienced user: if the antivirus was installed in advance, the infection simply would not have happened. <br><br>  <b>And what is this Trojan and why not all vendors immediately detected it?</b> <br>  In fact, the AndroidOS.Opfake family of sms Trojans is one of the oldest in our collection: we registered the first representative of this type 3 years ago, in August 2011.  Since then, we have detected more than 8,000 options.  They all have the same goal: to steal money from the user's account by sending SMS to paid short numbers and hiding this activity.  However, options are possible.  The first thing that this particular modification of Opfake.a does is connect to the C &amp; C server, and then executes the command that it will receive from there.  This could be spamming the contact list (Hi-TechFoto itself), sending SMS to premium numbers, stealing the contact list.  Plus, the Trojan can initiate a call to a specified number, block calls to the owner, intercept incoming SMS, and even install another malicious program. <br><br>  An interesting point is that this modification of the Trojan still shows the same <a href="">photo</a> with a cat.  Other modifications even do not do this, performing only hidden malicious operations and showing nothing at all. <br><br>  Now let's talk about why the Trojan was not detected by everyone, and not immediately.  Here is a graph based on information from our product: <br><br><img src="https://habrastorage.org/files/21d/949/787/21d9497877c8462792242a4e47d378c7.png"><br><br>  Here is the number of detections of the program from August 29 to September 1, with a two-hour interval.  As you can see, the main surge of activity took place on August 31, just for that day we detected more than 1800 attacks in Russia, Ukraine, Belarus, Kazakhstan and Uzbekistan.  But this modification of Opfake appeared on August 29 - on Friday evening.  Compared to previous versions of the Trojan, the new one was changed for the sole purpose of circumventing detection techniques with antivirus solutions.  In our case, detection was carried out not by the signature method, but with the help of heuristics - roughly speaking, descriptions of the behavior of the malicious program.  With one such heuristic, one can ‚Äúcover up‚Äù many modifications of the Trojan at once, and this method is more resistant to minor changes in the malicious code. <br><br>  In this situation, it all depends on how quickly the anti-virus company can react to the new attack.  First, the new sample must be somehow captured, secondly, it must be analyzed (manually or automatically), and thirdly, it is necessary to detect and quickly distribute information to customers as an update for the product.  An additional complicating factor was the time of the initial distribution of the Trojan, which was probably specially selected by cybercriminals, taking into account the peculiarities of our work.  But we managed :) <br><br>  <b>How to research</b> <br>  We return to where we started the post.  We investigate malware with all available tools, and choose the right one (whether it is code analysis, emulation, launch on a real device), depending on the circumstances, and taking into account considerable experience.  What can be recommended to those who decide to analyze such a Trojan at home?  The <a href="http://habrahabr.ru/users/rootes/" class="user_link">rootes</a> user <a href="http://habrahabr.ru/users/rootes/" class="user_link">strategy</a> was generally correct: to run a malicious program on a ‚Äúclean‚Äù device without personal data, with an installed SIM card, but without money in the account.  But I would recommend to start using safer methods: <br><br>  ‚Ä¢ Run inside the standard Android emulator.  The most secure method, which also allows you to learn a lot about the functionality of the Trojan.  Some malicious programs, however, track the launch inside virtuals and refuse to work.  But not all. <br>  ‚Ä¢ Run on a real device, without personal data, but <b>without a SIM card</b> and with the Internet turned off.  In the case of this Trojan, this would have done little.  There are rare types of mobile threats that refuse to work on a device without a SIM card installed, thus hiding its real purpose. <br>  ‚Ä¢ Run on a real device, with a SIM card.  The lack of money in the account in this case does not provide a 100% guarantee, I would recommend additionally connecting the operator to block sending SMS to short numbers. <br><br>  As I said above, sending paid SMS is not the only possibility for the Opfake Trojan, so I would not recommend using the third method at home.  You have been warned! <br><br>  <b>Prevention</b> <br>  We have repeatedly <a href="http://habrahabr.ru/company/kaspersky/blog/226397/">said</a> that mobile cybercrime, although it appeared as a species quite recently, is developing much faster than its counterpart on ordinary PCs.  In 2-3 years, Android has gone through the same stages of development from simple viruses to complex malware programs as on regular PCs.  Only on the last it took not a couple of years, but a couple of decades.  An ‚Äúadvanced‚Äù user doesn‚Äôt need to defend himself against such a Trojan - simply don‚Äôt open the message, don‚Äôt click on the dubious links and, of course, don‚Äôt install suspicious programs. <br><br>  What do less experienced users who choose a smartphone instead of the usual mobile phone more and more often?  Indeed, if you at least do not allow the installation of programs from unofficial sources, such a trojan like Opfake.a can already be stopped.  But this does not provide a 100% guarantee, and the evidence of this is the dozens of cases of detection of openly malicious programs on Google Play.  And we are not yet talking about the problems of phishing, about the promotion of dubious software in mobile advertising networks and so on.  So security software on mobile devices is necessary. </div><p>Source: <a href="https://habr.com/ru/post/236603/">https://habr.com/ru/post/236603/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236587/index.html">Google: only 2% of the accounts indicated by the attackers are really working</a></li>
<li><a href="../236593/index.html">Open move. "Finguru" is looking for like-minded people to create a global IT-service</a></li>
<li><a href="../236595/index.html">The rover Curiosity arrived to the main goal of its mission - Mount Sharp</a></li>
<li><a href="../236597/index.html">Little about us</a></li>
<li><a href="../236599/index.html">Western Digital released the world's first 10-terabyte HDD model with helium instead of air</a></li>
<li><a href="../236605/index.html">Vest Project: Acoustic Information Acquired by a Hearing Impaired Person Using Vibration</a></li>
<li><a href="../236615/index.html">Ejabberd 14.x on FreeBSD 10: Installation and Basic Setup</a></li>
<li><a href="../236617/index.html">Teatro.io - a cloud service for demonstrating the results of web development in one click</a></li>
<li><a href="../236627/index.html">An exoskeleton without a heap of iron, or an ex-costume from DARPA</a></li>
<li><a href="../236629/index.html">Skype for Linux version 4.2, which does not require upgrading to a newer one</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>