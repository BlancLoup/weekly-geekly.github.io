<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configuring linked servers: ms sql server and teradata</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I decided to write this article for one simple reason - I did not find detailed instructions for setting up a remote linked server between the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configuring linked servers: ms sql server and teradata</h1><div class="post__text post__text-html js-mediator-article">  Hello!  I decided to write this article for one simple reason - I did not find detailed instructions for setting up a remote linked server between the teradata and ms sql server servers. <br><br>  Sberbank data is stored on different servers: oracle, teradata, mssql.  Often (sometimes several times a day), my colleagues and I have to perform actions that are called ‚Äúeffective‚Äù very difficult: write a request, export data to a file, import it into the mssql server, work.  The time spent on one request is more than 3 hours (about 90 million lines). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ku/hg/hi/kuhghiik8oa7l5dtxc6xupaxy0k.jpeg"></div><br>  <em>"Effective work</em> <br><a name="habracut"></a><br>  The reason for such complex actions is the lack of rights to create tables on teradata servers.  That is why we ‚Äúfill in‚Äù the data on the ms sql server (everything is fine here with the permissions).  This was the introduction, and now turn to the description of the sequence of actions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>Note</strong> : The instruction was prepared using SQL Server Management Studio 12 and Teradata Client ver 15 (if the Teradata version is lower, for example 14, then additional software should be downloaded from the official site). <br><br>  <strong>Step 1</strong> - Setting up an ODBC connection <br><br>  Go to: <em>Control Panel \ System and Security \ Administration \ ODBC Data Sources</em> <br><br>  In the "User DSN" section, click "Add".  Next, select the driver "Teradata" and fill in the fields. <br><br>  Important: remember the name of the new source.  We still need it. <br><br>  <strong>Step 2</strong> - Linked Server <br><br>  Open Management Studio - Server Objects - Connected Servers - create a linked server. <br><br>  Fields of the ‚ÄúGeneral / General‚Äù section: Linked Server ‚Äî arbitrary name, Provider ‚Äî Microsoft OLE DB Provider for ODBC Drivers, Product Name ‚Äî ServiceNow, Data Source ‚Äî name of the data source that was created in ‚ÄúAction 1‚Äù. <br><br><img src="https://habrastorage.org/webt/-u/on/xo/-uonxodiqdheeqjg3jupsazkr98.jpeg"><br>  <em>Linked server section "General"</em> <br><br>  Fields of the Security / Security section: Remote login - the name of the UZ on the Teradata server, With password - the UZ password on the Teradata server. <br><br><img src="https://habrastorage.org/webt/ki/gb/9a/kigb9awuwvmg9wzbbancrxp_g3m.jpeg"><br>  <em>Related server section "Security / Security"</em> <br><br>  So that no one can log in through a connected server (teradata) under my UZ, I will add a login mapping on the local and remote servers.  Persist. <br><br><img src="https://habrastorage.org/webt/ps/ut/hd/psuthdk8raqmuuarw-tgmfqrbm0.jpeg"><br>  <em>Mapping logins on local and remote servers</em> <br><br>  Open a new request.  We write select * from openquery (SERVICENOW, 'select * from dual') and get an error.  Access closed.  Go ahead. <br><br><img src="https://habrastorage.org/webt/b8/ux/bd/b8uxbdoasvkdcnouwtxvvjpodv8.jpeg"><br>  <em>Error example</em> <br><br>  <strong>Step 3</strong> - SQLEXPRESS and Embedded UZ <br><br>  Go to the SQL Configuration Manager - properties of SQL Server (MSSQLSERVER).  We change the tick to "Use the input built-in ultrasound (Local System)". <br><br><img src="https://habrastorage.org/webt/u6/b9/zf/u6b9zf6afprcuz-n52ayhr_eswe.jpeg"><br>  <em>SQLEXPRESS and embedded KM</em> <br><br>  If you run Management Studio 12 as an administrator, it will work.  We need no administrator.  We continue the setting. <br><br>  <strong>Step 4</strong> - SQLEXPRESS and Network Service <br><br>  Go to the SQL Configuration Manager - properties of SQL Server (MSSQLSERVER).  We change the tick to "Use the built-in UZ (Network Service) for input", but under the <strong>NT Service \ MSSQLSERVER</strong> . <br><br><img src="https://habrastorage.org/webt/qg/xz/kw/qgxzkwexohoiquhseduulcenwak.jpeg"><br>  <em>SQLEXPRESS and Network Service</em> <br><br>  It should be like this. <br><br><img src="https://habrastorage.org/webt/dn/0m/fe/dn0mfe7clnytkarqyt8uroq-xnm.jpeg"><br>  <em>SQL Server Configuration Manager</em> <br><br>  <strong>Step 5</strong> - Component Service <br><br>  win + R - dcomcnfg - computers - properties my computer - default properties tab. <br>  Fill in the example below: <br><br><img src="https://habrastorage.org/webt/bq/6b/qf/bq6bqf-bcxnimeyn_sregevaels.jpeg"><br>  <em>Component service</em> <br><br>  <strong>Step 6</strong> - Configure DCOM <br><br>  win + R - dcomcnfg - computers - my computer - DCOM setting - msdainitialize properties.  Copy Application ID / Application Code.  Required for finding an object in the windows registry. <br><br><img src="https://habrastorage.org/webt/kc/gf/dl/kcgfdl__apgwhulli1yfnffc6zk.jpeg"><br>  <em>Msdainitialize object properties</em> <br><br>  Next win + R - regedit- search.  It is necessary to find an object in the registry, by the application code, and enter its permission / permission. <br><br><img src="https://habrastorage.org/webt/o6/ik/9s/o6ik9svofbp0x2kgi0mekgqsyn8.jpeg"><br>  <em>Msdainitialize object registry</em> <br><br>  Full control for the local PC administrator. <br><br><img src="https://habrastorage.org/webt/lr/lc/pk/lrlcpkkqov7_mpocfrjgzqwmpw4.jpeg"><br>  <em>Properties of the msdainitialize object in the WINDOWS registry</em> <br><br>  Confirm and save.  This was done so that the Security section of the object (application code) becomes active. <br><br><img src="https://habrastorage.org/webt/jv/bj/t-/jvbjt-i9aj7jc2njmjkx5e40i4s.jpeg"><br>  <em>The security section of the msdainitialize object</em> <br><br>  Customize / Settings - Edit (the button has become active) - we add full service to the <strong>NT Service \ MSSQLSERVER</strong> . <br><br><img src="https://habrastorage.org/webt/dw/ts/vk/dwtsvkbiqe_6c8kpcxl-kuvw9xo.jpeg"><br>  <em>Full rights for the MSSQLSERVER service</em> <br><br>  Grant the service the right to in the sections: Launch and Activation Permission, Access Permission, Configuration Permission.  Next, you need to restart the service MSQSQLSERVER - Restart / Restart <strong>NT Service \ MSSQLSERVER</strong> . <br><br>  <strong>Step 7</strong> COM Security / Security COM <br><br>  win + R - dcomcnfg - computers - my computer - DCOM setup <br>  Change the default value by adding the <strong>NT Service \ MSSQLSERVER service</strong> .  Assign it the maximum rights for the sections: Launch and Activation Permission, Access Permission. <br><br><img src="https://habrastorage.org/webt/i9/fo/ml/i9fomlcupgjhloz0e7vcks_abue.jpeg"><br>  <em>Access permission</em> <br><br>  Next, you need to restart the service MSQSQLSERVER - Restart / Restart <strong>NT Service \ MSSQLSERVER</strong> .  Run select * from openquery (SERVICENOW, 'select * from dual').  Works. <br><br><img src="https://habrastorage.org/webt/hq/lb/ug/hqlbugffbalcttxzczvuhe_wexw.jpeg"><br>  <em>Request execution</em> <br><br>  I hope that this manual will help with the settings of the remote access technology.  Now we import the data directly to the mssql server (saving hours and not minutes).  The query, which was previously executed for about 3 hours (exporting data to a file, importing to mssql), after setting up the technology, works out in 47 seconds (importing the result of the query directly to mssql). </div><p>Source: <a href="https://habr.com/ru/post/427437/">https://habr.com/ru/post/427437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427427/index.html">How come to IT: about the interns and the June (the result of a survey of "My Circle")</a></li>
<li><a href="../427429/index.html">GUI frameworks - on stream</a></li>
<li><a href="../427431/index.html">How Android works, part 4</a></li>
<li><a href="../427433/index.html">Balancing traffic in the operator‚Äôs IP networks</a></li>
<li><a href="../427435/index.html">STM32H7 - setting clocking without HAL</a></li>
<li><a href="../427439/index.html">The whole truth about the RTOS. Article # 16. Signals</a></li>
<li><a href="../427441/index.html">Convergence with Kubernetes</a></li>
<li><a href="../427443/index.html">Vivisection success</a></li>
<li><a href="../427447/index.html">GNU Arm Embedded Toolchain appeared in PVS-Studio</a></li>
<li><a href="../427449/index.html">How to understand Tensorflow and not die, but even teach a car something</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>