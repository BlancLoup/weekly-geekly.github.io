<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I intercepted the traffic of the poker room or "Writing my MitM SSL proxy in C #"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once I had an obsession: to see, and what is there such a poker client sends to the server. As you understand, large poker rooms use SSL to transfer d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I intercepted the traffic of the poker room or "Writing my MitM SSL proxy in C #"</h1><div class="post__text post__text-html js-mediator-article">  Once I had an obsession: to see, and what is there such a poker client sends to the server.  As you understand, large poker rooms use SSL to transfer data.  Protocols based on asymmetric encryption are subject to only one type of attack known to me - MitM (Man in the middle - the man in the middle). <br><br>  Having lamented with a ton of software designed to implement MitM on an SSL connection, I came to the conclusion that my hands do not grow from that place either from the developers of these tools or from me.  But the idea was terribly obsessive, and it was decided to do everything manually.  If it is interesting what came of all this, I ask for cat. <br><img src="https://habrastorage.org/getpro/habr/post_images/da9/cde/e8d/da9cdee8d285cc304fdbbe10ac76e66f.jpg"><br><a name="habracut"></a><br>  This article is enlightened by writing a simple tool for implementing MitM attacks.  Those who are not familiar with what MitM is can read about it <a href="http://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B5%25D0%25BB%25D0%25BE%25D0%25B2%25D0%25B5%25D0%25BA_%25D0%25BF%25D0%25BE%25D1%2581%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B5">here</a> . <br><br><h3>  purpose </h3><br>  A <a href="http://www.wincake.com/">Cake Poker</a> client was chosen as the test subject because of my lengthy acquaintance with him.  It all started with the fact that I just started a poker client and got into the good old resource manager, in which I found a dozen connections from him. <br><img src="https://habrastorage.org/getpro/habr/post_images/27c/6cf/e82/27c6cfe82800e7b7f41695035622a259.png"><br>  After experimenting, I was able to isolate the compound that always holds.  I took him on sight for the MitM attack. <br><img src="https://habrastorage.org/getpro/habr/post_images/8fa/109/b0a/8fa109b0a7fb511ab5d6de4c686d1d10.png"><br>  The source of the connection is known, the final goal is known - lb6.playdata.co.uk. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Traffic redirection </h3><br>  Now it was necessary to interpose between the client and the server.  I didn‚Äôt invent anything too clever, because there‚Äôs no need for that - I just added domain names to host that correlated with 127.0.0.1.  It is not difficult to guess that if there is lb6.playdata.co.uk, that is, lb1.playdata.co.uk, and lb8.playdata.co.uk.  I acted with them in the same way, bringing to the host, since  the final instances, as I understand it, are selected by the location of the stars.  When you start the poker client, it hangs waiting for a connection.  Wonderful.  This means that the traffic has been redirected to our typewriter.  Go ahead. <br><img src="https://habrastorage.org/getpro/habr/post_images/e9a/6b0/3df/e9a6b03dfeca220fb12c90c07cc424ae.png"><br><br><h3>  Proxy </h3><br>  The next task was to write a proxy in C #.  Yes, a simple proxy for preparing a future program.  In order not to engage in the invention of the bike, I quickly googled the solution that suits me: <a href="http://loosexaml.wordpress.com/2011/04/27/tcp-proxy-in-c-using-tasks-parallel-library/">TCP Proxy in C # using Task Parallel Library</a> . <br>  I did a bit of refactoring (I hate it when I have a lot of nesting), zahardkodil end point of connection and launched.  I launch the poker client - everything works.  In the resource manager we can see that the traffic from the poker client goes to my proxy, and from it to the server and back. <br><br><h3>  MitM to SSL </h3><br>  Next, we have to implement a MitM-attack on SSL.  We divide it into two stages: the first is connecting the client to the proxy;  the second is a proxy with the server. <br>  To implement the first stage, when the client connects to the proxy, we will not send the incoming data further, but begin the so-called handshake procedure.  In C #, this can be done using an instance of the SslStream class, built on top of the NetworkStream that has already been created.  At the time of creation, information about the protocol and other specific information is transmitted. <br>  After that, we transfer the certificate to the client.  This is done using the AuthenticateAsServer method of the SslStream class, where we must pass the path to the certificate file. <br><br>  The x509 certificate file was generated using the Makecert utility, which can be accessed from the Visual Studio developer console.  I had to suffer a little with the parameters, but everything worked out.  Here is a good description of how it can be used: <a href="http://ishare2learn.wordpress.com/tag/ssl/">SSL communication in C #</a> .  As the name we specify * .playdata.co.uk.  This name covers all domains that are used by the poker client. <br><pre><code class="hljs objectivec">makecert -n CN=MyCA -cy authority -a sha1 -sv ‚ÄúMyCA.pvk‚Äù -r ‚ÄúMyCA.cer‚Äù <span class="hljs-comment"><span class="hljs-comment">//   certmgr -add -all -c ‚ÄúMyCA.cer‚Äù -s -r LocalMachine Root //      makecert -n CN=*.playdata.co.uk -ic MyCA.cer -iv MyCA.pvk -a sha1 -sky exchange -pe -sr currentuser -ss my SslServer.cer //  </span></span></code> </pre> <br>  We generated the server private key and the CA key (identification center), which signed our key.  Key CA is placed in the "Trusted Root Certification Authorities", and voila!  If you look at our server key with Windows key browsing tools, we will see that the system considers it valid, just like the poker client running on our system. <br><img src="https://habrastorage.org/getpro/habr/post_images/c71/50b/1a3/c7150b1a3f7126a8446a34fc8419eb9a.png"><br><br>  We pass the path to the received certificate to the AuthenticateAsServer method.  If everything went well, then we will have an SSL connection from the client to the proxy to which the client will send data.  Now it is necessary to give the client adequate answers to his requests.  To do this, we need to implement the second stage of the MitM-attack, namely to build an SSL connection from the proxy to the server.  We also build SslStream on top of NetworkStream before the server and log in using the AuthenticateAsClient method.  The data coming from the SSL connection between the client and the server is sent to each other. <br><div class="spoiler">  <b class="spoiler_title">C # handshake process</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">var certificate = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> X509Certificate("SslServer.cer", "123"); var clientStream = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SslStream(client.GetStream(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); clientStream.AuthenticateAsServer(certificate, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">Security</span></span>.Authentication.SslProtocols.<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TcpClient("200.26.205.63", <span class="hljs-number"><span class="hljs-number">4520</span></span>); var serverSslStream = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SslStream(<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>.GetStream(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, SslValidationCallback, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); serverSslStream.AuthenticateAsClient("lb3.playdata.co.uk");</code> </pre><br></div></div><br>  After some time of work, it will be possible to notice in the resource manager the difference in the number of bytes sent to and from the proxy.  This is due to the fact that when encrypting different keys give different results in size. <br><img src="https://habrastorage.org/getpro/habr/post_images/2e0/30e/36d/2e030e36d580c262c586320f747acbbe.png"><br><h3>  Conclusion </h3><br>  What next?  And then we will add the code to save the data in a text file so that they can be analyzed by what the poker client sends to the server.  Actually, everything, MitM Proxy is written. <br><br>  It remains to add a little blackjack to it.  For example, for parsing the traffic going through it, pulling out the user's cards and sending it to us, etc. <br>  I wrote a traffic parser on the fly, so that it would be convenient to monitor what the client sends, and relate it to my actions.  Demonstration of what happened with me: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/qiP5B0AlWuw%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700253&amp;usg=ALkJrhgO-QOAPdn9sBXsV6GqhG-Tmf_k0g" frameborder="0" allowfullscreen=""></iframe><br><br><div class="spoiler">  <b class="spoiler_title">Mitm proxy sources</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Diagnostics; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net.Security; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net.Sockets; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Security.Cryptography.X509Certificates; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> ConnectionAnalizer; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">MITMProxy</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> TcpListener Listener = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TcpListener(IPAddress.Any, <span class="hljs-number"><span class="hljs-number">4520</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> BufferSize = <span class="hljs-number"><span class="hljs-number">4096</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Listener.Start(); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Task(() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = Listener.AcceptTcpClient(); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Task(() =&gt; AcceptConnection(client)).Start(); } }).Start(); Debug.WriteLine(<span class="hljs-string"><span class="hljs-string">"Server listening on port 4502. Press enter to exit."</span></span>); Console.ReadLine(); Listener.Stop(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcceptConnection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TcpClient client</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> certificate = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> X509Certificate(<span class="hljs-string"><span class="hljs-string">"SslServer.cer"</span></span>, <span class="hljs-string"><span class="hljs-string">"123"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> clientStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SslStream(client.GetStream(), <span class="hljs-literal"><span class="hljs-literal">false</span></span>); clientStream.AuthenticateAsServer(certificate, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, System.Security.Authentication.SslProtocols.Default, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> server = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TcpClient(<span class="hljs-string"><span class="hljs-string">"200.26.205.63"</span></span>, <span class="hljs-number"><span class="hljs-number">4520</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> serverSslStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SslStream(server.GetStream(), <span class="hljs-literal"><span class="hljs-literal">false</span></span>, SslValidationCallback, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); serverSslStream.AuthenticateAsClient(<span class="hljs-string"><span class="hljs-string">"lb3.playdata.co.uk"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Task(() =&gt; ReadFromClient(client, clientStream, serverSslStream)).Start(); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Task(() =&gt; ReadFromServer(serverSslStream, clientStream)).Start(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { Console.WriteLine(ex.Message); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SslValidationCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslpolicyerrors</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadFromServer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Stream serverStream, Stream clientStream</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> message = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[BufferSize]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> serverBytes; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { serverBytes = serverStream.Read(message, <span class="hljs-number"><span class="hljs-number">0</span></span>, BufferSize); clientStream.Write(message, <span class="hljs-number"><span class="hljs-number">0</span></span>, serverBytes); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (serverBytes == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadFromClient</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TcpClient client, Stream clientStream, Stream serverStream</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> message = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[BufferSize]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInfo(<span class="hljs-string"><span class="hljs-string">"client"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!fileInfo.Exists) fileInfo.Create().Dispose(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stream = fileInfo.OpenWrite()) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> clientBytes; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { clientBytes = clientStream.Read(message, <span class="hljs-number"><span class="hljs-number">0</span></span>, BufferSize); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (clientBytes == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } serverStream.Write(message, <span class="hljs-number"><span class="hljs-number">0</span></span>, clientBytes); memoryStream.Write(message, <span class="hljs-number"><span class="hljs-number">0</span></span>, clientBytes); stream.Write(message, <span class="hljs-number"><span class="hljs-number">0</span></span>, clientBytes); } client.Close(); } } } }</code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/213397/">https://habr.com/ru/post/213397/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213381/index.html">Project Tango from Google: a smartphone with a 3D space scanner</a></li>
<li><a href="../213385/index.html">Tai'Dzen: first steps</a></li>
<li><a href="../213389/index.html">How ServiceStack helps put the development of web services on stream</a></li>
<li><a href="../213391/index.html">Tame ZoG (Part 4: Beware of the Mines!)</a></li>
<li><a href="../213395/index.html">Announcement! DevCon 2014 becomes an international conference</a></li>
<li><a href="../213403/index.html">Applying a Poisson transform for seamless image overlay</a></li>
<li><a href="../213405/index.html">Weather station with Ethernet and tablet as a display device</a></li>
<li><a href="../213411/index.html">Unpacking, editing and packaging of DVR firmware and IP cameras from Xiong Mai</a></li>
<li><a href="../213413/index.html">The trouble with web security or the most secure bank of America</a></li>
<li><a href="../213415/index.html">Google Maps v2 for Android: Pop-up window with full redraw and input event support</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>