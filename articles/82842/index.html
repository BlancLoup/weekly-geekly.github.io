<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TDD for beginners. Answers to popular questions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Source project written using TDD. Visual Studio 2008 / C # 
 The xUnit library is used for writing tests, and Moq is used to create mock objects. 



...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TDD for beginners. Answers to popular questions</h1><div class="post__text post__text-html js-mediator-article">  <a href="">Source project written using TDD.</a>  <a href="">Visual Studio 2008 / C #</a> <br>  The <a href="http://www.codeplex.com/xunit">xUnit</a> library is used for writing tests, and <a href="http://code.google.com/p/moq">Moq</a> is used to create mock objects. <br><br><hr><br><br>  At the next interview, asking about TDD, I came to the conclusion that even the basic ideas of developing through tests are not understood by most developers.  I believe that ignorance of this topic is a big omission for any programmer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I get a lot of questions about TDD.  Of these questions, I chose key questions and wrote answers to them.  The questions themselves can be found in the text, they are in italics. <a name="habracut"></a><br><br>  As a starting point, we will solve a business problem: <br><br>  A task consists of several subtasks: 1) write a console application that sends reports.  2) Every second report generated should also be sent to auditors.  3) If no reports have been generated, then we send a message to the management that there are no reports.  4) After sending all the reports, you need to display in the console the number of sent. <br><br><blockquote>  <i><b>Question: How to start writing code with TDD?</b></i> <br><br>  We start with the fact that we will solve one small problem.  We will describe the business requirement in code using a test. <br></blockquote><br><br>  So, I created a new project of the console application (the final code can be <a href="">downloaded from SVN</a> ).  Now there is not a single line of code in it.  We need to figure out how my application will work.  Attention, the beginning!  Create a test that describes the 4th requirement: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ReporterTests <br> { <br> [Fact] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> ReturnNumberOfSentReports() <br> { <br> <font color="#0000ff">var</font> reporter = <font color="#0000ff">new</font> Reporter(); <br> <br> <font color="#0000ff">var</font> reportCount = reporter.SendReports(); <br> <br> Assert.Equal(2, reportCount); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The <i>Assert</i> class checks whether the number of sent reports is equal to 2. The test is started by the console utility <a href="http://www.codeplex.com/xunit">xUnit</a> , or by some plug-in to Visual Studio. <br><br>  We have just designed our application API.  We will use the <i>Reporter</i> object with the <i>SendReports</i> function.  The <i>SendReports</i> function returns the number of reports sent, this is shown by a test using the Assert.Equal statement.  If the variable reportCount is not equal to 2, then the test will not pass. <br><br>  At the first stage of the design is over, go to the coding.  Let's write a minimum of code to make this test work. <br><br><blockquote>  <i><b>Question: First we need to write a lot of tests, and then fix them one by one?</b></i> <br>  No, we go consistently.  We will not disperse their efforts.  At each time only one idle test.  We will write the code that this test will fix and we can write the next test. <br></blockquote><br><br>  In our project at the moment there is only one class <i>ReporterTests</i> .  It's time to create a tested <i>Reporter</i> class.  Add a <i>Reporter</i> object to the project and create an empty <i>SendReports</i> function for <i>it</i> .  In order for the test to pass, the <i>SendReports</i> function must return the number 2. It is not yet clear how to set the initial conditions in the <i>Reporter</i> object so that the <i>SendReports</i> function <i>returns the</i> number 2. <br><br>  We return to the design.  I think that I will have a separate class for creating reports, and a class for sending reports.  The <i>Reporter</i> object itself will control the logic of the interaction of these classes.  Let's call the first object <i>IReportBuilder</i> , and the second one - <i>IReportSender</i> .  Designed, it's time to write the code: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[Fact] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> ReturnNumberOfSentReports() <br> { <br> IReportBuilder reportBuilder; <br> IReportSender reportSender; <br> <br> <font color="#0000ff">var</font> reporter = <font color="#0000ff">new</font> Reporter(reportBuilder, reportSender); <br> <br> <font color="#0000ff">var</font> reportCount = reporter.SendReports(); <br> <br> Assert.Equal(2, reportCount); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><blockquote>  <i><b>Question: Are there any rules for naming test methods?</b></i> <br>  Yes there is.  It is desirable that the name of the test method indicates that it is testing the test and what result we expect.  In this case, the name tells us: "The number of reports sent is returned." <br></blockquote><br><br>  How the classes that implement these interfaces will work now does not matter.  The main thing is that we can form <i>IReportBuilder</i> all reports and send them using <i>IReportSender</i> . <br><br><blockquote>  <b><i>Question: why it is worth using the IReportBuilder and IReportSender interfaces instead of creating specific classes?</i></b> <br>  You can implement the object for creating reports and the object for sending reports in different ways.  It is now more convenient to hide the future <a href="http://blog.byndyu.ru/2009/12/blog-post.html">implementations of these classes behind the interfaces</a> . <br><br>  <i><b>Question: How to set the behavior of objects with which our test class interacts?</b></i> <br>  Instead of real objects with which our tested class interacts, it is most convenient to use stubs or mock objects.  In the current application, we will create mock objects using the Moq library. <br></blockquote><br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[Fact] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> ReturnNumberOfSentReports() <br> { <br> <font color="#0000ff">var</font> reportBuilder = <font color="#0000ff">new</font> Mock&lt;IReportBuilder&gt;(); <br> <font color="#0000ff">var</font> reportSender = <font color="#0000ff">new</font> Mock&lt;IReportSender&gt;(); <br> <br> <font color="#008000">//     IReportBuilder</font> <br> <font color="#008000">//  : "   CreateReports  List&lt;Report&gt;   2 "</font> <br> reportBuilder.Setup(m =&gt; m.CreateRegularReports()) <br> .Returns( <font color="#0000ff">new</font> <font color="#2B91AF">List</font> &lt;Report&gt; { <font color="#0000ff">new</font> Report(), <font color="#0000ff">new</font> Report()}); <br> <br> <font color="#0000ff">var</font> reporter = <font color="#0000ff">new</font> Reporter(reportBuilder.Object, reportSender.Object); <br> <br> <font color="#0000ff">var</font> reportCount = reporter.SendReports(); <br> <br> Assert.Equal(2, reportCount); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  We run the test - it fails, because we did not implement the <i>SendReports</i> function.  We program the simplest possible implementation: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> Reporter <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> IReportBuilder reportBuilder; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> IReportSender reportSender; <br> <br> <font color="#0000ff">public</font> Reporter(IReportBuilder reportBuilder, IReportSender reportSender) <br> { <br> <font color="#0000ff">this</font> .reportBuilder = reportBuilder; <br> <font color="#0000ff">this</font> .reportSender = reportSender; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> SendReports() <br> { <br> <font color="#0000ff">return</font> reportBuilder.CreateRegularReports().Count; <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  We start the test and it passes.  We have implemented the 4th requirement.  At the same time recorded it in the form of a test.  Thus, we compile the documentation of our system.  As practice has shown - this documentation is the most current at any time and never becomes outdated.  Go ahead. <br><br><blockquote>  <i><b>Question: Is there a standard pattern for writing a test?</b></i> <br>  Yes.  It is called Arrange-Act-Assert (AAA).  Those.  The test consists of three parts.  Arrange (Set) - we make setting the input data for the test.  Act (Act) - perform the action, the results of which are tested.  Assert (Check) - check the execution results.  I will sign the corresponding steps in the next test. <br></blockquote><br><br>  Now we will deal with the first requirement - sending reports.  The test will check that all generated reports are sent: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[Fact] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> SendAllReports() <br> { <br> <font color="#008000">// arrange</font> <br> <font color="#0000ff">var</font> reportBuilder = <font color="#0000ff">new</font> Mock&lt;IReportBuilder&gt;(); <br> <font color="#0000ff">var</font> reportSender = <font color="#0000ff">new</font> Mock&lt;IReportSender&gt;(); <br> <br> reportBuilder.Setup(m =&gt; m.CreateRegularReports()) <br> .Returns( <font color="#0000ff">new</font> <font color="#2B91AF">List</font> &lt;Report&gt; { <font color="#0000ff">new</font> Report(), <font color="#0000ff">new</font> Report()}); <br> <br> <font color="#0000ff">var</font> reporter = <font color="#0000ff">new</font> Reporter(reportBuilder.Object, reportSender.Object); <br> <br> <font color="#008000">// act</font> <br> reporter.SendReports(); <br> <br> <font color="#008000">// assert</font> <br> reportSender.Verify(m =&gt; m.Send(It.IsAny&lt;Report&gt;()), Times.Exactly(2)); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><blockquote>  <i><b>Question: Do I need to write tests for all objects of the application in one test class?</b></i> <br>  Very undesirable.  In this case, the test class will grow to enormous size.  It is best to create a separate test file for each class under test. <br></blockquote><br><br>  We run the test, it does not pass, because we did not implement the sending of reports in the SendReports function.  On this, as usual, we complete the design and proceed to coding: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">int</font> SendReports() <br> { <br> IList&lt;Report&gt; reports = reportBuilder.CreateRegularReports(); <br> <br> <font color="#0000ff">foreach</font> (Report report <font color="#0000ff">in</font> reports) <br> { <br> reportSender.Send(report); <br> } <br> <br> <font color="#0000ff">return</font> reports.Count; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  We run tests - both pass.  We have implemented another business requirement.  In addition, by running both tests, <b>we made sure that we did not break the functionality that we did 5 minutes ago</b> . <br><br><blockquote>  <i><b>Question: How often should I run all the tests?</b></i> <br>  The more the better.  Any change in the code may unexpectedly affect you in other parts of the system.  Especially if this code was not written by you.  Ideally, all tests should be run automatically by the integration system (Continuous Integration) during each build of the project. <br><br>  <i><b>Question: How to test private methods?</b></i> <br>  If you have read this far, you already understand that once the tests are written first and then the code, then all the code inside the class will be tested by default. <br></blockquote><br><br>  It's time to think about how to implement the third requirement.  Where do we start?  Will we draw UML diagrams or just meditate sitting in a chair?  Let's start with the test!  Let's write the 3rd business requirement in the code: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[Fact] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> SendSpecialReportToAdministratorIfNoReportsCreated() <br> { <br> <font color="#0000ff">var</font> reportBuilder = <font color="#0000ff">new</font> Mock&lt;IReportBuilder&gt;(); <br> <font color="#0000ff">var</font> reportSender = <font color="#0000ff">new</font> Mock&lt;IReportSender&gt;(); <br> <br> reportBuilder.Setup(m =&gt; m.CreateRegularReports()).Returns( <font color="#0000ff">new</font> <font color="#2B91AF">List</font> &lt;Report&gt;()); <br> reportBuilder.Setup(m =&gt; m.CreateSpecialReport()).Returns( <font color="#0000ff">new</font> SpecialReport()); <br> <br> <font color="#0000ff">var</font> reporter = <font color="#0000ff">new</font> Reporter(reportBuilder.Object, reportSender.Object); <br> <br> reporter.SendReports(); <br> <br> reportSender.Verify(m =&gt; m.Send(It.IsAny&lt;Report&gt;()), Times.Never()); <br> reportSender.Verify(m =&gt; m.Send(It.IsAny&lt;SpecialReport&gt;()), Times.Once()); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  We start and make sure that the test fails.  Now our efforts are focused on repairing this test.  Here, designing as usual ends and we return to programming: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">int</font> SendReports() <br> { <br> IList&lt;Report&gt; reports = reportBuilder.CreateRegularReports(); <br> <br> <font color="#0000ff">if</font> (reports.Count == 0) <br> { <br> reportSender.Send(reportBuilder.CreateSpecialReport()); <br> } <br> <br> <font color="#0000ff">foreach</font> (Report report <font color="#0000ff">in</font> reports) <br> { <br> reportSender.Send(report); <br> } <br> <br> <font color="#0000ff">return</font> reports.Count; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  We run tests - all 3 tests pass.  We implemented a new function and did not break the old ones.  This is good news! <br><br><blockquote>  <i><b>Question: How to find out what code has already been tested?</b></i> <br>  Code coverage tests can be verified using various utilities.  For a start, I can advise <a href="http://sourceforge.net/projects/partcover/">PartCover</a> . <br><br>  <i><b>Question: Is it necessary to strive to cover the code with tests for 100%?</b></i> <br>  Not.  This requires too much effort to create such tests and even more to support them.  Normal cover ranges from 50 to 90%.  Those.  all business logic should be covered without accessing the database, external services and the file system. <br></blockquote><br><br>  I propose to implement the second requirement for you and share in the comments the final part of the <i>SendReports</i> function and your test.  You will write a test first, right? <br><br><blockquote>  <i><b>Question: How can I test the interaction with the database, work with the SMTP server or the file system?</b></i> <br>  Indeed, it is necessary to test it.  But this is not done by unit tests.  Because the unit tests must pass quickly and not depend on external sources.  Otherwise, you will run them once a week.  For more details, see the article <a href="http://blog.byndyu.ru/2009/04/blog-post.html">‚ÄúEffective modular test‚Äù</a> . <br><br>  <i><b>Q: When can I use TDD?</b></i> <br>  TDD can be used to create any application.  It is very convenient to use it if you are studying the possibilities of a new library or programming language.  There are no special limits in application.  There may be inconvenience with testing multi-threaded and other specific applications. <br></blockquote><br><br><h4>  Conclusion </h4><br><br>  I wish every developer to try this practice.  After that, you can decide how TDD is suitable for you personally and for the project as a whole. </div><p>Source: <a href="https://habr.com/ru/post/82842/">https://habr.com/ru/post/82842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82834/index.html">Reasoning on authentication</a></li>
<li><a href="../82838/index.html">OreObject sells a steel touch ball mouse for $ 155</a></li>
<li><a href="../82839/index.html">Speed ‚Äã‚ÄãReading featuring Text Perception</a></li>
<li><a href="../82840/index.html">Time synchronization via http</a></li>
<li><a href="../82841/index.html">New approaches to validation in Rails 3</a></li>
<li><a href="../82845/index.html">ColorNote. Android application for notes</a></li>
<li><a href="../82846/index.html">Hitachi, Panasonic and Toshiba will delight with new wireless devices</a></li>
<li><a href="../82847/index.html">MythBusters: Truth and Fiction about Flash</a></li>
<li><a href="../82852/index.html">Following the results of the second Minsk StartUp Weekend</a></li>
<li><a href="../82853/index.html">Web Ready Contest through the eyes of a finalist</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>