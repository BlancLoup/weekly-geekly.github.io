<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Guide to writing secure PHP applications in 2018</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The year 2018 is approaching, and techies - in particular, web developers - must reject many of the old techniques and beliefs in the development of s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Guide to writing secure PHP applications in 2018</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/d3/g-/cv/d3g-cvikz3bnqivslphjkykk2z0.jpeg"></div><br><p>  The year 2018 is approaching, and techies - in particular, web developers - must reject many of the old techniques and beliefs in the development of secure PHP applications.  This is especially true for anyone who does not believe that such applications are possible at all. </p><br><p>  This guide is an addition to the <a href="http://www.phptherightway.com/">PHP: The Right Way</a> e-book with a strong emphasis on security, and not general PHP programming issues (such as code style). </p><a name="habracut"></a><br><h2 id="soderzhanie">  Content </h2><br><ol><li>  PHP versions </li><li>  Dependency Management with Composer <br><ul><li>  Featured Packages </li></ul></li><li>  HTTPS and browser security <br><ul><li>  Security headers </li><li>  Subresource Integrity </li><li>  Document Relationships </li></ul></li><li>  Developing secure PHP applications <br><ul><li>  Interaction with databases </li><li>  File upload </li><li>  Cross-site scripting (XSS) </li><li>  Cross-site request forgery (CSRF) </li><li>  XML attacks (XXE, XPath deployments) </li><li>  Deserialization and implementation of PHP objects </li><li>  Password Hashing </li><li>  General Cryptography </li></ul></li><li>  Special cases <br><ul><li>  Searchable Encryption </li><li>  Token-based authentication without side channels </li><li>  Developing secure APIs </li><li>  Security Event Logging with Chronicle </li></ul></li><li>  A few words from the author </li><li>  Sources </li></ol><br><h2 id="versii-php">  PHP versions </h2><br><p>  In short: nothing can be done, but in 2018 you will use <strong>PHP 7.2</strong> , and in the beginning of 2019 plan to switch to 7.3. </p><br><p>  PHP 7.2 released November 30, 2017 </p><br><p>  At the time of this writing, only PHP 7.1 and 7.2 are actively supported by language developers, and for PHP 5.6 and 7.0, security patches will be released for about a year. </p><br><p>  Some operating systems have long-term support for PHP versions that are no longer supported, but this is generally considered to be a bad practice.  For example, backporting security patches without incrementing version numbers makes it difficult to evaluate the security system for PHP only. </p><br><p>  Accordingly, regardless of the promises of vendors, always try to <a href="http://php.net/supported-versions.php">use only an <strong>actively supported</strong></a> version of PHP, if possible.  Even if you spend some time working with a version for which only security patches are released, regular version updates will save you from many unpleasant surprises. </p><br><h2 id="upravlenie-zavisimostyami">  Dependency management </h2><br><p>  In short: use Composer. </p><br><p>  <a href="https://getcomposer.org/">Composer</a> is a masterpiece dependency management solution for the PHP ecosystem.  In <em>PHP: The Right Way,</em> a whole section is devoted <a href="http://www.phptherightway.com/">to getting started with Composer</a> , we highly recommend reading it. </p><br><p>  If you do not use Composer to manage dependencies, then sooner or later (hopefully late, but, most likely, early) you will find yourself in a situation where one of the libraries you depend on is very outdated and criminals will actively exploit vulnerabilities in old versions. </p><br><p>  <strong>Important:</strong> Do not forget to <a href="http://www.phptherightway.com/">update your dependencies</a> as software is developed.  Fortunately, this can be done in one line: </p><br><pre><code class="hljs pgsql">composer <span class="hljs-keyword"><span class="hljs-keyword">update</span></span></code> </pre> <br><p>  If you are doing something special that requires the use of PHP extensions (written in C), then you cannot install them using Composer.  You will also need a PECL. </p><br><h2 id="rekomenduemye-pakety">  Featured Packages </h2><br><p>  Regardless of what you create, surely these dependencies will be useful to you.  This is in addition to what most PHP developers recommend (PHPUnit, PHP-CS-Fixer, etc.). </p><br><h3 id="roavesecurity-advisories">  roave / security-advisories </h3><br><p>  The <a href="https://github.com/Roave/SecurityAdvisories">Roave security-advisories package</a> uses the <a href="https://github.com/FriendsOfPHP/security-advisories">Friends of PHP</a> repository so that <strong>your</strong> project does not depend on any packages with known vulnerabilities. </p><br><pre> <code class="hljs pgsql">composer require roave/<span class="hljs-keyword"><span class="hljs-keyword">security</span></span>-advisories:dev-master</code> </pre> <br><p>  Or you can <a href="https://github.com/FriendsOfPHP/security-advisories">upload your</a> <code>composer.lock</code> <a href="https://github.com/FriendsOfPHP/security-advisories">file</a> to Sensio Labs as a standard automated vulnerability assessment procedure to receive alerts for any obsolete packages. </p><br><h3 id="vimeopsalm">  vimeo / psalm </h3><br><p>  <a href="https://github.com/vimeo/psalm">Psalm</a> is a static analysis tool that helps identify possible bugs in your code.  Although there are other good tools (for example, the wonderful <a href="https://github.com/phan/phan">Phan</a> and <a href="https://github.com/phpstan/phpstan">PHPStan</a> ), but if you need support for PHP 5, then Psalm is one of the best static analysis tools for PHP 5.4+. </p><br><p>  Using Psalm is simple: </p><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># Version 1 doesn't exist yet, but it will one day: composer require --dev vimeo/psalm:^0 # Only do this once: vendor/bin/psalm --init # Do this as often as you need: vendor/bin/psalm</span></span></code> </pre> <br><p>  If this is the first time you apply this code to an existing database, you will see a lot of red marks.  If you do not create a WordPress-scale application, then it is unlikely that you will have to perform the Hercules feat in order to pass all these tests. </p><br><p>  Regardless of which static analysis tool you choose, we recommend integrating it into the continuous integration workflow (if possible), so that the tool runs after each code change. </p><br><h2 id="https-i-bezopasnost-v-brauzere">  HTTPS and browser security </h2><br><p>  In short: HTTPS <a href="https://www.ssllabs.com/">to test</a> , and <a href="https://securityheaders.io/">security headers</a> . </p><br><p>  In 2018, sites will no longer work via unsecure HTTP.  Fortunately, you could get TLS-certificates for free and automatically update them thanks to the ACME protocol and the certification company <a href="https://letsencrypt.org/">Let's Encrypt</a> . </p><br><p>  Integrating ACME into your web server is a couple of trivia. </p><br><ul><li>  <a href="https://caddyserver.com/">Caddy</a> : embedded automatically. </li><li>  <a href="httpd.html">Apache</a> : coming soon as mod_md.  In the meantime, the network has <a href="https://www.digitalocean.com/community/tutorials/how-to-secure-apache-with-let-s-encrypt-on-ubuntu-16-04">excellent instructions</a> . </li><li>  <a href="https://www.nginx.com/blog/using-free-ssltls-certificates-from-lets-encrypt-with-nginx/">Nginx</a> : everything is quite simple. </li></ul><br><p>  You might think, ‚ÄúOkay, I have a TLS certificate.  Now we need to spend several hours searching for configurations to make the site safe and fast. ‚Äù </p><br><p>  <strong>Not!</strong>  <a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">Mozilla will help you</a> .  To create the <a href="https://wiki.mozilla.org/Security/Server_Side_TLS">recommended cipher suite</a> for your audience, you can use the configuration generator. </p><br><p>  <em>HTTPS (HTTP over TLS) is completely uncontested if you want to make your site secure.</em>  <em>The use of HTTPS instantly eliminates several types of attacks on your users (implementation of man-in-the-middle content, interception of data, replay attacks and manipulation of sessions for the sake of user substitution).</em> </p><br><h3 id="zagolovki-bezopasnosti">  Security headers </h3><br><p>  Although the use of HTTPS on your server has many advantages in terms of security and performance, you can go even further and use other browser security features.  Most of them involve sending HTTP response headers with content. </p><br><ul><li> <code>Content-Security-Policy</code> <br> <ul><li>  The header provides fine control of the browser‚Äôs permissions for external and internal resources.  That is, this is an additional level of cross-site scripting protection. </li><li>  Use <a href="https://github.com/paragonie/csp-builder">CSP-Builder</a> to quickly and easily deploy / manage Content Security Policies. </li><li>  For a deeper analysis, you can read this first: an <a href="https://scotthelme.co.uk/content-security-policy-an-introduction/">introduction to the content security policy headers</a> . </li></ul></li><li> <code>Expect-CT</code> <br> <ul><li>  The header adds a level of protection against fraudulent / compromised certification companies.  The title forces publication of evidence of the invalidity of certificates in a publicly verifiable, uneditable data structure.  More about <code>Expect-CT</code> : <a href="https://scotthelme.co.uk/a-new-security-header-expect-ct/">https://scotthelme.co.uk/a-new-security-header-expect-ct/</a> . </li><li>  First, set <code>enforce</code> , <code>max-age=30</code> , and when make sure that the header does not interfere with the service, increase the <code>max-age</code> . </li></ul></li><li> <code>Referrer-Policy</code> <br> <ul><li>  The header allows you to control the transfer of data on the behavior of your users to a third party. </li><li>  <a href="https://scotthelme.co.uk/a-new-security-header-referrer-policy/">Scott Helme perfectly describes the work with</a> <code>Referrer-Policy</code> <a href="https://scotthelme.co.uk/a-new-security-header-referrer-policy/">headers</a> . </li><li>  Set to <code>same-origin</code> or <code>no-referrer</code> until there is no reason to transmit more information. </li></ul></li><li> <code>Strict-Transport-Security</code> <br> <ul><li>  The header tells the browser to send all future requests to this source via HTTPS, and not via unsafe HTTP. </li><li>  When you first deploy, prescribe <code>max-age=30</code> , and then increase the value (for example, to <code>31536000</code> ), when you are sure that nothing will break. </li></ul></li><li> <code>X-Content-Type-Options</code> <br> <ul><li>  Confusion in MIME types can lead to unpredictable results, including strange extreme situations involving XSS vulnerabilities.  It is best to use this header with the standard <code>Content-Type</code> . </li><li>  Specify <code>nosniff</code> , unless you need the default behavior (for example, to download files). </li></ul></li><li> <code>X-Frame-Options</code> <br> <ul><li>  The header prevents clickjacking attacks. </li><li>  Set <code>DENY</code> (or <code>SAMEORIGIN</code> , but only if using <code>&lt;frame&gt;</code> elements) </li></ul></li><li> <code>X-XSS-Protection</code> <br> <ul><li>  The header includes some XSS protection browser features that are not included by default. </li><li>  Set <code>1; mode=block</code> <code>1; mode=block</code> </li></ul></li></ul><br><p>  Similarly, if you use the built-in PHP session management properties (which is recommended), you may want to call <code>session_start()</code> : </p><br><pre> <code class="hljs php">session_start([ <span class="hljs-string"><span class="hljs-string">'cookie_httponly'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'cookie_secure'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ]);</code> </pre> <br><p>  Then, when sending credentials, your application will use only secure HTTPS flags, which will prevent successful XSS attacks by stealing user cookies, they will be sent only via HTTPS.  A couple of years ago we already wrote about <a href="https://paragonie.com/blog/2015/04/fast-track-safe-and-secure-php-sessions">secure PHP sessions</a> . </p><br><h3 id="celostnost-podresursov">  Sub-resources integrity </h3><br><p>  Someday in the future you will be working on a project that uses CDNs to unload traditional Javascript / CSS frameworks and libraries into a central location.  Not surprisingly, security experts predicted an obvious problem: if many sites use CDN to provide part of their content, then cracking the CDN and swapping data will allow embedding arbitrary code on thousands (if not millions) of sites. </p><br><p>  <strong>Therefore, we invented the integrity of subresources (subresource integrity).</strong> </p><br><p>  Sub-Resource Integrity (SRI) allows you to pin a hash of the contents of the file, which the CDN should provide you.  The current implementation of SRI allows only cryptographic hash functions to be used, so attackers will not be able to generate malicious versions of the content, resulting in the same hashes as those of the original files. </p><br><p>  Real-world example: <a href="https://v4-alpha.getbootstrap.com/">Bootstrap v4-alpha uses SRI in the sample code of their CDN</a> . </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">integrity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">crossorigin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"anonymous"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">integrity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">crossorigin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"anonymous"</span></span></span><span class="hljs-tag"> &gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3 id="vzaimosvyazi-dokumentov">  Document Relationships </h3><br><p>  Web developers often set the <code>target</code> attribute to hyperlinks (for example, <code>target="_blank"</code> to open a link in a new window).  But if you don‚Äôt also pass the <code>rel="noopener"</code> tag, then <a href="https://mathiasbynens.github.io/rel-noopener/">let the landing page take control of the source page</a> . </p><br><p>  <strong><em>Don't do that</em></strong> </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://example.com"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_blank"</span></span></span><span class="hljs-tag">&gt;</span></span>Click here<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  This will allow <code>example.com</code> to gain control over the current page. </p><br><p>  <strong><em>Do this</em></strong> </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://example.com"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_blank"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"noopener noreferrer"</span></span></span><span class="hljs-tag">&gt;</span></span>Click here<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In the new window opens <code>example.com</code> , but does not gain control over the current window. </p><br><p>  <a href="https://www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever">For further study</a> . </p><br><h2 id="razrabotka-zaschischyonnyh-php-prilozheniy">  Developing secure PHP applications </h2><br><p>  If security software is new to you, you can start by introducing <em>A Gentle Introduction to Application Security.</em> </p><br><p>  Many security experts from the very beginning draw the attention of developers to resources like <a href="https://www.owasp.org/index.php/Top_10_2017-Top_10">OWASP Top 10</a> .  But many common vulnerabilities can be considered as special cases of the same high-level problems (code / data is not adequately separated, erroneous logic, unsafe operating environment, broken cryptographic protocols). </p><br><p>  We believe that if we instill in the safety of the neophytes a simpler, more fundamental understanding of security problems and their solutions, this will help improve the security situation in the long run. </p><br><h3 id="vzaimodeystvie-s-bazami-dannyh">  Interaction with databases </h3><br><p>  Read more: <a href="https://paragonie.com/blog/2015/05/preventing-sql-injection-in-php-applications-easy-and-definitive-guide">Preventing SQL injections in PHP applications</a> </p><br><p>  If you write SQL queries yourself, make sure that you use <strong>prepared statements (prepared statements)</strong> and that any information provided by the network or file system is passed as parameters, and not concatenated into a query string.  Also make sure you avoid <em>emulated</em> prepared expressions. </p><br><p>  The best choice is <a href="https://github.com/paragonie/easydb">EasyDB</a> . </p><br><p>  <strong><em>DO NOT DO THIS:</em></strong> </p><br><pre> <code class="hljs php"><span class="hljs-comment"><span class="hljs-comment">/*  : */</span></span> $query = $pdo-&gt;query(<span class="hljs-string"><span class="hljs-string">"SELECT * FROM users WHERE username = '"</span></span> . $_GET[<span class="hljs-string"><span class="hljs-string">'username'</span></span>] . <span class="hljs-string"><span class="hljs-string">"'"</span></span>);</code> </pre> <br><p>  Do this: </p><br><pre> <code class="hljs php"><span class="hljs-comment"><span class="hljs-comment">/*   SQL-: */</span></span> $results = $easydb-&gt;row(<span class="hljs-string"><span class="hljs-string">"SELECT * FROM users WHERE username = ?"</span></span>, $_GET[<span class="hljs-string"><span class="hljs-string">'username'</span></span>]);</code> </pre> <br><p>  There are other layers of abstractions in the databases that provide an equivalent level of security (EasyDB uses PDO under the hood, but by all means tries to turn off the emulation of prepared expressions in favor of real prepared expressions to prevent problems).  As long as user input does not affect the structure of requests (this also applies to stored procedures), you are safe. </p><br><h3 id="zagruzka-faylov">  File upload </h3><br><p>  Read more: <a href="https://paragonie.com/blog/2015/10/how-securely-allow-users-upload-files">How to safely allow users to upload files</a> </p><br><p>  Accepting user files is risky, but it can be done safely by taking a number of precautions.  In particular, close direct access to downloadable files so that they cannot be executed or interpreted. </p><br><p>  <strong>Downloaded files must have read-only or read-only or write attributes and never be executable.</strong> </p><br><p>  If your site has a root directory for documents <code>/var/www/example.com</code> , then you should not store the downloaded files in <code>/var/www/example.com/uploaded_files</code> . </p><br><p>  It is better to store them in a separate directory, to which there is no direct access (for example, <code>/var/www/example.com-uploaded/</code> ), so that they are not randomly executed as server scripts and do not open the door to remote code execution. </p><br><p>  A cleaner solution is to move your root directory for files one level down (i.e., at <code>/var/www/example.com/public</code> ). </p><br><p>  Another problem with downloadable files is related to their safe <em>download</em> . </p><br><ul><li>  Direct download SVG images execute JavaScript code in a custom browser.  This is <a href="https://github.com/w3c/svgwg/issues/266">despite the misleading</a> <code>image/</code> <a href="https://github.com/w3c/svgwg/issues/266">prefix</a> <a href="https://github.com/w3c/svgwg/issues/266">in the MIME type</a> . </li><li>  MIME-type sniffing can lead to attacks through type confusion, as described above.  See <code>X-Content-Type-Options</code> . </li><li>  If you did not follow the previous advice regarding the safe storage of downloaded files, then an attacker trying to download a <code>.php</code> or <code>.phtml</code> file can execute arbitrary code by accessing the file directly in the browser and get full control over the server.  Be careful. </li></ul><br><h3 id="mezhsaytovyy-skripting-xss">  Cross-site scripting (XSS) </h3><br><p>  Read more: <a href="https://paragonie.com/blog/2015/06/preventing-xss-vulnerabilities-in-php-everything-you-need-know">Everything you need to know about PHP cross-site scripting prevention</a> </p><br><p>  In an ideal world, preventing XSS would be as easy as SQL injection.  We would have an easy-to-use API for separating the structure of a document from its contents. </p><br><p>  Unfortunately, in the real world, most web developers generate long HTML and send it in an HTTP response.  This is not only characteristic of PHP, it‚Äôs just the reality of web development. </p><br><p>  Closing XSS vulnerabilities is a completely solvable task.  However, the contents <a href="https://paragonie.com/blog/2017/12/2018-guide-building-secure-php-software">of the browser security section</a> unexpectedly gaining more importance.  In short: </p><br><ol><li>  <strong>Always shield at the <em>exit</em> , never at the <em>entrance</em></strong> .  If you keep clean data in the database, then a SQL vulnerability is found somewhere, the attacker can completely bypass your XSS protection by simply contaminating the malicious code with seemingly clean records. </li><li>  If your framework has a template engine that offers automatic context filtering, then use it.  Your framework will work safer. </li><li> <code>echo htmlentities($string, ENT_QUOTES | ENT_HTML5, 'UTF-8');</code>  - this is a safe and effective way to stop all XSS attacks on a page using UTF-8, but all HTML will be prohibited. </li><li>  If you want to use Markdown instead of HTML, do not select HTML. </li><li>  If you need to allow some HTML and you do not use the template engine (see point 1), use <a href="http://htmlpurifier.org/">HTML Purifier</a> .  HTML Purifier is not suitable for shielding the context of HTML attributes. </li></ol><br><h3 id="poddelka-mezhsaytovyh-zaprosov-csrf">  Cross-site request forgery (CSRF) </h3><br><p>  Cross-site request forgery is a type of attack with delegate substitution: you can trick the user browser and force it to execute a malicious HTTP request with elevated user privileges. </p><br><p>  In general, this problem is easily solved: </p><br><ol><li>  Use https.  This is a necessary condition. </li><li>  Add a basic question-answer type authentication. <br><ul><li>  Add a hidden attribute to each form. </li><li>  Generate cryptographically secure random values ‚Äã‚Äã(tokens). </li><li>  Check the provided hidden form attributes and check with the expected values. </li></ul></li></ol><br><p>  We wrote the <a href="https://github.com/paragonie/anti-csrf">Anti-CSRF</a> library, which goes even further: </p><br><ul><li>  Each token can be made one-time to prevent replay attacks. <br><ul><li>  Tokens are stored on the backend. </li><li>  Tokens are rotated as needed, first go older ones. </li></ul></li><li>  Each token can be tied to a specific URI. <br><ul><li>  If a token leaks, it cannot be used in another context. </li></ul></li><li>  If desired, tokens can be limited to a specific IP address. </li><li>  From version v2.1, tokens can be used multiple times (for example, for AJAX calls). </li></ul><br><p>  If your framework does not care about CSRF vulnerabilities, then use Anti-CSRF. </p><br><p>  In the near future, <a href="https://www.sjoerdlangkemper.nl/2016/04/14/preventing-csrf-with-samesite-cookie-attribute/">SameSite</a> cookies <a href="https://www.sjoerdlangkemper.nl/2016/04/14/preventing-csrf-with-samesite-cookie-attribute/">will allow you to stop CSRF</a> attacks with much less effort. </p><br><h3 id="xml-ataki-xxe-xpath-vnedreniya">  XML attacks (XXE, XPath deployments) </h3><br><p>  There are two main vulnerabilities that manifest themselves in applications that handle XML a lot: </p><br><ol><li>  External Entities XML (XXE). </li><li>  XPath injection </li></ol><br><p>  XXE attacks, <a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing">among other things</a> , can be used as a launching pad for local / remote file injection exploits. </p><br><p>  Early versions of Google Docs were vulnerable to XXE attacks, but they are little known outside of business applications that handle large amounts of XML. </p><br><p>  The main thing you need to do to protect against XXE attacks: </p><br><pre> <code class="hljs lisp">libxml_disable_entity_loader(<span class="hljs-name"><span class="hljs-name">true</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><p>  <a href="https://www.owasp.org/index.php/XPATH_Injection">XPath injection is</a> very similar to SQL injection, only here we are talking about XML documents. </p><br><p>  Fortunately, in the PHP ecosystem, there are rarely situations when user input is transmitted in an XPath query. </p><br><p>  Unfortunately, this also means that the best available solution (for precompiled and parameterized XPath queries) is missing in the PHP ecosystem. </p><br><p>  We recommend using white lists of allowed characters for any data related to XPath queries. </p><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">declare</span></span></span><span class="php">(strict_types=</span><span class="hljs-number"><span class="php"><span class="hljs-number">1</span></span></span><span class="php">); </span><span class="hljs-class"><span class="hljs-keyword"><span class="php"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span><span class="php"><span class="hljs-class"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-class"><span class="hljs-title">SafeXPathEscaper</span></span></span></span><span class="php"><span class="hljs-class"> </span></span></span><span class="php">{ </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="php"><span class="hljs-comment"> string $input * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span></span><span class="php"><span class="hljs-comment"> string */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">public</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">static</span></span></span><span class="php"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="php"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">allowAlphaNumeric</span></span></span></span><span class="hljs-params"><span class="php"><span class="hljs-function"><span class="hljs-params">(string $input)</span></span></span></span><span class="php"><span class="hljs-function">: </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span><span class="php"><span class="hljs-function"> </span></span></span><span class="php">{ </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">return</span></span></span><span class="php"> \preg_replace(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'#[^A-Za-z0-9]#'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">''</span></span></span><span class="php">, $input); } </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">/** * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span></span><span class="php"><span class="hljs-comment"> string $input * </span></span><span class="hljs-doctag"><span class="php"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span></span><span class="php"><span class="hljs-comment"> string */</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">public</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">static</span></span></span><span class="php"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="php"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">allowNumeric</span></span></span></span><span class="hljs-params"><span class="php"><span class="hljs-function"><span class="hljs-params">(string $input)</span></span></span></span><span class="php"><span class="hljs-function">: </span></span><span class="hljs-title"><span class="php"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span><span class="php"><span class="hljs-function"> </span></span></span><span class="php">{ </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">return</span></span></span><span class="php"> \preg_replace(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'#[^0-9]#'</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">''</span></span></span><span class="php">, $input); } } </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">// Usage: $selected = $xml-&gt;xpath( "/user/username/" . SafeXPathEscaper::allowAlphaNumeric( $_GET['username'] ) );</span></span></span></span></code> </pre> <br><p>  White lists are safer than black ones. </p><br><h3 id="deserializaciya-i-vnedrenie-php-obektov">  Deserialization and implementation of PHP objects </h3><br><p>  Read more: <a href="https://paragonie.com/blog/2016/04/securely-implementing-de-serialization-in-php">Secure (de) serialization in PHP</a> </p><br><p>  If you pass untrusted data to <code>unserialize()</code> , then you are asking for two scenarios: </p><br><ol><li>  Implementing a PHP object that can be used to launch a POP chain and trigger other vulnerabilities from misused objects. </li><li>  Memory corruption in the PHP interpreter itself. </li></ol><br><p>  Many developers prefer to use JSON serialization instead, which is a noticeable improvement in software security.  But keep in mind that <code>json_decode()</code> <a href="http://lukasmartinelli.ch/web/2014/11/17/php-dos-attack-revisited.html">is vulnerable to DDoS attacks through hash collisions</a> .  Unfortunately, a complete solution to the hash DOS problem in PHP has <a href="https://bugs.php.net/bug.php%3Fid%3D70644">yet to be found</a> . </p><br><p>  Migrating from djb33 to Siphash with assignment 1 as the high-order bit for the hash of the string input value, 0 for the integer and with the key requested in advance, will provide full protection against these attacks, it will be provided by CSPRNG. </p><br><p>  Unfortunately, the creators of PHP are not willing to partially sacrifice the performance they achieved in PHP 7, so it‚Äôs hard to convince them to abandon djb33 (very fast, but unsafe) in favor of SipHash (also fast, though not like djb33, but much safer) .  A significant performance degradation may even interfere with the development of future versions, which will not benefit security. </p><br><p>  Therefore, it is better to do this: </p><br><ul><li>  Using JSON is safer <code>unserialize()</code> . </li><li>  Where possible, authenticate the input data before deserializing it. <br><ul><li>  For the data you provide to end users, choose <code>sodium_crypto_auth()</code> and <code>sodium_crypto_auth_verify()</code> with a secret key known only to the server. </li><li>  For data provided by a third party, sign JSON messages with <code>sodium_crypto_sign()</code> , and then check with <code>sodium_crypto_sign_open()</code> and a third-party public key. </li><li>  You can also use a separate API for writing if you need hexadecimal or base64 encoding of signatures for the transfer. </li></ul></li><li>  Where it is not possible to authenticate JSON strings, use strict rate limits and block IP addresses to protect against replay attacks. </li></ul><br><h3 id="heshirovanie-paroley">  Password Hashing </h3><br><p>  Read more: <a href="https://paragonie.com/blog/2016/02/how-safely-store-password-in-2016">How to safely store user passwords in 2016</a> <br>  Safe password storage used to be a topic of active discussion, but today it is easy to implement, especially in PHP: </p><br><pre> <code class="hljs ruby">$hash = \password_hash($password, PASSWORD_DEFAULT); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (\password_verify($password, $hash)) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Authenticated. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (\password_needs_rehash($hash, PASSWORD_DEFAULT)) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> Rehash, update database. } }</code> </pre> <br><p>  You do not even need to know what the algorithm is, because if you use the latest version of PHP, you will use the latest technologies, and the user passwords will be automatically updated as soon as a new algorithm is available by default. </p><br><p>  Whatever you do, <a href="https://paragonie.com/blog/2016/08/on-insecurity-popular-open-source-php-cms-platforms">do not do it like WordPress</a> . </p><br><p>  If interested: from PHP 5.5 to 7.2, the default algorithm is bcrypt.  In the future, it may be replaced by Argon2, the winner of the <a href="https://password-hashing.net/">Password Hashing Contest</a> . </p><br><p>  If you have not used the <code>password_*</code> API before and you need to migrate legacy hashes, then do it <a href="https://paragonie.com/blog/2016/02/how-safely-store-password-in-2016">that way</a> .  Many companies, such as <a href="https://www.theregister.co.uk/2016/12/15/yahoos_password_hash/">Yahoo</a> , have done wrong.  It seems that Apple has recently caused an incorrect implementation of the Legacy hashes update to cause a <a href="https://objective-see.com/blog/blog_0x24.html">bug</a> with <code>iamroot</code> . </p><br><h3 id="kriptografiya-obschego-naznacheniya">  General Cryptography </h3><br><p>  We wrote a lot on this topic: </p><br><ul><li>  <a href="https://paragonie.com/blog/2015/05/using-encryption-and-authentication-correctly">Correct use of encryption and authentication</a> (2015) </li><li>  <a href="https://paragonie.com/blog/2015/07/how-safely-generate-random-strings-and-integers-in-php">How to safely generate random strings and numbers in PHP</a> (2015) </li><li> <strong>:</strong> <a href="https://paragonie.com/blog/2015/11/choosing-right-cryptography-library-for-your-php-project-guide">        PHP-</a> (2015) </li><li> <strong>:</strong> <a href="https://paragonie.com/blog/2015/08/you-wouldnt-base64-a-password-cryptography-decoded">  Base64-  </a> (2015) </li><li> <a href="https://paragonie.com/blog/2017/02/cryptographically-secure-php-development">  PHP-</a> (2017) </li><li> <strong></strong> :   <a href="https://paragonie.com/blog/2017/06/libsodium-quick-reference-quick-comparison-similar-functions-and-which-one-use">Libsodium:        </a> (2017) </li></ul><br><p>         Sodium (libsodium).     PHP  7.2 (  5.2.4),   <a href="https://github.com/paragonie/sodium_compat">sodium_compat</a>  ,     7.2. </p><br><p>    -         .  ,                . </p><br><h2 id="osobye-sluchai">  Special cases </h2><br><p>   ,   2018-    PHP-.      . </p><br><h3 id="shifrovanie-s-vozmozhnostyu-poiska">     </h3><br><p> : <a href="https://paragonie.com/blog/2017/05/building-searchable-encrypted-databases-with-php-and-sql">Building Searchable Encrypted Databases with PHP and SQL</a> </p><br><p>         ,  ,    .      ,          .  In particular: </p><br><ol><li>   ,            . </li><li>     . </li><li>    (    )   HMAC   KDF    (, Argon2). </li><li>  :     3,     Bloom-. </li><li>     3  4   SELECT. </li><li>  . </li></ol><br><p>            ,     . </p><br><h3 id="autentifikaciya-na-osnove-tokenov-bez-pobochnyh-kanalov">        </h3><br><p> : <a href="https://paragonie.com/blog/2017/02/split-tokens-token-based-authentication-protocols-without-side-channels">-:        </a> </p><br><p>      ( ):  ,   SELECT        ? </p><br><p>   : </p><br><ol><li>     . </li><li>      SELECT. </li><li>       (constant-time). <br><ul><li>            .      ,       ¬´    ¬ª. </li></ul></li></ol><br><p>           ,    -. </p><br><h3 id="razrabotka-zaschischyonnyh-api">   API </h3><br><p> : <a href="https://paragonie.com/blog/2017/06/hardening-your-php-powered-apis-with-sapient">  Sapient   PHP API</a> </p><br><p>   <a href="https://github.com/paragonie/sapient">SAPIENT</a> , <strong>S</strong> ecure <strong>API</strong> <strong>EN</strong> gineering <strong>T</strong> oolkit,       . Sapient   /         (shared)         HTTPS. </p><br><p>     Ed25519     API-      ,           ,     ¬´ ¬ª    /  . </p><br><p>    HTTP-     ,     ,      (, Oauth).      ,     - ,      ,      . </p><br><p>    Sapient     Sodium. </p><br><p> <strong> :</strong> </p><br><ul><li>  <a href="https://github.com/paragonie/sapient/tree/master/docs">Sapient</a> </li><li>   <a href="">Sapient</a> </li><li>  <a href="">Sapient</a> </li></ul><br><p> Paragon Initiative Enterprises   Sapient     ( open source )      Sapient. </p><br><h3 id="bezopasnoe-zhurnalirovanie-sobytiy-s-pomoschyu-chronicle">      Chronicle </h3><br><p> : <a href="https://paragonie.com/blog/2017/07/chronicle-will-make-you-question-need-for-blockchain-technology">Chronicle  ,     </a> </p><br><p> <a href="https://github.com/paragonie/chronicle">Chronicle</a> ‚Äî  ,      .     -  ,  ,   ,       ¬´¬ª. </p><br><p>       , Chronicle     SIEM,             ,     . </p><br><p>   Chronicle     (cross-sign)      Chronicle /    ,      Chronicle,          . </p><br><p>   Chronicle         ,   . </p><br><p>      Chronicle    <a href="https://paragonie.com/blog/2017/12/2018-guide-building-secure-php-software">API,   Sapient</a> ,     ‚Äî <a href="https://github.com/paragonie/quill">Quill</a> . </p><br><h2 id="neskolko-slov-ot-avtora">     </h2><br><p>    ,        (  open source ),    <strong><em> </em></strong>   . </p><br><p>  . </p><br><p>        2015-            PHP. </p><br><p>   ,      (          PHP     PHP 7.2),    ,           .          ,     . </p><br><p>         ,  ,   ,    , ,   ,     ,    .    ,    ,       ( <a href="https://scotthelme.co.uk/">Scott Helme</a> )  .      ,            . </p><br><p>  Of course, this is not an exhaustive guide.        ,     .  ‚Äî   ,  .  ,                 PHP-. </p><br><h2 id="istochniki">  Sources </h2><br><p>         ,  <a href="https://github.com/paragonie/awesome-appsec">      </a> . </p><br><p>   ,     ,          ,    <a href="https://paragonie.com/services">   </a>  . </p><br><p>     ,       (PCI-DSS, ISO 27001  . .),  <a href="https://paragonie.com/blog/2017/06/why-you-want-paragon-initiative-enterprises-audit-your-code">      </a> .       ,     . </p><br><p>  ‚Äî    PHP-     . </p><br><ul><li> <a href="http://www.phptherightway.com/">PHP: The Right Way</a> ‚Äî     PHP-. </li><li>  SSL- <a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">Mozilla</a> . </li><li> <a href="https://letsencrypt.org/">Let's Encrypt</a> ‚Äî  ,   TLS-    . </li><li> <a href="https://www.ssllabs.com/ssltest">Qualys SSL Labs</a>      TLS-.              ,    :   . </li><li> <a href="https://securityheaders.io/">Security Headers</a>  ,              . </li><li> <a href="https://report-uri.com/">Report-URI</a> ‚Äî   ,      .   Report-URI,      ,     Report-URI,  -     XSS-. Report-URI           . </li><li> <a href="https://www.ripstech.com/php-security-calendar-2017">The PHP Security Advent Calendar</a> ,   <a href="https://www.ripstech.com/">RIPSTech</a> . </li><li> <a href="https://snuffleupagus.readthedocs.io/">Snuffleupagus</a> ‚Äî PHP-     (     <a href="https://github.com/sektioneins/suhosin">Suhosin</a> ). </li><li> <a href="https://phpdelusions.net/">PHP Delusions</a> ‚Äî ,    PHP.    ,  -         .  ,         PDO. </li><li> <a href="https://haveibeenpwned.com/">Have I Been Pwned?</a>   ,        . </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/344696/">https://habr.com/ru/post/344696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344684/index.html">We learn the car to understand languages</a></li>
<li><a href="../344686/index.html">Tanchiki in the console, the second article: "It is time to redo everything!"</a></li>
<li><a href="../344690/index.html">Tutorial on the Unreal Engine. Part 5: How to create a simple game</a></li>
<li><a href="../344692/index.html">The transfer pattern scala.concurrent.Promise to the actor: usage features and alternatives</a></li>
<li><a href="../344694/index.html">Deploy Parallels RAS to Microsoft Azure in half an hour</a></li>
<li><a href="../344700/index.html">ATOL Online: a look from the data center</a></li>
<li><a href="../344702/index.html">What you need to know to become a system architect</a></li>
<li><a href="../344704/index.html">Installing the HA Master Kubernetes Cluster with Kubespray</a></li>
<li><a href="../344706/index.html">6 design business habits that kill grocery</a></li>
<li><a href="../344708/index.html">IoT as a motivator for NAT in IPv6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>