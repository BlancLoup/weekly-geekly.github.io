<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Transition from ASP.NET to ASP.NET Core 2.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is a translation of the Help guide for migrating applications from ASP.NET to ASP.NET Core 2.0. Link to the original 
 Content 


1. Requ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Transition from ASP.NET to ASP.NET Core 2.0</h1><div class="post__text post__text-html js-mediator-article"><p>  This article is a translation of the Help guide for migrating applications from ASP.NET to ASP.NET Core 2.0.  <a href="https://docs.microsoft.com/ru-ru/aspnet/core/migration/proper-to-2x/">Link to the original</a> </p><br><h3 id="soderzhanie">  Content </h3><br><ol><li>  Requirements </li><li>  Framework Selection </li><li>  Differences in project structure </li><li>  Global.asax replacement </li><li>  Configuration storage </li><li>  Built-in mechanism Dependency Injection </li><li>  Work with static files </li></ol><br><h3 id="trebovaniya">  Requirements </h3><br><p>  ‚Ä¢ .NET Core 2.0.0 SDK or later. </p><br><h3 id="vybor-freymvorka">  Choosing a framework </h3><br><p> To work with an ASP.NET Core 2.0 project, the developer has to make a choice - use .NET Core, .NET Framework, or use both options at once.  As additional information, you can use the manual <a href="https://docs.microsoft.com/dotnet/standard/choosing-core-framework-server">Choosing between the .NET Core and .NET Framework for server apps</a> (briefly, the .NET core is a cross-platform library, unlike the .NET Framework) in order to understand which Framework will be the most preferable for you. . <br>  After selecting the desired Framework in the project, you must provide links to the NuGet packages. <br>  Using .NET Core allows you to eliminate numerous explicit references to packages, thanks to the <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/metapackage">combined package</a> (meta package) of ASP.NET Core 2.0.  This is how the installation of the <code>Microsoft.AspNetCore.All</code> meta package looks into the project: <a name="habracut"></a></p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.AspNetCore.All"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.0.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3 id="razlichiya-v-strukture-proekta">  Differences in project structure </h3><br><p>  The structure of the <em>.csproj</em> project file <em>has</em> been simplified in ASP.NET Core.  Here are some significant changes: </p><br><p>  ‚Ä¢ Explicitly specifying files is optional for adding them to a project.  Thus, the risk of conflicts in the process of merging XML is reduced if a large team works on a project. <br>  ‚Ä¢ No more GUID links to other projects, which improves readability <br>  ‚Ä¢ The file can be edited without downloading it from Visual Studio: </p><br><img src="https://habrastorage.org/web/3ec/204/37b/3ec20437b2894df1a910e1806d431265.png"><br><br><h3 id="zamena-globalasax">  Global.asax replacement </h3><br><p>  The entry point for an ASP.NET application is the Global.asax file.  Tasks such as route configuration and filter and area registration are handled in the Global.asax file. </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MvcApplication</span></span> : <span class="hljs-title"><span class="hljs-title">System</span></span>.<span class="hljs-title"><span class="hljs-title">Web</span></span>.<span class="hljs-title"><span class="hljs-title">HttpApplication</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Application_Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { AreaRegistration.RegisterAllAreas(); FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters); RouteConfig.RegisterRoutes(RouteTable.Routes); BundleConfig.RegisterBundles(BundleTable.Bundles); } }</code> </pre> <br><p>  This approach closely connects the application and the server on which the application is deployed.  To reduce connectivity, <a href="http://owin.org/">OWIN</a> was introduced as a tool that provides a more correct way to share several frameworks together. <br>  OWIN allows you to add only necessary modules to the request pipeline.  The runtime uses <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/startup">Startup</a> to configure services and the query pipeline. </p><br><p>  <code>Startup</code> registers a set of intermediate services (middleware) with the application.  For each request, the application calls each of the set of intermediate services in turn, which have a pointer to the first element of the linked list of handlers. </p><br><p>  Each middleware component can add one or more handlers to the query processing pipeline.  This is done by returning the reference to the handler that is at the top of the list. </p><br><p>  And the handler, having finished its work, calls the next handler from the queue. <br>  In ASP.NET Core, the entry point in the application is the <code>Startup</code> class, with which we level the dependence on Global.asax. </p><br><p>  If the .NET Framework was originally chosen, then using OWIN we can configure the query pipeline as in the following example: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Owin; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Web.Http; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">WebApi</span></span> { <span class="hljs-comment"><span class="hljs-comment">// :         OWIN.       ,  appSetting owin: AutomaticAppStartup   ¬´false¬ª. //         OWIN    ,     global.asax   MapOwinPath   MapOwinRoute  RouteTable.Routes public class Startup { //         . public void Configuration(IAppBuilder builder) { HttpConfiguration config = new HttpConfiguration(); //    , config.Routes.MapHttpRoute("Default", "{controller}/{customerID}", new { controller = "Customer", customerID = RouteParameter.Optional }); //           xml  json config.Formatters.XmlFormatter.UseXmlSerializer = true; config.Formatters.Remove(config.Formatters.JsonFormatter); // config.Formatters.JsonFormatter.UseDataContractJsonSerializer = true; builder.UseWebApi(config); } } }</span></span></code> </pre> <br><p>  Also, if necessary, here we can add other intermediate services to this pipeline (service loading, configuration settings, static files, etc.). <br>  As for the version of the .NET Core framework, a similar approach is used here, but not without using OWIN to determine the entry point.  Alternatively, the <code>Main</code> method in <em>Program.cs is used</em> (by analogy with console applications), where <code>Startup</code> is loaded: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.AspNetCore; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.AspNetCore.Hosting; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">WebApplication2</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { BuildWebHost(args).Run(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IWebHost </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BuildWebHost</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> =&gt; WebHost.CreateDefaultBuilder(args) .UseStartup&lt;Startup&gt;() .Build(); } }</code> </pre> <br><p>  Startup must include the Configure method.  Configure defines which services will be used in the request pipeline.  In the following example (taken from the standard website template), several extension methods are used to customize the pipeline with support: <br>  ‚Ä¢ BrowserLink <br>  ‚Ä¢ Error pages <br>  ‚Ä¢ Static files <br>  ‚Ä¢ ASP.NET Core MVC <br>  ‚Ä¢ Identity </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory</span></span></span><span class="hljs-function">)</span></span> { loggerFactory.AddConsole(Configuration.GetSection(<span class="hljs-string"><span class="hljs-string">"Logging"</span></span>)); loggerFactory.AddDebug(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (env.IsDevelopment()) { app.UseDeveloperExceptionPage(); app.UseDatabaseErrorPage(); app.UseBrowserLink(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { app.UseExceptionHandler(<span class="hljs-string"><span class="hljs-string">"/Home/Error"</span></span>); } app.UseStaticFiles(); app.UseIdentity(); app.UseMvc(routes =&gt; { routes.MapRoute( name: <span class="hljs-string"><span class="hljs-string">"default"</span></span>, template: <span class="hljs-string"><span class="hljs-string">"{controller=Home}/{action=Index}/{id?}"</span></span>); }); }</code> </pre> <br><p>  As a result, we have a separation of the runtime and the application, which gives us the opportunity to make the transition to another platform in the future. <br>  <strong>Note:</strong> For a deeper understanding of ASP.NET Core Startup and Middleware, you can explore <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/startup">Startup in ASP.NET Core</a> </p><br><h3 id="hranenie-konfiguraciy">  Configuration storage </h3><br><p>  ASP.NET supports saving settings.  For example, these are the settings that are used by the runtime where the application was deployed.  The approach itself was that the <code>&lt;appSettings&gt;</code> section in the <em>Web.config</em> file was used to store user key-value pairs: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UserName"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"User"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Password"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  The application accessed these settings using the ConfigurationManager.AppSettings collection from the System.Configuration namespace: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> userName = System.Web.Configuration.ConfigurationManager.AppSettings[<span class="hljs-string"><span class="hljs-string">"UserName"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> password = System.Web.Configuration.ConfigurationManager.AppSettings[<span class="hljs-string"><span class="hljs-string">"Password"</span></span>];</code> </pre> <br><p>  In ASP.NET Core, we can store application configuration data in any file and load them using services at the initial stage of loading. <br>  The default file in the new template project <em>appsettings.json</em> : </p><br><pre> <code class="hljs pgsql">{ "Logging": { "IncludeScopes": <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, "LogLevel": { "Default": "Debug", "System": "Information", "Microsoft": "Information" } }, //      .   <span class="hljs-type"><span class="hljs-type">JSON</span></span>,      :  //   ,    "AppConfiguration": { "UserName": "UserName", "Password": "Password" } }</code> </pre> <br><p>  Loading this file into the <code>IConfiguration</code> instance for the application occurs in Startup.cs: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Startup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IConfiguration configuration</span></span></span><span class="hljs-function">)</span></span> { Configuration = configuration; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IConfiguration Configuration { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; }</code> </pre> <br><p>  This is how the application uses Configuration to get these settings: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> userName = Configuration.GetSection(<span class="hljs-string"><span class="hljs-string">"AppConfiguration"</span></span>)[<span class="hljs-string"><span class="hljs-string">"UserName"</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> password = Configuration.GetSection(<span class="hljs-string"><span class="hljs-string">"AppConfiguration"</span></span>)[<span class="hljs-string"><span class="hljs-string">"Password"</span></span>];</code> </pre> <br><p>  There are other methods based on this approach that make the process more reliable, for example, Dependency Injection (DI). <br>  The DI approach provides access to a strictly typed set of configuration objects. </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// , AppConfiguration -  ,       AppConfiguration services.Configure&lt;AppConfiguration&gt;(Configuration.GetSection("AppConfiguration"));</span></span></code> </pre> <br><p>  <strong>Note:</strong> For a deeper understanding of ASP.NET Core configurations, you can get acquainted with <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/configuration">Configuration in ASP.NET Core</a> . </p><br><h3 id="vstroennyy-mehanizm-dependency-injection">  Built-in mechanism Dependency Injection </h3><br><p>  An important goal in creating large, scalable applications is to weaken the connection between components and services.  <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection">Dependency Injection</a> is a common technique for solving this problem and its implementation is a component built into ASP.NET Core. <br>  In ASP.NET applications, developers used third-party libraries to implement Injection Dependency.  An example of such a library is <a href="https://github.com/unitycontainer/unity">Unity</a> . <br>  An example of configuring Dependency Injection with Unity is a <code>UnityContainer</code> implementation wrapped in an <code>IDependencyResolver</code> : </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.Practices.Unity; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Web.Http.Dependencies; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UnityResolver</span></span> : <span class="hljs-title"><span class="hljs-title">IDependencyResolver</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> IUnityContainer container; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnityResolver</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IUnityContainer container</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (container == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"container"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.container = container; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetService</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Type serviceType</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> container.Resolve(serviceType); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ResolutionFailedException) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IEnumerable&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetServices</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Type serviceType</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> container.ResolveAll(serviceType); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ResolutionFailedException) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IDependencyScope </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginScope</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> child = container.CreateChildContainer(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnityResolver(child); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Dispose(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> disposing</span></span></span><span class="hljs-function">)</span></span> { container.Dispose(); } }</code> </pre> <br><p>  Create an instance of your <code>UnityContainer</code> , register your service, and set the dependency resolution for <code>HttpConfiguration</code> to a new instance of <code>UnityResolver</code> for our container: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Register</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HttpConfiguration config</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> container = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnityContainer(); container.RegisterType&lt;IProductRepository, ProductRepository&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HierarchicalLifetimeManager()); config.DependencyResolver = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnityResolver(container); <span class="hljs-comment"><span class="hljs-comment">//     }</span></span></code> </pre> <br><p>  Next, we inject <code>IProductRepository</code> where necessary: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ProductsController</span></span> : <span class="hljs-title"><span class="hljs-title">ApiController</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IProductRepository _repository; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProductsController</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IProductRepository repository</span></span></span><span class="hljs-function">)</span></span> { _repository = repository; } }</code> </pre> <br><p>  Since Dependency Injection is part of the ASP.NET Core kernel, we can add our service to the <code>ConfigureServices</code> method inside Startup.cs: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureServices</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IServiceCollection services</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   services.AddTransient&lt;IProductRepository, ProductRepository&gt;(); }</span></span></code> </pre> <br><p>  And then the repository injection can be done anywhere, as is the case with Unity. <br>  <strong>Note:</strong> Details can be found in <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection">Dependency Injection in ASP.NET Core</a> </p><br><h3 id="rabota-s-staticheskimi-faylami">  Work with static files </h3><br><p>  An important part of web development is the ability to maintain statics.  The most common examples of static are HTML, CSS, JavaScript, and images. <br>  These files must be saved in the application share folder (or, for example, in the CDN) so that they can be accessed later by reference.  The approach for working with statics has been changed in ASP.NET Core. </p><br><p>  In ASP.NET, static is stored in different directories. <br>  And in ASP.NET Core, static files are stored by default in ‚Äúweb root‚Äù (/ wwwroot).  And access to these files is carried out using the extension method <code>UseStaticFiles</code> from Startup.Configure: <br></p><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IApplicationBuilder app</span></span></span><span class="hljs-function">)</span></span> { app.UseStaticFiles(); }</code> </pre> <br><p>  For example, images located in the <em>wwwroot / images</em> folder will be accessible from the browser at <code>http://&lt;app-address&gt;/images/&lt;imageFileName&gt;</code> . <br>  <strong>Note:</strong> If the .NET Framework has been selected, then you will additionally need to install the NuGet <code>Microsoft.AspNetCore.StaticFiles</code> package. <br>  <strong>Note:</strong> For a more detailed reference to serving static files in the ASP.NET core, see the <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/static-files">Introduction to the ASP.NET Core</a> . </p><br><p>  translated <a href="https://habrahabr.ru/users/poledustaren/" class="user_link">poledustaren</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/338298/">https://habr.com/ru/post/338298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338286/index.html">Director Linux Foundation uses Mac OS X, announcing the "Year of Linux on Desktops"</a></li>
<li><a href="../338288/index.html">How to manage calls to the IT department</a></li>
<li><a href="../338290/index.html">Data geometry 2. Definition of di- and bi-coordinates</a></li>
<li><a href="../338292/index.html">How Android works, part 2</a></li>
<li><a href="../338294/index.html">How to make a good movie for the App Store and Google Play</a></li>
<li><a href="../338300/index.html">Paul Graham: Banal and Breakthrough</a></li>
<li><a href="../338302/index.html">Promo in check: How to build a loyalty program for the store without high costs</a></li>
<li><a href="../338304/index.html">Hackers attacked the Swiss Ministry of Defense</a></li>
<li><a href="../338306/index.html">SMS Newsletter Myths</a></li>
<li><a href="../338308/index.html">How to divide one instructor into all, so that everyone gets two. Best practice in IT training</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>