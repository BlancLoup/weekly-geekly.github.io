<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing Tiny Tiny RSS on Zyxel Keenetic router</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most recently, the "Corporation of Good" closed Google Reader. Thousands of users stood before the choice of RSS feed reader. Someone immediately foun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing Tiny Tiny RSS on Zyxel Keenetic router</h1><div class="post__text post__text-html js-mediator-article">  Most recently, the "Corporation of Good" closed Google Reader.  Thousands of users stood before the choice of RSS feed reader.  Someone immediately found what he liked, and someone is still in search.  But all online readers have one major drawback - they, like Google Reader, can close at any time.  The way out of this situation is to install one of the most popular self-hosted readers - Tiny Tiny RSS (hereinafter tt-rss).  It can be installed on a VDS server or home computer.  But you have to pay for the server, albeit small, but money, and keeping the always-on PC (in order to have access to the reader from everywhere) is problematic.  However, if you have a Zyxel Keenetic router working, then tt-rss can install a reader on it! <br><a name="habracut"></a><br>  To install you need: <br><ul><li>  Any Zyxel Keenetic router with firmware V1 </li><li>  USB flash drive, or USB hard disk (preferred) </li></ul><br>  Read more about the firmware.  Keenetic routers have two series of V1 and V2 firmware, respectively.  The firmware of the first series is notable in that they allow you to install packages on an external usb drive / flash drive.  And this is implemented without the firmware of the router itself!  However, for the second generation of Keenetic routers (Keenetic II / Keenetic Giga II / Keenetic Ultra), firmware V1 is unofficial (no technical support is provided for them).  In my case, there was a Keenetic Giga II router, which was flashed with firmware V1.  Firmware V1 for the second generation of routers can be found <a href="http://l10n.ndl.ru/firmwares/KII_Series/">here</a> (to be guided by the latest date).  The firmware process is quite simple, for this in the system settings of the router you need to go to "manage system files" and replace the <code>firmware</code> file with the downloaded <code>firmware</code> file. <br><br>  We proceed to the next step - installing the necessary packages.  Initially, you need to install the opkg package manager.  I will not consider this process, because  it is described in some detail on the <a href="http://keenetic.zyxmon.org/wiki/doku.php/wiki:ustanovka_paketov">website of the</a> author, who is building these packages, for which he thanks a lot. <br><br>  So, after opkg is installed, proceed directly to installing the necessary packages.  Connect to the router via ssh and execute the following command: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">opkg install libiconv-full libmysqlclient libncurses libncursesw libopenssl libpcre libreadline libxml2 lighttpd lighttpd-mod-fastcgi mysql-server php5 php5-cgi php5-mod-ctype php5-mod-dom php5-mod-hash php5-mod-iconv php5-mod-json php5-mod-mbstring php5-mod-mysql php5-mod-session uclibcxx mysql-server php5-mod-json php5-mod-mysql php5-mod-mbstring php5-mod-hash php5-mod-ctype php5-mod-iconv php5-mod-dom</code> </pre><br>  Now we set them up.  To configure, you must edit the configuration files on a USB flash drive / disk.  This is conveniently done using the <a href="http://winscp.net/eng/docs/lang:ru">WinSCP</a> program (in the connection settings, select the SCP protocol). <br><br>  Configure lighttpd server.  In the <code>/media/DISK_A1/system/etc/lighttpd/lighttpd.conf</code> file <code>/media/DISK_A1/system/etc/lighttpd/lighttpd.conf</code> activate the fastcgi module, for this we uncomment the lines: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">server</span></span>.modules = ( "mod_fastcgi" )</code> </pre><br>  Add index.php to the list of index file names: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">index</span></span>-file.names = ( "index.html", "default.html", "index.htm", "default.htm", "index.php" )</code> </pre><br>  And we add mime type svg for correct display of icons in the tt-rss interface: <br><br><pre> <code class="diff hljs">mimetype.assign = ( ... ".xml" =&gt; "text/xml", ".svg" =&gt; "image/svg+xml" )</code> </pre><br>  Uncomment the following lines: <br><br><pre> <code class="diff hljs">fastcgi.server = ( ".php" =&gt; ( "localhost" =&gt; ( "min-procs" =&gt; 1, "max-procs" =&gt; 1, "max-load-per-proc" =&gt; 4, "socket" =&gt; "/media/DISK_A1/system/tmp/php-fastcgi.socket", "bin-path" =&gt; "/media/DISK_A1/system/usr/bin/php-fcgi" ) ) )</code> </pre><br>  Remove the limit on the execution time of php scripts, for this we edit <code>/media/DISK_A1/system/etc/php.ini</code> Change the <code>max_execution_time</code> parameter, setting the value to <code>0</code> . <br><br>  Configure autorun http, mysql servers, and cron, which will be needed to automatically update feeds.  This is <code>/media/disk_a1/system/etc/init.d/</code> renaming the scripts in the <code>/media/disk_a1/system/etc/init.d/</code> folder.  To do this, run the following commands: <br><br><pre> <code class="bash hljs">mv /media/DISK_A1/system/etc/init.d/K02cron /media/DISK_A1/system/etc/init.d/S02cron mv /media/DISK_A1/system/etc/init.d/K27mysqld /media/DISK_A1/system/etc/init.d/S27mysqld mv /media/DISK_A1/system/etc/init.d/K50lighttpd /media/DISK_A1/system/etc/init.d/S50lighttpd</code> </pre><br>  Download the tarball from the official <a href="http://tt-rss.org/redmine/projects/tt-rss/wiki">site</a> .  Download it to the folder <code>/media/DISK_A1/system/www/</code> .  This can be done for example using the same WinSCP.  For unpacking we perform: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /media/DISK_A1/system/www/ tar -xvzf ./Tiny-Tiny-RSS-1.8.tar.gz rm ./Tiny-Tiny-RSS-1.8.tar.gz mv /media/DISK_A1/system/www/Tiny-Tiny-RSS-1.8/ /media/DISK_A1/system/www/tt-rss</code> </pre><br>  Reboot the router to start all services.  Connect to ssh router again.  Create a database called <code>mysql</code> (for the user named <code>root</code> ).  Execute commands: <br><br><pre> <code class="bash hljs">mysql_install_db --datadir=/media/DISK_A1/system/var/mysql --basedir=/media/DISK_A1/system/usr --force /media/DISK_A1/system/etc/init.d/S27mysqld restart</code> </pre><br>  Change the database access password: <br><br><pre> <code class="diff hljs">/media/DISK_A1/system/usr/bin/mysqladmin -u root password "new-password"</code> </pre><br>  Next, enter: <br><br><pre> <code class="bash hljs">mysql -u root -p</code> </pre><br>  Upon request, enter the password, which is set and enter the following commands: <br><br><pre> <code class="bash hljs">create database ttrss; use ttrss; <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> /media/DISK_A1/system/www/tt-rss/schema/ttrss_schema_mysql.sql; quit;</code> </pre><br>  To access the mysql database, you need to add an iptables rule to allow the lo interface: <code>iptables -I INPUT -i lo -j ACCEPT</code> .  To automatically execute this command upon reboot, you can add this command to the mysql server <code>/media/DISK_A1/system/etc/init.d/S27mysqld</code> autorun script: <br><br><pre> <code class="diff hljs">case "" in start) start iptables -I INPUT -i lo -j ACCEPT ;;</code> </pre><br>  Restart the mysql server: <br><br><pre> <code class="bash hljs">/media/DISK_A1/system/etc/init.d/S27mysqld restart</code> </pre><br>  We open in the browser the address <code><a href="http://192.168.1.1/"></a> 192.168.1.1:81/tt-rss/</code>  <code><a href="http://192.168.1.1/"></a> 192.168.1.1:81/tt-rss/</code> where the tt-rss installer opens: <br><br><img src="https://habrastorage.org/storage2/397/f0f/b48/397f0fb48cf0b4c9a31edd090a2c2bb0.png"><br><br>  Fill in the fields as in the screenshot.  Click test confiduration.  If everything is in order, the following messages will appear: <br><br><img src="https://habrastorage.org/storage2/d1d/751/c8d/d1d751c8dbf29cefa562663d3e9cdfba.png"><br><br>  Feel free to click Initialize database.  And then Save configuration. <br><br>  Try opening the address <code><a href="http://192.168.1.1/"></a> 192.168.1.1:81/tt-rss/</code>  <code><a href="http://192.168.1.1/"></a> 192.168.1.1:81/tt-rss/</code> .  Swears that you can not run from the root.  There are no other users in the router, so we will disable this check and allow it to run as root.  To do this, edit <code>/media/DISK_A1/system/www/tt-rss/include/sanity_check.php</code> .  In the line <code>if (function_exists('posix_getuid') &amp;&amp; posix_getuid() == 0) {</code> set <code>posix_getuid() == -1</code> . <br><br>  We update the page in the browser, enter the username admin, password password.  Everything, it is possible to use! <br><br>  To update the feeds, add the task to the cron, open the file <code>/media/DISK_A1/system/etc/crontabs/root</code> and add <br><br><pre> <code class="bash hljs">*/30 * * * * /media/DISK_A1/system/usr/bin/php-cgi /media/DISK_A1/system/www/tt-rss/update.php --feeds --quiet</code> </pre><br>  This command updates feeds every 30 minutes. <br><br>  To access the reader from the outside, you must uncomment the iptables rule in the http autorun script of the server <code>/media/DISK_A1/system/etc/init.d/S50lighttpd</code> : <br><br><pre> <code class="bash hljs">iptables -A INPUT -p tcp --dport <span class="hljs-variable"><span class="hljs-variable">$PORT_F</span></span> -j ACCEPT</code> </pre><br>  The tt-rss on the router showed an annoying bug, which is that the feeds in the win-1251 encoding do not want to be processed.  To solve this problem, you can use the following crutches.  In the <code>/media/DISK_A1/system/www/tt-rss/include/rssfuncs.php</code> file before <br><br><pre> <code class="diff hljs">if (!$rss) { $rss = new FeedParser($feed_data); $rss-&gt;init(); }</code> </pre><br>  add (thanks for the Star Per advice from the <a href="http://forum.zyxmon.org/">forum</a> ): <br><br><pre> <code class="diff hljs">if (stripos($feed_data, 'encoding="windows-1251"')) { $feed_data = str_ireplace( 'encoding="windows-1251"', 'encoding="utf-8"', iconv( 'CP1251', 'UTF-8', $feed_data ) ); }</code> </pre><br>  So we got an rss reader, which at one point will not be closed for one reason or another.  In addition, this reader works in multiplayer mode, it can be shared with your friends. <br>  Do not forget to change the default password in the reader!  Enjoy reading. </div><p>Source: <a href="https://habr.com/ru/post/185876/">https://habr.com/ru/post/185876/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../185864/index.html">Comparison of the scientific development of various countries of the world</a></li>
<li><a href="../185868/index.html">Writing a laptop display backlight controller for Gnu \ Linux</a></li>
<li><a href="../185870/index.html">Video review tablet Lenovo ThinkPad Helix</a></li>
<li><a href="../185872/index.html">NES, implementation on FPGA</a></li>
<li><a href="../185874/index.html">Master IT in the Skolkovo Institute of Science and Technology</a></li>
<li><a href="../185878/index.html">Own Web project on D under Ubuntu OS</a></li>
<li><a href="../185882/index.html">More about the evolution of racing cars</a></li>
<li><a href="../185886/index.html">NAT traversal with IPv6 & CloudFlare</a></li>
<li><a href="../185888/index.html">Reliable (non-extreme) overclocking of the processor and memory for ASUS motherboards with an i7 processor</a></li>
<li><a href="../185890/index.html">Multi-file storage of Java objects in xml format</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>