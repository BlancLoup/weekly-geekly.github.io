<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DB. Directories. MUMPS examples (Cach√© Object Script) 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the last article, we looked at an example directory on MUMPS (Cach√© Object Script). The global structures and the retrieve method were disassembled...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DB. Directories. MUMPS examples (Cach√© Object Script) 2</h1><div class="post__text post__text-html js-mediator-article">  In the last <a href="http://habrahabr.ru/company/intersystems/blog/175773/">article,</a> we looked at an example directory on MUMPS (Cach√© Object Script).  The global structures and the retrieve method were disassembled.  We have learned the simplest operation - obtaining the name of an element by a known identifier.  The structures considered were single-level.  Polls and comments, after the article, showed that the topic as a whole is interesting.  Today we look at examples of building indexes for reference books.  All codes / identifiers / global names are real.  The main idea of ‚Äã‚Äãthese articles is the <i>exchange of knowledge / experience in the development and design of live databases</i> . <br><br>  Briefly recall the main points of the <a href="http://habrahabr.ru/company/intersystems/blog/175773/">first part</a> : <br><ul><li>  <a href="http://habrahabr.ru/company/intersystems/blog/175773/">A handbook</a> is a slowly changing information; </li><li>  retrieve - quick operation; </li><li>  the name of the directory element is changed in one place; </li><li>  <a href="http://habrahabr.ru/company/intersystems/blog/175773/">Global</a> has the form: <i>^ Global Variable ("index1", "index2", ..., "indexN") = "value"</i> </li></ul><br>  At the request of <a href="http://habrahabr.ru/users/4dmonster/" class="user_link">4dmonster</a> , full versions of commands will be published in the examples.  ( <b>write</b> instead of <b>w</b> , etc.) <br><br>  Let's refresh the available data globals: <br><pre><code class="bash hljs">^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"akp"</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"meh"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span></code> </pre> <br>  Global <b>^ Dictionary</b> - contains all elements of reference books and their properties, global <b>^ NameDictionaryElement</b> - contains names of elements of reference books in all languages. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Create global Ctrl + C / V</b> <div class="spoiler_text">  <b>Set</b> command - sets the value of a variable (local or global). <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,1,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,2,0,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)=888 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"akp"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">"meh"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)=<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^NameDictionaryElement(2,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0,<span class="hljs-string"><span class="hljs-string">"UpdateTime"</span></span>)=<span class="hljs-string"><span class="hljs-string">"62086,66625"</span></span></code> </pre><br></div></div><br>  And now let's see how the directory index can be arranged, and see what it is for. <br><a name="habracut"></a><a name="index"></a><br><h4>  Definition: </h4><br>  <b><a href="http://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D0%25B4%25D0%25B5%25D0%25BA%25D1%2581">An index</a> is a number, letter, or other combination of characters indicating the location of an element, <i>or group of elements</i> , in the aggregate.</b>  The element may contain other elements.  The same applies to the index - the <i>index is always composite</i> , even if it consists of one or less parts. <br><br><div class="spoiler">  <b class="spoiler_title">We analyze the components of the global index in Cach√©</b> <div class="spoiler_text">  Remember the analysis of the word in the composition of the lessons of the Russian language?  Where prefix, root, sufix, ending is searched.  Here is something very similar.  First we need the word (global / local variable).  Let our word be <b>^ | "MONTOLOGY" | NameDictionaryElement (1, "ru", 0)</b> .  Between the vertical sticks <b>|</b>  specified namespace <b>|</b>  - it is necessary for the maximum completeness of the demonstration of the composition of the global index (variable).  Recall the meaning of our word - execute the <b>write</b> command: <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;write ^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)  MONTOLOGY&gt;</code> </pre><br>  Our word <b>^ | "MONTOLOGY" | NameDictionaryElement (1, "ru", 0)</b> means <b>automatic transmission</b> (automatic transmission). <br><br>  In addition to the word, for the analysis we need the system function <b><a href="">$ name ()</a></b> , which returns the name of the variable in the canonical form.  <b>Set</b> command - sets the value of a variable (local or global).  Create a local variable <b>slovo</b> and demonstrate the operation of the <b>$ name ()</b> function.  In one line, execute two <b>set</b> and <b>write</b> commands (commands separated by at least one space): <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> slovo=<span class="hljs-variable"><span class="hljs-variable">$name</span></span>(^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)) write slovo ^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0) MONTOLOGY&gt;</code> </pre><br><a name="indirection"></a><br>  If now, having only the <b>slovo</b> variable, we will need to re-read (or write down) the meaning of our word - we can use the indirection operator <b>@</b> <br><br>  Example: <br><pre> <code class="bash hljs">MONTOLOGY&gt;write @slovo  MONTOLOGY&gt;</code> </pre><br>  So, the <b>slovo</b> variable contains the name of our word <b>^ | "MONTOLOGY" | NameDictionaryElement (1, "ru", 0)</b> in the canonical form.  We proceed to his analysis.  Use the <b><a href="">$ qsubscript ()</a></b> function <b><a href="">.</a></b> Using a <b>for</b> loop, you can shorten the record and the explanation.  The <b>write</b> command and the <b>for</b> loop are written on one line in order to execute this command from the terminal: <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;write <span class="hljs-string"><span class="hljs-string">": "</span></span>_slovo,! <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i=-1:1:3 { write <span class="hljs-string"><span class="hljs-string">"  "</span></span>_i_<span class="hljs-string"><span class="hljs-string">"- : "</span></span>_<span class="hljs-variable"><span class="hljs-variable">$qsubscript</span></span>(slovo,i),! } : ^|<span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span>|NameDictionaryElement(1,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,0)  -1- : MONTOLOGY  0- : ^NameDictionaryElement  1- : 1  2- : ru  3- : 0 MONTOLOGY&gt;</code> </pre><br>  The underscore " <b>_</b> " is a concatenation character (stitching together strings).  The exclamation mark " <b>!</b> " Inside the <b>write</b> command is a newline.  If to be completely accurate, the limit value of the end of the cycle: the number <b>3</b> - must be replaced by the function <b><a href="">$ qlength (slovo)</a></b> .  It returns the maximum index number of the variable.  However, for simplicity, I just wrote <b>3</b> . <br><br>  So we see: <br><ul><li>  <b>The 1st</b> index is the name of the namespace; </li><li>  <b>The 0th</b> index is, in fact, the name of the global (up to the parentheses); </li><li>  <b>1st, 2nd, 3rd</b> (and further) are global indexes in brackets. </li></ul><br>  That is, a variable (local or global) in itself necessarily contains several indices.  In order to get the value of a variable, we need to know the values ‚Äã‚Äãof all its composite indices. <br></div></div><br><h5>  Preventing confusion with the word <b>index,</b> note the following: </h5><br><ul><li>  Any variable in Cach√© local or global is always indexed. </li><li>  The meaning of the variable to be inserted into the <b>i-</b> th index (variable index at the <b>i</b> -th level) is determined by the developer. </li><li>  The value of the <b>i-</b> th variable index = the value of the <b>i-</b> th word in brackets after the variable name = <b>$ qsubscript (variable, i)</b> </li><li>  A directory index (or index global) is a global designed and filled in a special way designed to make the search for directory elements convenient.  It does not contain any additional built-in or system "indexality", except for the meaning invested in it by the developer. </li></ul><br><h4>  Directory Indexes </h4><br>  Indexes are needed to quickly find information.  Depending on the type of search, different indexes may be required.  Consider an example of an index for the simplest search by value. <br><a name="IndexDictionary"></a><br>  We assume that the indices of the global <b>^ IndexDictionary</b> will mean the following: <br><ol><li>  ontology (rough classification of reference books) - our ontology <b>Vehicle</b> (vehicles) </li><li>  directory name - <b>TransmissionType</b> (transmission type) </li><li>  element property name </li><li>  element property value (or language name, if previous index = <b>"name"</b> ) </li><li>  reference element identifier (or lower-case element name, if the previous index is the language name) </li><li>  reference item identifier (only if there was an element name at the previous level, for all other properties except <b>‚Äúname‚Äù</b> , this index is absent) </li></ol><br>  Print the contents of the global <b>^ IndexDictionary</b> execute the command: <br>  <b>zwrite ^ IndexDictionary ("Vehicle", "TransmissionType")</b> <br>  I remind you that <b>‚ÄúMONTOLOGY‚Äù</b> is the name of the namespace. <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;zwrite ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>) ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"akp"</span></span>,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"meh"</span></span>,2)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,2)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,1)=1 ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,2)=1 MONTOLOGY&gt;</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Create Global Ctrl + C / V</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"akp"</span></span>,1)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>,<span class="hljs-string"><span class="hljs-string">"meh"</span></span>,2)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,1)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,2)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,1)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,2)=1</code> </pre><br></div></div><br>  Let's take a closer look at the structure of the index global.  The values ‚Äã‚Äãof indexed variables do not carry any semantic load, therefore, for simplicity, they are equal to one everywhere.  All the information we are interested in is contained solely in the indices.  Note that the first and second index of the global <b>^ IndexDictionary</b> , <a href="http://habrahabr.ru/company/intersystems/blog/175773/">coincides</a> with the first and second index of the global <b>^ Dictionary</b> .  The values ‚Äã‚Äãof the properties of elements go only at the 4th or 5th (for names) level.  Since our global should provide fast search by value, its very structure implies certain search conditions.  All preliminary indexes are known initially.  That is, before we start looking for something, we already know: the ontology, the type of the directory element, the name of the property and its value.  Obviously, such an index global is not suitable for analyzing full-text user requests.  But in this case - it is not required.  Let's try to find in the global directory element (s) of the property value.  We need a <b><a href="">$ order ()</a></b> function that returns the next variable index at a given level.  If there is no next index, the function will return the empty string <b>""</b> .  Let us demonstrate the operation of the <b>$ order ()</b> function: <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;write <span class="hljs-variable"><span class="hljs-variable">$order</span></span>(^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>)) name MONTOLOGY&gt;write <span class="hljs-variable"><span class="hljs-variable">$order</span></span>(^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>)) uid MONTOLOGY&gt;write <span class="hljs-variable"><span class="hljs-variable">$order</span></span>(^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>)) MONTOLOGY&gt;</code> </pre><br>  That is, the next index on the third level, after the empty string <b>""</b> , is the first occurring value of the index of the third level - <b>"name"</b> .  The next index on the third level after <b>‚Äúname‚Äù</b> is <b>‚Äúuid‚Äù</b> .  The next index on the third level after the <b>"uid" is</b> not, an empty line is printed.  In order to find the first identifier (perhaps the name is not unique) of the <b>TransmissionType</b> directory element with the Russian name <b>‚Äúmech‚Äù,</b> simply run the following command: <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;write <span class="hljs-variable"><span class="hljs-variable">$order</span></span>(^IndexDictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"name"</span></span>,<span class="hljs-string"><span class="hljs-string">"ru"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>)) 2 MONTOLOGY&gt;</code> </pre><br><h4>  retrieveListByIndex </h4><br>  We write a subroutine to display a list of directory elements by the value of any property (except the name). <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#; -------------------------------------------------------------------------------------------------- #;   #; -------------------------------------------------------------------------------------------------- Dictionary #; -------------------------------------------------------------------------------------------------- #;      . #; -------------------------------------------------------------------------------------------------- retrieveListByIndex(ontology,type,index,value) set id="" for { set id=$o(^IndexDictionary(ontology,type,index,value,id)) quit:id="" write id,! } quit #; --------------------------------------------------------------------------------------------------</span></span></code> </pre><br>  Note that <b>for {}</b> is an infinite loop.  The exit condition is described inside it by the <b>quit: id = ""</b> construct <br>  As soon as <b>id</b> becomes an empty string (and this happens when the next index on the fifth level is not present), the subroutine will exit the loop.  Find all elements of the <b>TransmissionType</b> help file added / edited by the user <b>888</b> (uid = 888): <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888) 1 2 MONTOLOGY&gt;</code> </pre><br>  We modify our subroutine in order for it to additionally be able to search for elements whose names begin with a certain substring.  Expand the output format (add the name of the element).  I will give the program code of the <b>Dictionary</b> along with the <b><a href="http://habrahabr.ru/company/intersystems/blog/175773/">retrieve</a></b> prod from the last part: <br><br><div class="spoiler">  <b class="spoiler_title">Dictionary code:</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#; -------------------------------------------------------------------------------------------------- #;   #; -------------------------------------------------------------------------------------------------- Dictionary #; -------------------------------------------------------------------------------------------------- #;   . #; -------------------------------------------------------------------------------------------------- retrieve(id,lang="ru",version=0) quit $get(^NameDictionaryElement(id,lang,version),"") #; -------------------------------------------------------------------------------------------------- #;      . #; -------------------------------------------------------------------------------------------------- retrieveListByIndex(ontology,type,index,value,str="",lang="ru") #;     ,       set str=$zconvert(str,"L") set id="" for { #;  ()    set id=$order(^IndexDictionary(ontology,type,index,value,id)) #;  ,        quit:id="" #;   set name=$$retrieve(id,lang) #;      str if $extract($zconvert(name,"L"),1,$length(str))=str { #;  (  ) write id_" "_name,! } } quit #; --------------------------------------------------------------------------------------------------</span></span></code> </pre><br>  Let me explain the new features and designs used: <br><ul><li>  <b><a href="">$ zconvert ()</a></b> - formats a string depending on the parameter passed (L - means translate to lower case); </li><li>  <b><a href="">$ length ()</a></b> - returns the length of the string; </li><li>  <b><a href="">$ extract ()</a></b> - selects a substring from a string with a specific starting and ending position.  In our case, starting with the first character and ending with a long <b>str</b> at the input of the subroutine. </li><li>  <b>set name = $$ retrieve (id, lang)</b> - calling the subroutine from the current program the program name can be omitted, although the construction <b>set name = $$ retrieve ^ Dictionary (id, lang)</b> will return the same result. </li></ul><br></div></div><br>  Let's try to look at the result of our program: <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888) 1  2  MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,<span class="hljs-string"><span class="hljs-string">"A"</span></span>) MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,<span class="hljs-string"><span class="hljs-string">""</span></span>) 2  MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,<span class="hljs-string"><span class="hljs-string">""</span></span>) 1  MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,<span class="hljs-string"><span class="hljs-string">""</span></span>) 2  MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>) MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,<span class="hljs-string"><span class="hljs-string">"m"</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>) 2 meh MONTOLOGY&gt;<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> retrieveListByIndex^Dictionary(<span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span>,<span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span>,<span class="hljs-string"><span class="hljs-string">"uid"</span></span>,888,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"partUri"</span></span>) 1 akp 2 meh MONTOLOGY&gt;</code> </pre><br>  I want to immediately note that the search engine for a name starting with a given substring, described in <b>retrieveListByIndex</b> , is not the most effective, it is just an option.  In more detail this topic will be covered further. <br><br>  So, in our reference subsystem, there are already three important significant global: <br><ul><li>  <b>^ Dictionary</b> - dictionary elements and their properties; </li><li>  <b>^ NameDictionaryElement</b> - names of elements of reference books in various languages; </li><li>  <b>^ IndexDictionary</b> - the main index of directories. </li></ul><br><a name="RefsDictionary"></a><br>  Obviously, to efficiently update / delete directory elements - one more global will be needed - which stores backlinks.  This is necessary in order not to perform any search when deleting data (when updating, the minimum necessary checks will be performed).  <b>Let's</b> call this global <b>RefsDictionary</b> .  Print all the backlinks for elements <b>1</b> and <b>2</b> : <br><br><pre> <code class="bash hljs">MONTOLOGY&gt;zwrite ^RefsDictionary(1),^RefsDictionary(2) ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"akp"</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,1)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"meh"</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,2)"</span></span>)=1 MONTOLOGY&gt;</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Create Global Ctrl + C / V</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"akp"</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",1)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(1,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,1)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"partUri"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"meh"</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"name"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"ru"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">""</span></span><span class="hljs-string"><span class="hljs-string">",2)"</span></span>)=1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ^RefsDictionary(2,<span class="hljs-string"><span class="hljs-string">"^|"</span></span><span class="hljs-string"><span class="hljs-string">"MONTOLOGY"</span></span><span class="hljs-string"><span class="hljs-string">"|IndexDictionary("</span></span><span class="hljs-string"><span class="hljs-string">"Vehicle"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"TransmissionType"</span></span><span class="hljs-string"><span class="hljs-string">","</span></span><span class="hljs-string"><span class="hljs-string">"uid"</span></span><span class="hljs-string"><span class="hljs-string">",888,2)"</span></span>)=1</code> </pre><br></div></div><br>  I think some of you, dear readers, have already guessed why <b>^ RefsDictionary is needed</b> and why it has such a structure.  More on this in the next article. <br><br>  Thanks for attention. <br><br>  I will be glad to questions, comments and suggestions. <br><br><h4>  PS: </h4>  I have practically no experience in writing technical articles, so <a href="http://habrahabr.ru/company/intersystems/blog/174655/">‚Äúattempts at Habr√© to show that the globals are cool‚Äù</a> didn‚Äôt stop, but just move at low speed.  Perhaps, on the May holidays, I can spend more time on this topic. </div><p>Source: <a href="https://habr.com/ru/post/177319/">https://habr.com/ru/post/177319/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../177305/index.html">IE 10, Windows 8 and Metro UI</a></li>
<li><a href="../177307/index.html">Devconf @ Mobi () - June 14 in Moscow - the authors of famous mobile applications share their development experience</a></li>
<li><a href="../177309/index.html">DevConf :: Python () June 14 in Moscow - the author of the book ‚ÄúPorting to Python 3‚Äù arrives</a></li>
<li><a href="../177313/index.html">Configure 2X ApplicationServer XG and publish Windows applications for Android, iOS, Linux, Windows, Mac and browsers with HTML5 support</a></li>
<li><a href="../177315/index.html">Foundation 4</a></li>
<li><a href="../177321/index.html">Twitter #Music</a></li>
<li><a href="../177325/index.html">Competition "NOKIA LUMIA 920 REVIEW": the best</a></li>
<li><a href="../177327/index.html">05 - HP Z420 - powerful workstation and virtualization tools</a></li>
<li><a href="../177329/index.html">Citrix NetScaler Key Feature Overview</a></li>
<li><a href="../177331/index.html">In Kiev, Kiev Games Night was held on the topic "How to open your game dev studio"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>