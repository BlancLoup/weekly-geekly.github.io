<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Alice. How Yandex teaches artificial intelligence to talk to people</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the future, it seems to us, people will interact with devices using voice. Already, applications recognize the exact voice commands put into them b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Alice. How Yandex teaches artificial intelligence to talk to people</h1><div class="post__text post__text-html js-mediator-article">  In the future, it seems to us, people will interact with devices using voice.  Already, applications recognize the exact voice commands put into them by the developers, but with the development of artificial intelligence technologies they will learn to understand the meaning of arbitrary phrases and even keep up the conversation on any topic.  Today we will tell Habr's readers how we are bringing this future closer by the example of <a href="https://alice.yandex.ru/">Alice</a> , the first voice assistant, who is not limited to a set of predetermined answers and uses neural networks for communication. <br><br><img src="https://habrastorage.org/webt/59/db/5d/59db5da34a176785178064.png"><br><br>  Despite the seeming simplicity, the voice assistant is one of the most large-scale technological projects of Yandex.  From this post, you will learn what difficulties the developers of voice interfaces face, who actually writes answers for virtual assistants, and what Alice has in common with the artificial intelligence from the film ‚ÄúShe‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  At the dawn of its existence, computers were mainly used in large scientific or defense enterprises.  Only fiction writers then thought about voice control, but in reality, the operators loaded the programs and data using a piece of cardboard.  Not the most convenient way: one mistake, and everything needs to start over. <br><br>  Over the years, computers have become more accessible and are beginning to be used in smaller companies.  Specialists manage them using text commands entered in the terminal.  A good, reliable way - it is used in a professional environment to this day, but requires preparation.  Therefore, when computers began to appear in the homes of ordinary users, engineers began to look for simpler ways of interaction between the machine and the person. <br><br>  The concept of graphical user interface WIMP (Windows, Icons, Menus, Point-n-Click) is emerging in the Xerox laboratory - it has found mass use in products from other companies.  Learning text commands to control your home computer was no longer necessary - they were replaced by gestures and mouse clicks.  For its time, it was a real revolution.  And now the world is approaching the next. <br><br>  Now almost everyone has a smartphone in his pocket, with enough computing power to land the ship on the moon.  The mouse and keyboard replaced the fingers, but with them we make all the same gestures and clicks.  It is convenient to do, sitting on the couch, but not on the road or on the go.  In the past, to interact with computer interfaces, man had to master the language of machines.  We believe that now is the time to teach devices and applications to communicate in the language of the people.  It was this idea that formed the basis of Alice‚Äôs voice assistant. <br><br>  Alice can be asked [Where is nearby to drink coffee?], And not to dictate something like [coffee shop astronauts street].  Alice will look at Yandex and suggest the right place, and the question [Great, and how to get there?] Will give a link to the already constructed route in Yandex.Maps.  She is able to distinguish exact factual questions from the desire to see the classic search results, rudeness from a polite request, the command to open a website from a desire to just chat. <br><br><img src="https://habrastorage.org/webt/59/db/5d/59db5dea46103708384629.png"><br><br>  It may even seem that somewhere in the cloud a neural miracle network works, which alone solves any tasks.  But in reality, any answer from Alice hides a whole chain of technological problems, which we have been learning to solve for 5 years.  And we begin our excursion from the very first link - the ability to listen. <br><br>  <b>Hi Alisa</b> <br><br>  Artificial intelligence from science fiction can listen - people do not have to press special buttons to turn on the ‚Äúrecording mode‚Äù.  And for this you need voice activation - the application must understand that the person is accessing it.  This is not as easy as it may seem. <br><br>  If you simply start recording and processing the entire incoming audio stream on the server, then very quickly discharge the device's battery and spend all mobile traffic.  In our case, this is solved with the help of a special neural network that is trained solely on the recognition of key phrases (‚ÄúHello, Alice‚Äù, ‚ÄúListen, Yandex‚Äù and some others).  Support for a limited number of such phrases allows you to perform this work locally and without accessing the server. <br><br>  If the network is trained to understand only a few phrases, you might think that it is quite simple and fast to do.  But no.  People utter phrases far from ideal conditions, but surrounded by completely unpredictable noise.  And the voices are different.  Therefore, to understand only one phrase requires thousands of training records. <br><br>  Even a small local neural network consumes resources: you can not just take and start processing the entire stream from a microphone.  Therefore, a less potent algorithm is applied at the forefront, which cheaply and quickly recognizes the event ‚Äúspeech began‚Äù.  It includes the neural network key word recognition engine, which in turn launches the hardest part - speech recognition. <br><br>  If thousands of examples are necessary for learning only one phrase, then you can imagine how difficult it is to train a neural network to recognize any words and phrases.  For the same reason, recognition is performed in the cloud, where the audio stream is transmitted, and from where ready-made answers are returned.  The accuracy of the answers depends on the quality of recognition.  That is why the main challenge is to learn to recognize speech as well as a person does.  By the way, people make mistakes too.  It is believed that a person recognizes 96-98% of speech (WER metric).  We managed to achieve an accuracy of 89-95%, which is not only comparable to the level of a live interlocutor, but also unique to the Russian language. <br><br>  But even a speech ideally transformed into text will mean nothing if we cannot understand the meaning of what has been said. <br><br>  <b>What is the weather tomorrow in St. Petersburg?</b> <br><br>  If you want your application to display the weather forecast in response to a voice query [weather], then everything is simple - compare the recognized text with the word ‚Äúweather‚Äù and if you get a match, output the answer.  And this is a very primitive way to interact, because in real life people ask questions differently.  A person may ask an assistant [What is the weather tomorrow in St. Petersburg?], And he should not be confused. <br><br>  The first thing Alice does when she receives a question is that she recognizes the script.  Send a search query and show a classic issue with 10 results?  Search for one exact answer and immediately give it to the user?  Take an action, for example, open a website?  Or maybe just talk?  It is incredibly difficult to teach the machine to accurately recognize scenarios of behavior.  And any mistake here is unpleasant.  Fortunately, we have all the power of the Yandex search engine, which every day encounters millions of queries, searches for millions of answers and learns to understand which ones are good and which are not.  This is a huge knowledge base, on the basis of which you can train another neural network - one that would with high probability "understand" what a person wants.  Mistakes, of course, are inevitable, but they are also committed by people. <br><br>  Using machine learning, Alice "understands" that the phrase [What is the weather tomorrow in St. Petersburg?] Is a weather query (by the way, this is obviously a simple example for clarity).  But what city are we talking about?  On what date?  This is where the extraction of Named Entity Recognition from user replicas begins.  In our case, two such objects carry important information: Peter and Tomorrow.  And Alice, who has search technologies behind her, ‚Äúunderstands‚Äù that ‚ÄúPeter‚Äù is a synonym for ‚ÄúSt. Petersburg‚Äù, and ‚Äútomorrow‚Äù is ‚Äúcurrent date + 1‚Äù. <br><br><img src="https://habrastorage.org/webt/59/db/5e/59db5e342c03a021686062.png"><br><br>  Natural language is not only the external form of our replicas, but also their coherence.  In life, we do not exchange short phrases, but we conduct a dialogue ‚Äî it is impossible if the context is not remembered.  Alice remembers him - it helps her to deal with complex linguistic phenomena: for example, to cope with an ellipsis (to restore the missing words) or to allow coreference (to define an object by a pronoun).  So, if you ask [Where is Elbrus?], And then specify [And what is its height?], Then the assistant will find the right answers in both cases.  And if after asking [What is the weather today?] To ask [And tomorrow?], Alice will understand that this is a continuation of the dialogue about the weather. <br><br><img src="https://habrastorage.org/webt/59/db/5e/59db5e63632f6181148584.png"><br><br>  And something else.  An assistant must not only understand natural language, but also be able to speak it - as a person, not as a robot.  For Alice, we will synthesize a voice, originally owned by dubbing actress Tatiana Shitova (the official voice of Scarlett Johansson in Russia).  She voiced artificial intelligence in the <a href="https://www.kinopoisk.ru/film/ona-2013-577488/">film ‚ÄúShe‚Äù</a> , although you could remember her by the voice acting of the sorceress Jennifer in The Witcher.  And we are talking about a rather deep synthesis using neural networks, and not about cutting ready-made phrases - it is impossible to record all their diversity in advance. <br><br>  Above, we described the features of natural communication (unpredictable form of cues, missing words, pronouns, mistakes, noise, voice) with which you need to be able to work.  But live communication has one more feature - we do not always require a particular answer or action from the interlocutor, sometimes we just want to talk.  If the application sends such requests to the search, then all the magic will be destroyed.  That is why popular voice assistants use a database of editorial responses to popular phrases and questions.  But we went even further. <br><br>  <b>And chat?</b> <br><br>  We taught the machine to answer our questions, to conduct a dialogue in the context of certain scenarios and to solve user problems.  This is good, but can it be made less soulless and endow with human properties: give it a name, teach her to talk about herself, keep up the conversation on free topics? <br><br><img src="https://habrastorage.org/webt/59/db/5e/59db5e9295dcc076299597.png"><br><br>  In the voice assistants industry, this task is accomplished with the help of editorial responses.  A special team of authors takes hundreds of the most popular questions from users and writes several answers for each.  Ideally, this should be done in the same style, so that the integral personality of the assistant can be formed from all the answers.  For Alice, we also write the answers - but we have something else.  Something special. <br><br>  In addition to the top of popular questions, there is a long tail of low-frequency or even unique phrases for which it is impossible to prepare an answer in advance.  You guessed it, with the help of which we solve this problem, right?  Using another neural network model.  Alice uses a neural network, trained on a huge database of texts from the Internet, books and films, to answer questions and replicas unknown to her.  Connoisseurs of machine learning may be interested in what we started with a 3-layer neural network, and now we are experimenting with a huge 120-layer one.  We will save the details for specialized posts, but here we say that the current version of Alice is trying to respond to arbitrary phrases with the help of a ‚Äúneural net talker‚Äù ‚Äîthat is what we call it inside. <br><br><img src="https://habrastorage.org/webt/59/db/5e/59db5eba51586278147941.png"><br><br>  Alice learns from a huge number of various texts in which people and characters do not always behave politely.  A neural network may not learn at all what we want to teach it. <br><br><blockquote>  - Order me a sandwich. <br>  - You will manage. </blockquote><br>  Like any child, Alice cannot be taught not to be rude, protecting her from all manifestations of rudeness and aggression - that is, teaching the neural network on a ‚Äúclean‚Äù base, where there are no rudeness, provocations and other unpleasant things that are often found in the real world.  If Alice does not know about the existence of such expressions, she will respond to them thoughtlessly, with random phrases ‚Äî for her they will remain unknown words.  Let her know better what it is - and work out a certain position on these issues.  If you know what a mat is, you can either swear in response, or say that you will not begin to talk with the swearing.  And we model Alice's behavior so that she chooses the second option. <br><br>  It so happens that Alice's remark itself is completely neutral, but in the context given by the user, the answer is no longer harmless.  Once, even during the closed testing, we asked the user to find some places - a cafe or something like that.  He said: "Find another one the same."  And at that moment a bug occurred in Alice, and instead of launching the organization‚Äôs search script, she gave a rather bold answer - something like ‚Äúlook on the map‚Äù.  And did not look for anything.  The user was surprised at first, and then surprised us, praising Alice's behavior. <br><br>  When Alice uses the ‚Äúneural network talker,‚Äù a million different personalities can appear in her, as the neural network absorbed a little from the author of each replica from the training sample.  Depending on the context, Alice can be polite or rude, cheerful, or depressive.  We want the personal assistant to be a complete personality with a well-defined set of qualities.  Here our editorial texts come to the rescue.  Their peculiarity is that they were originally written on behalf of the person that we want to recreate in Alice.  It turns out that you can continue to teach Alice on millions of lines of random texts, but she will respond with an eye to the pattern of behavior laid down in the editorial responses.  And this is what we are already working on. <br><br>  Alice became the first voice assistant known to us, who tries to maintain communication not only with the help of editorial answers, but also using a trained neural network.  Of course, we are still very far from what is portrayed in modern fiction.  Alice does not always accurately recognize the essence of the replica, which affects the accuracy of the answer.  Therefore, we still have a lot of work. <br><br>  We are planning to make Alice the most humanoid assistant in the world.  Instill in her empathy and curiosity.  To make it proactive is to teach you to set goals in a dialogue, take the initiative and involve the interlocutor in the conversation.  Now we are both at the very beginning of the journey and at the forefront of the sciences studying this field.  To move on, you have to move this edge. <br><br>  <a href="https://alice.yandex.ru/">You can talk to Alice</a> in the Yandex application for Android and iOS, in the <a href="https://alice.yandex.ru/windows">beta version</a> for Windows, and soon in the Yandex Browser.  We would be interested to discuss how you see the future of voice interfaces and scenarios for its use. </div><p>Source: <a href="https://habr.com/ru/post/339638/">https://habr.com/ru/post/339638/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339624/index.html">10 famous logos drawn from memory</a></li>
<li><a href="../339626/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ283 (October 2 - 8, 2017)</a></li>
<li><a href="../339628/index.html">We unite Websockets, Lisp and functional programming</a></li>
<li><a href="../339630/index.html">PHP Digest number 118 - the latest news, materials and tools (September 24 - October 9, 2017)</a></li>
<li><a href="../339636/index.html">Kali Linux: Types of Information Systems Checks</a></li>
<li><a href="../339640/index.html">ICO's birth defect: how tokens threaten the future of projects financed by them</a></li>
<li><a href="../339642/index.html">Search for files by tags in XMP / IPTC and operations with the found</a></li>
<li><a href="../339644/index.html">How to choose a data center for an IT project in Russia: uptime, money and overall adequacy</a></li>
<li><a href="../339646/index.html">Trillion Markets: Example One - eSports</a></li>
<li><a href="../339648/index.html">How to get a free SSL certificate from Amazon and move to HTTPS on Amazon S3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>