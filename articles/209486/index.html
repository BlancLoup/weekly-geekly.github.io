<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DNS server spoofing. be careful</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, habrosoobschestvu. 

 I want to share with you the case that recently happened to me. I hope this article will be able to protect someone from the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DNS server spoofing. be careful</h1><div class="post__text post__text-html js-mediator-article">  Hi, habrosoobschestvu. <br><br>  I want to share with you the case that recently happened to me.  I hope this article will be able to protect someone from the loss of private data and even money. <br><a name="habracut"></a><br><h4>  Outset </h4><br>  It all started with the fact that one of my friends complained that the mobile version of VKontakte was closed.  I was very surprised, because I did not see any objective reasons for this, and I hurried to check whether this was true.  The transition to m.vk.com dispelled my doubts - everything worked.  During the inquiry of a friend, it turned out that he had m.vk.com reporting that the entire service had moved to a mobile application and offered to download this application.  Obviously, this is naughty viruses, I thought, and asked a friend to give a look at his car. <br><br>  First of all, I personally looked at this fake, everything looked very plausible: it was well designed and the URL was exactly m.vk.com.  So, one could really think that the mobile version of the VC was closed. <br>  Well what could it be?  Of course, hosts!  Opening it, I was ready to save a friend from a terrible misfortune, but ... there was nothing in the file, except for standard comments.  There was also no other, hidden hosts, as is sometimes the case.  A careful study of the running processes did not give anything interesting, absolutely like the googling of the application offered for download.  I became thoughtful. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      My thought processes were interrupted by an acquaintance, saying that the same story happens when I try to log in to the VC from the phone.  It was a clue.  The phone was connected to a home wi-fi point, the same as the problem computer.  Asking a friend to log in to the VC from the mobile Internet, disconnecting from wi-fi, I dismissed the option of infecting the phone - the real version opened.  There was only one conclusion - the router is infected. <br><br><h4>  All the fault of irresponsibility </h4><br>  Turning to 192.168.1.1, I asked a friend for the login and password from the router and heard in response ... <b>admin: admin</b> !  What?!  How could you not change the password on the router distributing wi-fi?  Striking irresponsibility!  A friend shrugged. <br>  Checking the DNS, I found the following: <br><br><blockquote>  176.102.38.70 <br>  8.8.8.8 </blockquote><br>  The second address is well known to me, it‚Äôs Google‚Äôs DNS, but I‚Äôve never met the first one.  He was not even from our region. <br>  Nothing, except to go to this <a href="http://176.102.38.70/">address</a> , did not occur.  A fake QIWI appeared before me, with it, again, of excellent quality.  (By the way, he is still there). <br><br>  I deleted this address from DNS, replacing it with the standard one for our region, changed the password on the router and restarted it.  After that, everything worked as expected.  After listening to the thanks of a friend, I decided to tackle the fake more closely. <br><br><h4>  What a twist </h4><br>  2ip.ru said that the address is Ukrainian and showed what range it is from.  The range was small, so it would be logical to scan it.  No sooner said than done.  Half an hour of fuss and another interesting address was discovered.  Here it is: <b>176.102.38.39</b> . <br><br>  Now profanity is located there, but when I found it, there was a form called ‚ÄúFake admin panel‚Äù and login and password fields.  You never know?  I thought, and entered <b>admin: admin</b> .  What do you think happened? <br><br>  I found myself in the admin, with logs of all entries in the fakes fakes scam!  Amazingly, they got caught on their own method of infection. <br>  I admit, at first I thought it was a hanipot, and tried to enter one of the QIWI wallets from the log.  The data was correct, on the account of the wallet was about 1000 rubles.  So this is not a hanipot.  I went out of my wallet, and began to study the admin panel. <br><br><h4>  In the rear of the enemy </h4><br><div class="spoiler">  <b class="spoiler_title">Decorated admin was tastefully</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/a98/e6d/87c/a98e6d87cf1b65ef9aa7d03d4ddb17b0.png" alt="image"><br>  (these toys from above were moving when you put a rat on them, and they made a sound (and it was not a flash drive)) </div></div><br>  In the Stat section you could see how many entrances were logged.  The situation is as follows: <br><blockquote>  VK ~ 72000 <br>  OK ~ 45000 <br>  QIWI ~ 9000 <br>  BTC - 5 </blockquote><br>  Good results (not counting btc), right? <br><br>  Separately, it is necessary to note the QIWI log, apparently, for the sake of it all that was done.  The QIWI log displayed not only the login, password and IP, but also the balance at the time of entry, as well as whether the SMS confirmation for payments was turned on (which is amazing, in most of the accounts it was turned off).  Such a log says that after logging in via a fake, a person was authorized on a real QIWI, and the poor fellow didn‚Äôt even suspect a trick. <br><br>  In the upper right corner, the number of records that have not yet been archived is displayed (I note that these records were replenished very quickly). <br>  And below (in the picture it is not visible), there were buttons for convenient export of non-archived logs to a txt file and a button for restoring all records from the archive. <br><br>  Feeling that my time is running out, I restored all the records from the QIWI archive and downloaded them myself.  I wanted to do the same with the rest of the services, but I could not.  Because the next request I saw an error 403, and then what is there now. <br><br><h4>  results </h4><br>  I cleared the resulting file from identical records and checked if my friend‚Äôs wallet was there.  A lucky friend, his wallet in the hands of scam did not get. <br>  This <a href="http://sms-area.org/result.txt">file</a> (without passwords, of course) can check if your wallet is there. <br><br><div class="spoiler">  <b class="spoiler_title">offtop</b> <div class="spoiler_text">  For the sake of experiment, scanned your subnet.  I found 8 routers, 3 of which have a standard password. </div></div><br>  Be careful, evil, evil does not sleep! <br><br>  PS: Apparently, I now have to give up the evening walks: D </div><p>Source: <a href="https://habr.com/ru/post/209486/">https://habr.com/ru/post/209486/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209472/index.html">The movement of attention based on the continuously accumulated experience of perception, as the basis of the proposed approach to the design of a strong AI</a></li>
<li><a href="../209474/index.html">Survey on the "Russian public initiative"</a></li>
<li><a href="../209476/index.html">ASUS Transformer Pad TF701T Review</a></li>
<li><a href="../209480/index.html">Php elephant on kickstarter</a></li>
<li><a href="../209482/index.html">How does mathematics help Yandex earn?</a></li>
<li><a href="../209488/index.html">Spain became the first country in the world where wind power worked more efficiently than other branches of energy production.</a></li>
<li><a href="../209490/index.html">We analyze the interface details on the example of one mobile taxi client</a></li>
<li><a href="../209496/index.html">Creating 3D illustrations - a prototype system</a></li>
<li><a href="../209498/index.html">Experience of using MNP in Russia or how I transferred the number from operator to operator</a></li>
<li><a href="../209500/index.html">Cloud.Mail.Ru + EncFS for backing up your home photo archive</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>