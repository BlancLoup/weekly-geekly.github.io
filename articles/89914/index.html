<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Adding commands to the Computer context menu and the Recycle Bin (continued)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After the article is published on Habr√©, we add our own commands to the context menu of the Explorer. Letters periodically come to me in which the aut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Adding commands to the Computer context menu and the Recycle Bin (continued)</h1><div class="post__text post__text-html js-mediator-article">  After the article is published on Habr√©, we add our <a href="http://habrahabr.ru/blogs/windows7/79443/">own commands to the context menu of the Explorer.</a> Letters periodically come to me in which the authors asked me to explain why the added commands do not appear in the context menus of the Computer or Trash folders, although some programs somehow manage to add their own commands. <br><br>  The questions are quite natural, and I myself asked myself similar questions several years ago when I studied the Windows registry.  In order not to respond to every letter, I decided to write a small continuation on the context menu in Windows. <a name="habracut"></a><br><br>  First you need to understand that, despite certain similarities with folders, Computer and Recycle Bin are special Windows objects with special properties.  In fact, there are several hundred such objects in the Windows system.  The Windows registry has a special CLSID key, which is located in the HKEY_CLASSES_ROOT branch.  If you enter this section, you will see that it contains incomprehensible sections consisting of a set of numbers that are surrounded by curly braces.  These are class identifiers (Class ID or CLSID), which are a sixteen byte number.  For simplicity, you can think of this number as a phone number.  As the telephone number corresponds to one person, so the CLSID number corresponds to a particular object. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's get down to business.  So, to add a new command to the context menu of the Computer icon (formerly My Computer), you need to find its identifier and add a new subsection in its shell section.  The Computer object corresponds to the identifier <b>{20D04FE0-3AEA-1069-A2D8-08002B30309D}</b> .  Thus, to add your command to the context menu of the <b>Computer</b> object, you need to create a new section (for example, Notepad) in the <b>HKCR \ CLSID \ {20D04FE0-3AEA-1069-A2D8-08002B30309D} \ shell</b> section, which will be displayed in the menu.  In the created section, create a subsection of <b>command</b> , in which register the program to run in the default parameter.  In our case, this will be the string notepad.exe. <br><br>  As in the examples with folders, you can edit the default value for the created Notepad section to display a more convenient name (for example, <b>Start Notepad</b> ) <br><br><img src="http://winchanger.narod.ru/registry/images/computercontext.png" alt="Add a command to the registry"><br><br>  We check - we select the Computer object in any place (the Start button menu, the icon on the Desktop or in the Explorer) and make sure that the <b>Start Notepad</b> command appears in the context menu. <br><br><img src="http://winchanger.narod.ru/registry/images/computercontext2.png" alt="New command in context menu"><br><br>  A little linger on the context menu of the Computer.  It is clear that if a third-party program has added its command to the Computer context menu, then you can delete it, knowing where to look for this command.  But do not overdo it.  For example, to remove the command <b>Management</b> , it is not necessary to delete the subsection <b>Manage</b> .  It is enough to use the <b>NoManageMyComputerVerb</b> parameter in the HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Policies \ Explorer section or use group policy (for more information about this parameter, refer <a href="http://user.alexanderklimov.ru/tutorial/tutorial.php">to the Windows Registry</a> Electronic <a href="http://user.alexanderklimov.ru/tutorial/tutorial.php">Reference</a> . In this case, you simply hide the unnecessary command in a safe way. <br><br>  You can also hide the <b>Properties</b> menu item from the Computer object context menu using the <b>NoPropertiesMyComputer</b> parameter (also available in the electronic directory). <br><br>  We do the same with the object <b>Basket</b> .  The <b>cart</b> identifier is the number <b>{645FF040-5081-101B-9F08-00AA002F954E}</b> .  Register a new section for the CLSID with a subsection of <b>command</b> .  Instead of the annoying example with the launch of Notepad, I registered the <b>Go to Habr</b> command with the launch of Google Chrome to the Habrahabr home page (C: \ Users \ tehnolog \ AppData \ Local \ Google \ Chrome \ Application \ chrome.exe http://habrahabr.ru) . <br><br><img src="http://winchanger.narod.ru/registry/images/recyclebincontext.png" alt="Recycle Brief Menu"><br><br>  For completeness, I‚Äôll add that to hide the Properties command in the context menu of the Recycle Bin, the <b>NoPropertiesRecycleBin</b> parameter is <b>used</b> . <br><br>  The topic of the context menus in Windows is not exhausted.  But I hope this material will remove some of the questions.  Good luck! </div><p>Source: <a href="https://habr.com/ru/post/89914/">https://habr.com/ru/post/89914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../89905/index.html">Flash XML parsing: win vs mac</a></li>
<li><a href="../89906/index.html">Happy webmasters</a></li>
<li><a href="../89910/index.html">Business Card Thrower and Samsung H205 Camcorder</a></li>
<li><a href="../89912/index.html">[F #] pattern matching</a></li>
<li><a href="../89913/index.html">Who buys paid content on the Internet? Part 1</a></li>
<li><a href="../89916/index.html">sudo and alias in .bashrc</a></li>
<li><a href="../89917/index.html">The only true indicator of code quality</a></li>
<li><a href="../89918/index.html">5 Tips for a good code review</a></li>
<li><a href="../89919/index.html">Fifteen TCL in 10 lines</a></li>
<li><a href="../89921/index.html">Lightshot - handy screenshot</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>