<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kaggle. Prediction of sales, depending on weather conditions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not later than last Friday I had an interview in one company at Palo Alto for the position of Data Scientist and this many hours of technical and not-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kaggle. Prediction of sales, depending on weather conditions</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/e6a/cc5/1fc/e6acc51fc837dd6602b34a12724409ca.png" width="100%"><br><br>  Not later than last Friday I had an interview in one company at Palo Alto for the position of Data Scientist and this many hours of technical and not-so-many marathon had to start with my presentation about some project in which I was engaged in data analysis.  Duration - 20-30 minutes. <br><br>  Data Science is a vast area that includes a <a href="">lot of things</a> .  Therefore, on the one hand, there is something to choose from, but, on the other hand, it was necessary to choose a project that would be correctly accepted by the public, that is, so that the listeners understand the task, understand the logic of the solution and at the same time can get into how the approach Which I used can be related to what they do every day at work. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A few months before, my friend Hindu was trying to get a job at the same company.  He told them about one of his tasks, on which he worked in graduate school.  And, without thinking, it looked good: on the one hand, it is connected with what he has been doing for the last few years at the university, that is, he can explain the details and nuances at a deep level, and on the other hand, the results of his work were published in a peer-reviewed magazine, that is, it is a contribution to the world of piggy bank knowledge.  But in practice it worked quite differently.  First, to explain what you want to do and why, you need a lot of time, and he has 20 minutes to everything about everything.  And secondly, his story about how some graph with some parameters is divided into clusters, and how it all looks like a phase transition in physics, caused a legitimate question: ‚ÄúWhy do we need this?‚Äù.  I didn‚Äôt want the same result, so I didn‚Äôt tell about the ‚ÄúQuantum Monte Carlo simulations in fermionic Hubbard model.‚Äù <br><br>  I decided to tell about one of the competitions on kaggle.com, in which I participated. <br><a name="habracut"></a><br>  The choice fell on the <a href="https://www.kaggle.com/c/walmart-recruiting-sales-in-stormy-weather">task in which it was necessary to predict the sale of goods that are sensitive to weather conditions, depending on the date and these very weather conditions</a> .  The competition was held from April 1 to May 25, 2015.  Unlike conventional competitions, in which prize-winners get big and not so much money and where it is allowed to share code and, more importantly, ideas, the prize in this competition was simple: job recruiter will look at your resume.  And since the recruiter wants to evaluate your model, it was forbidden to share code and ideas. <br><br><h2>  Task: </h2><br><ul><li>  45 hypermarkets in 20 different places on the world map (we do not know the geographical coordinates) </li><li>  111 products whose sales may theoretically depend on the weather, such as umbrellas or milk (products are anonymized. That is, we are not trying to predict how many galoshes were sold on a given day. We are trying to predict how many goods were sold, say, index 31) </li><li>  Data from January 1, 2012 to September 30, 2014 </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c01/7b4/5d6/c017b45d6444b0a029952bd6ecee2a8b.png" alt="image"><br><br>  This not very clear picture, which is borrowed from the page with the description of the data for this competition, shows: <br><ul><li>  The column with numbers on the right is meteorological stations. </li><li>  Each meteorological station has two rows: the bottom one - all dates, the top one - dates with non-standard weather conditions: storm, strong wind, heavy rain or hail, etc. </li><li>  Blue dots - train set, for which the weather and sales are known.  Red - test set.  Weather conditions are known, but there is no sale. </li></ul><br><br>  Data is presented in four csv files: <br><ul><li>  train.csv - sales of each of 111 products in each of 45 stores each day from the train set </li><li>  test.csv - dates on which it is necessary to predict sales in each of the 45 stores for each of 111 products </li><li>  key.csv - which meteorological stations are located next to which stores </li><li>  weather.csv - weather conditions for each of the days in the range from January 1, 2012 to September 30, 2012 for each of the 20 weather stations </li></ul><br><br>  Meteorological stations provide the following data (Percentage of missing values ‚Äã‚Äãin brackets.): <br><ul><li>  Maximum temperature [degrees Fahrenheit] (4.4%) </li><li>  Minimum temperature [degrees Fahrenheit] (4.4%) </li><li>  Average temperature [degrees Fahrenheit] (7.4%) </li><li>  Deviation from the expected temperature [degrees Fahrenheit] (56.1%) </li><li>  Dew point [Fahrenheit] (3.2%) </li><li>  Wet thermometer temperature [degrees Fahrenheit] (6.1%) </li><li>  Rise time (47%) </li><li>  Sunset time (47%) </li><li>  Summary description of the type of rain, fog, tornado (53.8%) </li><li>  Precipitation of snow [inches] (35.2%) </li><li>  Precipitation in the form of rain [inches] (4.1%) </li><li>  Atmospheric pressure at station [inches of mercury] (4.5%) </li><li>  Atmospheric pressure at sea level [inches of mercury] (8.4%) </li><li>  Wind speed [mph] (2.8%) </li><li>  Wind direction [degrees] (2.8%) </li><li>  Average wind speed [mph] (4.2%) </li></ul><br>  Obvious data problems: <br><ul><li>  We do not know the geographical coordinates of the stores.  And that's bad.  Rain or sun is important, but most likely Alaska and San Francisco will show different sales dynamics. </li><li>  Product names are anonymized.  We do not know if the item with ID = 35 is milk, whiskey or cotton pants. </li><li>  The organizers of the competition decided to aggravate the previous item and wrote in English and white that there are no guarantees that ID = 35 in one store will mean the same as in the other. </li><li>  Meteorological stations measure not everything and not always.  The weather data is pretty leaky.  And the question of how to fill these gaps will need to somehow be addressed. </li></ul><br><br>  For me, the main thing in any task in machine learning, on which I work - is the "question".  In the sense that you need to understand the question to find the answer.  It seems to be a tautology, but I have examples in scientific activities and in third-party projects like Kagla, when people tried to find an answer not to the question that was asked, but to some kind of invented by themselves, and this did not end well . <br><br>  The second most important is the metric.  I do not like how it sounds: "My model is more precisely yours."  It will be much more pleasant to sound similar in meaning, but a little more accurate: ‚ÄúMy model is more accurate than yours if we apply this metric for evaluation.‚Äù <br><br>  We need to predict how many goods will be sold, that is, this regression task.  The standard regression metric of the standard deviation can be used, but it is illogical.  The problem is that the algorithm, which will try to predict how many pairs of rubber boots will be sold, can predict negative values.  And then the question will be what to do with these negative values?  Reset?  Take absolute value?  It is a chore.  You can do better.  Let's make a monotonous transformation of what needs to be predicted, so that the transformed values ‚Äã‚Äãcan take on any real, including negative, values.  Predict them, and then perform the inverse transform on the interval of non-negative real numbers. <br><br>  This can be thought of as if our error function were defined like this: <br><img src="https://habrastorage.org/files/aa6/b72/ac8/aa6b72ac82d6419a9a31ec930901462d.png" width="60%"><br><br>  Where: <br><ul><li>  a - real value </li><li>  p is our prediction </li><li>  the natural logarithm of the argument shifted by 1 is a monotone map with a non-negative real axis to the whole axis, with an obvious inverse transformation. </li></ul><br><br>  But, more importantly, in this competition, the accuracy of our prediction is estimated by this very metric.  And I will use it exactly: what the organizers want, then I will give them to them. <br><br><h3>  Zero iteration or base model. </h3><br>  When working on various tasks, this approach showed itself well: as soon as you started working on a task, you create a clumsy script that makes a prediction on our test set.  It is clumsy because it is created stupidly, without thinking, without looking at the data.  And not building any distributions.  The idea is that I need a lower estimate of the accuracy of the model that I can offer.  As soon as I have such a "clumsy" script, I can check out some new ideas, create new signs, adjust the model parameters.  I usually carry out the assessment of accuracy in two ways: <br><ul><li>  The result of the evaluation of the prediction on the test set, which shows us the Public Leaderboard on kaggle. </li><li>  hold out set if the train set is large and uniform, or 5 fold cross validation if the train set is small or uneven </li></ul><br><br>  The first is good because it does not take much time.  Made a prediction, sent to the site - got the result.  The bad news is that the number of attempts per day is limited.  In this competition, it is 5. He is also good at showing the relative accuracy of the model.  Error 0.1 - is it a lot or a little?  If many of them have a smaller prediction error on the Public Leaderboard, this is a lot. <br><br>  The second is good because you can evaluate different models as many times as you like. <br><br>  The problem is that the model is evaluated, using the same metric can give different accuracy in these two approaches: <br>  Inconsistencies may be caused by: <br><ul><li>  data in train and test are collected from different distributions </li><li>  very small train or test </li><li>  tricky metric does not allow human cross validation </li></ul><br>  In practice, it is enough that the improvement in accuracy of the cross validation model corresponds to the improvement in the results on the Public Leaderboard; exact numerical matching is not necessary. <br><br>  So here.  The first thing I wrote a script that: <br><ul><li>  It surpasses the time of dawn / dusk from hours and minutes to the number of minutes since midnight. </li><li>  Summary of weather conditions in dummy variables. </li><li>  Instead of all missing values, -1. </li><li>  We connect the corresponding train.csv / test.csv, key.csv and weather.csv </li><li>  Littered train set - 4,617,600 objects. </li><li>  The resulting test set is 526,917 objects. </li></ul><br><br>  Now we need to feed this data to some algorithm and make a prediction.  There is a sea of ‚Äã‚Äãdifferent regression algorithms, each with its own pros and cons, that is, there is plenty to choose from.  My choice in this case for the base model is <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">Random Forest Regressor</a> .  The logic of this choice is that: <br><ul><li>  Random Forest has all the advantages of algorithms from the Decision Tree family.  For example, theoretically he is indifferent to whether a numerical or categorical variable. </li><li>  It works fast enough.  If my memory serves me, the complexity is O (n log (n)), where n is the number of objects.  This is worse than the stochastic gradient descent method with its linear complexity, but better than the support vector method with a nonlinear core, in which O (n ^ 3). </li><li>  Evaluates the importance of attributes, which is important for the interpretation of the model. </li><li>  Indifferent to multicollinearity and correlated data. </li></ul><br><br>  Prediction =&gt; <b>0.49506</b> <br><br><h3>  Iteration 1. </h3><br>  Usually in all online classes there is a lot of discussion about which graphs to build, in order to try to understand what is happening.  And this idea is correct.  But!  In this case there is a problem.  45 stores, 111 products, and there is no guarantee that the same ID in different stores corresponds to the same product.  That is, it turns out that it is necessary to investigate, and then predict 45 * 111 = 4995 different pairs (store, product).  For each pair, weather conditions may work differently.  The correct, simple, but not obvious idea is to build a heatmap for each pair (store, product), on which to display how many units of goods were sold for all the time: <br><br><img src="https://habrastorage.org/files/e82/cc3/26b/e82cc326b5334e60b0441a76e20584a1.png"><br><ul><li>  In the vertical - the index of the goods. </li><li>  Horizontally - Intex store. </li><li>  Brightness points - Log (how many units of goods sold for all time). </li></ul><br>  And what do we see?  The picture is quite pale.  That is, it is possible that some goods in some stores in principle were not sold.  I associate this with the geographical location of the stores.  (Who will buy a down sleeping bag in Hawaii?).  And let's exclude from our train and test those goods that have never been sold in this store. <br><ul><li>  train from 4617600 reduced to 236038 </li><li>  test from 526917 is reduced to 26168 </li></ul><br>  that is, the size of the data has been reduced by almost 20 times.  And as a consequence: <br><ul><li>  We removed some noise from the data.  As a result, the algorithm will be easier to train and predict, that is, the accuracy of the model should increase. </li><li>  The model trains much faster, that is, it is much easier to test new ideas. </li><li>  Now we train on a reduced train (236038 objects), we predict on a reduced test (26168 objects), but since Kagl wants a prediction with a size (526917 objects), we score the rest with zeros.  The logic is that if a product has never been sold in this store, then either it will never be sold or it will be sold, but we cannot predict this in any way. </li></ul><br><br>  Prediction -&gt; <b>0.14240</b> .  The error has decreased three times. <br><br><h3>  Iteration 2. </h3><br>  The train / test size reduction worked great.  Is it possible to aggravate?  It turns out that you can.  After the previous iteration, I only got 255 non-zero pairs (store, product), and this is already foreseeable.  I looked at the graphics for each pair and it turned out that some products were not sold not because of bad / good weather conditions, but simply because they were not available.  For example, here's a picture for item 93, in store 12: <br><br><img src="https://habrastorage.org/files/3fb/4b2/6ae/3fb4b26ae3274479ba069a8557ea1c02.png" width="70%"><br><br>  I do not know what kind of product, but there is a suspicion that its sales ended at the end of 2012.  You can try to remove these products from the train and put 0 in all of them in the test, as our prediction. <br><br><ul><li>  train is reduced to 191,000 objects </li><li>  test decreases to 21272 objects </li></ul><br>  Prediction -&gt; <b>0.12918</b> <br><br><h3>  Iteration 3. </h3><br>  The name of the competition involves prediction based on weather data, but, as usual, they are cunning.  The task we are trying to solve sounds different: <br>  "You have a train, you have a test, spin as you wish, but make the most accurate prediction with this metric." <br><br>  What's the difference?  The difference is that we have not only weather data, but also a date.  And the date is a source of very powerful signs. <br><ul><li>  Data for three years =&gt; annual frequency =&gt; new signs <i>year</i> and <i>number of days from new year</i> </li><li>  People get paid once a month.  It is possible that there is a monthly frequency in purchases.  =&gt; new sign <i>month</i> </li><li>  The way people make purchases can be related to the day of the week.  Rain is, of course, yes, but Friday evening is Friday evening =&gt; a new sign the <i>day of the week</i> . </li></ul><br>  Prediction -&gt; <b>0.10649</b> (by the way, we are already in the top 25%) <br><br>  What about the weather? <br>  It turns out that the weather is not very important.  I honestly tried to add weight to her.  I tried to fill in the missing values ‚Äã‚Äãin various ways, such as average values ‚Äã‚Äãon the basis of various tricky subgroups, and tried to predict the missing values ‚Äã‚Äãusing various machine learning algorithms.  Slightly helped, but at the level of error. <br><br>  The next stage is linear regression. <br>  Despite the seeming simplicity of the algorithm, and a bunch of problems that this algorithm has, it also has significant advantages that make it one of my favorite regression algorithms. <br><br><ul><li>  Category attributes such as day of the week, month, year, store number, product index are distilled in dummy variables </li><li>  Scaling to increase convergence rate and results interpretability. </li><li>  Twist the L1 and L2 parameters of regularization. </li></ul><br><br>  Prediction -&gt; <b>0.12770</b> <br>  This is worse than Random Forest, but not so much. <br><br>  The question is, why do I even need linear regression on nonlinear data?  There is a reason.  And the reason for this - an assessment of the importance of signs. <br><br>  I use three different approaches for this assessment. <br>  The first is what RandomForest issues after we have trained it: <br><img src="https://habrastorage.org/files/f71/1d4/953/f711d4953984409e837ff22a874d4939.png" width="70%"><br>  What do we see in this picture?  The fact that the type of goods sold, as well as the store number is important.  And the rest is much less important.  But this we could say, even without looking at the data.  Let's remove the item type and store number: <br><img src="https://habrastorage.org/files/ec4/f90/e59/ec4f90e594d24a07b164732245d089ae.png" width="70%"><br>  And what is it?  Year - perhaps it is logical, but it is not obvious to me.  The pressure was clear to me, by the way, but the people to whom I was speaking were not very good.  Still, in St. Petersburg, the frequent change of weather, which is accompanied by a change in atmospheric pressure, and how it changes mood and health, especially in older people, I was aware of.  To people living in California, with its stable climate, this was not obvious.  What's next?  The number of days from the beginning of the year is also logical.  Cuts off what season we are trying to predict sales.  And the weather, anyway, with the season may be connected.  Then the day of the week is also understandable.  Etc. <br><br>  The second method is the absolute value of the coefficients that the linear regression produces on the scaled data.  The greater the coefficient - the more influence it has. <br><br><img src="https://habrastorage.org/files/0d7/b2c/2fa/0d7b2c2facab41f6a14f2edac36a7c23.png" width="70%"><br><br>  The picture looks like this and there is little that is clear.  The reason that there are so many signs is that, for example, the type of goods for RandomForest is one sign, and here there are as many as 111, the same with the store number, month and day of the week.  Let's remove the item type and store number. <br><br><img src="https://habrastorage.org/files/d71/9e2/d9c/d719e2d9c03647a6938390bcc827ee73.png" width="70%"><br>  That's better.  What's going on here?  Month is important, and especially if it is December, January or November.  It seems also logical.  Winter.  Weather.  And, importantly, the holidays.  There is a new year, thanksgiving, and christmas. <br><br>  The third method is the brute force method, throwing out the signs one by one and see how this will affect the prediction accuracy.  The most reliable, but the most dreary. <br><br>  With the finding of signs and their interpretation, we seem to have finished, now numerical methods.  It's all straightforward.  We try different algorithms, find the optimal parameters manually or using GridSearch.  We combine.  Predict. <br><br><ul><li>  Linear regression ( <b>0.12770</b> ) </li><li>  Random Forest ( <b>0.10649</b> ) </li><li>  Gradient Boosting ( <b>0.09736</b> ) </li></ul><br>  I did not particularly invent.  Took a weighted average of these predictions.  Weight calculated by predicting these algorithms on holdout set, which bit off the train set. <br>  It turned out something like 0.85% Gradient Boosting, 10% Random Forest, 5% Linear regression. <br><br>  Result: <b>0.09532</b> (15th place, top 3%) <br><br><img src="https://habrastorage.org/files/f24/a0b/2e4/f24a0b2e476f447ea80666e9b79f4fa9.png" width="70%"><br>  On this chart, the best known result is the first place on Private LeaderBoard. <br><br>  What did not work: <br><ul><li>  kNN is a simple algorithm, but often performs well as part of an ensemble.  I couldn‚Äôt squeeze less of it (0.3) </li><li>  Neural networks - with the right approach, even on such disparate data, they show a decent result, and what is important, often show themselves remarkably well in assemblies.  Here I didn‚Äôt have enough directness of hands, something somewhere I was too smart. </li><li>  I tried to build separate models for each weather station, product and store, but the data becomes very small, so the prediction accuracy falls. </li><li>  An attempt was made to analyze time series and the selection of the trend, and periodic components, but this prediction accuracy also did not increase. </li></ul><br><br>  Total: <br><ul><li>  Clever algorithms are important, and now there are algorithms that produce very accurate results out of the box.  (For example, I was pleased with the <a href="http://blog.kaggle.com/2015/08/10/detecting-diabetic-retinopathy-in-eye-images/">convolutional neural network of 28 layers, which itself isolates the vital signs from the images.</a> ) </li><li>  Data preparation and the creation of literate traits are often (but not always) much more important than complex models. </li><li>  Often ingenious ideas don't work. </li><li>  Sometimes completely stupid and hopeless ideas work great. </li><li>  People are those creatures who like to be in the comfort zone and follow their time-tested schedule, which is based on the calendar, and not on the momentary impulse caused by weather conditions. </li><li>  I tried to squeeze as much of this data as possible, but if we knew the price of the goods, or their names, or the geographical location of the stores, the solution would be different. </li><li>  I did not try to add the weather before and after the day for which the prediction should be made.  Also, I did not try to create a separate feature to describe the holidays.  It is possible that this would help. </li><li>  I spent a week on everything about everything, from time to time looking up from completing my thesis and starting another iteration.  Perhaps the prediction accuracy could be increased if I spent more time, although on the other hand, since I did not do it in a week, then so be it.  On kaggle.com a lot of interesting competitions, and to focus on one thing is not very correct in terms of the effectiveness of obtaining knowledge. </li><li>  Anyone who has not tried to participate in competitions on <a href="https://www.kaggle.com/">kaggle.com</a> - I recommend.  It is interesting and informative. </li></ul><br><br>  UPDATE: <br>  The comments asked a very correct question about overfitting, and I decided to add a text describing how the accuracy of your model is evaluated on kaggle.com. <br><br>  When interviewing me, people often ask me where my machine learning experience comes from.  Previously, I replied that the theoretical preparation of online classes, reading books, scientific articles and forums of relevant topics.  A practical of attempts to use machine learning in condensed matter physics and the experience of participating in competitions at Kagla.  Moreover, in fact from the point of view of knowledge, kaggle gave me much more.  At least because there I worked with more than 20 different tasks, and each has its own nuances and troubles.  For example: <br><br><ul><li>  <a href="https://www.kaggle.com/c/otto-group-product-classification-challenge">Otto Group Product Classification Challenge</a> - The data was prepared in such a way that no one really could create any signs.  The emphasis in this competition was on numerical methods.  Algorithms, model parameters, ensembles.  In this competition, I figured out the algorithms: Gradient Boosting, met Neural Networks, and learned how to make simple ensembles.  Began to actively use scikit-learn, graphlab, xgboost. </li><li>  <a href="https://www.kaggle.com/c/crowdflower-search-relevance">Search Results Relevance</a> - Here is Natural Language Processing with all the relevant theoretical and practical problems.  Theoretical base and practical experience of using SVM, bag of words, word2vec, glove, nltk. </li><li>  <a href="https://www.kaggle.com/c/avito-context-ad-clicks">Avito Context Ad Clicks</a> - There is a question of scalability.  300 million objects with lots of signs.  And here Apache Spark went with me, all the power and shortcomings of the logistic regression showed up.  (Unfortunately, my hands did not reach FFM) </li><li>  <a href="https://www.kaggle.com/c/diabetic-retinopathy-detection">Diabetic Retinopathy Detection</a> - Image processing, feature extraction from images, neural networks, advantages and disadvantages of using GPUs.  Experience with Theano and ImageMagic. </li></ul><br>  and so on, another 15 different problems.  It is very important that thousands of people with different knowledge and experience worked on these tasks at the same time, sharing ideas and code.  Sea of ‚Äã‚Äãknowledge.  In my opinion, this is a very effective training, especially if you simultaneously get acquainted with the relevant theory.  Each competition teaches something, and in practice.  For example, in our faculty, many have heard of PCA, and these many believe that it is a magic wand that can be used almost blindly to reduce the number of signs.  And in fact PCA is a very powerful technique, if used correctly.  And very powerful shoots in the foot, if wrong.  But until I tried it on various types of data, you really don't feel it. <br><br>  And, due to my inherent naivety, I assumed that those who heard about Kagl heard it that way.  It turned out that no.  Communicating with familiar Data Scientists, as well as slightly discussing my experience on different languages, I realized that people do not know how the accuracy assessment of the model takes place at these competitions, and the general opinion about kaglerah are overfitters, and this experience participation in competitions is more negative than positive. <br><br><h4>  So, I will try to explain how it is and what: </h4><br>  Most (but not all) tasks that are offered to those who wish are training with a teacher.  That is, we have a train set, there is a test set.  And you need to make a prediction on the test.  The accuracy of the model is estimated by how correctly we predicted the test.  And that sounds bad.  In the sense that experienced Data Scientists will immediately see the problem.  Making a bunch of predictions on test, we aggressively overfit.  And the model that works exactly on test can work disgustingly on new data.  And that's exactly how most of those who heard about Cagle, but did not try, think about this process.  But!  In fact, everything is not so. <br><br>  The idea is that the test set is divided into two parts: Public and Private.  Usually in the proportion of 30% on Public, and 70% on Private.  You make a prediction on the whole test set, but until the competition ends, you can see the accuracy of your prediction only on Public.  And after the end of the competition, the accuracy on Private becomes available to you, and this Private is the final accuracy of your model. <br><br>  An example of a competition that I described in this text. <br><br>  The competition ends on May 25th.  =&gt; Until 17:00, PST you have a prediction error of 30% test set, that is, the public part.  In my case it was <b>0.09486</b> and 10th place on the Public Leaderboard.  At five in the evening the PST contest ends.  And the prediction on the remaining 70% (Private) becomes available. <br>  I have this <b>0.09532</b> and 15th place.  That is, I slightly overfitit. <br><br>  The final accuracy of your Private model is estimated by the two predictions you selected.  As a rule, I choose one of them - the one that gives the smallest error on the Public Leaderboard, and the second is the one that gives the smallest error on the Cross Validation calculated by the train set. <br><br>  I usually work in this mode: if the error on the local cross validation has decreased =&gt; I send the prediction to Cagl.  That is a strong overfit does not occur.  Model parameters are also selected based on the magnitude of the error on cross validation.  For example, the weights with which I averaged Linear Regression, Random Forest and Gradient Boosting were determined by a piece of data that I bit off the train and did not use for training the model, nor did I use the test set. <br><br>  As <a href="https://www.kaggle.com/owenzhang1">Owen</a> correctly noted, in one of his <a href="http://www.slideshare.net/ShangxuanZhang/winning-data-science-competitions-presented-by-owen-zhang">presentations</a> , the correct assessment of the accuracy of the model is much more important than the complexity of the model.  Therefore, when I create my naive script (zero iteration) mentioned above, I do not focus on data analysis and model accuracy, but on the fact that the cross validation error on the train set matches the error on the Public Leaderboard. <br><br>  This is not always easy, and often simply impossible. <br><h4>  Examples: </h4><br><ul><li>  <a href="https://www.kaggle.com/c/facebook-recruiting-iv-human-or-bot">Facebook Recruiting IV: Human or Robot?</a>  - here I have something not fused.  Moreover, the people at the forum discussed how to do it humanly, that is, I am not the only one.  I was at war with reviewers on my dissertation topic, so here I‚Äôm just a Public Leaderboard overfit, but neatly.  My place on Private is 91st place higher than on Public.  Most likely because the rest overfit more aggressively.  But in general, this is an example of competition when Public and Private come from slightly different distributions. </li><li>  <a href="https://www.kaggle.com/c/restaurant-revenue-prediction">Restaurant Revenue Prediction</a> is generally ahtung.  train set - 137 objects, including outliers.  test set - 10,000. Here, simply because of the small size of the train, you can think of nothing more than overfitting the Public Leaderboard.  , <a href="https://www.kaggle.com/c/restaurant-revenue-prediction/leaderboard/private">   Private  Public.</a>  ,  ,      ,    . </li><li> <a href="https://www.kaggle.com/c/pkdd-15-predict-taxi-service-trajectory-i">ECML/PKDD 15: Taxi Trajectory Prediction (I)</a>  <a href="https://www.kaggle.com/c/pkdd-15-taxi-trip-time-prediction-ii">ECML/PKDD 15: Taxi Trip Time Prediction (II)</a> ‚Äî    , -,    ,    ,    ,   cross validation.    train/test  .    train     test. </li><li> <a href="https://www.kaggle.com/c/icdm-2015-drawbridge-cross-device-connections">ICDM 2015: Drawbridge Cross-Device Connections</a> ‚Äî  semi-supervised learning         .  ,     .        .     12 .    : ¬´ ¬ª.  -  . </li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Morality - I tried to clarify that the people who participate in the kaggle.com demonstration are different publics. </font><font style="vertical-align: inherit;">At first, the majority is engaged in adjusting the parameters, based on the results of the Public Leaderboard, and then howling on the forum that ‚Äúthe world is cruel, everyone is to blame,‚Äù when their final position on Private is much lower than expected. </font><font style="vertical-align: inherit;">But, as a rule, after the first such puncture, the chakras open and the public approaches the issue of assessing the accuracy of the model very carefully, with an understanding of where KFold is needed, where StarifiedKFold is, and where it is enough to hold out set, how many folds you need to take, how to interpret the results, and in general, where are there any rakes, and when they can be stepped on, and when they are not worth it.</font></font></div><p>Source: <a href="https://habr.com/ru/post/264653/">https://habr.com/ru/post/264653/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264641/index.html">Spring Security 4 + CSRF (adding a cross-site request forgery protection project to Spring)</a></li>
<li><a href="../264643/index.html">Go as the first programming language for students</a></li>
<li><a href="../264645/index.html">Office as Platform issue 3: Power BI. Get data from REST API</a></li>
<li><a href="../264647/index.html">Traffic lights can also be hacked</a></li>
<li><a href="../264651/index.html">Calculating cell height in a UITableView dynamic table</a></li>
<li><a href="../264655/index.html">Algorithmic and Automated Trading: Introduction</a></li>
<li><a href="../264657/index.html">Javascript and time zones - the correct time on the site</a></li>
<li><a href="../264659/index.html">Making a game with Gideros</a></li>
<li><a href="../264661/index.html">Report from Dribbble Meetup 2015 in Moscow</a></li>
<li><a href="../264665/index.html">Google released the first public security bulletin for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>