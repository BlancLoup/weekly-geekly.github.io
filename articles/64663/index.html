<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write Facebook application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Facebook is a popular social network where you can write your application. I do not like to push the water in a mortar, so immediately to the point. Y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write Facebook application</h1><div class="post__text post__text-html js-mediator-article">  Facebook is a popular social network where you can write your application.  I do not like to push the water in a mortar, so immediately to the point.  You can embed in two <em>directions</em> : external application in Facebook or Facebook data in an external application (aka <a href="http://wiki.developers.facebook.com/index.php/Anatomy_of_a_Facebook_Connect_Site">Facebook Connect</a> ).  Here I will talk about the first, which is basically more time consuming and interesting.  As a rule, the meaning of a facebook application carries two functionalities - interaction with friends and informative integration into a user profile. <br><br><h3>  The basics <br></h3><br>  You can embed the application in the following <strong>places</strong> .. <br><ul><li>  Canvas - the actual page with the application.  Available from the link <a href="http://apps.facebook.com/%25D0%259D%25D0%2590%25D0%2597%25D0%2592%25D0%2590%25D0%259D%25D0%2598%25D0%2595_%25D0%259F%25D0%25A0%25D0%259E%25D0%2593%25D0%25A0%25D0%2590%25D0%259C%25D0%259C%25D0%25AB/">apps.facebook.com/PROGRAM NAME</a> </li><li>  Profile box - a small box inside the user‚Äôs profile </li><li>  Profile tab - new tab in profile </li><li>  Boxes tab - a small block in tab boxes </li><li>  News feed - access to the stream of updates </li><li>  Requests box - interactive messages to other users </li></ul><br>  Integration is made by mixed <strong>features</strong> .. <br><ul><li>  REST API (http://api.new.facebook.com/restserver.php) which gives ‚Äúhard‚Äù access for the backend with the ability to upload photos, videos, get lists of friends, events, comments and so on. </li><li>  <a href="http://wiki.developers.facebook.com/index.php/FQL">FQL</a> is a way to request REST data not only through method parameters, but already through an SQL-like syntax </li><li>  <a href="http://wiki.developers.facebook.com/index.php/FBML">FBML</a> - HTML stripped down its own tags, which Facebook interprets in a window in its own style and design and caches during in-line display.  A bunch of problems with built-in tag validator </li><li>  xFBML - FBML tags used in your application </li><li>  FBJS - JS Trimmed </li></ul><br><h3>  Two ways <br></h3><br>  Now that the basic terms are clear, let's move on to the application itself, which is located in the Canvas.  After creating a new application through the <a href="http://www.facebook.com/developers/">developer app</a> , downloading the <a href="">REST library</a> for php, uploading the application to your site and installing the URL settings for the Canvas, you can see that there are two ways to launch it ‚Äî <strong>iframe</strong> (+ XFBML) or <strong>pure FBML</strong> that will be stored on facebook.  Naturally the first option is the easiest.  After creating the program and adding / confirming in your profile, the display of the Canvas will be accompanied by the usual iframe + GET parameters with the prefix fb_sig_, of which the most important is fb_sig_canvas_user.  The second option is more dreary, but more closely related to FB. <br><br> <a rel="inline" href=""><img src="http://kurapov.name/res/image/thumb/1175.png"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h3>  The rights <br></h3><br>  Now we need to think about what the application does in principle.  In my case, this is a quiz test - the user answers the questions and at the end the status is put on the wall in a profile (profile wall). <br>  First of all, it turns out that it is very useful to have user confirmation for receiving data ( <a href="http://wiki.developers.facebook.com/index.php/Authorizing_Applications">Authorization</a> ) which is called by the method <br>  Facebook :: require_login and for the user looks just like a window <br>  transfer of rights.  Having rummaged in the documentation for the publication of data in Wall (News feed), there is a method <a href="http://wiki.developers.facebook.com/index.php/Feed.publishTemplatizedAction">Feed.publishTemplatizedAction</a> , but it turned out that it is outdated (deprecated).  The alternative is <a href="http://wiki.developers.facebook.com/index.php/Stream.publish">Stream.publish</a> , and now we <a href="http://wiki.developers.facebook.com/index.php/Stream.publish">come</a> to the second important topic - <a href="http://wiki.developers.facebook.com/index.php/Extended_permissions">Extended permissions</a> . <br><br> <a rel="inline" href=""><img src="http://kurapov.name/res/image/thumb/1176.png"></a> <br>  Without rights, the request will simply receive a fatal error.  In order for the program to have a deeper access over the profile <br>  user, the latter must confirm this separately in the dialog <br>  window  And to cause this dialogue to post a message on the wall or <br>  changing the status of a user is not so easy. <br> <code>$facebook-&gt;api_client-&gt;stream_publish("My new status");</code> <br> <code>Uncaught exception 'FacebookRestClientException' with message 'The user hasn't authorized the application to perform this action' i</code> <br>  Now a few subtleties - the documentation in the wiki and forums should be read with great suspicion, because often <br>  Obsolete code is encountered (for example, the names of the privileges / methods of stream_publish instead of <br>  publish_stream).  Methods for checking privileges give either a fatal error or an unintelligible reply to the parameters, including the test <a href="http://developers.facebook.com/tools.php%3Fapi">API console</a> <br> <code>if($facebook-&gt;api_client-&gt;users_hasAppPermission("publish_stream")){ <br> //   <br> } <br></code> <br><br><h4>  FBML temptation <br></h4><br>  By this time, the advantages of the FBML mode (compulsion to a similar interface and the supported FBML tags) become clear.  I still worked <br><ul><li>  FBML mode + onclick + tag <code>&lt;fb:prompt-permission perms="stream_publish"&gt;Heelp&lt;/fb:prompt-permission&gt;</code> </li><li>  FBML mode + &lt;form promptpermission = "status_update"&gt; + onclick <br> <a rel="inline" href=""><img src="http://kurapov.name/res/image/thumb/1177.png"></a> <br></li><li>  Iframe + redirect to <a href="http">www.facebook.com/authorize.php?api_key=MY_API_KEY&amp;v=1.0&amp;ext_perm=publish_stream&amp;next=http</a> : //google.com <br><br>  Although it looks very buggy: <br> <a rel="inline" href=""><img src="http://kurapov.name/res/image/thumb/1178.png"></a> <br>  FBML mode + redirect issued an ‚ÄúError while loading page‚Äù message </li></ul><br><h3>  xFBML </h3><br>  It is clear that the rights to receive via the iframe are thus buggy, I want to live simultaneously and separately with Facebook.  To do this, there are xFBML-tags that are interpreted by Facebook javascript.  Total need in your application need: <br><ol><li>  <a href="http://static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php">Enable static.ak.connect.facebook.com/js/api_lib/v0.4/FeatureLoader.js.php javascript</a> </li><li>  Make <a href="http://wiki.developers.facebook.com/index.php/XFBML">xd_receiver.htm</a> </li><li>  Initialize with your api-key </li><li>  Specify the path to the root in the settings of the Connect-application on Facebook </li></ol><br>  Now you can ask right <br><br> <code>FB.Connect.showPermissionDialog('publish_stream');</code> <br> <a rel="inline" href=""><img src="http://kurapov.name/res/image/thumb/1179.png"></a> <br><h3>  Lost donkey cookie <br></h3><br>  You can not get around without mentioning IE 6/7 and here.  The fact is that the default iframe in these browsers loses session variables.  Simply put - cookies do not reach the server, because the iframe is considered ‚Äúunreliable‚Äù content and it even shows an eye in its status bar.  If you understand this in <a href="http://stackoverflow.com/questions/389456/cookie-blocked-not-saved-in-iframe-in-internet-explorer">detail</a> , then there is a justification for this in the form of the <a href="http://www.w3.org/TR/P3P/">W3C platform for privacy preferences</a> .  For this, it is easier to add a title. <br> <code>header('P3P: CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"'); //for IE6/7</code> <br>  In the end, the application successfully updated the profile (where it was possible to shove and picture through the attachment) <br><br> <a rel="inline" title="Hiller" href=""><img src="http://kurapov.name/res/image/thumb/1180.png" alt="Hiller"></a> <br><br><br>  <a href="http://kurapov.name/rus/technology/web/facebook_app/">Original</a> </div><p>Source: <a href="https://habr.com/ru/post/64663/">https://habr.com/ru/post/64663/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../64652/index.html">Installing LAMP (local web server for Ubuntu 9.04) step by step</a></li>
<li><a href="../64655/index.html">Counting the total number of rows in a sample in mySQL using LIMIT</a></li>
<li><a href="../64660/index.html">Hourly Project Management</a></li>
<li><a href="../64661/index.html">Coffee'n'Code in Kiev</a></li>
<li><a href="../64662/index.html">Software for del.icio.us</a></li>
<li><a href="../64664/index.html">Creative chaos</a></li>
<li><a href="../64665/index.html">Firebug 1.4.0</a></li>
<li><a href="../64667/index.html">Modem "Fiztech-1200". Back in USSR</a></li>
<li><a href="../64668/index.html">How do web studios just enter new regions?</a></li>
<li><a href="../64670/index.html">Words of English origin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>