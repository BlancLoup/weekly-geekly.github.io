<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yandex Map Kit for Android. Card rotation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 In this message I will describe the inclusion of the map rotation function in the application using the Yandex Map Kit for Android . A messag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yandex Map Kit for Android. Card rotation</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  In this message I will describe the inclusion of the map rotation function in the application using the <a href="https://github.com/yandexmobile/yandexmapkit-android">Yandex Map Kit for Android</a> .  A message was written based on <a href="https://github.com/yandexmobile/yandexmapkit-android/issues/99">Issue # 99</a> , which remained unresolved. <br><br><img src="https://habrastorage.org/storage2/432/147/14a/43214714a05270e3648dbcacb3250ddd.png"><br><a name="habracut"></a><br>  A small retreat.  It was not possible to start working with the map according to the description in the Wiki section <a href="https://github.com/yandexmobile/yandexmapkit-android/wiki/%25D0%259A%25D0%25B0%25D0%25BA-%25D0%25BD%25D0%25B0%25D1%2587%25D0%25B0%25D1%2582%25D1%258C-%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D1%2583">‚ÄúHow to start work‚Äù</a> .  The application crashed when starting with the error "Caused by: android.view.InflateException: Binary XML file line # 7: Error inflating class ru.yandex.yandexmapkit.MapView".  It helped connect to the classes.jar project, located in yandexmapkit-library \ libs. <br><br>  Like the author of <a href="https://github.com/yandexmobile/yandexmapkit-android/issues/99">Issue # 99,</a> the <b>MapController</b> method <b>setRotateAnimtionTo</b> rotated the map, but instead of the map tiles, it received tiles with the words "There is no data for this site." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Using the hint support <br><blockquote>  By rotation, it was done for my location and, as it were, represents internal functionality. <br>  The problem you have in turning is that the center point of rotation is not set.  But all these APIs are alas closed for now. </blockquote><br>  investigated the class <b>MyLocationOverlay</b> (bytecode can be viewed in Eclipse), the following lines were found <br><pre><code class="java hljs"><span class="hljs-number"><span class="hljs-number">223</span></span> aload_0 [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>] <span class="hljs-number"><span class="hljs-number">224</span></span> invokevirtual ru.yandex.yandexmapkit.overlay.location.MyLocationOverlay.f() : <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> [<span class="hljs-number"><span class="hljs-number">168</span></span>] <span class="hljs-number"><span class="hljs-number">227</span></span> ifeq <span class="hljs-number"><span class="hljs-number">258</span></span> <span class="hljs-number"><span class="hljs-number">230</span></span> aload_0 [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>] <span class="hljs-number"><span class="hljs-number">231</span></span> getfield ru.yandex.yandexmapkit.overlay.location.MyLocationOverlay.y : al [<span class="hljs-number"><span class="hljs-number">78</span></span>] <span class="hljs-number"><span class="hljs-number">234</span></span> aload_0 [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>] <span class="hljs-number"><span class="hljs-number">235</span></span> invokevirtual ru.yandex.yandexmapkit.overlay.location.MyLocationOverlay.getMyLocationItem() : ru.yandex.yandexmapkit.overlay.location.MyLocationItem [<span class="hljs-number"><span class="hljs-number">171</span></span>] <span class="hljs-number"><span class="hljs-number">238</span></span> invokevirtual ru.yandex.yandexmapkit.overlay.location.MyLocationItem.getBearing() : <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> [<span class="hljs-number"><span class="hljs-number">154</span></span>] <span class="hljs-number"><span class="hljs-number">241</span></span> invokevirtual al.a(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) : <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> [<span class="hljs-number"><span class="hljs-number">79</span></span>] <span class="hljs-number"><span class="hljs-number">244</span></span> aload_0 [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>] <span class="hljs-number"><span class="hljs-number">245</span></span> getfield ru.yandex.yandexmapkit.overlay.location.MyLocationOverlay.y : al [<span class="hljs-number"><span class="hljs-number">78</span></span>] <span class="hljs-number"><span class="hljs-number">248</span></span> aload_0 [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>] <span class="hljs-number"><span class="hljs-number">249</span></span> invokevirtual ru.yandex.yandexmapkit.overlay.location.MyLocationOverlay.getMyLocationItem() : ru.yandex.yandexmapkit.overlay.location.MyLocationItem [<span class="hljs-number"><span class="hljs-number">171</span></span>] <span class="hljs-number"><span class="hljs-number">252</span></span> invokevirtual ru.yandex.yandexmapkit.overlay.location.MyLocationItem.getPoint() : cp [<span class="hljs-number"><span class="hljs-number">156</span></span>] <span class="hljs-number"><span class="hljs-number">255</span></span> invokevirtual al.a(cp) : <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> [<span class="hljs-number"><span class="hljs-number">80</span></span>] <span class="hljs-number"><span class="hljs-number">258</span></span> aload_0 [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>] <span class="hljs-number"><span class="hljs-number">259</span></span> invokevirtual ru.yandex.yandexmapkit.overlay.location.MyLocationOverlay.getMapController() : ru.yandex.yandexmapkit.MapController [<span class="hljs-number"><span class="hljs-number">170</span></span>] <span class="hljs-number"><span class="hljs-number">262</span></span> invokevirtual ru.yandex.yandexmapkit.MapController.notifyRepaint() : <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> [<span class="hljs-number"><span class="hljs-number">140</span></span>]</code> </pre> <br>  where <b>al</b> is what the <b>MapController getMapRotator ()</b> method returns.  <b>MyLocationItem</b> is an <b>OverlayItem</b> extension, whose <b>getPoint ()</b> method is inherited in <b>MyLocationItem</b> (will be required to get an unavailable instance of the <b>cp</b> class).  Having seen all this, it is easy to guess that the method of the class <b>al a (cp point)</b> sets the coordinates of the axis around which the map rotates, and <b>al.a (float bearing) the</b> angle of rotation.  The class <b>al</b> (recall that the instance obtained by the <b>getMapRotator ()</b> method of the <b>MapController</b> class) has another method <b>a (boolean enableRotation)</b> for which there was a hunch that it allows the map to rotate, which was later confirmed. <br><br>  Now everything is ready to rotate the map, for example, when changing the azimuth.  How to get the values ‚Äã‚Äãof the azimuth when changing the position of the device in space is well described in the <a href="http://books.google.ru/books%3Fid%3Dg3hAdK1IBkYC%26printsec%3Dfrontcover%26dq%3Dprofessional%2Bandroid%2B4%2Bapplication%2Bdevelopment%26hl%3Dru%26sa%3DX%26ei%3DTqQKUcvTHpCN4gSriYCACg%26ved%3D0CDEQ6AEwAA">book</a> .  It remains only to insert the following code into the event handler for the change in azimuth. <br><pre> <code class="java hljs"> GeoPoint geoPoint = mMapController.getMapCenter(); <span class="hljs-comment"><span class="hljs-comment">//     OverlayItem overlayItem = new OverlayItem(geoPoint, null); //       cp,       mMapController.getMapRotator().a(bearing); //   mMapController.getMapRotator().a(overlayItem.getPoint()); //     </span></span></code> </pre><br>  Where <br><pre> <code class="java hljs"> MapController mMapController; MapView mMapView; mMapView = (MapView) findViewById(R.id.map); mMapController = mMapView.getMapController(); mMapController.getMapRotator().a(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  </span></span></code> </pre><br>  Result <br><br><img src="https://habrastorage.org/storage2/432/147/14a/43214714a05270e3648dbcacb3250ddd.png"></div><p>Source: <a href="https://habr.com/ru/post/167807/">https://habr.com/ru/post/167807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../167797/index.html">Smart home, as I sunk to such. Part 2</a></li>
<li><a href="../167799/index.html">Gaming technology - to life</a></li>
<li><a href="../167801/index.html">Statistics in Teradata DBMS</a></li>
<li><a href="../167803/index.html">The most notable problems of cloud providers for 2012</a></li>
<li><a href="../167805/index.html">IOS Alarm Log Demystification</a></li>
<li><a href="../167809/index.html">Information universe. Private conclusions from the assumption</a></li>
<li><a href="../167813/index.html">How google & yandex find pictures</a></li>
<li><a href="../167815/index.html">Developing games for Windows 8 using MonoGame: touchscreen support</a></li>
<li><a href="../167817/index.html">Sierpinski Triangle and Pascal's Triangle</a></li>
<li><a href="../167819/index.html">Yandeks.Narod: hosting moves to uCoz</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>