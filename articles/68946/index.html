<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Brain Fuck Scheduler - set in 5 minutes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About the new task scheduler for Linux on Habr√© already written here . A very startling "trailer" with xkcd to a new scheduler, and a no less fun FAQ,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Brain Fuck Scheduler - set in 5 minutes</h1><div class="post__text post__text-html js-mediator-article">  About the new task scheduler for Linux on Habr√© already written <a href="http://habrahabr.ru/blogs/linux/68533/">here</a> .  A very startling "trailer" with xkcd to a new scheduler, and a no less fun FAQ, awakened interest.  I asked friends who put in order to share my impressions - no one put it, because ‚Äúput a new core into the core‚Äù or ‚ÄúI will wait until it appears in the mainstream‚Äù.  I installed it and tried it myself, and for those who want to do the same, a quick guide for Ubuntu 9.04, with a description of potential rakes. <br><br>  As a teaser, I can only say that the full-screen video on youtube really does not slow down and the system has become more responsive and faster. <br><br>  So, in order not to be unfounded, let's start.  It is assumed that you have Ubuntu 9.04 (Jaunty) installed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><h3>  Core </h3><br>  This scheduler is written for 2.6.30+ kernels, so the default 2.6.28 kernel in Jaunty does not suit us.  You need to download <a href="http://kernel.ubuntu.com/~kernel-ppa/mainline/v2.6.30/">2.6.30</a> , and the latest is better from the branch at the moment - <a href="http://kernel.ubuntu.com/~kernel-ppa/mainline/v2.6.30.5/">2.6.30.5</a> . <br><br>  Download the sources carefully packed into .deb by the Ubuntu developers: <br> <b><code><a href=""></a> wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v2.6.30.5/linux-source-2.6.30_2.6.30-02063005_all.deb</code></b> <br> <br>  Install the source: <br> <b><code>sudo dpkg -i linux-source-2.6.30_2.6.30-02063005_all.deb <br> cd /usr/src <br> sudo tar xvjf linux-source-2.6.30.tar.bz2</code></b> <br> <br>  With the core so far finished. <br><br><h3>  BFS Patch </h3><br>  Now you need to install BrainFuck Scheduler patch.  The directory with the patch and other relevant files is here: <a href="http://ck.kolivas.org/patches/bfs/">ck.kolivas.org/patches/bfs</a> <br>  The latest actual version of the patch at the time of writing 2.0.9 - <a href="http://ck.kolivas.org/patches/bfs/2.6.30-sched-bfs-209.patch">ck.kolivas.org/patches/bfs/2.6.30-sched-bfs-209.patch</a> <br><br>  Download and apply the patch: <br> <b><code><a href="http://ck.kolivas.org/patches/bfs/2.6.30-sched-bfs-209.patch"></a> cd /usr/src/linux-source-2.6.30/ <br> sudo wget http://ck.kolivas.org/patches/bfs/2.6.30-sched-bfs-209.patch <br> sudo patch -p1 &lt; 2.6.30-sched-bfs-209.patch</code></b> <br>  The patch will swear twice on ‚Äúassume reverse patch‚Äù - you need to answer ‚Äúno‚Äù, and ‚ÄúApply anyway?‚Äù - ‚Äúyes‚Äù. <br><br><h3>  Build the patched kernel </h3><br>  Now we collect, as always.  Whoever doesn‚Äôt know how to build always, a brief introduction - in Debian / Ubuntu, there is a handy kernel-package utility for building a kernel that does a ton of work for us.  Therefore, we first install it, or make sure that it (and several other necessary programs) are installed: <br> <b><code>sudo apt-get install kernel-package libncurses5-dev fakeroot wget bzip2</code></b> <br> <br>  Now we generate a new kernel configuration based on the existing one: <br> <b><code>sudo cp /boot/config-`uname -r` ./.config <br> sudo make menuconfig</code></b> <br>  Here we will need to make a couple of changes. <br><br>  <b>UPD</b> .  <a href="http://habrahabr.ru/blogs/ubuntu/68946/">Correction</a> by <a href="https://habrahabr.ru/users/coldflame/" class="user_link">coldFlame</a> - these changes are not necessary, moreover, on laptops are not recommended.  From FAQ <br>  <b>THESE ARE OPTIONAL FOR LOWEST LATENCY.</b>  <b>YOU DO NOT NEED THESE!</b> <b><br></b>  <b>Configure your kernel with 1000Hz, preempt ON and disable dynamic ticks.</b> <br><br><ul><li>  Processor type and features -&gt; Timer frequencies set to 1000Hz </li><li>  Processor type and features -&gt; Tickless System (Dynamic Ticks) disable </li><li>  Processor type and features -&gt; Preemption Model -&gt; Preemptible kernel (Low latency desktop) </li></ul><br>  Exit and save the configuration. <br><br>  Next, the assembly itself.  About 5 minutes in the title, I, of course, lied :), but if the assembly step is neglected (resigned), and let the download speed of the above-mentioned packages strive to infinity, then in 5 minutes we calmly keep within.  :) <br> <b><code>sudo make-kpkg clean <br> fakeroot make-kpkg --initrd --append-to-version=-bfuck kernel_image kernel_headers</code></b> <br> <br>  If everything went well, then in / usr / src / you will have two .deb packages, with file headers and directly with the kernel and modules.  Install them: <br> <b><code>sudo dpkg -i /usr/src/*bfuck*.deb</code></b> <br> <br>  At the same time, the kernel and modules will be installed into the system, a new initrd will be generated, dependent external modules will be rebuilt (except nvidia, but more on that below) and grub will automatically find out about the new kernel. <br><br>  Everything, it is possible to reboot. <br><br><h3>  NVidia drivers </h3><br>  Those drivers, which by default are in the repository, are not automatically installed on the new kernel, but give an error.  It knocks down all the charm of automatic installation scripts and we have two options - either download the latest installation binaries from the Nvidia website, or use a beautiful method with a patch for drivers. <br><br>  So, download the patch for the nvidia module: <br> <b><code><a href="http://lionsimba.lerlan.ru/temp/proc-dir-entry-owner.patch"></a> wget http://lionsimba.lerlan.ru/temp/proc-dir-entry-owner.patch</code></b> <br> <br>  Copy it to /usr/src/nvidia-180.44/patches/ <br> <b><code>sudo cp proc-dir-entry-owner.patch /usr/src/nvidia-180.44/patches/</code></b> <br> <br>  Add the following lines to the /usr/src/nvidia-180.44/dkms.conf file: <br> <b><code>PATCH[1]="proc-dir-entry-owner.patch" <br> PATCH_MATCH[1]="^2.6.30"</code></b> <br> <br>  Everything, you can use all the delights of dkms and be sure that Nvidia drivers will work on the new kernel. <br>  <b>UPD</b> .  It makes sense to look at <a href="http://habrahabr.ru/blogs/ubuntu/68946/">these comments</a> . <br><br><h3>  Conclusion </h3><br>  Now, as for impressions.  The system has really become subjectively more responsive, the subtle but annoying pauses have been removed during various actions.  I confirm the full-screen video on youtube :) - it really does not slow down.  From what has been noticed so far - the Composite Ring Switcher for windows has become almost instantaneous - it has previously left a feeling of heaviness and awkwardness.  In principle, I will not do tests, benchmarks and measurements - it is more important to me the subjective feelings from working with the machine. <br><br>  For the time being, I'm definitely staying with this kernel and this scheduler. <br><br>  <b>UPD</b> .  Patch version 2.10 is applied to 2.6.31-rc9 as well (thanks to <a href="https://habrahabr.ru/users/davnozdu/" class="user_link">davnozdu</a> ) </div><p>Source: <a href="https://habr.com/ru/post/68946/">https://habr.com/ru/post/68946/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68936/index.html">ASUS Reader - two screens are ... why?</a></li>
<li><a href="../68937/index.html">Street View Ads by Google Japan</a></li>
<li><a href="../68938/index.html">Rug</a></li>
<li><a href="../68942/index.html">Mac vs PC Chess</a></li>
<li><a href="../68945/index.html">WinKnock Utility</a></li>
<li><a href="../68947/index.html">Where can I download a half terabyte in Russia to download in the States?</a></li>
<li><a href="../68948/index.html">Stencil Trainer</a></li>
<li><a href="../68949/index.html">Develop for yourself</a></li>
<li><a href="../68950/index.html">Ruby & Ccsv. FasterCSV is not so faster</a></li>
<li><a href="../68951/index.html">Excellent commercials of Windows 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>