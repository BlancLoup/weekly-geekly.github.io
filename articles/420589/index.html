<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What to look for when choosing a logging system, and why we stopped at ELK</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are a huge number of logging systems on the market, both open and proprietary. Each of them has its own functionality, its own advantages and di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What to look for when choosing a logging system, and why we stopped at ELK</h1><div class="post__text post__text-html js-mediator-article">  There are a huge number of logging systems on the market, both open and proprietary.  Each of them has its own functionality, its own advantages and disadvantages. <br><br>  Today we decided to share the experience of choosing a logging system and tell why in <a href="https://1cloud.ru/%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Dsys_admin%26utm_content%3Dsite">1cloud</a> we stopped at ELK. <br><br> <a href="https://habr.com/company/1cloud/blog/420589/"><img src="https://habrastorage.org/webt/d8/zl/ea/d8zleatktqo_uj1bswxll-rkq0a.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ Pixabay / <a href="https://pixabay.com/en/forest-wood-nature-log-trees-2310309/">picupyourphoto</a> / PD</i></font> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Moment of theory </h2><br>  When switching to production, applications turn into original ‚Äúblack boxes‚Äù.  Their work must be constantly monitored to prevent and respond to potential emergencies, to catch "bottlenecks". <br><br>  Logging systems are an indispensable tool, without which this process cannot be done.  Conducting a detailed analysis of the data collected, you can identify the "intrusion" into the network, identify incorrectly configured equipment and take action promptly.  Also, logging is a mandatory requirement when passing various kinds of certifications, such as PCI DSS. <br><br>  To automate the logging process there are special frameworks: log4j, log4net, Retrace, Logback, Logstash and others - many of them.  There are separate development tools for logging, for example, JDK - <a href="https://dzone.com/articles/writing-your-own-logging">there is java.util.logging</a> .  Of course, the functionality of different logging tools is different, and the required set of functions must be chosen on the basis of business requirements.  However, there are a number of common points that are worth noting when choosing a system for analyzing logs. <br><br><h5>  Ease of use and community size </h5><br>  Simplicity is one of the key components when choosing a logging system.  All developers in the team work with log frameworks, so the experience of using this tool should be positive and not turn log analysis into a nightmare.  The framework API must be intuitive, so that everyone who has not worked with the system before can quickly figure out how it is set up and configured. <br><br>  If we consider the open source system of logging, then it makes sense to assess the community that has formed around it.  To do this, you can study how often it is mentioned on specialized sites ( <a href="https://stackoverflow.com/questions/tagged/logging">Stack Overflow</a> ), as well as in profile threads, <a href="https://www.reddit.com/r/sysadmin/">for example, on Reddit</a> .  As an option - to see the popularity of the project on GitHub (the number of stars) and see how often it is entered into various collections of tools in the network ( <a href="https://github.com/ProjectMeniscus/meniscus/wiki/Logging-System-Comparison">like these</a> ).  Obviously, the larger the community, the higher the likelihood that you will be helped in case of unforeseen difficulties. <br><br>  As for the choice of proprietary logging systems, here, first of all, it is worth looking at the speed of responses and the adequacy of the support service of the chosen solution, as well as its price. <br><br><h5>  The possibility of collecting "variegated" logs </h5><br>  Not all logging platforms are able to process large amounts of data and provide complete information about the systems used. <br><br>  Before choosing a solution, you should decide which logs you plan to collect: HTTP logs (they will help you understand the behavior of users on the site), API logs (will give an opportunity to evaluate which services are most often requested by API), error logs and just records of changes in system (indicate "bottlenecks", if any). <br><br><h5>  Scalability </h5><br>  The logging tool should collect logs from each system component and provide access to them in one place.  If the system is not adapted for scaling, the quality of the log analysis will drop. <br><br>  We initially used 1cloud for logging MS SQL.  However, with the growing number of clients and services (for example, <a href="https://1cloud.ru/news/novyj-data-centr-v-minske%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Dsys_admin%26utm_content%3Dsite">we</a> recently <a href="https://1cloud.ru/news/novyj-data-centr-v-minske%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Dsys_admin%26utm_content%3Dsite">placed equipment in the Minsk data center</a> and <a href="https://habr.com/company/1cloud/blog/419405/">added support for IPv6</a> ), we had geographically separated infrastructure components that did not have access to the database.  And one of our main tasks was to preserve the possibility of analyzing logs from a single place. <br><br><h2>  1cloud logging system </h2><br>  As we have already noted, MS SQL was used to store logs in 1cloud, and log4net was used to write them.  And it began to create for us certain difficulties.  Due to geographically separated components, it became impossible to maintain network connectivity with the database and provide a single point for analysis. <br><br>  At the same time, a large amount of logs and the inability to build indices for all the fields we need to search led to an unnecessary simplification of the log analysis - we had to abandon the functionality for the sake of performance. <br><br>  To solve this problem and ensure scalability, we have implemented a new logging system.  In total, we studied more than fifty different solutions and identified four that fully met our requirements: <br><br><ul><li>  single log storage; </li><li>  horizontal scaling of the system if necessary; </li><li>  processing large amounts of data; </li><li>  powerful log analysis system. </li></ul><br>  These four solutions are: Fluentd, Graylog, Logalyse and Logstash. <br><br><h5>  <a href="https://www.elastic.co/products/logstash">Logstash</a> </h5><br>  The solution has 9.2 thousand stars on <a href="https://github.com/elastic/logstash/pulse">GitHub</a> .  Logstash is licensed under Apache 2.0 and is part of the ELK stack.  It has a large number of plug-ins ( <a href="https://github.com/logstash-plugins">there are about 250 of</a> them on GitHub).  Works under Windows and Linux and has high performance, almost independent of data volumes. <br><br>  The system <a href="https://www.itweek.ru/upload/iblock/140/140e2b01639d62a2ad00a8c206f44a6c.pdf">provides a</a> quick overview and analysis of events from workstations, firewalls, routers and switches.  This is due to the fact that there is no need to "normalize" events. <br><br>  However, it should be understood that this is a ‚Äúnaked‚Äù engine, because it does not provide ready-made visualizations.  Of the other drawbacks, we note the need to put Java on all servers, since Logstash is written in Ruby (JRuby). <br><br>  The solution has a rather extensive community: there is an <a href="https://webchat.freenode.net/">IRC channel</a> and a separate <a href="https://discuss.elastic.co/">forum</a> .  The network has examples on the <a href="https://www.elastic.co/guide/en/logstash/current/config-examples.html">configuration of the entire system</a> and <a href="https://www.elastic.co/guide/en/logstash/current/monitoring.html">API</a> .  <a href="https://www.quora.com/Who-uses-Logstash-for-their-logging-mechanism">The</a> following organizations <a href="https://www.quora.com/Who-uses-Logstash-for-their-logging-mechanism">use</a> Logstash: CERN Control Center, GitHub, SoundCloud. <br><br><h5>  <a href="https://www.fluentd.org/">Fluentd</a> </h5><br>  6.6 thousand stars on <a href="https://github.com/fluent/fluentd/pulse">GitHub</a> .  Distributed under the Apache 2.0 license by <a href="https://github.com/cncf">CNCF</a> (Cloud Native Computing Foundation) - it was <a href="https://ru.wikipedia.org/wiki/The_Linux_Foundation">founded</a> by Google and The Linux Foundation to promote container technologies. <br><br>  Fluentd runs on Linux, Windows and Mac and is written in Ruby (CRuby).  Fluentd has a <a href="https://www.fluentd.org/plugins/all">flexible plugin system</a> that extends its functionality. <br><br>  The solution has a unified logging format: the data Fluentd tries to bring to the JSON format.  To ensure the reliability of the work, no third-party solutions are required, but this requires additional configuration.  It is also not recommended to install it on servers that generate logs. <br><br>  The community is large: there is a <a href="https://fluent-all.slack.com/messages/C0CTT63EE/">channel in Slack</a> , as well as <a href="https://groups.google.com/forum/">thread in Google Groups</a> .  On the official site of the project <a href="https://docs.fluentd.org/v1.0/articles/config-file">there are examples of configurations</a> and <a href="https://docs.fluentd.org/v1.0/articles/monitoring-rest-api">API</a> .  Fluentd is used by companies such as Microsoft, Amazon, change.org and Nintendo. <br><br><h5>  <a href="https://www.graylog.org/">Graylog</a> </h5><br>  4.3 thousand stars on <a href="https://github.com/Graylog2/graylog2-server">GitHub</a> .  Distributed under the GNU GPL v3 license.  It works only under Linux.  Centralized <a href="https://marketplace.graylog.org/addons%3Fkind%3Dplugin">plug-in ecosystem</a> and customizable buffering system.  For convenience, it allows for a keyword to combine incoming messages into streams and group these streams from different hosts. <br><br>  The system uses Elasticsearch functions, but despite frequent Graylog updates and a developed community (there is a <a href="https://community.graylog.org/">forum</a> , an <a href="https://webchat.freenode.net/%3Fchannels%3D%252523graylog">IRC channel</a> , <a href="http://docs.graylog.org/en/2.4/pages/installation/manual_setup.html">there are examples of configurations</a> and <a href="http://docs.graylog.org/en/2.4/pages/configuration/rest_api.html">APIs</a> on the project‚Äôs official website.), It takes a long time to integrate current versions of Elasticsearch into a project.  For example, last year there was a situation when Graylog 2.2.1 (at that time the last one) <a href="http://proceedings.spiiras.nw.ru/ojs/index.php/sp/article/download/3590/2090">worked only</a> with Elasticsearch version 2.4.4, which was considered obsolete. <br><br>  In its work, Graylog <a href="https://stackshare.io/graylog/in-stacks">uses the</a> European Environment Agency, Dial Once, Stockopedia, and others. <br><br><h5>  <a href="http://www.logalyze.com/">LOGalyze</a> </h5><br>  Works under Linux and Windows.  The system has high performance and is able to compile detailed reports on keywords.  There is a serious drawback - LOGalyze collects logs in its file database, where it then indexes them, occupying a significant amount of disk space. <br><br>  The developers of LOGalyze <a href="http://www.logalyze.com/support/blogalyze">maintain their own blog</a> , and the discussion of the solution takes place in <a href="https://groups.google.com/forum/">Google groups</a> .  There is a guide <a href="http://confluence.zuriel.hu/display/LOGDOCEN40/Engine%2BConfiguration">to</a> system <a href="http://confluence.zuriel.hu/display/LOGDOCEN40/Engine%2BConfiguration">configuration</a> and data <a href="http://www.logalyze.com/product/feature-details/collectors/database-connectivity">migration</a> , as well as the <a href="https://sourceforge.net/projects/logalyze-cli/">CLI</a> . <br><br><hr><br>  After evaluating these four options, we chose Logstash and decided to organize an ELK stack (ElasticSearch, Logstash, Kibana).  Of these, Elasticsearch is a search engine, Logstash is a mechanism for collecting and analyzing logs, and Kibana is ‚Äúengaged‚Äù in analytics and data visualization. <br><br><img src="https://habrastorage.org/webt/gs/2d/qa/gs2dqaixd1h6pcrnz_dnqjmx1nw.png"><br><br>  We chose ELK, since all three components are developed by one ‚Äúmanufacturer‚Äù, therefore they are well integrated with each other.  If necessary, we can use each of these tools separately for other tasks. <br><br>  This approach makes the product flexible and versatile.  All this will allow for more efficient processing of already existing data volumes and faster implementation of new services - it will be easier to connect them. <br><br>  The test environment is now ready.  It "covers" all services, the logs of which we will analyze.  We are completing the latest debugging processes and are planning a full launch of the solution in the near future. <br><br>  By the way, despite the fact that we analyzed in detail the various options and chose the best for our needs, in the end, it was not without a fly in the ointment.  When testing a solution, we encountered a situation where Kibana dropped Elasticsearch with a query - which is considered an extremely rare and degenerate case.  Also, when ‚Äúassembling‚Äù the system, a number of issues arose, mainly related to security.  In the basic version, Elasticsearch is not protected by anything - it was necessary to adapt third-party software for these purposes. <br><br>  After launch, we will set up monitoring systems to respond as quickly as possible to failures in the log service.  We expect that the new technology stack will improve the user experience of our customers and further develop our services in the future. <br><br><h5>  Materials from our corporate blog: </h5><br><ul><li>  <a href="https://1cloud.ru/blog/oblachnyj-server-dlja-praktiki-sysadmina%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Dsys_admin%26utm_content%3Dblog">Training stand for admins: how not to break wood on the ‚Äúcombat‚Äù infrastructure</a> </li><li>  <a href="https://1cloud.ru/blog/novyj-server-cisco-ucs-b480-m5%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Dsys_admin%26utm_content%3Dblog">Photo report - review of our new products: Cisco UCS B480 M5</a> </li><li>  <a href="https://1cloud.ru/blog/bezopasnost-dannih-v-oblake%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Dsys_admin%26utm_content%3Dblog">How secure data is in the cloud</a> </li><li> <a href="https://1cloud.ru/blog/virtualnyj-kompyuter-zapushchennyj-v-oblake-luchshe-schitat-zheleznym%3Futm_source%3Dhabrahabr%26utm_medium%3Dcpm%26utm_campaign%3Dsys_admin%26utm_content%3Dblog">What is rented infrastructure better than the usual "iron"</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/420589/">https://habr.com/ru/post/420589/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420577/index.html">The digest of interesting materials for the mobile developer # 266 (August 13 ‚Äî August 19)</a></li>
<li><a href="../420579/index.html">24-core CPU, and I can not dial an email</a></li>
<li><a href="../420581/index.html">Forecasting real estate sales. Lecture in Yandex</a></li>
<li><a href="../420585/index.html">Barcode database free download without registration (and other persimmon)</a></li>
<li><a href="../420587/index.html">Well, where do these engines go now?</a></li>
<li><a href="../420591/index.html">Translation of Andrew Un‚Äôs Passion for Machine Learning, Chapter 20-27</a></li>
<li><a href="../420593/index.html">Mobile Web Navigation Optimization (2 Recent Success)</a></li>
<li><a href="../420595/index.html">Automatic program generation, inverse problem and some related solutions</a></li>
<li><a href="../420597/index.html">Data Protection Officer - GDPR updates profession</a></li>
<li><a href="../420599/index.html">Thirteen Things Lemme foreseen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>