<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability in Telegram allows you to bypass the password local code of any length</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From past 
 In my previous work, I demonstrated the vulnerability of secret Telegram chats, and posted a video manual for restoring the local code Tel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability in Telegram allows you to bypass the password local code of any length</h1><div class="post__text post__text-html js-mediator-article"><h4>  From past </h4><br>  In my <a href="https://habr.com/ru/post/419551/">previous</a> work, I demonstrated the vulnerability of secret Telegram chats, and posted a video manual for restoring the local code Telegram to GNU / Linux / Windows / Android (hacking the Mid-Telegram). <br><br>  Recently discovered the "continuation of the vulnerability": Android-Telegram [bypassing the local code of the password of any length] (added the attack "fingerprint"). <br><a name="habracut"></a><br>  Some of the comments that I am going to refute due to a random experiment with my experimental Android device. <br><blockquote>  "On Habr√© published an article entitled" Vulnerability in the Telegram allows you to compromise the secret chats. "  Loud headline, yes.  We got acquainted with the material and recommend readers to do the same, at least for the sake of interest. ‚Äù <br>  ‚ÄúIn the Android version of Telegram for several years, how can you set a complex alphanumeric password instead of a pin code?‚Äù </blockquote>  <a href="https://telegramfor.me/chan_post.php%3Fid%3D16968936">A source</a> <br><blockquote>  "In the Android version, there IS the ability to set an arbitrary password, for those who have little 4-digit PIN" <br></blockquote>  <a href="https://habr.com/ru/post/419551/">A source</a> <br><blockquote>  ‚ÄúYou can not use a pin, but a password.  And if you have a root or unlocked bootloader or an unencrypted phone, then what kind of personal data security can you say? ‚Äù <br></blockquote>  <a href="https://habr.com/ru/post/419551/">A source</a> <br><blockquote>  "Secondly, the victim should not include data encryption on his device" <br></blockquote>  <a href="https://meduza.io/slides/za-dve-nedeli-smi-soobschili-srazu-o-pyati-uyazvimostyah-telegram-aktivnee-drugih-pro-nih-pisala-fabrika-media-evgeniya-prigozhina">Source of</a> <br><br>  (Retreat - there were all sorts of (not just criticism, something tougher) "funny" comments about the attack on the Local Code, for example, such a comment: <br><blockquote>  ‚ÄúTehpod telegram, a crowd of stupid yeh ... s who don‚Äôt want or can‚Äôt tell Durov that it‚Äôs possible to break into secret chats and you don‚Äôt need to break his praised protocol‚Äù </blockquote>  <a href="https://medium.com/%40giktime8/%25D1%2582%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC-%25D0%25B2%25D0%25B7%25D0%25BB%25D0%25BE%25D0%25BC%25D0%25B0%25D0%25BD-be77e8778f87">Source</a> ) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I am not going to rewrite the previous article, everything is described in detail in the cracking of the local code in the <a href="https://habr.com/ru/post/419551/">previous</a> work, I will remind you of the key points: <br>  Telegram local code (pin) is cracked instantly with JTR.  Conditions: need root;  as it turned out "today" Android encryption does not always save;  will not save and instead of ‚Äúpin‚Äù ‚Äúpassword‚Äù local code Telegram. <br><br>  To get hold of the secret Telegram chats, it was enough to copy ‚Äúseveral files‚Äù from the root device to another, to crack the non-crypto-resistant local code using JTR.  The brute force attack speed was impressive, but still not so fast as to crack someday ‚Äúpassword‚Äù local code&gt; 30 characters.  Found a way to attack the password local code of any length and complexity. <br><br><h4>  Attack algorithm next </h4><br>  (we have root; encrypted gadget; password&gt; 30 characters on the victim's side; a fingerprint device does not exist ‚Äúthat is, it does not matter‚Äù). <br><br><ul><li>  Steal the "external data telegram" (see article before). </li><li>  Configure unlocking your Android device with a fingerprint on the side of the researcher (the position of the attacker). </li><li>  Install with GP Telegram and merge with ‚Äúexternal data‚Äù. </li><li>  When opening the Telegram on the device of the researcher and when prompted to enter a 31-digit password (to unlock the local code), put your finger on it.  Telegram unlocks, all secret chats / correspondence and cloud will be available to the researcher. </li></ul><br>  Interestingly, only Telegram (out of 4 tested applications) is subject to such an attack.  I tried to conduct similar attacks on keepass2android offline;  Sberbank Online;  Yandex money - these Android applications required a password and did not react to the imprint. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/LpGGrA7rj0Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>The plot on the video:</b> <br><br><ul><li>  Created a secret chat between Android on Virtualbox, where there is no fingerprint device and Android 6. Between the "terrorists" there is communication. </li><li>  On Android Virtualbox, I set the local code. A 31-digit password is to block the Telegram application. </li><li>  I backup the Telegram-Virtualbox account (it is not necessary to copy all the data, see the previous article). </li><li>  I copy the data on the poison. </li><li>  I am taking c Poison Backup on Android 6. </li><li>  I install Telegram on Android 6 from GP. </li><li>  Slip part of the "external data" from the Android 6 backup on the installed Android 6. </li><li>  I launch Telegram on Android 6, I get a request to enter a password / fingerprint.  I attach a fingerprint, and the telegram is unlocked, all the MF correspondence and the cloud are available. </li><li>  I restart Telegram, enter the 31-digit local code, and Telegram is also unlocked. </li></ul><br><br>  Double  I removed the fingerprint on the smartphone, dropped the pin-cod of the smartphone.  I installed a new pin on the device, created a new fingerprint.  I rerun the experiment (I cleared the Telegram completely from the devices / installed it) and the new imprint unlocked someone else‚Äôs Telegram account again.  Version Telegram-Android v5.4 from 02.27.2019. <br><br>  <b>Summing up this part of the article.</b> <br><br>  Telegram is susceptible to theft of keys, but the strangest thing in the messenger is ‚Äúintegrated fingerprint in the application‚Äù.  Yandex money;  Sberbank Online;  keepass2android offline - not subject to such an attack.  All the applications listed above have the function unlock the application by fingerprint, but in Telegram it is forcibly integrated and works when it is used for insidious purposes, in other applications the function ‚Äúfingerprint‚Äù does not work - fraud protection). <br><br>  Telegram Messenger is a massive messenger, protection needs to be developed both for housewives and for all.  The face of the company is wrong when it declares that all troubles come from the fact that everything has been compromised, except for the Telegram messenger. <br>  If you lose your ruled (in some cases encrypted) device, you should not worry about finances or keepass2android offline (passwords will not be opened).  Anyone who finds a gadget - will receive "only" access to all MF Telegram.  Clearing the Telegram data from the new device will not help if the attacker opens it in offline mode (the cache remains in place). <br>  Do Telegram developers understand this problem when developing their cryptocurrency? <br><br><h4>  ps / not related to Telegram </h4><br>  I also managed to bypass encryption on the Android device Leagoo M8 and get all the data, including Telegram data for access to the midrange (JTR attack, or fingerprint). <br><br>  There is a stock firmware of this gadget and dozens of custom (free) firmware on w3bsit3-dns.com.  Installed TWRP.  Formatted the Android device Leagoo M8, rolled Resurrection Remix 6 firmware (one of the best in my opinion).  I went to the settings - security - encrypt data.  Encrypted.  Before downloading the gadget, a password was required (the main section was not mounted in TWRP without a password).  I flashed secro.img from the stock firmware and the password (all encryption) safely disappeared.  In TWRP, it became possible to mount a partition without entering a password, / data / data / ... became available. <br><br>  Perhaps this problem (the problem of device encryption) also affects other gadgets, but I don‚Äôt have so many to experiment with different models of devices. </div><p>Source: <a href="https://habr.com/ru/post/442586/">https://habr.com/ru/post/442586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442576/index.html">Long live overclockers: how liquid cooling has become dominant in data centers</a></li>
<li><a href="../442578/index.html">Linux 5.0 release</a></li>
<li><a href="../442580/index.html">Reverse engineering of a binary format on the example of Korg .SNG files</a></li>
<li><a href="../442582/index.html">How we tried mobbing</a></li>
<li><a href="../442584/index.html">Documents on the building: the small joys of automation on the example of the Dark Tower</a></li>
<li><a href="../442588/index.html">Ask a question to the author of the language Lua</a></li>
<li><a href="../442592/index.html">Using Joomla Accounts in a Django Project</a></li>
<li><a href="../442594/index.html">And you will monitor everything for me? Aha</a></li>
<li><a href="../442596/index.html">Soundtrack for the game: humanists cry too</a></li>
<li><a href="../442598/index.html">Do we need Headhunters?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>