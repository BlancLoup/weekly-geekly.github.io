<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Build reports and analyze group policies using PowerShell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic of using PowerShell for administration is extremely relevant, and more and more articles on this topic appear on Habr√©. The previous transla...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Build reports and analyze group policies using PowerShell</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/storage2/eef/1be/c68/eef1bec6878c24a31ad68b76ed06356e.jpg">  The topic of using PowerShell for administration is extremely relevant, and more and more articles on this topic appear on Habr√©.  The previous <a href="http://habrahabr.ru/company/netwrix/blog/160837/">translation of the article by</a> Geoffrey Hicks, which we published last Friday, caused a wave of interest.  And how can you not remember the remarkable performance of the same author on TechEd North America 2012. The report, which Jeffrey Hicks conducted with Jeremy Moskowitz (Jeremy Moskowitz), was devoted to the analysis of group policy objects and the formation of reports.  The original material (video) is <a href="http://channel9.msdn.com/Events/TechEd/NorthAmerica/2012/WSV415">here</a> , we also provide the short content + scripts.  In any case, we recommend to watch the video itself. <br><br>  The focus of the report was two questions: <br><ol><li>  Build Group Policy Reports </li><li>  We carry out the analysis of group policies </li></ol><br>  Details - under the cut. <br><a name="habracut"></a><br><br><h4>  Using PowerShell in conjunction with group policies: what do you need for this? </h4><br>  To use PowerShell when working with group policies, we need: <br><ul><li>  Windows 7 (to run PowerShell) </li><li>  <a href="http://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D7887">RSAT for Windows 7</a> </li><li>  Actually PowerShell v2.0 or higher </li><li>  Optional: <a href="http://msdn.microsoft.com/ru-ru/library/windows/desktop/aa384753(v%3Dvs.85).aspx">Microsoft Active Directory Provider</a> recommended </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The sequence of our actions: <br><br><ul><li>  Importing a Group Policy Module (Import-module GroupPolicy) </li><li>  Get the group policy object using PowerShell (Get a GPO PowerShell Object) </li><li>  Build a report based on this object </li><li>  We build HTML / XML reports on group policy objects </li><li>  Parsing and searching XML for analysis </li><li>  Search through Select-XML and Xpath </li></ul><br><br><h4>  Build Group Policy Reports </h4><br>  <b>Problem number 1.</b>  <b>It is necessary to obtain information about what is currently happening in group policies.</b> <b><br></b> <br><br><pre><code class="vbscript hljs">PS C:\&gt; Import-Module GroupPolicy PS C:\&gt; <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPO JeremyGPO</code> </pre> <br>  In this case, instead of JeremyGPO appears the display name (DisplayName) of the group policy object.  Such a sign is displayed. <br><br><pre> <code class="vbscript hljs">DisplayName : JeremyGPO DomainName : GLOBOMANTICS.local Owner : GLOBOMANTICS\Domain Admins Id : cd73c562<span class="hljs-number"><span class="hljs-number">-5</span></span>bfe<span class="hljs-number"><span class="hljs-number">-40e2</span></span>-b81e<span class="hljs-number"><span class="hljs-number">-28</span></span>da10da425c GpoStatus : ComputerSettingsDisabled Description : CreationTime : <span class="hljs-number"><span class="hljs-number">12</span></span>/<span class="hljs-number"><span class="hljs-number">28</span></span>/<span class="hljs-number"><span class="hljs-number">2011</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">52</span></span>:<span class="hljs-number"><span class="hljs-number">37</span></span> PM ModificationTime : <span class="hljs-number"><span class="hljs-number">5</span></span>/<span class="hljs-number"><span class="hljs-number">21</span></span>/<span class="hljs-number"><span class="hljs-number">2012</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>:<span class="hljs-number"><span class="hljs-number">08</span></span>:<span class="hljs-number"><span class="hljs-number">26</span></span> AM UserVersion : AD Version: <span class="hljs-number"><span class="hljs-number">4</span></span>, SysVol Version: <span class="hljs-number"><span class="hljs-number">4</span></span> ComputerVersion : AD Version: <span class="hljs-number"><span class="hljs-number">1</span></span>, SysVol Version: <span class="hljs-number"><span class="hljs-number">1</span></span> WmiFilter :</code> </pre><br><br>  <b>Problem solving: create reports.</b> <br><br>  For example, we are faced with the task of obtaining a list of all group objects that have been changed in the last 30 days, sorted in descending order (the last ones at the top) with three values ‚Äã‚Äã(display name, time of change, description).  The resulting information must be exported to a .csv file (GPOModReport.csv in this example).  How it looks in PowerShell: <br><br><pre> <code class="vbscript hljs">PS C:\&gt; <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-gpo -all | Where {$_.ModificationTime -gt (<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).AddDays(<span class="hljs-number"><span class="hljs-number">-30</span></span>)} ... | Sort ModificationTime -Descending | Where {$_.ModificationTime -ge (<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).AddDays(<span class="hljs-number"><span class="hljs-number">-30</span></span>)} | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Displayname,ModificationTime,Description ... | Export-CSV R:\GPOModReport.csv</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Examples of additional commands</b> <div class="spoiler_text"><pre> <code class="vbscript hljs">#      PS C:\&gt;<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-gpo -all | Sort CreationTime,Modificationtime | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> Displayname,*<span class="hljs-built_in"><span class="hljs-built_in">Time</span></span></code> </pre><br><br><pre> <code class="vbscript hljs">#    ,    <span class="hljs-number"><span class="hljs-number">30</span></span>  PS C:\&gt;<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-gpo -all | Where {$_.ModificationTime -ge (<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).AddDays(<span class="hljs-number"><span class="hljs-number">-30</span></span>)}</code> </pre><br><br><pre> <code class="vbscript hljs">#       (Defaul Domain Policy) PS C:\&gt;<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -name <span class="hljs-string"><span class="hljs-string">"Default Domain Policy"</span></span> -ReportType HTML -Path <span class="hljs-string"><span class="hljs-string">"c:\work\ddp.htm"</span></span> invoke-item <span class="hljs-string"><span class="hljs-string">"c:\work\ddp.htm"</span></span></code> </pre><br><br><pre> <code class="vbscript hljs">#       PS C:\&gt;<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -All -ReportType HTML -Path <span class="hljs-string"><span class="hljs-string">"c:\work\allgpo.htm"</span></span> invoke-item <span class="hljs-string"><span class="hljs-string">"c:\work\allgpo.htm"</span></span></code> </pre><br><br><pre> <code class="vbscript hljs">#        #   _   GPO PS C:\&gt;<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPO -all | foreach { $f=<span class="hljs-string"><span class="hljs-string">"{0}.htm"</span></span> -f ($_.Displayname).<span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(<span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"_"</span></span>) $htmfile=<span class="hljs-built_in"><span class="hljs-built_in">Join</span></span>-Path -Path <span class="hljs-string"><span class="hljs-string">"C:\work"</span></span> -ChildPath $f <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -Name $_.Displayname -ReportType HTML -Path $htmfile <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Item $htmfile }</code> </pre><br></div></div><br><br>  <b>Problem number 2.</b>  <b>Too many GPOs that are not used.</b> <b><br></b> <br><br>  <b>Task: find empty GPOs</b> <b><br></b> <br><br><ul><li>  Define group policy objects without settings </li><li>  We are looking for XML ExtensionData </li></ul><br><br><pre> <code class="vbscript hljs">PS C:\&gt; Import-Module GroupPolicy PS C:\&gt; [xml]$r = <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -Name MyGPO -ReportType XML PS C:\&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((-<span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> $r.gpo.user.extensiondata) -<span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (-<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> $r.gpo.computer.extensiondata)) { <span class="hljs-string"><span class="hljs-string">"GPO is empty"</span></span> }</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Additional commands</b> <div class="spoiler_text"><pre> <code class="vbscript hljs">#requires -version <span class="hljs-number"><span class="hljs-number">2.0</span></span> #find <span class="hljs-literal"><span class="hljs-literal">empty</span></span> gpos <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the domain <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-EmptyGPO { Param ( [Parameter(Position=<span class="hljs-number"><span class="hljs-number">0</span></span>,ValueFromPipeline=$<span class="hljs-literal"><span class="hljs-literal">True</span></span>, ValueFromPipelinebyPropertyName=$<span class="hljs-literal"><span class="hljs-literal">True</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>]$DisplayName ) Begin { #import the GroupPolicy Module Import-Module GroupPolicy } Process { #create an XML report [xml]$report=<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -Name $displayname -ReportType XML #totally <span class="hljs-literal"><span class="hljs-literal">empty</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((-<span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> $report.gpo.user.extensiondata) -<span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> (-<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> $report.gpo.computer.extensiondata)) { #no extension data so write <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPO -Name $Displayname } } #process <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> {} } #<span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Test-EmptyGPO { Param ( [Parameter(Position=<span class="hljs-number"><span class="hljs-number">0</span></span>,ValueFromPipeline=$<span class="hljs-literal"><span class="hljs-literal">True</span></span>, ValueFromPipelinebyPropertyName=$<span class="hljs-literal"><span class="hljs-literal">True</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>]$DisplayName ) Begin { #import the GroupPolicy Module Import-Module GroupPolicy } Process { #<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> values $User=$<span class="hljs-literal"><span class="hljs-literal">False</span></span> $Computer=$<span class="hljs-literal"><span class="hljs-literal">False</span></span> #create an XML report [xml]$report=<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -Name $displayname -ReportType XML <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($report.gpo.user.extensiondata) { $User=$<span class="hljs-literal"><span class="hljs-literal">True</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> ( $report.gpo.computer.extensiondata) { $Computer=$<span class="hljs-literal"><span class="hljs-literal">True</span></span> } #write a custom object <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the pipeline <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-Object -<span class="hljs-built_in"><span class="hljs-built_in">TypeName</span></span> PSObject -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> @{ Displayname=$report.gpo.name UserData=$User ComputerData=$Computer } } #Process <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> {} } #<span class="hljs-keyword"><span class="hljs-keyword">function</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPO -All | <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-EmptyGPO #<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPO -All | Test-EmptyGPO</code> </pre><br></div></div><br><br>  <b>Problem number 3.</b> <b><br></b>  Who accessed the GPO? <br>  Are there GPOs where half of the policy is deactivated (‚ÄúAre there any GPOs with 'half' the policy disabled?‚Äù) <br>  Are there GPOs in which all policies are deactivated (‚ÄúAre there any GPOs with 'all' the policy disabled?‚Äù) <br><br>  Apply a filter by GPO status (GPOStatus).  Three commands correspond to each of the three questions above: <br><br><pre> <code class="vbscript hljs">PS C:\&gt; <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-gpo -all | Sort GPOStatus | format-table -GroupBy GPOStatus Displayname,*<span class="hljs-built_in"><span class="hljs-built_in">Time</span></span> PS C:\&gt; <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-gpo -all | where {$_.GPOStatus -match <span class="hljs-string"><span class="hljs-string">"disabled"</span></span>} | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> GPOStatus,Displayname PS C:\&gt; <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-gpo -all | where {$_.GPOStatus -match <span class="hljs-string"><span class="hljs-string">"AllSettingsDisabled"</span></span>}</code> </pre><br><br><h4>  Analyzing Group Policy Objects </h4><br>  <b>Problem number 4.</b>  <b>Discover GPO without connections</b> <b><br></b> <br><br><pre> <code class="vbscript hljs">PS C:\&gt; Import-Module ActiveDirectory <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADOrganizationalUnit -<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> * | <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>-object -ExpandProperty DistinguishedName | <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-adobject -prop gplink | where {$_.gplink} | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>-object -expand gplink | foreach-object { foreach ($item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ($_.<span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(<span class="hljs-string"><span class="hljs-string">"]["</span></span>))) { $links+=$regex.match($item).Value } } <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPO -All | Where {$links -notcontains $_.id}</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Additional commands</b> <div class="spoiler_text"><pre> <code class="vbscript hljs">#requires -version <span class="hljs-number"><span class="hljs-number">2.0</span></span> &lt;# Find unlinked GPOs. This requires the Active Directory Module This version does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> query <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> site links #&gt; Import-Module ActiveDirectory,GroupPolicy #GUID regular expression pattern [Regex]$RegEx = <span class="hljs-string"><span class="hljs-string">"(([0-9a-fA-F]){8}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){4}-([0-9a-fA-F]){12})"</span></span> #create an <span class="hljs-built_in"><span class="hljs-built_in">array</span></span> of distinguishednames $dn=@() $dn+=<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADDomain | <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> -ExpandProperty DistinguishedName $dn+=<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADOrganizationalUnit -<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> * | <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> -ExpandProperty DistinguishedName $links=@() #<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> domain <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> OU links foreach ($container <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $dn) { #pull the GUID <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> add it <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-built_in"><span class="hljs-built_in">array</span></span> of links <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-adobject -identity $container -prop gplink | where {$_.gplink} | <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> -expand gplink | foreach { #there might be multiple GPO links so <span class="hljs-built_in"><span class="hljs-built_in">split</span></span> foreach ($item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ($_.<span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(<span class="hljs-string"><span class="hljs-string">"]["</span></span>))) { $links+=$regex.match($item).Value } #foreach item } #foreach } #foreach container #$links &lt;# <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> all gpos where the ID doesn<span class="hljs-comment"><span class="hljs-comment">'t belong to the array write the GPO to the pipeline #&gt; Get-GPO -All | Where {$links -notcontains $_.id}</span></span></code> </pre><br><br></div></div><br>  <b>Problem 5. Group Policy Objects with Excess Registry Settings (‚ÄúExtra Registry Settings‚Äù)</b> <br><br>  We find unnecessary settings in the registry <br><pre> <code class="vbscript hljs">#Use Xpath <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the XML report data PS C:\&gt; [xml]$report = <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -Name MyGPO -ReportType XML PS C:\&gt; $ns = @{q3 = <span class="hljs-string"><span class="hljs-string">"http://www.microsoft.com/GroupPolicy/Settings/Registry"</span></span>} PS C:\&gt; $nodes = <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>-Xml -Xml $report -Namespace $ns -XPath <span class="hljs-string"><span class="hljs-string">"//q3:RegistrySetting"</span></span> | <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> -expand Node | Where {$_.AdmSetting -eq <span class="hljs-comment"><span class="hljs-comment">'false'}</span></span></code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Additional commands</b> <div class="spoiler_text"><pre> <code class="vbscript hljs">#requires -version <span class="hljs-number"><span class="hljs-number">2.0</span></span> #find GPOs <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> extra registry, ie non-ADM settings <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Test-GPOExtraRegistry { Param ( [Parameter(Position=<span class="hljs-number"><span class="hljs-number">0</span></span>,ValueFromPipeline=$<span class="hljs-literal"><span class="hljs-literal">True</span></span>, ValueFromPipelinebyPropertyName=$<span class="hljs-literal"><span class="hljs-literal">True</span></span>)] [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>]$DisplayName ) Begin { #import the GroupPolicy Module Import-Module GroupPolicy } Process { #create an XML report [xml]$report=<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-GPOReport -Name $displayname -ReportType XML #define the XML namespace $ns=@{q3=<span class="hljs-string"><span class="hljs-string">"http://www.microsoft.com/GroupPolicy/Settings/Registry"</span></span>} $nodes=<span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>-Xml -Xml $report -Namespace $ns -XPath <span class="hljs-string"><span class="hljs-string">"//q3:RegistrySetting"</span></span> | <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> -expand Node | Where {$_.AdmSetting -eq <span class="hljs-comment"><span class="hljs-comment">'false'} if ($nodes) { #extra settings were found so get the GPO and write it to the pipeline Get-GPO -Name $Displayname } } End {} } #function #Import-Module GroupPolicy #Get-GPO -all | Test-GPOExtraRegistry</span></span></code> </pre><br></div></div><br><br>  Let us once again denote that we have only post the dry residue of what was shown in the report.  The report itself can be viewed <a href="http://channel9.msdn.com/Events/TechEd/NorthAmerica/2012/WSV415">here</a> . <br><br>  Bonuses: <br><ul><li>  <a href="">Link to scripts</a> </li><li>  <a href="http://jdhitsolutions.com/blog/wp-content/uploads/2012/06/GroupPolicy_Reporting_Analysis_with_PowerShell.pdf">Slides</a> </li><li>  <a href="https://moskowitzinc.infusionsoft.com/app/form/2fb14a6883b8b10595a174b65169af71">Free book on Group Policy + PowerShell from one of the authors of the report [ENG]</a> (you must fill out the form) </li></ul><br><br>  You can also use our <a href="http://www.netwrix.com/ru/group_policy_auditing_change_reporting_freeware.html">NetWrix Group Policy Change Reporter</a> program to build group policy reports. </div><p>Source: <a href="https://habr.com/ru/post/161533/">https://habr.com/ru/post/161533/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161517/index.html">Installing Python Image Library (PIL) on x64 systems using CentOS as an example</a></li>
<li><a href="../161519/index.html">Kickstarter: Pros and Cons</a></li>
<li><a href="../161521/index.html">Asterisk: callback using AMI</a></li>
<li><a href="../161527/index.html">Android: Writing Multi-threaded Applications with Intel¬Æ Threading Building Blocks</a></li>
<li><a href="../161529/index.html">Easy spy tank programming</a></li>
<li><a href="../161535/index.html">Last.fm creators Lumi recommends interesting content from the browsing history of other users</a></li>
<li><a href="../161537/index.html">Jelastic plugin for IntelliJ IDEA</a></li>
<li><a href="../161539/index.html">Wooden mouse Project history</a></li>
<li><a href="../161541/index.html">Mary Micker's annual report on online trends: The share of Android + iOS shipments is growing (45% vs. 35% for Windows)</a></li>
<li><a href="../161547/index.html">Have you met in the code / comments / configuration files?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>