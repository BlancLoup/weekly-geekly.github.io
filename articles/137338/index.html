<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Treemap, deputies income, and language processing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Reading the topic on Habr√© ‚ÄúThe State Duma presented the incomes of the deputies in a new form‚Äù , I decided that the data on the incomes of the deputi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Treemap, deputies income, and language processing</h1><div class="post__text post__text-html js-mediator-article">  Reading the topic on Habr√© <a href="http://habrahabr.ru/blogs/e_gov/133799/">‚ÄúThe State Duma presented the incomes of the deputies in a new form‚Äù</a> , I decided that the data on the incomes of the deputies cost visualization.  My acquaintance with the topic ‚ÄúData Visualization‚Äù once began with Processing, therefore it was he who acted as a tool.  Below is a fragment of one of the first pictures, and then you can get acquainted with what Treemapping is and how to prepare it at Processing. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/c9c/d08/d08/c9cd08d08645f321e22d3cb96dad98d1.png"><br><a name="habracut"></a><br>  One of the best books on data visualization for me is Ben Fry's <a href="http://books.google.ru/books%3Fid%3D6jsVAiULQBgC%26printsec%3Dfrontcover">‚ÄúVisualizing Data‚Äù</a> , a small book by one of the creators of Processing.  This book kills two birds with one stone: it is well told about the principles of information visualization, plus it tells how to use the language <a href="http://processing.org/">Processing</a> for this.  About Processing on Habr√© already wrote, <a href="http://habrahabr.ru/blogs/programming/58314/">here</a> and <a href="http://habrahabr.ru/blogs/programming/69617/">here</a> .  Version 2.0a4 is now available (albeit not yet alpha).  In the first chapter, ‚ÄúVisualizing Data,‚Äù Ben Fry describes the seven stages of data visualization: data acquisition, data parsing, filtering excess data, data processing (for example, finding the minimum and maximum), choosing the data representation, improving this view, and the last point is the addition of interactivity.  He also points out that this process is not always consistent and often has to go back to the previous stages. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e9d/36d/08f/e9d36d08f1da08e72681ba955e259ee0.jpg" width="550">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first item, of course, is getting the data itself.  After viewing the pages of several deputies on the Duma‚Äôs website, it became clear that only the number changes in the url - by typing, it was found that the required range lies within [23494 - 23964], <a href="http://www.duma.gov.ru/structure/deputies/23494/">http://www.duma.gov.ru/structure/deputies / 23494 /</a> until <a href="http://www.duma.gov.ru/structure/deputies/23964/">http://www.duma.gov.ru/structure/deputies/23964/</a> .  On the page itself, I needed the data of belonging to a certain faction and information on income.  I downloaded the data using a C # program (since I already had one), but it would not be difficult to do this with the help of some of my own scripts.  True, going to the Duma‚Äôs website the next day, for some reason I didn‚Äôt see any information about the deputies ‚Äôincome - I don‚Äôt know what it was - from work and then on other days everything was in place.  But I digress.  The first item was executed - the data was received.  It is time to visualize them, and I decided to start with a bar chart, since it is quite simple to make. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/ae4/394/277/ae4394277e7ab63f6cd50f42aeb253ed.png" alt="Revenues of deputies for 2010"><br><br>  The picture well shows that the majority of deputies receive approximately the same money and that there is a part of deputies that receives an order of magnitude more.  Cons of this chart: it is not very suitable for comparing about 450 indicators.  In addition, the strong variation in income values ‚Äã‚Äãmakes small values ‚Äã‚Äãindistinguishable.  You can, of course, make the scale logarithmic, but then the visual intrigue of comparison of almost two billion to two million is lost.  Good - once the comparison of indicators along the corresponding length of the column works poorly - it is necessary to compare areas!  We draw circles instead of columns: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/280/264/667/2802646670fc2898d82fd2e5ceefda33.png" alt="null"><br><br>  The circles are not impressive - we replace them with squares: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/259/a11/be6/259a11be67d99e4197d2f0adbb4e5880.png" alt="Treemap Example"><br><br>  As if better.  Immediately for some reason I remembered the <a href="http://xkcd.com/980/">picture</a> with xkcd.  And here another option comes to mind - <a href="http://en.wikipedia.org/wiki/Treemapping/">treemap</a> . <br><br>  Treemap - the invention of gurus in Information Visualization- <a href="http://en.wikipedia.org/wiki/Ben_Shneiderman">Ben Shneiderman'a</a> .  In 1990, Ben Schneiderman wondered which files occupy the largest place on the hard disk (in the laboratory where he worked, 14 users used a disk with 80 Mbyte).  Ben began to think about the compact visualization of the tree structure of folders and files - this is how the diagram, which was later called the Treemap, occurred to him.  You can read more about the history of Treemapping <a href="http://www.cs.umd.edu/hcil/treemap-history/">here</a> : at the end of the article there are many examples of using this type of visualization.  And in the book "Visualizing Data" an entire chapter is devoted to a treemap.  The Processing distribution kit includes examples for this book and there are two examples dedicated to a Treemap.  In both examples, the <a href="http://benfry.com/writing/treemap/">Treemap</a> library is <a href="http://benfry.com/writing/treemap/">used -</a> this <a href="http://benfry.com/writing/treemap/">is</a> a modified version of the Java library for working with Processing.  In this library there are several algorithms for dividing the space into rectangles: slice-and-dice, pivot-by-middle, pivot-by-size, pivot-by-split-size and squarified layout.  You can compare the work of different algorithms <a href="http://www.cs.umd.edu/hcil/treemap-history/java_algorithms/LayoutApplet.html">here</a> (a Java plugin is required).  The picture, which gives "Squarified layout", in my opinion, the most pleasant to the eye.  This algorithm tends to construct rectangles so that their shape is as close as possible to the squares.  A description of the ‚ÄúSquarified layout‚Äù algorithm is provided in the <a href="http://www.win.tue.nl/~vanwijk/stm.pdf">article by</a> Jack van Wijk.  To start working with the library you need to get acquainted with three classes from the library: SimpleMapItem, MapModel and Treemap.  The SimpleMapItem class represents a single cell, MapModel stores a list of cells in an array, and the Treemap class builds the visualization itself, accepting an object of type MapModel and the coordinates of the chart boundaries in the designer.  Another object in the Treemap is a MapLayout object, which specifies the implementation of the split algorithm.  By default, the Treemap uses the pivot-by-split-size algorithm, but nothing prevents you from specifying a different algorithm using the function: setLayout (MapLayout algorithm).  So, in general, to get a Treemap visualization in Processing, we create the classes DeputatItem and DeputatMap, which implement the SimpleMapItem and MapMode interfaces, respectively.  In SimpleMapItem there is a size parameter, which is responsible for the size of a rectangle in a treemap; we will assign to it the amount of money earned by a deputy. <br><br>  We read the data and save it in a DeputatItem object, which implements the SimpleMapItem interface.  The created object with information about the deputy is added to the DeputatMap object (implementation of the MapModel interface). <br><br><pre><code class="java hljs">DeputatMap dMap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DeputatMap(); String[] lines = loadStrings(<span class="hljs-string"><span class="hljs-string">"parliamentV2010.csv"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; lines.length; i++) { <span class="hljs-comment"><span class="hljs-comment">//...  id, party, name, money  lines[i] DeputatItem d = new DeputatItem(id, party, name, money); dMap.addDeputat(d); } dMap.finishAdd();</span></span></code> </pre> <br><br>  Create a Treemap object, giving it the parameters of a DeputatMap, and the size of the rectangle in which to build the diagram. <br><br><pre> <code class="java hljs">Treemap treemap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Treemap(dMap , <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width - <span class="hljs-number"><span class="hljs-number">1</span></span>, height - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   SquarifiedLayout    treemap MapLayout algorithm = new SquarifiedLayout(); treemap.setLayout(algorithm); treemap.updateLayout();</span></span></code> </pre><br><br>  The previous code is executed in the Processing function setup (), and in the Processing function draw () we call the function draw () of the treemap object. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ treemap.draw(); }</code> </pre><br><br>  If each deputy is asked to color in accordance with the party to which he belongs, and display information on the deputies in the cells whose size this allows, then we will get the following picture: <br><br><img src="http://artprocessing.ru/wp-content/uploads/2012/01/DumaVFirstTry.png" alt="null"><br><br>  I decided to group the deputies belonging to the same party: for this you need to add another level of hierarchy - the party.  Schematically, the tree structure obtained in the previous stage can be represented as follows: Duma-&gt; deputies, adding parties will get: Duma-&gt; parties-&gt; deputies.  For such a scheme, we need two more classes: PartyItem (implementation of the SimpleMapItem interface) and PartyMap (implementation of the MapModel interface).  After similar steps to create a treemap, you get this picture: <br><br><img src="http://artprocessing.ru/wp-content/uploads/2012/01/DumaV2010Money.png" alt="null"><br><img src="http://artprocessing.ru/wp-content/uploads/2012/01/DumaVLegenda.png" alt="null"><br><br>  The pictures make it clear the general structure of income distribution, but unfortunately, it will not work to find a specific deputy in the picture.  To do this, you can use the <a href="http://artprocessing.ru/dumaapplet/index.html">interactive version</a> or download the application for <a href="">windows</a> , <a href="">linux</a> , <a href="">mac os</a> , or run the processing by downloading the <a href="">source code</a> . <br><br>  PS Treemap can be built not only in Processing.  Natan Yu, the author of the <a href="http://flowingdata.com/">Flowing data</a> blog, promotes this approach to information visualization: we work with the data in the statistical analysis program <a href="http://www.r-project.org/">R</a> , then get the resulting image to mind in Illustrator.  Nathan recently released a <a href="http://book.flowingdata.com/">book</a> that describes this approach in detail.  In R there is a special function for building a Treemap, for those interested, <a href="http://flowingdata.com/2010/02/11/an-easy-way-to-make-a-treemap/">click on a topic</a> on Nathan‚Äôs blog. <br><br>  There are also JavaScript implementations: <br>  <a href="http://code.google.com/apis/chart/interactive/docs/gallery/treemap.html">Google Chart Tools Treemap</a> ; <br>  <a href="http://mbostock.github.com/d3/ex/treemap.html">d3.js treemap</a> ; <br>  <a href="http://thejit.org/static/v20/Jit/Examples/Treemap/example1.html">JavaScript InfoVis Toolkit Treemap</a> . </div><p>Source: <a href="https://habr.com/ru/post/137338/">https://habr.com/ru/post/137338/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137331/index.html">Review of programs for monitoring the consumption of mobile Internet</a></li>
<li><a href="../137332/index.html">An office that is always at hand: an example of how a virtual desktop works on portable devices</a></li>
<li><a href="../137333/index.html">When need RVM, and when enough rbenv</a></li>
<li><a href="../137334/index.html">Using vkontakte js api for semi-automatic posting of messages from rss feeds</a></li>
<li><a href="../137336/index.html">Translator from Delphi to javascript</a></li>
<li><a href="../137339/index.html">Sliding in two - no, in four directions</a></li>
<li><a href="../137341/index.html">Access the operating system clipboard from a web application</a></li>
<li><a href="../137342/index.html">50 tips for developing flawless design iOS apps</a></li>
<li><a href="../137343/index.html">Change images</a></li>
<li><a href="../137344/index.html">Unisender seminar on email, SMS and SMM integration: photo report</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>