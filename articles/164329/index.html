<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Problems with the list of sites Roskomnadzor. Telecom operators, beware</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr. 


 We have already written how it turned out to be nontrivial to get access to the list of prohibited materials of Roskomnadzor, for organi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Problems with the list of sites Roskomnadzor. Telecom operators, beware</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr. <br><br><img align="right" src="https://habrastorage.org/storage2/d97/982/13a/d9798213a93ea657f7754ef87d793054.png"><br>  We <a href="http://habrahabr.ru/post/158891/">have already written</a> how it turned out to be nontrivial to get access to the list of prohibited materials of Roskomnadzor, for organizing automatic monitoring of the access of our networks and sites of our clients for blocking.  Unfortunately, the story of the attack on numerous rakes continues, so we would like to share it.  The described information will be primarily useful for telecom operators, who, like us, track the situation when resources are on the Roskomnadzor list. <a name="habracut"></a><br><br>  So, having started automatic monitoring in November, we waited for X hours - the appearance of a client resource in the list.  On the one hand, of course, it‚Äôs pleasant that it‚Äôs necessary to rush in contact with the client and decide whether to remove the blocked information, it‚Äôs not enough, all the more so as we are told that the reaction takes 1 day, which is written <a href="http://zapret-info.gov.ru/tooperators/">in the instruction sheet to the telecom operator</a> , on the other hand On the other hand, all the tests that were carried out before were somehow synthetic, and the developer inside was waiting impatiently for the automation to work on real data, happily notifying technical support and administrators in all possible ways.  After all, it‚Äôs nice (for developers, not admins) to see in the logs that the server has crashed, but the backup server has pulled the load on itself, that the master database has fallen off, but the replica has replaced it, etc.  In short, it was just interesting to see the system in action. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And here, on December 27, we received an e-mail message from Roskomnadzor that the page of our client, <a href="http://www.tourister.ru/">www.tourister.ru,</a> got into the ill-fated list.  The fact is that Turister.ru is such a social network for tourists, where people post reviews, reviews and life hacks about various trips.  And in the blocked article it was told how to go to Amsterdam correctly and what kind of grass worth buying there.  It is worth noting that the reason for blocking is completely understandable and does not cause any special questions, so we promptly contacted the administration of the resource and as a result the article was deleted.  It would seem that everything was a happy ending, but one moment alerted us - our monitoring of prohibited resources had not responded to this situation in any way.  Those.  In the staff list, our helpdesk received reports about the next freshly loaded dump, but there was no information that the tourister.ru was blocked: <br><br><img src="https://habrastorage.org/storage2/ec0/6ff/c7f/ec06ffc7f227861ef391de951d718133.png"><br><br>  Of course, such an order of things strongly disturbed us and we began to check the downloaded dumps, because  especially in the case of a similar situation, we keep a history of loaded databases. <br><br>  By the way, about dumps I would like to separately note one interesting feature.  As you know, the site zapret-info.gov.ru provides an RPC-interface for unloading the registry database.  <a href="http://www.zapret-info.gov.ru/docs/description_for_operators_2012-11-09v1.4.pdf">The documentation</a> declared 3 methods: <br><br><ol><li>  <b>getLastDumpDate</b> - returns the timestamp of the last update upload from the registry. </li><li>  <b>sendRequest</b> - the method of sending the request, in response to which the result code is returned. </li><li>  <b>getResult</b> is a method for getting results. </li></ol><br><br>  In addition, the following case is assumed: <br><br><ul><li>  We make a timestamp request, and if it has changed since the last time, we perform further actions.  In principle, it is logical - we save traffic and save the server (s?) Of Roskomnadzor from unnecessary load.  If the timestamp is unchanged - monitor the resources for this dump. </li><li>  We form and send a request.  Get the code. </li><li>  By code - we get a dump and we check our resources using it. </li></ul><br><br>  We implemented it, but rather quickly we noticed that each monitoring report contains a freshly downloaded dump, while the file size and the number of documents contained remain unchanged.  A quick run of files through the diff-tool showed that the files differ only in the timestamp value.  In fact, the date of the last upload is the current time value, with minutes and seconds discarded.  As a result, the whole idea of ‚Äã‚Äãsaving traffic and resources just does not work. <br><br>  So, after reviewing all the dumps for the last few days, we came to the conclusion that they simply keep a record of page blocking on tourister.ru: <br><br><img src="https://habrastorage.org/storage2/138/1c1/45e/1381c145e41e4aa54f93388ae781313d.png"><br><br>  At the same time, the <a href="http://zapret-info.gov.ru/">zapret-info</a> web interface regularly provides information about blocking: <br><br><img src="https://habrastorage.org/storage2/b68/85b/68f/b6885b68f8954a87a5cc3a9683d347f5.png"><br><br>  <a href="">Of</a> course, we wrote a letter with questions to <a href="">zapret-info@rsoc.ru</a> , but so far we have not received an answer. <br><br>  As a conclusion, I would like to quote myself from the previous article on the topic: <br><blockquote>  Sometimes a task related to working with government agencies may come to a completely unexpected place. </blockquote><br>  So, dear telecom operators, be vigilant. <br><br>  <b>UPD:</b> In the comments, Deputy Head of Roskomnadzor Ksenzov Ksenzov, Maxim Yuryevich, <a href="http://habrahabr.ru/post/164329/">answers questions</a> related to the work of zapret-info.  Attention of users, let's not minus <a href="http://habrahabr.ru/users/ksenzov/" class="user_link">Ksenzov</a> simply because he is a representative of the organization, leading the registry that is hated by everyone, because then we will lose the opportunity to hear the answers and comments from "the other side". </div><p>Source: <a href="https://habr.com/ru/post/164329/">https://habr.com/ru/post/164329/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164309/index.html">12 tools that every Big Data programmer needs to know about</a></li>
<li><a href="../164311/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ37 (December 22 - 28, 2012)</a></li>
<li><a href="../164313/index.html">New Year's Battle of Santa Claus and Santa Claus, as well as a couple of words about Golang</a></li>
<li><a href="../164321/index.html">How expensive is Google Chrome for your SSD?</a></li>
<li><a href="../164327/index.html">Nearby Entertainment Literature</a></li>
<li><a href="../164333/index.html">We sculpt a snowman (decorate the application)</a></li>
<li><a href="../164337/index.html">Custom scripts in Opera Mobile for android</a></li>
<li><a href="../164341/index.html">theos: writing a tweak for iOS SpringBoard</a></li>
<li><a href="../164349/index.html">Videobook ultrabook (tablet) Lenovo IdeaPad Yoga-13</a></li>
<li><a href="../164353/index.html">2013: it's time to stop chasing flops</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>