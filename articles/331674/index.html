<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>5 stages of microservice development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All those who have heard a lot about microservices, but did not dare to do a single one, are dedicated. 
 For the reasons for creating and describing ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>5 stages of microservice development</h1><div class="post__text post__text-html js-mediator-article">  All those who have heard a lot about microservices, but did not dare to do a single one, are dedicated. <br>  For the reasons for creating and describing all the pros and cons, hundreds of articles have already been written - here I will tell you about the practical side of creation and use. <br><div style="text-align:center;"><img src="https://habrastorage.org/web/bfa/ed6/f80/bfaed6f800fd4d23b6b33d5108e88284.png" alt="image"></div><a name="habracut"></a><br>  So, after much deliberation, you decided to do this miracle, maybe because you have turned up a task on the project, which is well suited to the microservice approach, or everyone has already written a few, and you have not had one. <br><br>  The article does not focus on how to write microservices, each has its own methods, here I will tell in general about the stages of development and delivery of the service to production and test. <br>  I divided the creation process into stages.  And here is the first one: <br><br><h2>  1. Task </h2><br>  To begin with, we define what tasks microservice will solve.  Usually, this is access to some resource on the server (database, queues, or file system) with a little logic on the service itself. <br>  Suppose we need to implement data return for display on a map from a slow storage.  The rendering of the microservice will, of course, be done by the client itself.  The data represents the coordinates of points on the map with some kind of title. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  2. Technology </h2><br>  There is a task, now we are determined with the technologies of its solution.  Data storage is slow and will not cope with a large flow of requests.  In such cases, you can use <a href="https://www.elastic.co/products/elasticsearch">elasticsearch</a> - it copes well with large loads and can shard and replicate out of the box.  We put in it the data in a separate script for later search by it. <br><br>  Since in our company Wheels Roof Market, it is customary to write microservices on Go, and I have experience writing on Go, it was decided to write on Go.  In your case, it can be anything - Nodejs, Java, PHP or any other, preferably compiled language.  Since the technology stack also depends on the architecture of the service, at this stage you need to think about it, as well as consider the logic of the work.  Here it is worth collecting info from all clients that will use our microservice, in particular from the mobile development team, if any. <br><br><h2>  3. Coding </h2><br>  After all thoughts on the stack of technology and architecture, the logic of the service we proceed directly to encoding.  Determine whether we will write the code base from scratch (I do not recommend it) or start some kind of ready-made framework. <br><br><div class="spoiler">  <b class="spoiler_title">Lots of implementation on Go</b> <div class="spoiler_text">  It was decided to start <a href="https://github.com/labstack/echo">github.com/labstack/echo</a> - it seemed to me the most lightweight and lively project.  Further, since we have to go for the data in the elastic, then you need to choose either for working with the elastic <a href="https://github.com/olivere/elastic">github.com/olivere/elastic</a> .  For logging we will take <a href="https://github.com/sirupsen/logrus">github.com/sirupsen/logrus</a> .  As a monitoring, you can take <a href="https://github.com/rcrowley/go-metrics">github.com/rcrowley/go-metrics</a> or something simpler <a href="https://github.com/cactus/go-statsd-client">github.com/cactus/go-statsd-client</a> . <br>  We connect all dependencies in main.go, and in the same file we describe the processing of all public methods. <br></div></div><br>  In addition to the main service methods, we describe a special stats method that will return service information via http: the microservice version, the number and codes of processed requests, as well as the launch date - will be used for service purposes and in particular for healthcheck.  In order to be able to run microservice in different environments (development, testing, production), you need to create configs for each environment. <br><br><h2>  4. Documentation </h2><br>  After writing the main part of the code, we proceed to the documentation of the service, because this is the most important part - <b>there</b> is <b>no documentation, no service</b> .  We describe absolutely all the features of microservice.  It is best to get the Readme file for synchronous updating in the project root for this purpose.  Or you can use a <a href="http://swagger.io/">swagger</a> if someone likes more beautiful. <br><br>  In principle, it can be said that at this stage the development of microservice is complete, since the code is written, the documentation is written and you tested it (honestly).  But actually not.  Since the most important, in my humble opinion, the issue of delivery of the service to production is not resolved.  And now we have come to the last stage - delivery. <br><br><h2>  5. Shipping </h2><br>  For these purposes, we will use the <a href="https://docs.docker.com/engine/swarm/">Docker Swarm</a> CI manager and technology. <br>  I will talk about the assembly in terms of <a href="https://www.atlassian.com/software/bamboo">Bamboo</a> (since we use it at home). <br><br>  The build cycle involves 2 related build plans.  The first is to compile a binary file from the microservice source code that is pulled from the repository source code.  Compilation takes place in a special Docker container with the version we need.  At the output of the first plan, we will have an artifact with a ready-to-run binary.  Immediately after the successful completion of the first plan, the dependent (second) plan starts.  In the second plan, a docker image is being prepared with the service itself, its configs and deployment parameters from another repository. <br><br>  For convenience, we configure the first build plan so that when changes occur in the master branch, the build starts automatically. <br><br>  Next you need to create and configure the Deployment Project for the deployment of microservice.  In this project we describe two environments - Test and Production. <blockquote>  Depla is performed through your crutch python deploator </blockquote>  In the deployment parameters, depending on the environment, it is indicated in which cluster to deploy (we currently have 4), the number of replicas, processor, memory limits, etc. <br><br>  Immediately after the successful deployment of each replica, an attempt will be made to launch it and, in case of failure, the deployment will stop so as not to put the remaining running replicas. <br><br>  We configure the trigger on the Test environment, so that if the master branch is successfully assembled, the warmth to the test is performed automatically. <br><br>  That's all, now, when the master branch changes, the binary build will start, then the image will be assembled, after which an automatic deployment will take place in the Test environment, and a special <a href="">Deploy button</a> will be active for the Production environment. <br><br>  From personal experience I will say that the main problem and complexity of microservices is their delivery to the production server, but if you have people who are friends with the docker, then the problems become several times smaller.  Previously, for deployment, we used deb packages, which forced us to do ‚Äúmanual work‚Äù with each update of the service and, moreover, degradation of the service was imposed due to the fact that it had to be restarted after installing the new package. <br><br>  I managed to identify 5 main stages for the development of microservice, I hope this will benefit you and bring into your life a new piece of creativity that we are developing. </div><p>Source: <a href="https://habr.com/ru/post/331674/">https://habr.com/ru/post/331674/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331664/index.html">Autoencoders in Keras, Part 4: Conditional VAE</a></li>
<li><a href="../331666/index.html">When will they send me an offer? Tips for applicants from HR-manager</a></li>
<li><a href="../331668/index.html">How to efficiently read data from the disk (provided that you have .Net)</a></li>
<li><a href="../331670/index.html">Dlang Tour translated into Russian</a></li>
<li><a href="../331672/index.html">"Confrontation": how information security specialists try to trick each other</a></li>
<li><a href="../331676/index.html">SecureLogin - forget about passwords</a></li>
<li><a href="../331678/index.html">How HumanOps Principles Apply in Server Density</a></li>
<li><a href="../331680/index.html">Team development of a system based on MS Dynamics CRM</a></li>
<li><a href="../331682/index.html">Pure Storage: Hour // m has arrived</a></li>
<li><a href="../331684/index.html">Multicore DSP TMS320C6678. Processor architecture overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>