<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Incident Report: GoldenEye / Petya</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On June 27, 2017, a massive attack began using a family option. 
 cryptographers, known as GoldenEye, from which many countries of the world have suff...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Incident Report: GoldenEye / Petya</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/a5a/eed/b2b/a5aeedb2b38848e2befc89b7b7afdb79.jpg"><br><br>  On June 27, 2017, a massive attack began using a family option. <br>  cryptographers, known as GoldenEye, from which many countries of the world have suffered. <br>  In addition to encrypting files, this family of encryptors is characterized by encrypting the MBR (Windows Master Boot Record) with rights, blocking full access to the computer. <a name="habracut"></a><br><br>  <b>general information</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This version of the malware is distributed as a DLL, which has a parameter that changes with each sample to start the encryption process on the computer.  On startup, it encrypts certain files on the disks of the infected system.  With administrator rights, it also encrypts the boot sector of the system, preventing access to the PC until a special access code is entered that will decrypt the system. <br><br>  Such an access key is provided after the victim pays the required ransom.  Also, this cryptographer creates a scheduled task to shut down the computer.  After restarting the PC, GoldenEye displays a false window with information indicating that there are disk issues that will be fixed soon. <br><br><img src="https://habrastorage.org/web/64e/83d/4cf/64e83d4cf3ce466ab4a1baa8a416bb6c.png"><br><br>  After that, a redemption window is displayed on the screen. <br><br><img src="https://habrastorage.org/web/d3b/610/0e7/d3b6100e777644ad8eb5d33832c4977c.png"><br><br>  <b>Spread</b> <br><br>  This time we saw various methods of penetrating and spreading the threat in networks: <br><br>  ‚Ä¢ Attack against update system in MeDoc, a popular electronic service <br>  document circulation in Ukraine (this country was hit hard by the attack) <br><br>  ‚Ä¢ ETERNALBLUE: This threat variant uses code that exploits a vulnerability, <br>  published by Microsoft on March 14, 2017 and described in MS17-010. <br><br>  ‚Ä¢ PSEXEC: Includes remote execution on the system using the PSEXEC command. <br><br>  ‚Ä¢ WMI: Contains remote execution on the system using the WMI command <br><br>  <b>General analysis of samples</b> <br><br>  <b>Sample 1:</b> 7e37ab34ecdcc3e77e24522ddfd4852d <br><br>  We did not see the direction of entry.  But we saw three different techniques for distribution on the internal network: <br><br>  <b>‚Ä¢ EternalBlue</b> <br><br><img src="https://habrastorage.org/web/fe8/632/359/fe8632359e1542ab8b57bf9d8dcc91a5.png"><br><br>  <b>‚Ä¢ PSEXEC</b> <br><br>  v8 = wsprintfW (a2, L ‚Äù% s \\\\% s -accepteula -s‚Äú, v3, a3); <br>  v9 = wsprintfW (&amp; a2 [v8], L ‚Äù-d C: \\ Windows \\ System32 \\ rundll32.exe \‚Äù C: \\ Windows \\% s \ ‚Äù, # 1‚Äú, &amp; v14) <br>  + v8; <br><br>  <b>‚Ä¢ WMI</b> <br><br>  wbem \ wmic.exe% s / node: "% ws" / user: "% ws" / password: "% ws" process call create ‚ÄúC: \ Windows <br>  \ System32 \ rundll32.exe \ ‚ÄùC: \ Windows \% s \‚Äù # 1 <br><br><img src="https://habrastorage.org/web/368/055/e49/368055e4925e4e9bb34f5cd3d4c6bd63.png"><br><br>  <b>Sample 2:</b> 71b6a493388e7d0b40c83ce903bc6b04 <br><br>  We have seen that the direction of entry is EZVIT, part of the MeDoc product, a popular system. <br>  electronic document management in Ukraine.  This is confirmed by the execution of GoldenEye through this program: <br><br><img src="https://habrastorage.org/web/fc3/c66/0b6/fc3c660b692c45e59689a880e0ba22e5.png"><br><br>  We will continue to analyze patterns associated with this cyber attack, and will provide new information as it arrives. <br><br>  <b>Tips and tricks</b> <br><br>  ‚Ä¢ Be careful of documents attached to unknown emails. <br>  senders.  Analyze all incoming and outgoing emails to detect threats, and <br>  filter executables to prevent them from reaching the end user. <br><br>  ‚Ä¢ Update your operating systems, software and firmware on all devices. <br><br>  ‚Ä¢ This time we discovered the use of ETERNALBLUE, and therefore we recommend that you download and install the following patch on all computers in your network: <br>  <a href="https://technet.microsoft.com/en-us/library/security/ms17-010.aspx">technet.microsoft.com/en-us/library/security/ms17-010.aspx</a> <br><br>  ‚Ä¢ Trust only next-generation endpoint security solutions, such as <a href="https://habrahabr.ru/company/panda/blog/328682/">Adaptive Defense and Adaptive Defense 360</a> . <br><br>  ‚Ä¢ If you are already a client of Adaptive Defense, and in the case of large-scale attacks, set the mode of operation in the Adaptive Defense solution to Lock: run only those processes that Panda Security has classified as reliable. <br><br>  ‚Ä¢ Periodically make backup copies and check that they work correctly and do not <br>  connected to the network. </div><p>Source: <a href="https://habr.com/ru/post/331886/">https://habr.com/ru/post/331886/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331874/index.html">How to create a successful loyalty program: approaches, technology and statistics</a></li>
<li><a href="../331878/index.html">AGAIN UPDATED: Technical details of the new global attack Trojan.Encoder.12544 (in various sources - Petya, etc.)</a></li>
<li><a href="../331880/index.html">[Peter] Meeting JUG.ru with the parallel programming legend Maurice Herlihy - Transactional Memory and Beyond</a></li>
<li><a href="../331882/index.html">How to confuse the analyst. Part one</a></li>
<li><a href="../331884/index.html">What should be the perfect report configurator</a></li>
<li><a href="../331888/index.html">Smart Lock on Android Things and Raspberry Pi3</a></li>
<li><a href="../331890/index.html">Digest of IT events for July</a></li>
<li><a href="../331892/index.html">PSEFABRIC - a new approach to network management and automation</a></li>
<li><a href="../331894/index.html">How does a store in a mall recognize you via Wi-Fi (more precisely, by MAC address) - based on regular hotspots</a></li>
<li><a href="../331896/index.html">"Saved": What is the result of excessive IT cuts in the store?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>