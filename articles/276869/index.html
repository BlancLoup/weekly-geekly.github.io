<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>And again about storing files, and how to quickly find the right one.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Premise 
 What is most necessary at a critical moment, for example, when are you going to go to the gym, and you are being asked the Word version of t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>And again about storing files, and how to quickly find the right one.</h1><div class="post__text post__text-html js-mediator-article"><h4>  Premise </h4><br>  What is most necessary at a critical moment, for example, when are you going to go to the gym, and you are being asked the Word version of the contract file for the 2012 project with Vasya Pupkin?  That's right - this is the very Word file. <br><br>  We have grown - well, not We specifically, but a company in the head office where I work: personal assistant to the Chief, IT manager, system administrator (just not playing the accordion), then you have a law firm, a couple of restaurants, and company, and rail freight. <br><br>  Accordingly, problems began with the exchange of files between the head office and subsidiary companies, and in order to save time for my beloved (he is too lazy to drive progress), I decided to implement a general workflow, and not just a workflow, but what would be great! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After searching and reading the articles ‚Äú <a href="https://habrahabr.ru/post/160237/">Large file storage for a small such company</a> ‚Äù and ‚Äú <a href="https://habrahabr.ru/post/148670/">Ideal document storage</a> ‚Äù, I realized that there is no simple solution ... <br><a name="habracut"></a><br><h4>  TK </h4><br>  But I would like something: <br><br><ul><li>  Cheap - Crisis, however!  (not yet come, but the brutal grin was already visible) </li><li>  Universal </li><li>  And if necessary, then fasten something else quickly and ... </li><li>  Convenient </li><li>  And not just the web interface </li><li>  And quick search </li></ul><br>  In general, if I voiced all my Wishlist, I would have suffocated ... I won‚Äôt be cunning, I had a document flow at the Head Office, but it cost a lot of money and only one requirement - Convenience, but as a template for the main idea I have was before my eyes. <br><br>  Overall, the SharePoint 2013 Foundation chose the platform: <br><br><ul><li>  Cheap - only need a SQL license, the product itself is free </li><li>  Universally - it is clear that the portal solution will not only close the need for file sharing, but also make it possible to realize virtually any task of distributed office collaboration, and, if necessary, there is room to grow. </li></ul><br>  But the rest of the Wishlist I was going to close: <br><br><ul><li>  Convenience - so that you can always determine from which source and which version of the file I have open.  And to quickly explain to the team of accountants how to use it.  (Yes, yes, we are still fighting (there should have been a smiley)) </li><li>  Integration with the office - so that the user does the minimum number of actions for saving, opening, searching for a file </li><li>  Quick search </li><li>  Remote connection, and the ability to work from home. </li></ul><br>  It was also necessary to close the disadvantages of the SharePoint platform: <br><br><ul><li>  The inability to store a file with the same name (the file is simply overwritten as a version) </li><li>  It is practically impossible to work with the file if additional fields are added to the Docs Library. </li><li>  Work speed </li></ul><br>  And the general issues of workflow: each department has its own tasks, files and types of documents, sometimes you need to get into the documents of the neighboring department and quickly find the right one. <br><br><h4>  Decision </h4><br>  <i>‚ÄúIf Nikanor Ivanovich‚Äôs lips and Ivan Kuzmich‚Äôs nose should be attached ...‚Äù</i> <i><br></i>  <i>* - From the play ‚ÄúThe Marriage‚Äù by N. V. Gogol (1809-1852), the words of the bride Agafi Tikhonovna</i> <br><br>  In general, understanding the whole kitchen of our collaboration, I did not have to describe the business processes of the organization, and I set to work. <br><br>  The problem of storing SharePoint files - to solve an automatically created folder hierarchy based on fixed lists, which immediately added attributes to the document for further search - and at that moment almost a miracle happened.  It turned out that for all departments, branches, subsidiaries, there is a three-level file storage structure, if we present the work of the department as work on projects. <br><br>  It turns out this catalog structure: <br><br><ul><li>  Project </li><li>  Subproject (refers, filtered by Project) </li><li>  Document Type </li></ul><br>  On SharePoint, it looked like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/24a/053/a46/24a053a4621d80cfe719294ae4420595.png" alt="image"><br><br>  Moreover, each project / subproject / document type received its own code, each company developed its own coding system, and the same code system was transferred to 1C - which, in general, simplified the implementation of the reporting system in the future.  Solve speed problems by caching directories, lists of documents, settings. <br><br><h4>  Implementation </h4><br>  First of all, I made the document explorer for SharePoint, with the main layout of the interface elements as in Outlook, the left part is navigation, a list with files and a file description. <br><br>  <i>Navigation</i> <br><br>  ‚ÄúLast edited documents‚Äù - displays the last 30 documents in the last 30 days. <br>  Templates - filters documents by Template type, for example, organization forms, letter or report templates. <br>  I also had to implement the ability to view the Library as in the explorer (especially the gifted could not understand how to use filters to search for documents). <br><br>  <i>Additions</i> <br><br>  Document number - Library ID file. <br>  All other fields are lookup to directories. <br>  The short name of the Library - each Library is indicated by a short code, which is then used in the file name. <br>  Versioning - I didn‚Äôt like what SharePoint does every time when saving a version of a document, I redid the algorithm for saving a document, where versioning became manageable, i.e.  A document version is created with the ability to comment when it‚Äôs needed, or when the document comes from an external source. <br><br>  <i>Main interface</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d66/4b7/c6f/d664b7c6f3dd79b8e1bf83ddadf49efb.png" alt="image"><br><br>  <i>Search</i> <br><br>  The search is implemented on CAML queries, and allows you to search multiple fields at once, the last five queries are saved.  Application filters were also made. <br><br>  <i>Search card and result</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a7/ad1/bc1/4a7ad1bc156ff4f8da9495a436388ec7.png" alt="image"><br><br>  <i>Saving the document</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/584/2b7/a8b/5842b7a8b59ecb0cbc66f0c71335085e.png" alt="image"><br><br>  To save the document to the system, now you need to give a name to the document and fill in three fields.  You can also give a description of the document and restrict access to it.  For convenience, the import of a document or folder is provided. <br><br>  And all this is integrated with Microsoft Office 2010/2013/2016.  Now, when working with a document, the name contains: the short name of the Library, the document number and version.  This integration allows you to work with documents, without leaving the usual interface. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/193/18c/176/19318c176aaaeb6a1ae03ff388ea2438.png" alt="image"><br><br><h4>  Cookies </h4><br>  In general, what we got delicious: <br><br><ul><li>  Cheap - even cheaper than planned, because  the solution turned out to be very flexible and fast.  The speed of work allowed connecting some remote offices to our central portal, which allowed us to save on a couple of Window / SQL licenses.  And where it was necessary, deployed its internal portal. </li><li>  Versatility - shut down the needs of shared file storage for all departments and subsidiaries. </li><li>  And if necessary, then fasten something else quickly and ... - someone added fields to the projects / subprojects list - got a CRM solution of the department, someone added additional (optional) fields to the Library of documents to track the execution of contracts and etc. </li><li>  Convenience - the user does not need to think about where to save the file, the main thing is to give a meaningful name of the document.  And centralized naming / filling in the reference books of projects / subprojects minimizes employee errors, such as incorrect file placement, folder creation, etc. </li><li>  And not only the web interface - the size of the distribution kit is about two megabytes.  Users who are actively working from home simply install it on their home computer, the same goes for mobile users.  To connect to the system, you only need to know the URL of the working portal, all other settings will be loaded.  Through the SSL protocol, the SharePoint web interface and the program work, so there are no problems with a remote connection yet. </li><li>  Quick search - additional attributes of the document allow you to search for documents quickly, with high efficiency of output.  SharePoint full-text search closes all other requests. </li></ul><br><h4>  An example is how the work of the financial department and HR has changed. </h4><br>  We created one Document Library for the financial and HR department, and remotely connected all accountants from subsidiaries.  Restricted access to certain folders. <br><br>  Now, when the HR department saves the document relating to the employee‚Äôs personal file, he fills in (for example): <br><br><ul><li>  File name: Agreement with employee Ivanov - 2016 </li></ul><br>  Selects from lists: <br><br><ul><li>  Project - Company Employees 1 </li><li>  SubProject - Name of Employee </li><li>  Document type - Contract </li></ul><br>  Or the time sheet: <br><br><ul><li>  File Name: Time Sheet - January 2016 </li></ul><br>  Selects from lists: <br><br><ul><li>  Project - Restaurants </li><li>  SubProject - Restaurant Name </li><li>  Document Type - Time Sheet </li></ul><br>  A restaurant accountant keeps a record of daily earnings: <br><br><ul><li>  File Name: cache report 05012016 </li></ul><br>  Selects from lists: <br><br><ul><li>  Project - Restaurants </li><li>  SubProject - Restaurant Name </li><li>  Document Type - Cache Report </li></ul><br>  And most importantly, everyone chose his own style of work: someone works directly with the Library of Documents, someone saves files locally on the computer, and at the end of the day imports it into the workflow.  The chief accountant set up an automatic summary of changes in specific folders. <br><br>  And now - everyone is happy, documents are stored centrally, transparent to all who have access, when changing document templates or reports, they need to be changed in one place, and reports are generated if necessary. <br>  Also, the program was evaluated by the Legal Department - the main document generator. <br><br><h4>  Conclusion </h4><br>  In general, I hope the idea is clear, I described the basic principle of its work.  The program has become popular at the testing stage.  Many colleagues and friends gladly implemented it at their place, of course, with varying degrees of project success.  But I prefer to think that this depends on the initial degree of staff motivation. <br><br>  Everything went under the motto: ‚ÄúAgrkh‚Äù - let's finally put things in order with the files, and I'll go to the gym. <br><br>  I give the program for free, you can download it at: <br><br>  <a href="http://www.it-bi.com/">Download</a> <br>  <a href="https://sway.com/lP33hzhy9lq0BlLi">Presentation</a> <br><br>  At the moment, taking into account all the wishes and acquired experience, we started the development of the second extended version, from those who implemented it, I am waiting for feedback and suggestions. </div><p>Source: <a href="https://habr.com/ru/post/276869/">https://habr.com/ru/post/276869/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276857/index.html">Using FPGA and DSL to speed up HFT trading</a></li>
<li><a href="../276859/index.html">Foster Day at the Foreign Ministry</a></li>
<li><a href="../276863/index.html">ARP: Cisco equipment features and interesting cases. Part 1</a></li>
<li><a href="../276865/index.html">Bind additional one-time passwords to the Windows logon window</a></li>
<li><a href="../276867/index.html">Study of virtual hosting tariffs</a></li>
<li><a href="../276871/index.html">Tuples in programming languages. Part 1</a></li>
<li><a href="../276873/index.html">43 useful project management services. No epithets</a></li>
<li><a href="../276877/index.html">PCs, laptops and everything.</a></li>
<li><a href="../276879/index.html">Wifi-radio with a warm lamp display. Part 1. Display</a></li>
<li><a href="../276881/index.html">Meet Jack and Jill on x86</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>