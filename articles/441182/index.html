<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine-synaesthetic approach to detecting network DDoS attacks. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello again. Today we continue to share material dedicated to the launch of the course ‚ÄúNetwork Engineer‚Äù , which starts in early March. We see that m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine-synaesthetic approach to detecting network DDoS attacks. Part 2</h1><div class="post__text post__text-html js-mediator-article">  Hello again.  Today we continue to share material dedicated to the launch of the course <a href="https://otus.pw/2EVT/">‚ÄúNetwork Engineer‚Äù</a> , which starts in early March.  We see that many were interested in the <a href="https://habr.com/ru/company/otus/blog/440210/">first part of the article</a> ‚ÄúMachine-synaesthetic approach to detecting network DDoS attacks‚Äù and today we want to share the second part with you - the final part. <br><br>  <b>3.2 Classification of images in the problem of detection of anomalies</b> <br><br>  The next step is to solve the problem of classifying the resulting image.  In general, the solution to the problem of detecting classes (objects) in an image is to use machine learning algorithms to build class models, and then algorithms to search for classes (objects) in an image. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/ea/g4/-_/eag4-_wggpukoheykyxcxiq3gei.png"><br><a name="habracut"></a><br>  Building a model consists of two stages: <br><br>  a) Extraction of characteristic features for a class: construction of vectors of characteristic features for class elements. <br><br><img src="https://habrastorage.org/webt/pb/fr/fl/pbfrflyftfhl3vk-w6cneqgreyg.png"><br>  Fig.  one <br><br>  b) Learning the features of the model for subsequent recognition tasks. <br><br>  The description of the class object is performed using feature vectors.  Vectors are formed from: <br><br>  a) color information (oriented gradient histogram); <br>  b) contextual information; <br>  c) data on the geometrical arrangement of the parts of the object. <br><br>  The classification (forecasting) algorithm can be divided into two stages: <br><br>  a) Extracting features from an image.  At this stage, two tasks are performed: <br><br><ul><li>  Since the image may contain objects of many classes, we need to find all the representatives.  To do this, you can use a sliding window that passes through the image from the upper left to the lower right corner. </li><li>  The image is scaled as the scale of the objects in the image may change. </li></ul><br>  b) associating an image with a specific class.  A formal class description, that is, a set of features that are highlighted by their test images, is used as input.  Based on this information, the classifier decides whether the image belongs to the class, and evaluates the confidence level for the conclusion. <br><br>  <i><b>Classification methods.</b></i>  Classification methods range from predominantly heuristic approaches to formal procedures based on the methods of mathematical statistics.  There is no generally accepted classification, but several approaches to the classification of images can be distinguished: <br><br><ul><li>  object modeling methods based on details; </li><li>  word bag methods; </li><li>  spatial pyramid matching methods. </li></ul><br>  For the implementation presented in this article, the authors chose the "bag of words" algorithm, given the following reasons: <br><br><ul><li>  Algorithms for modeling on the basis of details and comparison of spatial pyramids are sensitive to the position of the descriptors in space and their relative position.  These classes of methods are effective in detecting objects in an image;  However, due to the characteristic features of the input data, they are poorly applicable to the problem of image classification. </li><li>  The ‚Äúbag of words‚Äù algorithm is widely tested in other fields of knowledge, it shows good results and is quite simple to implement. </li></ul><br>  To analyze the video stream projected from the traffic, we used a naive Bayes classifier [25].  It is often used to classify texts with the word bag model.  In this case, the approach is similar to text analysis, instead of words only descriptors are used.  The work of this classifier can be divided into two parts: the learning phase and the forecasting phase. <br><br>  <i><b>The learning phase</b></i> .  Each frame (image) is fed to the input of the descriptor search algorithm, in this case scale-invariant feature transform (SIFT - scale-invariant feature transform) [26].  After this, the task of correlating the singular points between frames is performed.  The singular point on the image of the object is the point that is most likely to appear on other images of this object. <br><br>  To solve the problem of comparing the singular points of an object in different images, a descriptor is used.  A descriptor is a data structure, an identifier of a singular point that distinguishes it from the others.  It may or may not be invariant with respect to object image transformations.  In our case, the descriptor is invariant with respect to promising transformations, that is, scaling.  The descriptor allows you to compare a particular point of an object in one image with the same special point on another image of this object. <br><br>  Then, the set of descriptors obtained from all images is sorted by groups by similarity using the k-means clustering method [26, 27].  This is done in order to train the classifier, which will give an opinion on whether the image represents abnormal behavior. <br><br>  Below is a step-by-step algorithm for learning the image descriptor classifier: <br><br>  <b>Step 1</b> .  Extract all descriptors from sets with and without attack. <br>  <b>Step 2</b> .  Clustering all descriptors using the k-means method in n clusters. <br>  <b>Step 3</b> .  Calculation of the matrix A (m, k), where m is the number of images, and k is the number of clusters.  The element (i; j) will store the value of how often descriptors from the j-th cluster appear on the i-th image.  Such a matrix will be called the appearance frequency matrix. <br>  <b>Step 4</b> .  Calculation of descriptor weights using the formula tf idf [28]: <br><br><img src="https://habrastorage.org/webt/tc/dl/n6/tcdln6bdffwsibefbvmadl2yv84.png"><br><br>  Here tf (‚Äúterm frequency‚Äù) is the frequency of the descriptor appearing in this image and is defined as <br><br><img src="https://habrastorage.org/webt/_f/yn/6w/_fyn6wlser_byf9cuolmpz5ygkm.png"><br><br>  where t is the descriptor, k is the number of descriptors in the image, nt is the number of descriptors t in the image.  In addition, idf (‚Äúreverse document frequency‚Äù) is the inverse of the image frequency with the specified descriptor in the sample and is defined as <br><br><img src="https://habrastorage.org/webt/o3/ue/ez/o3ueezxet1juctehastf-shbuyg.png"><br><br>  where D is the number of images with a given descriptor in the sample, {di ‚àà D, t ‚àà di} is the number of images in D, where t is under the conditions nt!  = 0 <br>  <b>Step 5</b> .  Substituting the corresponding weights instead of descriptors into the matrix A. <br>  <b>Step 6</b> .  Classification.  We use the gain of naive Bayes classifiers (adaboost). <br>  <b>Step 7</b> .  Save the trained model to a file. <br>  <b>Step 8</b> .  This completes the training phase. <br><br>  <i><b>Phase prediction</b></i> .  The differences between the learning phase and the prediction phase are small: descriptors are extracted from the image and correlated with existing groups.  Based on this relationship, a vector is constructed.  Each element of this vector is the frequency of the appearance of descriptors from this group on the image.  By analyzing this vector, the classifier can make a prediction of an attack with a certain probability. <br><br>  The general prediction algorithm based on a pair of classifiers is presented below. <br><br>  <b>Step 1</b> .  Extract all descriptors from the image; <br>  <b>Step 2</b> .  Clustering the resulting set of descriptors; <br>  <b>Step 3</b> .  Calculation of the vector [1, k]; <br>  <b>Step 4</b> .  Calculate the weight for each descriptor using the tf idf formula presented above; <br>  <b>Step 5</b> .  Replacing the frequency of occurrence in vectors by their weight; <br>  <b>Step 6</b> .  Classification of the resultant vector by the previously trained classifier; <br>  <b>Step 7</b> .  The conclusion about the presence of anomalies in the observed network based on the forecast classifier. <br><br>  <b>4. Evaluation of detection efficiency</b> <br><br>  The task of evaluating the effectiveness of the proposed method was solved experimentally.  The experiment used a number of parameters established empirically.  1000 clusters were used for clustering.  The generated images had 1000 per 1000 pixels. <br><br>  <b>4.1 Experimental data set</b> <br><br>  For experiments was assembled installation.  It consists of three devices connected by a communication channel.  The block diagram of the installation is shown in Figure 2. <br><br><img src="https://habrastorage.org/webt/hp/el/it/hpelitoq61g5u_sjddoys-_fi4a.png"><br>  Pic1 <br><br>  The SRV device plays the role of an attacking server (hereinafter referred to as the target server).  As the target server, the devices listed in Table 1 with the SRV code were used sequentially.  The second is a network device designed to transmit network packets.  Characteristics of the device are shown in Table 1 under the code ND-1. <br><br>  Table 1. Network device specifications <br><br><img src="https://habrastorage.org/webt/ly/0g/2m/ly0g2mdjsp8jlfhwtiyoks93xye.png"><br><br>  On the target servers, the network packets were written to a PCAP file for later use in detection algorithms.  For this task, the tcpdump utility was used.  The data sets are described in table 2. <br><br>  Table 2. Intercepted Network Packets <br><br><img src="https://habrastorage.org/webt/zs/gl/md/zsglmd6kc1rstv9n_ygjdlxio2k.png"><br><br>  The following software was used on the target servers: Linux distribution, nginx 1.10.3 web server, postgresql 9.6 DBMS.  A special web application was written to emulate the system boot.  The application requests a database with a large amount of data.  The query is designed to minimize the use of various caching.  During the experiments, requests were made to this web application. <br>  The attack was carried out from the third client device (Table 1) using the Apache Benchmark utility.  The structure of the background traffic during the attack and the rest of the time is presented in Table 3. <br><br>  Table 3. Background traffic features <br><br><img src="https://habrastorage.org/webt/n4/69/zd/n469zd5mfy7kxdk7rplpnv0pb3w.png"><br><br>  As an attack, we are implementing the version of the distributed DoS HTTP GET flood.  Such an attack, in essence, is the generation of a constant stream of GET requests, in this case from a CD-1 device.  To generate it, we used the ab utility from the apache-utils package.  As a result, files containing network status information were obtained.  The main characteristics of these files are presented in Table 2. The main parameters of the attack scenario are shown in Table 4. <br>  From the resulting network traffic dump, the sets of generated images TD # 1 and TD # 2, which were used during the training phase, were obtained.  Sample TD # 3 was used for the prediction phase.  A summary of the test datasets is presented in table 5. <br><br>  <b>4.2 Performance Criteria</b> <br><br>  The main parameters evaluated during this study were: <br><br>  Table 4. Features of DDoS attacks <br><br><img src="https://habrastorage.org/webt/aj/x3/x6/ajx3x6-chazufxjmg1jjj7lbg9k.png"><br><br>  Table 5. Test Image Sets <br><br><img src="https://habrastorage.org/webt/f-/td/ji/f-tdjinn7-twrmownaxs78luax0.png"><br><br>  a) DR (Detection Rate) - the number of detected attacks in relation to the total number of attacks.  The higher this parameter, the higher the efficiency and quality of ADS. <br><br>  b) FPR (False Positive Rate) - the number of ‚Äúnormal‚Äù objects mistakenly classified as an attack, in relation to the total number of ‚Äúnormal‚Äù objects.  The lower this parameter, the higher the efficiency and quality of the anomaly detection system. <br><br>  c) CR (Complex rate) is a complex indicator that takes into account the combination of the DR and FPR parameters.  Since the DR and FPR parameters were taken to be of equal importance in the study, the complex indicator was calculated as follows: CR = (DR + FPR) / 2. <br>  1000 images were submitted to the classifier, marked as ‚Äúabnormal‚Äù.  Based on the recognition results, DR was calculated depending on the size of the training sample.  The following values ‚Äã‚Äãwere obtained: for TD # 1 DR = 9.5% and for TD # 2 DR = 98.4%.  Further, the second half of the images (‚Äúnormal‚Äù) were classified.  Based on the result, FPR was calculated (for TD # 1 FPR = 3.2% and for TD # 2 FPR = 4.3%).  Thus, the following comprehensive performance indicators were obtained: for TD # 1 CR = 53.15% and for TD # 2 CR = 97.05%. <br><br>  <b>5. Conclusions and future research</b> <br><br>  From the results of the experiments it is clear that the proposed method for detecting anomalies shows high results in detecting attacks.  For example, on a large sample, the value of the integrated efficiency indicator reaches 97%.  However, this method has some limitations in its application: <br><br>  1. The DR and FPR values ‚Äã‚Äãshow the sensitivity of the algorithm to the size of the training set, which is a conceptual problem for machine learning algorithms.  Increasing the sample results in improved detection rates.  However, it is not always possible to implement a large enough training sample for a particular network. <br><br>  2. The developed algorithm is deterministic, the same image is classified each time with the same result. <br><br>  3. The effectiveness of the approach is good enough to confirm the concept, but the number of false positives is also large, which can lead to difficulties in practical implementation. <br><br>  To overcome the limitation described above (point 3), it is supposed to change the naive Bayesian classifier to a convolutional neural network, which, in the authors' opinion, should lead to an increase in the accuracy of the anomaly detection algorithm. <br><br><div class="spoiler">  <b class="spoiler_title">Links</b> <div class="spoiler_text">  1. Mohiuddin A., Abdun NM, Jiankun H .: A survey of network anomaly detection techniques.  In: Journal of Network and Computer Applications.  Vol.  60, p.  21 (2016) <br>  2. Afontsev E.: Network anomalies, 2006 <a href="https://nag.ru/articles/reviews/15588/">nag.ru/articles/reviews/15588</a> setevyie-anomalii.html <br>  3. Berestov AA: On the Internet.  In: XV All-Russian Scientific Conference on the Higher School System ‚Äù, pp.  180‚Äì276 (2008) <br>  4. Galtsev AV: for the Candidate Degree of Technical Sciences.  Samara (2013) <br>  5. Kornienko AA, Slyusarenko IM: Intrusion Detection Systems, 2008 <a href="http://citforum.ru/security/">; citforum.ru/security</a> internet / ids overview / <br>  6. Kussul N., Sokolov A.: Adaptive anomaly detection using variable ordering.  Part 2: Methods of detecting anomalies and the results of experiments.  In: Informatics and Control Problems.  Issue 4, pp.  83 √ó 88 (2003) <br>  7. Mirkes EM: Neurocomputer: draft standard.  Science, Novosibirsk, pp.  150-176 (1999) <br>  8. Tsvirko DA Prediction of a network attack route using production model methods, 2012 <a href="http://academy.kaspersky.ru/downloads/academycup">academy.kaspersky.com/downloads/academycup</a> participants / cvirko d.  ppt <br>  9. Somayaji A.: Automated response using system-call delays.  In: USENIX Security Symposium 2000, pp.  185-197, 2000 <br>  10. Ilgun K .: USTAT: A Real-time Intrusion Detection System for UNIX.  In: IEEE, University of California (1992) <br>  11. Eskin E., Lee W., and Stolfo SJ: Modeling system calls for intrusion detection with dynamic window sizes.  In: DARPA Information Survivability Conference and Exposition (DISCEX II), June 2001 <br>  12. Ye N., Xu M., and Emran SM: Probabilistic networks with undirected links for anomaly detection.  In: 2000 IEEE Workshop on Information Assurance and Security, West Point, NY (2000) <br>  13. Michael CC and Ghosh A.: Two state-based approaches to program-based anomaly detection.  In: ACM Transactions on Information and System Security.  No.  5 (2), 2002 <br>  14. Garvey TD, Lunt TF: Model-based Intrusion Detection.  In: 14th Nation computer security conference, Baltimore, MD (1991) <br>  15. Theus M. and Schonlau M .: Intrusion detection based on structural zeroes.  In: Statistical Computing and Graphics Newsletter.  No.  9 (1), pp.  12‚Äì17 (1998) <br>  16. Tan K .: The application of neural networks to computer security.  In: IEEE International Conference on Neural Networks.  Vol.  1, pp.  476 √ó 481, Perth, Australia (1995) <br>  17. Ilgun K., Kemmerer RA, Porras PA: State Transition Analysis: A Rule-Based Intrusion Detection System.  In: IEEE Trans.  Software Eng.  Vol.  21, no.  3, (1995) <br>  18. Eskin E.: Anomaly detection over noisy data using learned probability distributions.  In: 17th International Conf.  on Machine Learning, pp.  255? 262.  Morgan Kaufmann, San Francisco, CA (2000) <br>  19. Ghosh K., Schwartzbard A., and Schatz M.: Learning program behavior profiles for intrusion detection.  In: 1st USENIX Workshop on Intrusion Detection and Network Monitoring, pp.  51 √ó 62, Santa Clara, California (1999) <br>  20. Ye N .: A markov chain model for anomaly detection.  In: 2000 IEEE Systems, Man, and Cybernetics, Information Assurance and Security Workshop (2000) <br>  21. Axelsson S .: For the difficulty of intrusion detection.  In: ACM Conference on Computer and Communications Security, pp.  1‚Äì7 (1999) <br>  22. Chikalov I, Moshkov M, Zielosko B.: Optimization of dynamic programming.  In Vestnik of Lobachevsky State University of Nizhni Novgorod, no.  6, pp.  195-200 <br>  23. Chen CH: Handbook of pattern recognition and computer vision.  University of Massachusetts Dartmouth, USA (2015) <br>  24. Gantmacher FR: Theory of matrices, p.  227. Science, Moscow (1968) <br>  25. Murty MN, Devi VS: Pattern Recognition: An Algorithmic.  Pp.  93-94 (2011) <br></div></div><br>  Traditionally, we are waiting for your comments and invite everyone to <a href="https://otus.pw/pmQk/">the open day</a> , which will be held next Monday. </div><p>Source: <a href="https://habr.com/ru/post/441182/">https://habr.com/ru/post/441182/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../441170/index.html">The head of "Roskosmos" does not believe in Mask's ability to create a rocket engine, superior to Russian developments</a></li>
<li><a href="../441172/index.html">As the 3D printing market grew in 2018 and what does this mean for business</a></li>
<li><a href="../441174/index.html">PLO is dead, long live PLO</a></li>
<li><a href="../441176/index.html">Yandex.Music was automatically installed on Windows 10 and replaced the standard MP3 application.</a></li>
<li><a href="../441180/index.html">Cloudy, Likely non-switchable ads on the starry sky</a></li>
<li><a href="../441186/index.html">ASH Viewer: Reboot</a></li>
<li><a href="../441188/index.html">On Twitter, a protocol of administrative offense</a></li>
<li><a href="../441192/index.html">Using computational capabilities of R to test the equality hypothesis</a></li>
<li><a href="../441196/index.html">To whom and for what will messengers ‚Äúknock‚Äù</a></li>
<li><a href="../441198/index.html">Scrum and Graves' spiral dynamics: how not to fly on reefs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>