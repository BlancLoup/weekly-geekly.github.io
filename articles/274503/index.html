<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attackers have targeted the BlackEnergy Trojan at Ukrainian energy companies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yesterday, we presented information on cyber attacks on media companies in Ukraine and industrial facilities that used the BlackEnergy Trojan and a ne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attackers have targeted the BlackEnergy Trojan at Ukrainian energy companies</h1><div class="post__text post__text-html js-mediator-article">  Yesterday, we <a href="http://habrahabr.ru/company/eset/blog/274469/">presented</a> information on cyber attacks on media companies in Ukraine and industrial facilities that used the BlackEnergy Trojan and a new component called KillDisk.  KillDisk was used to destroy files on compromised computers and on disabling such systems.  In addition to reviewing the capabilities of these two malicious programs, we managed to get interesting information that links cyber attacks using BlackEnergy with recent media reports about successful hacking of energy systems in western Ukraine, which led to a massive power outage. <br><br><img src="https://habrastorage.org/files/59b/7ec/9ed/59b7ec9ed4e84999b46d336dfc341dc8.jpg"><br><br>  According <a href="http://ru.tsn.ua/ukrayina/iz-za-hakerskoy-ataki-obestochilo-polovinu-ivano-frankovskoy-oblasti-550406.html">to</a> media reports, on December 23, 2015, about half of the residents of Ivano-Frankivsk region (with a population of 1.4 million) in Ukraine were left without electricity for several hours.  The TSN news portal <a href="http://ru.tsn.ua/ukrayina/iz-za-hakerskoy-ataki-obestochilo-polovinu-ivano-frankovskoy-oblasti-550406.html">indicates</a> that the power outage was caused by a ‚Äúhacker attack‚Äù that used a ‚Äúvirus‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Using our telemetry system, we found that the incident mentioned in the media was not isolated and other energy companies of Ukraine at the same time underwent similar attacks.  We also discovered that for this cyber attack, the attackers used malware, a detailed analysis of which we have already produced.  This is a Trojan BlackEnergy and a new modification of its component KillDisk, mentioned in our previous study. <br><br>  BlackEnergy Trojan has been used by attackers to perform various tasks over the past few years.  At the well-known conference Virus Bulletin in 2014, we <a href="">presented</a> data on a series of cyber attacks against government and industrial facilities in Ukraine.  The attackers used several methods to spread this malware and infect users, including, 0day, an exploit for PowerPoint's CVE-2014-4114 vulnerability.  While the main targets of the attackers in 2014 were cyber espionage, a component capable of <a href="https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-281-01B">infecting</a> SCADA ICS was also discovered for BlackEnergy, which allows BlackEnergy to target more dramatic goals. <br><br>  In recent cyber attacks on the electric power companies of Ukraine, a Trojan with KillDisk functions destructive for the system was downloaded and executed on computers compromised by BlackEnergy.  The link between BlackEnergy and KillDisk was first <a href="http://cert.gov.ua/%3Fp%3D2370">established</a> by the CERT-UA organization in November.  According to these data, some Ukrainian news companies were attacked during the local elections in this country.  The report indicated that the result of a cyber attack was the destruction of a large number of video materials and other documents. <br><br>  We have information about several energy companies in Ukraine (except for the company ‚ÄúPrikarpattyaoblenergo‚Äù), which were the targets of cyber attacks using BlackEnergy.  We can confirm that this Trojan, along with the KillDisk component, was used to compromise the computers of these companies on the eve of the Catholic Christmas 2015. We also have information that BlackEnergy was used in cyber attacks on energy companies earlier in 2015, but In their case, we did not observe the use of a KillDisk component for data corruption by attackers.  It can be assumed that at that moment the attackers were in the preliminary stages of preparing more substantial operations. <br><br>  The Microsoft Office files containing malicious macros were used as a vector for infecting users in the cyber attacks mentioned above.  Such methods of infection were also used by other attackers, for example, the <a href="http://habrahabr.ru/company/eset/blog/271981/">Dridex</a> gang and other <a href="http://www.welivesecurity.com/2015/04/29/macro-malware-attacks-rise-says-microsoft/">attackers</a> in 2015. <br><br>  In this case, the attack scenario is quite simple, the alleged victim receives a phishing email, which contains a malicious document as an attachment.  Ukrainian security company CyS Centrum has <a href="https://cys-centrum.com/ru/news/uisgcon11_2015">published</a> two screenshots of such letters, which were used to deliver BlackEnergy droppers.  The attackers used special fake addresses as the sender's address, which were similar to the addresses of the Ukrainian parliament - Rada.  A phishing document sent by cybercriminals contains text that urges the user to launch a malicious macro embedded in it.  Such a case is an example of the delivery of malware to a victim using social engineering, instead of exploiting any vulnerabilities in the software.  After the macro is executed, the user is infected with a modification of <a href="http://habrahabr.ru/company/eset/blog/239001/">BlackEnergy Lite</a> . <br><br><img src="https://habrastorage.org/files/d16/62a/aa2/d1662aaa2eb84817afebe87393424221.png"><br>  Fig.  An example of a malicious document. <br><br>  As indicated in our <a href="">presentation of</a> VirusBulletin, BlackEnergy is a modular trojan and is used by attackers to deploy various downloadable components to perform the required tasks.  As we have already indicated, the Win32 / KillDisk component also loaded BlackEnergy and was found on computers it had compromised in the cyber attacks mentioned above. <br><br>  The KillDisk malware specializes in the destruction of files in the system, as well as the corruption of system files, which causes the OS to become inoperable.  Some of the KillDisk modifications that we found in energy companies contained in their structure additional capabilities for sabotaging industrial systems.  The first such possibility is the installation of a timeout or delay on the triggering of its main destructive mechanism.  The second possibility is the completion of two non-standard processes with the names of komut.exe and sec_service.exe.  The name of the second process may refer to software called ELTIMA Serial to Ethernet Connector or ASEM Ubiquity, the ICS industrial software platform.  In case of detection of the activity of processes in the system, the malware will terminate them, and also destroy their executable files on the disk. <br><br>  <b>Conclusion</b> <br><br>  Malware with destructive functions is not a new phenomenon.  Despite the fact that some of the early viruses contained such possibilities, they were used for entertainment purposes, unlike modern cybercriminals, who use them to achieve various kinds of goals, from sabotage and hacktivism to cyber espionage.  Another infamous example of such malware is Flamer (aka Flame or sKyWIper).  Another destructive malware called Destover was previously <a href="http://arstechnica.com/security/2014/12/inside-the-wiper-malware-that-brought-sony-pictures-to-its-knees/">used</a> in cyber attacks on Sony Pictures.  It should be mentioned once again that this kind of destructive malware is not unique and if we take into account the vague naming scheme of malware, we should not associate completely different incidents only by the names of their detections (for example, the name Wiper or its derivatives). <br><br>  In 2014, BlackEnergy used a more outdated modification of the destructive component called dstr, which we described in a previous post.  There are differences between KillDisk and dstr, which indicate that the latter was used as a tool for the complete destruction of data in the system. <br><br>  Our analysis of the KillDisk component, which was discovered on compromised computers of energy companies in Ukraine, indicates its theoretical focus on disabling critical industrial systems.  However, there is another explanation for this.  BlackEnergy itself, like the SSH backdoor, which was also used in these malicious campaigns and was described by us in a previous post, gives attackers remote access to the compromised system.  After successfully infecting the system, the attackers also, theoretically, can manually use the destructive component to damage the system.  In this case, KillDisk can be used by them as a component, with the help of which it is possible to make the recovery of a damaged system a very time-consuming process.  With a high degree of probability, we assume that it was the above set of malicious programs that was used to damage the energy infrastructure in the Ivano-Frankivsk region. <br><br>  Although in Ukraine Christmas is usually not celebrated on December 24 and 25, cybercriminals have chosen this particular time of year to turn off the light to several hundred thousand people.  Attackers are also lucky that this malware was not detected in the system in a timely manner. <br><br>  Other technical information about the incident can be <a href="https://ics.sans.org/blog/2016/01/01/potential-sample-of-malware-from-the-ukrainian-cyber-attack-uncovered">found</a> on the SANS Industrial Control Systems website.  Indicators of compromise (IoC) can be found in our previous <a href="http://habrahabr.ru/company/eset/blog/274469/">post</a> . </div><p>Source: <a href="https://habr.com/ru/post/274503/">https://habr.com/ru/post/274503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274493/index.html">One more analysis of bubble sort</a></li>
<li><a href="../274495/index.html">Flash Player (ActiveX) update for January 1, 2016</a></li>
<li><a href="../274497/index.html">Centrifugal compressor installations. Surge protection</a></li>
<li><a href="../274499/index.html">Definition of gender by name - when accuracy is really important</a></li>
<li><a href="../274501/index.html">IBM opens blockchain lab</a></li>
<li><a href="../274509/index.html">Create 2D portals using shaders</a></li>
<li><a href="../274511/index.html">Benchmark 32 and 64-bit versions of browsers: faster, stronger, higher?</a></li>
<li><a href="../274513/index.html">Meet-up "Productive work of the front-end developer in the conditions of legacy-code support": transition to Dart</a></li>
<li><a href="../274515/index.html">Meet-up ‚ÄúProductive work of a front-end developer under conditions of legacy-code support‚Äù: talking about useful tools</a></li>
<li><a href="../274519/index.html">Programming microcomputer LEGO NXT Mindstorms 2.0. Introduction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>