<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart home on .NET - release of ThinkingHome 3.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! Today, I finally can share with you the results of my work over the past two years! Last night I released a new version 3.0 of the ThinkingHome...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart home on .NET - release of ThinkingHome 3.0</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello!  Today, I finally can share with you the results of my work over the past two years!  Last night I released a new version 3.0 of the <a href="http://system.thinking-home.ru/">ThinkingHome</a> smart home control system. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8db/ad8/afd/8dbad8afdc464074a829533772250cf1.png"></div><br><p>  <a href="http://system.thinking-home.ru/">ThinkingHome</a> is a program (.NET Windows service), with the help of which you can organize on your computer a smart home control center.  This center, which is friendly with each other "glands" with different interfaces from different manufacturers, allows you to automate work with them (write scripts in JavaScript) and manage the entire economy through a web interface. </p><br><p>  Under the cat a more detailed description of the system, a list of changes in the new version and a small announcement for those who hate Windows :) </p><a name="habracut"></a><br><h3 id="platforma">  Platform </h3><br><p>  ThinkingHome is not just a program that controls devices!  This is a platform on the basis of which you can implement (as plug-ins) any functionality available for a computer, without worrying about solving basic tasks, such as logging or saving data between system launches. </p><br><h4 id="vam-dostupny">  Available to you: </h4><br><ul><li>  <a href="">Plug</a> -in <a href="">system</a> - is responsible for connecting plug-ins and their interaction (plug-ins can use the API and subscribe to each other's events).  This means that you can connect to yourself a plugin that another person wrote for themselves and this plugin will be compatible with your plugins.  Plugins are written in C #. </li><li>  <a href="">Logging API</a> - allows you to write information to the log and flexibly configure the storage of logs.  For example, you can store logs in text files for a month and, in addition, messages about critical errors can also be sent by mail.  Inside is used <a href="http://nlog-project.org/">NLog</a> . </li><li>  <a href="">The API for storing data in the database</a> - you just write classes in C # and save them in the database (used by <a href="http://nhibernate.info/">NHibernate</a> as ORM).  For the migration of the database structure - <a href="https://github.com/dima117/ecm7migrator">ecm7migrator</a> . </li><li>  <a href="">HTTP API infrastructure</a> - you can mark the method of your plugin with a special attribute and it will be available for a call via HTTP. </li><li>  <a href="">Web Interface Infrastructure</a> - your plugin can add its own widget types for the start screen or even new interface sections to the system. </li><li>  <a href="">Client-server message bus</a> - you can push messages from the server to the client or from the client - to all other clients.  For example, when receiving a new temperature value from the sensor, you can send it to all browsers (!), In which the system's web interface is open, so that they update the temperature graphs on the already open page.  <a href="https://www.asp.net/signalr">SignalR is</a> used inside the message <a href="https://www.asp.net/signalr">bus</a> . </li><li>  <a href="">Localization API</a> - allows you to display the interface in several languages ‚Äã‚Äãand customize it flexibly.  The system kernel and all base plugins support Russian and English. </li></ul><br><h4 id="v-komplekte-idut-gotovye-plaginy">  Included are ready-made plugins: </h4><br><p>  <a href="">The script plugin</a> adds <a href="">scripts</a> to the system ‚Äî small JavaScript programs that are written via the web interface.  With their help, you can implement any logic for the automatic control of home devices (plugins API is available for this in scripts).  For example, you can write a script that automatically turns off the warm floor and lights in the whole house, if no motion sensor worked for more than an hour during the day. </p><br><p>  The script editor looks like this: </p><br><p><img src="https://pp.vk.me/c622922/v622922336/31783/7jzi3PSyd1o.jpg" alt="ThinkingHome - Script Editor"></p><br><p>  <a href="">The MQTT plugin</a> is simple: you can receive data from other devices and send them commands using the MQTT protocol.  For example, this protocol supports the <a href="http://contactless.ru/wiren-board-5/">Wiren Board</a> controller. </p><br><p>  <a href="">The nooLite plugin</a> allows <a href="">you</a> to control electrical appliances using <a href="http://www.noo.com.by/sistema-noolite.html">the nooLite system</a> .  You can control the lighting, ventilation, floor heating and any other electrical appliances.  Even a teapot :) </p><br><p>  <em>The microclimate plug-in</em> collects and stores in the database information on temperature and humidity from <a href="http://www.noo.com.by/sensors.html">nooLite sensors</a> .  Data is displayed as graphs in the web interface. </p><br><p>  It looks like this: </p><br><p><img src="https://habrastorage.org/files/ceb/561/18c/ceb56118c7af42eb86f323190092c3cd.png" alt="ThinkingHome - temperature and humidity graphs"></p><br><p>  <em>The alarm clock / timer</em> plug-in allows you to turn on a sound signal at a specified time or execute a specified script.  For example, you can set up that at 8 am, the blinds in the whole house would open themselves, and at 22 hours they would close themselves. </p><br><p>  <em>Weather forecast plugin</em> - displays the weather forecast for specified cities in the web interface.  Weather information is downloaded from the <a href="https://openweathermap.org/api">OpenWeatherMap API</a> .  The result looks like this: </p><br><p><img src="https://habrastorage.org/files/2c5/732/140/2c57321406e24b12a107aa885df58a63.png" alt="ThinkingHome - weather forecast"></p><br><h3 id="chto-novogo">  What's new? </h3><br><p>  In the new version we have made a large number of new improvements.  In addition, many parts of the system were completely rewritten to increase the speed of work and make a more convenient API. </p><br><h4 id="osnovnye-izmeneniya">  Major changes: </h4><br><ul><li>  a new dark theme of design (it <a href="https://geektimes.ru/post/240170/">used to be like this</a> ); </li><li>  <a href="">The new interface of the start page</a> (conveniently configured through the editor); </li><li>  widgets and nooLite APIs for the start page; </li><li>  full screen mode for the script editor; </li><li>  multi-language support (see above); </li><li>  MQTT protocol support (see above); </li><li>  client-server message bus (see above) + is already used in widgets; </li><li>  completely rewritten the core of the web interface; </li><li>  API for triggering periodic actions </li><li>  chart.js (chart display tool) is available on the client; </li><li>  reconnect to nooLite receivers, if the receiver was unavailable, then became available again; </li><li>  accelerated service start; </li><li>  and many smaller improvements. </li></ul><br><h3 id="dokumentaciya">  Documentation </h3><br><p>  To a stranger <del>  at least somehow possible </del>  it was easier to deal with all these things, we wrote <em>documentation</em> .  We tried very hard to describe everything in detail and clearly!  The result was almost 50 pages of text (if printed on A4) and more than a hundred code examples (we wrote this for almost 3 months). </p><br><p>  The result is posted on the site <a href="http://system.thinking-home.ru/">http://system.thinking-home.ru</a> . </p><br><h3 id="dlya-teh-kto-nenavidit-windows">  For those who hate Windows </h3><br><p>  Historically, the project was written in C #.  In principle, this is a good option, given the number of ready-made libraries and the very high quality of development tools.  However, this option has a significant (for many, a critical) flaw - the application needs the .NET Framework, which works only under Windows. </p><br><p>  It was so until recently, but now the situation has changed.  In the summer, cross-platform .NET Core was released, and in November, version 1.1 was released.  We are pleased to announce that we have already begun to port ThinkingHome to .NET Core. </p><br><p>  Development is conducted in a <a href="https://github.com/thinking-home/system">separate repository</a> .  All code is written on a Mac and tested on macOS and linux.  Now the system kernel and part of the base plugins are ported (timers, work with the database, scripts).  When porting, much of the code is completely rewritten.  Definitely a new version will be much better than the old one in terms of architecture, API and performance. </p><br><p>  If you suddenly want to participate, we will be glad to any help!  (And if you don‚Äôt want to participate, go to <a href="https://github.com/thinking-home/system">github</a> anyway and click on the star :) </p><br><h3 id="vmesto-zaklyucheniya">  Instead of conclusion </h3><br><p>  I wanted to tell a lot, I'm not sure that everything was clear.  I will be glad to answer questions in the comments. </p><br><p>  Try <a href="">installing the application</a> and <a href="">write your own plugins</a> .  Create <a href="https://github.com/dima117/thinking-home/issues">issues</a> if you find errors and send <a href="https://github.com/dima117/thinking-home">pull requests</a> .  Add to our <a href="https://vk.com/thinking_home">VKontakte group</a> to keep abreast of the project news. </p><br><p>  I will be very pleased if you like it! </p><br><p>  <em>UPD: 12/24/2016 8:00 PM</em> <br>  Fixed a flaw in the distribution.  Those who downloaded the distribution, please download again. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/370003/">https://habr.com/ru/post/370003/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../369993/index.html">Astronomers have discovered a star that swallowed up part of their planets.</a></li>
<li><a href="../369995/index.html">Hugin - an excellent free program for creating panoramas</a></li>
<li><a href="../369997/index.html">The tax on Google will not raise the price of digital content - they said</a></li>
<li><a href="../369999/index.html">We photograph muons on the desktop. Instructions for use</a></li>
<li><a href="../370001/index.html">Nokia sues Apple for patent infringement</a></li>
<li><a href="../370007/index.html">The mobile Signal application bypasses government blocking by passing traffic through Google App Engine.</a></li>
<li><a href="../370009/index.html">Leonardo's musical Soviet military industry: from artillery systems to the world's first studio synthesizer</a></li>
<li><a href="../370013/index.html">A couple of new products from HiFiMAN: Edition S and Edition X</a></li>
<li><a href="../370015/index.html">Budget video surveillance for stingy "dummies"</a></li>
<li><a href="../370017/index.html">Kampi Flegrey, a volcano near Naples, started to wake up</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>