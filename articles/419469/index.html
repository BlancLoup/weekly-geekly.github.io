<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>UE4 | Cycle day and night | SkySphere modification</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The change of day and night often rises among users. And if in itself the movement of the sun is quite simple to organize, then it is much more diffic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>UE4 | Cycle day and night | SkySphere modification</h1><div class="post__text post__text-html js-mediator-article"><table><tbody><tr><td><img src="https://habrastorage.org/webt/i8/vv/kq/i8vvkqlbthqie8tuxsil4m1tihc.png" title="Day and night" align="left">  The change of day and night often rises among users.  And if in itself the movement of the sun is quite simple to organize, then it is much more difficult to achieve a more or less realistic work *** SkySphere ***. </td></tr></tbody></table><br><p>  In this article I do not plan to show all sorts of ways to change the orientation of <strong><em>DirectionalLight</em></strong> with the seasons and the precession.  On this topic, in my opinion, there is enough material.  Someone does this through <em>Blueprint</em> , I use <em>C ++</em> , so that the clock ticks on the server and periodically (once every few seconds) synchronizes the client's clock.  In this case, no movement occurs on the server.  Not lordly this business, to move the sun across the sky. </p><br><p>  Next, I will talk about emerging issues and show my version of upgrading the standard <strong><em>BP_Sky_Sphere</em></strong> to work correctly with the daily cycle. </p><br><hr><a name="habracut"></a><br><p>  Before the modification, it will be completely useful to copy the entire contents of the <em>EngineSky</em> folder to your directory, so as not to spoil the standard <em>Blueprint</em> and the resources connected to it. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/b6/0q/hcb60qrpea9jjmt5epkmyo92gve.png" title="BP_Sky_Sphere location"></div><br><hr><br><p>  First of all I want to talk about the bug (or features) of the standard sphere.  Attached <em>StaticMesh</em> for a sphere has a scale of 400. If you change it to 1, it seems that nothing will change, but if you run a little ahead you will feel like in the movie ‚ÄúThe Truman Show‚Äù.  Yes, this area, though huge, has its limits.  An obvious problem for open worlds, which is very easy to fix by forcing the sphere to move with the player. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uu/c5/q9/uuc5q9zbqocf6qjx3jivk-hioha.png" title="Sphere moving"></div><br><p>  Of course, as an alternative, you can make the sphere even bigger, but I don‚Äôt really like this idea. </p><br><hr><br><p>  The next item is setting up a normal night.  I categorically do not like that the stars appear only at midnight, and the rest of the time - it's just some long evening. </p><br><p>  It is also quite simply solved by setting the existing curves and adding new ones. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ma/ee/f_/maeef_fbjh-0qy0zlwmqqkw1p-g.png" title="Files for skySphere"></div><br><div class="spoiler">  <b class="spoiler_title">Curve example</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/je/bx/jn/jebxjnwz4wffra4nlgkfwfudpyw.png" title="Curve example"></div></div></div><br><hr><br><p>  The next problem is light attenuation for <em>DirectionalLight</em> and <em>SkyLight</em> .  It is strange to observe that at night you can see no worse than during the day.  It is also solved very simply by adding and adjusting the curves. </p><br><div class="spoiler">  <b class="spoiler_title">Changing lighting levels</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/pn/ah/q1/pnahq16t9que9s5ibs-ongxblua.png" title="Light adjustment"></div></div></div><br><hr><br><p>  Well, for dessert ... The stars do not move!  If the <em>night is long and full of horror</em> , then the player may not notice it.  But we are for a serious approach? </p><br><p>  First, I made the stars move by adding additional variables to the material. </p><br><div class="spoiler">  <b class="spoiler_title">Something like that</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/sv/ar/4h/svar4hd_cr_waskgntdl-h4v47o.png" title="Texture shifting"></div></div></div><br><p>  While the sun is moving along the equatorial plane, everything is in order.  But when imitating high latitudes, mathematical complexity begins and the reluctance of the texture to twist as we like.  But we are for a serious approach?  :) </p><br><p>  In the end, I decided to make two celestial spheres.  One with clouds, the sun and the sky, and the second, a little larger, with stars.  I connected the additional sphere to the same <strong><em>BP_Sky_Sphere</em></strong> and politely asked it to rotate with the sun ... </p><br><p>  And the most interesting part!  Make the smaller sky sphere partially transparent.  Just because connecting the logic of the material to the <em>Opacity</em> , of course, I got wonderful stars shining through the black night clouds.  Therefore, again I had to modify the material with a file, actually drawing two skies.  One with black night clouds for visuals.  And second, with always white clouds for <em>Opacity</em> .  Plus he added many, many whites in the daytime, actually making the sky opaque, so that the translucent blue did not frighten with its depth. </p><br><div class="spoiler">  <b class="spoiler_title">Blueprint</b> <div class="spoiler_text"><p>  The picture is clickable <br></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/i7/hb/ie/i7hbiewnz563pf3o03ayopkyu-4.png" title="Skysphere blueprint"></div><p></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Material</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/to/0e/gi/to0egihkctiysbq7onixdg2mqm8.png" title="SkySphere Material"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qu/dj/x4/qudjx4p-wn7yggoue3qozdzgmzi.png" title="SkySphere Material"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gz/oa/6t/gzoa6tc3ugdm04-alvx8togsvse.png" title="SkySphere Material"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vp/qq/nj/vpqqnjzwui4pdxyae48jayuyzbq.png" title="SkySphere Material"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iw/lp/qr/iwlpqrzms2fj0m0etcu75k4ahkk.png" title="SkySphere Material"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9d/xi/9j/9dxi9jciwkknqep1h_6k1gmdzvc.png" title="SkySphere Material"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/z0/fz/b_/z0fzb_jmzhkgz_zm8jaqohtua8u.png" title="SkySphere Material"></div></div></div><br><p>  Now everything works as intended by the Creator, in this case by me.  It remains only to fine-tune the control curves, but in general it looks good already. </p><br><hr><br><p>  If you have an idea how to make it easier, please share it.  I will be grateful. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/419469/">https://habr.com/ru/post/419469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../419451/index.html">Step-by-step creating a symfony 4 bundle</a></li>
<li><a href="../419453/index.html">Numerical methods for solving systems of nonlinear equations</a></li>
<li><a href="../419457/index.html">RabbitMQ - SQL Server</a></li>
<li><a href="../419461/index.html">Ventilation of the bathroom with the mind</a></li>
<li><a href="../419467/index.html">From the light bulb to the vacuum cleaner and the drone - as we taught Alice to control hundreds of devices</a></li>
<li><a href="../419471/index.html">Migration option from jQuery to pure javascript</a></li>
<li><a href="../419473/index.html">How are things in the cloud, and what drives IaaS ahead: discuss technological trends</a></li>
<li><a href="../419475/index.html">How to find inspiration and not lose uniqueness</a></li>
<li><a href="../419477/index.html">Easier than it seems. Chapter 11</a></li>
<li><a href="../419479/index.html">Security "Ekaterinburg Arena": how we prepared the stadium for the 2018 World Cup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>