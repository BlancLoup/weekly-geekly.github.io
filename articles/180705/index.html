<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automated testing of a web application (MS Unit Testing Framework + Selenium WebDriver C #). Part 3: WebPages - describing pages</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Greetings to all whom the previous articles were helpful or were just interesting. In the last part we dealt with Selenium WebDriver, a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automated testing of a web application (MS Unit Testing Framework + Selenium WebDriver C #). Part 3: WebPages - describing pages</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/846/eae/1d9/846eae1d9b65bc2b8ab520ceede75ccc.png" alt="Webpages"><br><h5>  Introduction </h5><br>  Greetings to all whom the previous articles were helpful or were just interesting.  In the last part we dealt with Selenium WebDriver, and now, before we start writing tests, we need to describe the pages of the application under test.  In the preview list the main points <br><ul><li>  Descriptions of all pages will be in a separate project, I called it Autotests.WebPages </li><li>  For each page a separate class will be created, located in a separate file. </li><li>  The names of the classes will coincide with the names of the web pages, for example, the description of the MySite / Home / Help page will be stored in a class called Help </li><li>  The structure of the location of these files is hierarchical and will repeat the tree of web pages.  For example, the Help page will have the path Root \ Home \ Help.cs relative to the project and be located in the namespace (namespace) of Autotests.WebPages.Root.Home </li><li>  To access the pages will be developed some facade (Facade), a static class Pages </li><li>  In practice, pages can have a lot in common, so it is quite logical to use inheritance and putting some functionality into separate helpers. </li></ul><a name="habracut"></a><br><br><h5>  Links </h5><br>  <a href="http://habrahabr.ru/post/178321/">Part 1: Introduction</a> <br>  <a href="http://habrahabr.ru/post/180047/">Part 2.1: Selenium API wrapper - Browser</a> <br>  <a href="http://habrahabr.ru/post/180357/">Part 2.2: Selenium API wrapper - WebElement</a> <br>  <a href="http://habrahabr.ru/post/180705/">Part 3: WebPages - describing pages</a> <br>  <a href="http://habrahabr.ru/post/181558/">Part 4: Finally writing tests</a> <br>  <a href="https://autotests.codeplex.com/">Framework Publishing</a> <br><br><h5>  Class PageBase </h5><br>  It is logical to start with the design of the base class.  What will be common to our pages?  Least: <br><ul><li>  getting url page </li><li>  page opening </li><li>  getting page name </li><li>  link navigation </li></ul><br>  In addition to this, the PageBase class will contain methods common to all pages, which depend on the particular application.  For example, if on all pages of the site can pop up a custom pop-up window, then we write the ClosePopup () method.  Or, for example, on all pages there is a site menu.  Then this menu can be described in the base class.  In the example I will omit it. <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Autotests.WebPages</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PageBase</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Uri Url { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { Browser.WaitAjax(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetUriByRelativePath(RelativePath); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Open</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Contract.Requires(Url != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); Contract.Ensures(Browser.Url == Url, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0} != {1}"</span></span>, Browser.Url, Url)); Browser.WaitAjax(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Browser.Url == Url) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; Browser.Navigate(Url); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Type </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PageName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetType(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Navigate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Uri url</span></span></span><span class="hljs-function">)</span></span> { Contract.Requires(url != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); Browser.Navigate(url); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Uri </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetUriByRelativePath</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> relativePath</span></span></span><span class="hljs-function">)</span></span> { Contract.Requires(!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(relativePath)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0}{1}"</span></span>, SharedSettings.TestEnvironmentUrl, relativePath)); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> RelativePath { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> rootNamespaceName = <span class="hljs-string"><span class="hljs-string">"Autotests.WebPages.Root"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> stringToDelete = <span class="hljs-string"><span class="hljs-string">"Page"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fullName = GetType().FullName; Contract.Assume(fullName != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fullName.Replace(rootNamespaceName, <span class="hljs-string"><span class="hljs-string">""</span></span>).Replace(<span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">"/"</span></span>).Replace(stringToDelete, <span class="hljs-string"><span class="hljs-string">""</span></span>); } } } }</code> </pre> <br>  RelativePath gets the relative path to the web page based on the name and location of the class that describes it.  Deleting the magic word ‚ÄúPage‚Äù is a crutch for the case when the name of the page of the site coincides with the reserved or occupied names.  In this case, the word ‚ÄúPage‚Äù is simply assigned to the name of the page description class. <br>  SharedSettings.TestEnvironmentUrl - the address of the site under test.  It can be stored in constants or in project settings. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  LogOn page description </h5><br>  Now, to get to the site, we need to pass authorization (by the way, everyone knows how authorization differs from authentication?). <br>  We describe the LogOn page: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogOn</span></span> : <span class="hljs-title"><span class="hljs-title">PageBase</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Elements private static readonly WebElement LoginEdit = new WebElement().ById("Login"); private static readonly WebElement PasswordEdit = new WebElement().ById("Password"); private static readonly WebElement RememberMeCheckbox = new WebElement().ById("Remember"); private static readonly WebElement ValidationSummary = new WebElement().ByClass("ValidationSummary"); #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> public void DoLogOn(UserLoginInfo userLoginInfo) { LoginEdit.Text = userLoginInfo.Login; PasswordEdit.Text = userLoginInfo.Password; RememberMeCheckbox.SetCheck(userLoginInfo.RememberMe); Browser.ExecuteJavaScript("$('#LogOnForm').submit()"); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (Browser.Url == Main.Url) return; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (ValidationSummary.Exists()) throw new LogOnValidationException(); throw new Exception("Unknown logon exception."); } }</span></span></code> </pre><br>  So, on the page we have two input fields (username and password), the ‚ÄúRemember me‚Äù checkbox and the ‚ÄúEnter‚Äù button.  I deliberately did not begin to describe this button, but click on it through the Browser.ExecuteJavaScript to show this way of manipulating elements. <br>  The DoLogOn method accepts some data structure, fills in and submits the form.  If after this the main Browser.Url == Main.Url page is displayed, the method successfully completes its work.  If the input failed, and a ValidationSummary.Exists () error is shown, the method throws a LogOnValidationException exception.  In all other (unforeseen) cases, an exception is thrown with the message "Unknown logon exception.". <br>  The LogOn class inherited from PageBase some methods and properties, for example, the Open () method.  There are situations when the page needs to be opened with some parameters.  To do this, you need to write in the LogOn class an overload for Open: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Open</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userId</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0}?userId={1}"</span></span>, Url, userId)); Navigate(url); }</code> </pre><br>  In this method, we create a new Url (add user id) and call the base class Navigate method. <br><br>  Note that there is no hidden initialization (remember PageFactory), the elements will be searched when they are accessed. <br><br><h5>  Facade Pages </h5><br>  In principle, you can not use the facade.  I was so comfortable because the classes of the pages are not static, and I need to create instances.  For example (see picture above), the Pages class will look like this: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Autotests.WebPages</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Pages</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> LogOn LogOn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LogOn(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Home</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Help Help = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Help (); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Main MainLogOut = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MainLogOut (); } } }</code> </pre><br>  Thus, from the tests we will be able to work with the pages as follows: <br><pre> <code class="cs hljs">Pages.LogOn.DoLogOn(...); Pages.Home.Help.Open();</code> </pre><br>  This is very convenient, the page hierarchy repeats the site hierarchy. <br><br><h5>  Conclusion </h5><br>  Fuf, this part was pretty easy for me, and there was a bit of code.  As usual, write any questions / suggestions in a personal or in the comments.  In the next part, finally, we will write autotests =) In it, I will give answers to the most frequent questions and give a link to the working version of the framework. </div><p>Source: <a href="https://habr.com/ru/post/180705/">https://habr.com/ru/post/180705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180695/index.html">11 reasons to be a manager</a></li>
<li><a href="../180697/index.html">Why I do not believe in the domestic space - a view from the inside</a></li>
<li><a href="../180699/index.html">Moving a physical machine in a ProxmoxVE2 cluster (3) from DRBD to a new hardware</a></li>
<li><a href="../180701/index.html">Google Play Developer Console: New Features - New Issues</a></li>
<li><a href="../180703/index.html">Hibernate duplicate fieldset</a></li>
<li><a href="../180707/index.html">Russian 3D core zahabreno. Answers to your questions</a></li>
<li><a href="../180709/index.html">The visual language of DRAGON and its application in the rocket and space industry, medicine and other fields. Video report V. Parondzhanova</a></li>
<li><a href="../180711/index.html">Kim Dotcom and two-factor authentication</a></li>
<li><a href="../180715/index.html">Google acquired the manufacturer of flying wind turbines</a></li>
<li><a href="../180717/index.html">Fast neutron reactors - that‚Äôs the hope of mankind!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>