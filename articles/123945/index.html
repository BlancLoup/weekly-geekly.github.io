<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Running code under another user in Windows from Java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! Now I will tell you how to run the code under the account of another user in Windows from Java using JNA. 

 Practical value 
 In general, t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Running code under another user in Windows from Java</h1><div class="post__text post__text-html js-mediator-article">  Good day!  Now I will tell you how to run the code under the account of another user in Windows from Java using JNA. <br><a name="habracut"></a><br><h4>  Practical value </h4><br>  In general, this may be necessary when you need to access resources that are available to any one user, and the user under which the current thread is running does not have permissions to access these resources.  But there is a login, domain and password of the desired user. <br>  For example - there is a server that allows you to give files to the client from certain folders.  Access to folders is restricted at the level of NTFS access rights.  And the server itself does not have access to these folders (which is correct - the server is started under a separate account, which has access only to the server directory and the temp folder).  But the client knows the credentials of users who are allowed access to these folders.  Question for small - log in under the desired user and access. <br><br><h4>  Theory </h4><br>  First you need to know that in order to take advantage of the rights of the user, you need to start the process or stream under the credentials of the desired user, and then from this thread / process to access the necessary resources.  MSDN and forums advise us the following: <br>  1) CreateProcessWithLogonW - immediately launches the specified application with the necessary credentials.  The easiest option and the most optimal is that in order to execute a couple of three lines of code we will start the whole application. <br>  2) A bunch of functions - LogonUser, CreateThread, SetThreadToken, ResumeThread.  In the first function, we login to the system under the specified credentials and get a token.  In the second function, create a sleep thread.  The third indicates the token for the created thread.  In the fourth run the created sleep stream. <br>  Let's stop on the second option.  Although it requires some additional lines of code, it is the most optimal. <br><br><h4>  Implementation </h4><br>  First you need to choose with which we will run the native code from Java.  I know two ways - JNI and JNA.  The first is ‚Äúnative‚Äù for Java and the fastest (according to some authors).  But it requires writing an additional native library with a description of the functions being called.  And for this you need some outside body movements.  Moreover, writing a native code, albeit a simple one, is not a trivial task for a Java programmer.  In the second case, you only need to describe the called functions in the interface and everything can be used.  Especially since many types and functions of Windows in JNA are already described. <br>  To use JNA, we need jna.jar itself, which contains the main JNA code and platform.jar, which describes some functions and types for different platforms - Mac, Win, * nix. <br>  We now turn to coding.  First, we describe the called functions ‚Äî we create two interfaces ‚Äî MoreKernel32, which inherits the Kernel32 interface from platform.jar, and MoreAdvapi32, which inherits Advapi32 from the same jar. <br>  Let's write in the following methods in these interfaces: <br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MoreAdvapi32</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Advapi32</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MoreAdvapi32 instance = (MoreAdvapi32) Native.loadLibrary(<span class="hljs-string"><span class="hljs-string">"advapi32"</span></span>, MoreAdvapi32.class, W32APIOptions.DEFAULT_OPTIONS); <span class="hljs-function"><span class="hljs-function">Boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetThreadToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HANDLEByReference pointer, HANDLE Token)</span></span></span></span>; }</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MoreKernel32</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kernel32</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MoreKernel32 instance = (MoreKernel32) Native.loadLibrary(<span class="hljs-string"><span class="hljs-string">"kernel32"</span></span>, MoreKernel32.class,W32APIOptions.DEFAULT_OPTIONS); <span class="hljs-function"><span class="hljs-function">DWORD </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResumeThread</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WinNT.HANDLE hThread)</span></span></span></span>; WinNT.<span class="hljs-function"><span class="hljs-function">HANDLE </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateThread</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Pointer lpThreadAttributes, Pointer dwStackSize, Callback lpStartAddress, Pointer lpParameter, DWORD dwCreationFlags, Pointer lpThreadId)</span></span></span></span>; }</code> </pre> <br><br>  The LogonUser method is already in the Advapi32 interface, it is not necessary to describe it. <br>  A few words about how JNA learns what functions to call on the native library.  To do this, you need to describe the interface with these functions so that their names and parameters match.  Then you need to call Native.loadLibrary with the following parameters - the name of the loaded library, the name of the interface to which the library will be mapped, and the loading options.  As a result, we will get a link to the interface from which it will be possible to use these functions. <br>  Now I will tell you in more detail what we have done: <br>  1) Described the functions in the interfaces. <br>  2) We loaded the kernel32 and advapi32 libraries, and zamapili them on the created interfaces by calling the Native.loadLibrary function.  The link to the loaded libraries was saved in the instance variable in each of the interfaces. <br>  Now consider two classes.  The first class ThreadFunc is designed to run in a user thread.  The code is very simple - here you just open the file for reading and check for the availability of the file.  The most important thing is that the class implements the Callback interface, and the callback () function was created in it.  This will allow JNA to determine if the class is intended to be called.  If you look at the Callback interface code, you can see that it describes the name of the function being called and describes the name of the functions that will be ignored. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> jna; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileInputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileNotFoundException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.sun.jna.Callback; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThreadFunc</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callback</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String fileName; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FileInputStream in; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> FileInputStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> in; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fileName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String file)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fileName = file; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ File testAccess = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(fileName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (testAccess.canRead()) { System.out.println(<span class="hljs-string"><span class="hljs-string">"     "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { in = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(fileName); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (FileNotFoundException e) { e.printStackTrace(); } }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"     "</span></span>); } } }</code> </pre><br>  The second class of JnaTest is basic - a stream is created here, a user logs into the system, a token is set up, and the most important thing for which all this hastily happened is reading a file. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> jna; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileInputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.channels.FileChannel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.sun.jna.platform.win32.Advapi32; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.sun.jna.platform.win32.WinBase; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.sun.jna.platform.win32.WinDef.DWORD; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.sun.jna.platform.win32.WinNT.HANDLE; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.sun.jna.platform.win32.WinNT.HANDLEByReference; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JnaTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String fileName = <span class="hljs-string"><span class="hljs-string">"D:\\user1\\hitman.jpg"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ FileInputStream in = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FileOutputStream out = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FileChannel fcin = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FileChannel fcout = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { File testAccess = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(fileName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (testAccess.canRead()) { System.out.println(<span class="hljs-string"><span class="hljs-string">"     "</span></span>); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"     "</span></span>); } <span class="hljs-comment"><span class="hljs-comment">//  // CREATE_SUSPENDED DWORD flag = new DWORD(4L); ThreadFunc func = new ThreadFunc(); func.setFile(fileName); HANDLE hThread = MoreKernel32.instance.CreateThread(null, null, func, null, flag, null); if (hThread == null) { System.out.println("  "); return; } //    HANDLEByReference phToken = new HANDLEByReference(); Boolean logonResult = Advapi32.INSTANCE.LogonUser("user1", "HORROR", "1234567q-",WinBase.LOGON32_LOGON_NETWORK, WinBase.LOGON32_PROVIDER_DEFAULT, phToken); if (logonResult == false) { System.out.println("  "); return; } //   HANDLEByReference pThread = new HANDLEByReference(hThread); Boolean setTokenResult = MoreAdvapi32.instance.SetThreadToken(pThread, phToken.getValue()); if (setTokenResult == false) { System.out.println("  "); return; } //     MoreKernel32.instance.ResumeThread(hThread); MoreKernel32.instance.WaitForSingleObject(hThread, -1); MoreKernel32.instance.CloseHandle(hThread); MoreKernel32.instance.CloseHandle(phToken.getValue()); //  in = func.getIn(); if (in == null) { return; } out = new FileOutputStream("D:\\test.zip"); fcin = in.getChannel(); fcout = out.getChannel(); fcin.transferTo(0, fcin.size(), fcout); } catch (Exception e) { e.printStackTrace(); } finally { //  if (fcin != null) { try { fcin.close(); } catch (IOException e) { e.printStackTrace(); } } if (fcout != null) { try { fcout.close(); } catch (IOException e) { e.printStackTrace(); } } if (in != null) { try { in.close(); } catch (IOException e) { e.printStackTrace(); } } if (out != null) { try { out.close(); } catch (IOException e) { e.printStackTrace(); } } } } }</span></span></code> </pre><br>  Consider in more detail this code. <br>  First, create a class for the stream and specify which file to open.  Then we execute the CreateThread function with two parameters ‚Äî a reference to the class for opening the file and the creation flag CREATE_SUSPENDED ‚Äî indicating to the system that the stream should be created ‚Äúasleep‚Äù.  After execution, we get the handle of the thread.  Then we check if the handle is null, then the thread is not created and we need to complete the work. <br>  The second block of code is designed to perform the login.  Here, before launching the LogonUser function, you need to create a link to the handle, which will then be written to the user's token.  We specify the login, the domain, the password, the memory pointer where the token and additional parameters of the user‚Äôs login will be written as parameters to start the function.  As a result of executing the function, we get either true and the user's token or false.  Next comes the check for the return value and, if it is false, exit from the program. <br>  The next block is quite simple - there we start the thread, wait until it finishes, and close the tokens. <br>  Reading a file is also not difficult - we get file channels from FileInputStream and FileOutputStream and copy the file. <br>  Resource closing is standard in Java - in the finally block. <br>  Now a few comments: <br>  1) When creating a stream, you need to keep a reference to the class that will be called in the stream, for the entire life of the stream.  Even if external access to this class is not needed.  Otherwise, the class may be deleted by the garbage collector and there will be an attempt to access memory filled with incorrect data.  Actually, this is written on the JNA website, but I learned that later, when I caught several Access error. <br>  2) If you open a resource and transfer it to another thread, the access rights are saved.  Here we can observe this - the file is open in a stream with the access rights of one user, and the file itself is read in another stream, with other rights. <br><br><h4>  Execution Example </h4><br>  Now check the program execution.  First create a folder and file. <br><br><br>  Then assign permissions to this folder: <br><br><img src="https://habrastorage.org/storage1/48056d69/5cf09c4e/ea2df760/1cd6c687.png"><br>  Fig.1 Folder user1 <br><br><img src="https://habrastorage.org/storage1/be1c1ab6/d98dc9a0/f57cd589/75b1b52b.png"><br>  Fig.2 Allow access for user user1 <br><br><img src="https://habrastorage.org/storage1/ca617d3e/a86474b9/e635cafb/1231f9b3.png"><br>  Fig.3 Allowing access for user Tim <br><br>  Run the program: <br>  <b>The file can be read from the main stream.</b> <b><br></b>  <b>The file can be read from the additional stream.</b> <br><br>  Now we deny the user Tim access to the folder. <br><br><img src="https://habrastorage.org/storage1/633410fb/8de99d85/bcbe9915/7ea63d15.png"><br>  Fig.  4 Denying rights to access the folder for the user Tim <br><br>  Let's try to open a folder in Explorer.  We get the error message: <br><br><img src="https://habrastorage.org/storage1/33a21534/75dbc664/0430b4ce/80263275.png"><br>  Fig.  5 Error message when opening a folder <br><br>  Now run the program: <br>  <b>The file cannot be read from the main stream.</b> <b><br></b>  <b>The file can be read from the additional stream.</b> <br><br><h4>  Links to resources </h4><br>  <a href="http://jna.java.net/">Jna</a> <br><br>  <a href="http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx">Logonuser</a> <br><br>  <a href="http://msdn.microsoft.com/en-us/library/ms682453(v%3DVS.85).aspx">CreateThread</a> <br><br>  <a href="http://msdn.microsoft.com/en-us/library/ms685086(v%3DVS.85).aspx">ResumeThread</a> <br><br>  <a href="http://msdn.microsoft.com/en-us/library/aa379590(VS.85).aspx">SetThreadToken</a> </div><p>Source: <a href="https://habr.com/ru/post/123945/">https://habr.com/ru/post/123945/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123940/index.html">Plugin for "live" forms</a></li>
<li><a href="../123941/index.html">Making a keyboard with the layout Dvorak (for programmers) from the usual QWERTY</a></li>
<li><a href="../123942/index.html">HTC Status Communicator Appears in the USA</a></li>
<li><a href="../123943/index.html">Google+ account lockout continues</a></li>
<li><a href="../123944/index.html">Buying tickets for Russian Railways</a></li>
<li><a href="../123946/index.html">Letter</a></li>
<li><a href="../123947/index.html">Personal data protection - how to be and what to do?</a></li>
<li><a href="../123948/index.html">Best DNS practices for telecom</a></li>
<li><a href="../123949/index.html">Semantics for CSS selectors and combinators</a></li>
<li><a href="../123950/index.html">The work of the Ural physicists on spintronics in Physical Review Letters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>