<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wi-Fi networks: penetration and protection. 1) materiel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Weather forecasters predict that by 2016 the second ice age will come the traffic in wireless networks by 10% will exceed the traffic in wired Etherne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wi-Fi networks: penetration and protection. 1) materiel</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/71a/ed2/1ab/71aed21ab462ce60a842ecf990aa0e3f.jpg" height="250"><br><br>  Weather forecasters predict that by 2016 the <s>second ice age will come the</s> traffic in wireless networks <a href="http://www.cisco.com/c/en/us/solutions/collateral/service-provider/ip-ngn-ip-next-generation-network/white_paper_c11-481360.html">by 10% will exceed the traffic in wired Ethernet</a> .  At the same time, from year to year private access points become <a href="http://www.statista.com/statistics/218601/global-number-of-private-hotspots-since-2009/">about 20% more</a> . <br><br>  With this trend, it can <s>not but</s> rejoice that <a href="http://graphs.net/wifi-stats.html">80% of network owners do not change default access passwords</a> .  Their number includes networks of companies. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      With this series of articles, I want to put together descriptions of existing protection technologies, their problems and workarounds, so that at the end the reader will be able to tell himself how to make his network impenetrable, <s>and even visually demonstrate the problems using the hapless neighbor‚Äôs example</s> (do not try this at home, kids).  The practical side of hacking will be covered with <b><a href="http://kali.org/">Kali Linux</a></b> (formerly Backtrack 5) in the following sections. <br><br>  The article, as it was written, grew from 5 pages to 40, so I decided to break it apart.  This cycle is not just an instruction, as it should and should not be done, but a detailed explanation of the reasons for this.  Well, who wants instructions - they are: <br><blockquote> Use WPA2-PSK-CCMP with a password of 12 <code>az</code> characters (2000+ years busting on an ATI cluster).  Change the default network name to something unique (protection from rainbow-tables).  Disable WPS (just touch 10000 PIN combinations).  Do not rely on MAC filtering and hiding the SSID. <br></blockquote><br>  <b>Table of contents:</b> <br>  <b>1)</b> materiel <br>  <b>2)</b> <a href="http://habrahabr.ru/post/225483/">Kali.</a>  <a href="http://habrahabr.ru/post/225483/">Hiding SSID.</a>  <a href="http://habrahabr.ru/post/225483/">MAC filtering.</a>  <a href="http://habrahabr.ru/post/225483/">WPS</a> <br>  <b>3)</b> <a href="http://habrahabr.ru/post/226431/">WPA.</a>  <a href="http://habrahabr.ru/post/226431/">OpenCL / CUDA.</a>  <a href="http://habrahabr.ru/post/226431/">Pick statistics</a> <br><a name="habracut"></a><br>  But first - materiel. <br><br><h4>  Pass me the sugar </h4><br>  Imagine that you are a device that accepts instructions.  Anyone can connect to you and give any command.  Everything is good, but at some stage it was necessary to filter the personalities that can control you.  This is where the fun begins. <br><br>  How to understand who can give the command and who does not?  The first thing that comes to mind is a password.  Let each client pass a certain password before transferring a new command.  Thus, you will only execute commands that are accompanied by the correct password.  <s>The rest is a floppy.</s> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/47e/b46/134/47eb461341e94239d711b70bf3b0c5ce.png"></div><br>  This is how HTTP (Auth Basic) basic authorization works: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">AuthType</span></span> Basic AuthName <span class="hljs-string"><span class="hljs-string">"My super secret zone!"</span></span> AuthUserFile /home/.htpasswd Require valid-user</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/532/86f/4b4/53286f4b4d9c144567c597020ad95c2a.png"></div><br><br>  After successful authorization, the browser will simply transfer a specific header for each request to a closed zone: <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span>: Basic YWRtaW46cGFzcw==</code> </pre><br>  That is, the original: <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> -n <span class="hljs-string"><span class="hljs-string">'admin:pass'</span></span> | base64 <span class="hljs-comment"><span class="hljs-comment"># YWRtaW46cGFzcw==</span></span></code> </pre><br>  This approach has one big drawback - since the password (or login-password, which is essentially just two parts of the same password) is transmitted through the channel ‚Äúas it is‚Äù - anyone can interlock between you and the client and get your password on a plate.  And then use it and dispose of you as you like! <br><br>  To prevent such a disgrace, you can resort to tricks: use any two-way encryption algorithm, where our password will be the private key, and you should never explicitly transmit it.  However, this will not solve the problem - you only need to know the password once and you can decrypt any data transmitted in the past and the future, plus encrypt your own and successfully disguise yourself as a client.  And given that the password is intended for a person, and people tend to use far from the whole set of 256 bytes in each character, and these characters are usually around 6-8 ... in general, the Komsomol does not approve. <br><br>  What to do?  And let's do what real conspirators do: at the first contact, we will invent a long random string (long enough so that it cannot be picked up while the sun is shining), remember it and will encrypt all further transmitted data using this ‚Äúpseudonym‚Äù for a real password .  And periodically to change this line - <s>then the Jedi will not pass at all</s> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/57d/705/29f/57d70529f9c4b4bfe2137d98f12db433.png"></div><br>  The first two transfers (the green icons in the figure above) are the handshake phase, when we first tell the server about our legitimacy, showing the correct password, to which the server responds with a random string, which we then use for encryption and transfer any data. <br><br>  So, to select a key, a hacker will either need to find a vulnerability in its generation algorithm (as is the case with <a href="https://en.wikipedia.org/wiki/Dual_EC_DRBG">Dual_EC_DRBG</a> ), or rent a hundred or two parallel universes and several thousand ATI farms to solve this problem during their lifetime.  All this is due to the fact that a random key can be of any length and contain any codes of the available 256, because the human user will never have to work with it. <br><br>  Such a scheme with a temporary key (session key, session key or ticket) in different variations is used today in many systems - including SSL / TLS and wireless security standards, which will be discussed. <br><br><h4>  Attack plan </h4><br>  Attentive readers, of course, noticed that no matter how tricky we are, we cannot get away from sending a password and a temporary key in an open or hashed form.  As a result, it is enough for the hacker to intercept the transmission in this phase, and he will be able to read all the subsequent data, as well as participate in the process, inserting his five kopecks.  And it is impossible to distinguish it, since all the information that the server could use to issue a temporary key or access check is based on exactly what was at the beginning of the transfer - a handshake.  Therefore, the hacker knows everything the same as the server and the client, and can drive both by the nose until the temporary key expires. <br><br>  Our task in hacking any program somehow comes down to intercepting a handshake, from which you can either pull out a temporary key, or the original password, or both.  In general, this is quite a long time and requires some luck. <br><br>  But it is in an ideal world ... <br><br><h4>  Wi-Fi Protection Mechanisms </h4><br>  Technologies are created by people and in almost all of them there are mistakes, sometimes critical enough to circumvent any of the best protection in theory.  Below we will go through the list of existing mechanisms for protecting data transmission over the air (that is, without affecting SSL, VPN and other higher-level methods). <br><br><h5>  OPEN </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/b0d/e46/3a3/b0de463a3c6c2f487890ea780950561d.jpg"><br><br>  <b>OPEN</b> is the lack of any protection.  The access point and the client do not disguise the transfer of data.  Almost any wireless adapter in any laptop with Linux can be set to a wiretapping mode, when instead of discarding packets not intended to it, it will record them and transfer them to the OS, where they can be safely viewed.  <s>Who are we got there on Twitter?</s> <br><br>  It is on this principle that wired networks work - they don‚Äôt have built-in protection and ‚Äúcrashing‚Äù into it or simply connecting to the hub / switch the network adapter will receive packets of all devices in this network segment in the open form.  However, with a wireless network, you can ‚Äúcrash‚Äù from any place - 10-20-50 meters or more, and the distance depends not only on the power of your transmitter, but also on the length of the hacker's antenna.  Therefore, open data transmission over a wireless network is much more dangerous. <br><br>  In this series of articles, this type of network is not considered, since there is nothing to crack there.  If you need to use an open network in a cafe or airport - use VPN (avoiding PPTP) and SSL ( <code>https://</code> , but put <a href="https-everywhere">HTTPS Everywhere</a> , or paranoidly make sure that the lock does not disappear from the address bar if someone turns <code>sslstrip</code> - which, however, passwords will no longer save), and even all together.  Then nobody sees your cats. <br><br><h5>  WEP </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/763/7b9/c29/7637b9c298cc8743f127085890d841bc.jpg"><br><br>  <b>WEP</b> is the first Wi-Fi security standard.  It stands for <i>Wired Equivalent Privacy</i> ("equivalent to protecting wired networks"), but in fact it gives much less protection than these wired networks, as it has many flaws and is cracked in many different ways, which, because of the distance covered by the transmitter, makes data more vulnerable.  It should be avoided almost in the same way as open networks - it provides security only for a short time, after which any transmission can be fully disclosed, regardless of the complexity of the password.  The situation is aggravated by the fact that WEP passwords are either 40 or 104 bits, which is an extremely short combination and can be picked up in seconds (this is without taking into account errors in the encryption itself). <br><br>  WEP was invented in the late 90s, which justifies it, but those who still use it do not.  I still consistently find at least one WEP network for 10-20 WPA networks. <br><br>  In practice, there were several encryption algorithms for the transmitted data ‚Äî Neesus, MD5, Apple ‚Äî but all of them are somehow unsafe.  Especially noteworthy is the first, the effective length of which is 21 bits (~ 5 characters). <br><br>  The main problem of WEP is a fundamental design error.  As illustrated in the beginning, stream encryption is done with a temporary key.  WEP actually transfers several bytes of this key along with each data packet.  Thus, regardless of the complexity of the key, any transmission can be revealed simply by having a sufficient number of intercepted packets (several tens of thousands, which is quite a small amount for an actively used network). <br><br>  By the way, in 2004 IEEE declared WEP obsolete due to the fact that the standard ‚Äúdid not fulfill its goals [to ensure the security of wireless networks]‚Äù. <br><br>  <s>Pro attacks on WEP will be discussed in the third part.</s>  Most likely in this cycle about WEP will not be, since the articles and so it turned out very large, and the prevalence of WEP steadily declining.  Who needs it - can easily find guidance on other resources. <br><br><h5>  WPA and WPA2 </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/e91/d4b/99c/e91d4b99cb3a0b73aa062e856e5133bd.jpg"><br><br>  <b>WPA</b> is the second generation to replace WEP.  It stands for <i>Wi-Fi Protected Access</i> .  Qualitatively different level of protection due to taking into account WEP errors.  The password length is arbitrary, from 8 to 63 bytes, which greatly complicates its selection (compare with 3, 6 and 15 bytes in WEP). <br><br>  The standard supports various encryption algorithms for transmitted data after a handshake: TKIP and CCMP.  The first is a kind of bridge between WEP and WPA, which was invented while IEEE was busy creating a full-fledged CCMP algorithm.  TKIP, like WEP, suffers from some types of attacks, and is generally not secure.  Now it is rarely used (although it‚Äôs not clear why it‚Äôs used at all), and in general, using WPA with TKIP is <a href="http://www.findmysoft.com/news/Wi-Fi-NOT-Protected-Access-Prove-Hacking-Experts/">almost the same as using simple WEP</a> . <br><br>  One of the interesting features of TKIP is the possibility of the so-called Michael-attack.  For fast patching of some especially critical holes in WEP in TKIP, a rule was introduced that the access point is obliged to block all communications through itself (that is, ‚Äúfall asleep‚Äù) for 60 seconds if an attack is found on the selection of a key (described in the second part).  Michael-Attack is a simple transfer of ‚Äúspoiled‚Äù packets to completely shut off the entire network.  Moreover, in contrast to the usual DDoS, only two ( <i>two</i> ) packets are enough for guaranteed network outage for one minute. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7d/35b/14b/e7d35b14b7aa4a720a3b1d7583ba4052.jpg"></div><br>  WPA differs from WEP in that it encrypts each client's data separately.  After the handshake, a temporary key is generated - PTK - which is used to encode the transfer of this client, but no other.  Therefore, even if you have penetrated the network, you can only read the packets of other clients when you intercept their handshakes - each separately.  Demonstrating this with Wireshark will be in the third part. <br><br>  In addition to different encryption algorithms, WPA (2) supports two different modes of initial authentication (checking password for client access to the network) - PSK and Enterprise.  <b>PSK</b> (sometimes called <i>WPA Personal</i> ) is a login using a single password that a client enters when connecting.  This is simple and convenient, but in the case of large companies it can be a problem - let's say your employee has left and so that he can no longer get access to the network, you have to <s>use the method from the Black Men to</s> change the password for the entire network and notify other employees about it .  <b>Enterprise</b> removes this problem due to the presence of multiple keys stored on a separate server - RADIUS.  In addition, Enterprise standardizes the authentication process itself in the EAP (Extensible Authentication Protocol) protocol, which allows you to write your own <s>bicycle</s> algorithm.  In short, some buns for great uncles. <br><br>  In this cycle, the attack on WPA (2) -PSK will be discussed in detail, since Enterprise is a completely different story, as it is used only in large companies. <br><br><h5>  WPS / QSS </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/d23/54c/3ff/d2354c3fff4f9a59fb9cb271ae705e9c.jpg"><br><br>  <b>WPS</b> , also <s>known</s> as <s>Qikk aSS</s> <b>QSS,</b> is an interesting technology that allows us not to think about a password at all, but simply <s>add water to</s> press a button and immediately connect to the network.  In fact, this is a ‚Äúlegal‚Äù method of circumventing password protection in general, but it is surprising that it has become widespread with a very serious miscalculation in the admission system itself - years after the sad experience with WEP. <br><br>  WPS allows a client to connect to an access point using an 8-digit code consisting of numbers (PIN).  However, due to an error in the standard, only 4 of them need to be guessed.  Thus, it suffices only 10,000 picking attempts, and <i>regardless of the complexity of the password for accessing the wireless network,</i> you automatically get this access, and with it in addition - this same password as it is. <br><br>  Considering that this interaction occurs before any security checks, you can send 10-50 login requests via WPS per second, and in 3-15 hours (sometimes more, sometimes less) you will receive the keys <s>to paradise</s> . <br><br>  When this vulnerability was revealed, manufacturers began to introduce a limit on the number of attempts to enter (rate limit), after exceeding which the access point automatically for some time disables WPS - however, until now, such devices are no more than half from those already released without this protection.  Even more - a temporary outage does not fundamentally change anything, since with one attempt to log in per minute we only need <code>10000/60/24 = 6,94</code> days.  And the PIN is usually found before the whole cycle passes. <br><br>  I want to once again draw your attention to the fact that when WPS is enabled, your password will inevitably be revealed, regardless of its complexity.  Therefore, if you need WPS at all - turn it on only when connecting to the network, and keep this backdoor off the rest of the time. <br><br>  The attack on WPS will be discussed in the second part. <br><br>  ps: since the topic is very extensive, errors and inaccuracies could creep into the material.  Instead of shouting ‚Äúthe author does not understand anything,‚Äù it is better to use comments and <a href="http://habrahabr.ru/conversations/">drugs</a> .  It will only be welcome. <br><br>  <b>Table of contents:</b> <br>  <b>1)</b> materiel <br>  <b>2)</b> <a href="http://habrahabr.ru/post/225483/">Kali.</a>  <a href="http://habrahabr.ru/post/225483/">Hiding SSID.</a>  <a href="http://habrahabr.ru/post/225483/">MAC filtering.</a>  <a href="http://habrahabr.ru/post/225483/">WPS</a> <br>  <b>3)</b> <a href="http://habrahabr.ru/post/226431/">WPA.</a>  <a href="http://habrahabr.ru/post/226431/">OpenCL / CUDA.</a>  <a href="http://habrahabr.ru/post/226431/">Pick statistics</a> </div><p>Source: <a href="https://habr.com/ru/post/224955/">https://habr.com/ru/post/224955/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../224943/index.html">Android with Intel 64-bit kernel in questions and answers</a></li>
<li><a href="../224945/index.html">Myths about programmers: indifference to strippers, dumplings and controlled chaos</a></li>
<li><a href="../224947/index.html">Dyson Halo - smart glasses 10 years before Google Glass</a></li>
<li><a href="../224949/index.html">NASA successfully tested Morpheus's landing module in the dark on rocky terrain</a></li>
<li><a href="../224953/index.html">VoIP and Internet Telephony History</a></li>
<li><a href="../224961/index.html">A cloud in pants</a></li>
<li><a href="../224963/index.html">As we collected the flying robot</a></li>
<li><a href="../224965/index.html">R * -tree or geospatial indexing</a></li>
<li><a href="../224967/index.html">jsDelivr - an advanced, open and publicly available CDN</a></li>
<li><a href="../224971/index.html">ONYX BOOX i63ML Newton - the first reader with the newest screen E-Ink Carta</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>