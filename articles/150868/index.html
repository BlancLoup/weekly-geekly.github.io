<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The main principle of good code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For twenty years of diverse programming, I formulated, I am convinced, the main principle of good code. Relying on it, I and my colleagues managed to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The main principle of good code</h1><div class="post__text post__text-html js-mediator-article">  For twenty years of diverse programming, I formulated, I am convinced, the main principle of good code.  Relying on it, I and my colleagues managed to put in order the most terrible code, to unite in a team of incompatible programmers and to maintain the system for years without too much nagging. <br><br>  Read this article: <b>15 minutes</b> <br>  Understanding the technique: <b>10 minutes</b> <br>  Tangible results: <b>30 minutes</b> <br><br><a name="habracut"></a>  So, <br><h4>  What for? </h4><br>  What about bad code? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  nothing is clear </li><li>  incomprehensible variables </li><li>  huge methods </li><li>  non-obvious algorithms </li><li>  hacks, encapsulation violations </li><li>  high complexity and confusion </li><li>  changes lead to surprises </li><li>  nothing is clear </li></ul><br>  It was not for nothing that I pointed out the same moment twice.  Indeed, almost everything comes down to the fact that the programmer cannot deal with some code. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/08c/c28/50a/08cc2850a8b5d340c85d55e9b3b62e83.jpg" alt="I wake up screaming"><br><br>  Bad code is slow to change, and changes bring surprises.  This is understandable: the programmer does not see what the code is doing, and he has to understand instead of creating something new.  Actually, it often happens that only its author is really capable of fixing a program. <br><br>  Therefore, one of the most important features of a good code is its clarity.  Understanding is a purely human notion.  The compiler doesn‚Äôt care what it is called, he doesn‚Äôt get to the point;  only person reads code.  Only a person from the name of the method can imagine what exactly the method does.  Only a person reads the name of a variable and immediately sees the essence of the data stored in it. <br><br>  I am convinced that the clarity of the code is more dependent on the names.  From the names of classes, methods, variables.  The clearer the names are formulated, and the more, the easier the code is read. <br><br>  For example, there is such a code for sending a notification to a mobile device: <br><br><pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($device)</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-comment"><span class="hljs-comment">// Can we locate the device?</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($device-&gt;token != <span class="hljs-string"><span class="hljs-string">""</span></span> &amp;&amp; $device-&gt;expire &lt;= $now) {
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>;
    }

    $modelNotifier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModelNotifier($device); 
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $modelNotifier-&gt;go();
}
</code></pre><br>
 ,   -  .     .<br>
<br>
<ul>
<li>  <code>$device?</code></li>
<li>   <code>$device-&gt;expire</code>  <code>$now</code>?         ?</li>
<li>  <code>$modelNotifier-&gt;go()</code>?</li>
</ul><br>
    .    ,       ,         <code>$device-&gt;expire</code>   ,   .     <code>ModelNotifier-&gt;go()</code>    ,   .  ,      ,       token       .         ,       .<br>
<br>
 ,          <i> :</i>          <code>token!=""</code>,          .   ,   ,      .<br>
<br>
,       .  ‚Äî .  ,        ;      ,      . ,   .<br>
<br>
  .<br>
<br>
<h4>?</h4><br>
<b>,      ‚Äî     .</b><br>
<br>
        , ,  ,   .    ,   ‚Äî   ‚Äî    .<br>
<br>
  :<br>
<br>
<pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($device)</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-comment"><span class="hljs-comment">// Can we locate the device?</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($device-&gt;token != <span class="hljs-string"><span class="hljs-string">""</span></span> &amp;&amp; $device-&gt;expire &lt;= $now) {
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>;
    }

    $modelNotifier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModelNotifier($device); 
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $modelNotifier-&gt;go();
}
</code></pre><br>
     <i></i>  ,   <i></i> ,    <i></i> : ‚Äú   ?‚Äù<br>
<br>
     :<br>
<br>
<pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ModelDevice</span></span></span><span class="hljs-function">::</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isLocatable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;token != <span class="hljs-string"><span class="hljs-string">""</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;expire &lt;= $now);
}

‚Ä¶

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">locateAndNotifyDevice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ModelDevice $device)</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$device-&gt;isLocatable()) {
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>;
    }

    $modelNotifier = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModelNotifier($device);
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $modelNotifier-&gt;go();
}
</code></pre><br>
    ,    ,  -    ,    .<br>
<br>
 .    isLocatable().     :      ,      :<br>
<br>
<ol>
<li>    ?</li>
<li>    ?</li>
</ol><br>
 :      ,    .<br>
<br>
 :<br>
<br>
<pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isDeviceExpired</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;expireAtUnixtime &gt;= $now);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isOurTokenValid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;token != <span class="hljs-string"><span class="hljs-string">""</span></span>);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isLocatable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isOurTokenValid() &amp;&amp; !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isDeviceExpired());
}
</code></pre><br>
       .     :   <code>isLocatable()</code>  , <i></i>           .  isDeviceExpired(),  , <i></i>          .<br>
<br>
     <i></i> ‚Äî     <i>.</i><br>
<br>
, ,    ,  token .  ,          :  .<br>
<br>
 , :      . Instant win!<br>
<br>
<h4>?</h4><br>
  ,       . !    ,   .<br>
<br>
<b>-,</b>   <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B5%25D1%2580%25D0%25B1%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B5_%25D1%2581%25D0%25BF%25D0%25BE%25D1%2581%25D0%25BE%25D0%25B1%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">  </a>   .       ,   ,   . ,         : .       ,    ,   .            .   , ? :)<br>
<br>
<b>-,</b>  -   (‚Äú ?‚Äù)   (‚Äú ?‚Äù) .     <code> isLocatable()</code>,         :  ,       .  ‚Äî  ,       .      ‚Äú‚Äù  <code>locateDevice()</code>,      ;  , ,   .  ‚Äî  ,     .<br>
<br>
<b>-,</b>  ,   CPU,            .    ,       ‚Äî  1/3 <sup>*</sup>.  ,   ,   .       ,      .     ,        ,      .      ,           .<br>
<br>
<sup>*</sup>300ms ‚Äî          .<br>
<br>
<h4></h4><br>
 :<br>
<br>
<pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConfig</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasOption(<span class="hljs-string"><span class="hljs-string">'configs'</span></span>)) {
        $configs = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'configs'</span></span>);
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasOption(<span class="hljs-string"><span class="hljs-string">'config'</span></span>)) {
        $configs = [ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'config'</span></span>) ];
    }

    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($configs)) {
        $root = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'root'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>);
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$root) {
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'PWD'</span></span>])) {
                $root = $_SERVER[<span class="hljs-string"><span class="hljs-string">'PWD'</span></span>];
            } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>])) {
                $root = $_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>];
            }
        }

        $configs-&gt;root = $root;
    }

    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $configs;
}
</code></pre><br>
 :         (  ),     .    :<br>
<br>
<pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">grabConfiguration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasOption(<span class="hljs-string"><span class="hljs-string">'configs'</span></span>)) {
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'configs'</span></span>);
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasOption(<span class="hljs-string"><span class="hljs-string">'config'</span></span>)) {
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'config'</span></span>) ];
    }
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">figureOutRootFolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    $root = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getOption(<span class="hljs-string"><span class="hljs-string">'root'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$root) {
        $root = $_SERVER[<span class="hljs-string"><span class="hljs-string">'PWD'</span></span>];
    }
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$root) {
        $root = $_SERVER[<span class="hljs-string"><span class="hljs-string">'DOCUMENT_ROOT'</span></span>];
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $root;
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConfigs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
    $configs = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;grabConfiguration();  
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!is_null($configs)) {
        $configs-&gt;rootFolder = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;figureOutRootFolder();        
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $configs;
}
</code></pre><br>
       iOS:<br>
<br>
<pre><code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([imageEntry objectForKey:<span class="hljs-string"><span class="hljs-string">@"fullscreenUrl"</span></span>]==<span class="hljs-literal"><span class="hljs-literal">nil</span></span>) {
    <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *kind = [imageEntry objectForKey:<span class="hljs-string"><span class="hljs-string">@"kind"</span></span>];
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([kind isEqualToString:<span class="hljs-string"><span class="hljs-string">@"pdf"</span></span>]) {
        <span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> *i = [<span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> imageNamed:<span class="hljs-string"><span class="hljs-string">@"galleryPdfIcon"</span></span>];
        [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.uiImagesCache setObject:i forKey:@(photoIndex)];
        *photoSize = NIPhotoScrollViewPhotoSizeOriginal;
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i;
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([kind isEqualToString:<span class="hljs-string"><span class="hljs-string">@"video"</span></span>]) {
        <span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> *i = [<span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> imageNamed:<span class="hljs-string"><span class="hljs-string">@"galleryVideoIcon"</span></span>];
        [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.uiImagesCache setObject:i forKey:@(photoIndex)];
        *photoSize = NIPhotoScrollViewPhotoSizeOriginal;
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i;
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {
        <span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> *i = [<span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> imageNamed:<span class="hljs-string"><span class="hljs-string">@"galleryBrokenImage"</span></span>];
        [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.uiImagesCache setObject:i forKey:@(photoIndex)];
        *photoSize = NIPhotoScrollViewPhotoSizeOriginal;
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i;
    }
}
</code></pre><br>
  ,     .    . :<br>
<br>
<pre><code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> *) genericImageForKind:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *) imageKind {
    <span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> *candidate = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>;

    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([kind isEqualToString:<span class="hljs-string"><span class="hljs-string">@"pdf"</span></span>]) {
        candidate = [<span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> imageNamed:<span class="hljs-string"><span class="hljs-string">@"galleryPdfIcon"</span></span>];
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([kind isEqualToString:<span class="hljs-string"><span class="hljs-string">@"video"</span></span>]) {
        candidate = [<span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> imageNamed:<span class="hljs-string"><span class="hljs-string">@"galleryVideoIcon"</span></span>];
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {
        candidate = [<span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> imageNamed:<span class="hljs-string"><span class="hljs-string">@"galleryBrokenImage"</span></span>];
    }

    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> candidate;
}

‚Ä¶

<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([imageEntry objectForKey:<span class="hljs-string"><span class="hljs-string">@"fullscreenUrl"</span></span>]==<span class="hljs-literal"><span class="hljs-literal">nil</span></span>) {
    <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *kind = [imageEntry objectForKey:<span class="hljs-string"><span class="hljs-string">@"kind"</span></span>];
    <span class="hljs-built_in"><span class="hljs-built_in">UIImage</span></span> *genericImage = [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> genericImageForKind:kind];
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (genericImage) {
        [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.uiImagesCache setObject:genericImage forKey:@(photoIndex)];
        *photoSize = NIPhotoScrollViewPhotoSizeOriginal;
    } 

    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>;
}
</code></pre><br>
   SQL  .       ,  ,     ,   ,     .<br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, dResults</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) {
        <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(err);
        callback(err);
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;
    }

    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>, lastDownloaded = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> unixtimes = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(dResults);
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;unixtimes.length;i++) {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dResults[unixtimes[i]].isDownloaded) { 
            lastDownloaded = unixtimes[i];
        }
    }

    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;unixtimes.length;i++) {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (unixtimes[i]&gt;lastDownloaded) {
            <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> dResults[unixtimes[i]];
        }
    }

    self.getOpenPrice(symbol, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, openPrice</span></span></span><span class="hljs-function">) </span></span>{
        callback(err, dResults, openPrice);
    });
}
</code></pre><br>
:<br>
<br>
<pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLastDownloadedUnixtime</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">entries</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastDownloadedUnixtime = <span class="hljs-literal"><span class="hljs-literal">null</span></span>;

    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> unixtimes = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(entries);
    unixtimes.forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">unixtime</span></span></span><span class="hljs-function">) </span></span>{
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (entries[unixtime].isDownloaded) { 
            lastDownloadedUnixtime = unixtime;
        }
    });

    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastDownloadedUnixtime;
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cleanupEntriesNewerThanLastDownloadedUnixtime</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">entries, lastDownloadedUnixtime</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> unixtimes = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(entries);
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;unixtimes.length;i++) {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (unixtimes[i]&gt;lastDownloadedUnixtime) {
            <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> entries[unixtimes[i]];
        }
    }
}

‚Ä¶

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, dResults</span></span></span><span class="hljs-function">) </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) {
        <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(err);
        callback(err);
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;
    }

    <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastDownloadedUnixtime = getLastDownloadedUnixtime(dResults);
    cleanupEntriesNewerThanLastDownloadedUnixtime(dResults, lastDownloadedUnixtime);

    self.getOpenPrice(symbol, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, openPrice</span></span></span><span class="hljs-function">) </span></span>{
        callback(err, dResults, openPrice);
    });
}
</code></pre><br>
 XML    Amazon S3.    ,     ,  XML  :<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;Delete&gt;\n"</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;Quiet&gt;true&lt;/Quiet&gt;\n"</span></span>);

<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;batchCount;i++) {
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *escapedPath=Deleter::xmlEscape(batch[i]);
    <span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"\t&lt;Object&gt;&lt;Key&gt;"</span></span>);
    <span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, escapedPath);
    <span class="hljs-built_in"><span class="hljs-built_in">free</span></span>(escapedPath);
    <span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;/Key&gt;&lt;/Object&gt;\n"</span></span>);
    LOG(LOG_DBG, <span class="hljs-string"><span class="hljs-string">"[Delete] %s"</span></span>, batch[i]);
}

<span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;/Delete&gt;\n"</span></span>);
</code></pre><br>
    ,    :<br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addPathToDeleteXml</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *xml, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *path)</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *escapedPath=Deleter::xmlEscape(path);
    <span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"\t&lt;Object&gt;&lt;Key&gt;"</span></span>);
    <span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, escapedPath);
    <span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;/Key&gt;&lt;/Object&gt;\n"</span></span>);
    <span class="hljs-built_in"><span class="hljs-built_in">free</span></span>(escapedPath);
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addBatchOfPathsToXml</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *xml, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> **batch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint32_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> batchCount)</span></span></span><span class="hljs-function"> </span></span>{
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;batchCount;i++) {
        addPathToDeleteXml(xml, batch[i]);
        LOG(LOG_DBG, <span class="hljs-string"><span class="hljs-string">"[Delete] %s"</span></span>, batch[i]);
    }
}

‚Ä¶

<span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n"</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;Delete&gt;\n"</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;Quiet&gt;true&lt;/Quiet&gt;\n"</span></span>);

addBatchOfPathsToXml(xml, batch, batchCount);

<span class="hljs-built_in"><span class="hljs-built_in">strcat</span></span>(xml, <span class="hljs-string"><span class="hljs-string">"&lt;/Delete&gt;\n"</span></span>);
</code></pre><br>
<br>
<h4> </h4><br>
    ,   ‚Äî  .   :       ,    - .    ,      - ,        -    ,  ,     .<br>
<br>
 ,    .      ,             .        , ,    ,   .<br>
<br>
        .   ,   .       , .      ,      .<br>
<br>
<h4> </h4><br>
       ‚Äî       .      ,       :    ,   ,   .<br>
<br>
         .       ‚Äî    ,  -   .<br>
<br>
    . ,    ,      ,          autocomplete.<br>
<br>
<b>Update:</b>    ¬´if (true) return true¬ª  , ..     ,        .</div><p>Source: <a href="https://habr.com/ru/post/150868/">https://habr.com/ru/post/150868/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150861/index.html">Apple sent invitations to the presentation on September 12</a></li>
<li><a href="../150862/index.html">Debugging Android Applications Without Java Source Code: A Few Words About Breakpoints</a></li>
<li><a href="../150863/index.html">Add Bundling and Minification to an ASP.NET Web Forms Application</a></li>
<li><a href="../150864/index.html">iPhone Style Checkbox for Twitter Bootstrap</a></li>
<li><a href="../150867/index.html">PyCharm updated to version 2.6 with class diagrams, Flask, Python 3.3 and improved CSS / Sass / LESS editor</a></li>
<li><a href="../150869/index.html">Google Chrome is four years old</a></li>
<li><a href="../150870/index.html">5000 mA journey</a></li>
<li><a href="../150871/index.html">Button with outlined (stroke) font on Android</a></li>
<li><a href="../150872/index.html">Integration of site users and forum on phpbb 3</a></li>
<li><a href="../150873/index.html">Porting games for iOS on BlackBerry PlayBook</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>