<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"My way" with MS Excel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the company where I work, users work with data using MS Excel. The main repository of information is the Oracle database. From here it is required:...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"My way" with MS Excel</h1><div class="post__text post__text-html js-mediator-article">  In the company where I work, users work with data using MS Excel.  The main repository of information is the Oracle database.  From here it is required: <br><br><ul><li>  Reporting from the database in Excel format </li><li>  Retrieve information in the form of Excel files and upload it to Oracle </li></ul><br><h4>  Problems: </h4><br>  Working with Excel is quite different from working with a regular text file.  In addition to the values, complex formulas and data loaded by links can be stored in its cells.  Also in the column with one data type values ‚Äã‚Äãof other types may occur.  In the event of any error in the cell, the information on the sheet continues to be available and only this cell will have the status Error.  There are other things that make Excel a very flexible and unique product for the user and not easy for the developer. <br><a name="habracut"></a><br>  Somehow there was a case when the head of the mouse selected part of the table in Excel and copied it to another page, asking me the question - ‚ÄúIs it really so difficult to do this only with copying to the base?  You are a Professional! ‚Äù.  After that conversation, for a while, I felt like a hamster, who was given a drop of nicotine that killed a horse.  But as time went on, and with the help of MSDN and the Internet, I became closer with MS Excel, and daily dances with a tambourine around it gave their result. <br><br>  There are many ways to read (write) data from (to) Excel, everyone has the right to choose the one that is most convenient for him, but in this article I decided to tell you about my way of working with it: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I started with Microsoft Excel ODBC Driver, used Microsoft Integration Services, wrote macros on VB.  I also used templates with ready-made macros and forced the user to work only with them.  Attempts were also made not to use MS Excel when working with the database, but they did not find understanding. <br><br><h4>  Attempts to avoid using MS Excel </h4><br><ul><li>  First of all, nobody needs replacing MS Excel with something else. </li><li>  Secondly, such attempts are perceived by others with bewilderment.  At best, such ‚Äúrevolutionaries‚Äù are stroked on the head and released home early, at worst, they are accompanied with a sympathetic look and shake their heads. </li></ul><br><h4>  What I came to: </h4><br>  At the moment, to download and upload data from the database to Excel and from Excel to the database are used: <br><ul><li>  Microsoft Reporting Services (download only) <a href="http://msdn.microsoft.com/ru-ru/library/ms159106.aspx">Link</a> </li><li>  Microsoft Office Interop Excel <a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel%2528v%3Doffice.15%2529.aspx">Link</a> </li><li>  Microsoft Open XML SDK <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D30425">Link</a> </li><li>  EPPlus <a href="http://epplus.codeplex.com/releases/view/89923">Link</a> </li></ul><br>  In addition to the above methods of working with Excel, there are others, but they were not used to solve the set tasks. <br><br><h4>  Microsoft Reporting Services </h4><br>  The tool is convenient, allows you to build reports using many different data sources and upload them to files of various formats.  Supported uploading to Excel, integrated into MS Sharepoint, has a good report editor - MS Report Builder. <br><br><h4>  Microsoft Office Interop Excel </h4><br>  Allows you to work with files * .xls and * .xlsx.  In the company where I work, it is used to load data from MS Excel 2003 files into the database.  Also, this tool can extract data from files with the * .xlsx extension (Microsoft Office Open XML format). <br><br><h4>  Microsoft Open XML SDK </h4><br>  It is used to upload to Excel in the format * .xlsx (Microsoft Office Open XML).  To ensure speed and support the ability to upload large amounts of data, work with Microsoft Office Open XML is carried out using the Simple API for XML (SAX) <a href="http://blogs.msdn.com/b/brian_jones/archive/2010/06/22/writing-large-excel-files-with-the-open-xml-sdk.aspx">Link</a> . <br><br><h4>  EPPlus </h4><br>  EPPlus allows you to upload and download data in the * .xlsx format.  Its advantage over the Open XML SDK is a more friendly API and less labor intensive.  It is much more convenient to use than the Open XML SDK.  At the moment it is used in the company in those cases where it is not necessary to use the Simple API for XML (SAX). <br><br><h4>  Conclusion </h4><br>  The C # code samples were very large, so I decided to write the Conclusion in front of them. <br>  In this article I wanted to share my experience with excel files, because  In my opinion, this is not a completely trivial task and quite common.  Initially, I wanted to describe in detail all the subtleties of the work of the tools listed above, but in the end I decided that code samples would be more useful. <br>  Thanks to everyone who could read everything I wrote about above! <br><br><h4>  Code examples </h4><br>  The code is intentionally simplified in order to isolate only the essence.  All the examples were made in a test project, in order to show how to work with it.  Various aspects of programming and error tolerance did not receive attention in it (according to the principle - ‚ÄúDo you want to go, or go?‚Äù). <br><h5>  Microsoft Office Interop Excel, download data from Excel file </h5><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveDataToBase</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">[,] arr</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// save data } private static object[,] loadCellByCell(int row, int maxColNum, _Worksheet osheet) { var list = new object[2, maxColNum + 1]; for (int i = 1; i &lt;= maxColNum; i++) { var RealExcelRangeLoc = osheet.Range[(object) osheet.Cells[row, i], (object) osheet.Cells[row, i]]; object valarrCheck; try { valarrCheck = RealExcelRangeLoc.Value[XlRangeValueDataType.xlRangeValueDefault]; } catch { valarrCheck = (object) RealExcelRangeLoc.Value2; } list[1, i] = valarrCheck; } return list; } public static void LoadExcelFiles() { Application ExcelObj = null; _Workbook ecelbook = null; try { ExcelObj = new Application(); ExcelObj.DisplayAlerts = false; const string f = @"C:\Temp\1\test.xlsx"; ecelbook = ExcelObj.Workbooks.Open(f, 0, true, 5, "", "", false, XlPlatform.xlWindows); var sheets = ecelbook.Sheets; var maxNumSheet = sheets.Count; for (int i = 1; i &lt;= maxNumSheet; i++) { var osheet = (_Worksheet) ecelbook.Sheets[i]; Range excelRange = osheet.UsedRange; int maxColNum; int lastRow; try { maxColNum = excelRange.SpecialCells(XlCellType.xlCellTypeLastCell).Column; lastRow = excelRange.SpecialCells(XlCellType.xlCellTypeLastCell).Row; } catch { maxColNum = excelRange.Columns.Count; lastRow = excelRange.Rows.Count; } for (int l = 1; l &lt;= lastRow; l++) { Range RealExcelRangeLoc = osheet.Range[(object) osheet.Cells[l, 1], (object) osheet.Cells[l, maxColNum]]; object[,] valarr = null; try { var valarrCheck = RealExcelRangeLoc.Value[XlRangeValueDataType.xlRangeValueDefault]; if (valarrCheck is object[,] || valarrCheck == null) valarr = (object[,]) RealExcelRangeLoc.Value[XlRangeValueDataType.xlRangeValueDefault]; } catch { valarr = loadCellByCell(l, maxColNum, osheet); } SaveDataToBase(valarr); } } } finally { if (ecelbook != null) { ecelbook.Close(); Marshal.ReleaseComObject(ecelbook); } if (ExcelObj != null) ExcelObj.Quit(); } }</span></span></code> </pre> <br><br><h5>  Open XML SDK, save data to database (SAX) </h5><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { OpenXMLSaveExcel.SaveDataToExcel(<span class="hljs-string"><span class="hljs-string">@"c:\temp\1\test2.xlsx"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>); }</code> </pre><br>  ... <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ExcelTest</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BadChars</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Lazy&lt;Regex&gt; ControlChars = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lazy&lt;Regex&gt;(() =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Regex(<span class="hljs-string"><span class="hljs-string">"[\x00-\x1f]"</span></span>, RegexOptions.Compiled)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FixData_Replace</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Match match</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((match.Value.Equals(<span class="hljs-string"><span class="hljs-string">"\t"</span></span>)) || (match.Value.Equals(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)) || (match.Value.Equals(<span class="hljs-string"><span class="hljs-string">"\r"</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> match.Value; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&amp;#"</span></span> + ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)match.Value[<span class="hljs-number"><span class="hljs-number">0</span></span>]).ToString(<span class="hljs-string"><span class="hljs-string">"X4"</span></span>) + <span class="hljs-string"><span class="hljs-string">";"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Fix</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> data, MatchEvaluator replacer = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> fixed_data; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (replacer != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) fixed_data = ControlChars.Value.Replace(data.ToString(), replacer); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> fixed_data = ControlChars.Value.Replace(data.ToString(), FixData_Replace); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fixed_data; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OraParameter</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ViewName; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OracleType type; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Value; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BaseColumn</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Type Type; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> colNumber; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OpenXMLSaveExcel</span></span> { SpreadsheetDocument myDoc; WorksheetPart worksheetPart; WorkbookPart workbookPart; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OpenXmlWriter writer; OpenXmlWriter sheetWriter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveDataToExcel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sheetName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OpenXMLSaveExcel(); f.SaveExcel( filename, sheetName); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveExcel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sheetName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;OraParameter&gt; { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OraParameter { Name = <span class="hljs-string"><span class="hljs-string">"param1"</span></span>, type = OracleType.VarChar, Value = <span class="hljs-string"><span class="hljs-string">"   1"</span></span>, ViewName = <span class="hljs-string"><span class="hljs-string">" 1"</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OraParameter { Name = <span class="hljs-string"><span class="hljs-string">"param2"</span></span>, type = OracleType.Number, Value = <span class="hljs-number"><span class="hljs-number">245</span></span>, ViewName = <span class="hljs-string"><span class="hljs-string">" 2"</span></span> } }; CreateExcelFile(filename); SaveData(lp, <span class="hljs-string"><span class="hljs-string">" "</span></span>); CloseExcelFile(sheetName); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">List&lt;OraParameter&gt; parameters, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> reportName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(reportName)) { OpenRow(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BaseColumn {Name = reportName, Type = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)}; SaveCells(c, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); CloseRow(); OpenRow(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> parameters) { c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BaseColumn {Name = p.ViewName, Type = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)}; SaveCells(c, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); i++; } CloseRow(); OpenRow(<span class="hljs-number"><span class="hljs-number">3</span></span>); i = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> parameters) { c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BaseColumn {Type = p.Value.GetType()}; SaveCells(c, p.Value.ToString()); i++; } CloseRow(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenRow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rowNum</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oxa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;OpenXmlAttribute&gt; {<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OpenXmlAttribute(<span class="hljs-string"><span class="hljs-string">"r"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, rowNum.ToString())}; writer.WriteStartElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Row(), oxa); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CloseRow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { writer.WriteEndElement(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveCells</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BaseColumn c, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oxa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;OpenXmlAttribute&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> exelType; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> == DBNull.Value) exelType = <span class="hljs-string"><span class="hljs-string">"str"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> exelType = getExcelType(c.Type); oxa.Add(exelType == <span class="hljs-string"><span class="hljs-string">"d"</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OpenXmlAttribute(<span class="hljs-string"><span class="hljs-string">"s"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"1"</span></span>) : <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OpenXmlAttribute(<span class="hljs-string"><span class="hljs-string">"t"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, exelType)); writer.WriteStartElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cell(), oxa); saveCellValue(c, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, exelType); writer.WriteEndElement(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saveCellValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BaseColumn c, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> exelType</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { writer.WriteElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellValue(c.Name)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> v = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> DBNull ? <span class="hljs-string"><span class="hljs-string">""</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (exelType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"n"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> DBNull) writer.WriteElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellValue()); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> writer.WriteElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellValue(v.Replace(<span class="hljs-string"><span class="hljs-string">","</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"d"</span></span>: v = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> DBNull ? <span class="hljs-string"><span class="hljs-string">""</span></span> : Convert.ToDateTime(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).ToOADate().ToString(); writer.WriteElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellValue(v)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: writer.WriteElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellValue(BadChars.Fix(v))); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CloseExcelFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sheetName</span></span></span><span class="hljs-function">)</span></span> { writer.WriteEndElement(); writer.WriteEndElement(); writer.Close(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheetIds = myDoc.WorkbookPart.GetIdOfPart(worksheetPart); sheetWriter = OpenXmlWriter.Create(myDoc.WorkbookPart); sheetWriter.WriteStartElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Workbook()); sheetWriter.WriteStartElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sheets()); sheetWriter.WriteElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sheet() { Name = sheetName, SheetId = <span class="hljs-number"><span class="hljs-number">1</span></span>, Id = sheetIds }); sheetWriter.WriteEndElement(); sheetWriter.WriteEndElement(); sheetWriter.Close(); myDoc.Close(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateExcelFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filename</span></span></span><span class="hljs-function">)</span></span> { myDoc = SpreadsheetDocument.Create(filename, SpreadsheetDocumentType.Workbook); workbookPart = myDoc.AddWorkbookPart(); ApplyStylesheet(workbookPart); worksheetPart = workbookPart.AddNewPart&lt;WorksheetPart&gt;(); writer = OpenXmlWriter.Create(worksheetPart); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> worksheet = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Worksheet() { MCAttributes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkupCompatibilityAttributes() { Ignorable = <span class="hljs-string"><span class="hljs-string">"x14ac"</span></span> } }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ns = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(); ns[<span class="hljs-string"><span class="hljs-string">"r"</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/officeDocument/2006/relationships"</span></span>; ns[<span class="hljs-string"><span class="hljs-string">"mc"</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span>; ns[<span class="hljs-string"><span class="hljs-string">"x14ac"</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> attr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;OpenXmlAttribute&gt; {<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OpenXmlAttribute(<span class="hljs-string"><span class="hljs-string">"mc:Ignorable"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"x14ac"</span></span>)}; writer.WriteStartElement(worksheet, attr, ns); writer.WriteStartElement(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SheetData()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> WorkbookStylesPart </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ApplyStylesheet</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WorkbookPart workbookPart</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> workbookStylesPart = workbookPart.AddNewPart&lt;WorkbookStylesPart&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stylesheet1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Stylesheet() { MCAttributes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkupCompatibilityAttributes() { Ignorable = <span class="hljs-string"><span class="hljs-string">"x14ac"</span></span> } }; stylesheet1.AddNamespaceDeclaration(<span class="hljs-string"><span class="hljs-string">"mc"</span></span>, <span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span>); stylesheet1.AddNamespaceDeclaration(<span class="hljs-string"><span class="hljs-string">"x14ac"</span></span>, <span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/**/</span></span> Fonts fonts = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Fonts() { Count = (UInt32Value)<span class="hljs-number"><span class="hljs-number">1U</span></span>, KnownFonts = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }; Font font = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Font(); FontSize fontSize = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FontSize() { Val = <span class="hljs-number"><span class="hljs-number">11</span></span>D }; Color color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color() { Theme = (UInt32Value)<span class="hljs-number"><span class="hljs-number">1U</span></span> }; FontName fontName = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FontName() { Val = <span class="hljs-string"><span class="hljs-string">"Calibri"</span></span> }; FontFamilyNumbering fontFamilyNumbering = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FontFamilyNumbering() { Val = <span class="hljs-number"><span class="hljs-number">2</span></span> }; FontCharSet fontCharSet = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FontCharSet() { Val = <span class="hljs-number"><span class="hljs-number">204</span></span> }; FontScheme fontScheme = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FontScheme() { Val = FontSchemeValues.Minor }; font.Append(fontSize); font.Append(color); font.Append(fontName); font.Append(fontFamilyNumbering); font.Append(fontCharSet); font.Append(fontScheme); fonts.Append(font); <span class="hljs-comment"><span class="hljs-comment">/*************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/**/</span></span> Fills fills = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Fills() { Count = (UInt32Value)<span class="hljs-number"><span class="hljs-number">1U</span></span> }; Fill fillNone = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Fill(); PatternFill patternFillNone = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PatternFill() { PatternType = PatternValues.None }; fillNone.Append(patternFillNone); fills.Append(fillNone); <span class="hljs-comment"><span class="hljs-comment">/*************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/**/</span></span> Borders borders = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Borders() { Count = (UInt32Value)<span class="hljs-number"><span class="hljs-number">1U</span></span> }; Border border = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Border(); LeftBorder leftBorder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LeftBorder(); RightBorder rightBorder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RightBorder(); TopBorder topBorder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopBorder(); BottomBorder bottomBorder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BottomBorder(); DiagonalBorder diagonalBorder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DiagonalBorder(); border.Append(leftBorder); border.Append(rightBorder); border.Append(topBorder); border.Append(bottomBorder); border.Append(diagonalBorder); borders.Append(border); <span class="hljs-comment"><span class="hljs-comment">/*************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/**/</span></span> CellFormats cellFormats = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellFormats() { Count = (UInt32Value)<span class="hljs-number"><span class="hljs-number">3U</span></span> }; CellFormat stringCellFormat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellFormat() { NumberFormatId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, FontId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, FillId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, BorderId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, FormatId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span> }; CellFormat dateCellFormat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellFormat() { NumberFormatId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">14U</span></span>, FontId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, FillId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, BorderId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, FormatId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, ApplyNumberFormat = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }; CellFormat numberCellFormat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CellFormat() { NumberFormatId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">2U</span></span>, FontId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, FillId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, BorderId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, FormatId = (UInt32Value)<span class="hljs-number"><span class="hljs-number">0U</span></span>, ApplyNumberFormat = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }; cellFormats.Append(stringCellFormat); cellFormats.Append(dateCellFormat); cellFormats.Append(numberCellFormat); <span class="hljs-comment"><span class="hljs-comment">/*************/</span></span> stylesheet1.Append(fonts); stylesheet1.Append(fills); stylesheet1.Append(borders); stylesheet1.Append(cellFormats); workbookStylesPart.Stylesheet = stylesheet1; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> workbookStylesPart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getExcelType</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Type Type</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Type == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"str"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Type == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(DateTime)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"d"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"n"</span></span>; } } }</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/235903/">https://habr.com/ru/post/235903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235889/index.html">A selection of entertaining CSS recipes "Naked Fridays # 2"</a></li>
<li><a href="../235893/index.html">CSS GuideLines, part 2. Commenting code</a></li>
<li><a href="../235895/index.html">The digest of interesting materials for mobile developer # 69 (September 1-7)</a></li>
<li><a href="../235899/index.html">Digest of domestic projects on Kickstarter ‚Ññ 5</a></li>
<li><a href="../235901/index.html">Top Sublime Text Plugins</a></li>
<li><a href="../235907/index.html">School of 3D solutions for students: what's inside and how to get to study for free</a></li>
<li><a href="../235909/index.html">First All-Russian Olympiad of Schoolchildren on Programming (Informatics) 1989</a></li>
<li><a href="../235913/index.html">nanoCAD becomes available in a virtual environment thanks to NVIDIA GRID</a></li>
<li><a href="../235915/index.html">Sorry - Weekend Project</a></li>
<li><a href="../235917/index.html">We develop habraklaviatura under iOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>