<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigation of security incidents with StaffCop Enterprise 4.4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My name is Roman Frank, I am a specialist in information security. More recently, I worked in a large company in the security department (techn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Investigation of security incidents with StaffCop Enterprise 4.4</h1><div class="post__text post__text-html js-mediator-article">  Hello!  My name is Roman Frank, I am a specialist in information security.  More recently, I worked in a large company in the security department (technical protection).  I had 2 problems: there were no normal modern technical means of protection and money for security in the budget.  But I had free time to study software solutions, about one of them - StaffCop Enterprise - I want to tell you in detail today. <br><br>  Experience has shown me that 90% of the time I spent on identifying and investigating information leaks myself, with the program is solved in a few minutes.  I was so deep in technical details of the solution that I eventually left my company and now I work at StaffCop for the position of a technical support specialist. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m0/-u/bl/m0-ublkjfhtmls6oufulk51snxy.png"></div><a name="habracut"></a><br><h3>  <font color="#2e74b5">Let's understand StaffCop Enterprise</font> </h3><br>  <b>StaffCop Enterprise</b> is a system for monitoring employee actions with DLP functionality. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The program is capable of: <br><br><ul><li>  ensure information security in the company (detects information leaks and investigates incidents); </li><li>  monitor employee actions (keeps records of working time, evaluates employee productivity, conducts behavioral analysis, monitors business processes); </li><li>  conduct remote administration (administration of workplaces, inventory of computers). </li></ul><br><img src="https://habrastorage.org/webt/bi/dd/9f/bidd9fmryuto0t39vpxqr_szqrg.png"><br><br>  In my opinion, a tangible advantage is the lack of the need to close on a local network with the inability to work via the Internet.  Since it is now difficult to talk about the perimeter of information security (in any company there are remote branches or employees on freelance), gateway solutions are not so flexible and, often, require an agent at the user's workstation. <br><br>  This task of full control of workstations outside the local network of StaffCop easily copes.  The stack of technologies used in the development allows the system to be less demanding of resources and easy to integrate with other systems, and developers - if necessary, modify the functionality.  Also, in the near future a distribution kit with a certificate of FSTEC will be released, which is suitable for protecting objects where protection class 4 and below is needed.  All this allows the system to be profitable, reliable and useful to various specialists. <br><br>  Let's start with the most important thing.  <b>How can the StaffCop system make life safer?</b>  Let us examine the main headaches of a person whose task is to prevent the explosion of powder barrels.  The powder keg may be limited access information that has become known outside the company.  Accordingly, the main concern is not to leave.  And if it's gone, then how to find the attacker and punish. <br><br><h3>  <font color="#2e74b5">Confidential Information Control</font> </h3><br>  Staffcop controls all major information transfer channels from user PCs to Windows.  The Linux agent is moving in the same direction, but for now there is a need for network monitoring. <br><br><ol><li>  <b>Control file operations / special file control.</b>  If you have determined which files should be protected from prying eyes, the settings allow you to intercept any operations with these files, including copying, printing, saving in another place, etc. If anyone makes changes to such files or title, a shadow copy of the document will be created.  It is worth emphasizing that if an organization has a list of confidential information, then employees must sign a non-disclosure agreement and, more importantly, this agreement should clarify that personal computers are company property and the data processed behind these PCs can be copied, can be stored and processed by security personnel. </li><li>  <b>Control removable media.</b>  A flash drive is the most popular way to merge information.  Staffcop allows you to set up monitoring of USB devices.  This means that as soon as someone uses a USB flash drive, the security technician in the event tape shows the fact of connecting the removable device.  Moreover, any files sent to removable media will be intercepted.  You can always restore a complete picture of how exactly the database was copied or other confidential information.  If there is a need, and in large organizations it is always there, you can prohibit all devices, except those allowed, on the white list.  These settings allow you to work with locks on users' PCs, as well as on the users themselves.  In addition, there is a control of device types, for example, you can unlock removable hard drives, and USB-carriers to block. </li><li>  <b>Control network traffic / special control sites</b> .  StaffCop controls all user activity on the network.  To control network traffic, a certificate substitution method is used, thanks to this substitution, all traffic that goes through an https connection is intercepted.  By default, it is encrypted with the TLS protocol, but thanks to the substitution, it can be decrypted, intercepted the correspondence and thus closes one of the most important channels of information leakage - the Internet. </li><li>  <b>Interception of mail.</b>  You can intercept the body of the letter, the mailing list, including a copy and a hidden copy, as well as all attachments.  Mail control is implemented in several areas: webmail control, mail control that uses POP3, POP3S, SMTP, SMTPS, IMAP, IMAPS, MAPI protocols ... If you don‚Äôt have your option here, let us know! </li><li>  <b>Control of instant messengers.</b>  The main feature of the interception, which allows you not to be attached to the sources of instant messengers - the binding of all events to each other.  Accordingly, specifying the application WhatsApp, we get all the screenshots for this application and keyboard input.  You can filter related events by time.  Similarly with web messengers.  I would also recommend setting up a special control of the sites of instant messengers, whereby screenshots are taken every few seconds if the user is on such a site. </li><li>  <b>Application startup and installation control / special program control.</b>  You will always know what programs employees use.  You can filter out those applications that are not valid in your organization and block them.  StaffCop allows you to track users who install and run illegitimate software or, for example, work in AutoCAD or in other corporate software for personal purposes, executing orders from third-party customers.  As well as for sites, you can configure selective enhanced control: if an employee launches a certain application, screenshots with an increased frequency will be taken, for example, every 2 seconds. </li><li>  <b>Control printers.</b>  For you now will not be a secret where the paper goes.  Events of sending documents for printing are fixed, with shadow copy enabled, a shadow copy of printed documents will be made. </li></ol><br><img src="https://habrastorage.org/webt/za/wz/ly/zawzlyffwm81c6i-1jgcwlbuye4.png"><br><br><h3>  <font color="#2e74b5">Search for potential leaks</font> </h3><br>  Organizational measures are good exactly as long as they are implemented, in other cases, technical protection measures are a must. <br><br><ol><li>  Do your colleagues use personal mail and cloud services to send work files?  There is a special filter that allows you to track all mail that is not sent from the corporate domain.  You can see that the person uses personal mail, intercept the message, notice leaks.  Implemented interception of documents sent to the cloud.  If an employee uploads a document there, his shadow copy is saved. <br><br><img src="https://habrastorage.org/webt/5x/pr/u5/5xpru5sytgnln-dbmhju2qeb0f0.png"><br><br>  You can filter all users who sent messages not from corporate email.  This is especially important because, as soon as the document went online, you no longer control it.  It is important to remember that not all plums of information are committed by malicious intent.  Banal user mistakes can cost a lot of money for the organization. </li><li>  Do you know with whom your employees communicate during working hours?  You have the right to know this if you warned them.  There is a special graph that allows you to see the relationship between users via any channels of communication.  The most popular case is confidential information.  File names are known.  Thanks to this column, you can always track who sent the documents to which addresses.  As soon as the document has left the organization, it becomes clearly visible.  Such a report is suitable for a manager who wants to see the result of the work of a security man and who does not want to understand all the filters, flows of information and data.  He just needs some final report, preferably a small one, where you can see the file name, the sending channel, the external address. <br><br><img src="https://habrastorage.org/webt/nf/06/pm/nf06pmu2doxyqomnzouocd9zggu.png"><br></li><li>  Dictionaries.  You can set up sending notifications when using offensive language, and thus track splashes of negativity and take action.  Especially if users work with customers - it is unacceptable that they use profanity in communication. <br><br><img src="https://habrastorage.org/webt/vl/3b/0e/vl3b0epcl6tpnkns6bfg2madgqq.png"><br></li><li>  Personal cards of employees.  The personal card contains all the information for a specific user.  For example, for which computer it works, top sites, top applications that it launches, search requests, intercepted files, recent screenshots.  You can track the graph of communications - communication with other employees within the organization: with whom it communicates more often, through which channels of communication.  This is a kind of dossier, a personal matter, from which you can get general information about the employee.  Such cards can be created not only for people, but also for files, computers.  Employee cards are well suited for investigating incidents.  As an introduction to the user. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/209/9a4/409/2099a4409f43f6dc36624bbe7e678691.png" alt="image"><br></li><li>  A user behavior anomaly detector is used to detect leaks.  Drastic change in employee behavior is a reason to pay attention.  The StaffCop Enterprise detector is configured by default to exceed the average occurrence of an event by 10 times.  The most popular case is an increase in copy operations.  For example, there was a case of fixing copying a large number of documents to a USB-drive.  Additionally, it was revealed that information was copied from the closed network segment, which is necessary for working with drawings marked ‚ÄúConfidential‚Äù.  Further, physical information protection measures and security services come into effect.  Employee detained for further investigation.  Anomaly detector will significantly reduce the time to detect incidents for which it is difficult or impossible to set up an automatic filter. <br><br><img src="https://habrastorage.org/webt/bn/of/s8/bnofs8_y_kkwov2terpfdtybyk0.png"><br></li></ol><br><h3>  <font color="#2e74b5">Closing holes</font> </h3><br>  Not always passive protection measures are a cheap substitute for active protective equipment.  In our case, Staffcop is an active means of protection and allows you to monitor and close some channels of information leaks. <br><br><ol><li>  We block personal USB drives and CDs.  The organization may prohibit the use of personal removable media.  A so-called ‚Äúwhite list‚Äù of allowed devices is entered, and all other carriers that are not included in it will be blocked. <br><br><img src="https://habrastorage.org/webt/fb/6l/up/fb6lup5gbfyujakqukoskbhz5sw.png"><br></li><li>  We block access to "unproductive" sites or allow only "productive".  You can set rules for blocking sites by address.  Blocking rules work on a substring - it is not necessary to specify exact addresses and domains.  You can do without the products that are used for blocking sites. </li><li>  We block the launch of applications.  You can make a list of applications that can be blocked, or vice versa, use only allowed ones.  When creating a closed software environment, you need to be very careful about the list of allowed applications.  In case of an error, the login can be blocked. </li><li>  Configure alerts for malicious actions.  For any events that we consider an incident, you can build a filter and set up an alert.  The list of such events is determined independently by the customer at the testing stage.  For example, copying to a USB-drive is considered malicious if, for some reason, it is impossible to set up a white list.  Such events are recorded, the report is sent with a specified frequency, for example, every day or once a week.  You can set up an immediate alert when a certain event occurs. </li></ol><br><h3>  <font color="#2e74b5">Incident Investigation</font> </h3><br>  When investigating incidents, the evidence base is very important.  Staffcop allows you to keep a history of all events that were committed by the user during monitoring. <br><br><ol><li>  Incident or not incident?  It is necessary to look in more detail.  There is an event communication system and the construction of multidimensional reports, the ‚ÄúDrill-down‚Äù technique.  All events are interrelated with each other, for example, interception of web forms is associated with site visits, when a person enters a login and password into a web form when entering a site, this information can be intercepted.  If interception of this form is enabled, then we will see not only what was in these forms, but also the site on which the form was entered.  "Drill-down" is a failure, that is, you can detail the information on the event and see the related events. <br><br>  StaffCop uses the OLAP technology (multidimensional cube).  Thanks to the use of hybrid mode with two databases, the user gets excellent results on performance.  Reports, which in other systems are formed for several hours, StaffCop Enterprise generates in a few (tens) seconds.  From the report, you can clarify any information associated with a particular event. </li><li>  Microphone recording, desktop video and screenshots are used to understand the context of events.  For example, a specific filter worked, an event occurred, but its context is incomprehensible.  Microphone recording and desktop video recording are two modules that are disabled by default.  Sound is recorded in short lengths of 10 minutes (you can put more or less), while silence is not recorded.  You can also record video.  Each event is saved with a time stamp.  If the desktop video recording module is enabled, everything that happens on the desktop is recorded.  It should be understood that the storage of large amounts of information is expensive.  This function can be used pointwise, for example, if a certain employee came under suspicion, you can put such a module on it and monitor everything that happens.  Screenshots are used when special control of sites and programs is required.  With the help of these modules, any event can be detailed in parts.  Fine-tuning will allow to select for the investigation of incidents only those modules that will allow step by step to identify not only the fact of information leakage and the causes, but also, possibly, additional involved persons and events. <br><br><img src="https://habrastorage.org/webt/m5/w4/tm/m5w4tmpthffxzuiswad_appe_f4.png"><br></li><li>  Fast reporting.  The product uses a hybrid database PostgreSQL + ClickHouse, thanks to which, the construction of reports is very fast.  The disadvantage of ClickHouse is resource requirements.  For example, the server must have at least 16 GB of RAM, 8 or 16 cores, so this solution is only used for systems with a large number of agents.  In such systems, many events occur, and in order to quickly load them, ClickHouse is needed.  If PostgreSQL is used, the problem arises: if there are several tens of millions of events in the database, then there is a delay in uploading to the web console up to 1 minute, but if you constantly refresh the page, then all new events will fall into the event lens. <br><br>  Sometimes a hybrid mode is used when two databases are running at the same time.  It should be noted that the StaffCop Enterprise system does not use cloud technologies, except ABBYY, a cloud service for text recognition. </li></ol><br>  I believe that StaffCop is the main tool in the hands of a security guard, which will save time for security and money for company management. <br><br>  Resource requirements <a href="https://www.staffcop.ru/system-requirements">can be found here</a> . <br>  <a href="https://docs.staffcop.ru/ru/4.4/">Installation details</a> . <br>  And if you want to drive the system in test mode and see for yourself whether StaffCop is right for you, you can <a href="https://www.staffcop.ru/download">send a request here</a> or <a href="https://store.softline.ru/atom-bezopasnost/staffcop-enterprise/">through our partner</a> . <br><br><br>  Roman Frank, <br>  StaffCop technical support specialist </div><p>Source: <a href="https://habr.com/ru/post/432800/">https://habr.com/ru/post/432800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432790/index.html">Superconductor + ferromagnet: the study of triplet Cooper pairs</a></li>
<li><a href="../432792/index.html">Roskomnadzor fined Google 500 thousand rubles</a></li>
<li><a href="../432794/index.html">Bret Victor: A few words about Douglas Engelbart</a></li>
<li><a href="../432796/index.html">Compute Module, 2019 models</a></li>
<li><a href="../432798/index.html">Best OS for Security: Comparing Titans</a></li>
<li><a href="../432802/index.html">Six free automated platforms for learning programming</a></li>
<li><a href="../432804/index.html">The whole truth about the RTOS. Article # 24. Queues: helper services and data structures</a></li>
<li><a href="../432806/index.html">Sverhintelekt: an idea that does not give rest to intelligent people</a></li>
<li><a href="../432808/index.html">Salaries in AI: where more money and who are looking for in Russia</a></li>
<li><a href="../432810/index.html">First GDPR penalties: who has already been punished</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>