<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parse it!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago I had to do a little research work. Its essence was to find the best pdf parser implemented in java. 

 A little bit about the project. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parse it!</h1><div class="post__text post__text-html js-mediator-article">  Some time ago I had to do a little research work.  Its essence was to find the best pdf parser implemented in java. <br><br>  A little bit about the project.  It implements a system for forwarding internal messages to which files can be attached.  There is also a search that should be carried out on the contents of the attachments.  Most of these attachments are pdfs. <br>  Actually, the operation of the mechanism is quite simple: when sending a message, the attachment data is parsed and the index is left on it. <br><br>  For a long time, documents were parsed with the help of the PDFBOX library, whose work did not cause anyone to be happy: long and malfunctioning. <br>  As a result, 4 libraries were selected, the comparison of which I did: PDFBOX, JPod, iText and Acrobat. <br><a name="habracut"></a><br>  The acrobat was eliminated almost immediately, since  it turned out that this library has not been maintained for several years, but the statistics on it has remained, so I will publish it too. <br>  Libraries had to be compared according to two criteria - the speed of work and the quality of the results obtained. <br>  I'll warn you right away: the libraries were tested on internal documents, and they fall under a certain security level.  So I can‚Äôt even give names.  I can only say one thing - the content of the files was the most diverse: the text, tables of pictures, scans, and so on.  File sizes are also quite different, so we can expect objective assessments. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Estimated time: </h2><br><table><tbody><tr><td><h4>  file size </h4></td><td><h4>  PDFBOX </h4></td><td><h4>  Acrobat </h4></td><td><h4>  JPOD </h4></td><td><h4>  iText </h4></td></tr><tr><td>  74.1 KB </td><td>  00: 02.591 </td><td>  <font color="red">00: 03.155</font> </td><td>  00: 01.683 </td><td>  <font color="green">00: 00.963</font> </td></tr><tr><td>  257.5 KB </td><td>  00: 01.680 </td><td>  <font color="red">00: 03.191</font> </td><td>  00: 00.116 </td><td>  <font color="green">00: 00.78</font> </td></tr><tr><td>  1.6 MB </td><td>  <font color="red">00: 05.805</font> </td><td>  00: 02.884 </td><td>  00: 02.532 </td><td>  <font color="green">00: 02.79</font> </td></tr><tr><td>  28.1 MB </td><td>  <font color="red">E</font> </td><td>  <font color="red">01: 10.983</font> </td><td>  <font color="green">00: 43.815</font> </td><td>  <font color="red">E</font> </td></tr><tr><td>  13.6 MB </td><td>  <font color="red">00: 05.218</font> </td><td>  00: 04.331 </td><td>  00: 00.599 </td><td>  <font color="green">00: 00.77</font> </td></tr><tr><td>  1.9 MB </td><td>  00: 02.782 </td><td>  <font color="red">00: 14.506</font> </td><td>  <font color="green">00: 00.608</font> </td><td>  00: 00.707 </td></tr><tr><td>  1.6 MB </td><td>  <font color="red">00: 06.182</font> </td><td>  00: 02.98 </td><td>  <font color="green">00: 00.906</font> </td><td>  00: 02.413 </td></tr><tr><td>  8.9 MB </td><td>  <font color="red">00: 05.98</font> </td><td>  00: 03.894 </td><td>  00: 00.680 </td><td>  <font color="green">00: 00.647</font> </td></tr><tr><td>  2.4 MB </td><td>  <font color="red">00: 14.15</font> </td><td>  00: 07.893 </td><td>  <font color="green">00: 02.826</font> </td><td>  <font color="red">E</font> </td></tr><tr><td>  604.7 KB </td><td>  00: 03.342 </td><td>  <font color="red">00: 04.721</font> </td><td>  <font color="green">00: 00.551</font> </td><td>  00: 01.222 </td></tr><tr><td>  100.6 KB </td><td>  00: 01.819 </td><td>  <font color="red">00: 04.212</font> </td><td>  <font color="green">00: 00.84</font> </td><td>  00: 00.456 </td></tr><tr><td>  1.6 MB </td><td>  <font color="red">00: 05.633</font> </td><td>  00: 03.99 </td><td>  <font color="green">00: 00.883</font> </td><td>  00: 02.18 </td></tr><tr><td>  10.3 MB </td><td>  00: 22.311 </td><td>  <font color="green">00: 22.145</font> </td><td>  <font color="red">00: 27.663</font> </td><td>  <font color="red">E</font> </td></tr><tr><td>  1.9 MB </td><td>  00: 06.943 </td><td>  <font color="red">00: 14.736</font> </td><td>  <font color="green">00: 01.200</font> </td><td>  <font color="red">E</font> </td></tr><tr><td>  2.1 MB </td><td>  <font color="red">00: 02.573</font> </td><td>  <font color="red">E</font> </td><td>  00: 00.498 </td><td>  <font color="green">00: 00.475</font> </td></tr><tr><td>  111.0 KB </td><td>  00: 01.956 </td><td>  <font color="red">00: 02.846</font> </td><td>  00: 00.705 </td><td>  <font color="green">00: 00.300</font> </td></tr><tr><td>  814.3 KB </td><td>  00: 02.552 </td><td>  <font color="red">00: 04.221</font> </td><td>  <font color="green">00: 00.306</font> </td><td>  00: 00.900 </td></tr><tr><td>  2.0 MB </td><td>  00: 06.319 </td><td>  <font color="red">00: 07.128</font> </td><td>  <font color="green">00: 01.821</font> </td><td>  00: 02.796 </td></tr><tr><td>  338.7 KB </td><td>  00: 01.950 </td><td>  <font color="red">00: 03.684</font> </td><td>  <font color="green">00: 00.79</font> </td><td>  00: 00.415 </td></tr><tr><td>  12.9 MB </td><td>  <font color="red">00: 15.932</font> </td><td>  00: 13.628 </td><td>  <font color="green">00: 04.989</font> </td><td>  <font color="red">E</font> </td></tr><tr><td>  7.3 MB </td><td>  <font color="red">E</font> </td><td>  <font color="red">00: 17.275</font> </td><td>  <font color="green">00: 16.377</font> </td><td>  <font color="red">E</font> </td></tr><tr><td>  97.2 MB </td><td>  <font color="red">00: 27.291</font> </td><td>  <font color="green">00: 01.994</font> </td><td>  00: 05.739 </td><td>  <font color="red">E</font> </td></tr><tr><td>  5.2 MB </td><td>  00: 07.773 </td><td>  <font color="red">00: 11.108</font> </td><td>  <font color="green">00: 01.964</font> </td><td>  <font color="red">E</font> </td></tr><tr><td colspan="5"></td></tr><tr><td colspan="5">  Total: </td></tr><tr><td>  Best </td><td>  0 </td><td>  2 </td><td>  14 </td><td>  7 </td></tr><tr><td>  Middle </td><td>  12 </td><td>  7 </td><td>  eight </td><td>  eight </td></tr><tr><td>  Worst (including errors) </td><td>  eleven </td><td>  14 </td><td>  one </td><td>  eight </td></tr><tr><td colspan="5"></td></tr><tr><td>  Errors </td><td>  2 </td><td>  one </td><td>  0 </td><td>  eight </td></tr></tbody></table><br>  The worst and best times are highlighted in red and green respectively.  The letter ‚ÄúE‚Äù indicates the state of permanent collapse, overtaking the process due to buffer overflow or any other errors. <br>  In comparison, the objective winner was JPod.  Pleased by the lack of errors when parsing. <br><br><h2>  Quality control: </h2><br>  Quality assessment was rather subjective and was divided into only 3 categories: Best, Middle and Worst.  There is also an Empty score, which was set if a collapse occurred during the parsing process, or simply the parser did not find the text inside the document. <br>  The similarity of the received text with the original was assessed, but not very critical, because  the text was needed for the index, not for the output. <br><table><tbody><tr><td><h4>  file size </h4></td><td><h4>  PDFBOX </h4></td><td><h4>  Acrobat </h4></td><td><h4>  JPOD </h4></td><td><h4>  iText </h4></td></tr><tr><td>  74.1 KB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td></tr><tr><td>  257.5 KB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  1.6 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td><td>  <font color="red">Empty</font> </td><td>  <font color="red">Worst</font> </td></tr><tr><td>  28.1 MB </td><td>  <font color="red">Empty</font> </td><td>  Middle </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  13.6 MB </td><td>  <font color="red">Empty</font> </td><td>  <font color="red">Empty</font> </td><td>  <font color="red">Empty</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  1.9 MB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  <font color="red">Worst</font> </td><td>  Middle </td></tr><tr><td>  1.6 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td><td>  <font color="red">Worst</font> </td><td>  <font color="red">Worst</font> </td></tr><tr><td>  8.9 MB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  Middle </td><td>  <font color="green">Best</font> </td></tr><tr><td>  2.4 MB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  <font color="red">Worst</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  604.7 KB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  Middle </td><td>  Middle </td></tr><tr><td>  100.6 KB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  1.6 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td><td>  <font color="red">Worst</font> </td><td>  <font color="red">Worst</font> </td></tr><tr><td>  10.3 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  1.9 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  2.1 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  111.0 KB </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td></tr><tr><td>  814.3 KB </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Worst</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td></tr><tr><td>  2.0 MB </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td></tr><tr><td>  338.7 KB </td><td>  Middle </td><td>  Middle </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  12.9 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  7.3 MB </td><td>  <font color="red">Empty</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  97.2 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  Middle </td><td>  <font color="red">Empty</font> </td></tr><tr><td>  5.2 MB </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="green">Best</font> </td><td>  <font color="red">Empty</font> </td></tr><tr><td colspan="5"></td></tr><tr><td colspan="5">  Total: </td></tr><tr><td>  Best </td><td>  nineteen </td><td>  eight </td><td>  14 </td><td>  five </td></tr><tr><td>  Middle </td><td>  one </td><td>  ten </td><td>  3 </td><td>  2 </td></tr><tr><td>  Worst (including empty) </td><td>  3 </td><td>  five </td><td>  6 </td><td>  sixteen </td></tr><tr><td colspan="5"></td></tr><tr><td>  Empty </td><td>  3 </td><td>  four </td><td>  2 </td><td>  13 </td></tr></tbody></table><br><br>  Characteristics of parsing: <br>  Acrobat very often parses the text in one line.  Spaces between words and sentences are preserved, so in principle this is not critical for indexing. <br>  iText does not understand "non-English" characters.  In the test used the documents in English, German and French.  Therefore, all their umlauts went to the forest.  I didn‚Äôt even just have to go to the forest - instead of these symbols, I received question marks.  Perhaps this is somewhere configurable, but the rest understood similar symbols without dancing with a tambourine. <br>  PDFBOX for quality did not cause complaints. <br>  JPod - everything is ok too.  Except for one feature that made tinker with it for quite some time.  In some cases, the document is completely or partially parsed one letter per line - for the index, such parsing is useless. <br><br>  As a result, JPod was declared the winner, despite its peculiarity of parsing by letter in a row. <br>  We had to deal with this. <br><br><h1>  Part two.  Inside JPod. </h1><br>  It took a lot of time to tinker with source JPod.  Letters, project forum.  As a result, it was found that this behavior of the parser is caused by the orientation of the document pages.  Portrait orientation is normal, but landscape orientation is not.  Attempts to pick the parameters yielded nothing.  The class properties responsible for page orientation were useless. <br>  In general, at one of the moments I decided to simply remove from the classes all work with fonts.  Anyway, they are not needed for text indexing.  It helped because  blocks of text were calculated incorrectly, and it was caused by fonts. <br>  Here I would stop, but <a href="https://habrahabr.ru/users/egiptyanin/" class="user_link">Egiptyanin</a> insisted on the need to reach the end.  Then I almost did not participate. <br>  The solution was found, and in this form is used: the affine transformation matrix was redefined.  Instead of a dynamic matrix, a static one was set.  The CSPlainTextExtractor class was used instead of the CSTextExtractor.  The new class has the following form: <br><br> <code>public class CSPlainTextExtractor extends CSTextExtractor { <br> public void textSetTransform(float a, float b, float c, float d, float e, float f) { <br> super.textSetTransform(1, 0, 0, 1, 0, 0); <br> } <br> } <br></code> <br>  Of course, this is not a panacea and very rarely the parser does not add hyphenation to the necessary places, but this is not important for indexing. <br><br>  Actually, everything.  Thank you for your attention =) <br><br>  PS This is my first more or less serious article, I hope for objective criticism. <br><br>  <b>Upd</b> Particularly attentive readers found inconsistencies in the tables - fixed. </div><p>Source: <a href="https://habr.com/ru/post/57076/">https://habr.com/ru/post/57076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../57070/index.html">Automatic fotozhabilka - we could do it)</a></li>
<li><a href="../57071/index.html">Windows promo video</a></li>
<li><a href="../57072/index.html">Untangle Gateway, 6.1 release released</a></li>
<li><a href="../57073/index.html">MSI - warranty repair in Serso</a></li>
<li><a href="../57075/index.html">Some impressions from the test drive of Ubuntu 9.04 beta</a></li>
<li><a href="../57077/index.html">BarCamp Central Asia 2009 promo video</a></li>
<li><a href="../57078/index.html">Spam protection with captcha</a></li>
<li><a href="../57080/index.html">Update online fb2 ‚Üí lrf converter</a></li>
<li><a href="../57082/index.html">Automatic habrakat</a></li>
<li><a href="../57085/index.html">Squid for the smallest. Part 4 We cut the channel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>