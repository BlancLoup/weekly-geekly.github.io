<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jet9 test results and service commissioning</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Two months ago, we began a public beta test of web hosting on the Jet9 platform. During this time, with the help of test participants, we checked the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jet9 test results and service commissioning</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://jet9.ru/"><img src="https://habrastorage.org/files/aab/cf7/5bb/aabcf75bba574f18bf1404a8b88caab1.jpg" align="right"></a>  Two months ago, we began a public beta test of web hosting on the <a href="http://jet9.ru/">Jet9</a> platform.  During this time, with the help of test participants, we checked the operation of the platform's subsystems: a fault-tolerant cluster, CDN and web accelerators, the environment of the web hosting sites, and received assessments of user interaction with the platform.  In some cases, the expected results were confirmed, in other cases, the desired deficiencies were revealed.  At the same time, we optimized the web hosting environment for typical PHP / MySQL sites and improved the work of custom containers. <br><br>  A week ago, the testing was completed, we summarized the results and now we provide Jet9 hosting in the working mode with provision of all services and declared SLAs for customers. <br><br><a name="habracut"></a><br><h3>  Test results </h3><br>  We have described the Jet9 device in general terms in the article <a href="http://habrahabr.ru/company/truevds/blog/262231/">Testing Jet9 - fault-tolerant hosting of sites with geographic optimization</a> .  The platform consists of three layers: <br><ul><li>  frontends - geographically distributed network of web accelerators </li><li>  backends - a working environment for web hosting sites and applications </li><li>  failover clusters with nodes in different data centers </li></ul><br>  In simplified form, the scheme looks like this: <br> <a href=""><img src="https://habrastorage.org/files/c5a/dfb/01d/c5adfb01deda4ca4b22c87b60d3fb2d5.png"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <br>  Frontends are distributed throughout Russia and other countries of the world.  Each frontend serves the site visitors who are closest to it and returns data either from the cache of the web accelerator or executes a request for the backend serving the site. <br><br>  On the back end are custom web containers with one or more sites.  The web container is allocated server resources in accordance with the tariff; inside it, the Apache, MySQL, PostgreSQL or other applications belong to the user. <br><br>  Backends work on high availability clusters according to the master backup scheme, where each of the cluster nodes is located in a separate independent data center.  Cluster nodes have common network connectivity (HA SLA Standard) or are located in different autonomous systems (HA SLA Business and HA SLA Corporate). <br><br>  Separately, we use these subsystems to operate internal <a href="http://www.truevds.ru/">TrueVDS</a> services, provide clients with services such as <a href="http://www.truevirtual.ru/price%3Fpricelist%3Dha1">High Availability Virtual Servers,</a> or deployed and served in customer projects.  In <a href="http://jet9.ru/">Jet9,</a> all three subsystems were refined and integrated into one platform.  Their management and interaction is carried out automatically both in normal mode and in case of accidents.  The site owner or application developer does not need to understand how all this is implemented inside, how to configure and maintain it.  Therefore, testing had two goals: to evaluate the convenience of working with hosting for regular users, and to test the assembled platform in normal and emergency modes. <br><br><h4>  Convenience of working with hosting for ordinary users </h4><br>  As the default control panel, we took <a href="https://www.ispsystem.ru/software/ispmanager">ISPManager 5, which is</a> popular and familiar to many.  With the help of plug-ins, we integrated it with our platform and provided users with a familiar web site management interface.  All the complex mechanics of setting up a web container, cluster operation, placement and configuration of a site in a CDN are hidden by the standard form for adding a site consisting of a field with a domain name and the "Add" button.  For typical PHP-sites on <a href="http://www.1c-bitrix.ru/">1C-Bitrix</a> , <a href="http://www.umi-cms.ru/">UMI.CMS</a> , <a href="https://wordpress.org/">Wordpress</a> , <a href="https://www.drupal.org/">Drupal</a> , etc.  no further action is required. <br><br>  Since, for users, the system looks no different from regular hosting, there were no difficulties and additional questions when testing.  The site was created and hosted in the usual way.  The work of CDN and Web accelerators was transparent for both the site administrator and visitors.  But there were still flaws - some details were missed in the letters sent, for example, there was no data for access via FTP, and it was difficult to find information about the DNS servers used.  The missing information was added to the letter templates and entered in the <a href="http://jet9.ru/faq/">FAQ</a> .  As can be judged by the current volume of the FAQ, a large number of questions have not yet arisen, and the work with the sites did not cause any difficulties for users. <br><br><h4>  Platform Test </h4><br>  High availability clusters are implemented on a bunch of Pacemaker, Corosync and DRBD.  We have been using this scheme for a long time and have studied its behavior in various situations quite well.  For clusters, the presence or absence of frontends makes no difference, the logic of their work does not depend on it.  But for the work of the frontends, it is essential that the backends are placed on the master backup clusters - therefore, the frontend must correctly transmit requests to the desired backend, and be able to respond correctly if the backend moves from the master to the backup. <br><br>  Therefore, we carried out tests of the platform in normal mode, and when imitating accidents in the cluster and on the frontend.  They also studied the behavior of the system in real emergency situations - when the channel disappears between data centers and when communication degrades in one of the uplink directions. <br><br><h5>  The interaction of subsystems in the normal mode </h5><br>  In normal mode, there are three types of processes in which all layers of the platform are involved: <br><br><ul><li>  create and delete user accounts </li><li>  creating and deleting sites </li><li>  service requests to sites </li></ul><br>  In these processes, separate operations for subsystems can be distinguished: <br><ul><li>  Account creation <br><ul><li>  Backend <br><ul><li>  Creating a custom web container with dedicated resources and isolation from other containers </li><li>  Formation of a web environment for the selected preset (for example, LAMP) </li></ul></li></ul></li><li>  Add site <br><ul><li>  Backend <br><ul><li>  Creating a site environment in a custom web container </li><li>  Generation of a DNS zone with records for geo-acceleration </li><li>  Register web site container (discovery) in the backend </li></ul></li><li>  Frontends <br><ul><li>  Assigning frontends that will serve this site </li><li>  Domain DNS zone placement </li><li>  Binding on the frontend domain to the master and backup cluster </li></ul></li></ul></li><li>  Request to site <br><ul><li>  Frontends <br><ul><li>  Return to the visitor of content from the closest to him frontend </li><li>  Determining the mode of the backend and sending a request to the master or backup, depending on their availability </li></ul></li><li>  Backend <br><ul><li>  Submit a site request to a user's web container </li></ul></li></ul></li></ul><br>  Before the public testing, we conducted internal testing, during which most of the shortcomings were eliminated.  But the beta test participants helped us discover two more bugs: one for us, the other for some domain registrars. <br><br>  We had a bug when tying a domain to frontends, when during the race conditions the operation was marked as completed, although the domain was not yet attached.  This error did not affect the work of already linked domains and appeared quite rarely - only when the site was connected.  Thanks to the users who placed several dozen domains in the first days of testing, this error was quickly detected and eliminated.  There were no other errors in the work of the platform. <br><br>  Registrar bug arises in the process of domain delegation to new servers, while verifying the zone and DNS servers.  In our scheme, to improve reliability, each DNS server had several A-records.  Some registrars in verifying the delegation correctly processed such a naming scheme and completed the delegation without errors.  Other registrars refused to delegate the domain, claiming incorrect configuration.  Probably, they take only the first of several A-records when checking, and if it turns out to be the same for all servers, they consider this a mistake.  Although this bug is in checking DNS servers as a registrar, but in order to simplify the lives of customers of such registrars, we had to use the old server naming scheme - with a single A-record. <br><br><h5>  Reaction to various types of accidents </h5><br>  We experienced a platform response to the following types of accidents: <br><ul><li>  Main server power down </li><li>  Failure in the core data center internal routing </li><li>  Partial failures in uplink routing </li><li>  Failures on the communication channel between the master and the cluster backup </li><li>  Failure of the backup server </li><li>  Failure of one of the frontends </li></ul><br>  In this case, the platform is required to determine whether the problem really arose, whether any reaction is required on it, and, if the problem exists, change the topology to eliminate the problem.  In the event of a crash of the cluster master, not only is the migration of the backend to the backup server, but also the frontend reconfiguration to redirect requests to the new backend. <br><br>  All the indicated situations were worked out correctly, the restoration of work was carried out during the scheduled time - up to one and a half minutes in the most difficult cases.  For Internet services assembled on a master backup cluster without frontends, even with the optimally chosen solution for organizing DNS and IP routing, the master‚Äôs failure can lead, though not to a complete cessation of service, but to a noticeable degradation of the quality of work for about hours  Adding a frontend layer in the Jet9 platform, among other things, reduced the time of service degradation in case of accidents to a few minutes. <br><br><h4>  Improving the web hosting environment </h4><br><br>  Simultaneously with the beta testing of the Jet9 platform, we improved the custom web containers used in it.  In addition to guaranteed resources and load isolation between users, we have implemented the ability to fully manage the software used in the container: <br><ul><li>  Use own httpd and mysqld </li><li>  Choose arbitrary versions of programs (supported and updated by us) <br><ul><li>  PHP 5.2, 5.3, 5.4, 5.6, 7RC2 </li><li>  MySQl5.6, MariaDB 10.0, Percona 5.6 </li><li>  PostgreSQL 8.4, 9.4 </li></ul></li><li>  Configure Apache at httpd.conf <br><ul><li>  switching modules on and off </li><li>  tuning the number of httpd processes, fcgi processes </li></ul></li><li>  Enable, disable or configure PHP modules </li><li>  Configure MySQL Server Configuration </li></ul><br>  Among other things, it allowed us to optimize the web environment for maximum performance for demanding CMS resources for PHP. <br><br><h3>  Putting the service into operation </h3><br>  Public beta testing confirmed the correct operation of the Jet9 platform and found several shortcomings.  Many thanks to the testing participants for their help!  After improving the work of web containers and eliminating the identified shortcomings, Jet9 web hosting has been put into service since September 7, and now we are <a href="http://jet9.ru/order/">accepting orders</a> . <br><br>  In addition to hosting on a failover cluster, we also added hosting tariffs of the usual level of reliability (Standard Server).  They also work on optimized and managed web containers with guaranteed resources and scaling, and are integrated with a network of geographic optimization and web accelerators.  But due to a simpler configuration and the absence of double hot backup equipment, its cost is much lower and corresponds to the average market prices for VPS or dedicated servers of similar capacity. <br><br>  Once again we express our gratitude to all participants in the testing and remind you that in order to receive discounts for participating in testing, it is enough to indicate in the comments to the issued order the login used during testing, or send this information in a letter of support. </div><p>Source: <a href="https://habr.com/ru/post/266863/">https://habr.com/ru/post/266863/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266851/index.html">Start loving go</a></li>
<li><a href="../266853/index.html">Return fix and other improvements in Vivaldi 1.0.275.3 fix</a></li>
<li><a href="../266857/index.html">FAS has recognized Google as violator of antitrust laws</a></li>
<li><a href="../266859/index.html">Non-intersecting sets and mysterious function of Ackermann</a></li>
<li><a href="../266861/index.html">Hash array mapped trie</a></li>
<li><a href="../266865/index.html">QuadBraces - based on the MODx parser</a></li>
<li><a href="../266869/index.html">New ‚Äúservice‚Äù from Ubiquiti - replenishment in the model range UniFi AC</a></li>
<li><a href="../266871/index.html">Deploy JetBrains Hub + Youtrack + Upsource + Nginx on your Debian 8 server</a></li>
<li><a href="../266873/index.html">Functional C #: Immutability</a></li>
<li><a href="../266877/index.html">Git for a professional programmer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>