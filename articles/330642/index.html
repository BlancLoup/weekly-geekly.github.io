<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Is it always safe to encrypt or recover data from an external hard drive Prestigio Data Safe II</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The owner of a small business on Monday evening decided to take up a financial analysis of current affairs. When he arrived home in the evening, he se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Is it always safe to encrypt or recover data from an external hard drive Prestigio Data Safe II</h1><div class="post__text post__text-html js-mediator-article">  The owner of a small business on Monday evening decided to take up a financial analysis of current affairs.  When he arrived home in the evening, he settled into his home office, connected an external drive Prestigio Data Safe II 500GB to the laptop and plunged into numbers.  Suddenly his thoughts were interrupted by the noise, and then a pet ran into the room with a shrill meow. on others, hissing at any attempt to approach. <br><br>  When the culmination of events disappeared and the reasons for this behavior of a pet became clear, the owner discovered that the case was not limited to the frightened cat.  Real chaos reigned on the table and around it: documents scattered around the room and a lifeless hard drive dangling on a USB cable. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/0e3/b28/f6a/0e3b28f6a1bc46dba75bbc0a99923629.jpg"></div><br>  <i>rice</i>  <i>one</i> <br><a name="habracut"></a><br>  After eliminating the consequences of the race of the unfortunate animal, close attention was paid to the hard drive.  On the back of the disk owner, he ran a light chill when he didn‚Äôt wait for the utility's launch drive to offer a password to access the hidden section.  After several fruitless attempts, the system administrator was urgently called. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The administrator, making sure of the futility of trying to work with the drive via USB, dismantled the box, removed the Toshiba MK5059GSXP HDD and connected it to the SATA port of the computer.  Having booted Windows, in the Disk Management snap-in, I discovered that from the point of view of the OS, the drive does not contain any partitions.  An attempt was made to launch an automatic recovery program, but the scan, which had barely begun, suspended the computer, and there were clicks from the drive.  At this stage, it was decided that it was time to stop. <br><br>  With this background, the drive came to our data recovery lab.  Based on the fact that the drive was after the impact and when attempting to scan, it began to make knocking sounds, then the first operation would be to clean it from dust and conduct an examination in a laminar box.  Suspension and slider BMG, recirculation air filter, as well as the upper surface in the disc pack are subject to thorough examination. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/49e/4dd/62d/49e4dd62dd8743c38b06d38ba1311afe.jpg"></div><br>  <i>rice</i>  <i>2</i> <br><br>  Inspection of the recirculating air filter and BMG did not reveal deformations and the presence of metal particles, on the basis of which we conclude that the drive can be started with the original BMG.  Examination of the upper surface under a microscope reveals a small radial scratch at the outer edge. <br><br>  Assembling the drive, connect it to the PC3000 port and power up.  Characteristic air noise is heard when the shaft rotates and the sound of the calibration test passes.  Further, there is a certain delay, after which the drive finally issues a register readiness to accept commands. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/51d/88c/045/51d88c045c09455db54e4c8e1e59edce.png"></div><br>  <i>rice</i>  <i>3</i> <br><br>  We perform firmware backup, in the process we discover the unreadable G-list.  Since this defect list is necessary for the operation of the broadcast system, the drive does not allow reading any sectors from the user area in the normal mode. <br><br>  Attempting to write to an unused track in the service area causes the hard disk to start knocking sounds, which clearly indicates recording problems.  Since we don‚Äôt have the opportunity to rewrite the unreadable module, we will not attempt to write a pure G-list module. <br><br>  For Toshiba drives that do not have or do not work correctly recording heads, or there are serious damages in the service area, which do not allow to function correctly, you can use the features of the technological mode.  After switching on the technology mode, the drive changes the operation logic: no logging to SMART logs is performed, offline scanning is disabled, and the translation system does not take into account entries in the P-list and G-list. <br><br>  Before reading in the technological mode, you need to analyze the P-list of the hard disk in order to take into account all excluded areas from the PBA range and, when reading out, obtain user data that was recorded within the LBA range (which includes exceptions from the P-list) without shifts. <br><br>  The next step is to build a zone distribution map in order to understand how the logical space is formed.  For reading, we will construct a map of the mini zones and sort them in descending order, since during the examination damage was found at the outer edge of the plate. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/ef3/a04/5aa/ef3a045aabaa41f4bda55961a50e4427.png"></div><br>  <i>rice</i>  <i>four</i> <br><br>  In this case, without much difficulty, up to 15,998 xxx sectors were read.  Then there were difficulties in reading. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/1c6/755/fe9/1c6755fe9b2b4eac83920490cb322f64.png"></div><br>  <i>rice</i>  <i>five</i> <br><br>  An attempt to rebuild the chain in ascending order with further reading showed the presence of defects from the very beginning of the logical range. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/6a8/0a9/9dc/6a80a99dc0f743658e93cbc6b68c8d35.png"></div><br>  <i>rice</i>  <i>6</i> <br><br>  We exclude reading on head No. 0 and try to read further, then problems with 249 xxx sectors are detected, we also exclude reading on head No. 2.  We perform zone reading with heads No. 1 and No. 3 in the interval from 0 to 15,998,975 sectors. <br><br>  For further reading of the problem areas, we will use the PIO mode to more accurately control the state of the drive.  After completing a certain number of attempts to read with different timeouts, wait for readiness and different size of jumps when instabilities are detected, proceed to the stage of multipass reading of defects.  As a result of all reading attempts, less than 3,000 sectors out of a total of 976,773,168 sectors remained unread. <br><br>  Fill in the unread sectors on the copy with the 0xDE 0xAD pattern.  We analyze regular expressions for various popular file types and find the absence of user data on the disk, but at the same time we can say that the disk is filled with some data by more than 95% (according to how many sectors are filled with non-zero values). <br><br>  At this stage, we will postpone the sector-by-sector copy and analyze the features of the USB-SATA bridge used in the box. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/d07/2a8/2f2/d072a82f231c4f679177eaccac0ffcd9.jpg"></div><br>  <i>rice</i>  <i>7</i> <br><br>  This USB-SATA adapter is based on the MCU J-Micron 20339. Take a drive, all sectors of which are filled with 0x00, connect to this adapter and connect to the PC. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/629/27e/680/62927e680b3743a1941c2f48783baaff.png"></div><br>  <i>rice</i>  <i>eight</i> <br><br>  OS found 2 drives of 20Mb each.  When analyzing, it turned out that the first section is read only.  On the second record is available. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/88a/b87/264/88ab872646084e428ae2cfe7a28a3d35.png"></div><br>  <i>rice</i>  <i>9</i> <br><br>  Based on the device names in the passport data, it can be assumed that the role of the first is to store an application that configures the size of a public and hidden section, as well as opening access to a hidden section.  The second section is designed to store "public" data and the third appears only when you enter the password in the proprietary utility. <br><br>  When opening in the disk editor in each sector of any of the devices we see filling with a certain pattern. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/c0c/427/e2c/c0c427e2c33046168ffe7b2f9f635757.png"></div> <br>  <i>rice</i>  <i>ten</i> <br><br>  Let's disconnect the disk from this adapter and analyze if the controller has some metadata on the drive itself, since the disk was initially completely filled with zeros.  In sector 0x18FBF (102,335) and sector 0x18FCF (102,351), filling with a certain chaotic content is detected. <br><br>  Starting from sector 102 352, we will record the sector number in the first 4 bytes over 40 960 sectors.  Reconnecting the drive to the adapter, let's analyze the filling of the first twenty megabyte partition.  We will see that throughout the entire section the pattern remains as in fig.  10, but with changes in the first bytes.  Having performed XOR operations between the original pattern and the current values, we get the sectors, the contents of which will be zeros with the sector number in the first 4 bytes. <br><br>  Based on this, we can assert that this controller encrypts data using XOR operation, the key size is 512 bytes.  The disadvantage of this ‚Äúencryption‚Äù is that in sectors filled with zeros, but read through this USB-SATA adapter, all 512 bytes of the key will be in their original form.  Also note that in drives, where sectors 102 335 and 102 351 contain incorrect content in terms of the JM20339 firmware, new keys will be generated randomly. <br><br>  Let's return to the copy of the problem drive and analyze the read card.  Let us make sure that the key sectors 102 335 and 102 351 are read and additional analysis methods for finding the key will not be required.  Transfer the contents of the key sectors to the blank drive and see which XOR pattern will be generated by the JM20339 controller firmware. <br><br>  Let's create a backup copy of the drive on which the patient has had a sector-specific copy of the patient, and perform an XOR operation on each sector, starting from sector 102352 with the obtained key. <br><br>  Starting the analysis of regular expressions, we note that there are many signs of the presence of popular file types (jpg, doc, xls, etc.).  This circumstance confirms the correctness of data decryption. <br><br>  For convenience of analysis, in the 0 sector we will write the classical partition table, in which we will describe the 3 partitions available on this drive.  In our original task we will substitute the drive with decrypted data. <br><br>  Since the client‚Äôs task was to restore the data from the hidden partition, we will evaluate the integrity of the file system on it by analyzing the location of the metadata and check if there are any unread sections.  The analysis reveals that 16 sectors in the MFT could not be read, which indicates a loss of no more than 8 file records.  Further comparison of files with the read card allows you to identify 73 more files affected by the contact of the sliders with the surfaces of the plates. <br><br>  99, 9% of the recovered files are the final result that satisfied the client. <br>  As a conclusion, you can once again remind everyone of the need for backup and also note that to this day there are quite a few solutions on the market, where the data encryption option is just a marketing ploy that cannot reliably protect user data. <br><br>  <a href="https://habrahabr.ru/post/331090/">Next post: Shallow immersion or data recovery from the hard drive after flooding the office</a> <br>  <a href="https://habrahabr.ru/post/330120/">Previous publication: Data Recovery from an External Hard Drive Seagate FreeAgent Go</a> </div><p>Source: <a href="https://habr.com/ru/post/330642/">https://habr.com/ru/post/330642/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330632/index.html">Solving linear diophantine equations with any number of unknowns.</a></li>
<li><a href="../330634/index.html">Redux: trying to get rid of the need to think during requests to the API, part 2</a></li>
<li><a href="../330636/index.html">Service of the future: opportunities and risks</a></li>
<li><a href="../330638/index.html">By magic ... (Pike programming language)</a></li>
<li><a href="../330640/index.html">No edits. How to become the happiest designer on the planet</a></li>
<li><a href="../330644/index.html">Red-black trees: short and clear</a></li>
<li><a href="../330646/index.html">Screen rotation during long-term operation</a></li>
<li><a href="../330648/index.html">Solving linear programming problems using Python</a></li>
<li><a href="../330650/index.html">Ruby on Rails agreement. Part 4</a></li>
<li><a href="../330654/index.html">Dialectics of Neural Machine Translation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>