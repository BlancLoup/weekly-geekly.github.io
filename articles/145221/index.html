<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forcing the capture of the roles of the deceased operations wizard</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is no secret that in AD there are operations that are assigned only to one domain controller in the forest, called the operation master. For exampl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Forcing the capture of the roles of the deceased operations wizard</h1><div class="post__text post__text-html js-mediator-article">  It is no secret that in AD there are operations that are assigned only to one domain controller in the forest, called the operation master.  For example, in AD only one controller is assigned as the primary keeper of the directory schema. <br><br>  In the case of dying of such a server for any of the technical or non-technical reasons, a situation arises when the second DC together does not allow you to fully manage the domain.  In such cases, the following recipe will help, which will allow transferring the existing roles of the operations wizard to the surviving controller.  The recipe is quite famous, however, I found it useful to put detailed instructions on Habr, since my first reaction was panic. <br><a name="habracut"></a><br>  A domain configuration with two controllers is considered.  One of them is assigned the role of the operations wizard and the global catalog, and in our scenario he dies.  To reassign all roles, the administrator must be a member of the Enterprise Admins group.  The procedure consists of two stages: capturing roles and assigning a global catalog. <br><br>  Those who want to learn the theory by the masters of operations read <a href="http://habrahabr.ru/post/133370/">this informative post</a> , well, we proceed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Capture Roles </h5><br>  Click the <b>Start</b> button, select <b>Run</b> , type <b>ntdsutil</b> , and press ENTER. <br>  1. Connection <br>  1.1.  At the <b>ntdsutil:</b> prompt, type <b>roles</b> and press ENTER. <br>  1.2.  At the <b>fsmo maintenance:</b> prompt, type <b>connections</b> and press ENTER. <br>  1.3.  At the <b>server connections:</b> prompt, type <b>connect to server</b> <i>servername</i> (where <i>servername</i> is the name of the domain controller that will assume the operations master role), and press ENTER. <br>  1.4.  After you confirm the connection, type <b>quit</b> and press ENTER. <br>  2. Depending on the role you want to take in the <b>fsmo maintenance</b> prompt <b>:</b> type the appropriate command from the table below and press ENTER. <br>  3. Enter <b>quit</b> and press ENTER.  Repeat again to exit ntdsutil. <br><br>  The system asks for confirmation.  Then she tries to transfer the specified roles.  During this, several error messages may be displayed, but the capture will continue.  Upon completion, the list of roles and LDAP nodes of the responsible servers will be displayed.  During the master RID capture, the current master should try to synchronize with the replication partner, but the partner is dead, so a warning will be displayed and you will need to confirm the operation. <br><br>  Commands to capture <br><table><tbody><tr><th>  <b>Role</b> </th><th>  <b>Necessary privileges</b> </th><th>  <b>Team</b> </th></tr><tr><td>  Domain naming master </td><td>  Enterprise admins </td><td>  seize domain naming master </td></tr><tr><td>  Schema master </td><td>  Enterprise admins </td><td>  seize schema master </td></tr><tr><td>  Infrastructure master </td><td>  Domain Admins </td><td>  seize infrastructure master </td></tr><tr><td>  PDC emulator </td><td>  Domain Admins </td><td>  seize pdc </td></tr><tr><td>  RID master </td><td>  Domain Admins </td><td>  seize rid master </td></tr></tbody></table><br><h5>  Assigning a global catalog </h5><br>  1. Opening the snap-in Active Directory Sites and Services. <br>  2. In the console tree, select the domain controller where you want to enable or disable the global catalog.  Search here Active Directory Sites and Services / Sites / site_name / Servers / controller_name <br>  3. Right-click on NTDS Settings, select Properties.  Select the Global Catalog check box to enable the global catalog, or uncheck the box to disable the global catalog. <br><br><img src="https://habrastorage.org/storage2/0df/ed3/d13/0dfed3d13b8b66dff9c8d0202d0c3ec0.png"><br><br>  I hope the article will save someone a good ton of nerves. <br><br>  UPD: <br><br>  In Win2k8R2, the commands are slightly different: <br><br>  fsmo maintenance:? <br><br>  ?  - Display this reference information <br>  Connections - Connect to a specific DC / LDS instance of AD <br>  Help - Displays this help information. <br>  Quit - Return to the previous menu. <br>  Seize infrastructure master - Overwrite infrastructure role on connected server <br>  Seize naming master - Overwrite the role of the naming master on the connected server <br>  Seize PDC - Overwrite PDC role on connected server <br>  Seize RID master - Overwrite the RID role on the connected server <br>  Seize schema master - Overwrite schema role on connected server <br>  Select operation target - Select sites, servers, domains, roles, naming contexts <br>  Transfer infrastructure master - Make the connected server the master of infrastructure <br>  Transfer naming master - Make the connected server the naming master <br>  Transfer PDC - Make a connected PDC server <br>  Transfer RID master - Make the connected server the master RID <br>  Transfer schema master - Make the connected server the schema master <br><br>  <a href="http://support.microsoft.com/kb/255504">Useful source</a> </div><p>Source: <a href="https://habr.com/ru/post/145221/">https://habr.com/ru/post/145221/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145214/index.html">Creating multiple diagrams based on a single Entity Framework model in Visual Studio 2012</a></li>
<li><a href="../145215/index.html">Protecting the Apache web server from a slow-reading attack, as well as some other targeted attacks</a></li>
<li><a href="../145216/index.html">Computex announced devices on Windows 8</a></li>
<li><a href="../145218/index.html">Firefox 13 released - with SPDY, new home page and tabs</a></li>
<li><a href="../145219/index.html">HP, IBM, Cisco and Hitachi blade server platforms comparison, part two: network infrastructure, management, server features, service and market share</a></li>
<li><a href="../145222/index.html">Dedicated Internet backbone can connect BRICS countries, Africa and the USA</a></li>
<li><a href="../145223/index.html">Meebo team will work on Google+ tools for publishers</a></li>
<li><a href="../145224/index.html">MIT has developed an unusual video enhancement technology.</a></li>
<li><a href="../145226/index.html">Comparison of Windows Azure Blob Storage and Google Cloud Storage</a></li>
<li><a href="../145230/index.html">In Arch Linux, digital signature verification is enabled by default.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>