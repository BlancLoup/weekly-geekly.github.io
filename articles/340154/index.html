<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Change sex and race on a selfie using neural networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! Today I want to tell you how you can change your face in the photo, using a rather complex pipeline from several generative neural networks ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Change sex and race on a selfie using neural networks</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/e4/81/59e4812912d29153257074.png"></div><br><p>  Hi, Habr!  Today I want to tell you how you can change your face in the photo, using a rather complex pipeline from several generative neural networks and not only.  Recently fashionable applications for transforming oneself into a lady or grandfather work easier, because neural networks are slow, and the quality that can be obtained by classical methods of computer vision is already good.  Nevertheless, the proposed method seems to me very promising.  Under the cut there will be little code, but a lot of pictures, links and personal experience with GANs. <a name="habracut"></a></p><br><p>  The task can be divided into the following steps: </p><br><ul><li>  find and cut the face in the photo </li><li>  convert the face as necessary (turn into a woman / black, etc.) </li><li>  improve / enlarge the resulting image </li><li>  paste the transformed face back into the original photo </li></ul><br><p>  Each of these steps can be implemented as a separate neural network, but you can do without them.  Let's take it in order. </p><br><h2 id="detekciya-lica">  Face detection </h2><br><p> Here is the easiest.  You can not invent anything and just take <code>dlib.get_frontal_face_detector()</code> ( <a href="http://dlib.net/face_detector.py.html">example</a> ).  Dlib's default detector uses a linear classifier trained on HOG features. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e427431c624910906990.png"><br><br><p>  As we can see, the issued rectangle does not contain the entire face, so it‚Äôs better to enlarge it.  Optimum zoom factors can be hand picked.  As a result, you can get a similar method and a similar result: </p><br><div class="spoiler">  <b class="spoiler_title">code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">detect_single_face_dlib</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(img_rgb, rescale=</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1.1</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">, </span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1.5</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">, </span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1.1</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">, </span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1.3</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> fd_front_dlib = dlib.get_frontal_face_detector() face = fd_front_dlib(img_rgb, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(face) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: face = sorted([(t.width() * t.height(), (t.left(), t.top(), t.width(), t.height())) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> face], key=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> t: t[<span class="hljs-number"><span class="hljs-number">0</span></span>], reverse=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> rescale <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> face <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> type(rescale) != tuple: rescale = (rescale, rescale, rescale, rescale) (x, y, w, h) = face w = min(img_rgb.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] - x, int(w / <span class="hljs-number"><span class="hljs-number">2</span></span> + rescale[<span class="hljs-number"><span class="hljs-number">2</span></span>] * w / <span class="hljs-number"><span class="hljs-number">2</span></span>)) h = min(img_rgb.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] - y, int(h / <span class="hljs-number"><span class="hljs-number">2</span></span> + rescale[<span class="hljs-number"><span class="hljs-number">3</span></span>] * h / <span class="hljs-number"><span class="hljs-number">2</span></span>)) fx = max(<span class="hljs-number"><span class="hljs-number">0</span></span>, int(x + w / <span class="hljs-number"><span class="hljs-number">2</span></span> * (<span class="hljs-number"><span class="hljs-number">1</span></span> - rescale[<span class="hljs-number"><span class="hljs-number">0</span></span>]))) fy = max(<span class="hljs-number"><span class="hljs-number">0</span></span>, int(y + h / <span class="hljs-number"><span class="hljs-number">2</span></span> * (<span class="hljs-number"><span class="hljs-number">1</span></span> - rescale[<span class="hljs-number"><span class="hljs-number">1</span></span>]))) fw = min(img_rgb.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] - fx, int(w - w / <span class="hljs-number"><span class="hljs-number">2</span></span> * (<span class="hljs-number"><span class="hljs-number">1</span></span> - rescale[<span class="hljs-number"><span class="hljs-number">0</span></span>]))) fh = min(img_rgb.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] - fy, int(h - h / <span class="hljs-number"><span class="hljs-number">2</span></span> * (<span class="hljs-number"><span class="hljs-number">1</span></span> - rescale[<span class="hljs-number"><span class="hljs-number">1</span></span>]))) face = (fx, fy, fw, fh) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> face</code> </pre> </div></div><br><img src="https://habrastorage.org/webt/59/e4/27/59e42742ca128285969809.png"><br><br><p>  If the work of the "old" methods for some reason does not suit you, you can try deep learning.  To solve the problem of face detection, any Region Proposal Networks will suit, for example, <a href="https://arxiv.org/abs/1612.08242">YOLOv2</a> or <a href="https://arxiv.org/abs/1506.01497">Faster-RCNN</a> .  How to try - be sure to share what you got. </p><br><h2 id="transformaciya-lica">  Face transformation </h2><br><p>  Here is the most interesting.  <a href="https://habrahabr.ru/company/ods/blog/336594/">As you probably already know</a> , <a href="https://habrahabr.ru/company/ods/blog/336594/">you can</a> transform a face or make a mask without neural networks, and it will work well.  But generative networks are a much more promising tool for image processing.  There are already a huge number of models, such as <code>&lt;your prefix&gt;GAN</code> , that can do a variety of transformations.  The task of converting images from one set (domain) to another is called Domain Transfer.  You could get acquainted with some Domain Transfer architectures in our <a href="https://habrahabr.ru/company/ods/blog/322514/">recent review of GANs</a> . </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e427456f789279016928.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3 id="cycle-gan">  Cycle-gan </h3><br><p>  Why choose Cycle-GAN?  Yes, because it works.  Visit <a href="https://junyanz.github.io/CycleGAN/">the project site</a> and see what you can do with this model.  As a dataset, two sets of images are enough: DomainA and DomainB.  Let's say you have folders with photos of men and women, whites and Asians, apples and peaches.  It's enough!  Clone <a href="https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix">the author's repository</a> with the implementation of Cycle-GAN on pytorch and start learning. </p><br><h3 id="kak-eto-rabotaet">  How it works </h3><br><p>  In this figure from the <a href="https://arxiv.org/abs/1703.10593">original article, the</a> principle of the model operation is described quite fully and briefly.  In my opinion, a very simple and elegant solution that gives good results. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e42744848e6728090234.png"><br><br><p>  In fact, we train two generator functions.  One - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">G</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> G </script>  - learns from the input image from the domain <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> X </script>  generate image from domain <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">Y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="1.937ex" viewBox="0 -780.1 763.5 834" role="img" focusable="false" style="vertical-align: -0.125ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-59" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> Y </script>  .  Other - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">F</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.741ex" height="2.057ex" viewBox="0 -780.1 749.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-46" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> F </script>  - on the contrary, from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">Y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="1.937ex" viewBox="0 -780.1 763.5 834" role="img" focusable="false" style="vertical-align: -0.125ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-59" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> Y </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> X </script>  .  Relevant discriminators <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-16" style="vertical-align: -0.4em;">Y</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.41ex" height="2.298ex" viewBox="0 -780.1 1468.4 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-59" x="1171" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> D_Y </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-msubsup" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-20" style="vertical-align: -0.4em;">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.097ex" height="2.419ex" viewBox="0 -780.1 1333.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="1171" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> D_x </script>  they are helped in this, as is characteristic of the GANs.  A typical Advesarial Loss (or GAN Loss) looks like this: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-21"><span class="MJXp-msubsup" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-24" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">G</span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;">Y</span></span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">X</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">Y</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-40">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">b</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mrow" id="MJXp-Span-48" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-50" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">y</span><span class="MJXp-mtext" id="MJXp-Span-52">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">m</span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-63">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">y</span><span class="MJXp-mo" id="MJXp-Span-65">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-67">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">g</span><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">Y</span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">y</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-79">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">b</span><span class="MJXp-msubsup" id="MJXp-Span-86"><span class="MJXp-mrow" id="MJXp-Span-87" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-89" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">x</span><span class="MJXp-mtext" id="MJXp-Span-91">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">m</span><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-102">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">x</span><span class="MJXp-mo" id="MJXp-Span-104">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-106">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">g</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-111">1</span><span class="MJXp-mo" id="MJXp-Span-112" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-115" style="vertical-align: -0.4em;">Y</span></span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">G</span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">x</span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="96.873ex" height="3.021ex" viewBox="0 -832 41709 1300.8" role="img" focusable="false" style="vertical-align: -1.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-4C" x="0" y="0"></use><g transform="translate(681,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-41" x="786" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-4E" x="1537" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="2496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="2886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2C" x="3672" y="0"></use><g transform="translate(4117,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-59" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2C" x="5586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-58" x="6031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2C" x="6883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-59" x="7328" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="8092" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-3D" x="8759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="10066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="10944" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="11474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-68" x="11835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="12412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="12841" y="0"></use><g transform="translate(13271,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-73" x="851" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-69" x="1320" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="1666" y="0"></use><g transform="translate(1799,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-70" x="0" y="0"></use><g transform="translate(356,-163)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="523" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="1053" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="1414" y="0"></use></g></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="4522" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="4912" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="5409" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5B" x="18210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6C" x="18738" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6F" x="19037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-67" x="19522" y="0"></use><g transform="translate(20003,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-59" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="21471" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="21861" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="22358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5D" x="22748" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2B" x="23248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="24499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="25377" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="25907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-68" x="26268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="26845" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="27274" y="0"></use><g transform="translate(27704,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-73" x="926" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-69" x="1395" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="1741" y="0"></use><g transform="translate(1852,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-70" x="0" y="0"></use><g transform="translate(356,-163)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="523" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="1053" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="1414" y="0"></use></g></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="4597" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="4987" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="5559" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5B" x="32749" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6C" x="33278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6F" x="33576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-67" x="34062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="34542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-31" x="34932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2212" x="35654" y="0"></use><g transform="translate(36655,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-59" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="38123" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="38513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="39299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="39689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="40261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="40651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="41040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5D" x="41430" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> L_ {GAN} (G, D_Y, X, Y) = \ mathbb {E} _ {y \ sim p_ {data} (y)} [\ log D_Y (y)] + \ mathbb {E} _ {x \ sim p_ {data} (x)} [\ log (1-D_Y (G (x)))] </script></p><br><p>  Additionally, the authors introduce the so-called Cycle Consistensy Loss: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-124"><span class="MJXp-msubsup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-127" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">G</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">F</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-137">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">b</span><span class="MJXp-msubsup" id="MJXp-Span-144"><span class="MJXp-mrow" id="MJXp-Span-145" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-147" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">x</span><span class="MJXp-mtext" id="MJXp-Span-149">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">m</span><span class="MJXp-msubsup" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-155" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-160">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">x</span><span class="MJXp-mo" id="MJXp-Span-162">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-164">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">t</span><span class="MJXp-mtext" id="MJXp-Span-169">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-170"><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">F</span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">G</span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">x</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">x</span><span class="MJXp-mtext" id="MJXp-Span-181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">t</span><span class="MJXp-mtext" id="MJXp-Span-187">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-188"><span class="MJXp-mrow" id="MJXp-Span-189" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-191" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">b</span><span class="MJXp-msubsup" id="MJXp-Span-201"><span class="MJXp-mrow" id="MJXp-Span-202" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-204" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">y</span><span class="MJXp-mtext" id="MJXp-Span-206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">m</span><span class="MJXp-msubsup" id="MJXp-Span-210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-212" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-217">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">y</span><span class="MJXp-mo" id="MJXp-Span-219">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-221">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">t</span><span class="MJXp-mtext" id="MJXp-Span-226">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-227"><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">G</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">F</span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">y</span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">y</span><span class="MJXp-mtext" id="MJXp-Span-238">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">t</span><span class="MJXp-mtext" id="MJXp-Span-244">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mrow" id="MJXp-Span-246" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-248" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="110.677ex" height="3.021ex" viewBox="0 -832 47652.5 1300.8" role="img" focusable="false" style="vertical-align: -1.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-4C" x="0" y="0"></use><g transform="translate(681,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="433" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-63" x="930" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="1746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="2135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2C" x="2922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-46" x="3367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="4117" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-3D" x="4784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="6090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="6969" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="7498" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-68" x="7860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="8436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="8866" y="0"></use><g transform="translate(9295,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-73" x="926" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-69" x="1395" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="1741" y="0"></use><g transform="translate(1852,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-70" x="0" y="0"></use><g transform="translate(356,-163)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="523" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="1053" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="1414" y="0"></use></g></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="4597" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="4987" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="5559" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5B" x="14340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6C" x="14869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-65" x="15167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-66" x="15634" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="16184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-7C" x="16796" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-46" x="17074" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="17824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="18213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="19000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="19389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="19962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="20351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2212" x="20963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-78" x="21964" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-72" x="22786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-69" x="23238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-67" x="23583" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-68" x="24064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="24640" y="0"></use><g transform="translate(25252,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-31" x="393" y="-404"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5D" x="25984" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2B" x="26485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="27736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="28614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="29144" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-68" x="29505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="30082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-62" x="30511" y="0"></use><g transform="translate(30941,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-73" x="851" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-69" x="1320" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6D" x="1666" y="0"></use><g transform="translate(1799,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-70" x="0" y="0"></use><g transform="translate(356,-163)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="523" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="1053" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-61" x="1414" y="0"></use></g></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="4522" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="4912" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="5409" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5B" x="35880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-6C" x="36408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-65" x="36707" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-66" x="37173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="37724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-7C" x="38335" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="38614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="39400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-46" x="39790" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-28" x="40539" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="40929" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="41426" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-29" x="41816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-2212" x="42427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-79" x="43428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-72" x="44176" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-69" x="44627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-67" x="44973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-68" x="45453" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-74" x="46030" y="0"></use><g transform="translate(46641,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-31" x="393" y="-404"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMAIN-5D" x="47374" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> L_ {cyc} (G, F) = \ mathbb {E} _ {x \ sim p_ {data} (x)} [\ left \ | F (G (x)) - x \ right \ | _1] + \ mathbb {E} _ {y \ sim p_ {data} (y)} [\ left \ | G (F (y)) - y \ right \ | _1] </script></p><br><p>  Its essence is to image from the domain <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> X </script>  after going through a generator <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">G</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/340154/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfaT-U2FtvdMM5hMZcIYwIQQUlQ#MJMATHI-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> G </script>  and then through the generator <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">F</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> F </script>  It was most similar to the original.  In short <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">F</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">G</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">x</span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> F (G (x)) \ approx x </script>  . </p><br><p>  Thus, the objective function takes the form: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">L</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">G</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">F</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-281" style="vertical-align: -0.4em;">X</span></span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-285" style="vertical-align: -0.4em;">Y</span></span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-290" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">G</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-299" style="vertical-align: -0.4em;">Y</span></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">X</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">Y</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-308" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">F</span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-317" style="vertical-align: -0.4em;">X</span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">Y</span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">X</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">a</span><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-333" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">c</span></span></span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">G</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">F</span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> L (G, F, D_X, D_Y) = L_ {GAN} (G, D_Y, X, Y) + L_ {GAN} (F, D_X, Y, X) + \ lambda L_ {cyc} (G, F ) </script></p><br><p>  and we solve the following optimization problem: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-342"><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">G</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-345" style="vertical-align: 0.5em;">‚àó</span></span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348" style="margin-right: 0.05em;">F</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-349" style="vertical-align: 0.5em;">‚àó</span></span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">g</span><span class="MJXp-mtext" id="MJXp-Span-354">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">i</span><span class="MJXp-msubsup" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-359" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">F</span><span class="MJXp-mo" id="MJXp-Span-361">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">G</span></span></span><span class="MJXp-mtext" id="MJXp-Span-363">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">a</span><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-371" style="vertical-align: -0.4em;">X</span></span><span class="MJXp-mo" id="MJXp-Span-372">,</span><span class="MJXp-msubsup" id="MJXp-Span-373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-375" style="vertical-align: -0.4em;">Y</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">L</span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">G</span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">F</span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-384" style="vertical-align: -0.4em;">X</span></span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-388" style="vertical-align: -0.4em;">Y</span></span><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> G ^ *, F ^ * = arg \ min_ {F, G} \ max_ {D_X, D_Y} L (G, F, D_X, D_Y) </script></p><br><p>  Here <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-390"><span class="MJXp-mtext" id="MJXp-Span-391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ lambda </script>  - a hyperparameter controlling the weight of the extra loss. </p><br><p>  But that is not all.  It was noticed that the generators greatly change the color gamut of the original image. </p><br><p>  To fix this, the authors added an additional loss - Identity Loss.  This is a kind of regularizer that requires identity mapping from the generator for images of the target domain.  Those.  if a zebra came to the zebra generator, then you don‚Äôt need to change such a picture. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-398"><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400" style="margin-right: 0.05em;">L</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-401" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">y</span></span></span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">G</span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">F</span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-416">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">b</span><span class="MJXp-msubsup" id="MJXp-Span-423"><span class="MJXp-mrow" id="MJXp-Span-424" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-426" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">y</span><span class="MJXp-mtext" id="MJXp-Span-428">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">m</span><span class="MJXp-msubsup" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-434" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-439">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">y</span><span class="MJXp-mo" id="MJXp-Span-441">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-443">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">t</span><span class="MJXp-mtext" id="MJXp-Span-448">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-449"><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">G</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">y</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">y</span><span class="MJXp-mtext" id="MJXp-Span-457">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">t</span><span class="MJXp-mtext" id="MJXp-Span-463">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-464"><span class="MJXp-mrow" id="MJXp-Span-465" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-467" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-470">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">b</span><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mrow" id="MJXp-Span-478" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">E</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-480" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">x</span><span class="MJXp-mtext" id="MJXp-Span-482">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">m</span><span class="MJXp-msubsup" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-488" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-493">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">x</span><span class="MJXp-mo" id="MJXp-Span-495">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-497">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">t</span><span class="MJXp-mtext" id="MJXp-Span-502">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-503"><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">F</span><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">x</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">x</span><span class="MJXp-mtext" id="MJXp-Span-511">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">t</span><span class="MJXp-mtext" id="MJXp-Span-517">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-518"><span class="MJXp-mrow" id="MJXp-Span-519" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-521" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> L_ {identity} (G, F) = \ mathbb {E} _ {y \ sim p_ {data} (y)} [\ left \ | G (y) -y \ right \ | _1] + \ mathbb {E} _ {x \ sim p_ {data} (x)} [\ left \ | F (x) -x \ right \ | _1] </script></p><br><p>  To (my) surprise, this helped solve the problem of preserving colors.  Here are examples from the authors of the article (Monet‚Äôs paintings are trying to be converted into real photos): </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e427442a79c604925360.png"><br><br><h3 id="arhitektury-ispolzuemyh-setey">  Network Architecture </h3><br><p>  In order to describe the used architecture, we introduce some conventions. <br>  <code>c7s1-k</code> is a 7x7 convolutional layer followed by a batch normalization and ReLU, with Straight 1, Padding 3 and the number of filters k.  Such layers do not reduce the dimension of our image.  Example on pytorch: </p><br><pre> <code class="python hljs">[nn.Conv2d(n_channels, inplanes, kernel_size=<span class="hljs-number"><span class="hljs-number">7</span></span>, padding=<span class="hljs-number"><span class="hljs-number">3</span></span>), nn.BatchNorm2d(k, affine=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>), nn.ReLU(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)]</code> </pre> <br><p>  <code>dk</code> - 3x3 convolutional layer with a stride 2 and the number of filters k.  Such convolutions reduce the dimension of the input image by 2 times.  Again the pytorch example: </p><br><pre> <code class="python hljs">[nn.Conv2d(inplanes, inplanes * <span class="hljs-number"><span class="hljs-number">2</span></span>, kernel_size=<span class="hljs-number"><span class="hljs-number">3</span></span>, stride=<span class="hljs-number"><span class="hljs-number">2</span></span>, padding=<span class="hljs-number"><span class="hljs-number">1</span></span>), nn.BatchNorm2d(inplanes * <span class="hljs-number"><span class="hljs-number">2</span></span>, affine=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>), nn.ReLU(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)]</code> </pre> <br><p>  <code>Rk</code> - residual block with two 3x3 convolutions with the same number of filters.  The authors, it is designed as follows: </p><br><pre> <code class="python hljs">resnet_block = [] resnet_block += [nn.Conv2d(inplanes, planes, kernel_size=<span class="hljs-number"><span class="hljs-number">3</span></span>, stride=<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-number"><span class="hljs-number">1</span></span>), nn.BatchNorm2d(planes, affine=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>), nn.ReLU(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)] resnet_block += [nn.Conv2d(planes, planes, kernel_size=<span class="hljs-number"><span class="hljs-number">3</span></span>, stride=<span class="hljs-number"><span class="hljs-number">1</span></span>, padding=<span class="hljs-number"><span class="hljs-number">1</span></span>), nn.BatchNorm2d(planes, affine=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)]</code> </pre> <br><p>  <code>uk</code> - 3x3 up-convolution layer with BatchNorm and ReLU - to increase image dimension.  Again an example: </p><br><pre> <code class="python hljs">[nn.ConvTranspose2d(inplanes * <span class="hljs-number"><span class="hljs-number">4</span></span>, inplanes * <span class="hljs-number"><span class="hljs-number">2</span></span>, kernel_size=<span class="hljs-number"><span class="hljs-number">3</span></span>, stride=<span class="hljs-number"><span class="hljs-number">2</span></span>, padding=<span class="hljs-number"><span class="hljs-number">1</span></span>, output_padding=<span class="hljs-number"><span class="hljs-number">1</span></span>), nn.BatchNorm2d(inplanes * <span class="hljs-number"><span class="hljs-number">2</span></span>, affine=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>), nn.ReLU(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)]</code> </pre> <br><p>  With the above designations, a generator with 9 reznet-blocks looks like this: </p><br><p> <code>c7s1-32,d64,d128,R128,R128,R128,R128,R128,R128,R128,R128,R128,u64,u32,c7s1-3</code> </p> <br><p>  We do the initial convolution with 32 filters, then reduce the image twice, simultaneously increasing the number of filters, then go 9 reznet-blocks, then twice increasing the image, reducing the number of filters, and creating a final 3-channel output of our neural network. </p><br><p>  For the discriminator, we will use the notation <code>Ck</code> - 4x4 convolution followed by a batch-norm and LeakyReLU with parameter 0.2.  The discriminator architecture is as follows: </p><br><p> <code>C64-C128-C256-C512</code> </p> <br><p>  In this case, for the first layer of <code>C64</code> we do not do BatchNorm. <br>  And at the end we add one neuron with a sigmoid activation function, which says whether it has come to fake or not. </p><br><h4 id="esche-paru-slov-pro-diskriminator">  Just a few words about the discriminator </h4><br><p>  Such a discriminator is the so-called fully-convolutional network - there are no fully connected layers, only convolution.  Such networks can receive images of any size as input, and the number of layers controls the receptive field of the network.  For the first time such an architecture was presented in the <a href="">Fully Convolutional Networks for Semantic Segmentation</a> article. </p><br><p>  In our case, the generator mapping the input image is not on one scalar, as usual, but on 512 output images (of reduced size), which are used to draw the "real or fake" output.  This can be interpreted as a weighted vote on 512 patches of the input image.  The size of the patch (receptive field) can be estimated by forwarding all activations back to the input.  But good people <a href="">made a utility</a> that considers everything for us.  Such networks are also called PatchGAN. </p><br><p>  In our case, the 3-layer PatchGAN with an input image of 256x256 has a receptive field of 70x70, and this is equivalent to how we would cut out a few random patches of 70x70 from the input and judged by it, the actual picture came or generated.  By controlling the depth of the network, we can control the size of the patches.  For example, a 1-layer PatchGAN has a 16x16 receptive field, and in this case we are looking at low-level features.  5-layer PatchGAN will already look at almost the entire picture.  <a href="https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix/issues/39">Here</a> Phillip Isola clearly explained all this magic to me.  Read, you too should become clearer.  The main thing: fully convolutional networks work better than usual, and they should be used. </p><br><h3 id="osobennosti-obucheniya-cycle-gan">  Features of learning Cycle-GAN </h3><br><h4 id="dannye">  Data </h4><br><p>  To begin with, we tried to solve the problem of transforming the faces of men into women and vice versa.  The blessing, for this purpose is.  For example, <a href="http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html">CelebA</a> , containing 200 thousand photos of celebrities with binary marks Gender, Points, Beard, etc. </p><br><img src="https://habrastorage.org/getpro/habr/post_images/bf6/4f6/d84/bf64f6d843684dcdfd738e05bf1d3ec6.png"><br><br><p>  Actually, having broken this dataset by the necessary attribute, we get about 90k pictures of men and 110k - women.  These are our DomainX and DomainY. </p><br><p>  However, the average size of the faces on these photos is not very large (about 150x150), and instead of resizing all the images to 256x256, we brought them to 128x128.  Also, to preserve the aspect ratio, the pictures did not stretch, but fit into the black square 128x128.  A typical generator input might look like this: </p><br><img src="https://habrastorage.org/webt/59/e4/29/59e429fd4f898333465018.png"><br><br><h4 id="perceptual-loss">  Perceptual Loss </h4><br><p>  Intuition and experience prompted us to consider identity loss not in the pixel space, but in the feature space of the pre-trained VGG-16 network.  This is the trick that was first introduced in the article <a href="https://arxiv.org/abs/1603.08155">Perceptual Losses for Real-Time Style Transfer and Super-Resolution</a> and is widely used in Style Transfer tasks.  The logic here is simple: if we want to make generators invariant to the style of images from the target domain, then why consider the error on pixels, if there are features containing style information.  What effect this has led you will find out a little later. </p><br><h4 id="procedura-obucheniya">  Learning procedure </h4><br><p>  In general, the model was quite cumbersome, 4 networks are studying right away.  Images on them should be driven back and forth several times to calculate all the losses, and then spread back all the gradients.  One epoch of learning at CelebA (200k pictures 128x128) on GForce 1080 takes about 5 hours.  So do not particularly experiment.  Let me just say that our configuration differed from the author only by replacing Identity Loss with Perceptual.  PatchGANs with more or fewer layers did not go, left 3-ply.  Optimizer for all networks - Adam with parameters <code>betas=(0.5, 0.999)</code> .  The learning rate defaults to <code>0.0002</code> and decreases each epoch.  BatchSize was equal to 1, and in all grids BatchNorm was replaced (by the authors) with InstanceNorm.  An interesting point is that the input to the discriminator was not the last output of the generator, but a random picture from the buffer of 50 images.  Thus, the discriminator could come image generated by the previous version of the generator.  This trick and many others that the authors used are listed in the Sumit Chintala note (by PyTorch) <a href="https://github.com/soumith/ganhacks">How to Train a GAN?</a>  <a href="https://github.com/soumith/ganhacks">Tips and tricks to make GANs work</a> .  I recommend to print this list and hang it near the workplace.  We did not reach out to try everything that is there, for example, LeakyReLU and alternative methods of upsampling for the generator.  But they fiddled with the discriminator and training schedule of the generator / discriminator pair.  It really adds stability. </p><br><h3 id="eksperimenty">  Experiments </h3><br><p>  Now will go more pictures, you probably already waited. </p><br><p>  In general, learning of generative networks is somewhat different from other tasks of deep learning.  Here you often will not see your usual picture of the downward-losing and growing metrics of quality.  Rate how good your model can only be looking at the outputs of the generators.  A typical picture that we saw looked like this: </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4274299afb149467150.png"><br><br><p>  The generators gradually disperse, the other Losses slightly decreased, but nevertheless, the network produces decent pictures and obviously learned something.  By the way, we used <a href="https://github.com/facebookresearch/visdom">visdom</a> , a fairly easy to set up and handy tool from Facebook Research, to visualize the course of the model.  Every few iterations we looked at the following 8 pictures: </p><br><ul><li>  real_A - login from domain A </li><li>  fake_B - real_A, converted by generator A-&gt; B </li><li>  rec_A - reconstructed image, fake_B, converted by generator B-&gt; A </li><li>  idty_B - real_A, converted by generator B-&gt; A </li><li>  and 4 similar images on the reverse side </li></ul><br><p>  In average, good results can be seen after the 5th era of training.  Look, the error of the generators does not decrease in any way, but this did not prevent the network from turning a person like Hinton into a woman.  Nothing holy! </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4274246dfb074842905.png"><br><br><p>  Sometimes things can go really bad. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e42741769c5974602574.png"><br><br><p>  In this case, you can press Ctrl + C and call journalists, tell how you stopped artificial intelligence. </p><br><p>  In general, despite some artifacts and low resolution, Cycle-GAN with a bang coped with the task. <br>  See for yourself: </p><br><p>  Men &lt;-&gt; Women </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e427426f092592851865.png"><br><br><p>  White &lt;-&gt; Asians </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e42740d6f56743534790.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273fa2b62216788041.png"><br><p>  White &lt;-&gt; Black </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273fc7909306248666.png"><br><br><p>  Have you noticed the interesting effect that identity mapping and perceptual loss give?  Look at idty_A and idty_B.  A woman becomes more feminine (more make-up, smooth, light skin), a man gets facial hair, whites become even whiter, and black, correspondingly, blacker.  Generators learn the average style for the entire domain, thanks to perceptual loss.  This is where the creation of an application for the "beautification" of your photos is directly suggested.  Shut up and give me your money! </p><br><p>  Here is Leo: </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273e8ee52518779338.png"><br><br><p>  And a few more celebrities: </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273d9464a102244832.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273de8f64628922935.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273e47307285437819.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273dc642b761394027.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273e1df34376192671.png"><br><p>  Personally, this guy-Jolie scared me. </p><br><p>  And now, attention, a very complicated case. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273e671b8820783914.png"><br><br><h2 id="uvelichenie-razresheniya">  Increase resolution </h2><br><p>  CycleGAN coped well with the task.  But the resulting images are of small size and some artifacts.  The task of increasing the resolution is called Image Superresolution.  And we have already learned how to solve this problem using neural networks.  I want to mention two state-of-the-art models: SR-ResNet and EDSR. </p><br><h3 id="srresnet">  SRResNet </h3><br><p>  In the article " <a href="https://arxiv.org/abs/1609.04802">A Generative Adversarial Network", the</a> authors propose a generation network architecture for the super-resolution task (SRGAN), which is based on ResNet.  In addition to the pixel-based MSE, the authors add Perceptual loss using activations from the pre-trained VGG (see, everyone does it!) And the discriminator, naturally. </p><br><p>  The generator uses residual blocks with 3x3 convolutions, 64 filters, batchnorm and ParametricReLu.  Two subPixel layers are used to increase the resolution. </p><br><p>  The discriminator has 8 convolutional layers with a 3x3 core and an increasing number of channels from 64 to 512, activation everywhere is LeakyReLu, after each doubling of the number of features, the image resolution decreases due to stride in convolutions.  There are no pooling layers; at the end, two fully connected layers and a sigmoid for classification.  A schematic of the generator and discriminator is shown below. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e42744b3bcd620147213.png"><br><br><h3 id="edsr">  EDSR </h3><br><p>  <a href="https://arxiv.org/abs/1707.02921">Enhanced Deep Super-Resolution network</a> is the same SRResNet, but with three modifications: </p><br><ul><li>  No batch normalization.  This allows reducing up to 40% of the memory used during training and increasing the number of filters and layers </li><li>  Outside residual blocks not used ReLu </li><li>  all resnet blocks are multiplied by a factor of 0.1 before adding them to previous activations.  This allows you to stabilize learning. </li></ul><br><h3 id="obuchenie">  Training </h3><br><p>  To learn the SR network, you need to have high resolution datsets.  Some effort and time had to be spent on parsing several thousand photos from instagram on the #face hashtag.  But where without it, we all know that the collection and processing of data is 80 +% of the volume of our work. </p><br><p>  Teaching the SR network is not made on full images, but on small patches cut from them.  This allows the generator to learn how to work with small parts.  And in the working mode, the input of the network can be submitted images of any size, because this is a fully-convolutional network. </p><br><p>  In practice, the EDSR, which supposedly should work better and faster than its predecessor SRResNet, did not show the best results and studied much slower. </p><br><p>  As a result, we chose SRRestNet, trained on 64x64 patches, for our Peripual loss 2 and 5 layers of VGG-16 were used, and we generally removed the discriminator.  Below are a few examples from the training set. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273d85cc7009582442.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273d5142d798945157.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273d228b9283523262.png"><br><br><p>  And this is how this model works on our artificial images.  Not ideal, but not bad. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273cbca6a485435577.png"><br><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273c8ddff209814693.png"><br><br><h2 id="vstavka-izobrazheniya-v-original">  Insert image in original </h2><br><p>  Even this task can be solved by neural networks.  I found one interesting job on image blending.  <a href="https://arxiv.org/abs/1703.07195">GP-GAN: Towards Realistic High-Resolution Image Blending</a> .  I will not tell the details, I will show only a picture from the article. </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e42745448c0670077398.png"><br><br><p>  We did not have time to implement this thing, we got off with a simple solution.  We insert our square with the transformed face back into the original, gradually increasing the transparency of the image closer to the edges.  It turns out like this: </p><br><img src="https://habrastorage.org/webt/59/e4/2d/59e42d17e73db344843421.png"><br><br><p>  Again, not ideal, but in haste - ok. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Many things can still be tried to improve the current result.  I have a whole list, I just need time and more video cards. </p><br><p>  And in general, I really want to get together on some hackathon and finish the resulting prototype to a normal web application. </p><br><p>  And then you can think about trying to transfer Ghana to mobile devices.  To do this, you need to try different techniques to accelerate and reduce neural networks: factorization, knowledge distillation, that's all.  And about this we will soon have a separate post, stay tuned.  See you again! </p><br><img src="https://habrastorage.org/webt/59/e4/27/59e4273c29599432562566.png"></div><p>Source: <a href="https://habr.com/ru/post/340154/">https://habr.com/ru/post/340154/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340140/index.html">WiFi roaming - 802.11i / r / k / v / OKC, what we really need and how to recognize it</a></li>
<li><a href="../340144/index.html">Waf eyes hackers</a></li>
<li><a href="../340146/index.html">Five easy steps for understanding JSON Web Tokens (JWT)</a></li>
<li><a href="../340148/index.html">Digital events for the week</a></li>
<li><a href="../340150/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ284 (October 9 - 15, 2017)</a></li>
<li><a href="../340156/index.html">FrontFest.JS: ClojureScript in production, optimization of React rendering and how to (not) get depressed with Angular</a></li>
<li><a href="../340158/index.html">VoIP server for a small company (FreePBX 14, Asterisk 15, Ubuntu 16.04) part 2</a></li>
<li><a href="../340160/index.html">Header design features</a></li>
<li><a href="../340164/index.html">Information security in the process control system: attack vector man-machine interface</a></li>
<li><a href="../340166/index.html">How Android Converts Resource Sizes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>