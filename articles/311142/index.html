<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Grouping Fancy Bear uses malware for OS X in cyber attacks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The cyber grouping of Fancy Bear (Sofacy, APT 28, Sednit, Pawn Storm, TsarTeam) has already gained sufficient fame in the media space due to recent cy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Grouping Fancy Bear uses malware for OS X in cyber attacks</h1><div class="post__text post__text-html js-mediator-article">  The cyber grouping of Fancy Bear (Sofacy, APT 28, Sednit, Pawn Storm, TsarTeam) has already <a href="https://www.wada-ama.org/en/media/news/2016-09/wada-confirms-attack-by-russian-cyber-espionage-group">gained</a> sufficient fame in the media space due to recent cyber attacks on the servers of the world anti-doping agency WADA.  Later, an account supposedly belonging to this group appeared on Twitter, in which from time to time the publication of various parts of the WADA data received by Fancy Bear was announced. <br><br><img src="https://habrastorage.org/files/962/674/732/9626747323a54b31b36ea2518659e121.jpeg"><br>  Yesterday, the famous American security company Palo Alto Networks <a href="http://researchcenter.paloaltonetworks.com/2016/09/unit42-sofacys-komplex-os-x-trojan/">published the</a> results of a new Trojan research for OS X called Komplex, which was used by Fancy Bear for cyber attacks on poppy users.  ESET AV products detect this malware as <b>OSX / Komplex.A</b> .  Komplex collects basic information about the user's system and sends it to the server.  This information includes the system version, user name, list of running processes.  After that, the data is sent in encrypted form to the managing C &amp; C server. <br><br><a name="habracut"></a>  The involvement of Fancy Bear in Komplex malware is confirmed by the indicators of the infrastructure they use.  In particular, the apple-iclouds [.] Net and itunes-helper [.] Net domains used to communicate with C &amp; C have already been used by grouping in previous cyber attacks.  The same applies to the domain appleupdate [.] Org, which itself was not noticed in use, however, the IP address to which it was mapped was previously used as a managing server for the previous malicious campaign. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Installation of malware into the system is divided into several stages.  On the first, a special executable file gets to the user, which saves the Komplex dropper to the disk, as well as a PDF document as bait.  Palo Alto Networks specialists have discovered variants of this executable file for both 32-bit and 64-bit systems.  Regardless of the architecture, it saves the Trojan dropper to the / tmp / content directory.  After that, the document is opened by the Preview application. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/77b/3bf/955/77b3bf95554a4e4a81a3c9c6c1ffb0ce.png"></div><br>  <em>Fig.</em>  <em>The part of the Mach-O code of the file that drops the Komplex dropper file to the disk, as well as the document bait.</em>  <em>(Palo Alto Networks data)</em> <br><br>  The document is saved to a file called roskosmos_2015-2025.pdf, the screenshot below shows one of its pages.  It is called the ‚ÄúProject of the Federal Space Program of Russia for 2016-2025‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/391/3bd/bc1/3913bdbc1e7848be8b2d71849a06684d.png"></div><br>  <em>Fig.</em>  <em>Part of the bait document.</em>  <em>(Palo Alto Networks data)</em> <br><br>  The Komplex dropper is responsible for installing the third executable file into the system and setting the necessary OS X system parameters for it to ensure that it starts after a reboot.  The dropper file contains the debug line "/ Users / kazak / Desktop / Project / komplex", which indicates the name Komplex. <br><br>  The dropper itself is quite simple in terms of the functions it performs, since all calls to important functions are concentrated in the starting function <i>_main</i> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9f7/6a3/eb1/9f76a3eb1aa748fea51d7af348b0ab1f.png"></div><br>  <em>Fig.</em>  <em>Function code _main dropper.</em>  <em>(Palo Alto Networks data)</em> <br><br>  The main task of the dropper is to install the payload component in the system.  It is saved to the <i>Users / Shared / .local / kextd file</i> .  Immediately after its launch in the system, the payload executable file checks the debugger activity using a special method.  To do this, use a function called <i>AmIBeingDebugged</i> .  The function code uses the <i>sysctl</i> call to check for the P_TRACED debug flag, which indicates this.  It is interesting to note that this feature is very similar to Apple‚Äôs proposed method of checking debugging applications in its <a href="https://developer.apple.com/library/content/qa/qa1361/_index.html">Detecting the Debugger</a> manual. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/023/e38/29d/023e3829d95540d08ab3ce1421423973.png"></div><br>  <em>Fig.</em>  <em>The anti-debug code of the Komplex payload.</em>  <em>(Palo Alto Networks data)</em> <br><br>  After this check, the payload code performs another check for the presence of a sandbox environment, which is used by automatic file analysis tools.  To do this, it sends a request to the Google search engine, which indicates the possibility of successful interaction with its C &amp; C server only if there is an Internet connection.  The code for this function is shown below. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ae6/1ea/fd2/ae61eafd293a447c8a5c972e0f2aa82d.png"></div><br>  <em>Fig.</em>  <em>Code checking the possibility of access to the Internet.</em>  <em>(Palo Alto Networks data)</em> <br><br>  After collecting the above system data, Komplex sends it in encrypted form to a remote C &amp; C server using an HTTP POST request. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0de/49e/feb/0de49efeb120446e9726a968f5f0a423.png"></div><br>  <em>Fig.</em>  <em>Encrypted system data sent by malware to a remote server.</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/20e/322/4ff/20e3224ff8f74c50962dadaf7c507dbd.png"></div><br>  <em>Fig.</em>  <em>The function of collecting data on the system.</em>  <em>(Palo Alto Networks data)</em> <br><br>  We previously wrote about the activities of Fancy Bear in the following posts. <br><br>  ¬ª <a href="https://habrahabr.ru/company/eset/blog/239979/">Sednit hacker group switched to using their own set of exploits</a> <br>  ¬ª <a href="https://habrahabr.ru/company/eset/blog/243309/">Hacker group Sednit specializes in attacks against isolated air-gapped networks</a> <br>  ¬ª <a href="https://habrahabr.ru/company/eset/blog/256171/">Sednit hacker group uses 0day exploits for cyber attacks</a> </div><p>Source: <a href="https://habr.com/ru/post/311142/">https://habr.com/ru/post/311142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311130/index.html">UWP beginner: Responsive Design (VB.NET + C #)</a></li>
<li><a href="../311134/index.html">Locks aren't that slow.</a></li>
<li><a href="../311136/index.html">The Incredible Adventures of Aliens in Y Combinator</a></li>
<li><a href="../311138/index.html">Creating Babylon.js and WebGL based shaders: theory and examples</a></li>
<li><a href="../311140/index.html">Measuring Apache Ignite Cache Performance</a></li>
<li><a href="../311144/index.html">We integrate messengers (using Slack as an example): GitHub, RSS (in particular, Java), jobs for your request</a></li>
<li><a href="../311146/index.html">Welcome to Spark ... on Java: Interview with Evgeny Borisov</a></li>
<li><a href="../311150/index.html">Analysis of the use of data redundancy as the required additional memory when sorting by the merge algorithm</a></li>
<li><a href="../311152/index.html">Truth born in the dispute about the ratings of popular programming languages</a></li>
<li><a href="../311154/index.html">Smart Bunker FX - solution for Microcentre Data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>