<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meet Envoyer.io (part 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Envoyer is a new service from Taylor Otvall, the creator of Laravel. Now you can see a series of screencasts on Laracasts about this service. This is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meet Envoyer.io (part 2)</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://envoyer.io/">Envoyer</a> is a new service from Taylor Otvall, the creator of Laravel.  Now you can see a <a href="https://laracasts.com/series/envoyer">series of screencasts on Laracasts</a> about this service.  This is the second and last part of the description of this service. <br><br>  <a href="http://habrahabr.ru/post/253217/">Meet Envoyer.io (Part 1)</a> <br><br>  This section will describe the more advanced features of Envoyer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/d85/dc2/0a1/d85dc20a1a9a461bbe03f6aa0ca5d2cb.png" alt="image"><br><br><a name="habracut"></a><br><br><h4>  Customization Deploy Hooks </h4><br>  Envoyer has 4 steps in the deployment process, and you, in turn, can execute any of your scripts <i>before</i> and <i>after</i> any of these steps.  These steps are: <b>Clone of a new release</b> , <b>Installing a dependency composer</b> , <b>Activating a new release,</b> and <b>Deleting old releases</b> . <br><img src="https://habrastorage.org/files/1d4/253/ddf/1d4253ddf21a41728c6de8701146e9ba.png" alt="image"><br><br>  Next to each step there is a ‚Äúgear‚Äù button, clicking on it takes you to the next screen: <br><img src="https://habrastorage.org/files/e7c/a7a/314/e7ca7a314e7c4657a5842153f52ed178.png" alt="image"><br><br>  There you can add hooks before and after the selected step.  Click on the <b>Add Hook</b> in the part you need. <br><img src="https://habrastorage.org/files/b4d/fb0/701/b4dfb07017b243579a08038703b07be3.png" alt="image"><br><br>  As you can see, for each hook you can specify your name, specify the user under which the script should be executed, and the body of the hook, which has access to the <b><code>{{release}}</code></b> variable, which stores the path in the folder of the newest release (for example, <code>/home/my-user/website.com/releases/20150316083301</code> ). <br>  Note that you can also change the order in which the hooks are executed via drag &amp; drop. <br><img src="https://habrastorage.org/files/2f8/805/f0f/2f8805f0f10a4e8da16d0f1f8d86719f.png" alt="image"><br><br><h4>  Cancellations </h4><br>  But what if you completed the new deployment and realized that you broke everything?  Usually, you would connect to the server via ssh, <code>git log</code> , search for the desired commit, copy the hash of the commit, <code>git checkout THAT_HASH</code> , <code>composer install</code> , and only then, perhaps, calm down for a few minutes. <br><br>  Using Envoyer, your previous release will be up and running in the <code>releases</code> folder.  Just go to the dashboard of your project, find the deploy that deploil the working code and click the ‚ÄúRedeploy‚Äù button.  The <code>current</code> symbolic link will simply point to the working folder in the <code>releases</code> folder and everything will work again. <br><img src="https://habrastorage.org/files/885/339/e11/885339e117da4ec8887b4a87b0863a4a.png" alt="image"><br><br><h4>  Health </h4><br>  You may have noticed the <b>Post-Deployment Health</b> section on the project deshbord.  There are icons for New York, London and Singapore - three regions from which Envoyer checks the availability of your application.  Until you specify a Health Check URL, these icons will be question marks. <br><img src="https://habrastorage.org/files/343/275/cd9/343275cd93a0483db401270a55693699.png" alt="image"><br><br>  Each project can have a <b>Health Check URL</b> that will be called by Envoyer after each deployment.  You can edit this URL in the project settings. <br><img src="https://habrastorage.org/files/0b6/b2f/24b/0b6b2f24bd734552bf1f944557470492.png" alt="image"><br><br>  After deploying, Envoyer looks at the HTTP response from the specified URL, and will check if the response code is <code>200</code> (OK).  If so, then Envoyer considers the application "healthy."  You can specify the home page of your site or make a special test URL that can fully indicate whether your server is ‚Äúhealthy‚Äù. <br>  If all is well, you will see green checkmarks. <br><img src="https://habrastorage.org/files/65e/693/f63/65e693f63a87494fb044d96f69759555.png" alt="image"><br><br>  If something breaks, you will see red crosses (and then you will most likely need the Cancel section): <br><img src="https://habrastorage.org/files/967/6b1/b13/9676b1b138024e2e9c7bde51e290b86b.png" alt="image"><br><br><h4>  Multiple server deploy </h4><br>  If you want to deploy to several servers at once, just add them to the project and the server will automatically participate in the deployment. <br><br><h5>  Deploy stage </h5><br>  Note that when the deployment process is in progress, until the previous deployment step on each server is completed, no further steps are started, which allows the servers to remain fully synchronized with each other. <br><img src="https://habrastorage.org/files/bb6/da6/17d/bb6da617d05b4e90bf06a1eff1e3033f.png" alt="image"><br><br><h5>  Synchronization environment settings </h5><br>  If you have a local configuration file that needs to be synchronized with the servers ( <code>.env</code> in Laravel 5, <code>.env.php</code> in Laravel 4), click the <b>Manage Environment</b> button in the project dashboard. <br><br>  Note that the file is encrypted with a password that is not stored in Envoyer, so do not lose the ‚ÄúEnvironment Key‚Äù. <br><img src="https://habrastorage.org/files/679/5ce/729/6795ce72991e475a8523cfedb6dafd33.png" alt="image"><br><br>  As soon as you enter the password, you will be given a text field, which is essentially a code editor.  Write what you need in this field, and the contents will be saved to a file ( <code>.env</code> if you have selected the project type Laravel 5 or Other and <code>.env.php</code> if the project type is Laravel 4). <br><img src="https://habrastorage.org/files/676/721/071/6767210719a44abd9acf2f0715980f26.png" alt="image"><br><br>  Now select the servers on which you want to save it and save. <br>  Envoyer will save this file to the project root on servers and create all the necessary symbolic links. <br><br><h4>  Notifications </h4><br>  In the ‚ÄúNotifications‚Äù tab, you can configure Envoyer to notify you about important events.  Currently, Envoyer can notify in Hipchat and Slack. <br><img src="https://habrastorage.org/files/634/060/bdd/634060bdd3e146f0943a1145cf6d670c.png" alt="image"><br><img src="https://habrastorage.org/files/47d/e27/815/47de2781526f47999cecd8a5ad606499.png" alt="image"><br><br><h4>  Heartbeats </h4><br>  One of the biggest challenges in managing the ‚Äúhealth‚Äù of servers is ensuring that all cron tasks always work.  Envoyer Heartbeats allows you to establish the condition that if the specified URL is pinged with the specified frequency, then cron work is ‚Äúalive‚Äù.  If there is no ping, Envoyer will notify you. <br>  To add Heartbeat, in the Heartbeats tab, click on the <i>Add Heartbeat</i> button. <br><img src="https://habrastorage.org/files/852/a29/635/852a29635c534e18ba0773f798ae5561.png" alt="image"><br><br>  You can specify the name and specify the frequency with which the expected ping from the cron task. <br><img src="https://habrastorage.org/files/34c/5cc/20f/34c5cc20f13b40d085bbd61bdb3d6291.png" alt="image"><br>  Once you add it, the status will be Healthy.  Until that time passes, the status will remain Healthy.  That is, if you choose 10 minutes, it will remain Healthy for 10 minutes after creation. <br><br><h5>  Ping heartbeat </h5><br>  Each Heartbeat has its own unique URL, which can be obtained from the Heartbeats tab.  It will be in the following format: <code><a href="https://beats.envoyer.io/heartbeat/203849102395790125"></a> beats.envoyer.io/heartbeat/203849102395790125</code> <br>  In a regular cron file, you can do this in order to pingan Heartbeat: <br><pre> <code class="bash hljs">php yourfile.php &amp;&amp; curl https://beats.envoyer.io/heartbeat/203849102395790125</code> </pre><br><br>  If you are using Laravel, in the latest version, the <code>thenPing()</code> method was added to the <code>thenPing()</code> , which allows you to ping any URL after executing the cron task.  This is perfect for heartbeats: <br><img src="https://habrastorage.org/files/190/90e/d83/19090ed832614736a6c55ed738aad6c5.png" alt="image"><br><br>  Here is the notification if there is no ping: <br><img src="https://habrastorage.org/files/80d/eb6/a88/80deb6a881b74b31bc96d245af944d58.png" alt="image"><br><br><h4>  Teamwork </h4><br>  Envoyer allows unlimited people to access your servers.  If someone in your team wants to work with you on the deployment of servers, but does not want to create your account with details of the payment card, you can create an account by selecting ‚ÄúI'm just collaborating with others.‚Äù During registration. <br><img src="https://habrastorage.org/files/b85/dce/3b1/b85dce3b1aa94c78a6426d5ced7e9305.png" alt="image"><br><br>  Each project has a Collaborators tab, where you can add people by entering their email. <br><img src="https://habrastorage.org/files/0f6/dfd/170/0f6dfd1700604c35b4b827cc33d1d351.png" alt="image"><br><br>  Notice that these people will have access to all functions except deleting the project. <br><br><h4>  FAQ </h4><br><br><h6>  Will Envoyer be a replacement for Forge? </h6><br>  Not.  Envoyer does not manage servers.  But he will make a great pair of Forge. <br><br><h6>  How does Envoyer log in to the server? </h6><br>  After adding a new server, Envoyer will give you the SSH key that you need to add the desired user to the <code>authorized_keys</code> file. <br><br><h6>  Can I use Envoyer with a non-Laravel project? </h6><br>  Yes of course.  True, some automatic settings will not work.  For example, automatic creation of symbolic links to the <code>storage</code> folder.  But this can be achieved using hooks. <br><br><h6>  If I use Forge, do I need to connect the site to the Git repository in Forge? </h6><br>  No, just start the site without connecting to any repository.  Everything else will make Envoyer himself. <br><br><h6>  What happens if an error occurs in any deployment step? </h6><br>  Envoyer will notice this and notify you.  Depla will be canceled. <br><img src="https://habrastorage.org/files/bfe/bc9/34a/bfebc934ae6a4dbe84cd88a58b83ff81.png" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/253278/">https://habr.com/ru/post/253278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253266/index.html">Gson cheat sheet for Map, List and Array</a></li>
<li><a href="../253268/index.html">How we spent 1 year and 3 months to develop a browser game</a></li>
<li><a href="../253270/index.html">Using Intel¬Æ C ++ Compiler Advanced Features for Android Applications</a></li>
<li><a href="../253272/index.html">Automate Cisco IOU from console</a></li>
<li><a href="../253274/index.html">Future C: OOP</a></li>
<li><a href="../253280/index.html">PVS-Studio: 25 suspicious code snippets from CoreCLR</a></li>
<li><a href="../253281/index.html">Unpleasant surprises from Tinypass or not worth chasing a subscription discount</a></li>
<li><a href="../253283/index.html">Microsoft Technology Expedition Starts March 18 in St. Petersburg</a></li>
<li><a href="../253285/index.html">Finding relationships using the Oil Ruble example</a></li>
<li><a href="../253287/index.html">Update Opera Mini servers: Flexbox, ES5, HTML5 parser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>