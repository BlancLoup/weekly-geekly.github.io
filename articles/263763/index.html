<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How does this mysterious HTC Dot View work?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the HTC world, there is such a thing as Dot View. HTC Dot View is a very original case that allows users of advanced models from HTC (One line) to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How does this mysterious HTC Dot View work?</h1><div class="post__text post__text-html js-mediator-article">  In the HTC world, there is such a thing as Dot View.  <a href="http://mobiltelefon.ru/post_1398075870.html">HTC Dot View</a> is a very original case that allows users of advanced models from HTC (One line) to use their device in a very non-standard way.  This accessory was designed to bring even greater fame to the company, and it seems that it successfully copes with its task: many people make their choice in favor of the HTC One * and thanks to the Dot View case. <br><br>  Such accessories attract not only users to do their numerous reviews, but also mobile developers to create non-standard applications that use these cool features.  The standard set of Dot View features from the manufacturer (HTC) is quite rich: a handy player with the flashing of tracks, displaying various notifications "to the dots" of the case, and even simple games that resemble the "eight-bit era" with their "big pixels".  But the problem is that the official developer did not provide not only an API for use, but not even the slightest instruction on how his brainchild Dot View works.  This led to the fact that enthusiasts had to understand <a href="http://www.youtube.com/watch%3Fv%3D-E0FbHp7rWA">independently</a> the mechanisms of pairing the cover with the device, and the researchers - to <a href="http://chezasite.com/news/haker-vzlomal-chehol-htc-80322.html">investigate</a> . <br><br>  In this topic, we will try to understand how this magic case from HTC functions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/ca2/7b7/111/ca27b711171b4ea5bc0f175eb30ed529.jpg"><br><br><a name="habracut"></a><br><br><h4>  All this is one big conspiracy !? </h4><br><br>  As mentioned above, this case was released by the official manufacturer specifically for their devices. <br>  The case is designed in such a way that the magnet, mounted in it, interacts with the internal equipment, allowing it to understand that the phone is wearing a case, and this case is the Dot View.  And the magnet itself is located here, right below the HTC label: <br><br><img src="https://habrastorage.org/files/87d/efc/9a8/87defc9a8b144b5db791cd06560ad38f.jpg"><br><br>  After putting the cover on the device, the services launched in the system begin to interact with the cover, intercepting the device‚Äôs power management (state) control modes and starting ‚Äúspecific‚Äù activities from the official manufacturer.  Ie, mobile devices are associated with this case both at the software level and in hardware.  A little more detailed review can be viewed <a href="http://www.androidcentral.com/dot-view-case">here</a> . <br><br><h4>  What if the API does not exist? </h4><br><br>  That was the question that had to be asked at first ... Indeed, it was hard to believe that for such a unique accessory no API for third-party developers was released.  In the process of searching the network, there were some examples that were somehow relevant, such as the implementation of <a href="http://repo.xposed.info/module/com.mohammadag.dotviewmodsforhtcmate">the</a> Dot View <a href="http://repo.xposed.info/module/com.mohammadag.dotviewmodsforhtcmate">module</a> for the custom Xposed framework, but nothing that could really push off and finally use the capabilities of Dot View in its own applications.  Therefore, I had to start my own investigation. <br><br>  The first step towards understanding the truth was to view the <i>logcat</i> , in which there were sorts, precisely indicating the presence in the system of some head component Dot View: <br><br><pre><code class="bash hljs">W/SensorService( 870): Listener[0] = com.htc.dotmatrix.CoverService<span class="hljs-variable"><span class="hljs-variable">$7</span></span>@24541961 W/SensorService( 870): Listener[1] = com.htc.dotmatrix.CoverService<span class="hljs-variable"><span class="hljs-variable">$7</span></span>@6b8ab5b W/SensorService( 870): Listener[2] = com.htc.dotmatrix.CoverService<span class="hljs-variable"><span class="hljs-variable">$7</span></span>@f1d0b5a ... D/DotMatrix( 1287): [CoverService] resetCoverViewState, poleN: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, state: <span class="hljs-literal"><span class="hljs-literal">true</span></span> D/DotMatrix( 1287): [CoverService] updateCoverState, (sticky)poleN: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, state: <span class="hljs-literal"><span class="hljs-literal">true</span></span> D/DotMatrix( 1287): [CoverService] updateCoverState, (intent)poleN: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, state: <span class="hljs-literal"><span class="hljs-literal">false</span></span> D/DotMatrix( 1287): [CoverService] updateCoverState, removeMessages EVENT_COVER_CLOSED D/DotMatrix( 1287): [CoverService] show cover D/DotMatrix( 1287): [DotImage] init com.htc.dotmatrix.ui.BackgroundImage D/DotMatrix( 1287): [DotImage] init com.htc.dotmatrix.ui.TemperatureImage D/DotMatrix( 1287): [DotImage] init com.htc.dotmatrix.ui.LastCallImage</code> </pre> <br><br>  The first thing that came to mind was the idea of ‚Äã‚Äãdecompiling the APK of the official <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.htc.dotmatrix%26hl%3Dru">HTC Dot View</a> application, because the most interesting logs from logcat referred to the package name of this application.  But in the end, no useful information, allowing you to write your code for the case, could be extracted except for the specific intent-action games used by broadcast receivers and intended to track the status of the case cover: open or closed. <br><br>  After some time of unsuccessful attempts to reach the point, I accidentally managed to stumble upon the ‚ÄúApplications‚Äù section in the official HTC application for Dot View, which had several ‚Äúdefault‚Äù applications: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/57b/9c7/de0/57b9c7de066942d5a569492584798d62.png"></div><br><hr><br><div style="text-align:center;"><img src="https://habrastorage.org/files/991/583/89e/99158389e8514b1aa91daa7375195a98.png"></div><br><br>  It became interesting here how the usual Android application differs from the Dot View application.  Ie at what level is the separation?  Looking for other applications on Google Play, we managed to get to the implementation of <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.htc.dotbreaker%26hl%3Dru">Dot Breaker</a> , which is a ‚Äúknock out building blocks‚Äù game.  Of course, like everyone else, it was from the official manufacturer. <br><br>  It is thanks to the Dot Breaker application that we managed to find out all the subtleties of the Dot View work and create our own application for the case. <br><br><h4>  Searches for the essence ... </h4><br><br>  Having performed the initial decompilation of the application, it is possible to look into the <a href="">application manifest</a> (AndroidManifest.xml). <br>  This manifesto was not much like the manifesto of the official HTC Dot View application.  The very first thing that caught my eye was the lack of a ‚Äúsheet‚Äù of permits: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.GET_TASKS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.htc.permission.dotviewgame"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br>  After all, the application, at least, controlled the state of the device.  And the resolution GET_TASKS is generally recognized as <a href="http://developer.android.com/reference/android/Manifest.permission.html">obsolete</a> .  Therefore, the following resolution was of the greatest interest.  From his name it is obvious that it is non-standard. <br><br>  Here is another constructive point, which is responsible for ensuring that the application appears in the very list of "Applications": <br><br><pre> <code class="xml hljs">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".WelcomePageActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.htc.intent.action.dotviewgame_launch"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre><br><br>  Roughly speaking, this custom action is like <i>‚Äúandroid.intent.category.LAUNCHER‚Äù</i> , only <i>‚Äúcom.htc.intent.action.dotviewgame_launch‚Äù</i> . <br>  And in assets (assets) all the animation that was present in the game was collected: <br><br><img src="https://habrastorage.org/files/8d3/4b6/87b/8d34b687b804453eba86784d63c95ad1.png"><br><br>  ... and in the future it will become clear why, because drawing on the points of the cover is not a very standard exercise. <br>  This was followed by a secondary decompilation, the purpose of which was a direct analysis of the decompiled Java code of the application.  (The decompiled code is presented in <a href="https://bitbucket.org/Asen/dotview_dotbreaker">the BitBucket repository</a> .) <br><br>  Based on the above piece of the manifest, we can conclude that the <i>WelcomePageActivity is the</i> main activity of the Dot Breaker <i>application</i> .  The only thing she does is show the initial animation (not yet associated with the Dot View) for 2 seconds and start the <i>GameLevel</i> activity, which is responsible for the level selection: <br><br><pre> <code class="java hljs">... <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mCountDownTimer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CountDownTimer(<span class="hljs-number"><span class="hljs-number">2000L</span></span>, <span class="hljs-number"><span class="hljs-number">2000L</span></span>) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFinish</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ WelcomePageActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.finish(); WelcomePageActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.startActivity(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(WelcomePageActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, GameLevel.class)); } } .start(); ...</code> </pre><br><br>  Activity <i>GameLevel</i> also allows you to select a level.  In its restored Java code, you can see the ‚Äúsheet‚Äù of initializations for all 20 levels of the application;  when clicking on the View of each of them, an AlertDialog will pop up, containing the following code for calling the application‚Äôs key activity - <b>GameActivity</b> : <br><br><pre> <code class="java hljs">... localBuilder.setPositiveButton(<span class="hljs-string"><span class="hljs-string">"OK"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DialogInterface.OnClickListener() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DialogInterface paramAnonymousDialogInterface, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> paramAnonymousInt)</span></span></span><span class="hljs-function"> </span></span>{ GameLevel.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.startActivity(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(GameLevel.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, GameActivity.class)); } }); ...</code> </pre><br><br>  This code is the ‚Äúlast frontier‚Äù, which is finally followed by the internal mechanisms for implementing the HTC Dot View concept. <br><br><h4>  How does this dot view work? </h4><br><br>  The key activity of <i>GameActivity</i> , which is an intermediary in the cycle of interaction with the Dot View, does not stand out in any way - it, like any other activity, is inherited from the <i>Activity</i> class.  This means that the interaction starts with the onCreate method.  In the code of this <i>GameActivity</i> activity <i>method,</i> you can find many calls responsible for the configuration and styling of the window (fullscreen, brightness, etc.), followed by a key call at the very end of the method: <br><br><pre> <code class="java hljs">... <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mDotViewCommunity.bindDotViewService();</code> </pre><br><br>  Here <i>this.mDotViewCommunity</i> is an instance of the wrapper class, which is a simple abstraction and implemented within the GameActivity class as a nested class.  You can ignore it, since this class does not play a significant role. <br>  But an important role is played by the method with the speaking (even screaming) name <i>‚ÄúbindDotViewService‚Äù</i> contained in this class.  At this stage, it can already be assumed that there is a linking with a certain service, possibly, for the purposes of interprocess communication (IPC). <br><br>  Here is the key code from the <i>bindDotViewService</i> method: <br><br><pre> <code class="java hljs">... DotViewSericeConnection mServiceConnect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DotViewSericeConnection(); ... Intent localIntent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(); localIntent.setClassName(<span class="hljs-string"><span class="hljs-string">"com.htc.dotmatrix"</span></span>, <span class="hljs-string"><span class="hljs-string">"com.htc.dotmatrix.GameService"</span></span>); bool3 = GameActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bindService(localIntent, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mServiceConnect, <span class="hljs-number"><span class="hljs-number">1</span></span>); ...</code> </pre><br><br>  As you can see, there is actually a linking with the custom Dot View service in order to further interact with it.  The class name of the service is <i>com.htc.dotmatrix.GameService</i> , and the package (application) to which this service belongs is <b>the very</b> official HTC Dot View application.  <i>DotViewSericeConnection</i> is a custom class Dot Breaker, which is an implementation of the standard Android <a href="http://developer.android.com/reference/android/content/ServiceConnection.html">ServiceConnection</a> interface for monitoring service status.  The <i>DotViewSericeConnection</i> class <i>is</i> also implemented as a class nested in an activity class. <br><br>  Well, maybe this is the expected outcome, but how does the interaction of the Dot Breaker game unfold after binding to the service from HTC? <br><br>  The <i>ServiceConnection</i> interface requires an overridden <a href="http://developer.android.com/reference/android/content/ServiceConnection.html"><i>onServiceConnected ()</i></a> method, which is called if it successfully connects to the service. <br>  In the case of a successful connection with the service, the code is called, the execution of which is the first of two steps on the way to using the Dot View: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onServiceConnected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ComponentName paramComponentName, IBinder paramIBinder)</span></span></span><span class="hljs-function"> </span></span>{ GameActivity.DotViewCommunity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Messenger(paramIBinder); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Message localMessage = Message.obtain(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); localMessage.replyTo = GameActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mMessenger; Bundle localBundle = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bundle(); <span class="hljs-comment"><span class="hljs-comment">//    ,  ""  Dot View localBundle.putString("activityName", GameActivity.class.getName()); localMessage.setData(localBundle); //    GameActivity.this.mService.send(localMessage); return; } catch (RemoteException localRemoteException){ ... } }</span></span></code> </pre><br><br>  Here you can observe a fairly standard client-server "communication" with the remote service in the context of Android. <br>  A message with <i>what-code = 1 is</i> pulled out of the global pool. <br>  And at the beginning of the activity class you can find the following set of constants: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MSG_DOTVIEW_CLIENT_PAUSE = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MSG_DOTVIEW_CLIENT_REGISTER = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MSG_DOTVIEW_CLIENT_RESUME = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MSG_DOTVIEW_CLIENT_UNREGISTER = <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre><br><br>  This means that the code of this method registered the activity as a new potential user. <br>  Then a similar code is called, but with what-code ‚Äú3‚Äù - <i>MSG_DOTVIEW_CLIENT_RESUME</i> . <br>  Immediately after that, the Dot View stops responding to the slam of the lid <b>for a given activity</b> and provides screen-Dot-View drawing of the activity that wants it, i.e. GameActivity. <br><br><h4>  Well, what about the bundle and communication with the service? </h4><br><br>  After telling <i>com.htc.dotmatrix.GameService</i> that the activity wants and is ready to use the case ‚Äúin its own way‚Äù, when the cover of the case is slammed, the screen will not go out (at first there will be a feeling that the Dot View functions simply stopped working) displaying the markup of the activity that ‚Äúcaptured‚Äù the Dot View mode.  If the screen goes out, then after double tapa (the standard way to ‚Äúwake up‚Äù Dot View) instead of the splash screen, again, there will be a markup of ‚Äúactivity-invader‚Äù. <br><br>  Activity works almost standardly: buttons can be placed on it, and their onclick will work, standard Android <a href="http://developer.android.com/reference/android/view/GestureDetector.html">gesture detectors</a> can be used - everything will work quite normally. <br><br>  But what is the difficulty then? <br>  Somehow in the beginning it was said that Dot Breaker stores all its animation in pictures.  One of the main reasons (but hardly the most important) is the specificity of drawing on the Dot View points.  That is why none of the official application and does not use the standard Android View, because they simply will not be visible!  A button with its standard font will not even look like a button, rather, like some kind of View-shaped spot, which can be clicked and something will happen ‚Äúunder the cover‚Äù.  It would seem that you can increase the size of the button and the text, but, although everything will become more visually intelligible, you still need a more reliable approach. <br><br>  Inside the <a href="">BrickView</a> class of the Dot Breaker application, there are sorts (some of the logic may be misunderstood due to the not entirely correct decompilation) of the method of converting screen pixels to DotView pixels.  He is definitely worth reading.  There is also a simpler, but less accurate way - to count the number of points of the cover: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9a3/ac0/bed/9a3ac0bed97f45d3bd04c3ad583a9599.png"></div><br><br>  The result was 27 weighty points in X and 48 in Y. By "weighty" should be understood such a DotView-point, which is imposed on the display device.  With such information, it is easy to write a method that would produce the desired scaling. <br><br><h4>  Completion: 1. </h4><br><br>  All the above material will be really interesting in the context of some practical implementation. <br>  As such, some simple game for the Dot View would work well. <br><br>  All test demo application encapsulates <a href="">3 activities</a> : <br><br>  1) <i><a href="">MainActivity</a></i> - serves only to display the application in the application menu (support for standard launch) and to launch a second activity or exit from the application. <br><br>  2) <a href="">DotRunner</a> - intermediate activity, the main purpose of which is to monitor the condition of the cover of the cover by means of a broadcast receiver and start / stop the third activity: <br><br><pre> <code class="java hljs">... BroadcastReceiver dotReceiver = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DotReceiver(); <span class="hljs-comment"><span class="hljs-comment">// () intent-action IntentFilter intentFilter = new IntentFilter("com.htc.cover.closed"); registerReceiver(dotReceiver,intentFilter); ... public class DotReceiver extends BroadcastReceiver { @Override public void onReceive(Context context, Intent intent) { boolean isCoverClosed = intent.getBooleanExtra("state",false); if(isCoverClosed) { startActivity(new Intent(DotRunner.this, DotActivity.class)); } else{ ... } } }</span></span></code> </pre><br><br>  3) <a href="">DotActivity</a> - an activity that interacts with the Dot View according to the rules described in the previous sections. <br><br>  For a more convenient drawing of the Dot View screen, taking into account scaling, it was necessary to create a custom view <a href="">DotMatrixView</a> , in which the game-test-process takes place and which implements all the logic of rendering ‚Äúlarge pixels‚Äù. <br><br>  The game, in turn, is extremely simple: you need to tap the cube to prevent it from falling: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/889/d89/140/889d8914089941d08fccf083204eeebd.png"></div><br><hr><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b90/aae/7b2/b90aae7b26a34397a1682fb8b76e364d.png"></div><br><br>  And to start a new game you will need to open and close the Dot View lid.  In addition, a gesture recognition interface was implemented inside the <i>DotMatrixView</i> game class (using the <a href="https://developer.android.com/training/gestures/detector.html">GestureDetector</a> class), with which you can start the game again by making a Fling gesture using the Dot View cover. <br><br>  A demonstration video of the custom application can be viewed <b><a href="https://youtu.be/_dgnhWeYvZw">here</a></b> . <br>  The source code of the test application is presented in <a href="https://bitbucket.org/Asen/dotview_dottestapp">the BitBucket repository</a> . <br><br><h4>  Completion: 0. </h4><br><br>  Having reviewed the principles of HTC Dot View, it became clear that this idea does not involve any secret principles: everything is the same old, but ‚Äúunder the new cover‚Äù. <br><br>  Without a doubt, we can say that modern users are very lucky with the time in which they exist: there are so many useful and interesting devices around that you don‚Äôt even keep up with everything, let alone experience it.  And the developers of things like the Dot View and create this modernity.  After all, it is from such trivialities that the whole is formed.  Therefore, an open and accessible API for such ‚Äútrifles‚Äù is more than just a software interface.  This is the ability to take a fresh look at the use of old concepts. <br>  ‚ÄúEverything new is well forgotten old‚Äù (c). </div><p>Source: <a href="https://habr.com/ru/post/263763/">https://habr.com/ru/post/263763/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263753/index.html">Search for similar groups and public Vkontakte</a></li>
<li><a href="../263755/index.html">Cybercriminals revived Darkode forum</a></li>
<li><a href="../263757/index.html">Skills of .NET-developer of Russia and the USA, what's the difference?</a></li>
<li><a href="../263759/index.html">Android found vulnerabilities that allow access to a smartphone via MMS</a></li>
<li><a href="../263761/index.html">GNS3 in the cloud</a></li>
<li><a href="../263765/index.html">Data structures Informal guide</a></li>
<li><a href="../263769/index.html">A brief history of the evolution of proof-of-work in cryptocurrencies. Part 1</a></li>
<li><a href="../263771/index.html">How to set up directory synchronization in IP PBX - search by ODBC</a></li>
<li><a href="../263773/index.html">How ITSM-System ServiceNow appeared in our cloud</a></li>
<li><a href="../263775/index.html">Algorithm for parsing arithmetic expressions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>