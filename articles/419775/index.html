<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>My version of the "device for lucid dreaming" - a brief history and description of the first version</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Note: The article is written solely for informational purposes, and is not a call to repeat such experiments at home due to the potential risk of harm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>My version of the "device for lucid dreaming" - a brief history and description of the first version</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i>Note: The article is written solely for informational purposes, and is not a call to repeat such experiments at home due to the potential risk of harm to physical health (in the case of use of Li-ion batteries and photoresistors in the devices).</i> </blockquote><br>  Good day, dear habouriors and habwearers) This is my first serious article on Habr√©, therefore, JUDGE MOSTLY STRICTLY, I promise to work on style and content. <br><a name="habracut"></a><br>  Briefly about yourself.  By education - instrument maker, master.  Occupation: entrepreneur, I am a co-founder of the network of robotics robots for children‚Äôs circles.  During his studies at the university he was engaged in various kinds of research in the field of medical measuring equipment. <br><br>  Long time was going to talk about these of their developments, but all hands did not reach ... <br>  Prehistory  Since childhood, I have often seen very vivid and plot dreams.  So plot and vivid that he was not lazy from the age of seven with enviable persistence to keep a diary of dreams.  And then, once, back in 2014, I got into the hands of a curious book called Dream Hackers.  Do I have to say how much I was interested in the phenomenon around which the story lined up?  Especially when taking into account the diary, which has exceeded in the amount of 2 notebooks of 96 sheets each, and since 2012 it has been running on a computer. <br><br>  A quick googling, after a significant anti-esoteric filtering, led me to scientific work on a subject.  As it turned out, the beginning of the study of the OS in the first half of the 20th century was put by a certain Dutch psychologist, Frederick Van Eden.  His article, ‚ÄúA Study of Dreams‚Äù (Proceedings of the Society for Psychical Research, vol. 26, p. 431), which aimed to classify dreams, contained the term ‚Äúlucid dreams‚Äù, which literally translates to ‚Äúclear dreams‚Äù.  As far as I know, this was the first mention of this phenomenon in scientific circles. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Years passed, but only in 1975, an experiment scientifically proved the existence of an operating system was carried out by the scientist Keith Hearne, Hull (England) University's sleep-laboratory.  As a result of the experiment, experimental Alan Worley showed conscious and pre-planned eye movements when, in all indications of the instruments, he was in a state of sleep.  This experiment was later rerun by scientist Stephen Laberge of Stanford University. <br><br>  The results of the experience became widely known, since Laberge made a huge contribution to the popularization of this subject.  Also, this scientist proposed a concept of a device called the ‚Äúinducer of lucid dreams,‚Äù which would allow anyone, even without a long workout, to enter the OS state ... <br><br>  After I read about the OS inductor, I could not sleep anymore.  Arduinschik soul inflamed incredible tide of enthusiasm!  The fact is that by that time I had already read a lot about various kinds of practices that allow me to realize in a dream, and all of them didn‚Äôt give any results without long training sessions and work on myself.  A dream to steer something hunting!) <br><br>  Having studied all the variety of OS inductors that were full of the market, as well as a homemade base, of which there were also a lot on the Web, I drafted a standard, the essence of which was to formulate: ‚Äúnot to do Remee, but closer to Dreamstalker, but more conveniently.  Technical requirements boiled down to these four points: <br><br><ol><li>  The device must reliably determine the phase of fast sleep (and not ‚Äúguess at NE555‚Äù, as it was, judging by the descriptions, in early versions of the Remee mask); <br></li><li>  The device should be compact and should not interfere with the sleep process; </li><li>  The device must be able to collect and display information about the sleep process in order to conduct real research, and not just play in the OS; </li><li>  The device must be safe to use. </li></ol><br>  Such are the requirements ... Nehilo for someone who at that time barely touched the basics of working with operational amplifiers, and generally poorly versed in circuit design) However, "young-green", and I began to develop. <br><br>  To begin with, I decided to take up the simplest question: what physiological parameters change during sleep?  The result of the search was this table (if anyone can add - write in the comments, I will be very happy): <br><br><img src="https://habrastorage.org/webt/yk/3m/t3/yk3mt3qysjhbnj_ttav6lgm39q8.png"><br><br>  The solid knowledge of the school course in biology and physics, together with moderate programming skills in C ++ and LabVIEW, as well as possession of some information from the field of measurement technology, allowed me to develop a block diagram of the device.  She looked like this: <br><br><img src="https://habrastorage.org/webt/ay/tt/7m/aytt7mis-xkf4wtlk9szarml3vk.png"><br><br>  The logic was as follows.  In order not to fence the measuring laboratory on the forehead of a person (and not to become like a working, but terribly inconvenient Dreamstalker mask), all measuring blocks from the mask should be removed.  Moreover, the found schemes of optical oculographs were either too complicated or extremely cumbersome.  And how to register an oculogram, you ask?  After all, eye movements in a dream are the most reliable sign of REM sleep! <br><br>  Well, then I decided that once the heartbeat is also changing in some way, then it will be possible to find the phase of rapid sleep and on it.  Thus, a device appeared in the device, with a pulse sensor on board.  And only the radio receiver unit and a handful of LEDs remained in the mask, which were supposed to be switched on by a command from a computer. <br><br>  The logical question is: why is there a computer, and why it was impossible to immediately send commands from the bracelet when it would detect the necessary changes in heart rhythm?  Firstly, I did not know which changes to consider as ‚Äúnecessary‚Äù.  Moreover, at the time, the person‚Äôs pulse graph of what a cardiointervalogram and heart rate variability look like is generally weak ... Secondly, various complex algorithms in a graphical development environment are much simpler and clearer to write, and finding the right sleep phase by heartbeat is clearly simple algorithms are not relevant, and therefore - LabVIEW to help. <br><br>  Circuitry <br><br>  Mask: <br><br><ol><li>  Platform Arduino Micro Pro (on ATmega32U4 stone) <br></li><li>  LEDs WS2812B </li><li>  Standard radio receiver module with 433 MHz carrier frequency </li><li>  Li-ion 200 mAh battery </li><li>  Charging module for battery on TP4056 microcircuit </li></ol><br>  In order of the choice of components.  The Micro Pro platform was chosen because of its compactness (due to the lack of CH3400 and the presence of built-in PLL and USB, but this is the lyrics), as well as low power consumption and just a pleasant appearance. <br><br>  I chose the addressable RGB LEDs because I wanted to see if the frequency of hits in the OS would not correlate with the color of the stimulating effect.  I know that sounds so-so, but who knows, right?) <br><br>  I chose the 433 MHz module for two reasons: because I hadn‚Äôt tried anything else from the wireless connection, and because I didn‚Äôt know what a colossal pig this module would fit me ... When it came to tests, it turned out that the antenna was meticulously measured, sewn along the contour of the mask, being close to the body, cannot work in principle.  As I was explained in the ‚ÄúRadio Amateur‚Äù group, to which I sometimes ask questions, due to the fact that the human body has a certain capacity, which is quite significant, and because of this, the receiver frequency is lost, as there is an oscillating circuit in it, and an extra capacity hinders him.  I do not understand everything, I don‚Äôt want to be dishonored, I can only say that at that time I couldn‚Äôt conduct experiments with a mask. <br><br>  I chose the battery because of its compactness, having sacrificed a safety requirement: a lithium ionnik attached to the nose, although it had a small capacity, could have damaged the eyes during an explosion.  Therefore, as best I could, I packed it in plastic from the side adjacent to my face and left open the opposite side.  This did not affect the compactness of the design, but added peace of mind, albeit unjustified. <br><br>  With the charging module, everything is simple: it is almost the industry standard for all sorts of home-made products, and here I was not steamed about anything. <br><br>  Bracelet: <br><br><ol><li>  Arduino Nano Platform </li><li>  Homemade optical pulse sensor (more about it will tell later) <br></li><li>  Standard radio transmitter module (same 433 MHz) </li><li>  Holder for four AA </li><li>  4 Ni-Mh battery at 2700 mAh each </li></ol><br>  With the bracelet, things were better.  I collected the first version directly on the breadboard, and the antenna of the transmitting module did not fit directly to the body, therefore everything worked like a clock.  The only thing that deserves attention in the first version of the bracelet is the pulse sensor, which was perhaps my biggest problem, since I swam in analog electronics. <br><br>  A very good article about photoplethysmography and how different bracelets for fitness are arranged has become a foothold.  After reviewing the essence of the work of optical pulse sensors, I began to look for ready-made circuit solutions.  As a result, I stopped at this scheme, which earned almost immediately even on breadboard.  I didn‚Äôt look for an open channel optocoupler recommended by the author of the article, and simply tore the TCRT5000 out of the line sensor, which was accidentally left lying at home.  I replaced the operational amplifier with the more common LM358. <br><br><img src="https://habrastorage.org/webt/mv/mu/3_/mvmu3_aeyc6-0jhgqi_pb2udd1k.png"><br><br>  The sensor was made in the form of a ring, put on the pad of the finger.  The TCRT5000 was pressed tightly against the skin, and the signal from the phototransistor was amplified and transmitted by wire to the microcontroller, where it was digitized and sent further along the instances. <br><br>  Transmitting unit: <br><br><ol><li>  Arduino Nano Platform </li><li>  Standard radio receiver module with 433 MHz carrier frequency </li><li>  Standard radio transmitter module (same 433 MHz) </li></ol><br>  Everything is trivial: when the bracelet sends data, it is received by the receiver, and through the COM port sharashat into the computer, where they are met by the caring paws of my samopisny VI.  The first version of the virtual device stupidly built the ADC readings graph, and did not try to analyze anything by itself.  Subsequently, when it became more or less clear that it was necessary to analyze not the pulsogram, but the intervalogram built on it, and the patterns that often arise in the BDG phase were identified, data began to be sent from VI to the mask, giving a signal to activate the stimulation.  But until that moment it was still very far away)) <br><br>  The first night with a heart rate monitor revealed several unpleasant facts. <br><br>  First: due to the fact that in a dream the blood flow in the hand changes (for example, when I bend my arm and stay in this position for a long time), the sensor loses the signal and the graph becomes illegible.  I had no idea how to adjust the gain automatically. <br>  Second, the sensor could lose a signal on a flat spot, and a very low-frequency interference with a very large amplitude is superimposed on the graph itself, due to which it disappears from time to time.  Below is a screen of the testimony of one of the first (but not the first) working versions of the virtual instrument.  Pulsogram graph (red) is inverted, and low-frequency noise can be seen on the lower peaks. <br><br><img src="https://habrastorage.org/webt/y3/hg/fu/y3hgfuty_meypjerygheqahc5ea.png"><br><br>  The third fact: to sleep with a breadboard model and four batteries on your hand is not at all impossible, but extremely uncomfortable.  How it looked at first, you can see below (alas, except for photos from the diploma, nothing remains of that sketch))) <br><br><img src="https://habrastorage.org/webt/gr/gd/ub/grgdubgjop-ztdofam6lizefnx4.png"><br><br>  ‚ÄúWe need serious improvements!‚Äù - looking at the messy data, with harsh cabbage soup, I concluded.  And first of all I decided to finish the sensor, which was needed first of all to continue working on the device. <br><br>  Once again, after rereading the article on photoplethysmographs, I realized the following: why the hell <s><a href="https://www.youtube.com/watch%3Fv%3DCXoUndA090o%26feature%3Dyoutu.be">did I</a></s> use the IR optocoupler to use a <s><a href="https://www.youtube.com/watch%3Fv%3DCXoUndA090o%26feature%3Dyoutu.be">cable</a></s> if I could use any other color?  A graph illustrating the dependence of the absorption coefficient of light by hemoglobin on the wavelength was taken from the same article. <br><br><img src="https://habrastorage.org/webt/jg/e8/uw/jge8uwz-qiqdg19k8lozpw9orxm.png"><br><br>  Based on the graph, I chose green as the most absorbed by hemoglobin in both its states (saturated with oxygen and unsaturated).  Therefore, the sensor will become the most sensitive to changes in blood volume, and not to saturation with its oxygen (I suspected that I had a low-frequency disturbance because the sensitivity of the IR sensor changes significantly due to oxygen saturation of the blood). <br><br>  Under the spoiler: I wonder if it is impossible to track the respiratory rate just for this low-frequency noise? <br>  And everything would be fine, but here's the plug: what to choose as a sensitive element?  After a brief search, I found a cheap option - a photoresistor.  The advantages were obvious: the spectral peak of the most common models, just around 500 nm, is cheap, and its inertia, which is often reproached, is not significant in this case - the heartbeat itself is not very fast. <br><br>  Of the minuses, I noted for myself only that photoresistors contain cadmium and lead (which is why in some countries they were banned altogether), and it is not very good to use them in equipment that is in direct contact with the body.  But - science requires sacrifices, and I bungled the second version of the sensor: on two address LEDs (the wavelength of their green color was, according to the datasheet, just the way it was needed).  A plus was the fact that now it was possible to change the brightness programmatically, thus adjusting the sensitivity, albeit within small limits. <br><br><img src="https://habrastorage.org/webt/n5/qf/-k/n5qf-ksqdoei0umngh5bgss3nzc.png"><br><br>  As you can see, the illiterate (but minimally working) filtering and amplifying circuit remained in its place, and the sensor now has already got two wires to connect with the MC. <br><br>  When the layout was assembled, the tests showed a significant improvement in the measurement results.  Although the sensor could not work ‚Äúon reflection‚Äù (I wanted to make the bracelet a full bracelet, but it did not work out - the reflected signal was too weak), but it worked perfectly well for the light.  Also, the low-frequency interference went away, which put an end to signal loss. <br><br>  The development of the device entered a new stage - now all efforts were directed at collecting data and trying to find the desired sleep phase among them. <br><br>  But about this - in the next article, and that time is now later, and you can‚Äôt disturb the sleep mode) <br><br>  PS If it is the will of the readers, I will lay out in open access all the schemas and source codes of the project so that the bytes are not covered with dust on my hard disk. <br><br>  Any utility: <br><br>  <a href="https://lucid.gitbooks.io/lds/content/">- the book "Clear Sleep Skills", which is the most complete collection of scientific information on sabzh;</a> <br><br>  <a href="http://ezoe.ru/">- the coolest homemade product with open source from all I've seen</a> <br><br>  <a href="https://habr.com/post/234895/">- a cool selection of virtual instruments for analyzing biomedical signals</a> </div><p>Source: <a href="https://habr.com/ru/post/419775/">https://habr.com/ru/post/419775/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../419765/index.html">The course "Web programming languages" (based on Ruby) from MSTU. N. E. Bauman on Tehnostrim channel</a></li>
<li><a href="../419767/index.html">The creator of Wikipedia answers the questions: programming, sleep, books, tips "for life"</a></li>
<li><a href="../419769/index.html">WireGuard will ‚Äúcome‚Äù to the Linux kernel - why?</a></li>
<li><a href="../419771/index.html">Fintech-digest: Central Bank speeds up the collection of biometrics of customers, cryptocurrency is falling, and the volume of the Internet of things market is growing</a></li>
<li><a href="../419773/index.html">From zero to ‚ÄúActions on Google‚Äù hero: start</a></li>
<li><a href="../419777/index.html">How to sell NNN servers in the Netherlands and not stay with bare enthusiasm: the secrets of sales</a></li>
<li><a href="../419779/index.html">Grown lungs are successfully transplanted to a pig, in 5 years human tests are possible.</a></li>
<li><a href="../419781/index.html">SpaceX held the first Mars Workshop</a></li>
<li><a href="../419785/index.html">How MSTP works</a></li>
<li><a href="../419787/index.html">Rome Club Report 2018, Chapter 3.9: ‚ÄúFivefold Resource Performance‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>