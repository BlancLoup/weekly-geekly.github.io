<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Set of 1S admin screwdrivers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For several years, at first, forced, and then quite entertaining administration of 1C, I have accumulated a set of solutions for most of the product f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Set of 1S admin screwdrivers</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/8f8/586/031/8f858603178645c0961962377ae82aac.jpg" alt="image alt text"></p><br><p>  For several years, at first, forced, and then quite entertaining administration of 1C, I have accumulated a set of solutions for most of the product features.  I propose to put aside high matter about clusters and SQL tuning, and shake up stocks of scripts and mechanisms that make life easier with 1C. </p><br><p>  There will be both simple tools for creating new users and monitoring whether everyone is out of the database, as well as more sophisticated interfaces for checking the integrity of the database and its movement. <a name="habracut"></a></p><br><h1 id="chistyy-kesh-i-krepkoe-zdorove">  Clean Cache and Good Health </h1><br><p>  Like most complex applications, 1C after some time work get out strange errors, and sometimes there is an inexplicable behavior.  Special 1C people advise in such cases to clean the cache. </p><br><p>  If you run 1C with the / ClearCache parameter, only client-server requests will be cleared.  Local metadata will remain and must be removed separately at the file and folder level.  This data is stored in a user profile, in folders with long names from GUID databases.  If there are not many databases on the server, such a cache can be easily removed by hand.  But if the database is in the tens, then manually cleaning you will not be happy. </p><br><p><img src="https://habrastorage.org/files/988/ea7/840/988ea78403f04f7dbf250052b13ea829.jpg" alt="image alt text"></p><br><p>  In such situations, the Powershell script will help out, which is started each time the user logs off: </p><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ChildItem "$env:USERPROFILE\AppData\Local\1C\1Cv8\*","$env:USERPROFILE\AppData\Roaming\1C\1Cv8\*" | <span class="hljs-keyword"><span class="hljs-keyword">Where</span></span> {$_.Name -<span class="hljs-keyword"><span class="hljs-keyword">as</span></span> [guid]} |Remove-Item -Force -Recurse</code> </pre> <br><p>  And no problems with the old cache. </p><br><h1 id="ispravlyaem-oshibki">  Fix bugs </h1><br><p>  To fix the corrupted file database, the 1C utility includes the <strong>chdbfl.exe</strong> utility, which simply reads the contents of the database into a temporary file.  If any data can not be considered - skips.  However, it does not have start-up keys for automation, and the test has to be started manually. </p><br><p>  In general, it is more correct to start checking the DB with the configurator, but this process takes much longer.  If you only use the physical integrity check using <strong>chdbfl.exe</strong> , then do not forget to make a backup copy due to possible data loss. </p><br><p>  For bases 8.1, <a href="http://infostart.ru/profile/12366/">Andrei Sklyarov</a> created a good <strong>Check1CD</strong> tool, with two launch parameters: ‚Äúfix found errors‚Äù and ‚Äúpath to base‚Äù. </p><br><p>  But Check1CD lacks two things: </p><br><ul><li><p>  Progress indicator; </p><br></li><li>  Notifications technical support about errors found. </li></ul><br><p>  Since there is a Wishlist and some free time, then why not try to solve the problem yourself? </p><br><div class="spoiler">  <b class="spoiler_title">So there was a mega-script on AutoIt</b> <div class="spoiler_text"><pre> <code class="hljs mel">#NoTrayIcon #include &lt;GUIConstantsEx.au3&gt; #include &lt;File.au3&gt; #include &lt;Date.au3&gt; #include &lt;Inet.au3&gt; Global $oMyError = ObjEvent(<span class="hljs-string"><span class="hljs-string">"AutoIt.Error"</span></span>,<span class="hljs-string"><span class="hljs-string">"MyErrFunc"</span></span>) Global $Basepath=<span class="hljs-string"><span class="hljs-string">"D:\Base\‚Äù ;    ,   ;,    1. If ProcessExists("</span></span><span class="hljs-number"><span class="hljs-number">1</span></span>cv8.exe<span class="hljs-string"><span class="hljs-string">") or ProcessExists("</span></span>chdbfl.exe<span class="hljs-string"><span class="hljs-string">") Then Msgbox(0,"</span></span>!<span class="hljs-string"><span class="hljs-string">", "</span></span><span class="hljs-number"><span class="hljs-number">1</span></span>c  ,   <span class="hljs-string"><span class="hljs-string">") Exit EndIf ;,     ,     if FileExists ($Basepath&amp;"</span></span>_$NEW$_<span class="hljs-number"><span class="hljs-number">.1</span></span>CD<span class="hljs-string"><span class="hljs-string">") Then MSGbox(0,"</span></span>!<span class="hljs-string"><span class="hljs-string">", "</span></span>   !    <span class="hljs-string"><span class="hljs-string">") Exit EndIf ;  ,       If not FileExists ($Basepath&amp;"</span></span><span class="hljs-number"><span class="hljs-number">1</span></span>Cv8<span class="hljs-number"><span class="hljs-number">.1</span></span>CD<span class="hljs-string"><span class="hljs-string">") Then Msgbox(0,"</span></span>!<span class="hljs-string"><span class="hljs-string">", "</span></span>   !<span class="hljs-string"><span class="hljs-string">") Exit EndIf ;,  $hgui = GUICreate("</span></span> <span class="hljs-string"><span class="hljs-string">" , 200, 200) GUICtrlCreateLabel("</span></span>    <span class="hljs-string"><span class="hljs-string">",2,2) GUICtrlCreateLabel("</span></span>    <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-string"><span class="hljs-string">",2,22) GUICtrlCreateLabel("</span></span> ? <span class="hljs-string"><span class="hljs-string">",2,42) $yes = GUICtrlCreateButton("</span></span><span class="hljs-string"><span class="hljs-string">", 5, 150, 70, 25) $no= GUICtrlCreateButton("</span></span><span class="hljs-string"><span class="hljs-string">", 75, 150, 70, 25) GUISetState(@SW_SHOW) While 1 $msg = GUIGetMsg() Select Case $msg = $GUI_EVENT_CLOSE GUIDelete() Exit Case $msg = $yes GUIDelete() _check () ExitLoop Case $msg = $no GUIDelete() Exit EndSelect WEnd ;   func _check () $sTitle="</span></span>    <span class="hljs-string"><span class="hljs-string">" ProgressOn("</span></span> <span class="hljs-string"><span class="hljs-string">", "</span></span>   <span class="hljs-string"><span class="hljs-string">", "</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>%",<span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>) run (<span class="hljs-string"><span class="hljs-string">"C:\Program Files\1cv81\bin\chdbfl.exe"</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>, @SW_HIDE,<span class="hljs-number"><span class="hljs-number">7</span></span>) WinWait($sTitle) local $size = filegetsize($Basepath&amp;<span class="hljs-string"><span class="hljs-string">"1Cv8.1CD"</span></span>) ;! ControlSend($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement9"</span></span>,$Basepath&amp;<span class="hljs-string"><span class="hljs-string">"1Cv8.1CD"</span></span>) ControlClick($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement8"</span></span>) ControlClick($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement7"</span></span>,<span class="hljs-string"><span class="hljs-string">"left"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) $filename = $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"\1Cv8.1CD"</span></span> local $size1 =<span class="hljs-number"><span class="hljs-number">0</span></span> ;        While <span class="hljs-number"><span class="hljs-number">1</span></span> $size1 = filegetsize($Basepath&amp;<span class="hljs-string"><span class="hljs-string">"_$NEW$_.1CD"</span></span>) $perc=round(($size1/$size)*<span class="hljs-number"><span class="hljs-number">100</span></span>) ProgressSet($perc, <span class="hljs-string"><span class="hljs-string">", .  "</span></span>&amp; $perc &amp; <span class="hljs-string"><span class="hljs-string">"%"</span></span>) sleep (<span class="hljs-number"><span class="hljs-number">1500</span></span>) ;,         ;    If not FileInUse($filename) and not FileExists ($Basepath&amp;<span class="hljs-string"><span class="hljs-string">"\_$NEW$_.1CD"</span></span>) Then ExitLoop EndIf WEnd sleep(<span class="hljs-number"><span class="hljs-number">5000</span></span>) ; ,         ; - ! WinSetState ( $sTitle, <span class="hljs-string"><span class="hljs-string">""</span></span>, @SW_SHOW ) WinSetOnTop($sTitle, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) WinActivate($sTitle, <span class="hljs-string"><span class="hljs-string">""</span></span>) WinWaitActive($sTitle) ControlClick($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement4"</span></span>) sleep(<span class="hljs-number"><span class="hljs-number">50</span></span>) ControlSend($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement4"</span></span>,<span class="hljs-string"><span class="hljs-string">"^{home}"</span></span>) sleep(<span class="hljs-number"><span class="hljs-number">50</span></span>) ControlSend($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement4"</span></span>,<span class="hljs-string"><span class="hljs-string">"+^{end}"</span></span>) sleep(<span class="hljs-number"><span class="hljs-number">50</span></span>) ControlSend($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement4"</span></span>,<span class="hljs-string"><span class="hljs-string">"^{ins}"</span></span>) sleep(<span class="hljs-number"><span class="hljs-number">50</span></span>) $text = ClipGet() ControlClick($sTitle,<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"V8FormElement6"</span></span>,<span class="hljs-string"><span class="hljs-string">"left"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) ProgressSet(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">"100%"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>) sleep (<span class="hljs-number"><span class="hljs-number">500</span></span>) ProgressOff() ; -,     ,   . ;  e-mail ;   Outlook Express.     $sender = RegRead(<span class="hljs-string"><span class="hljs-string">"HKEY_CURRENT_USER\Software\Microsoft\ _ Internet Account Manager\Accounts\00000001"</span></span>,<span class="hljs-string"><span class="hljs-string">"SMTP Email Address"</span></span>) $sendername = RegRead(<span class="hljs-string"><span class="hljs-string">"HKEY_CURRENT_USER\Software\Microsoft\ _ Internet Account Manager\Accounts\00000001"</span></span>,<span class="hljs-string"><span class="hljs-string">"SMTP Display Name"</span></span>) If not FileExists($Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>) then _FileCreate($Basepath&amp;<span class="hljs-string"><span class="hljs-string">"\check.Log"</span></span>) FileWrite ($Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, _NowCalc()&amp;@CRLF ) If $text &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> Then FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">" :"</span></span>&amp;@CRLF) FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, $text&amp;@CRLF) FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">" .."</span></span>&amp;@CRLF) ;   smtp. -,   If Ping(<span class="hljs-string"><span class="hljs-string">"smtp-server"</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> then <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $sender = <span class="hljs-string"><span class="hljs-string">""</span></span> or $sendername=<span class="hljs-string"><span class="hljs-string">""</span></span> Then MSGbox(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"!"</span></span>, <span class="hljs-string"><span class="hljs-string">"  ,    !"</span></span>) Else email($sender, $sendername,$text) EndIf endif ;   ,      Else FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>&amp;@CRLF) EndIf $hgui = GUICreate(<span class="hljs-string"><span class="hljs-string">" "</span></span> , <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) $ok = GUICtrlCreateButton(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>) GUISetState(@SW_SHOW) While <span class="hljs-number"><span class="hljs-number">1</span></span> $msg = GUIGetMsg() Select Case $msg = $GUI_EVENT_CLOSE or $msg=$1 GUIDelete() Exit EndSelect WEnd EndFunc Func FileInUse($filename) $handle = FileOpen($filename, <span class="hljs-number"><span class="hljs-number">1</span></span>) $result = False <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $handle = <span class="hljs-number"><span class="hljs-number">-1</span></span> then $result = True FileClose($handle) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $result EndFunc func email($sender, $sendername,$text) local $array[<span class="hljs-number"><span class="hljs-number">1</span></span>] $array[<span class="hljs-number"><span class="hljs-number">0</span></span>]=$text $t=_INetSmtpMail(<span class="hljs-string"><span class="hljs-string">"smtpserver"</span></span>, $sendername,$sender, <span class="hljs-string"><span class="hljs-string">"[helpdesk@domain.com](mailto:helpdesk@domain.com)"</span></span>, _ <span class="hljs-string"><span class="hljs-string">" "</span></span> ,$array,<span class="hljs-string"><span class="hljs-string">"EHLO "</span></span> &amp; @ComputerName,<span class="hljs-number"><span class="hljs-number">-1</span></span> ) $error=@error <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $t &lt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> Then FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">"  e-mail  "</span></span>&amp;$sendername&amp; <span class="hljs-string"><span class="hljs-string">" "</span></span>&amp;$sender&amp;@CRLF) FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">"  "</span></span>&amp;$error&amp;@CRLF) Else FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">"email "</span></span>&amp;@CRLF) EndIf EndFunc ;---------------------------------------------------------------------------------------------------------- ; Com Error Handler ;---------------------------------------------------------------------------------------------------------- Func MyErrFunc() Local $HexNumber Local $strMsg $HexNumber = Hex($oMyError.Number, <span class="hljs-number"><span class="hljs-number">8</span></span>) $strMsg = <span class="hljs-string"><span class="hljs-string">" "</span></span> &amp; $HexNumber &amp; @CRLF $strMsg &amp;= <span class="hljs-string"><span class="hljs-string">" "</span></span> &amp; $oMyError.WinDescription &amp; @CRLF $strMsg &amp;= <span class="hljs-string"><span class="hljs-string">": "</span></span> &amp; $oMyError.ScriptLine &amp; @CRLF FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">" -: "</span></span>&amp;$strMsg) FileWrite ( $Basepath&amp;<span class="hljs-string"><span class="hljs-string">"check.Log"</span></span>, <span class="hljs-string"><span class="hljs-string">"e-mail  "</span></span>&amp; @CRLF) SetError(<span class="hljs-number"><span class="hljs-number">1</span></span>) Endfunc</code> </pre> </div></div><br><p>  Modifying the code for passing parameters through the command line keys is a matter of technique. </p><br><p><img src="https://habrastorage.org/files/922/e5b/474/922e5b474c2847e3a69c662cea8abb25.jpg" alt="image alt text"></p><br><p>  It was </p><br><p><img src="https://habrastorage.org/files/5c8/69c/ea1/5c869cea19dd43bfaf11a6e38e3c17a4.jpg" alt="image alt text"></p><br><p>  So it became </p><br><p>  With the release of 1C 8.2, there was a problem - the path to chdbfl changed with the installation of the new release.  Well, let's add the script: </p><br><pre> <code class="hljs vbscript">;      chdbfl    $path=_FileListToArrayRec(@ProgramFilesDir&amp;<span class="hljs-string"><span class="hljs-string">"\1cv8\"</span></span>,<span class="hljs-string"><span class="hljs-string">"chdbfl.exe"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Msgbox</span></span>(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"1c  ,    "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> Endif ;   Run ($path[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-string"><span class="hljs-string">""</span></span>, @SW_HIDE,<span class="hljs-number"><span class="hljs-number">7</span></span>)</code> </pre> <br><p>  I must say, the source code Check1CD was recently <a href="http://its61.ru/%25D0%25B8%25D1%2581%25D1%2585%25D0%25BE%25D0%25B4%25D0%25BD%25D1%258B%25D0%25B9-%25D0%25BA%25D0%25BE%25D0%25B4-check1cd/">published</a> .  Yes, also on AutoIT. </p><br><p>  A similar mechanism can also be used to automatically start various regulatory mechanisms, where you need to run 1C and wait for the operation to complete. </p><br><h1 id="vykidyvaem-iz-bazy-s-vydumkoy">  Throwing out of the base with fiction </h1><br><p>  With various procedural operations with 1C (nightly configuration update or backup in .dt) it is important to ensure that there are no users connected to it.  Of course, you can run 1C: Enterprise with the <strong>/ C</strong> key <strong>. Complete the Users operation</strong> , but this is not always convenient, and then you want to write a personal letter with recommendations on how to eliminate sclerosis. </p><br><p>  You can use the regular connectivity to 1C via the <strong>COMConnector</strong> and the <strong>AutoIT</strong> script.  The code is written under 1C 8.1 and allows you to throw users out of the database with a log entry. </p><br><pre> <code class="hljs ruby">global $obj = ObjCreate(<span class="hljs-string"><span class="hljs-string">"v81.comconnector"</span></span>) $AgentConnection = $obj.ConnectAgent(<span class="hljs-string"><span class="hljs-string">"tcp://servername:1540"</span></span>) $Cluster = $AgentConnection.GetClusters()[<span class="hljs-number"><span class="hljs-number">0</span></span>] $AgentConnection.Authenticate($Cluster, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) $WorkingProcess = $AgentConnection.GetWorkingProcesses($Cluster)[<span class="hljs-number"><span class="hljs-number">0</span></span>] $ConnectString = $WorkingProcess.HostName &amp; <span class="hljs-string"><span class="hljs-string">":"</span></span> &amp; $WorkingProcess.MainPort $WorkingProcessConnection = $obj.ConnectWorkingProcess($ConnectString) $WorkingProcessConnection.AddAuthentication(<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>) $ibDesc = $WorkingProcessConnection.CreateInfoBaseInfo() $ibDesc.Name = <span class="hljs-string"><span class="hljs-string">" "</span></span> $connections = $WorkingProcessConnection.GetInfoBaseConnections($ibDesc) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> $temp <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $connections <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $temp.username &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> ($temp.AppID &lt;&gt; <span class="hljs-string"><span class="hljs-string">"COMConsole"</span></span> <span class="hljs-number"><span class="hljs-number">_</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"COM-"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> FileWriteLine ( <span class="hljs-string"><span class="hljs-string">" "</span></span>, @MDAY&amp;<span class="hljs-string"><span class="hljs-string">"."</span></span>&amp;@MON&amp;<span class="hljs-string"><span class="hljs-string">"."</span></span>&amp;@YEAR&amp;<span class="hljs-string"><span class="hljs-string">" _ "</span></span>&amp;@HOUR&amp;<span class="hljs-string"><span class="hljs-string">":"</span></span>&amp;@MIN&amp;<span class="hljs-string"><span class="hljs-string">"    "</span></span>&amp;$temp.username &amp;<span class="hljs-string"><span class="hljs-string">" _   "</span></span>&amp;$temp.AppID) $WorkingProcessConnection.Disconnect($temp) endif Next $AgentConnection=<span class="hljs-string"><span class="hljs-string">""</span></span> $connect=<span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre> <br><p>  But sometimes the operation needs to be rotated at the request of the user himself, who launched the ‚Äúheavy‚Äù report and hung it up 1C.  If you do not want to solve these issues on your own, then simply output a shortcut to the compiled script for those who like ‚Äúheavy‚Äù reports: </p><br><pre> <code class="hljs php">$a=Msgbox(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-string"><span class="hljs-string">" ?"</span></span>,<span class="hljs-string"><span class="hljs-string">"     ?"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> $a&lt;&gt;<span class="hljs-number"><span class="hljs-number">6</span></span> then <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $obj = ObjCreate(<span class="hljs-string"><span class="hljs-string">"v83.comconnector"</span></span>) $AgentConnection = $obj.ConnectAgent(<span class="hljs-string"><span class="hljs-string">"tcp://servername:1540"</span></span>) $Cluster = $AgentConnection.GetClusters()[<span class="hljs-number"><span class="hljs-number">0</span></span>] $AgentConnection.Authenticate($Cluster, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) $infobases=$AgentConnection.GetInfoBases($Cluster) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> $base in $infobases <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $base.name=<span class="hljs-string"><span class="hljs-string">"basename"</span></span> Then $connections=$AgentConnection.GetInfoBaseSessions($Cluster, $base) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> $temp in $connections ;     ,     <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> $temp.username = @username then $AgentConnection.terminatesession($cluster,$temp) <span class="hljs-keyword"><span class="hljs-keyword">EndIf</span></span> next <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EndIf</span></span> next <span class="hljs-keyword"><span class="hljs-keyword">Endif</span></span></code> </pre> <br><p>  Another COMConnector helps to check for configuration updates, get some information from the database, and automate the establishment of users in 1C. </p><br><h1 id="tehnologichnoe-sozdanie-novyh-polzovateley">  Technological creation of new users </h1><br><p>  In my opinion, the system administrator should create new 1C users, not 1C programmer.  But the latter needs to make the process as simple as possible.  To prevent the administrator from having to ‚Äúlook in‚Äù to each database separately, you can use another script. </p><br><div class="spoiler">  <b class="spoiler_title">For example, I‚Äôll give you the function to create users in sample Accounting 2.0.</b> <div class="spoiler_text"><pre> <code class="hljs perl">;     , ,    func _1cBuh($username, $surname,$name,$fathername) FileWriteLine($logfile, <span class="hljs-string"><span class="hljs-string">"  1 8.3  "</span></span>&amp; $Username) $obj = ObjCreate(<span class="hljs-string"><span class="hljs-string">"v83.comconnector"</span></span>) $connect=$obj.Connect(<span class="hljs-string"><span class="hljs-string">"Srvr="</span></span><span class="hljs-string"><span class="hljs-string">"servername"</span></span><span class="hljs-string"><span class="hljs-string">";Ref="</span></span><span class="hljs-string"><span class="hljs-string">"basename"</span></span><span class="hljs-string"><span class="hljs-string">";Usr="</span></span><span class="hljs-string"><span class="hljs-string">"login"</span></span><span class="hljs-string"><span class="hljs-string">";Pwd="</span></span><span class="hljs-string"><span class="hljs-string">"password"</span></span><span class="hljs-string"><span class="hljs-string">";"</span></span>) Local $avArray[<span class="hljs-number"><span class="hljs-number">1</span></span>], $i=<span class="hljs-number"><span class="hljs-number">0</span></span> ;     $hgui = GUICreate(<span class="hljs-string"><span class="hljs-string">""</span></span> , <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"   ?"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) GUICtrlCreateLabel(<span class="hljs-string"><span class="hljs-string">"  ?"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">22</span></span>) $1 = GUICtrlCreateButton(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>) $2= GUICtrlCreateButton(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>, <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>) GUISetState(@SW_SHOW) While <span class="hljs-number"><span class="hljs-number">1</span></span> $msg = GUIGetMsg() Select Case $msg = $1 GUIDelete() $rght=<span class="hljs-string"><span class="hljs-string">""</span></span> ExitLoop Case $msg = $2 GUIDelete() $rght=<span class="hljs-string"><span class="hljs-string">""</span></span> ExitLoop EndSelect WEnd $mt=$connect.Metadata.Roles.find($rght) ;   $newuser= $connect..createuser() $newuser.name = $surname&amp;<span class="hljs-string"><span class="hljs-string">" "</span></span>&amp;$name $newuser.fullname = $surname&amp;<span class="hljs-string"><span class="hljs-string">" "</span></span>&amp;$name&amp;<span class="hljs-string"><span class="hljs-string">" "</span></span>&amp;$fathername $newuser.StandardAuthentication = <span class="hljs-string"><span class="hljs-string">"False"</span></span> $newuser.OSAuthentication=<span class="hljs-string"><span class="hljs-string">"True"</span></span> $newuser.OSuser=<span class="hljs-string"><span class="hljs-string">"\\DOMAINNAME\"&amp;$Username $newuser.Roles.add($mt) $newuser.write() ;    $bject=$connect.NewObject("</span></span>.<span class="hljs-string"><span class="hljs-string">") $newuserS=$bject.CreateItem() $newuserS.code=$surname&amp;"</span></span> <span class="hljs-string"><span class="hljs-string">"&amp;$name $newuserS.Description=$surname&amp;"</span></span> <span class="hljs-string"><span class="hljs-string">"&amp;$name&amp;"</span></span> <span class="hljs-string"><span class="hljs-string">"&amp;$fathername $newuserS.write() ;  () $query=$connect.Catalogs..() while $query.() if StringInStr ( $query.Description, "</span></span><span class="hljs-string"><span class="hljs-string">") then _ArrayAdd($avArray, $query.Description) $i+=1 endif wend $avArray[0]=$i GUICreate("</span></span> <span class="hljs-string"><span class="hljs-string">", 200,$i*20+70) for $i=1 to $avArray[0] assign ("</span></span>var<span class="hljs-string"><span class="hljs-string">"&amp;$i, GUICtrlCreateCheckbox( $avArray[$i], 2, 0+20*$i));, 90, 20)) next $OK_Btn = GUICtrlCreateButton("</span></span><span class="hljs-string"><span class="hljs-string">", 50,$i*20+20, 60) GUISetState() While 1 $msg = GUIGetMsg() Select Case $msg = $OK_Btn For $i=1 to $avArray[0] if BitAND(GUICtrlRead(eval("</span></span>var<span class="hljs-string"><span class="hljs-string">"&amp;$i)), $GUI_CHECKED) = _ $GUI_CHECKED Then $grp=$connect... _ ($avArray[$i]).() $t=$grp..add() $t. = $newuserS. $grp.write() endif next GUIDelete() ExitLoop EndSelect WEnd $connect="</span></span><span class="hljs-string"><span class="hljs-string">" endfunc</span></span></code> </pre> </div></div><br><p><img src="https://habrastorage.org/files/985/ca8/afe/985ca8afef56499297e25f25cea298c4.jpg" alt="image alt text"></p><br><p>  Legal entities divorced too much - you need to break into columns. </p><br><p>  It's interesting, but after changing several generations of administrators in one company from the distant past, the new ones no longer knew how to create a user manually. </p><br><h1 id="avtomaticheskoe-peremeschenie-baz">  Automatic database movement </h1><br><p>  If you need to transfer the 1C: Enterprise database along with its data to SQL to another server, then it is advisable to do this manually only for 1-2 databases. </p><br><div class="spoiler">  <b class="spoiler_title">With more of them, the routine will become tedious - it is better to use the script.</b> <div class="spoiler_text"><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">GUIConstantsEx</span></span>.au3&gt; local <span class="hljs-string"><span class="hljs-string">$n</span></span>ame <span class="hljs-type"><span class="hljs-type">GUICreate</span></span>(<span class="hljs-comment"><span class="hljs-comment">""</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">180</span></span>) <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">"   "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">35</span></span>) <span class="hljs-string"><span class="hljs-string">$n</span></span>ame1 = <span class="hljs-type"><span class="hljs-type">GUICtrlCreateInput</span></span>(<span class="hljs-string"><span class="hljs-string">$n</span></span>ame, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn = <span class="hljs-type"><span class="hljs-type">GUICtrlCreateButton</span></span>(<span class="hljs-comment"><span class="hljs-comment">""</span></span>, <span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">180</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>) <span class="hljs-type"><span class="hljs-type">GUISetState</span></span>() <span class="hljs-type"><span class="hljs-type">While</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-type"><span class="hljs-type">GUIGetMsg</span></span>() <span class="hljs-type"><span class="hljs-type">Select</span></span> <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$G</span></span>UI_EVENT_CLOSE <span class="hljs-type"><span class="hljs-type">Exit</span></span> <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn <span class="hljs-string"><span class="hljs-string">$n</span></span>ame = <span class="hljs-type"><span class="hljs-type">GUICtrlRead</span></span>(<span class="hljs-string"><span class="hljs-string">$n</span></span>ame1) exitloop endselect <span class="hljs-type"><span class="hljs-type">WEnd</span></span> <span class="hljs-type"><span class="hljs-type">GUIDelete</span></span>() <span class="hljs-type"><span class="hljs-type">GUICreate</span></span>(<span class="hljs-comment"><span class="hljs-comment">""</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">180</span></span>) <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">" "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-type"><span class="hljs-type">GUISetState</span></span>() <span class="hljs-string"><span class="hljs-string">$c</span></span>onstrim=<span class="hljs-comment"><span class="hljs-comment">"DRIVER={SQL Server};SERVER=_;DATABASE=master;uid=sa;pwd=;"</span></span> <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN = <span class="hljs-type"><span class="hljs-type">ObjCreate</span></span> (<span class="hljs-comment"><span class="hljs-comment">"ADODB.Connection"</span></span>) <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN.<span class="hljs-type"><span class="hljs-type">Open</span></span> (<span class="hljs-string"><span class="hljs-string">$c</span></span>onstrim) <span class="hljs-string"><span class="hljs-string">$s</span></span>Query = <span class="hljs-comment"><span class="hljs-comment">"sp_detach_db @dbname = N'"</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">"'"</span></span> <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN.<span class="hljs-type"><span class="hljs-type">Execute</span></span>(<span class="hljs-string"><span class="hljs-string">$s</span></span>Query) <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN.<span class="hljs-type"><span class="hljs-type">Close</span></span> <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">" "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>) <span class="hljs-string"><span class="hljs-string">$u</span></span>=<span class="hljs-type"><span class="hljs-type">FileCopy</span></span> (<span class="hljs-comment"><span class="hljs-comment">"\\_\    SQL-\"</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">".mdf"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"\\_\    SQL-\"</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">".mdf"</span></span>) if <span class="hljs-string"><span class="hljs-string">$u</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-type"><span class="hljs-type">Then</span></span> <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">"!  !!!!"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>) <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn = <span class="hljs-type"><span class="hljs-type">GUICtrlCreateButton</span></span>(<span class="hljs-comment"><span class="hljs-comment">""</span></span>, <span class="hljs-number"><span class="hljs-number">336</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>) <span class="hljs-type"><span class="hljs-type">GUISetState</span></span>() <span class="hljs-type"><span class="hljs-type">While</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-type"><span class="hljs-type">GUIGetMsg</span></span>() <span class="hljs-type"><span class="hljs-type">Select</span></span> <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$G</span></span>UI_EVENT_CLOSE exit <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn exit endselect <span class="hljs-type"><span class="hljs-type">WEnd</span></span> <span class="hljs-type"><span class="hljs-type">GUIDelete</span></span>() <span class="hljs-type"><span class="hljs-type">EndIf</span></span> <span class="hljs-string"><span class="hljs-string">$u</span></span>=<span class="hljs-type"><span class="hljs-type">FileCopy</span></span> (<span class="hljs-comment"><span class="hljs-comment">"\\_\    _ SQL-\"</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">".ldf"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"\\_\    SQL-\"</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">".ldf"</span></span>) if <span class="hljs-string"><span class="hljs-string">$u</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-type"><span class="hljs-type">Then</span></span> <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">"!  !!!!"</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>) <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn = <span class="hljs-type"><span class="hljs-type">GUICtrlCreateButton</span></span>(<span class="hljs-comment"><span class="hljs-comment">""</span></span>, <span class="hljs-number"><span class="hljs-number">336</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>) <span class="hljs-type"><span class="hljs-type">GUISetState</span></span>() <span class="hljs-type"><span class="hljs-type">While</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-type"><span class="hljs-type">GUIGetMsg</span></span>() <span class="hljs-type"><span class="hljs-type">Select</span></span> <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$G</span></span>UI_EVENT_CLOSE exit <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn exit endselect <span class="hljs-type"><span class="hljs-type">WEnd</span></span> <span class="hljs-type"><span class="hljs-type">GUIDelete</span></span>() <span class="hljs-type"><span class="hljs-type">EndIf</span></span> <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">"   "</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>) <span class="hljs-type"><span class="hljs-type">GUISetState</span></span>() <span class="hljs-string"><span class="hljs-string">$c</span></span>onstrim=<span class="hljs-comment"><span class="hljs-comment">"DRIVER={SQL Server};SERVER=_;DATABASE=master;uid=sa;pwd=;"</span></span> <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN = <span class="hljs-type"><span class="hljs-type">ObjCreate</span></span> (<span class="hljs-comment"><span class="hljs-comment">"ADODB.Connection"</span></span>) <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN.<span class="hljs-type"><span class="hljs-type">Open</span></span> (<span class="hljs-string"><span class="hljs-string">$c</span></span>onstrim) <span class="hljs-string"><span class="hljs-string">$s</span></span>Query = <span class="hljs-comment"><span class="hljs-comment">"CREATE DATABASE "</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">" ON (FILENAME = '    _ \"</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">".mdf'), (FILENAME = '    \"</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">".ldf') FOR ATTACH"</span></span> <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN.<span class="hljs-type"><span class="hljs-type">Execute</span></span>(<span class="hljs-string"><span class="hljs-string">$s</span></span>Query) <span class="hljs-string"><span class="hljs-string">$a</span></span>dCN.<span class="hljs-type"><span class="hljs-type">Close</span></span> <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">" 1c-  "</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">41</span></span>) <span class="hljs-type"><span class="hljs-type">GUISetState</span></span>() run (<span class="hljs-comment"><span class="hljs-comment">""</span></span><span class="hljs-comment"><span class="hljs-comment">"C:\Program Files (x86)\1cv8\common\1cestart.exe"</span></span><span class="hljs-comment"><span class="hljs-comment">" createinfobase_ "</span></span><span class="hljs-comment"><span class="hljs-comment">"Srvr=localhost;Ref="</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">";DB="</span></span>&amp;<span class="hljs-string"><span class="hljs-string">$n</span></span>ame&amp;<span class="hljs-comment"><span class="hljs-comment">";DBMS=MSSQLServer;DBSrvr=localhost;DBUID=sa;DBPwd="</span></span><span class="hljs-comment"><span class="hljs-comment">""</span></span>) <span class="hljs-type"><span class="hljs-type">GUICtrlCreateLabel</span></span>(<span class="hljs-comment"><span class="hljs-comment">",  "</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">54</span></span>) <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn = <span class="hljs-type"><span class="hljs-type">GUICtrlCreateButton</span></span>(<span class="hljs-comment"><span class="hljs-comment">""</span></span>, <span class="hljs-number"><span class="hljs-number">336</span></span>,<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>) <span class="hljs-type"><span class="hljs-type">GUISetState</span></span>() <span class="hljs-type"><span class="hljs-type">While</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-type"><span class="hljs-type">GUIGetMsg</span></span>() <span class="hljs-type"><span class="hljs-type">Select</span></span> <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$G</span></span>UI_EVENT_CLOSE exitloop <span class="hljs-type"><span class="hljs-type">Case</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>sg = <span class="hljs-string"><span class="hljs-string">$O</span></span>K_Btn exitloop endselect <span class="hljs-type"><span class="hljs-type">WEnd</span></span> <span class="hljs-type"><span class="hljs-type">GUIDelete</span></span>()</code> </pre> </div></div><br><p><img src="https://habrastorage.org/files/d39/424/b13/d39424b13a7f44dbb1e36dde6703dcc4.jpg" alt="image alt text"></p><br><p>  The list of databases for migration can also be taken from a file, and the log can be output to a text file.  Similarly, you can convert several dozen databases from file to SQL by simple upload-loading to .dt </p><br><h1 id="na-etom-nabor-zakanchivaetsya">  The set ends here. </h1><br><p>  Of course, this is not all that can be automated in conjunction with 1C.  But all sorts of exchanges, obtaining real-time information from 1C in other applications and other scenarios were not included in this review due to its narrow focus and specificity. </p><br><p>  <strong>Surely you also have your own set of "know how" for administering 1C - it would be great if you share it with your colleagues in the comments.</strong> </p><br><p>  <em>Scripts and know-how are provided by <a href="https://habrahabr.ru/users/avelor/" class="user_link">avelor</a> , for which <a href="https://habrahabr.ru/users/avelor/" class="user_link">many thanks</a> to him!</em> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/320852/">https://habr.com/ru/post/320852/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320836/index.html">Video conferencing for one state organization: why we need hardware solutions</a></li>
<li><a href="../320840/index.html">"Baikal-T1": familiarity with the board on the first 28-nm processor in Russia</a></li>
<li><a href="../320842/index.html">Materials of journals of ITMO University: research in the field of image processing and computer modeling</a></li>
<li><a href="../320846/index.html">Zubmill - New Russian Dental-Aliexpress</a></li>
<li><a href="../320848/index.html">LiveStreet 2.0 release</a></li>
<li><a href="../320854/index.html">Neutralized malware that can paralyze the work of the whole ministry</a></li>
<li><a href="../320856/index.html">Through the walls: overcoming obstacles</a></li>
<li><a href="../320858/index.html">Development of high-quality VR projects</a></li>
<li><a href="../320860/index.html">VR-Design: a look into the virtual world</a></li>
<li><a href="../320862/index.html">Recommendations for the use of Hero Images (UPD)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>