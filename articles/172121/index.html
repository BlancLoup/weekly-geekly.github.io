<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cross-platform development for mobile with Xamarin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Quite recently, Xamarin announced the release of a new version of its toolkit for cross-platform development of mobile applications, bu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cross-platform development for mobile with Xamarin</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  Quite recently, Xamarin announced the release of a new version of its toolkit for cross-platform development of mobile applications, but there are still no sane articles in Russian on this topic.  A small <a href="http://habrahabr.ru/post/170629/">overview</a> appeared on Habr√©, not related to coding, there were a couple of <a href="http://habrahabr.ru/post/169467/">attempts to</a> tell about it in a little more detail, but it didn‚Äôt go beyond the process of creating the Hello World application.  It's a pity.  This time we will try to correct this unfortunate misunderstanding. <br><a name="habracut"></a><br><h4>  Beginning of work </h4><br>  The installer Xamarin installs a plug-in to Visual Studio, which allows you to develop applications for popular mobile platforms in a familiar developer environment.  A separate development environment Xamarin Studio is also being installed, which, apparently, is a modified version of MonoDevelop.  I‚Äôm used to working in Visual Studio so the examples in this article will be shown using this particular development environment. <br><br>  After installation, project templates for mobile applications for Android and iOS are added to Visual Studio (it supports the creation of both specialized applications for iPad and iPhone, universal applications, and applications using OpenGL).  To create applications for iOS in Visual Studio will have to, however, pay.  This functionality is available either in trial mode or in the business version of the toolkit, and it costs $ 999 per year. <br><br>  After creating the project, we get the same API for each platform that we have in native development, but the syntax will be in C #, besides, it is possible to use the basic types of the .NET Framework, syntax sugar and other .NET buns. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Android development </h4><br>  After creating the Android project, we get a set of files in which there is a class of the main window and a set of resource files.  After long work in Eclipse, the name of the folders in PascalCase is a bit annoying, but you can get used to it rather quickly.  There are also differences in working with resource files.  In order for the embedded window designer to understand resource files with layouts, their extension has been changed to .AXML instead of the usual .XML in Eclipse.  This is pretty annoying, especially if you draw layouts in Eclipse, and then transfer them to Visual Studio in case Eclipse's window designer is more like it. <br><br>  The built-in window designer seemed to me inconvenient.  Slow, often brings down the whole IDE, I still do not understand how it is easy to switch between the XML-type and UI.  Here we can definitely say that it was written by strangers for predators.  I decided for myself that in Eclipse it is more convenient for me, more familiar, and more useful information is placed on the laptop screen in Eclipse.  Maybe someone designer Visual Studio and enjoy it more, the taste and color markers are different. <br><br><h5>  Activities </h5><br>  C # code for Mono for Android is very similar to Java code. <br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">XamarinDemo.Android</span></span> { [Activity(Label = <span class="hljs-string"><span class="hljs-string">"XamarinDemo.Android"</span></span>, MainLauncher = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, Icon = <span class="hljs-string"><span class="hljs-string">"@drawable/icon"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainActivity</span></span> : <span class="hljs-title"><span class="hljs-title">Activity</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Bundle bundle</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.OnCreate(bundle); SetContentView(Resource.Layout.Main); Button button = FindViewById&lt;Button&gt;(Resource.Id.MyButton); button.Click += <span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { button.Text = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0} clicks!"</span></span>, count++); }; } } }</code> </pre> <br>  Differences that are immediately visible: <br><ul><li>  To register an activity, you do not need to register anything in the manifest.  To do this, use the summary [Activity] </li><li>  In order to make the activity start, it is necessary for the [Activity] annotation to specify the parameter MainLauncher.  This will be equivalent to setting action = android.intent.action.MAIN and category = android.intent.category.LAUNCHER in the manifest. </li><li>  The main methods of the life cycle activity (and indeed all methods) have names in PascalCase. </li></ul><br><br><h5>  Controls and Event Handling </h5><br>  To get references to controls, as in the Java version, use the <code>FindViewById()</code> method.  Very pleased with the presence of a generic version of this method, which returns an object of the desired type and allows you to get rid of c-Cast'ov. <br>  Instead of listeners, or rather, in addition to them, delegates are used to connect event handlers.  You can also use listeners, but this is, firstly, not the .NET way, and secondly, it requires writing more code, even compared to Java.  In addition, several delegates can be connected: <br><pre> <code class="cs hljs">Button button = FindViewById&lt;Button&gt;(Resource.Id.MyButton); button.Click += <span class="hljs-keyword"><span class="hljs-keyword">delegate</span></span> { button.Text = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0} clicks!"</span></span>, count++); }; button.Click += (o, e) =&gt; { Toast.MakeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0} clicks!"</span></span>, count++), ToastLength.Long).Show(); };</code> </pre><br>  Not with all event handlers in the form of delegates things are rosy.  One of the projects revealed a problem with the <code>View.ViewTreeObserver.GlobalLayout</code> event, which did not disable handler delegates when using the - = operator.  Yes, in general, did not turn off.  I had to use <code>IOnGlobalLayoutListener</code> . <br><br><h5>  Using Java libraries in a .NET project </h5><br>  Mono for Android has the ability to use existing JAR files in a C # application.  For these purposes, a special project type is provided: Java Binding Library. <br>  To use the JAR library, you must: <br><ul><li>  Create a Java Binding Library project in the solution. </li><li>  Put the required JAR file in the Jars folder (AndroidManifest.xml should not be in the JAR library, because the presence of this file can have a number of unpleasant consequences. You can learn more about this <a href="http://forums.xamarin.com/discussion/1899/problem-with-deploying-apk-which-uses-android-binding-library-and-jar">here</a> ). </li><li>  Specify a build action for a JAR file as EmbeddedJar. </li><li>  In the Android application project add the project created by the Java Binding Library to References. </li></ul><br>  After that, you can use classes from a JAR file.  Be aware that package names in C # and in Java source code may differ slightly.  For example, the com.example.androiddemolib package from Java code will be renamed to Com.Example.Androiddemolib (that is, it will be converted to PascalCase). <br>  A good guide to using Java libraries can be found <a href="">here</a> . <br><br><h5>  Work with databases </h5><br>  Mono for Android uses the <code>Mono.Data.Sqlite</code> namespace <code>Mono.Data.Sqlite</code> (used to access SQLite databases) and <code>System.Data.SqlClient</code> (for accessing Microsoft SQL Server) to work with databases.  The classes of the <code>System.Data.SqlClient</code> namespace are available only in the Business edition of the development tools.  You can also use wrapper classes over native Java API for Android and third-party development, such as sqlite-net, in which an asynchronous API is available. <br>  Using the available API is quite simple.  Everything is very similar to desktop development: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">XamarinDemo.Android</span></span> { [Activity(Label = <span class="hljs-string"><span class="hljs-string">"XamarinDemo.Android"</span></span>, MainLauncher = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, Icon = <span class="hljs-string"><span class="hljs-string">"@drawable/icon"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainActivity</span></span> : <span class="hljs-title"><span class="hljs-title">Activity</span></span> { <span class="hljs-function"><span class="hljs-function">SqliteConnection </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetConnection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path</span></span></span><span class="hljs-function">)</span></span> { SqliteConnectionStringBuilder builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SqliteConnectionStringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!File.Exists(path)) { FileInfo info = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInfo(path); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Directory.Exists(info.Directory.FullName)) { Directory.CreateDirectory(info.Directory.FullName); } SqliteConnection.CreateFile(path); } builder.DataSource = path; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SqliteConnection(builder.ToString()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Bundle bundle</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.OnCreate(bundle); SetContentView(Resource.Layout.Main); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> path = GetDatabasePath(<span class="hljs-string"><span class="hljs-string">"xamarindemo.sqlite"</span></span>).Path; SqliteConnection connection = GetConnection(path); connection.Open(); SqliteCommand command = connection.CreateCommand(); command.CommandType = CommandType.Text; command.CommandText = <span class="hljs-string"><span class="hljs-string">"CREATE TABLE IF NOT EXISTS DemoTable("</span></span> + <span class="hljs-string"><span class="hljs-string">"id INTEGER AUTO_INCREMENT PRIMARY KEY NOT NULL"</span></span> + <span class="hljs-string"><span class="hljs-string">", name VARCHAR(32))"</span></span>; command.ExecuteNonQuery(); connection.Close(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { System.Diagnostics.Debug.WriteLine(e.ToString()); } } } }</code> </pre><br><br><h4>  IOS development </h4><br><br><h5>  Controls and Event Handlers </h5><br>  Creating controls in code is no different from analogous work in Objective-C.  Event handlers can be hung in the same way as in Android - with the help of delegates.  You can also add handlers as in Objective-C through selectors. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">XamarinDemo.iOS</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyViewController</span></span> : <span class="hljs-title"><span class="hljs-title">UIViewController</span></span> { UIButton button; ‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyViewController</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ViewDidLoad</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.ViewDidLoad(); ‚Ä¶ button = UIButton.FromType(UIButtonType.RoundedRect); ‚Ä¶ button.AddTarget(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Selector(<span class="hljs-string"><span class="hljs-string">"ButtonTouchInside"</span></span>), UIControlEvent.TouchUpInside); ‚Ä¶ button.TouchUpInside += (<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> sender, EventArgs e) =&gt; { button.SetTitle(String.Format( <span class="hljs-string"><span class="hljs-string">"clicked {0} times"</span></span>, numClicks++), UIControlState.Normal); }; ‚Ä¶ View.AddSubview(button); } [Export(<span class="hljs-string"><span class="hljs-string">"ButtonTouchInside"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnButtonTouchInside</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>); } } }</code> </pre><br><br><h5>  Using Native Libraries </h5><br>  In Xamarin iOS, as well as for Android, the ability to use native libraries is available.  For these purposes, there is a special type of project - the iOS Binding Project, to which you can add static libraries, after which they will be linked together with the main project. <br><br>  In general, to use a native library in a C # project, you need to do the following: <br><ul><li>  Create a static library project in Xcode. </li><li>  If you plan to debug a C # project in the simulator, then in the static library project settings you need to add the i386 architecture to the Valid Architectures list. </li><li>  Write the necessary logic (let's say we have one exported class): <br><pre> <code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iOSDemoClass</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSObject</span></span></span><span class="hljs-class"> - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSInteger</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">addData</span></span></span><span class="hljs-class">: (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSInteger</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">andOtherValue</span></span></span><span class="hljs-class">: (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSInteger</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value2</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> ‚Ä¶ @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iOSDemoClass</span></span></span><span class="hljs-class"> -(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSInteger</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">addData</span></span></span><span class="hljs-class">: (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSInteger</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">andOtherValue</span></span></span><span class="hljs-class">: (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NSInteger</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value2</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value1 + value2; } <span class="hljs-keyword"><span class="hljs-keyword">@end</span></span></code> </pre><br></li><li>  Close project in Xcode </li><li>  Build a separate static library for the necessary architectures (for example, this way): <br><pre> <code class="bash hljs">xcodebuild -project iOSDemoLib.xcodeproj \ -target iOSDemoLib -sdk iphonesimulator \ -configuration Release clean build xcodebuild -project iOSDemoLib.xcodeproj \ -target iOSDemoLib -sdk iphoneos -arch armv7 \ -configuration Release clean build</code> </pre><br></li><li>  Make a universal library for several platforms from libraries, resulting in the previous step: <br><pre> <code class="bash hljs">lipo -create -output ../iOSDemoLib.Binding/libiOSDemoLib.a ../libiOSDemoLib-i386.a ../libiOSDemoLib-iphone-armv7.a</code> </pre><br></li><li>  Create an iOS Binding Project in a C # solution and add a universal static library there.  After that, the file [libname] .linkwith.cs will be automatically created with linking rules that look something like this: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">assembly: LinkWith (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"libiOSDemoLib.a"</span></span></span><span class="hljs-meta">, LinkTarget.Simulator | LinkTarget.ArmV7, ForceLoad = true, Frameworks = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Foundation"</span></span></span><span class="hljs-meta">)</span></span>]</code> </pre><br></li><li>  In the ApiDefinition.cs file (created automatically), specify the rules for binding native classes to .NET types (note that the complex method names must contain colons in places where method parameters must be in Objective-C. That is, Parameters will be two colons): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">iOSDemoLib.Binding</span></span> { [BaseType (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(NSObject))] <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">iOSDemoClass</span></span> { [Export(<span class="hljs-string"><span class="hljs-string">"addData:andOtherValue:"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddDataAndOtherValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value2</span></span></span><span class="hljs-function">)</span></span>; } }</code> </pre><br></li><li>  In the application project in which you plan to use the library, add the iOS Binding project to References. </li><li>  Collect, run, be happy. </li></ul><br>  In general, it is very good and accessible about binding native libraries written <a href="http://docs.xamarin.com/guides/ios/advanced_topics/binding_objective-c_libraries">here</a> . <br><br><h5>  Work with databases </h5><br>  To work with databases in iOS, the same namespaces are used as in Android.  The API, respectively, is the same.  A small difference can be in the details.  For example, to get the path to the SQLite database file on Android, there is a special API call: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> path = GetDatabasePath(<span class="hljs-string"><span class="hljs-string">"xamarindemo.sqlite"</span></span>).Path;</code> </pre><br>  In iOS, you need to use the standard .NET tools: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> path = Path.Combine( Environment.GetFolderPath(Environment.SpecialFolder.Personal), <span class="hljs-string"><span class="hljs-string">"xamarindemo.sqlite"</span></span>);</code> </pre><br><br><h5>  Remote debugging of iOS applications from Visual Studio </h5><br>  In Xamarin 2.0, you can debug mobile apps for iOS right from Visual Studio.  In order to make this possible, you need to have Macs with XCode, iOS SDK and Xamarin Studio installed on the local network.  You do not need to make any additional settings; it‚Äôs enough when you open an iOS project in Visual Studio to select the required build server from the list of available ones. <br><br>  Unfortunately, this approach did not work with a virtual machine running on the same computer as Visual Studio.  Although everything works fine with a regular Mac on a local network.  I could not find any reasons or explanations for this, I try to communicate with the developers about this. <br><br>  It is also not very clear how to organize UI testing and application health check from Visual Studio.  The simulator runs on a Mac, it seems that VNC is indispensable here. <br><br><h4>  Cross Platform Class Libraries (Portable Class Libraries) </h4><br>  Xamarin provide the ability to create libraries that can be used (in the form of code or ready-made assemblies) for several platforms at once.  Such libraries are called Portable Class Library (PCL). <br><br>  For the development of such libraries, a special truncated version of the .NET Runtime is used and this is a wonderful tool for the developer, the importance of which is difficult to overestimate, but here, too, everything is not so simple.  By default, Visual Studio cannot specify Android and iOS as supported platforms for the PCL project.  But this does not mean that Visual Studio immediately becomes useless in this regard. <br><br>  The problem can be solved by creating XML files in the folder <code>C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETPortable\v4.0\Profile\Profile104\SupportedFrameworks</code> for x64 systems or in the folder <code>C:\Program Files\Reference Assemblies\Microsoft\Framework\.NETPortable\v4.0\Profile\Profile104\SupportedFrameworks</code> for x86 systems. <br>  Android file <b>MonoAndroid, Version = v1.6 + .xml</b> <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Framework</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DisplayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Mono for Android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Identifier</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MonoAndroid"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Profile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MinimumVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.6"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MaximumVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  iOS <b>VSMonoTouch</b> file <b>, Version = v1.0 + .xml</b> <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Framework</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DisplayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"VS MonoTouch"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Identifier</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".NETFramework"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Profile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MinimumVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MaximumVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  After creating these two files and restarting Visual Studio, you can specify Android and iOS as supported platforms for new PCL projects or add these platforms to existing projects via Properties -&gt; Library -&gt; Target Framework. <br>  But this is not all the nuances. <br><br>  If you want support for Android and iOS in a PCL project, then you will have to abandon support for Xbox 360 and Windows Phone 7 (but you can support Windows Phone 7.5+).  For Xbox, you will have to create another project and add files from the existing PCL project as links.  Or, as an option, leave all Microsoft platforms (including Xbox 360) in one PCL project, and only iOS and Android in the other. <br><br>  There is still such a problem that a PCL project added from Visual Studio for Windows will not participate in the solution build if you open it in Xamarin Studio under OS X. The project will be inactive and a message will be displayed <i>(not built in active configuration)</i> .  This problem is solved by removing the project from the solution and adding it again. <br><br><h4>  New language features and support for C # 5 </h4><br>  In the development for Android, it is important to transfer work with files, databases, network, etc., that is, with long-term operations, into a separate stream.  C # 5 provides special capabilities for implementing asynchronous operations, namely <a href="http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx">async / await</a> .  Unfortunately, in the current version of Mono for Android and MonoTouch these features are not available.  Because of this, many quite interesting libraries cannot be used in the form that is provided for them.  For example, to work with the asynchronous API of the sqlite-net library, you have to do several tricks with your ears.  The good news is that these features <a href="http://forums.xamarin.com/discussion/1582/could-not-load-type-iasyncstatemechine">should become available</a> in a few months with the transition from Xamarin to C # 5. <br><br><h4>  Additional components and libraries </h4><br>  Xamarin, in addition, in fact, sales of software development tools, opened a <a href="http://components.xamarin.com/">store</a> selling third-party components, many of which really greatly simplify the life of the developer.  The store has both paid and free libraries and themes.  The usefulness, for example, of free <a href="http://components.xamarin.com/view/xamarin.auth/">Xamarin.Auth</a> , <a href="http://components.xamarin.com/view/xamarin.social/">Xamarin.Social</a> and <a href="http://components.xamarin.com/view/xamarin.mobile/">Xamarin.Mobile is</a> difficult to overestimate.  It is possible to publish your own components in this store. <br><br><h4>  Unpleasant moments </h4><br>  Of the problem points, the most noticeable are: <br><ul><li>  Terrible brakes when debugging Android applications, when on a fairly powerful machine with a Core i7 and 8 GB RAM when stopped at a breakpoint Visual Studio freezes for 10-15 seconds.  This can be repeated at each step of the debugger. </li><li>  Absence in the list of devices available for debugging applications, some devices connected to a computer (which, however, are visible through adb devices and on which Eclipse perfectly launches applications) </li><li>  Arbitrary debugger crashes and the need to restart the application due to this. </li><li>  Lack of articles and training materials (yes, there are some materials on the official site, but they do not cover all popular tasks) </li><li>  The presence of bugs that you learn suddenly!  after chatting on the forum.  Although at the same official forum, the developers quite cheerfully answer questions and generally well done. </li><li>  The price for the Business edition is very biting.  In addition, a license for a year, and not forever (the situation is somewhat brightened up by the availability of discounts when purchasing a license for several platforms at once). </li></ul><br><br><h4>  Pleasant moments </h4><br><ul><li>  When you purchase a license for several platforms at once or for several jobs at once, a discount is provided. </li><li>  With the release of the new version, in which there will be support for async \ await, development will indeed become easier and it will be possible to use a bunch of useful libraries without changing their code. </li></ul><br><br><h4>  findings </h4><br>  The Xamarin toolkit does yes, it really works and if you plan to develop several applications a year or the planned profit from the application being developed is more than $ 2k, then the Xamarin SDK can clearly make your life easier and save you from duplicate work on the code for each platform. <br><br>  On the other hand, for the Indy-developer, the price of $ 1k for each platform, for example, seems to me excessive because  There are many nuances that you need to know and / or feel for yourself before starting development, there are bugs that are not known in which mode they will be fixed and it is not known how much their presence can slow down the development of your particular project. <br><br><h4>  A little cool ssylochek! </h4><br><ul><li>  <a href="http://blog.xamarin.com/">Official blog Xamarin</a> . </li><li>  <a href="https://github.com/xamarin">Xamarin on github</a> . </li><li>  <a href="http://www.youtube.com/user/XamarinHQ">Xamarin on YouTube</a> (video posted seminars). </li><li>  Examples <br><ul><li>  <a href="https://github.com/xamarin/monotouch-samples">For iOS</a> . </li><li>  <a href="https://github.com/xamarin/monodroid-samples">For Android</a> . </li><li>  <a href="https://github.com/xamarin/mobile-samples">Cross platform</a> </li></ul><br></li><li>  Blogs <br><ul><li>  <a href="http://tirania.org/blog/">Blog Miguel de Icaza</a> . </li><li>  <a href="http://manski.net/tags/mono-for-android/">Manski.net</a> . </li><li>  <a href="http://conceptdev.blogspot.com/">ConceptDev</a> . </li></ul><br></li><li>  <a href="http://monogame.net/">MonoGame</a> is a framework for creating games. </li><li>  <a href="https://github.com/praeclarum/sqlite-net">Sqlite-net on github</a> . </li></ul><br><br>  <b>UPD:</b> <a href="https://habrahabr.ru/users/northicewind/" class="user_link">Updating</a> from <a href="https://habrahabr.ru/users/northicewind/" class="user_link">northicewind</a> about the cost of the license: <br><blockquote>  The license is perpetual, but includes one year of free updates.  I wrote to them in support for explanations.  Here is their answer <br><blockquote>  Your license is perpetual.  You have to purchase a renewal every year to get new updates. </blockquote></blockquote></div><p>Source: <a href="https://habr.com/ru/post/172121/">https://habr.com/ru/post/172121/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../172107/index.html">Debugging Node.js in Visual Studio</a></li>
<li><a href="../172109/index.html">Rails 4 - Thread-Safety</a></li>
<li><a href="../172111/index.html">DIYROCKETS and Sunglass are taking a step towards the general availability of aerospace development using joint 3D modeling</a></li>
<li><a href="../172115/index.html">Controlling access to Samba file servers in an AD-based Windows domain</a></li>
<li><a href="../172119/index.html">SimplePHPEasyPlus: Adding Numbers to PHP</a></li>
<li><a href="../172123/index.html">Oracle ADF (Application Development Framework)</a></li>
<li><a href="../172127/index.html">New Jump Grasshopper (Grasshopper) SpaceX</a></li>
<li><a href="../172131/index.html">Export photo albums from VKontakte</a></li>
<li><a href="../172133/index.html">The digest of news from the world of mobile development for the last week ‚Ññ5 (March 4 - 10, 2013)</a></li>
<li><a href="../172135/index.html">Google and MPEG LA make a deal on VP8 video codec</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>