<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analysis of the shopping cart using MS Excel and MS SQL Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you are working in the field of trade, then surely the task of analyzing the shopping basket will be of interest to you. In simple words, this task...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analysis of the shopping cart using MS Excel and MS SQL Server</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/8e5/caf/9b8/8e5caf9b8d7b4e798a8afe2e96efc4da.jpg" alt="image"><br><br>  If you are working in the field of trade, then surely the task of analyzing the shopping basket will be of interest to you.  In simple words, this task boils down to determining which goods are most often bought together with other goods.  With this information, you can easily increase sales, making a display of goods in accordance with the results of the analysis, or implement a system of recommendations to the buyer when selling goods. <br><a name="habracut"></a><br>  To solve the problem, we need the following tools: <br><ul><li>  Microsoft Excel (in my case, Microsoft Office 2013 Standard 2013). </li><li>  Microsoft SQL Server (in my case, Microsoft SQL Server 2014 Standard Edition). </li></ul><br>  Also for the analysis, we need sales data.  Previously, I received the following sample using a report in the OLTP system (see Figure 1). <br><br><img src="https://habrastorage.org/files/a19/0bd/881/a190bd8816a74e9cbf71ac6bf982d7c8.png" alt="image"><br>  Fig.  one. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the sample there are: <br><ul><li>  Document reference (Doc field). </li><li>  Product code (Product field). </li><li>  The quantity of the goods sold (the Quantity field). </li><li>  The amount of goods sold (field Amount). </li></ul><br>  Before we start analyzing the recycle bin, we‚Äôll need to download a free Excel plug-in called <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D35578">Data Mining Add-ins for Excel</a> .  After installing the plug-in, the DATA MINING item will appear in the Excel main menu (see Figure 2). <br><br><img src="https://habrastorage.org/files/53d/b6b/17d/53db6b17d4c647f5a217cf203db4a998.png" alt="image"><br>  Fig.  2 <br><br>  The analysis itself is performed on the server by SQL Server Analysis Services, so you need to click the button in the toolbar in the Connections group (highlighted with a red arrow in Figure 2) and establish a connection with the Analysis Services server.  Initially, there will be written ‚ÄúNo connection‚Äù, click on this button and specify the connection parameters.  After that, click the ‚ÄúTrace‚Äù button and uncheck the ‚ÄúUse session models‚Äù box (see Figure 3). <br><br><img src="https://habrastorage.org/files/81d/cd3/00d/81dcd300de1845ddbab979db84446452.png" alt="image"><br>  Fig.  3 <br><br>  Now everything is ready for analysis.  Go to Excel, press Ctrl + A to select the table, go to the "Insert" tab and click on the "Table" button (see. Fig. 4). <br><br><img src="https://habrastorage.org/files/b70/c27/4e2/b70c274e2f184b95ad668ea13692a343.png" alt="image"><br>  Fig.  four. <br><br>  After that we will see the following picture (see fig. 5). <br><br><img src="https://habrastorage.org/files/6c4/d9f/1aa/6c4d9f1aad5b4b50a59a3817849f7eaf.png" alt="image"><br>  Fig.  five. <br><br>  Now click on the ‚ÄúShopping Basket Analysis‚Äù button.  (Pay attention to the adjacent buttons that allow you to perform other types of data analysis, for example, ‚ÄúDetecting Categories‚Äù, ‚ÄúForecast‚Äù and others, but this is a topic for individual articles.) In the window that opens, fill in the parameters for analysis .  As a transaction (Transaction ID), select the field Doc, Item - Product, Item Value - Quantity.  Press the ‚ÄúRun‚Äù button (see fig. 6). <br><br><img src="https://habrastorage.org/files/8a2/1fd/b99/8a21fdb993f64390a6e5d6260d10dbde.png" alt="image"><br>  Fig.  6 <br><br>  During the calculation, the program will show such a window (see Fig. 7). <br><br><img src="https://habrastorage.org/files/c02/4fb/f75/c024fbf755214fd784350e8f2c13cfee.png" alt="image"><br>  Fig.  7 <br><br>  After the calculation is completed, two new sheets will be automatically added to the Excel workbook: <br><ul><li>  Shopping Basket Bundled Items. </li><li>  Shopping Basket Recommendations. </li></ul><br>  Consider the first received label ‚ÄúShopping Basket Bundled Items‚Äù.  In it, we see products that are bought together, sorted by total sales (see Fig. 8). <br><br><img src="https://habrastorage.org/files/94c/9cc/73c/94c9cc73c421472c9ee91af8a4a9be83.png" alt="image"><br>  Fig.  eight. <br><br>  And the second table is ‚ÄúShopping Basket Recommendations‚Äù.  In it we see the recommendations of the following type - bought the product ‚ÄúSelected Item‚Äù, we recommend to buy the product ‚ÄúRecommendation‚Äù  The data is sorted by the number of joint sales (see Fig. 9). <br><br><img src="https://habrastorage.org/files/cb5/0c3/100/cb50c31009344fcca547c45315f4551d.png" alt="image"><br>  Fig.  9. <br><br>  That's all.  As you can see, the analysis of the shopping cart is quite simple. <br><br>  Now back to the question of how to use the data.  I personally offered my business the following: <br><ul><li>  Check whether the display of goods in the retail network is consistent with the analysis data and, if necessary, change the display. </li><li>  Refine the automated system for collecting customer orders in wholesale sales so that when creating a pre-order the information about the recommended order addition is displayed to the sales representative. </li></ul><br>  If in the next quarter my innovations will bring sales growth, it will be an occasion to ask for a bonus :) <br><br>  I hope this article will be useful to you.  Thanks for reading. </div><p>Source: <a href="https://habr.com/ru/post/254863/">https://habr.com/ru/post/254863/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254853/index.html">How we fulfilled the requirement of Roskomnadzor with benefit for business</a></li>
<li><a href="../254855/index.html">Static code analysis</a></li>
<li><a href="../254857/index.html">The story of the unofficial application what3words for BlackBerry</a></li>
<li><a href="../254859/index.html">Dell has released a secure data center for the military</a></li>
<li><a href="../254861/index.html">Writing a script for arranging elements in a circle for Eagle CAD</a></li>
<li><a href="../254865/index.html">Talk to me, Windows Phone</a></li>
<li><a href="../254867/index.html">Alpha TypeScript 1.5 Announcement</a></li>
<li><a href="../254869/index.html">Trigger metastability and inter-cycle synchronization</a></li>
<li><a href="../254871/index.html">Media queries: width against device-width</a></li>
<li><a href="../254873/index.html">Online store. Safety for owners</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>