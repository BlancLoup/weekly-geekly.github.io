<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Distributed server solution for MMO projects (test results of the transport part)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the request of readers, I provide a description of testing the transport part of the server solution on cloud technology, which I described in the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Distributed server solution for MMO projects (test results of the transport part)</h1><div class="post__text post__text-html js-mediator-article">  At the request of readers, I provide a description of testing the transport part of the server solution on cloud technology, which I described in the last article.  First, I want to describe a little what it is and why to test it.  Having started my development with building server solutions for high-load MMO projects in real time, I gradually came to the conclusion that to maintain the maximum possible number of clients, it is necessary to use a fully distributed system.  Below I give theses, on the basis of which, we are developing server solutions now. <br><br><ol><li>  Complete separation of the transport part of the project from the logical part and data </li><li>  Maximum modularity to create the optimal solution for a specific project </li><li>  Unification of solution services (any team can execute any of the services intended for this purpose) </li><li>  Asynchronous task execution </li><li>  SQL is intended only for persistent storage. </li><li>  Using NoSQL to store operational data </li><li>  Using a pooling system (reusable groups of objects) </li><li>  No data binding to processing services </li></ol><br><a name="habracut"></a><br>  The existing solutions use these principles only partially, and it is very problematic to build a truly cloud system based on them.  Take at least the engine ‚ÄúBigWorld‚Äù in which a very interesting, in my opinion, system of dynamic, floating locations, which are tied to the objects of the system, is applied.  What is suitable for huge seamless worlds with low rates of change.  But as practice shows, it is badly combined with rapidly changing games in real time.  We used earlier similar technology and abandoned it, making sure that for real scaling it is necessary: <br><br><ul><li>  <b>Complete separation of Logic, Transport and Data</b> </li><li>  <b>Unification of services of the same type (dynamic pools)</b> <br></li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now, having finished, finally, the development of the main modules of the cloud system, we decided to test in action until one chain <br>  Transport - Processing - Data. <br><br>  <b>Transport service</b> <br>  a) to connect customers <br>  b) unpacking / packing commands <br>  c) command forwarding <br>  <b>Work service</b> <br>  a) connecting logic modules (DLL) <br>  b) transfer of commands to logic modules <br>  c) command processing in logic modules <br>  d) querying SQL and NoSQL <br>  <b>SQL service</b> <br>  a) receiving commands <br>  b) SQL database query optimization <br>  c) send replies <br>  <b>NoSQL service (objects)</b> <b><br></b>  a) object reading on request NoSQL <br>  b) recording NoSQL objects <br>  c) sending the result <br><br>  At the beginning, the test client launches 1000 parallel connections to the server that are serviced by a dynamic thread pool.  Then, after a random time interval, different for each client, a command is sent to the server.  The server receives a command through the Transport service, unpacks it, recognizes and sends it for processing to the Work service.  Work service sends the command to the correct logic module, where it is processed.  A request is sent to the NoSQL database to get the desired object, its data is read and small calculations are made.  Then the result is sent back to the transport server for shipment to the client.  Queries in the SQL database are approximately ¬º of all requests from the client.  So, as all data is stored in the operational database NoSQL, and SQL acts only as a data warehouse. <br><br>  <b>Computer Features:</b> <br>  OS - Windows 2008 server <br>  RAM - 8GB <br>  CPU - i7 (8 core) <br>  SQL - MSSQL <br>  All services were launched on 1 PC.  To increase the load. <br><img src="http://www.goldingame.ru/TestSheme2.jpg" width="505" height="277"><br><br>  <b>Test results for 1 service:</b> <b><br></b>  Simultaneous connections were made - <b>from 5,000 to 10,000</b> individual clients (10 test programs of 1,000 clients each client asynchronously in a parallel thread) <br>  <b>NoSQL The</b> number of processing requests for which the delay time does not exceed 1 ms - <b>1200 per second</b> <br>  <b>SQL</b> Number of processing requests for which the delay time does not exceed 1 ms - <b>500 per second</b> <br>  For the transport service (1 instance) the optimal number of connections is <b>10,000</b> <br><br><img src="http://www.goldingame.ru/TestStatya2.jpg" width="379" height="464"><br>  According to the test results, you can see that the system works stably, without failures, only the processing time increases with increasing load.  In reality, services will run on separate PCs (distributed system) and power balancers will ensure that the request delay time does not exceed 1 ms.  This test is synthetic and does not guarantee that 10,000 full-fledged clients of a dynamic MMO game can be operated on one server.  The technology is distributed and involves the creation of a computing cloud consisting of individual PCs connected to a local high-speed network.  The system provides for vertical and horizontal scaling. <br>  According to our calculations, about <b>10,000</b> real-time clients will need about <b>10</b> servers for an MMO game. <br><br><ul><li>  Transport: 1-2 servers </li><li>  Calculation: 3-5 servers </li><li>  NoSQL storage: 1-2 servers </li><li>  SQL storage: 1 server </li></ul><br>  As the key point is the speed of calculating the logic of game objects. <br>  <font color="#FF0000"><b>VERY IMPORTANT!</b></font>  Make fast data processing logic.  We have been looking for the optimal structure of logic for a long time and developed our model, which we called <font color="#0099CC"><b>‚ÄúIsolated calculation of game objects‚Äù</b></font> .  This model allows to avoid logical collisions and to simplify the calculation of logic for one object as much as possible.  Using fully asynchronous programming and deferred procedures. <br>  For those who are interested, ‚Äúfeel personally‚Äù after signing the NDA, we can provide test and admin clients <br>  for your own tests. <br><img src="http://www.goldingame.ru/TestStatya3.jpg" width="504" height="306"><br>  <font color="#555555"><b>Create, use distributed server solutions for your MMO projects - this will help in the future to avoid server side crashes.</b></font>  <font color="#555555"><b>For all questions - please always help.</b></font> <br></div><p>Source: <a href="https://habr.com/ru/post/103340/">https://habr.com/ru/post/103340/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../103332/index.html">Analog HTC clock / weather widget in windows</a></li>
<li><a href="../103333/index.html">Auction for SCO assets appointed</a></li>
<li><a href="../103334/index.html">235 free indie games in 10 minutes</a></li>
<li><a href="../103337/index.html">Reader's Award. We vote for the authors of money!</a></li>
<li><a href="../103339/index.html">ZFS v28 for FreeBSD started testing</a></li>
<li><a href="../103341/index.html">Asterisk protection or Cuban epidemic</a></li>
<li><a href="../103342/index.html">Interview with the leader of GTUG Russia</a></li>
<li><a href="../103343/index.html">In the first month since the release, 3 million copies of Starcraft II were sold.</a></li>
<li><a href="../103344/index.html">The story about "Domolink"</a></li>
<li><a href="../103346/index.html">We build high-quality sound in Qt application (Qt + FMOD)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>