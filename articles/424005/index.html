<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rapid prototypes on Flutter and Kotlin / Native</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Having received the task of developing an application for our upcoming internal conference within the OLX Group, my team thought about how to reduce t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rapid prototypes on Flutter and Kotlin / Native</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/c05/ca7/ac4/c05ca7ac4411c1d831ae565963ad5b19.jpg" alt="Rapid prototypes on Flutter and Kotlin / Native"></p><br><p>  Having received the task of developing an application for our upcoming internal conference within the OLX Group, my team thought about how to reduce the time to create an application for iOS and Android, because we had something to do without it.  The first thing that occurred to me was to use Kotlin, because  It can compile on other platforms.  <em>Spoiler: not everything went as originally planned, but we did everything on time, learning many new things along the way!</em> </p><br><p>  So, this is a story about how we made the OLX Group Product &amp; Tech Conference application in record time. </p><a name="habracut"></a><br><p>  Recently, companies like Google and Facebook have made great efforts in the development of cross-platform development.  <a href="https://flutter.io/">Flutter</a> and <a href="https://kotlinlang.org/docs/reference/native-overview.html">Kotlin / Native</a> are the results of these efforts. </p><br><h2 id="chto-takoe-flutter">  What is Flutter? </h2><br><p>  Flutter, developed by Google, was announced in 2017.  As a development language, he uses Dart.  Flutter supports compiling code on both Android and iOS using the same code base written in Dart.  Flutter is compiled into native code, and does not use web view components in applications.  But it uses its own user interface components instead of platform-specific UIView in iOS or Fragments and ViewGroups in Android.  Flutter also supports <a href="https://devcolibri.com/course/android-material-design-%25D0%25B4%25D0%25BB%25D1%258F-%25D0%25BD%25D0%25B0%25D1%2587%25D0%25B8%25D0%25BD%25D0%25B0%25D1%258E%25D1%2589%25D0%25B8%25D1%2585/">Material Design</a> and Material Theming in its user interface components. </p><br><p>  We had no experience with Dart development, so we were not sure that we would have enough time to learn a new language (after all, we had other priorities).  We really did not start using Flutter until we realized that we really had little time.  Therefore, we initially started with the use of Kotlin / Native and developed some model data and logic for them. </p><br><p>  This is the folder structure in Kotlin / Native we had: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/55e/3fc/287/55e3fc287dfe0cef90703ff79e6a61f6.jpg" alt="Folder structure in Kotlin / Native"></p><br><p>  Pay attention to the ‚Äúcommon‚Äù folder where all common code written in Kotlin is placed.  Accordingly, projects on Android and iOS use the code from this folder. </p><br><h2 id="chto-takoe-kotlinnative">  What is Kotlin / Native? </h2><br><p>  Kotlin / Native was developed by JetBrains, the same company that created Kotlin.  If you have not heard of Kotlin, perhaps you just recently did not go online.  In general, this is a simplified replacement for Java, which also supports backward compatibility with it.  Kotlin / Native allows you to write code on Kotlin and compile it on various platforms that do not natively support Kotlin, for example, iOS. </p><br><h2 id="dizayn">  Design </h2><br><p>  We asked our designer to distribute some layout for the application, and she quickly made a nice design with the help of Material Theming.  <a href="https://devcolibri.com/course/ui-%25D0%25B2-sketch-%25D0%25B4%25D0%25BB%25D1%258F-%25D0%25BD%25D0%25B0%25D1%2587%25D0%25B8%25D0%25BD%25D0%25B0%25D1%258E%25D1%2589%25D0%25B8%25D1%2585/">Sketch</a> has a plugin for creating Material Theming sketches, which saved us a lot of time and effort. </p><br><p>  Here is a small overview of the sketch designs made by our designer: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ec3/e58/7b8/ec3e587b8063208eca520350521e6569.jpg" alt="Thumbnail overview"></p><br><p>  Material Theming allows you to quickly create design layouts and supports both iOS and Android. </p><br><p>  Initially, we wanted to implement the user interface separately for Android and iOS.  Despite the fact that both platforms support Material Theming, we would still have to write interfaces for both.  And we thought that if we use Flutter for the user interface, we will have one code base for it and it will be independent of the application logic, and accordingly we can continue to use Kotlin logic regardless of this. </p><br><h2 id="uchim-kotlinnative-i-flutter-rabotat-vmeste">  Teach Kotlin / Native and Flutter to work together. </h2><br><p>  Since  before that, Flutter and I did not work, we needed to make sure that it would work with existing code that we already have.  By the way, it seems that before that no one tried to use Flutter and Kotlin / Native together.  We planned to build the architecture shown below.  This architecture reduces the number of code specific to each platform, and also reduces the amount of code on the Dart, since  we can isolate most of the logic using Kotlin. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/5f7/3d9/cd0/5f73d9cd00d30319688ed44934704147.png" alt="Application architecture"></p><br><p>  We were able to reduce the amount of specific code using Kotlin and Dart.  Since  Since we were more familiar with Kotlin, then most of the common code was written on it, and not on Dart. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ab1/416/d58/ab1416d58e52c0b7742a3c112d3024e4.jpg" alt="application"></p><br><h2 id="ogranicheniya">  Restrictions </h2><br><p>  Both of these technologies have certain limitations that make using them not as simple as it could be. </p><br><p>  <strong>Restriction 1:</strong> Kotlin / Native only supports Kotlin classes for common code.  For example, if you wanted to use java.util.Date, then you would not have such an opportunity, because  it requires a JVM.  One way to solve this problem is to implement this method in the platform code (Android and iOS) and call it from Kotlin / Native. </p><br><p>  <strong>Restriction 2:</strong> Kotlin uses Companion objects for static methods that turn into a completely new object in iOS.  One way to get around this is to make static methods an instance method or make a class method a global function. </p><br><p>  <strong>Restriction 3:</strong> Kotlin / Native only supports compilation for arm64 on iOS.  The latest devices work with this processor architecture, but the old ones are still on armv7.  To avoid any problems with the architecture, simply go to ‚ÄúBuild Settings‚Äù and delete all architectures except arm64. </p><br><p>  There are also some limitations in the interaction between the Kotlin code, Flutter code, and the platform code.  Flutter can interact with the platform code using channels, passing the method name and a set of parameters there.  Parameters are limited to native classes such as map, list, string, int, etc.  With all this interaction, custom objects are serialized.  However, both Flutter and Kotlin / Native support serialization rather limitedly, so for now we are using native classes directly. </p><br><h2 id="itogi">  Results </h2><br><p>  Key results of our experience: </p><br><ul><li>  Flutter is great for fast prototypes; </li><li>  Flutter and Kotlin / Native are still in beta testing, but can already be used, albeit with some restrictions; </li><li>  Kotlin / Native perfectly solves the problem of reducing the number of platform-specific code; </li><li>  You need to write some layer, which will be responsible for the transfer of objects and their serialization. </li></ul><br><p>  It took about a week of planning and a week and a half to develop the application.  We spent about an hour a day on this with four developers and a designer, while at the same time doing our usual work. </p><br><p>  It was a lot of fun to develop this application using Flutter and Kotlin, and I hope that you will also try these two technologies. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b2d/719/aff/b2d719aff4197c14e4c15c1c1b9f5f9c.gif" alt="IOS application"></p><br><p>  You can find more materials on Kotlin / Native in the official documentation: </p><br><ul><li>  <a href="https://kotlinlang.org/docs/reference/multiplatform.html">Multiplatform projects</a> </li><li>  <a href="https://kotlinlang.org/docs/reference/native-overview.html">Kotlin / Native</a> </li></ul><br><p>  And read / watch about Flutter here: </p><br><ul><li>  <a href="https://flutter.io/docs/">Flutter Documentation</a> </li><li>  <a href="https://codelabs.developers.google.com/codelabs/mdc-103-flutter/">Flutter: Material Theming</a> </li><li>  <a href="https://www.youtube.com/watch%3Fv%3DhA0hrpR-o8U">Beautiful UI code on Flutter and Material Design (Google I / O '18)</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/424005/">https://habr.com/ru/post/424005/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423995/index.html">Clean in the boom workshop. Part 2</a></li>
<li><a href="../423997/index.html">IT Crimea: a new technology park in Sevastopol - it will start working at the end of this year</a></li>
<li><a href="../423999/index.html">The data of Windows users on a PC with touch input is written to a separate file.</a></li>
<li><a href="../424001/index.html">Zimbra and spam protection</a></li>
<li><a href="../424003/index.html">As Apple comes out of an endless loop. Old campus stories</a></li>
<li><a href="../424007/index.html">8 stories that influenced the development of artificial intelligence</a></li>
<li><a href="../424011/index.html">We push parameters into unsafe operations in a safe code</a></li>
<li><a href="../424015/index.html">On both sides of the barricades: hiring mobile application developers</a></li>
<li><a href="../424017/index.html">Tackling the Difficult: A Roadmap for Effective Collaboration</a></li>
<li><a href="../424019/index.html">Old computer, Windows 7, 1 GB RAM, DirectX 9 video card, Firefox and Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>