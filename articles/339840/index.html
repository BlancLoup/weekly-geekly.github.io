<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>When it is better not to use deep learning</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I understand that it is strange to start a blog with a negative, but over the past few days a wave of discussions has risen, which correlates well wit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>When it is better not to use deep learning</h1><div class="post__text post__text-html js-mediator-article">  I understand that it is strange to start a blog with a negative, but over the past few days a wave of discussions has risen, which correlates well with some topics that I have been thinking about lately.  It all started with <a href="https://simplystatistics.org/2017/05/31/deeplearning-vs-leekasso/">Jeff Lick's post on the Simply Stats blog</a> with caution about using in-depth training on a small sample size.  He argues that with a small sample size (which is often observed in biology), linear models with a small number of parameters work more efficiently than neural networks, even with a minimum of layers and hidden blocks. <br><br>  Further, it shows that a very simple linear predictor with the ten most informative features works more efficiently than a simple neural network in the task of classifying zeros and ones in the MNIST data set, using only about 80 samples.  This article encouraged Andrew Bima to write a <a href="http://beamandrew.github.io/deeplearning/2017/06/04/deep_learning_works.html">refutation</a> in which a properly trained neural network was able to surpass a simple linear model, even on a very small number of samples. <br><br>  Such disputes are taking place against the background of the fact that more and more researchers in the field of biomedical informatics are applying in-depth training on various tasks.  Is excitement justified, or are linear models enough for us?  As always, there is no definite answer.  In this article I want to consider cases of machine learning where the use of deep neural networks does not make sense at all.  And also to talk about common prejudices that, in my opinion, interfere with the really effective use of deep learning, especially among beginners. <br><a name="habracut"></a><br><h1>  Destruction of deep learning prejudices </h1><br>  First, let's talk about some prejudices.  It seems to me that they are present in the majority of specialists who are not very knowledgeable in the subject of deep learning, but in fact are half-truths.  There are two very common and one slightly more technical prejudice - we‚Äôll dwell on them.  It is in some way a continuation of the magnificent chapter of ‚ÄúDelusion‚Äù in the <a href="http://beamandrew.github.io/deeplearning/2017/06/04/deep_learning_works.html">article by Andrew Beam</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Deep learning can really work on small sample sizes. </h3><br>  In-depth training has become famous for efficient processing of a large amount of input data (remember that the first Google Brain project involved loading a large number of YouTube videos into a neural network), and has since been constantly described as complex algorithms that work on a large amount of data.  Unfortunately, this pair of big data and depth learning somehow led people to the opposite thought: the myth that depth learning cannot be used on small samples. <br><br>  If you have only a few samples, launching a neural network with a high ratio of parameters to a sample at first glance may seem like a direct way to retraining.  However, simply taking the sample size and dimension into account for this particular problem, when training with a teacher or without a teacher, is something like modeling data in a vacuum, without context.  But you need to consider that in such cases you have relevant data sources or convincing preliminary data that an expert in this field can provide, or the data is structured in a very specific way (for example, in the form of a graph or image).  In all of these cases, it is likely that in-depth training will benefit ‚Äî for example, you can encode useful representations of larger, related data sets and use them in your task.  A classic example of such a situation is often found in natural language processing, where you can learn information about the inclusion of individual words in a large dictionary building such as Wikipedia, and then use the information about the inclusion of words on a smaller, narrow body when teaching with a teacher. <br><br>  In the extreme case, you may have several neural networks that together assimilate the representation <i>and the</i> effective way of its reuse on small sets of samples.  This is called one-shot learning from the first time, and it is successfully used in various fields with multidimensional data, including computer vision and the discovery of new drugs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a3d/bb9/39d/a3dbb939d3a21ef7abe9a8dadee5ab69.png"><br>  <i><font color="gray">Learning networks from the first time in the discovery of new drugs.</font></i>  <i><font color="gray">Illustration from the article Altae-Tran et al.</font></i>  <i><font color="gray">ACS Cent.</font></i>  <i><font color="gray">Sci.</font></i>  <i><font color="gray">2017</font></i> <br><br><h3>  Deep learning is not a universal solution to all problems. </h3><br>  The second misconception that one often hears is a real hyip.  Many experts who begin to practice, expect that the deep-seated nets will give them a fabulous jump in productivity gains just because it happens in other areas.  Others are impressed by the tremendous success of in-depth training in modeling and manipulating images, sound and linguistics - in the three types of data that are closest to humans - and they plunge into this area, trying to educate the latest trendy architecture of concurrent neural networks.  This hype is manifested in different ways. <br><br>  In-depth training has become an undeniable force in machine learning and an important tool in the arsenal of any data model developer.  Its popularity has led to the creation of important frameworks, such as TensorFlow and PyTorch, which are incredibly useful even beyond the depth of learning.  The story of his transformation from an underdog into a superstar inspired researchers to revise other methods previously considered obscure, such as evolutionary strategies and reinforced learning.  But this is by no means a panacea.  In addition to considerations about the absence of freebies, in principle, I can say that models of in-depth training can have important nuances, require careful handling, and sometimes a very costly search for hyperparameters, tuning and testing (for more details, see later in the article).  In addition, there are many cases where in-depth training simply does not make sense from a practical point of view, and simpler models work much better. <br><br>
<h3>  Deep learning is more than <code>.fit()</code> </h3><br>  There is another aspect of depth learning models that, according to my observations, is misunderstood from the point of view of other areas of machine learning.  Most textbooks and introductory materials on depth learning describe these models as composed of hierarchically connected layers of nodes, where the first layer receives an input signal, and the last layer produces an output signal, and you can teach them using some form of stochastic gradient descent.  Sometimes it can be briefly mentioned how the stochastic gradient descent works and what is the reverse error propagation.  But the lion's part of the explanation is devoted to the rich variety of types of neural networks (convolutional, recurrent, etc.).  The optimization methods themselves receive little attention, and this is very bad, because they represent an important (if not the most important) part of the work of any network of in-depth training and because knowledge of these specific methods (read, for example, <a href="http://www.inference.vc/everything-that-works-works-because-its-bayesian-2/">this post by Ferenc Hujar</a> and his <a href="https://arxiv.org/abs/1609.04836">scientific the article</a> that is mentioned there), and knowing how to optimize the parameters of these methods and how to share the data for their effective use is extremely important for obtaining good convergence in a reasonable time. <br><br>  Why exactly stochastic gradients are so important is still unknown, but experts here and there make different assumptions on this matter.  One of my favorites is the interpretation of these methods as part of the Bayesian output calculation.  In fact, every time you perform some kind of numerical optimization, you expect a Baisso conclusion with certain assumptions.  After all, there is a whole region called <a href="http://probabilistic-numerics.org/">probability number</a> , which literally grew out of such an interpretation. <br><br>  The stochastic gradient descent (SGD) is no different, and <a href="https://arxiv.org/pdf/1704.04289.pdf">recent scientific work</a> suggests that this procedure is actually a Markov chain, which, under certain assumptions, demonstrates a stationary distribution, and it can be considered as a kind of variational approximation to the a posteriori probability.  So if you stop your SGD and accept the final parameters, you will in reality get samples from this approximate distribution. <br><br>  This idea seemed very bright to me.  It explains a lot, because the parameters of the optimizer (in this case, the speed of learning) now get much more sense.  Such an example: how you can change the learning rate parameter in a stochastic gradient descent, so the Markov chain becomes unstable until it finds a wide local minimum covering samples in a large area;  thus, you increase the variance of the procedure.  On the other hand, if the learning rate is reduced, the Markov chain slowly approaches a narrower local minimum until it converges in a very narrow area;  thus, you increase the bias to a certain area. <br><br>  Another parameter in SGD, batch size, also controls which type of domain the algorithm converges: in wider areas for small packages or in sharper areas with larger packages. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b0/ae2/b78/9b0ae2b7818216854bdd81a7a66b072f.png"></div><br>  <i><font color="gray">SGD prefers a wide or narrow local minimum, depending on learning speed or packet size.</font></i> <br><br>  Such complexity means that the optimizers of deep neural networks come to the fore: this is the core of the model, just as important as the architecture of the layers.  In many other models of machine learning this is not.  Linear models (even regularization, such as LASSO) and SVM are convex optimization problems that do not have such subtleties and there is only one solution.  That is why specialists who came from other areas and / or use tools like scikit-learn cannot understand why it is impossible to find a very simple API with the <code>.fit()</code> method (although there are some tools like skflow that try to reduce simple neural networks to signature <code>.fit()</code> , but this approach seems to me a bit wrong, because the meaning of deep learning is its flexibility). <br><br><h1>  When not to use depth learning </h1><br>  So, when is deep learning not the most optimal way to solve a problem?  From my point of view, here are the main scenarios where in-depth training will most likely be a hindrance. <br><br><h3>  Low budget or minor problems </h3><br>  Neural networks are very flexible models with many architectures and types of nodes, optimizers and regularization strategies.  Depending on the application, your model may have convolutional layers (how wide? With which pooling?) Or a recurrent structure (with or without gates?).  It can be really deep (Hourglass, Siamese or one of many other architectures) or with just a few hidden layers (how many blocks to use?).  It may contain linear rectification units or other activation functions.  It can turn off part of the neurons during training through the drop-out (in which layers? How many neurons is turned off?) And it is necessary, perhaps, to order the weights (l1, l2 or something more strange?).  This is not a complete list, there are many other types of nodes, links, and even loss functions - all this can be tested. <br><br>  It will take a lot of time to experience such a large number of possible hyper-parameters and architectures, even when training a single instance of a large neural network.  Google recently boasted that its AutoML pipeline is capable of automatically selecting the most optimal architecture, which is very impressive, but it requires around-the-clock work of more than 800 GPUs in a few weeks, and this is not available to everyone.  The bottom line is that learning deep neural networks is expensive, both in computing and in debugging.  Such costs do not make sense to solve everyday forecasting problems, so the ROI of setting up a neural network for such problems may be too small, even when setting up small neural networks.  Even if you have a large budget and an important task, there is no reason not to try first the alternative methods as an initial level.  You may be pleasantly surprised that linear SVM is all you really need. <br><br><h3>  Interpretation and explanation of the model parameters and characteristics for a wide audience </h3><br>  Depth neural networks are also notoriously known as ‚Äúblack boxes‚Äù with high prediction efficiency, but low interpretability.  Although in recent times a lot of tools have been created, like salinity cards and <a href="https://arxiv.org/abs/1704.02685">differences in activation</a> .  They work well in some areas, but not all applications are applicable.  Basically, these tools are useful when you want to verify that a neural network is not deceiving you by remembering a dataset or processing certain dummy attributes.  But it is still difficult to interpret the contribution of each feature to the overall solution of the neural network. <br><br>  In such conditions, nothing can compare with linear models, since there the learned coefficients are directly related to the result.  This is especially important when it is necessary to explain such interpretations to a wide audience that will make important decisions based on them.  For example, physicians need to integrate all kinds of different data to get a diagnosis.  The simpler and clearer the link between the variable and the result, the better the physician can take into account this variable, eliminating the possibility of underestimating or overestimating its value.  Moreover, there are cases when interpretability is more important than the accuracy of the model (usually deep learning has no equal in accuracy).  Thus, legislators may be interested in what effect some demographic variables have, for example, on mortality.  And they may be more interested in direct approximation, rather than prediction accuracy.  In both cases, depth learning is inferior to simpler, more transparent networks. <br><br><h3>  Determination of cause-effect relationships </h3><br>  The extreme case of model interpretability is when we try to define a mechanistic model, that is, a model that actually captures the phenomenon behind the data.  A good example would be to try to predict how two molecules (for example, drugs, proteins, nucleic acids, etc.) react in a certain cellular environment.  Or hypothesize how a certain marketing strategy will affect sales.  According to experts in this field, in reality there is nothing that can compete with the good old Bayesian methods.  This is the best (though not perfect) way to present and draw conclusions about cause-effect relationships.  Vicarious recently published a <a href="https://www.vicarious.com/img/icml2017-schemas.pdf">good scientific paper</a> .  It shows why this more principled approach gives better generalizations than in-depth training in tasks with video games. <br><br><h3>  Training on "unstructured" features </h3><br>  Perhaps this is a controversial point.  I found out that there is one area in which in-depth training is great.  This is a search for useful data representations for a specific task.  A very nice illustration is the above mentioned inclusions of words.  Natural language has a rich and complex structure, it can be approximated using neural networks that take into account the context: each word is represented as a vector encoding the context in which the word is used most often.  Using information about the inclusions of words obtained as a result of training on a large corpus of words, the processing of natural language can sometimes show much greater efficiency in a specific task on another corpus of words.  However, this model may be completely useless if the case is not structured at all. <br><br>  Let's say you're trying to classify objects by studying unstructured keyword lists.  Since keywords are not used in any particular structure (like sentences), it is unlikely that the inclusion of words here will greatly help.  In this case, the data is a word bag model.  Such a presentation would probably be quite enough to complete the task.  However, it can be argued here that word inclusions are calculated relatively simply if you use pre-trained models, and they can better capture the similarity of keywords.  However, I would still prefer to start with a bag of words and see if she can make good predictions.  In the end, each dimension of a bag of words is easier to interpret than the corresponding layer of the inclusion of the word. <br><br><h1>  Future is depth </h1><br>  The field of in-depth training is on the rise, well-funded and stunningly growing.  By the time you read a scientific article published at the conference, it is likely that two or three iterations of improved models will be released on the basis of this article, which can already be considered obsolete.  This is an important warning to all the arguments that I expressed above: in fact, in the near future, in-depth training may be super-useful for all the scenarios mentioned.  Tools for interpreting depth learning models for images and individual sentences are getting better.  The latest software, like <a href="https://arxiv.org/abs/1701.03757">Edward,</a> combines Bayesian modeling and deep neural network frameworks, allowing you to quantify the uncertainty of the parameters of neural networks and make simple Bayesian inference using probabilistic programming and automated variational inference.  In the longer term, we can expect a reduction in the dictionary for modeling: it will capture the salient properties that a neural network can have, and thus reduce the space of those parameters that should be tried.  So don't forget to look into your arXiv feed, this article of mine may become outdated in a month or two. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/027/59d/62f/02759d62fa20650862f36166caf2f7b4.png"><br>  <i><font color="gray">Edward combines probabilistic programming with TensorFlow, allowing for the creation of models that simultaneously use depth learning and Bayesian methods.</font></i>  <i><font color="gray">Illustration: Tran et al.</font></i>  <i><font color="gray">ICLR 2017</font></i> </div><p>Source: <a href="https://habr.com/ru/post/339840/">https://habr.com/ru/post/339840/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339830/index.html">How to offer your game to YouTube / streamer</a></li>
<li><a href="../339832/index.html">Intel introduced the first 17-qubit quantum chip</a></li>
<li><a href="../339834/index.html">Who left: three stories of alumni of the HeadHunter School of Programmers</a></li>
<li><a href="../339836/index.html">Teamwork and electronic document management. University study experience</a></li>
<li><a href="../339838/index.html">Reverse engineering game Strike Commander</a></li>
<li><a href="../339842/index.html">Unusual mitap about Java in St. Petersburg on October 30</a></li>
<li><a href="../339844/index.html">Cisco IOS Archive functionality</a></li>
<li><a href="../339846/index.html">Golang Moscow: meeting in Avito</a></li>
<li><a href="../339848/index.html">Progressive degradation</a></li>
<li><a href="../339850/index.html">How does it feel to work in a customer's office?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>