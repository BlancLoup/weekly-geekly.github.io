<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cheap full flash - fiction or reality?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2016 was declared the beginning of the era of Flash drives: flash becomes cheaper and more accessible. And after the decline in the cost of ssd-drives...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cheap full flash - fiction or reality?</h1><div class="post__text post__text-html js-mediator-article">  2016 was declared the beginning of the era of Flash drives: flash becomes cheaper and more accessible.  And after the decline in the cost of ssd-drives manufacturers produce arrays, the logic of which was originally designed to work only with fast flash drives.  The cost of such decisions still brings them to the corporate segment of the market, not allowing small companies to know all the "charms" of the ssd era.  And here, Synology made its move: meet the budget full-flash array of Synology FS3017.  What is this - a marketing ploy, or the first budget flash array? <a name="habracut"></a><br><br>  The reasons for the appearance of flash systems (All Flash Array - AFA) are quite simple - unified hybrid arrays do not cope with the enormous performance of flash drives, and the logic of work is based on interaction with classic HDDs, increasing the system response time and SSD wear.  Based on this, there are 3 main differences of AFA: <br><br><ol><li>  Increased controller performance, capable of completely "pumping" used drives. <br></li><li>  Optimized architecture that reduces system response time. <br></li><li>  Intellectual processing and data recording functionality that reduces drive wear. <br></li></ol><br>  That is why when my colleagues suggested that I test the array of Synology FS3017, I was very surprised.  Let's evaluate its parameters together and decide whether it fits the AFA category. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The FS3017 array has a standard rack-mount design: 24 SFF drives fit in a 2U package, drives from various manufacturers (Intel, OCZ, Seagate, etc.) are supported, which is typical of all Synology products.  But what surprised me the most was the support of classic HDDs - this calls into question the belonging of the FS3017 to the AFA segment.  On the positive side, both enterprise-class drives with a SAS interface and more budget SATA drives are supported. <br><br>  The processor uses 2 x Intel Xeon E5-2620 (6-core, 2.4 GHz) v3, the amount of internal memory is 64GB DDR4, and can be expanded to an impressive 512 Gb. <br><br><img src="https://habrastorage.org/web/62d/2b4/c0f/62d2b4c0f4b84ea1b01b227f5b3c69d0.jpg"><br><br>  As a network interface in the basic configuration, there are 2 10 GE ports with support for Link Aggregation technology, used for both array management and data transfer.  Additionally, you can install 2 PCI-E (x16 and x8) modules: a network expansion module (1GbE / 10GbE / 25GbE / 40GbE) or a SAS module for connecting two additional disk shelves (RX1217sas to 12 LFF slots or RX2417sas to 24 SFF slots ). <br><br><img src="https://habrastorage.org/web/126/9d7/7b7/1269d77b71734d46955ee3c468fb4291.jpg"><br><br>  The operating system uses Synology DiskStation Manager (DSM) version 6.1, which is familiar to all users.  I expected for my AFA Synology to release a special version of the microcode, but it matches the DSM of desktop and rack-mount models.  So what does this AFA array do?  As it turned out - support for technology RAID F1. <br><br>  According <a href="https://global.download.synology.com/download/Document/WhitePaper/Synology_RAID_F1_WP.pdf">to the</a> manufacturer, RAID F1 technology is designed to reduce the likelihood of data loss associated with the failure of the entire RAID group as a whole.  Since, unlike HDD, the failure of SSD drives is caused by the end of the drive resource (cell wear), then, theoretically, it is possible that all drives of one raid will die at the same time.  To avoid this situation, RAID F1 was developed.  Distributing data blocks between drives like RAID 5, RAID F1 writes a block with checksums twice to 1 drive.  This leads to the fact that his resource is spent faster, and therefore the probability of failure of all disks of the raid is reduced.  After completing the resource and replacing the drive, the system automatically selects the most worn drive, and begins to write duplicate blocks on it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/445/36a/6d7/44536a6d77d541f48ff052628633d9fc.png"></div><br>  Despite all the statements of manufacturers, SSDs still remain expensive drives, and deliberately reducing their resources is not the most reasonable solution to the problem from a business point of view.  While the main players of the AFA-market are introducing technologies for balancing and reducing the amount of recorded data to extend the lifespan of ssd-drives, Synology went in the opposite direction.  How justified and whether this approach will be recognized by the market will show time. <br><br>  The rest of the FS array differs from the RS line (Synology rack arrays) by the presence of a more powerful processor (Intel Xeon D Family), a second socket, and support for RAID F1.  Inherited FS3017 and standard usage scenarios - the list of recommended DSM packages consists of a cloud storage server, a note server and a DVR.  There is no talk of any optimization of architecture and logic for using ssd, which is supported by the presence of the SSD cache function.  Since two of the three signs of AFA-systems are not observed, it remains to check how much the array can pump our ssd-drives. <br><br>  I was provided with a test system with 128 Gb extended memory and 12 <a href="https://ark.intel.com/ru/products/93026/Intel-SSD-DC-S3520-Series-480GB-2_5in-SATA-6Gbs-3D1-MLC">Intel SSD DC S3520 Series drives</a> with a capacity of 480 Gb.  Decent performance and affordable price due to the use of SATA-interface make them the most interesting for those who are planning to build a flash-class budget system.  I allocated 1 disk for hot swapping (global disk replacement from all shelves is supported) and I combined 11 disks in RAID F1.  On the resulting RAID group, I created an iSCSI volume and presented it to the server running Windows Server 2016. Server specification: 2 * Intel Xeon E5-2695 V3 2.3 GHz 14-core, 128 Gb RAM, 2-port 10 GE Base-T.  For technical reasons, I had to use only one port 10 GE Base-T, which clearly affected the performance of the array. <br>  I generated the load by the most popular synthetic test program Iometer on the market.  The goal of the tests was not the performance of the disks, but the array itself, so I decided to use the 4KiB 100% random pattern. <br><br>  I decided to start with the ‚Äúideal‚Äù load of 100% read, in order to check to look at the ‚Äúbeautiful‚Äù figure.  FS3017 showed itself worthily, issuing 156k IOPS. <br><br><img src="https://habrastorage.org/web/bec/9f6/ec1/bec9f6ec127c4d98a1ee2ab1b7f0f067.png"><br><br>  At the same time, the utilization of disks and the computing power of the system did not reach 90% - this indicates that the data transmission channel is a bottleneck.  Then I went to the "combat" tests.  I chose the most common load profile: 67% reading, 33% writing.  The load was generated by 25 Workers (Iometer terminology) for 5 iSCSI targets. <br><br>  Based on personal experience, the specified AFA array configuration with a similar load profile should generate about 120-170k IOPS. After running the cyclic tests with an increase in the number of threads, I saw the following picture: <br><br><img src="https://habrastorage.org/web/933/345/589/9333455896a24095afcd59edb5d297d2.png"><br><br>  As can be seen from the graph, the limit was reached already at 4 I / O flows per loadable Worker and was ~ 94'000 IOPS.  At the same time, there is no further degradation (which always occurs when the ‚Äúceiling‚Äù of the array is reached), therefore, this value is limited by the channel capacity.  This is evidenced by indicators of utilization of computing resources of the array, not exceeding 15%. <br><br>  It is worth noting the explosive growth of the delay time with an increase in the number of threads: <br><br><img src="https://habrastorage.org/web/918/213/469/918213469d2249aaa2642b0f59686dd0.png"><br><br>  Upon reaching 4 threads on the Worker (which gives us a total of 100 threads on the system), the delay was ~ 1.06 ms, after which a sharp degradation began exponentially. <br>  In the future, I plan to connect the server with two ports to see how much the system can squeeze the maximum out of these disks.  But even achieved 94 k IOPS allow FS3017 to be rightly called AFA-system <br><br>  The FS3017 system left a very strange impression: considering the performance indicators achieved in the tests, it can indeed be positioned as an AFA solution, however, the reduced reliability (due to the absence of a second controller) and the functionality that was cut down compared to its competitors puts an end to corporate tasks.  Namely, this sector is currently the main and only user of AFA-systems. <br><br>  But despite this, I am sure that she will definitely find her market segment.  One of the most obvious may be the development of corporate applications and databases with complex terrain.  In these tasks, we can afford to put a test copy of the database or the entire test environment on a very fast and relatively cheap FS3017 for further operational tasks, without exposing the business to losing critical data. </div><p>Source: <a href="https://habr.com/ru/post/330434/">https://habr.com/ru/post/330434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330422/index.html">Redux: an attempt to get rid of the need to think during API requests</a></li>
<li><a href="../330424/index.html">Joint security in the cloud according to RUVDS, HUAWEI and Kaspersky Labs</a></li>
<li><a href="../330426/index.html">XoruX - free monitoring of virtual infrastructure, data storage and transmission systems</a></li>
<li><a href="../330428/index.html">The story of one landing</a></li>
<li><a href="../330432/index.html">Interview with Josh Patridge (Shazam) about marketing, business, strategy and new products</a></li>
<li><a href="../330438/index.html">Polybius Bank: the most significant event of the year in the world of cryptocurrency</a></li>
<li><a href="../330440/index.html">Virtualization opportunities for IT savings</a></li>
<li><a href="../330444/index.html">Effective technical support tools</a></li>
<li><a href="../330446/index.html">Turla's cybercamping: updated Firefox extension uses Instagram</a></li>
<li><a href="../330448/index.html">Designer's blood, sweat and tears</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>