<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unity Editor Extension via the Editor Window, Scriptable Object and Custom Editor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My name is Grisha, and I am the founder of CGDevs. Today I want to talk about the editor's extensions and tell you about one of my projects, wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unity Editor Extension via the Editor Window, Scriptable Object and Custom Editor</h1><div class="post__text post__text-html js-mediator-article">  Hello!  My name is Grisha, and I am the founder of CGDevs.  Today I want to talk about the editor's extensions and tell you about one of my projects, which I decided to put in OpenSource. <br><br>  Unity is a great tool, but it has a small problem.  For a beginner, to make a simple room (a box with windows), you must either master 3D modeling, or try to collect something from the quad.  Recently, ProBuilder has become completely free, but it is also a simplified 3D modeling package.  I wanted a simple tool that allows you to quickly create environments like rooms with windows and the right UV at the same time.  For a long time, I developed one plugin for Unity, which allows you to quickly prototype environments such as apartments and rooms using 2D drawing, and now I decided to put it into OpenSource.  On his example, we will analyze how to expand the editor and what tools for this exist.  If you're interested - welcome under cat.  The link to the project at the end, as always, is attached. <br><br><img src="https://habrastorage.org/webt/e_/oy/lr/e_oylrvnh0iqwprqfu2g_5amfxe.png"><br><a name="habracut"></a><br>  Unity3d has a wide enough toolkit to expand the capabilities of the editor.  Thanks to classes such as <i>EditorWindow</i> , as well as the functionality of <i>Custom Inspector</i> , <i>Property Drawer</i> and <i>TreeView</i> (+ <i>UIElements are</i> coming soon), it is easy to build on your frameworks of varying degrees of complexity over your unit. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Today we will talk about one of the approaches that I used when developing my solution and about a couple of interesting tasks that I had to face. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mvN5O4LtMZo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  The solution is based on the use of three classes, such as <i>EditorWindow</i> (all additional windows), <i>ScriptableObject</i> (data storage) and <i>CustomEditor</i> (additional inspector functionality for the Scriptable Object). <br><br>  When developing editor extensions, it is important to try to adhere to the principle that the extension will be used by the Unity developers, so the interfaces must be clear, native, and written into the Unity workflow. <br><br>  Let's talk about interesting problems. <br><br>  In order for us to prototype something, first of all we need to learn how to draw drawings, from which we will generate our environment.  To do this, we need a special EditorWindow window, in which we will display all the drawings.  In principle, it would be possible to draw in SceneView, but the initial idea was that when finalizing the solution, you might want to open several drawings at the same time.  In general, in the unit to create a separate window is a fairly simple task.  You can read about it in <a href="https://docs.unity3d.com/Manual/editor-EditorWindows.html">Unity manuals.</a>  But the drawing grid is a more interesting task.  There are several problems with this topic. <br><br>  <b>In Unity, several styles that affect the colors of windows</b> <br><br>  The fact is that most people using the Pro version of Unity use a dark theme, and in the free version only the light one is available.  However, the colors that are used in the drawing editor should not blend into the background.  Here you can come up with two solutions.  Difficult - to make your own version of styles, check it and change the palette under the version of the unit.  And simple - fill the window background with a certain color.  When developing it was decided to use a simple way.  An example of how this can be done is to call such code in the OnGUI method. <br><br><div class="spoiler">  <b class="spoiler_title">Color shading</b> <div class="spoiler_text"><pre><code class="cs hljs">GUI.color = BgColor; GUI.DrawTexture(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(Vector2.zero, maxSize), EditorGUIUtility.whiteTexture); GUI.color = Color.white;</code> </pre> <br></div></div><br><br>  In essence, we simply rendered the BgColor color texture into the entire window. <br><br><img src="https://habrastorage.org/webt/vy/oz/vg/vyozvgmtlmv5ureag8qpthzfpik.png"><br><br>  <b>Draw and move the grid</b> <br><br>  Here several problems opened at once.  First, it was necessary to enter your coordinate system.  The fact is that for correct and convenient work we need to recalculate the GUI coordinates of the window to the coordinates of the grid.  For this, two transformation methods were implemented (in essence, these are two TRS matrices) <br><br><div class="spoiler">  <b class="spoiler_title">Recalculation of window coordinates to screen coordinates</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Vector2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GUIToGrid</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 vec</span></span></span><span class="hljs-function">)</span></span> { Vector2 newVec = ( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(vec.x, -vec.y) - <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(_ParentWindow.position.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, -_ParentWindow.position.height / <span class="hljs-number"><span class="hljs-number">2</span></span>)) * _Zoom + <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(_Offset.x, -_Offset.y); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newVec.RoundCoordsToInt(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Vector2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GridToGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 vec</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(vec.x - _Offset.x, -vec.y - _Offset.y) ) / _Zoom + <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(_ParentWindow.position.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, _ParentWindow.position.height / <span class="hljs-number"><span class="hljs-number">2</span></span>); }</code> </pre><br></div></div><br><br>  where <i>_ParentWindow</i> is the window in which we are going to draw the grid, <i>_Offset</i> is the current position of the grid, and <i>_Zoom</i> is the degree of approximation. <br><br>  Secondly, for drawing lines, we need the <i>Handles.DrawLine</i> method.  The Handles class has many useful methods for drawing simple graphics in the editor, inspector or SceneView windows.  At the time of development of the plug-in (Unity 5.5), <i>Handles.DrawLine</i> - allocated memory and as a whole worked rather slowly.  For this reason, the number of possible lines for drawing was limited to the constant <i>CELLS_IN_LINE_COUNT</i> , and also made the ‚ÄúLOD level‚Äù at the zoom to achieve an acceptable fps in the editor. <br><br><div class="spoiler">  <b class="spoiler_title">Grid drawing</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DrawLODLines</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> level</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gridColor = SkinManager.Instance.CurrentSkin.GridColor; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> step0 = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) Mathf.Pow(<span class="hljs-number"><span class="hljs-number">10</span></span>, level); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> halfCount = step0 * CELLS_IN_LINE_COUNT / <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = halfCount * DEFAULT_CELL_SIZE; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offsetX = ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (_Offset.x / DEFAULT_CELL_SIZE)) / (step0 * step0) * step0; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> offsetY = ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (_Offset.y / DEFAULT_CELL_SIZE)) / (step0 * step0) * step0; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = -halfCount; i &lt;= halfCount; i += step0) { Handles.color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(gridColor.r, gridColor.g, gridColor.b, <span class="hljs-number"><span class="hljs-number">0.3f</span></span>); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(-length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)) ); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, -length + offsetY * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, length + offsetY * DEFAULT_CELL_SIZE)) ); } offsetX = (offsetX / (<span class="hljs-number"><span class="hljs-number">10</span></span> * step0)) * <span class="hljs-number"><span class="hljs-number">10</span></span> * step0; offsetY = (offsetY / (<span class="hljs-number"><span class="hljs-number">10</span></span> * step0)) * <span class="hljs-number"><span class="hljs-number">10</span></span> * step0; ; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = -halfCount; i &lt;= halfCount; i += step0 * <span class="hljs-number"><span class="hljs-number">10</span></span>) { Handles.color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(gridColor.r, gridColor.g, gridColor.b, <span class="hljs-number"><span class="hljs-number">1</span></span>); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(-length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(length + offsetX * DEFAULT_CELL_SIZE, (i + offsetY) * DEFAULT_CELL_SIZE)) ); Handles.DrawLine( GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, -length + offsetY * DEFAULT_CELL_SIZE)), GridToGUI(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2((i + offsetX) * DEFAULT_CELL_SIZE, length + offsetY * DEFAULT_CELL_SIZE)) ); } }</code> </pre><br></div></div><br><br>  For Grid almost everything is ready.  His movement is described very simply.  _Offset is essentially the current position of the ‚Äúcamera‚Äù. <br><br><div class="spoiler">  <b class="spoiler_title">Grid movement</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Move</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 dv</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = _Offset.x + dv.x * _Zoom; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = _Offset.y + dv.y * _Zoom; _Offset.x = x; _Offset.y = y; }</code> </pre> <br></div></div><br><br>  In the project itself, you can review the window code in general and see how you can add buttons to the window. <br><br>  We go further.  In addition to a separate window for drawing drawings, we need to somehow store the drawings themselves.  The internal Unity serialization mechanism, the Scriptable Object, is great for this.  In fact, it allows you to store the described classes in the form of assets in the project, which is very convenient and native for many developers.  For example, part of the Apartment class, which is responsible for storing information about the layout as a whole. <br><br><div class="spoiler">  <b class="spoiler_title">Part of the class Apartment</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Apartment</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> fields public float Height; public bool IsGenerateOutside; public Material OutsideMaterial; public Texture PlanImage; [SerializeField] private List&lt;Room&gt; _Rooms; [SerializeField] private Rect _Dimensions; private Vector2[] _DimensionsPoints = new Vector2[4]; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span></span></code> </pre> <br></div></div><br><br>  In the editor, it looks like this in the current version: <br><br><img src="https://habrastorage.org/webt/h1/hh/9o/h1hh9oc8lin8nh3ztjvjqbi0hb0.png"><br><br>  Here, of course, CustomEditor has already been applied, but nevertheless, you will notice that such parameters as _Dimensions, Height, IsGenerateOutside, OutsideMaterial and PlanImage are displayed in the editor. <br><br>  All public fields and fields marked with [SerializeField] are serialized (that is, saved in a file in this case).  This greatly helps to save drawings if necessary, but when working with ScriptableObject, and all the resources of the editor you need to remember that it is better to call AssetDatabase.SaveAssets () to save the state of the files.  Otherwise, the changes will not be saved.  If you just do not save the project with your hands. <br><br>  Now partially analyze the class ApartmentCustomInspector, and how it works. <br><br><div class="spoiler">  <b class="spoiler_title">Class ApartmentCustomInspector</b> <div class="spoiler_text"><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">CustomEditor(typeof(Apartment))</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ApartmentCustomInspector</span></span> : <span class="hljs-title"><span class="hljs-title">Editor</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Apartment _ThisApartment; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Rect _Dimensions; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEnable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _ThisApartment = (Apartment) target; _Dimensions = _ThisApartment.Dimensions; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnInspectorGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { TopButtons(); _ThisApartment.Height = EditorGUILayout.FloatField(<span class="hljs-string"><span class="hljs-string">"Height (cm)"</span></span>, _ThisApartment.Height); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dimensions = EditorGUILayout.Vector2Field(<span class="hljs-string"><span class="hljs-string">"Dimensions (cm)"</span></span>, _Dimensions.size).RoundCoordsToInt(); _ThisApartment.PlanImage = (Texture) EditorGUILayout.ObjectField(_ThisApartment.PlanImage, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Texture), <span class="hljs-literal"><span class="hljs-literal">false</span></span>); _ThisApartment.IsGenerateOutside = EditorGUILayout.Toggle(<span class="hljs-string"><span class="hljs-string">"Generate outside (Directional Light)"</span></span>, _ThisApartment.IsGenerateOutside); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_ThisApartment.IsGenerateOutside) _ThisApartment.OutsideMaterial = (Material) EditorGUILayout.ObjectField( <span class="hljs-string"><span class="hljs-string">"Outside Material"</span></span>, _ThisApartment.OutsideMaterial, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Material), <span class="hljs-literal"><span class="hljs-literal">false</span></span>); GenerateButton(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dimensionsRect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rect(-dimensions.x / <span class="hljs-number"><span class="hljs-number">2</span></span>, -dimensions.y / <span class="hljs-number"><span class="hljs-number">2</span></span>, dimensions.x, dimensions.y); _Dimensions = dimensionsRect; _ThisApartment.Dimensions = _Dimensions; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopButtons</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GUILayout.BeginHorizontal(); CreateNewBlueprint(); OpenBlueprint(); GUILayout.EndHorizontal(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateNewBlueprint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Create new"</span></span> )) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> manager = ApartmentsManager.Instance; manager.SelectApartment(manager.CreateOrGetApartment(<span class="hljs-string"><span class="hljs-string">"New Apartment"</span></span> + GUID.Generate())); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenBlueprint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Open in Builder"</span></span> )) { ApartmentsManager.Instance.SelectApartment(_ThisApartment); ApartmentBuilderWindow.Create(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateButton</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Generate Mesh"</span></span> )) { MeshBuilder.GenerateApartmentMesh(_ThisApartment); } } }</code> </pre> <br></div></div><br>  CustomEditor is a very powerful tool that allows you to solve elegantly many typical tasks for expanding the editor.  Paired with ScriptableObject, it allows you to make simple, convenient and understandable editor extensions.  This class is a bit more complicated than simply adding buttons, since in the source class you can see that the [SerializeField] private List _Rooms field is serialized.  Displaying it in the inspector is, firstly, to nothing, and secondly, it can lead to unforeseen bugs and drawing conditions.  The OnInspectorGUI method is responsible for drawing the inspector, and if you just need to add buttons, you can call the DrawDefaultInspector () method in it and all the fields will be drawn. <br><br>  Immediately the necessary fields and buttons are drawn by hand.  The EditorGUILayout class in itself has many implementations for the most different types of fields supported by the unit.  But button rendering in Unity is implemented in the GUILayout class.  As in this case, the processing of pressing buttons.  OnInspectorGUI - handles for each user input event with the mouse (mouse movement, mouse clicks inside the editor window, etc.) If the user clicks the button in the billing box, the method returns true and work out the methods that are inside the if ' a.  For example: <br><br><div class="spoiler">  <b class="spoiler_title">Mesh generation button</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateButton</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GUILayout.Button( <span class="hljs-string"><span class="hljs-string">"Generate Mesh"</span></span> )) { MeshBuilder.GenerateApartmentMesh(_ThisApartment); } }</code> </pre> <br></div></div><br>  When you click on the Generate Mesh button, a static method is called that is responsible for generating the mesh of a particular layout. <br><br>  In addition to these basic mechanisms used in the expansion of the Unity editor, I would like to separately note a very simple and very convenient tool, which for some reason many people forget about - Selection.  Selection is a static class that allows you to select the necessary objects in the inspector and ProjectView. <br><br>  In order to select an object, you just need to write Selection.activeObject = MyAwesomeUnityObject.  And the most beautiful thing is that it works with ScriptableObject.  In this project, he is responsible for selecting the drawing and the rooms in the drawing window. <br><br>  Thanks for attention!  I hope the article and the project will be useful to you, and you will get something new for you in one of the approaches of the Unity editor extension.  And as always - a <a href="https://github.com/CGDevsCommunity/Apartment_Builder">link to the GitHub project</a> , where you can see the whole project.  It is still a bit damp, but nevertheless it already allows you to make layouts in 2D simply and quickly. </div><p>Source: <a href="https://habr.com/ru/post/431856/">https://habr.com/ru/post/431856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431844/index.html">Swift Heroes 2018. How It Was</a></li>
<li><a href="../431846/index.html">GeekBrains begins to prepare full-stack developers in Python</a></li>
<li><a href="../431848/index.html">As I wrote the biggest script for Altium Designer</a></li>
<li><a href="../431852/index.html">Hack 50,000 network printers and print custom text? There is nothing easier</a></li>
<li><a href="../431854/index.html">Data consistency in high load systems</a></li>
<li><a href="../431858/index.html">Mitap Sberteha in Rostov-on-Don</a></li>
<li><a href="../431862/index.html">Mitap Sberteha in Yekaterinburg</a></li>
<li><a href="../431864/index.html">PVS-Studio ROI: how not to lose millions (draft article)</a></li>
<li><a href="../431866/index.html">Programmers misconceptions about names - with examples</a></li>
<li><a href="../431870/index.html">Developer of interactive books with LEDs complained about the theft of ideas by Google employees</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>