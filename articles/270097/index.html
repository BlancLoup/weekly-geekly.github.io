<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Some YAML Tricks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post I will talk about not very well-known features of the language YAML. 

 Prologue 
 System administration over the past few years has chan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Some YAML Tricks</h1><div class="post__text post__text-html js-mediator-article">  In this post I will talk about not very well-known features of the language YAML. <br><br><h2>  Prologue </h2><br>  System administration over the past few years has changed somewhat.  Instead of small bash scripts, we now have huge configuration system projects.  Puppet with a million modules is ready to ‚Äúconfigure‚Äù any type of machine for us, install everything and configure everything.  And of course, this celebration is crowned by the automation of <a href="http://habrahabr.ru/post/242657/">Hiera</a> - the control system of the control system. <br><br>  At the beginning, the idea of ‚Äã‚Äãisolating all configuration data into a hierarchical structure and editing beautiful and convenient YAML files seems incredibly seductive, especially if we recall the many formats of config files whose creators seem to have participated in original thinking competitions.  However, very soon we find ourselves with thousands of lines of YAML.  Let's see how you can use YAML to make our configurations easier to read and maintain. <br><a name="habracut"></a><br><h2>  Examples </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Multiline text </h5><br>  Very often you need to cram in multi-line hiera text.  For this there are at least 3 ways. <br><br><pre><code class="hljs pgsql">multiliners: ugly_multiline: "ugly\nugly\nugly\nugly\n" multiline_with_line_ending: | multiline <span class="hljs-type"><span class="hljs-type">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> ending multiline_without_line_ending: |- multiline <span class="hljs-type"><span class="hljs-type">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">without</span></span> ending</code> </pre> <br>  Please now that you have learned how to make multi-line text, do not use the first method. <br><br><h5>  Single line text </h5><br>  Sometimes you need to cram a lot of sub-lines into one line.  In YAML, this can be done in at least three ways. <br><br><pre> <code class="hljs pgsql">singleliners: simple: single <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span> single-<span class="hljs-type"><span class="hljs-type">line</span></span>-<span class="hljs-type"><span class="hljs-type">text</span></span>: &gt;- single <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span> single-<span class="hljs-type"><span class="hljs-type">line</span></span>-<span class="hljs-type"><span class="hljs-type">text</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-<span class="hljs-type"><span class="hljs-type">line</span></span>-ending: &gt; single <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-type"><span class="hljs-type">text</span></span></code> </pre><br>  Interestingly, all 3 methods can be used anywhere, for example, in lists: <br><br><pre> <code class="hljs javascript">commands: - <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> something <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> --a long --list <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> --parameters - <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> something <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> --a long --list <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> --parameters</code> </pre><br><h5>  Json-style </h5><br>  YAML since version 1.2 is a superset of JSON.  That is, everything that is correct for JSON is also suitable for YAML.  Sometimes this can be used to improve readability. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">json</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">vm-profiles-yaml</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">small</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span>: 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">ram</span></span>: 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span>: 10 <span class="hljs-selector-tag"><span class="hljs-selector-tag">os</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">rhel6</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">large</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">cpu</span></span>: 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">ram</span></span>: 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span>: 10 <span class="hljs-selector-tag"><span class="hljs-selector-tag">os</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">rhel6</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vm-profiles-json</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">small</span></span>: { <span class="hljs-attribute"><span class="hljs-attribute">cpu</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, ram: <span class="hljs-number"><span class="hljs-number">2</span></span>, disk: <span class="hljs-number"><span class="hljs-number">10</span></span>, os: rhel6 } <span class="hljs-selector-tag"><span class="hljs-selector-tag">large</span></span>: { <span class="hljs-attribute"><span class="hljs-attribute">cpu</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, ram: <span class="hljs-number"><span class="hljs-number">4</span></span>, disk: <span class="hljs-number"><span class="hljs-number">10</span></span>, os: rhel6 }</code> </pre><br>  The obvious disadvantage of the last construction is that changing one parameter changes the entire line, and the alignment can also spoil the story in GIT.  However, readability is worth it. <br><br><h5>  Matrices </h5><br>  Another use of JSON-style is the definition of matrices. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">matrices</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">matrix_json_style</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[ [1, 0, 0]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0, 1, 0]</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0, 0, 1]</span></span>, ] <span class="hljs-selector-tag"><span class="hljs-selector-tag">matrix_yaml_style</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[1, 0, 0]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0, 1, 0]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[0, 0, 1]</span></span></code> </pre><br><h5>  Inheritance </h5><br>  They did not expect?  I was surprised too.  It turns out that there is also inheritance in YAML. <br><br><pre> <code class="hljs pgsql">inheritance: _basic: &amp;basic cpu: <span class="hljs-number"><span class="hljs-number">2</span></span> ram: <span class="hljs-number"><span class="hljs-number">2</span></span> disk: <span class="hljs-number"><span class="hljs-number">10</span></span> os: rhel6 vm-profiles: small: &lt;&lt;: *basic cpu: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">large</span></span>: &lt;&lt;: *basic cpu: <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre><br>  Or, if you rewrite it even shorter, using JSON, you can get a beautiful label: <br><br><pre> <code class="hljs pgsql">inheritance: _basic: &amp;basic cpu: <span class="hljs-number"><span class="hljs-number">2</span></span> ram: <span class="hljs-number"><span class="hljs-number">2</span></span> disk: <span class="hljs-number"><span class="hljs-number">10</span></span> os: rhel6 vm-profiles: small: {&lt;&lt;: *basic, cpu: <span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">large</span></span>: {&lt;&lt;: *basic, cpu: <span class="hljs-number"><span class="hljs-number">4</span></span>}</code> </pre><br><h5>  Links </h5><br>  In the previous example, we looked at inheritance, and you probably noticed the elements &amp; and *.  These elements allow you to define a link to an element and then use it. <br><br><pre> <code class="hljs mel">references: value1: &amp;<span class="hljs-keyword"><span class="hljs-keyword">reference</span></span> <span class="hljs-string"><span class="hljs-string">"Don't repeat yourself!"</span></span> value2: *<span class="hljs-keyword"><span class="hljs-keyword">reference</span></span></code> </pre><br><h2>  Check </h2><br>  Well, and finally, one-liner for checking YAML files: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># requires PyYAML alias yaml2json='python -c "import sys,yaml,json;sys.tracebacklimit=0;print(json.dumps(yaml.load(open(sys.argv[1]).read()), indent=2))"'</span></span></code> </pre><br><h2>  Read </h2><br>  <a href="http://yaml.org/spec/1.2/spec.html">YAML 1.2 format specification</a> <br>  <a href="http://www.yaml.org/YAML_for_ruby.html">Yaml Cookbook for Ruby</a> <br><br>  And may <a href="https://en.wikipedia.org/wiki/KISS_principle">KISS</a> and <a href="https://ru.wikipedia.org/wiki/Don%25E2%2580%2599t_repeat_yourself">DRY</a> be with you. <br><br>  UPD <br>  I would be glad to see in the comments your examples of interesting use of YAML. </div><p>Source: <a href="https://habr.com/ru/post/270097/">https://habr.com/ru/post/270097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270087/index.html">How do we equip an alternative to 1C</a></li>
<li><a href="../270089/index.html">Is IT infrastructure a black Pandora's box?</a></li>
<li><a href="../270091/index.html">Errors and problems of the Big Three servers: part one. Dell</a></li>
<li><a href="../270093/index.html">Using RxJs to bind application components</a></li>
<li><a href="../270095/index.html">We invite to the webinars for beginners Android programmers on Delphi</a></li>
<li><a href="../270099/index.html">Does C # need a ‚Äústate‚Äù?</a></li>
<li><a href="../270101/index.html">Iron's little strange browser bug</a></li>
<li><a href="../270103/index.html">CSS modules</a></li>
<li><a href="../270105/index.html">Help #tceh improve UX and get a discount on the course</a></li>
<li><a href="../270109/index.html">Understandable and simple about web components and Polymer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>