<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ANOVA, or who comments?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the comments, the thought was slipping that people did not comment much on articles on Habrahabr, because afraid to lose karma. It turns out that b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ANOVA, or who comments?</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/006/4c0/1bb/0064c01bbaea4e3f967b74f74833d315.png"></div><br>  In the comments, the thought was slipping that people did not comment much on articles on Habrahabr, because  afraid to lose karma.  It turns out that basically those who have more karma write.  We will try to investigate this hypothesis in more detail and obtain results supported not only intuitively, but also <a href="https://xkcd.com/882/">statistically</a> . <br><a name="habracut"></a><br>  We need to check whether the user's karma has a <a href="https://en.wikipedia.org/wiki/Statistical_significance">statistically significant</a> effect on the number of comments that he leaves on average.  Since  the number of compared groups will be more than two, then the <a href="https://en.wikipedia.org/wiki/Student%27s_t-test">t-test</a> will not work, and it will be necessary to use <a href="https://en.wikipedia.org/wiki/Analysis_of_variance">analysis of variance</a> - this is what ANOVA (analysis of variance) stands for. <br><br>  I will use the data previously collected by <a href="https://habrahabr.ru/users/varagian/" class="user_link">varagian</a> and posted <a href="https://github.com/SergeyParamonov/HabraData">here</a> : <br><br><pre><code class="hljs pgsql">user_data &lt;- <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>.csv(<span class="hljs-string"><span class="hljs-string">'user_dataset.csv'</span></span>, stringsAsFactors=F, na.strings=c("", "NA"))</code> </pre> <br>  For <b><a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B8%25D1%2581%25D0%25BF%25D0%25B5%25D1%2580%25D1%2581%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7">single factor analysis of variance,</a></b> two variables will be needed: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  The dependent variable, which in this case is the number of comments left by the user.  Its histogram looks like this: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/e82/539/2f2/e825392f2a9d4de9b8d7d0cf975392d9.png"></div><br>  And such a distribution is not the best for analysis of variance, since  for it, certain prerequisites must be fulfilled, such as, for example, the normality of the dependent variable.  Fortunately, in this case, the variable can be ‚Äúmade‚Äù almost normal by using its log transformation: <br><br><pre> <code class="hljs lisp">comments_log &lt;- log1p(<span class="hljs-name"><span class="hljs-name">user_data</span></span>$comments)</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/files/690/605/e17/690605e175334a04bc217d1cc62039ab.png"></div><br></li><li>  A factor variable whose effect on the dependent variable is being investigated.  Look at the distribution of karma: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>(user_data$karma) Min. <span class="hljs-number"><span class="hljs-number">1</span></span>st Qu. Median Mean <span class="hljs-number"><span class="hljs-number">3</span></span>rd Qu. Max. <span class="hljs-number"><span class="hljs-number">0.00</span></span> <span class="hljs-number"><span class="hljs-number">0.00</span></span> <span class="hljs-number"><span class="hljs-number">5.00</span></span> <span class="hljs-number"><span class="hljs-number">17.92</span></span> <span class="hljs-number"><span class="hljs-number">18.00</span></span> <span class="hljs-number"><span class="hljs-number">1230.00</span></span></code> </pre><br>  To group the data, we introduce a new variable, which will be an interval ‚Äúslice‚Äù of karma and play the role of a factor variable: <br><br><pre> <code class="hljs lisp">karma_cut &lt;- cut(<span class="hljs-name"><span class="hljs-name">user_data</span></span>$karma, breaks=c(<span class="hljs-name"><span class="hljs-name">-Inf</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, Inf)) table(<span class="hljs-name"><span class="hljs-name">karma_cut</span></span>) (<span class="hljs-name"><span class="hljs-name">-Inf</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>] (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>] (<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>] (<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>] (<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">50</span></span>] (<span class="hljs-number"><span class="hljs-number">50</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>] (<span class="hljs-number"><span class="hljs-number">100</span></span>, Inf] <span class="hljs-number"><span class="hljs-number">5488</span></span> <span class="hljs-number"><span class="hljs-number">2059</span></span> <span class="hljs-number"><span class="hljs-number">2955</span></span> <span class="hljs-number"><span class="hljs-number">1423</span></span> <span class="hljs-number"><span class="hljs-number">1411</span></span> <span class="hljs-number"><span class="hljs-number">859</span></span> <span class="hljs-number"><span class="hljs-number">480</span></span></code> </pre><br>  The largest group is users with a karma less than or equal to 0. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Nota bene!</b> <div class="spoiler_text">  Here I must say a few words about the conversion of a continuous variable into a categorical.  This practice is widespread in sociological, psychological and biomedical research: for example, the amount of blood pressure can be conditionally defined as low, normal, high.  But in general, from a statistical point of view, this procedure is somewhat flawed, since  any partitioning is very conditional, potentially leading to loss of information. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/447/4d3/fbf/4474d3fbf11d423fbf09343a479affc6.png"></div><br>  As for the ‚Äúnumber of comments‚Äù ~ ‚Äúkarma‚Äù dependence, there is a slight positive correlation, and the linear regression, performed on the basis of these two numerical indicators (see above), being significant, looks unconvincing, so that statistical findings: for example, <a href="https://en.wikipedia.org/wiki/Ramsey_RESET_test">Ramsey‚Äôs RESET test</a> signals missing variables, and <a href="https://en.wikipedia.org/wiki/Breusch%25E2%2580%2593Pagan_test">Broish ‚Äì Pagan‚Äôs test</a> indicates <a href="https://en.wikipedia.org/wiki/Heteroscedasticity">heteroskedasticity of</a> random errors.  In addition, I set the task in advance to compare groups of users whose karma is perceived as ‚Äúsmall‚Äù, ‚Äúmedium‚Äù, etc. <br></div></div><br>  Here is how medians are distributed depending on the interval in which the user's karma falls: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0b9/8fb/b97/0b98fbb973294511af588e91476e6337.png"></div><br>  It can already be observed that with the growth of karma, the median of the number of comments that the user leaves also grows.  Considering the above, our null hypothesis for analysis of variance can be formulated as follows: karma has no effect on the logarithm of the number of comments left by the user, and the observed differences between the group averages are insignificant and random: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/191/23b/db3/19123bdb365d406d8258124a1c9944c7.png"></div><br>  An alternative hypothesis, respectively, argues that the differences are not accidental.  To accept or reject the null hypothesis, we need to compare the intergroup VAR <sub>b</sub> and the intragroup VAR <sub>w</sub> dispersion.  Both of these quantities estimate the dispersion of the general population in their own way, and with a valid null hypothesis, their ratio is close to 1, i.e  intragroup and intergroup dispersions do not differ.  The formulas for calculating these variances are given below: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/e50/ed2/ca1/e50ed2ca16904e0d99ee2ab00fa11b4e.png"></div><br>  Here K is the number of groups, N is the total sample size.  Now we need to evaluate the ratio <br><div style="text-align:center;"><img src="https://habrastorage.org/files/2c4/d2e/101/2c4d2e1011364fa9b49db514828dca8f.png"></div><br>  In this context, it is customary to say that the value of F follows an <a href="https://en.wikipedia.org/wiki/F-distribution">F-distribution</a> with degrees of freedom K-1 and NK.  A small piece of code on R that computes the statistics F <sub>test</sub> and the critical value F <sub>crit</sub> at a level of significance Œ± = 5%: <br><br><pre> <code class="hljs lisp">alpha &lt;- <span class="hljs-number"><span class="hljs-number">0.05</span></span> K &lt;- length(<span class="hljs-name"><span class="hljs-name">levels</span></span>(<span class="hljs-name"><span class="hljs-name">karma_cut</span></span>)) N &lt;- nrow(<span class="hljs-name"><span class="hljs-name">user_data</span></span>) df1 &lt;- K - <span class="hljs-number"><span class="hljs-number">1</span></span> df2 &lt;- N - K M &lt;- mean(<span class="hljs-name"><span class="hljs-name">comments_log</span></span>) var_b &lt;- sum(<span class="hljs-name"><span class="hljs-name">tapply</span></span>(<span class="hljs-name"><span class="hljs-name">comments_log</span></span>, karma_cut, function(<span class="hljs-name"><span class="hljs-name">x</span></span>){ length(<span class="hljs-name"><span class="hljs-name">x</span></span>) * (mean(x) - M) ^ 2})) / df1 var_w &lt;- sum(tapply(comments_log,karma_cut, function(x){ sum((x - mean(x))^2)})) / df2 Ftest &lt;- var_b / var_w Fcrit &lt;- qf(alpha, df1, df2, lower.tail=F)</code> </pre><br>  The graph below shows the distribution <i>F</i> (6, 14668), the critical and calculated statistics values: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ea5/5fc/0c2/ea55fc0c22fa42298f96ce6c11e02836.png"></div><br>  Obviously, F <sub>crit</sub> &lt;&lt; F <sub>test</sub> , which means that the hypothesis H <sub>0</sub> can be rejected.  In R, of course, all of the above has long been implemented, so just check the calculation: <br><br><pre> <code class="hljs 1c">m.aov &lt;- aov(comments_log <span class="hljs-symbol"><span class="hljs-symbol">~ karma_cut) summary(m.aov) Df Sum Sq Mean Sq F value Pr(&gt;F) karma_cut 6 5519 919.9 556.2 &lt;2e-16 *** Residuals 14668 24260 1.7 --- Signif. codes</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> '***' <span class="hljs-number"><span class="hljs-number">0.001</span></span> '**' <span class="hljs-number"><span class="hljs-number">0.01</span></span> '*' <span class="hljs-number"><span class="hljs-number">0.05</span></span> '.' <span class="hljs-number"><span class="hljs-number">0.1</span></span> ' ' <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  The value of F-statistics is 556.2, which coincides with the previously calculated. <br><br><h2>  Post hoc </h2><br>  Calculations show that the hypothesis H <sub>0</sub> about equality of averages should be rejected (this is the only thing we can say by running ANOVA).  What to do with this conclusion next?  Usually, <a href="https://en.wikipedia.org/wiki/Post_hoc_analysis">post-hoc analysis is</a> performed after ANOVA: you can use the t-test with the <a href="https://en.wikipedia.org/wiki/Bonferroni_correction">Bonferroni correction</a> (in <a href="https://www.r-project.org/">R</a> it's <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/pairwise.t.test.html">pairwise.t.test</a> ) or, for example, <a href="https://en.wikipedia.org/wiki/Tukey%27s_range_test">Tukey's HSD test</a> to find out between which groups there are differences.  I like the last test more: <br><br><pre> <code class="hljs erlang">TukeyHSD(m.aov, <span class="hljs-string"><span class="hljs-string">"karma_cut"</span></span>, conf.level=<span class="hljs-number"><span class="hljs-number">0.95</span></span>) Tukey multiple comparisons <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> means <span class="hljs-number"><span class="hljs-number">95</span></span><span class="hljs-comment"><span class="hljs-comment">% family-wise confidence level Fit: aov(formula = comments_log ~ karma_cut) $karma_cut diff lwr upr p adj (0,5]-(-Inf,0] -0.08189943 -0.17990408 0.01610521 0.1725558 (5,15]-(-Inf,0] 0.29578008 0.20925195 0.38230821 0.0000000 (15,25]-(-Inf,0] 0.92766799 0.81485590 1.04048009 0.0000000 (25,50]-(-Inf,0] 1.36762030 1.25442791 1.48081269 0.0000000 (50,100]-(-Inf,0] 1.66955943 1.53041195 1.80870691 0.0000000 (100, Inf]-(-Inf,0] 1.87283311 1.69233134 2.05333488 0.0000000 (5,15]-(0,5] 0.37767952 0.26881660 0.48654243 0.0000000 (15,25]-(0,5] 1.00956743 0.87883646 1.14029840 0.0000000 (25,50]-(0,5] 1.44951973 1.31846045 1.58057902 0.0000000 (50,100]-(0,5] 1.75145887 1.59742628 1.90549145 0.0000000 (100, Inf]-(0,5] 1.95473255 1.76252197 2.14694313 0.0000000 (15,25]-(5,15] 0.63188791 0.50952455 0.75425128 0.0000000 (25,50]-(5,15] 1.07184022 0.94912615 1.19455428 0.0000000 (50,100]-(5,15] 1.37377935 1.22678192 1.52077678 0.0000000 (100, Inf]-(5,15] 1.57705303 1.39043280 1.76367327 0.0000000 (25,50]-(15,25] 0.43995231 0.29748058 0.58242403 0.0000000 (50,100]-(15,25] 0.74189144 0.57803877 0.90574410 0.0000000 (100, Inf]-(15,25] 0.94516512 0.74499878 1.14533146 0.0000000 (50,100]-(25,50] 0.30193913 0.13782440 0.46605386 0.0000012 (100, Inf]-(25,50] 0.50521281 0.30483189 0.70559373 0.0000000 (100, Inf]-(50,100] 0.20327368 -0.01283281 0.41938017 0.0811265</span></span></code> </pre><br>  It can be preliminarily concluded that users with karma (-‚àû, 0] and (0, 5] leave approximately the same log number of comments, as do users with karma (50,100] and (100, ‚àû]. The other groups differ significantly). <br><br><h2>  What's wrong? </h2><br>  We could stop at this, but there are a few comments in addition to what is under the spoiler above.  First of all, you should pay attention to our "normalized" variable comments_log: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/30e/4cf/9f3/30e4cf9f385840b68ed85a811150a00d.png"></div><br>  On closer examination, it turns out to be very far from the normal distribution, as the <a href="https://en.wikipedia.org/wiki/Shapiro%25E2%2580%2593Wilk_test">Shapiro-Wilk</a> test hints at.  Another criterion - the <a href="https://en.wikipedia.org/wiki/Bartlett%27s_test">Bartlett test</a> - indicates that the variance in groups is heterogeneous: <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">bartlett</span></span>.test(comments_log~karma_cut) <span class="hljs-type"><span class="hljs-type">Bartlett</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> homogeneity <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> variances <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">: comments_log by karma_cut </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bartlett's</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">K</span></span></span><span class="hljs-class">-squared = 84.811, df = 6, p-value = 3.613e-16</span></span></code> </pre><br>  On the one hand, there is a violation of the prerequisites of ANOVA, on the other hand, there are a number of papers that say that <a href="https://en.wikipedia.org/wiki/F-test">analysis of variance is very resistant</a> to the violation of the normality condition and the dispersion heterogeneity.  If the violation of conditions is still constrained by someone, then you can use the non-parametric <a href="https://en.wikipedia.org/wiki/Kruskal%25E2%2580%2593Wallis_one-way_analysis_of_variance">Kruskal-Wallis</a> test.  Here, the null hypothesis is the assumption of equality of the medians (and not the mean!) In all groups: <br><br><pre> <code class="hljs cs">kruskal.test(comments_log ~ karma_cut) Kruskal-Wallis rank sum test data: comments_log <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> karma_cut Kruskal-Wallis chi-squared = <span class="hljs-number"><span class="hljs-number">2816.1</span></span>, df = <span class="hljs-number"><span class="hljs-number">6</span></span>, p-<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &lt; <span class="hljs-number"><span class="hljs-number">2.2e-16</span></span></code> </pre><br>  The Kruskal-Wallis test also allows you to reject the null hypothesis.  Since  the Kruskal-Wallis test is non-parametric, then the post-hoc analysis must also be based on non-parametric tests, such as, for example, <a href="https://en.wikipedia.org/wiki/Mann%25E2%2580%2593Whitney_U_test">the Mann-Whitney U-test</a> with the subsequent correction of p-values, the Dunn test.  The latter is contained in the R <a href="https://cran.r-project.org/web/packages/dunn.test/dunn.test.pdf">dunn.test</a> package: <br><br><pre> <code class="hljs cmake">dunn.<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>::dunn.<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>(comments_log, karma_cut, method=<span class="hljs-string"><span class="hljs-string">"bonferroni"</span></span>)</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dae/848/a44/dae848a44236403382397ba17ac70e5a.png"></div><br>  At the 5% level of significance, like the Tukey test, Dunn's criterion says that users with karma (-‚àû, 0] and (0, 5], and (50,100] and (100, ‚àû]. Leave approximately the same log- number of comments. <br><br><h2>  ANOVA and linear regression </h2><br>  Speaking of analysis of variance, it is impossible not to mention the linear regression.  Moreover, it can be argued that this is practically the same thing, since  The analysis of variance model is a special case of linear regression.  We write the linear regression with the factor variable and check its coefficients: <br><br><pre> <code class="hljs cs">m.lm &lt;- lm(comments_log ~ karma_cut<span class="hljs-number"><span class="hljs-number">-1</span></span>) summary(m.lm) Coefficients: Estimate Std. <span class="hljs-function"><span class="hljs-function">Error t </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">value</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Pr</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">&gt;|t|</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">karma_cut</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">-Inf,</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">] </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3.20288</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.01736</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">184.50</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2e-16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *** karma_cut(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">] </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3.12098</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.02834</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">110.12</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2e-16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *** karma_cut(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">15</span></span></span></span><span class="hljs-function"><span class="hljs-params">] </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3.49866</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.02366</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">147.88</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2e-16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *** karma_cut(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">15</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">25</span></span></span></span><span class="hljs-function"><span class="hljs-params">] </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4.13055</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.03409</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">121.16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2e-16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *** karma_cut(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">25</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">50</span></span></span></span><span class="hljs-function"><span class="hljs-params">] </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4.57050</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.03424</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">133.50</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2e-16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *** karma_cut(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">50</span></span></span></span><span class="hljs-function"><span class="hljs-params">,</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">100</span></span></span></span><span class="hljs-function"><span class="hljs-params">] </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4.87244</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.04388</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">111.04</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2e-16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *** karma_cut(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">100</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Inf] </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5.07571</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.05870</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">86.47</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &lt;</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2e-16</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *** --- Signif. codes: </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'***'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.001</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'**'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.01</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'*'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.05</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'.'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.1</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">' '</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Residual standard error: </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.286</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">on</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">14668</span></span></span></span><span class="hljs-function"><span class="hljs-params"> degrees of freedom Multiple R-squared: </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.8914</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Adjusted R-squared: </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.8913</span></span></span></span><span class="hljs-function"><span class="hljs-params"> F-statistic: </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1.719e+04</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">on</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">7</span></span></span></span><span class="hljs-function"><span class="hljs-params"> and </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">14668</span></span></span></span><span class="hljs-function"><span class="hljs-params"> DF, p-</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span><span class="hljs-function"><span class="hljs-params">: &lt; </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2.2e-16</span></span></span></span></span></span></code> </pre><br>  Now we find the average number of log comments for each karmic slice: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">tapply</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">comments_log</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">karma_cut</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">mean</span></span>) (<span class="hljs-selector-tag"><span class="hljs-selector-tag">-Inf</span></span>,0] (0,5] (5,15] (15,25] (25,50] (50,100] (100, <span class="hljs-selector-tag"><span class="hljs-selector-tag">Inf</span></span>] 3<span class="hljs-selector-class"><span class="hljs-selector-class">.202879</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.120979</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.498659</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.130547</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.570499</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.872438</span></span> 5<span class="hljs-selector-class"><span class="hljs-selector-class">.075712</span></span></code> </pre><br>  The coefficients in linear regression are the mean values, i.e.  the following formula is valid: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9ce/5f3/7a8/9ce5f37a80f04869bf320b253ae75231.png"></div><br>  where Œº <sub>i</sub> is the average of the corresponding group, Œµ <sub>ij</sub> is a random error distributed normally. <br><br><h2>  Conclusion </h2><br>  So, the variance analysis is performed according to the following scheme: <br><br><ol><li>  The dependent and factor variables are determined. </li><li>  Prerequisites for ANOVA are checked. </li><li>  With a normal dependent variable and homogeneous dispersion, ANOVA is performed; otherwise, the non-parametric Kruskal-Wallis test </li><li>  After analyzing the variance and rejecting the null hypothesis, the appropriate post-hoc analysis is performed - parametric or non-parametric. </li></ol><br>  In the <a href="https://en.wikipedia.org/wiki/Analysis_of_variance">multivariate analysis of dispersions</a> , the <a href="https://en.wikipedia.org/wiki/F-test">F-test</a> is also used, but the formulas for calculating the variance are complicated;  in addition, there are additional terms that describe the interaction between factors, and several null hypotheses appear. <br><br>  As for the comments on Habr√©, both ANOVA and the Kruskal-Wallis test say that there is a relationship between the log number of comments and the user's karma, with groups with karma (-‚àû, 0] and (0, 5], and (50,100] and (100, ‚àû] leave approximately the same number of comments. In general, as the karma itself grows, the number of comments increases. Interestingly, the results of both non-parametric and parametric tests coincided, although the prerequisites for the latter were clearly violated. This fact can be explained robustness analysis of variance  a, and the fact that with a large amount of data (we have thousands of measurements), the violation of the assumption that the data is normal has a much smaller effect on the result than in the case of a small sample. </div><p>Source: <a href="https://habr.com/ru/post/304528/">https://habr.com/ru/post/304528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304514/index.html">Root - a robot that helps children learn programming</a></li>
<li><a href="../304516/index.html">What is AXON</a></li>
<li><a href="../304518/index.html">How HTTP / 2 will make the web faster</a></li>
<li><a href="../304520/index.html">Four ways to extract values ‚Äã‚Äãfrom hidden fields in C #</a></li>
<li><a href="../304524/index.html">IBM Watson takes you to Wimbledon</a></li>
<li><a href="../304530/index.html">Writing a text game in Python / Ren'Py Part 2: mini-games and pitfalls</a></li>
<li><a href="../304532/index.html">Critical vulnerability of Symantec Endpoint antivirus allows remote code execution</a></li>
<li><a href="../304534/index.html">Drum machine on the neural network</a></li>
<li><a href="../304536/index.html">Process management. Do not exceed RPS API limit (QPS)</a></li>
<li><a href="../304538/index.html">Fintech: why are programmers waiting here</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>