<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Anatomy of ransomware for Android, part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Extortionists (ransomware) are a special type of malware for mobile devices, the number of which is constantly growing. The extortionists can be divid...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Anatomy of ransomware for Android, part 1</h1><div class="post__text post__text-html js-mediator-article">  Extortionists (ransomware) are a special type of malware for mobile devices, the number of which is constantly growing.  The extortionists can be divided into two large groups: the former specialize in locking the screen of the user's device (lock-screen ransomware), and the latter encrypt data on it (crypto-ransomware).  For several years of their activity, both of these types have already led to significant financial losses for users, as well as the loss of their personal data. <br><br><img src="https://habrastorage.org/files/fe1/f60/2c5/fe1f602c5333486d889dcf88aa478899.jpg"><br><br>  Like other types of malware for Android, such as SMS Trojans, for example, extortionists have evolved significantly over the past few years, while VX authors have adapted many malicious techniques that have proven effective in similar malware for desktop systems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  <b>General information</b> <br><br>  Extortionists for both Windows and Android use the theme of ‚Äúpolice ransomware‚Äù (police ransomware) as the theme for the lock screen.  This topic is quite effective, as the attackers use the user's guilt feeling, accusing him of viewing or storing illegal content on the device.  Mobile extortionists have similar features with the infamous family of such malicious programs for Windows as Cryptolocker, for example, they use strong cryptographic algorithms to encrypt files in such a way that the user does not have a way to restore access to encrypted files.  Since the user stores a much larger amount of personal data on a smartphone, the risk of losing a significant amount of user data increases significantly. <br><br>  One of the interesting observations that we managed to do was to change the geographical orientation of the attackers from Eastern European countries to other countries.  For example, the vast majority of ransomware victims of the <b>Android / Simplocker</b> and <b>Android / Lockerpin families</b> are located in the USA. <br><br>  Both of the aforementioned types of ransomware were a very common problem for Windows users since 2013, when the popularity of these malicious programs among cybercriminals began to increase significantly, despite the fact that they were distributed much earlier.  Infection extortionists brought serious trouble for both ordinary users and corporate users. <br><br><img src="https://habrastorage.org/files/e56/36b/6b4/e5636b6b4078425e89178ab439a5b2d4.png"><br>  Fig.  Statistics of ransomware for Android according to ESET LiveGrid. <br><br>  The use of ransomware by the attackers specifically for Android is not an accident.  Since the number of smartphones on this OS is growing from year to year, users are increasingly choosing them to store personal and valuable data.  Accordingly, such a business will bring them the maximum amount of benefits. <br><br>  <b>Possible vectors of infection</b> <br><br>  Attackers use the same disguise for extortionists Android, as well as for other malicious programs, which is that the user is convinced of the legitimacy of the application.  Various popular applications, such as games, as well as porn-related applications, are often chosen as a cover and to increase the likelihood of a potential victim being compromised.  In some cases, malicious APK files are provided with an icon and the name of a legitimate application.  Another scenario involves the direct use by the attackers of a legitimate application into which the malicious code is inserted, while the original functions of the application are preserved.  The behavior of the malicious program may be imperceptible to the user of the device, this happens when the authors do not rely on the screen lock mechanism or file encryption, as is the case with backdoors or SMS trojans.  It should be noted that such a change in a legitimate application will lead to its violation of the integrity and inconsistency of the data specified in the digital signature. <br><br>  It should be noted that none of the ransomware described by us was found in the Google Play app store.  However, there are cases of successful crawling by malware of constantly improving Google security measures for the Play Store.  Our analysts found and sent to Google hundreds of examples of malware for Android, including such malicious software as Fake AV, spyware with credential theft functions, click-click trojans, backdoors, potentially unwanted applications (PUA) with advertisements, and other PUA- applications and others.  Virus writers also use special methods of infecting the device in such a way as to postpone the actual payload by using loaders (downloaders), as well as droppers.  On the other hand, the use of such advanced techniques as the automatic installation of drive-by download malware is not common in Android. <br><br>  <b>Interaction with the C &amp; C Server Manager</b> <br><br>  After successful installation on the system, most of the malware for Android reports this to "home", i.e., to a remote C &amp; C server.  Typically, this sent message includes some basic information about the device, such as the device model, IMEI number, language used, etc. If a permanent connection is established between the C &amp; C server and the bot, the attacker can send him commands to execute .  Thus, the attacker can control the botnet of devices running Android. <br><br>  Some examples of remote commands that support extortionists for Android are listed below: <br><ul><li>  open the required URL in a web browser; </li><li>  send an SMS message to all contacts; </li><li>  lock or unlock the device; </li><li>  send SMS messages from the device to attackers; </li><li>  send the attackers contact information to the victim; </li><li>  select the desired text message with a ransom request; </li><li>  upgrade to the new version; </li><li>  enable or disable storage of data on the device; </li><li>  enable or disable Wi-Fi connection; </li><li>  Track the user's geographic location using GPS. </li></ul><br>  Typically, the HTTP protocol is used to communicate with the remote server, but in some cases we also observed using a public service such as Google Cloud Messaging to interact with C &amp; C.  This service allows Android applications on smartphones to share data.  Baidu Cloud Push is also used for malicious purposes.  Some of the malware samples that we analyzed used the anonymous Tor service (.onion domains) and the XMPP protocol (jabber).  Trojans for Android can receive commands and send data remotely using SMS messages. <br><br>  <b>Self defense methods</b> <br><br>  The task of infecting a user's device running Android with a malicious program is not a trivial task for attackers.  Even for users without an established anti-virus solution, such as <a href="https://www.esetnod32.ru/home/products/mobile-security/android/">ESET Mobile Security</a> , there are mechanisms to protect against the malware of the OS itself.  After the attackers bypass the defense mechanisms, they are interested in the malware remaining there as long as possible. <br><br>  We observed the use by Android malware of various self-defense mechanisms that prevented disruption or removal from the system.  For example, the extortioner <b>Android / Lockerpin</b> could freelance complete the process of antivirus solutions.  One of the most universal methods that we observe in using virus writers, and more and more, is obtaining Device Administrator privileges.  Despite the fact that this mode of operation is not as dangerous as obtaining root rights, it still provides attackers with extended privileges after being acquired on the device. <br><br><img src="https://habrastorage.org/files/5ba/21f/4a7/5ba21f4a7eb64803812210bd016f2a7d.png"><br>  Fig.  Examples of malware for Android that requests administrator rights in the system. <br><br>  Legitimate applications with device administrator privileges use such extended permissions in the OS for various purposes, which are usually related to security.  Malicious applications, in contrast, use them to protect themselves from being removed from the system.  Before removing such an application from Android, its Administrator rights must be revoked.  Some malicious programs, such as <b>Android / Lockerpin</b> , use their privileges to set or change the PIN of the lock screen. <br><br><img src="https://habrastorage.org/files/8e5/ccd/d26/8e5ccdd2615b4faa8855ede46d813a1c.png"><br>  Fig.  Chronology of the appearance of ransomware for Android. <br><br>  The first cases of the appearance of ransomware for Android were accompanied by the addition of malicious functions to fake antivirus programs.  Such fake antiviruses have been distributed for a long time, starting in 2012 for Android and since 2004 for computers.  As the name implies, such programs show the user fake messages about scanning files on the device, and then try to deceive him by displaying a message demanding payment for further anti-virus actions to neutralize the threat.  These programs are also called ‚Äúscareware‚Äù because they extort money from the victim after being intimidated by the presence of an active infection of the device. <br><br>  Most ransomware with a screen lock feature for Windows use the theme of law enforcement (police ransomware) when intimidating a user.  The attackers began using a similar method in extortionists and for Android.  This type of extortionists significantly increases the possibility of successfully extorting money from the user, since the victim is addressed on behalf of law enforcement agencies, and they are informed that illegal actions were detected on the device. <br><br>  The first version of the extortionist cryptographer for Android was a family of malware called <a href="https://habrahabr.ru/company/eset/blog/225331/">Simplocker</a> in May 2014. For the past three years, extortionists for Android have continued their development, during which time several new families of this malware have been discovered. <br><br>  <b>Android Defender</b> <br><br>  This malware was first detected in mid-2013 and is an example of a fake antivirus for Android, as well as, in fact, the first extortionist for Android.  As can be seen in the figure below, the user interface of the malicious application attempts to imitate its legitimate counterpart.  Malefactors provide such function for belief of the user in legitimacy of an antivirus.  It is interesting to note that during a fake scan of files on a disk, the trojan displays the names of files actually present on the memory card, which makes this process even more plausible in the eyes of the user.  The names of the malware families are also indicated as existing, however, they have nothing to do with the user's device. <br><br><img src="https://habrastorage.org/files/09e/98b/1af/09e98b1af20a4b8ea2bd28ba38ae41e9.png"><br><img src="https://habrastorage.org/files/e5d/5c1/eb9/e5d5c1eb9daa4a6ea1d1707005fdc7f1.png"><br>  Fig.  The appearance of a fake antivirus Android Defender (Fake AV). <br><br>  At this stage, the user still has access to the setting called ‚Äúcontinuing unprotected‚Äù, and can also close the application.  However, running an auxiliary OS service, which belongs to a fake antivirus, makes the smartphone almost unusable, constantly displaying special warning windows every time a user tries to launch an application.  By selecting the ‚ÄúStay unprotected‚Äù setting, the user will only save himself from the current pop-up window, while immediately receiving a new one. <br><br><img src="https://habrastorage.org/files/2c9/f7d/9fb/2c9f7d9fb4834530852bc66ac76ecd9b.png"><br>  Fig.  The message fixed by malicious program deprives the user of possibility of normal work with the device. <br><br>  In the event that the smartphone owner gives in to the trick of the intruders and decides to pay the required amount to upgrade to the ‚Äúfull version of the antivirus‚Äù, his disappointments do not end there.  Six hours after its launch in the system, the malware will display a window with pornographic pictures on the entire screen of the device, which cannot be closed. <br><br><img src="https://habrastorage.org/files/14a/968/fee/14a968fee27a46a5b5ddf0a57d8d18c3.png"><br>  Fig.  Android Defender lock screen with porn picture. <br><br>  When paying, the owner of the smartphone also leaves the attackers with their credit card information, which can be used to conduct fraudulent transactions.  As indicated in the screenshot, scammers offer the user a discount, reducing the amount to $ 89.99. <br><br>  Antivirus product ESET Mobile Security detects Android Defender as <b>Android / FakeAV.B</b> . <br><br>  <b>Extortionist with fake anti-virus and porn features</b> <br><br>  Another type of extortionist in the form of a fake antivirus does not copy the interface of the Android Defender product, but the name of the legitimate Avast security application.  This is a malicious program that is detected by ESET antivirus products like <a href="http://virusradar.com/en/Android_FakeAV.E/description">Android / FakeAV.E</a> .  She uses the brand of the famous PornHub resource to find her audience among the visitors of this resource. <br><br><img src="https://habrastorage.org/files/878/ab7/470/878ab74705334e9ca46b652759db6483.png"><br>  Fig.  Extortionist disguised as an application for viewing porn. <br><br>  After starting the application, the user receives a message instead of viewing pornographic clips that his device needs to be checked for viruses.  After clicking on the OK button, a fake antivirus that looks like Avast starts a pseudo-scan. <br><br><img src="https://habrastorage.org/files/6df/6c5/cf9/6df6c5cf9c4c45458b101efd9aca95e1.png"><br><img src="https://habrastorage.org/files/1c0/999/fa7/1c0999fa73ca4351807a1d86431181b4.png"><br>  Fig.  Extortionist <b>Android / FakeAV.E</b> disguises itself as a fake Avast antivirus application. <br><br>  The information that fraudsters display to the user is rather strange.  First, the message itself shows that "the device is in danger and has been blocked for security reasons."  Further, it is proposed to purchase an enhanced version of pseudo-security software.  This behavior gives the user the true intentions of the software he received, since the blocking of the device is clearly not consistent with the functions of a legitimate antivirus.  The message screen displayed to the user requires him to pay a fine of $ 100 to avoid possible legal consequences. <br><br><img src="https://habrastorage.org/files/7e3/a00/3f0/7e3a003f0afb49c391017a8b7e44a018.png"><br>  Fig.  Payment redemption for <b>Android / FakeAV.E</b> . <br><br>  We got the impression that the authors of this extortioner copied the text of a message demanding ransom from another malicious program, since the text contains the same grammatical errors. <br><br>  <b>Police Extortionists</b> <br><br>  Extortionists for Windows used various themes to demonstrate as a lock screen.  Some earlier patterns used the blue screen theme of death (BSOD) or the Windows activation message.  We found various topics that the attackers used for the screen lock, however, the most common of these was the topic of law enforcement (police). <br><br>  Such police extortionists claimed that the device was blocked by local law enforcement agencies, as illegal content was found on it, or illegal activities were carried out from the device.  As the text for the lock screen was used, sometimes, taken from the article of the criminal code.  The text also stated that if you pay the appropriate amount, the user is discharged.  This type of ransomware often uses IP-based geolocation to select the desired banner with the law enforcement icon of the desired state. <br><br><img src="https://habrastorage.org/files/799/c2f/c00/799c2fc008914111a33faf04ac17db5a.png"><br>  Fig.  The first police extortionist was aimed at Russian-speaking Android users. <br><br>  The first copies of police extortionists for Android appeared in the first half of 2014 and were directed against Russian-speaking users.  Shortly thereafter, variants in English were discovered. <br><br><img src="https://habrastorage.org/files/d6e/e28/a3c/d6ee28a3c7494776ae942a77eac84e8c.png"><br><img src="https://habrastorage.org/files/c1c/b92/9bf/c1cb929bf0344da58900e354c81afae6.png"><br>  Fig.  The extortioner Android / Locker uses camera images and geolocation to intimidate the user, with examples of lock screens for Russia, Ukraine, and Kazakhstan. <br><br><img src="https://habrastorage.org/files/80f/3e2/1a2/80f3e21a20304128b3c1be519d3c240a.png"><br><img src="https://habrastorage.org/files/2ad/286/c8c/2ad286c8ce314c1f90ff0e1b5dbbabc7.png"><br>  Fig.  Extortionist Android / Koler switched to compromising English-speaking users. <br><br>  ESET antivirus products detect instances of the above ransomware like <a href="http://virusradar.com/en/Android_Koler/detail">Android / Koler</a> and <a href="http://virusradar.com/en/Android_Locker/detail">Android / Locker</a> . </div><p>Source: <a href="https://habr.com/ru/post/277747/">https://habr.com/ru/post/277747/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277733/index.html">The history of one configuration "umbrella"</a></li>
<li><a href="../277737/index.html">Lazy list in C ++</a></li>
<li><a href="../277739/index.html">Zabbix 3.0: Encryption</a></li>
<li><a href="../277741/index.html">Backup and transfer of data in the browser Vivaldi</a></li>
<li><a href="../277743/index.html">IP PBX Askozia and Push Notifications in Telegram</a></li>
<li><a href="../277751/index.html">How our techies in the army served</a></li>
<li><a href="../277753/index.html">How to color the Chrome tab</a></li>
<li><a href="../277757/index.html">Convenient conversion of enumerations (enum) to string in C ++</a></li>
<li><a href="../277759/index.html">Segmentation Fault (computer memory allocation)</a></li>
<li><a href="../277761/index.html">The digest of interesting materials for the mobile # 141 developer (February 15-23)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>