<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Running Terminal Server for 1C Applications on Synology NAS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More recently, DS412 + NAS from Synology has come into our hands. If you believe the words from the manufacturer's website, it is designed for small a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Running Terminal Server for 1C Applications on Synology NAS</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4a8/2fc/284/4a82fc28413b4a03afd0c4a0d12ec92e.jpg"><br><br>  More recently, DS412 + NAS from Synology has come into our hands.  If you believe the words from the manufacturer's website, it is <i>designed for small and medium businesses that require high performance, ease of management and a full-featured network storage solution for centralizing data backup, protecting critical information and sharing files between different platforms</i> .  Our customer was interested in using it not only as a drive (for storing the 1C database), but also as a terminal server for working with the 1C platform.  Under the cut, you will find the DS412 + adaptation process itself. <br><a name="habracut"></a><br>  Let's start with a brief description of the characteristics of the device, complete you can find <a href="http://www.synology.su/products/71">here</a> : <br><ul><li>  CPU clock speed - 2.13 GHz (Dual Core) </li><li>  RAM RAM - DDR3 1 GB </li><li>  HDD type and number - 4 3.5 ‚ÄùSATA (II) or 4 2.5‚Äù SATA / SSD disks </li><li>  Type and number of network ports - 2 Gigabit ports </li></ul><br>  We were lucky that the Atom CPU stands at 412m and its architecture allowed us to use pre-compliled 1C packages for the i386 platform, although on the same DS213j there is already MARVELL Armada 370, which, unfortunately, there are no ready-made solutions.  To build the packages, we used a virtual machine running on a working PC.  So let's get started. <br><br>  1. Install the minimum distribution of Debian on a virtual machine; <br>  2. Install on this system debootstrap (from the repository); 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">apt-get install debootstrap</code> </pre> <br>  3. Prepare debootstrap to run on another system.  Since  DS412 + under i686, we specify the architecture.  Put it in the ~ / deboo folder: <br><br><pre> <code class="bash hljs">debootstrap --foreign --arch i386 wheezy deboo</code> </pre><br>  Copy our repositories to the prepared image: <br><br><pre> <code class="bash hljs">cp /etc/apt/sources.list ~/deboo/etc/apt/sources.list</code> </pre><br>  And we pack it in a tarball-file so that it is more convenient to transfer: <br><br><pre> <code class="bash hljs">tar xvzpf synodebian.tar.gz</code> </pre><br>  4. After DiskStation initialization, we turn on the ftp-server, add the share folder via the web interface. <br><br><img src="https://habrastorage.org/files/450/1dc/1d1/4501dc1d137142f883268b11d45ba993.png"><br><br><img src="https://habrastorage.org/files/6be/0ba/d00/6be0bad0088d4c5996e377876f349225.png"><br><br>  We transfer the tarball-file with the system (debootstrap) prepared in the third stage to this folder; <br>  5. In order not to build on a weak DS later, we immediately collect XRDP packets on a virtual machine: <br><br><pre> <code class="bash hljs">apt-get install git git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/scarygliders/X11RDP-o-Matic.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> X11RDP-o-Matic ./X11rdp-o-matic.sh ‚Äìjustdoit</code> </pre><br>  It will take a long time to collect, at the end we pick up ready-made packages from ./X11RDP-o-Matic/packages, put it in the same share share folder on the DS.  There we also copy the service script from ./X11RDP-o-Matic/RDPsesconfig.sh.  The virtual machine is no longer needed, it can be turned off. <br>  6. Connect to DS via SSH.  The system mounts the section in the folder "/ volume1", go to it, to the subfolder share (which is shared by ftp).  Extract the created tarball file to / volume1 / deboo; <br>  7. Transfer the DNS settings and server name: <br><br><pre> <code class="bash hljs">hostname &gt; /volume1/deboo/etc/hostname cp /etc/resolv.conf /volume1/deboo/etc/</code> </pre><br>  8. Unpack all the packages: <br><br><pre> <code class="bash hljs">chroot /volume1/deboo /debootstrap/debootstrap --second-stage</code> </pre><br>  9. Making scripts for mounting / unmounting system folders, allowing them to run: <br><br><pre> <code class="bash hljs">~/deboo-mount.sh: /bin/mount -o <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /dev /volume1/deboo/dev /bin/mount -o <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /proc /volume1/deboo/proc /bin/mount -o <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /dev/pts /volume1/deboo/dev/pts /bin/mount -o <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /sys /volume1/deboo/sys /bin/mount -o <span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /mnt/share /volume1/deboo/share ~/deboo-umount.sh: /bin/umount /volume1/deboo/proc /bin/umount /volume1/deboo/dev/pts /bin/umount /volume1/deboo/dev /bin/umount /volume1/deboo/sys /bin/umount /volume1/deboo/share</code> </pre><br>  10. We mount system folders, and we launch already full-fledged debian: <br><br><pre> <code class="bash hljs">sh ~/deboo-mount chroot /volume1/deboo /bin/bash</code> </pre><br>  11. Everything, now began full-fledged work with debian in bash.  We prepare work with repositories and update packages: <br><br><pre> <code class="bash hljs">apt-get update &amp;&amp; apt-get upgrade</code> </pre><br>  12. Install probably the easiest graphical shell (the Xs are also installed when dependencies are resolved): <br><br><pre> <code class="bash hljs">apt-get install --no-install-recommends lxde</code> </pre><br>  13. Install the XRDP packages collected in the fifth step: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /volume1/share/packages dpkg -i *.deb &amp;&amp; apt-get install -f</code> </pre><br>  14. Add users to the system that will connect to the terminal server, run the RDPsesconfig.sh script, obtained in step 5, which will generate the necessary configuration files for them; <br>  15. Start the XRDP: <br><br><pre> <code class="bash hljs">/etc/init.d/xrdp start</code> </pre><br>  Now you can connect to the terminal server. <br>  16. Download <a href="https://users.v8.1c.ru/distribution/version_files%3Fnick%3DPlatform83%26ver%3D8.3.5.1248">from here</a> client and server packages for DEB-based systems.  Unpack them into one folder and install: <br><br><pre> <code class="bash hljs">dpkg -i *.deb &amp;&amp; apt-get -f install</code> </pre><br>  17. For the platform, additional font packages and imagemagick are needed, put them: <br><br><pre> <code class="bash hljs">apt-get install ttf-mscorefonts-installer imagemagick</code> </pre><br><br>  It is done!  Stayed routine.  In the same shared folder we place the file base 1C (already unpacked demo version of Trade Management).  We connect via RDP to the server under our user, the shell is launched, we add a shortcut to launch Enterprise 1C on the desktop, we launch it.  1C invites you to add a base.  We add existing, we specify in a shared folder in which the base was placed.  Connect in enterprise mode, select user. <br><br>  And a few more words in the end, despite the fact that we still managed to start the terminal server, we consider using this configuration to solve the task inappropriate, due to the high cost and difficulty in preparing the software component. </div><p>Source: <a href="https://habr.com/ru/post/242879/">https://habr.com/ru/post/242879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242863/index.html">PowerShell Web Access: manage servers from a browser</a></li>
<li><a href="../242865/index.html">Installing, configuring and using the rkhunter server vulnerability scanner</a></li>
<li><a href="../242869/index.html">Logger with member functions that do not exist</a></li>
<li><a href="../242875/index.html">FAQ on the conference. NEXT 2014 Moscow</a></li>
<li><a href="../242877/index.html">Go turned 5 years old</a></li>
<li><a href="../242881/index.html">Bestsellers O'Reilly</a></li>
<li><a href="../242883/index.html">What is better for a startup: Vietnam or Thailand?</a></li>
<li><a href="../242885/index.html">For what Google applications blocks. Bylina</a></li>
<li><a href="../242887/index.html">[Translation] The Home Kit Framework - Learn more about Apple's home automation protocol.</a></li>
<li><a href="../242889/index.html">Microsoft has released EMET 5.1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>