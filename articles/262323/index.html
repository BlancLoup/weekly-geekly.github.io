<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Spring without XML. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habrahabr! 

 At the moment, there are already quite a few guides on such a bundle, but in my opinion, first of all, they are a bit outdated, and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Spring without XML. Part 1</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habrahabr! <br><br>  At the moment, there are already quite a few guides on such a bundle, but in my opinion, first of all, they are a bit outdated, and secondly, I think that there should be a guide on how to make something tangible but simple to show that this is possible. <br><br>  So, if you want to try Spring MVC with saving in the database and 0 (zero) xml-configuration files, please under the cat! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Content</b> <div class="spoiler_text"><h3>  <a href="https://habr.com/ru/post/262323/">1. Preparing for launch</a> </h3><br><h4>  <a href="https://habr.com/ru/post/262323/">1.1 IDE</a> </h4><br><h4>  <a href="https://habr.com/ru/post/262323/">1.2 Folder structure</a> </h4><br><h4>  <a href="https://habr.com/ru/post/262323/">1.3 Gradle &amp; Git</a> </h4><br><h5>  <a href="https://habr.com/ru/post/262323/">1.3.1 For the rest</a> </h5><br><h4>  <a href="https://habr.com/ru/post/262323/">1.4 Database</a> </h4><br><h3>  <a href="https://habr.com/ru/post/262323/">2. Getting Started</a> </h3><br><h4>  <a href="https://habr.com/ru/post/262323/">2.1 Creating a project</a> </h4><br><h4>  <a href="https://habr.com/ru/post/262323/">2.2 Add the first code</a> </h4><br><h4>  <a href="https://habr.com/ru/post/262323/">2.3 Content</a> </h4><br><h3>  <a href="https://habr.com/ru/post/262323/">3. Add work from the database</a> </h3><br><h4>  <a href="https://habr.com/ru/post/262323/">3.1 Entity ‚ÄúUser‚Äù</a> </h4><br><h4>  <a href="https://habr.com/ru/post/262323/">3.2 UsersRepository Repository</a> </h4><br><h4>  <a href="https://habr.com/ru/post/262323/">3.3 Add a connection between the user and Spring Security</a> </h4><br><h3>  <a href="https://habr.com/ru/post/262323/">4. What we have come to</a> </h3><br><h4>  <a href="https://habr.com/ru/post/262323/">4.1 For those who want to launch a finished project</a> </h4><br></div></div><br><br>  Of course, I would like to start the application right away, but first we will prepare a little. <br><br><h3><a name="1"></a>  1. Preparing for launch </h3><br><h4><a name="11"></a>  1.1 IDE </h4><br>  All development will be conducted on Intellij IDEA, but I do not think that the implementation in another IDE will be much more difficult. <br><a name="habracut"></a><br><h4><a name="12"></a>  1.2 Folder structure </h4><br>  First, create a project folder, call it ForHabrahabr <br>  For our project, in the root you need to create the following folder tree: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a2/b80/e80/0a2b80e80883e0e394fe350e0ac1ca21.png" alt="directories tree"><br>  <i>(you can just do the instructions for the rest in the next section)</i> <br><br><h4><a name="13"></a>  1.3 Gradle &amp; Git </h4><br><div class="spoiler">  <b class="spoiler_title">For independent</b> <div class="spoiler_text">  So, we received an application framework. <br>  Now let's add version control and a collector to it. <br>  To do this, add .gitignore to ForHabrahabr with this content: <br><br>  .gradle <br>  .idea <br>  * .iml <br>  build / <br><br>  Go to this directory via the console and write <br><pre> git init
</pre><br><br>  Now we add bulid.gradle with all dependencies that will be useful to us in the process of writing the application. <br><div class="spoiler">  <b class="spoiler_title">build.gradle</b> <div class="spoiler_text">  buildscript { <br>  repositories { <br>  mavenCentral () <br>  } <br>  dependencies { <br>  classpath ("org.springframework.boot: spring-boot-gradle-plugin: 1.2.5.RELEASE") <br><br>  classpath 'mysql: mysql-connector-java: 5.1.34' <br>  } <br>  } <br><br>  apply plugin: 'java' <br>  apply plugin: 'eclipse' <br>  apply plugin: 'idea' <br>  apply plugin: 'spring-boot' <br><br>  jar { <br>  baseName = 'gs-rest-service' <br>  version = '0.1.0' <br>  } <br><br>  repositories { <br>  mavenCentral () <br>  } <br><br>  sourceCompatibility = 1.8 <br>  targetCompatibility = 1.8 <br><br>  dependencies { <br>  compile ("org.springframework.boot: spring-boot-starter-web") <br>  compile ("org.springframework.boot: spring-boot-starter-data-jpa") <br>  compile ("org.springframework.boot: spring-boot-starter-security") <br>  compile ("org.springframework.boot: spring-boot-starter-thymeleaf") <br>  compile 'mysql: mysql-connector-java: 5.1.31' <br>  compile 'commons-dbcp: commons-dbcp: 1.4' <br>  testCompile ("org.springframework: spring-test") <br>  testCompile ("junit: junit") <br>  testCompile 'org.springframework.security:spring-security-test:4.0.1.RELEASE' <br>  } <br><br>  task wrapper (type: Wrapper) { <br>  gradleVersion = '2.3' <br>  } <br></div></div><br><br>  Then in the console in the same directory where build.gradle we write <br><pre> gradle wrapper
 ./gradlew build    
 (or for windows ./gradlew.bat build) 
</pre><br></div></div><br>  Now you can use gradlew.bat / gradlew depending on the OS. <br><br><h5><a name="131"></a>  1.3.1 For the rest </h5><br><br><ul><li>  Go through the console to the folder where your Idea projects are located. </li><li>  git clone <a href="">github.com/MaxPovver/ForHabrahabr.git</a> </li><li>  git cd ForHabrahabr / </li><li>  git checkout quikstart </li><li>  That's it, now you have a finished project structure. </li></ul><br><br><h4><a name="14"></a>  1.4 Database </h4><br>  As the database, choose MySQL as the easiest one for quickstart.  Create it on localhost, <br>  in it we create the forhabrahabr base, further we will create labels in it <br>  users <br>  roles <br>  users_roles <br>  posts <br>  likes <br>  But more on that later, while it is enough to create a database. <br><br><h3><a name="2"></a>  2. Getting Started </h3><br><h4><a name="21"></a>  2.1 Creating a project </h4><br>  So, first we will open our newly created project in Intellj IDEA, she will see Gradle and offer to use it: <br>  (Welcome to ItelliJ IDEA -&gt; Open -&gt; ForHabrahabr). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/efb/712/365/efb712365acd3f1cc400772ed23d48e6.png" alt="image"><br><br>  In this window, just press OK, if it is not there (or problems with the Gradle JVM) - write in HP, I will understand what is wrong. <br><br>  In the end, should get this project: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb2/763/086/cb2763086721e79a87d0ba34e7a308a1.png" alt="image"><br><br><h4><a name="22"></a>  2.2 Add the first code </h4><br>  First, create a package for all classes, call it habraspring (the usual folder in src / main / java /), and in it is the first <br>  Application class: <br><br><div class="spoiler">  <b class="spoiler_title">Class code</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.SpringApplication; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.SpringBootApplication; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.ComponentScan; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.data.jpa.repository.config.EnableJpaRepositories; <span class="hljs-meta"><span class="hljs-meta">@SpringBootApplication</span></span> <span class="hljs-meta"><span class="hljs-meta">@ComponentScan</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableJpaRepositories</span></span>(basePackages = {<span class="hljs-string"><span class="hljs-string">"habraspring"</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ SpringApplication.run(Application.class, args); } }</code> </pre> <br></div></div><br>  But in this form, our application will not start yet, you need to show the autoconfigurator where the database is located, for this we will add the file to the resources / <b>application.properties</b> file. <br><br><div class="spoiler">  <b class="spoiler_title">With this content</b> <div class="spoiler_text"><pre> #settings for database
 spring.datasource.url = jdbc: mysql: // localhost / forhabrahabr
 spring.datasource.username = root
 spring.datasource.password =
 spring.datasource.driver-class-name = com.mysql.jdbc.Driver
 #turned on to enable lazy loading
 spring.jpa.properties.hibernate.enable_lazy_load_no_trans = true
</pre><br></div></div><br>  You also need to create a resources / templates / folder for the template engine. <br><br>  The resource folder will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/24c/034/4df/24c0344df9de5a550f7f894ffbf21839.png" alt="image"><br><br>  Do not pay attention to the .gitkeep files, they are not needed for the program to work, you can safely delete / not create them. <br><br>  Done, you can start your application for the first time without crashing <br><br>  To start, you need to run the bootRun task (double click on it): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe4/2d8/a24/fe42d8a24348c7baf3a112b76b6b0888.png" alt="image"><br><br>  If there is no such panel, go to View -&gt; Tool Windows -&gt; Gradle. <br><br>  In the application log there will be something like this: <br><br><div class="spoiler">  <b class="spoiler_title">Startup log</b> <div class="spoiler_text"><pre> 15:24:47: Executing external task 'bootRun' ...
 : compileJava UP-TO-DATE
 : processResources
 : classes
 : findMainClass
 : bootRun<font></font>
<font></font>
   .  ____ _ __ _ _
  / \\ / ___'_ __ _ _ (_) _ __ __ _ \ \ \ \
 (() \ ___ | '_ |' _ | | '_ \ / _` | \ \ \ \
  \\ / ___) |  | _) |  |  |  |  |  ||  (_ | |))))
   '| ____ |  .__ | _ |  | _ | _ |  | _ \ __, |  / / / /
  ========= | _ | ============== | ___ / = / _ / _ / _ /
  :: Spring Boot :: (v1.2.5.RELEASE)<font></font>
<font></font>
 2015-07-11 14: 24: 49.180 INFO 12590 --- [main] habraspring. Application: Starting Application on MacBook-Pro-Maksim.local with PID 12590 (/ Users / admin / IdeaProjects / ForHabrahabr / build / classes / main started by admin in / Users / admin / IdeaProjects / ForHabrahabr)
 2015-07-11 14: 24: 49.230 INFO 12590 --- [main] ationConfigEmbeddedWebApplicationContext: Refreshing org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@2eda0940: startup date [Sat Jul 11 ‚Äã‚Äã14:24:49 MSK 2015];  root of context hierarchy
 2015-07-11 14: 24: 50.029 INFO 12590 --- [main] osbfsDefaultListableBeanFactory: Overriding bean definition for bean 'beanNameViewResolver': replacing [Root bean: class [null];  scope =;  abstract = false;  lazyInit = false;  autowireMode = 3;  dependencyCheck = 0;  autowireCandidate = true;  primary = false;  factoryBeanName = org.springframework.boot.autoconfigure.web.ErrorMvcAutoConfiguration $ WhitelabelErrorViewConfiguration;  factoryMethodName = beanNameViewResolver;  initMethodName = null;  destroyMethodName = (inferred);  [org / springframework / boot / autoconfigure / web / ErrorMvcAutoConfiguration $ WhitelabelErrorViewConfiguration.class]] [Root bean: class [null];  scope =;  abstract = false;  lazyInit = false;  autowireMode = 3;  dependencyCheck = 0;  autowireCandidate = true;  primary = false;  factoryBeanName = org.springframework.boot.autoconfigure.web.WebMvcAutoConfiguration $ WebMvcAutoConfigurationAdapter;  factoryMethodName = beanNameViewResolver;  initMethodName = null;  destroyMethodName = (inferred);  defined in class path resource [org / springframework / boot / autoconfigure / web / WebMvcAutoConfiguration $ WebMvcAutoConfigurationAdapter.class]]
 2015-07-11 14: 24: 50.701 INFO 12590 --- [main] trationDelegate $ BeanPostProcessorChecker: bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [class org.springframework.transaction.annotation.ProxyTransformat "class $$ 1f1e9ae] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
 2015-07-11 14: 24: 50.727 INFO 12590 --- [main] trationDelegate $ BeanPostProcessorChecker: Bean 'transactionAttributeSource' of type [class org.springframework.transaction.annotation.AnnotationTransactionAttributeSource] is not allowed for example: not eligible for auto-proxying)
 2015-07-11 14: 24: 50.741 INFO 12590 --- [main] trationDelegate $ BeanPostProcessorChecker: Bean 'transactionInterceptor' of type [class org.springframework.transaction.interceptor.TransactionInterceptor] for example: not eligible for auto-proxying)
 2015-07-11 14: 24: 50.746 INFO 12590 --- [main] trationDelegate $ BeanPostProcessorChecker: Bean 'org.springframework.transaction.config.internalTransactionAdvisor' of type [class org.springframework.transaction.interceptor.BeanFactoryTransactionerataerataeraftArte.staframework.transaction.config. eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
 2015-07-11 14: 24: 51.168 INFO 12590 --- [main] sbcetTomcatEmbeddedServletContainer: Tomcat initialized with port (s): 8080 (http)
 2015-07-11 14: 24: 51.408 INFO 12590 --- [main] o.apache.catalina.core.StandardService: Starting service Tomcat
 2015-07-11 14: 24: 51.409 INFO 12590 --- [main] org.apache.catalina.core.StandardEngine: Starting Servlet Engine: Apache Tomcat / 8.0.23
 2015-07-11 14: 24: 51.601 INFO 12590 --- [ost-startStop-1] oaccC [Tomcat]. [Localhost]. [/]: Initializing Spring embedded WebApplicationContext
 2015-07-11 14: 24: 51.601 INFO 12590 --- [ost-startStop-1] osweb.context.ContextLoader: Root WebApplicationContext: initialization completed 2374 ms
 2015-07-11 14: 24: 52.570 INFO 12590 --- [ost-startStop-1] basAuthenticationManagerConfiguration: <font></font>
<font></font>
 Using default security password: bd1659e1-4c49-43a2-9fd6-2ca7d46e9e23<font></font>
<font></font>
 2015-07-11 14: 24: 52.614 INFO 12590 --- [ost-startStop-1] ossweb.DefaultSecurityFilterChain: Creating filter chain: Ant [pattern = '/ css / **'], []
 2015-07-11 14: 24: 52.614 INFO 12590 --- [ost-startStop-1] ossweb.DefaultSecurityFilterChain: Creating filter chain: Ant [pattern = '/ js / **'], []
 2015-07-11 14: 24: 52.614 INFO 12590 --- [ost-startStop-1] ossweb.DefaultSecurityFilterChain: Creating filter chain: Ant [pattern = '/ images / **'], []
 2015-07-11 14: 24: 52.614 INFO 12590 --- [ost-startStop-1] ossweb.DefaultSecurityFilterChain: Creating filter chain: Ant [pattern = '/ ** / favicon.ico'], []
 2015-07-11 14: 24: 52.614 INFO 12590 --- [ost-startStop-1] ossweb.DefaultSecurityFilterChain: Creating filter chain: Ant [pattern = '/ error'], []
 2015-07-11 14: 24: 52.650 INFO 12590 --- [ost-startStop-1] ossweb.DefaultSecurityFilterChain: Creating a filter chain: OrRequestMatcher [requestMatchers = [Ant [pattern = '/ **']]], [org .springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter @ 5854c7d0, org.springframework.security.web.context.SecurityContextPersistenceFilter@874f491, and of up to about 20 nights of max total. .web.authentication.logout.LogoutFilter @ 609329b3, org.springframework.security.web.authentication. .SecurityContextHolderAwareRequestFilter @ a3153e3, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@1b8b1dc9, org.springframework.access.access.access.access.access.access.access.access.asn.acquireFileter.ab.Abl.Anl.Anl.  4, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@1fb86c05]
 2015-07-11 14: 24: 52.723 INFO 12590 --- [ost-startStop-1] osbcembedded.FilterRegistrationBean: Mapping filter: 'characterEncodingFilter' to: [/ *]
 2015-07-11 14: 24: 52.724 INFO 12590 --- [ost-startStop-1] osbcembedded.FilterRegistrationBean: Mapping filter: 'hiddenHttpMethodFilter' to: [/ *]
 2015-07-11 14: 24: 52.724 INFO 12590 --- [ost-startStop-1] osbcembedded.FilterRegistrationBean: Mapping filter: 'springSecurityFilterChain' to: [/ *]
 2015-07-11 14: 24: 52.724 INFO 12590 --- [ost-startStop-1] osbceServletRegistrationBean: Mapping servlet: 'dispatcherServlet' to [/]
 2015-07-11 14: 24: 53.410 INFO 12590 --- [main] j.LocalContainerEntityManagerFactoryBean: Building JPA container EntityManagerFactory for persistence unit 'default'
 2015-07-11 14: 24: 53.425 INFO 12590 --- [main] o.hibernate.jpa.internal.util.LogHelper: HHH000204: Processing PersistenceUnitInfo [
	 name: default
	 ...]
 2015-07-11 14: 24: 53.500 INFO 12590 --- [main] org.hibernate.Version: HHH000412: Hibernate Core {4.3.10.Final}
 2015-07-11 14: 24: 53.503 INFO 12590 --- [main] org.hibernate.cfg.Environment: HHH000206: hibernate.properties not found
 2015-07-11 14: 24: 53.505 INFO 12590 --- [main] org.hibernate.cfg.Environment: HHH000021: Bytecode provider name: javassist
 2015-07-11 14: 24: 53.628 INFO 12590 --- [main] o.hibernate.annotations.common.Version: HCANN000001: Hibernate Commons Annotations {4.0.5.Final}
 2015-07-11 14: 24: 53.711 INFO 12590 --- [main] org.hibernate.dialect.Dialect: HHH000400: Using dialect: org.hibernate.dialect.MySQL5Dialect
 2015-07-11 14: 24: 53.774 INFO 12590 --- [main] ohhiast.ASTQueryTranslatorFactory: HHH000397: Using ASTQueryTranslatorFactory
 2015-07-11 14: 24: 54.244 INFO 12590 --- [main] swsmmaRequestMappingHandlerAdapter: Looking for @ControllerAdvice: org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@2eda0940: launch date [Sat Jul 11 ‚Äã‚Äã14:24 MSK 2015];  root of context hierarchy
 2015-07-11 14: 24: 54.328 INFO 12590 --- [main] swsmmaRequestMappingHandlerMapping: Mapped "{[/ error]}": java.util.Map &lt;java.lang.String , java.lang.Object &gt;&gt; org.springframework.boot.autoconfigure.web.BasicErrorController.error (javax.servlet.http.HttpServletRequest)
 2015-07-11 14: 24: 54.328 INFO 12590 --- [main] swsmmaRequestMappingHandlerMapping: Mapped "{[/ error], produces = [text / html]}" for public org.springframework.web.servlet.ModelAndView org. springframework.boot.autoconfigure.web.BasicErrorController.errorHtml (javax.servlet.http.HttpServletRequest)
 2015-07-11 14: 24: 54.356 INFO 12590 --- [main] oswshandler.SimpleUrlHandlerMapping: Mapped URL path [/ webjars / **] for class of [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
 2015-07-11 14: 24: 54.357 INFO 12590 --- [main] oswshandler.SimpleUrlHandlerMapping: Mapped URL path [/ **] for handler type [class org.springframework.web.servlet.resource.ResourceHttpRequestHandler]
 2015-07-11 14: 24: 54.393 INFO 12590 --- [main] oswshandler.SimpleUrlHandlerMapping: Mapped URL path [/**/favicon.ico] [class org.springframework.web.servlet.resource. ResourceHttpRequestHandler]
 2015-07-11 14: 24: 54.723 INFO 12590 --- [main] osjeaAnnotationMBeanExporter: Registering beans for JMX exposure on startup
 2015-07-11 14: 24: 54.800 INFO 12590 --- [main] sbcetTomcatEmbeddedServletContainer: Tomcat started on port (s): 8080 (http)
 2015-07-11 14: 24: 54.803 INFO 12590 --- [main] habraspring.Application: Started Application in 5.945 seconds (JVM running for 6.529) </pre><br></div></div><br>  Try to go now to <a href="http://localhost:8080/">http: // localhost: 8080</a> , it should work. <br><br>  Well, now I would like to see some content, right? <br><br><h4><a name="23"></a>  2.3 Content </h4><br>  To do this, we need to create two configuration classes (remember, no XML!) In the config subfolder, and also add home.html (similar to index.html) to the resources folder. <br><br>  We have the simplest configuration files, because we use them for pages without a controller: <br><br><div class="spoiler">  <b class="spoiler_title">config / MvcConfig.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MvcConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebMvcConfigurerAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addViewControllers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ViewControllerRegistry registry)</span></span></span><span class="hljs-function"> </span></span>{ registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/home"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"home"</span></span>); registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"home"</span></span>); } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">config / WebSecurityConfig.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.security.SecurityProperties; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.core.annotation.Order; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.builders.HttpSecurity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.servlet.configuration.EnableWebMvcSecurity; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableWebMvcSecurity</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableGlobalMethodSecurity</span></span>(prePostEnabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Order</span></span>(SecurityProperties.ACCESS_OVERRIDE_ORDER) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebSecurityConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebSecurityConfigurerAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpSecurity http)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ http .authorizeRequests() .antMatchers(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">"/home"</span></span>).permitAll(); } }</code> </pre><br></div></div><br>  Well, the simplest home page: <br><br><div class="spoiler">  <b class="spoiler_title">home.html</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/xhtml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:th</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.thymeleaf.org"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Habrahabr<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Welcome!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Yours home page.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br>  How the project should look like at this stage can be viewed (and downloaded) here: <br>  <a href="https://github.com/MaxPovver/ForHabrahabr/tree/withbasicmvc">github.com/MaxPovver/ForHabrahabr/tree/withbasicmvc</a> <br>  * do not forget to write in the project folder in the console git checkout withbasicmvc <br><br>  If at the moment everything is done correctly, <a href="http://localhost:8080/">http: // localhost: 8080</a> should show you <br><pre> Welcome!<font></font>
<font></font>
 Yours home page.
</pre><br><br><h3><a name="3"></a>  3. Add work from the database </h3><br>  So, we want to add controllers, and that access to them is granted only to authorized users, but we do not have them yet. <br><br>  In order for the authorization mechanism to work, we need to add the essence of the user to the project. <br>  Necessary steps: <br><ul><li>  Add a class that describes the essence of the user in the database </li><li>  Add new entity repository </li><li>  Add a ‚Äúlink‚Äù between the Spring Security mechanism and our entity </li><li>  All everywhere register </li><li>  Enable Spring Security </li></ul><br><h4><a name="31"></a>  3.1 Entity ‚ÄúUser‚Äù </h4><br>  First, create in DB the simplest table users with the fields id, username, password. <br><br>  Now we will create a subpackage of entities for the entities and create the class User in it: <br><br><div class="spoiler">  <b class="spoiler_title">entities / User.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.entities; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.*; <span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name=<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.AUTO) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String username; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String password; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPassword</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> password; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPassword</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String password)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.password = password; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> username; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.username = username; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String pass)</span></span></span><span class="hljs-function"> </span></span>{ username = name; password = pass; } }</code> </pre><br></div></div><br><br>  No hbm.xml is needed, you do not even need to annotate the fields (an exception is the ID field, you should always mark it) <br><br><h4><a name="32"></a>  3.2 UsersRepository Repository </h4><br>  Here Spring does everything for us, it‚Äôs enough to be inherited so that he understands what to generate, you don‚Äôt need to write code at all: <br><br><div class="spoiler">  <b class="spoiler_title">UsersRepository.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.repositories; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> habraspring.entities.User; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.data.repository.CrudRepository; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CrudRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Long</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-function">User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findByUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username)</span></span></span></span>; }</code> </pre><br></div></div><br><br><h4><a name="33"></a>  3.3 Add a connection between the user and Spring Security </h4><br>  To do this, we need to create a class that implements the UserDetailsService interface and enable it in WebSecurityConfig <br><br><div class="spoiler">  <b class="spoiler_title">utils / MySQLUserDetailsService.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.utils; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> habraspring.entities.User; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> habraspring.repositories.UsersRepository; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.authentication.InternalAuthenticationServiceException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.GrantedAuthority; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.userdetails.UserDetails; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.userdetails.UserDetailsService; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.userdetails.UsernameNotFoundException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Collection; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MySQLUserDetailsService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDetailsService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> UsersRepository users; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UserDetails </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadUserByUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> UsernameNotFoundException </span></span>{ UserDetails loadedUser; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { User client = users.findByUsername(username); loadedUser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> org.springframework.security.core.userdetails.User( client.getUsername(), client.getPassword(), DummyAuthority.getAuth()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception repositoryProblem) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InternalAuthenticationServiceException(repositoryProblem.getMessage(), repositoryProblem); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedUser; } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DummyAuthority</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GrantedAuthority</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Collection&lt;GrantedAuthority&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAuth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;GrantedAuthority&gt; res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(<span class="hljs-number"><span class="hljs-number">1</span></span>); res.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DummyAuthority()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAuthority</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"USER"</span></span>; } } }</code> </pre><br></div></div><br>  Now, change the WebSecurityConfig code: <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> habraspring.utils.MySQLUserDetailsService; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.security.SecurityProperties; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.core.annotation.Order; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.builders.HttpSecurity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.servlet.configuration.EnableWebMvcSecurity; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableWebMvcSecurity</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableGlobalMethodSecurity</span></span>(prePostEnabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Order</span></span>(SecurityProperties.ACCESS_OVERRIDE_ORDER) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebSecurityConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebSecurityConfigurerAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpSecurity http)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ http .authorizeRequests() .antMatchers(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">"/home"</span></span>).permitAll() .anyRequest().authenticated() .and() .formLogin() .loginPage(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>) .permitAll() .and() .logout() .permitAll(); } <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MySQLUserDetailsService mySQLUserDetailsService; <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureGlobal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthenticationManagerBuilder auth)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ auth.userDetailsService(mySQLUserDetailsService); } }</code> </pre><br></div></div><br>  Add the login.html login page and the "secret" (for authorized only) secret.html page: <br><br><div class="spoiler">  <b class="spoiler_title">Their code</b> <div class="spoiler_text"><div class="spoiler">  <b class="spoiler_title">secret.html</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/xhtml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:th</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.thymeleaf.org"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Secret page<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">th:inline</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag">&gt;</span></span>Hello [[${#httpServletRequest.remoteUser}]]!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">th:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{/logout}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Sign Out"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">login.html</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/xhtml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:th</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.thymeleaf.org"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Login page<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">th:if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${param.error}"</span></span></span><span class="hljs-tag">&gt;</span></span> Invalid username and password. <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">th:if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${param.logout}"</span></span></span><span class="hljs-tag">&gt;</span></span> You have been logged out. <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">th:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@{/login}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> User Name : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"username"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> Password: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Sign In"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br></div></div><br>  And we will make the new pages available without a controller, adding 2 lines to WebMvcConfig: <br><br><pre> <code class="java hljs"> registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"login"</span></span>); registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/secret"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"secret"</span></span>);</code> </pre><br>  Done!  Now, at <a href="http://localhost:8080/">http: // localhost: 8080</a> , everything should be displayed normally, <br>  but at <a href="http://localhost:8080/secret">http: // localhost: 8080 / secret</a> you will not be able to get through - they will throw in / login, requiring a valid user / password pair. <br><br>  Now add to your forhabrahabr.users table an entry with a password and login user, user (or run the script <a href="">github.com/MaxPovver/ForHabrahabr/blob/withauth/import_me.sql</a> in your db). <br>  If you did everything right, you should now be allowed into / secret. <br><br><h3><a name="4"></a>  4. What we have come to </h3><br>  So, we already use a full-fledged Spring MVC application using Spring Security for Security and Spring JPA for working with the database.  And no XML. <br><br><h4><a name="41"></a>  4.1 For those who want to launch a finished project </h4><br><ul><li>  git clone <a href="">github.com/MaxPovver/ForHabrahabr.git</a> </li><li>  cd ForHabrahabr / </li><li>  git checkout withauth </li><li>  we start import_me.sql in our local mysql database (or create a label and data for it with our hands) </li><li><div class="spoiler">  <b class="spoiler_title">Open IDEA folder created ForHabrahabr</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/5d4/fa8/270/5d4fa82708c2714b1fed09693dcaffab.png" alt="image"><br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">There are no Gradle panels?</b>  <b class="spoiler_title">Open it here</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/70a/0b7/9f9/70a0b79f928a472db4aba5a32bc46431.png" alt="image"><br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Run bootRun</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/7f4/8a0/f0e/7f48a0f0e66fb21d81f73d1a58a3203f.png" alt="image"><br></div></div></li><li>  At this step everything should already work. </li></ul><br><br>  Much had to be omitted / not explained in order not to confuse it completely, but if you consider it necessary to add something now - write in ps. <br><br>  There is still material left for at least one part, if, of course, the topic is relevant.  (Controllers, EntityToEntity (ManyToOne OneToOne etc), User Roles, Testing etc) <br><br><h3>  Comments to the first part </h3><br>  In the article itself I had to skip some moments, I will try to write about their maximum number here.  This part is not needed to run the application, but can be useful in clarifying incomprehensible moments. <br><div class="spoiler">  <b class="spoiler_title">To read...</b> <div class="spoiler_text"><h4>  Mvcconfig </h4><br>  I will cite his code again: <br><br><div class="spoiler">  <b class="spoiler_title">MvcConfig.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MvcConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebMvcConfigurerAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addViewControllers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ViewControllerRegistry registry)</span></span></span><span class="hljs-function"> </span></span>{ registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/home"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"home"</span></span>); registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"home"</span></span>); registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"login"</span></span>); registry.addViewController(<span class="hljs-string"><span class="hljs-string">"/secret"</span></span>).setViewName(<span class="hljs-string"><span class="hljs-string">"secret"</span></span>); } }</code> </pre><br></div></div><br>  What does this method do?  It binds a request from the address bar to a template from the resources / folder. <br>  For example, if our server is asked to show the contents of "/" or "/ home", it will return home.html. <br>  Similarly, when requesting "/ login", login.html will return. <br><br><h4>  WebSecurityConfig </h4><br><div class="spoiler">  <b class="spoiler_title">WebSecurityConfig.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.config; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> habraspring.utils.MySQLUserDetailsService; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.boot.autoconfigure.security.SecurityProperties; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.core.annotation.Order; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.builders.HttpSecurity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.config.annotation.web.servlet.configuration.EnableWebMvcSecurity; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableWebMvcSecurity</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableGlobalMethodSecurity</span></span>(prePostEnabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Order</span></span>(SecurityProperties.ACCESS_OVERRIDE_ORDER) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebSecurityConfig</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebSecurityConfigurerAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpSecurity http)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ http .authorizeRequests() .antMatchers(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">"/home"</span></span>).permitAll() .anyRequest().authenticated() .and() .formLogin() .loginPage(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>) .permitAll() .and() .logout() .permitAll(); } <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MySQLUserDetailsService mySQLUserDetailsService; <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureGlobal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthenticationManagerBuilder auth)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ auth.userDetailsService(mySQLUserDetailsService); } }</code> </pre><br></div></div><br>  Consider this class in order: <br>  We allow to give requests from this list to anyone who requested: <br><br><pre> <code class="java hljs">.authorizeRequests() .antMatchers(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">"/home"</span></span>).permitAll()</code> </pre><br>  All the rest is allowed to open only to authorized users, we specify where the login form is, by opening it for all and the page to exit: <br><br><pre> <code class="java hljs">.anyRequest().authenticated() .and() .formLogin() .loginPage(<span class="hljs-string"><span class="hljs-string">"/login"</span></span>) .permitAll() .and() .logout() .permitAll();</code> </pre><br>  We also determine where to get users from our system of protection, for this we use the @Autowired annotation, Spring will load the instance of the necessary service there: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MySQLUserDetailsService mySQLUserDetailsService;</code> </pre><br>  And we transfer it to the method that allows us to define our service for connecting Spring Security users and users from the database. <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configureGlobal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthenticationManagerBuilder auth)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ auth.userDetailsService(mySQLUserDetailsService); }</code> </pre><br><h4>  MySQLUserDetailsService </h4><br><div class="spoiler">  <b class="spoiler_title">MySQLUserDetailsService.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.utils; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> habraspring.entities.User; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> habraspring.repositories.UsersRepository; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.authentication.InternalAuthenticationServiceException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.GrantedAuthority; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.userdetails.UserDetails; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.userdetails.UserDetailsService; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.userdetails.UsernameNotFoundException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Collection; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MySQLUserDetailsService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDetailsService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> UsersRepository users; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> UserDetails </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadUserByUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> UsernameNotFoundException </span></span>{ UserDetails loadedUser; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { User client = users.findByUsername(username); loadedUser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> org.springframework.security.core.userdetails.User( client.getUsername(), client.getPassword(), DummyAuthority.getAuth()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception repositoryProblem) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InternalAuthenticationServiceException(repositoryProblem.getMessage(), repositoryProblem); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedUser; } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DummyAuthority</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GrantedAuthority</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Collection&lt;GrantedAuthority&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAuth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;GrantedAuthority&gt; res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(<span class="hljs-number"><span class="hljs-number">1</span></span>); res.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DummyAuthority()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAuthority</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"USER"</span></span>; } } }</code> </pre><br></div></div><br>  Consider the implementation of loadUserByUsername. <br><br>  Here, we again use @Autowired to spring up in the users' implemented user interface of the repository from the database and pull out with its help the user with the specified nickname from the database: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> UsersRepository users; .... User client = users.findByUsername(username);</code> </pre><br>  And here we return the ‚Äúconverted‚Äù from the database entity to the Spring Security entity user.  But there is a problem - our user does not have associated roles yet (we‚Äôll make them later), so we will create a stub class that gives user rights to any existing user.  If the user does not exist, the code will crash earlier with the exception.  Then Spring itself for this user will check the correspondence of the entered password and the password of the object in the database with the following username: <br><br><pre> <code class="java hljs"> loadedUser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> org.springframework.security.core.userdetails.User( client.getUsername(), client.getPassword(), DummyAuthority.getAuth());</code> </pre><br><h4>  User </h4><br><div class="spoiler">  <b class="spoiler_title">User.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> habraspring.entities; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.*; <span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name=<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.AUTO) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String username; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String password; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPassword</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> password; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPassword</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String password)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.password = password; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> username; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUsername</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.username = username; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String pass)</span></span></span><span class="hljs-function"> </span></span>{ username = name; password = pass; } }</code> </pre><br></div></div><br>  Consider the code line by line: <br>  By adding the <a href="https://habrahabr.ru/users/entity/" class="user_link">Entity</a> annotation, we indicate to the Spring scanner that this class should be tied to a table in the database. <br>  In the <a href="https://habrahabr.ru/users/table/" class="user_link">Table</a> annotation, we indicate the name of the table to which we will bind this class (often it can also not be indicated, but it is better not to do so, otherwise, if you change the name of the table, you can catch problems). <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name=<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{</code> </pre><br>  With fields, everything is much simpler - they are automatically attached to fields in the database with the same name, you don‚Äôt need to write anything at all!  You only need to specify which field - ID, and how to generate it for new entities while saving to the base. <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.AUTO) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String username; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String password;</code> </pre><br>  Next are automatically generated getters / setters (it is better to do them even if they are not needed, just in case SUDDENLY want to add logic to it). <br><br>  Well, after there are two constructors - empty - only for the serializer, you cannot use it directly in the program, and user friendly to create new users and then save them in the UsersRepository. <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String pass)</span></span></span><span class="hljs-function"> </span></span>{ username = name; password = pass; }</code> </pre><br><h4>  Gradle </h4><br><pre> <code class="java hljs">buildscript { repositories { mavenCentral() } dependencies { classpath(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-gradle-plugin:1.2.5.RELEASE"</span></span>) classpath <span class="hljs-string"><span class="hljs-string">'mysql:mysql-connector-java:5.1.34'</span></span> } } apply plugin: <span class="hljs-string"><span class="hljs-string">'java'</span></span> apply plugin: <span class="hljs-string"><span class="hljs-string">'eclipse'</span></span> apply plugin: <span class="hljs-string"><span class="hljs-string">'idea'</span></span> apply plugin: <span class="hljs-string"><span class="hljs-string">'spring-boot'</span></span> jar { baseName = <span class="hljs-string"><span class="hljs-string">'gs-rest-service'</span></span> version = <span class="hljs-string"><span class="hljs-string">'0.1.0'</span></span> } repositories { mavenCentral() } sourceCompatibility = <span class="hljs-number"><span class="hljs-number">1.8</span></span> targetCompatibility = <span class="hljs-number"><span class="hljs-number">1.8</span></span> dependencies { compile(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-web"</span></span>) compile(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-data-jpa"</span></span>) compile(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-security"</span></span>) compile(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-thymeleaf"</span></span>) compile <span class="hljs-string"><span class="hljs-string">'mysql:mysql-connector-java:5.1.31'</span></span> compile <span class="hljs-string"><span class="hljs-string">'commons-dbcp:commons-dbcp:1.4'</span></span> testCompile(<span class="hljs-string"><span class="hljs-string">"org.springframework:spring-test"</span></span>) testCompile(<span class="hljs-string"><span class="hljs-string">"junit:junit"</span></span>) testCompile <span class="hljs-string"><span class="hljs-string">'org.springframework.security:spring-security-test:4.0.1.RELEASE'</span></span> } <span class="hljs-function"><span class="hljs-function">task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wrapper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(type: Wrapper)</span></span></span><span class="hljs-function"> </span></span>{ gradleVersion = <span class="hljs-string"><span class="hljs-string">'2.3'</span></span> }</code> </pre><br>    ,  Gradle      : <br><br><pre> <code class="java hljs">dependencies { compile(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-web"</span></span>) -   <span class="hljs-function"><span class="hljs-function">Spring MVC </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-data-jpa"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> -   Spring </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Jpa</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(   )</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-security"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> -   Spring Security </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-thymeleaf"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> -     resources/tempates compile 'mysql:mysql-connector-java:5.1.31' - mysql to spring compile 'commons-dbcp:commons-dbcp:1.4'</span></span></code> </pre><br><br>    ,      (  ): <br><br><pre> <code class="java hljs"> testCompile(<span class="hljs-string"><span class="hljs-string">"org.springframework:spring-test"</span></span>) testCompile(<span class="hljs-string"><span class="hljs-string">"junit:junit"</span></span>) testCompile <span class="hljs-string"><span class="hljs-string">'org.springframework.security:spring-security-test:4.0.1.RELEASE'</span></span></code> </pre><br></div></div><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> second part: </font></font><a href="http://habrahabr.ru/post/262361/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spring without XML.</font></font></a>  <a href="http://habrahabr.ru/post/262361/">Part 2</a> </div><p>Source: <a href="https://habr.com/ru/post/262323/">https://habr.com/ru/post/262323/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262311/index.html">AGTH reverse to recreate an alternate GUI</a></li>
<li><a href="../262315/index.html">Yii 2.0.5 (security fix)</a></li>
<li><a href="../262317/index.html">At St.Petersburg State University of Economics, the acceptance of applicants' documents for the direction ‚ÄúApplied Mathematics and Computer Science‚Äù with a deep study of Wolfram Mathematica began</a></li>
<li><a href="../262319/index.html">Another critical vulnerability has been discovered in Adobe Flash Player.</a></li>
<li><a href="../262321/index.html">Three thoughts for Android fans based on I / O 2015</a></li>
<li><a href="../262327/index.html">Dojo 2</a></li>
<li><a href="../262333/index.html">Tekla Structures API (Delphi): Connection and Simple Examples</a></li>
<li><a href="../262335/index.html">Garbage collector in Go: solving the problem of responsiveness in Go 1.5</a></li>
<li><a href="../262339/index.html">2 Pi or not 2 Pi - that is the question</a></li>
<li><a href="../262341/index.html">We sign data: HMAC in practice in API and Web-forms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>