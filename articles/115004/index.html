<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Run Chaco and Mayavi on PySide</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Well, there was the long-awaited release of PySide. Some habravchane begin to use it for the first time, some have already dealt with it. 

 In my wor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Run Chaco and Mayavi on PySide</h1><div class="post__text post__text-html js-mediator-article">  Well, there was the long-awaited release of PySide.  Some habravchane begin to use it for the first time, some have already dealt with it. <br><br>  In my work, we have to use Mayavi cross-platform visualizer and Chaco chart builder ( <a href="http://code.enthought.com/chaco/">if you are</a> interested, read <a href="http://code.enthought.com/chaco/">code.enthought.com/chaco</a> and <a href="http://code.enthought.com/projects/mayavi/">code.enthought.com/projects/mayavi</a> ).  My task was to embed their frames in my HPGL-GUI application.  Initially, I wrote everything on PyQt4 and everything suited me, except for one thing.  The problem was the license.  PySide is released under the LGPL v2.1, which is just right for commercial needs. <br><br>  PySide came to the rescue, which has already begun to be actively used as a backend to Enthought products.  It was then that the first pitfalls awaited me. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Lack of documentation on exactly how to use PySide for embedding. <br>  Having a little browsing through the sources, I found out that it is enough to specify the environment variable 'QT_API' to the value 'pyside': <br><br><blockquote>  <font color="#ff7700">import</font> <font color="#dc143c">os</font> <br>  <font color="#dc143c">os</font> .  <font>environ</font> <font>[</font> <font color="#483d8b">'QT_API'</font> <font>]</font> = <font color="#483d8b">'pyside'</font> </blockquote><br>  Despite this, the application refused to work.  It is useful to edit the source.  It seemed that there were not so many changes, but finding problems from scratch is rather disgusting and time consuming.  I hope further instructions will help someone. <br><br><a name="habracut"></a><br>  The first thing you need to collect packages from the gita.  We set ourselves PySide, git, subversion, setuptools, swig, numpy, scipy, vtk, wxpython.  For Windows, you also need to install mingw (vtk and wxpython for Win, I advise you to take from here to save time <a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/">www.lfd.uci.edu/~gohlke/pythonlibs</a> ). <br><ul><li>  Download and put in the ETS daddy, go to it and clone the repositories: <br><blockquote>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> traits.git Traits <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> traitsbackendqt.git TraitsBackendQt <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> traitsbackendwx.git TraitsBackendWX <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> traitsgui.git TraitsGUI <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> enable.git Enable <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> chaco.git Chaco <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> mayavi.git Mayavi <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> enthoughtbase.git EnthoughtBase <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> envisagecore.git EnvisageCore <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> envisageplugins.git EnvisagePlugins <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> etsdevtools.git ETSDevTools <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> blockcanvas.git BlockCanvas <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> graphcanvas.git GraphCanvas <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> codetools.git CodeTools <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> apptools.git AppTools <br>  git clone git: <font color="#000000">//</font> github.com <font color="#000000">/</font> enthought <font color="#000000">/</font> scimath.git SciMath </blockquote></li><li>  Run the build: <br><blockquote>  python ets.  <font>py</font> develop </blockquote></li><li>  If the build fails, then install the necessary packages and restart the script. </li><li>  After successful assembly, go to the directory Mayavi / enthought / tvtk / pyface / ui / qt4 / <br>  Open all the files one by one and change the import of PyQt4 to PySide. <br>  If desired, you can use the design of the form: <br><blockquote>  <font color="#ff7700">import</font> <font color="#dc143c">os</font> <br>  qt_api = <font color="#dc143c">os</font> .  <font>environ</font> .  <font>get</font> <font>(</font> <font color="#483d8b">'QT_API'</font> , <font color="#483d8b">'pyqt'</font> <font>)</font> <br>  <font color="#ff7700">if</font> qt_api == <font color="#483d8b">'pyqt'</font> : <br>  <font color="#ff7700">from</font> PyQt4 <font color="#ff7700">import</font> QtGui, QtCore <br>  <font color="#ff7700">else</font> : <br>  <font color="#ff7700">from</font> PySide <font color="#ff7700">import</font> QtGui, QtCore </blockquote></li><li>  In the init.py file from the same directory, you need to comment out lines 26-30 with checking the version of PyQt: <br><blockquote>  <font color="#808080">#if QtCore.QT_VERSION &lt;0x040200:</font> <br>  <font color="#808080"># raise RuntimeError, "Need Qt v4.2 or higher, but not got v% s"% QtCore.QT_VERSION_STR</font> <br><br>  <font color="#808080">#if QtCore.PYQT_VERSION &lt;0x040100:</font> <br>  <font color="#808080"># raise RuntimeError, "Need PyQt v4.1 or higher, but not got% s"% QtCore.PYQT_VERSION_STR</font> </blockquote></li><li>  edit the TraitsBackendQt / enthought / traits / ui / qt4 / ui_panel.py file in lines 920-926 (__add_widget (...) function): <br><blockquote>  <font color="#ff7700">if</font> row <font color="#66cc66">&lt;</font> <font color="#ff4500">0</font> : <br>  <font color="#ff7700">if</font> <font color="#008000">isinstance</font> <font>(</font> w, QtGui. <font>QWidget</font> <font>)</font> : <br>  layout.  <font>addWidget</font> <font>(</font> w <font>)</font> <br>  <font color="#ff7700">elif</font> <font color="#008000">isinstance</font> <font>(</font> w, QtGui. <font>QLayout</font> <font>)</font> : <br>  layout.  <font>addLayout</font> <font>(</font> w <font>)</font> <br>  <font color="#ff7700">else</font> : <br>  layout.  <font>addWidget</font> <font>(</font> w <font>)</font> </blockquote></li><li>  For those who want to work under Win, you need to fix the file Mayavi \ enthought \ tvtk \ pyface \ ui \ qt4 \ QVTKRenderWindowInteractor.py <br><br>  Add to imports: <br><blockquote>  <font color="#ff7700">from</font> ctypes <font color="#ff7700">import</font> pythonapi, c_void_p, py_object <br>  pythonapi.  <font>PyCObject_AsVoidPtr</font> .  <font>restype</font> = c_void_p <br>  pythonapi.  <font>PyCObject_AsVoidPtr</font> .  <font>argtypes</font> = <font>[</font> py_object <font>]</font> </blockquote><br>  and, using a text editor replacement, change str (int (self.winId ())) to str (int (pythonapi.PyCObject_AsVoidPtr (self.winId ()))) <br></li></ul><br><br>  After all these manipulations, you can run an example. <br>  For Chaco: <a href="http://pastebin.ubuntu.com/575888/">pastebin.ubuntu.com/575888</a> <br>  For Mayavi: <a href="http://pastebin.ubuntu.com/575889/">pastebin.ubuntu.com/575889</a> <br><br>  Screenshots of working widgets: <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/8c/e0/8ce008b799421a04ed7091ad441c2389.png"></a> <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/79/34/7934eb425499babc519077ee4493f694.png"></a> <br><br>  <b>PS If someone is interested, I can write articles on the possibilities and pitfalls of Chaco and Mayavi.</b> </div><p>Source: <a href="https://habr.com/ru/post/115004/">https://habr.com/ru/post/115004/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114998/index.html">Hardware accelerated graphics in Flash on Windows and Linux</a></li>
<li><a href="../114999/index.html">DevCon'11 - Software Development Conference</a></li>
<li><a href="../115000/index.html">Dynamic pricing concept</a></li>
<li><a href="../115001/index.html">Acer Aspire One Happy or a netbook with android</a></li>
<li><a href="../115002/index.html">Control start tasks using Twitter</a></li>
<li><a href="../115006/index.html">A new official site symfony has opened</a></li>
<li><a href="../115007/index.html">Mercurial + Nginx configuration for managing a large number of repositories</a></li>
<li><a href="../115008/index.html">Legal review of Creative Commons licenses made in Kyrgyzstan</a></li>
<li><a href="../115009/index.html">Kohana 3.0 - simplify your life</a></li>
<li><a href="../115011/index.html">The Wikimedia Foundation published a financial report for the second half of 2010</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>