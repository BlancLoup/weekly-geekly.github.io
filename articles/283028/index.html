<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Squid's serious proxy vulnerability can ‚Äúpoison cache‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jianjun Chen, a graduate student at Tsinghua University in China, discovered a dangerous vulnerability in the popular proxy server, Squid. As he manag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Squid's serious proxy vulnerability can ‚Äúpoison cache‚Äù</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/283028/"><img src="https://habrastorage.org/files/efc/a4e/9c2/efca4e9c217549c4b624384842c17443.png"></a> <br><br>  Jianjun Chen, a graduate student at Tsinghua University in China, discovered a <a href="http://bugs.squid-cache.org/show_bug.cgi%3Fid%3D4501">dangerous vulnerability</a> in the popular proxy server, Squid.  As he managed to find out, the system does not comply with the RFC 7230 standard, and also does not work correctly when parsing and processing the Host header in HTTP requests.  As a result, an attacker can form a malicious package and use it to cache cache with the help of it. <a name="habracut"></a><br><br><h4>  What is the problem </h4><br>  The researcher was able to carry out the Squid-3.5.12 cache poisoning attack for any unencrypted HTTP requests.  To conduct such an attack, the attacker must be able to send requests through a proxy server to his site (say, attack.com).  In this scenario, a TCP connection is first established with the attack.com web server of the site ‚Äî since Squid is operating in transparent proxy mode, it intercepts and transmits these requests further.  In the next step, the attacker initiates an HTTP request: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">GET http://victim.com/ HTTP/1.1 Host: attack.com</code> </pre> <br>  The caching module uses the node address from the request line (victim.com) for the key, but the verification module uses the Host (attack.com) header to verify communication between the node and the IP address.  This makes the attack possible. <br><br>  The researcher also published a <a href="https://drive.google.com/file/d/0ByM36MBckzBaQUFES0VYRlZydUE/view">demo video</a> . <br><br>  Such an attack can be carried out remotely, for example using Flash-advertising.  Since Squid is used as a transparent proxy by many Internet providers, exploiting a detected vulnerability can lead to serious consequences. <br><br>  Initially, the Squid developers considered that the discovered vulnerability repeated the error described in CVE-2009-0801.  However, a Chinese researcher has proven that the new attack is not related to the old vulnerability.  In the case of CVE-2009-0801, an attacker could carry out a SOP bypass attack: this error was due to incorrect processing of the destination node's IP address.  The problem has been fixed since version Squid 3.3.  The new vulnerability lies in the inconsistent operation of the route checking module and the Squid 3.5 caching module. <br><br><h4>  How to protect </h4><br>  At the moment, the vulnerability is fixed, but CVE is still not there, as well as the official patch in the form of a separate version of Squid.  The fix is ‚Äã‚Äãenabled for now only in daily assemblies for versions <a href="http://www.squid-cache.org/Versions/v4/changesets/squid-4-14659.patch">4</a> and <a href="http://www.squid-cache.org/Versions/v3/3.5/changesets/squid-3.5-14039.patch">3.5</a> . <br><br>  Positive Technologies experts recommend enabling the <b><a href="http://www.squid-cache.org/Doc/config/host_verify_strict/">host_verify_strict</a></b> option, <b><a href="http://www.squid-cache.org/Doc/config/host_verify_strict/">disabled</a></b> by default, and also using the Suricata IDS rule to detect attempted exploits: <br><br><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="728237422643949569"></twitter-widget><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div><p>Source: <a href="https://habr.com/ru/post/283028/">https://habr.com/ru/post/283028/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283018/index.html">Dagger 2. We treat dependencies by the method of Google</a></li>
<li><a href="../283020/index.html">The first success of a complex game bot</a></li>
<li><a href="../283022/index.html">Developers lazy to the edge?</a></li>
<li><a href="../283024/index.html">We delegate the right to restore virtual machines, files and application objects using Enterprise Manager</a></li>
<li><a href="../283026/index.html">How to replace ELK for viewing logs?</a></li>
<li><a href="../283030/index.html">Once again on minimizing boolean functions</a></li>
<li><a href="../283036/index.html">Means of data collection in computer technical expertise</a></li>
<li><a href="../283038/index.html">Performance without event loop</a></li>
<li><a href="../283042/index.html">Towards Full Typing with TypeScript, Swashbuckle, and AutoRest</a></li>
<li><a href="../283044/index.html">How data centers are changing right now: Energy efficiency, data storage and the "clouds"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>