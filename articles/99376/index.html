<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RSA, is it really that simple?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prelude 
 Good day, dear readers. 
 Most likely, most of you know what the asymmetric RSA encryption algorithm is. In fact, so many articles are devot...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RSA, is it really that simple?</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prelude </h4><br>  Good day, dear readers. <br>  Most likely, most of you know what the asymmetric RSA encryption algorithm is.  In fact, so many articles are devoted to this issue on the whole Internet and on this resource in particular, that it is almost impossible to say something new about it. <br>  Well, there, by God, you can still come up with and so everything is understood long ago.  The recipe is simple: <br>  Two prime numbers P and Q. <br>  Multiply to get the number N. <br>  Choose arbitrary E. <br>  Find D = E <sup>-1</sup> (mod ( <i>P-1</i> ) ( <i>Q-1</i> )). <br>  To encrypt a message, M is raised to the power of E modulo N. To decrypt the cryptotext C to the power of D along the same modulus N. All crypto-primitive is ready.  We take and use, right?  In fact, not so.  The thing is that this is really nothing more than a crypto-primitive and in the real world everything is a bit more complicated. <br><a name="habracut"></a><br><h4>  A bit of theory </h4><br>  In order to understand why it is extremely not recommended to use RSA in its most simple form, we first note the following requirement put forward to asymmetric cryptosystems. <br>  <b>Requirement 1:</b> <br>  A modern asymmetric cryptosystem can (but this is not a fact) be considered resistant if an attacker, having two plaintext M <sub>1</sub> and M <sub>2</sub> , as well as one ciphertext C <sub>b</sub> , with a probability greater than 0.5, cannot determine which of the two plaintext ciphertext C <sub>b</sub> . <br>  See if RSA meets this requirement.  So let's imagine the attacker Malory listens to Alice and Bob's correspondence.  On one wonderful day for himself, he sees that Bob, in the clear, asked Alice a very important question, knowing which answer would enrich, well, or at least immensely amuse Malori‚Äôs curiosity.  Alice monosyllabically answers Bob to this personal question.  She encrypts her response with Bob‚Äôs public key and sends a ciphertext.  Further, Malory intercepts the ciphertext and suspects that either "Yes" or "No" is encrypted in it.  All he now needs to do in order to find out Alice‚Äôs answer is to encrypt the word ‚ÄúYes‚Äù with Bob‚Äôs public key and if the received cryptotext matches the intercepted, it means that Alice answered ‚ÄúYes‚Äù, otherwise the attacker will understand that it was no. <br><br>  As can be seen from this, let the somewhat contrived, but still not so utopian example, RSA is not as reliable as it is considered to be.  Yes, of course, we can say that Alice is a fool herself and no one asked her to answer such a serious question for her in monosyllables.  So now to prohibit the use of monosyllabic answers in cryptography?  Of course not.  Everything is not so bad, it is enough that the algorithm adds some random information to the text that it would be impossible to predict and insidious Mallory will be powerless.  Indeed, in fact, he cannot predict that the answer ‚ÄúYes‚Äù after processing by the algorithm will turn, for example, into ‚ÄúYes4FE6DA54‚Äù, and therefore he will not be able to encrypt this message and will have nothing to compare with the intercepted cryptotext. <br><br>  Thus, we can already say that RSA in all its manifestations, whether it be PGP or SSL, does not encrypt only the data sent to the encryption function.  The algorithm first adds to this data blocks containing a random set of bits.  And only after that the result is encrypted.  Those.  instead of the usual <br>  C = M <sup>E</sup> (mod <i>N</i> ) <br>  we get closer to reality <br>  C = (M || Rand) <sup>E</sup> (mod <i>N</i> ), <br>  where rand is a random number. <br>  This technique is called add-on schemes.  Currently, using RSA without add-on schemes is not so much a bad tone as a direct violation of <a href="http://www.rsa.com/rsalabs/node.asp%3Fid%3D2125">standards</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But that's not all.  It is believed that even if a crypto system satisfies the requirement formulated above, this does not prove its suitability for practical purposes.  We formulate another requirement for the stability of an asymmetric algorithm. <br><br>  <b>Requirement 2:</b> <br>  Let the malefactor have access to the decoding "black box".  Those.  Any cryptotext at the request of the attacker can be decrypted.  Next, the attacker creates two clear text M <sub>1</sub> and M <sub>2</sub> .  One of these texts is encrypted and the resulting cryptotext C <sub>b is</sub> returned to the attacker.  The task of the attacker to guess with a probability greater than 0.5 which of the messages M <sub>1</sub> and M <sub>2</sub> corresponds to the cryptotext C <sub>b</sub> .  At the same time, he may ask to decrypt any message, except C <sub>b</sub> (otherwise the game does not make sense).  It is said that a cryptosystem is resistant, if an attacker, even in such excellent conditions, cannot indicate to which source text C <sub>b</sub> corresponds with a probability greater than 0.5. <br><br>  In the light of the above, let's see how things are in RSA. <br>  So, the attacker has two messages M <sub>1</sub> and M <sub>2</sub> .  And also cryptotext <br>  C <sub>b</sub> = M <sub>1</sub> <sup>E</sup> (mod <i>N</i> ). <br>  He needs to specify which of the two texts corresponds to C <sub>b</sub> .  To do this, he can do the following.  Knowing the public key E, he can create a message <br>  C '= 2 <sup>E</sup> * C <sub>b</sub> (mod <i>N</i> ). <br>  Then he asks the decoding ‚Äúblack box‚Äù to decrypt the message C '.  And then simple arithmetic to help him.  We have: <br>  M '= C' <sup>D</sup> (mod <i>N</i> ) = 2 <sup>ED</sup> * M <sub>1</sub> <sup>ED</sup> (mod <i>N</i> ) = 2 * M <sub>1</sub> (mod <i>N</i> ). <br>  Those.  calculating M '/ 2 the attacker will see M <sub>1</sub> .  And this means that he will understand that in our example the message M <sub>1</sub> was encrypted, and therefore we were once again convinced of the unacceptability of using RSA in its naive form in practice. <br><br>  Eliminate this trouble help add-on schemes.  Only now they are being asked not only that the additional information be completely random and unpredictable.  But also the fact that the additional blocks helped to determine whether the ciphertext was obtained as a result of the operation of the encryption function or was modeled by the attacker.  Moreover, if it is detected that the ciphertext is modeled instead of the decrypted data, the attacker will receive a message about the inconsistency of the data with the real cryptotext. <br><br>  It would seem that the implementation of such an add-on scheme is an intractable task, but after all, cryptography already has a ready-made tool for controlling data integrity.  Of course, these are hash functions.  All modern add-on schemes are implemented on the idea of ‚Äã‚Äãusing a hash function as a check for decrypted data for authenticity. <br><br>  In RSA, when signing and encrypting data, two different add-on schemes are used.  The scheme implemented for signing documents is called the RSA-PSS (probabilistic signature scheme) or <i>probabilistic signature scheme.</i>  The scheme used for encryption - RSA-OAEP (Optimal asymmetric encryption padding) or <i>optimized asymmetric encryption complement</i> , using the example of OAEP and consider how message encryption actually happens in RSA. <br><br><h4>  RSA-OAEP </h4><br>  So, to encrypt absolutely any message in RSA-OAEP, the following is done: <br><ol><li>  Two hash functions G (x) and H (x) are selected so that the total length of the results of the hash functions does not exceed the RSA key length. </li><li>  A random string of l is generated.  The length of the string must be equal to the length of the result of the hash function H (x). </li><li>  Message M is divided into blocks of k-bits.  Then, to each received block m, append (nk) zeros.  Where n is the length of the hash function G (x). </li><li>  The following bit set is defined: {m || 0 <sup>(nk)</sup> ‚äïG (l)} || {l‚äïH (m || 0 <sup>(nk)</sup> G (l))} </li><li>  The resulting bits are represented as an integer M <sub>1</sub> </li><li>  Cryptotext receive the formula: C = M <sub>1</sub> <sup>E</sup> (mod <i>N</i> ) </li></ol><br>  The decryption process is as follows: <br><ol><li>  Find M <sub>1</sub> by the formula M <sub>1</sub> = C <sup>D</sup> (mod <i>N</i> ) </li><li>  In the resulting set of bits cut off the left side.  In the sense: the left part is the n left bits of the number M <sub>1</sub> where n is the length of the hash function G (x).  We denote these bits conditionally by T. And note that T = {m || 0 <sup>(nk)</sup> G (l)}.  All other bits are the right side. </li><li>  Find H (T) = H (m || 0 <sup>(nk)</sup> G (l)) </li><li>  Knowing H (T) we get l, since  we know l‚äïH (T) is the right side of the block. </li><li>  Calculating l, we find m from T‚äïG (l) since  T = {m || 0 <sup>(nk)</sup> G (l)} </li><li>  If m ends with (nk) nulls, then the message is encrypted correctly.  If not, this means that the ciphertext is incorrect, and therefore it is most likely forged by an intruder. </li></ol><br><h4>  Conclusion </h4><br>  Those.  RSA is not only exponentiation modulo a large number.  It is also the addition of redundant data allowing for additional protection of your information.  You may ask: why is all this necessary?  Can it really happen that an attacker gets access to a decryption algorithm?  On another occasion, it was somehow said: if any unpleasantness can occur, it will happen.  Only with the use of add-on schemes this will no longer be considered a nuisance. <br><br>  upd: transferred cryptography to the blog. <br>  upd2: <br>  Literature and links: <br>  1. N. Ferguson, B. Schneier "Practical cryptography" <br>  2. N. Smart "Cryptography" <br>  3. <a href="">RSA-OAEP specification (pdf)</a> </div><p>Source: <a href="https://habr.com/ru/post/99376/">https://habr.com/ru/post/99376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../99368/index.html">On Monday, Valve released a new free (!) Game Alien Swarm</a></li>
<li><a href="../99369/index.html">Overview of the Chinese UMPC Gome FlyTouch</a></li>
<li><a href="../99371/index.html">We create PivotViewer site content in 10 minutes using the example of Habrahabr</a></li>
<li><a href="../99373/index.html">Making lines of multiple parts</a></li>
<li><a href="../99375/index.html">Facts and Errors of Professional Programming</a></li>
<li><a href="../99377/index.html">SSH access organization by one-time passwords</a></li>
<li><a href="../99380/index.html">The first 100 GB Blu-ray discs coming soon</a></li>
<li><a href="../99385/index.html">Two stories about bank cards</a></li>
<li><a href="../99387/index.html">A detailed review of Alien Swarm - free cooperative shooter from Valve</a></li>
<li><a href="../99388/index.html">Canon DM-2400CR. Electronic Notebook. Dreams of the nineties</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>