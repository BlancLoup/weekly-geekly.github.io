<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Geek competition: how we did it (part 2) and the results</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As promised in the first part , we tell in more detail about our project, about successful and unsuccessful solutions, problems and unexpected surpris...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Geek competition: how we did it (part 2) and the results</h1><div class="post__text post__text-html js-mediator-article">  As promised in the <a href="http://habrahabr.ru/company/mailru/blog/240195/">first part</a> , we tell in more detail about our project, about successful and unsuccessful solutions, problems and unexpected surprises. <br><br> <a href="http://habrahabr.ru/company/mailru/blog/241995/"><img src="https://habrastorage.org/files/5d8/d7b/e2a/5d8d7be2a9874ed384f6d2a82e0f7a4b.JPG"></a> <br><br>  We begin, perhaps, with the printer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Printer </h1>  For obvious reasons, the printer is a critical node of our project, so we approached its choice with particular care.  After going through about 15 different models, we stopped on an HP Officejet Pro X451dw inkjet printer with duplex printing capability (that is, on both sides of the paper).  Its competitive advantage is also high printing speed, a large 500-sheet tray (with the ability to purchase one more for the same amount) and a fairly large height, on which the output window for printed sheets is located. <br><a name="habracut"></a><br><img src="https://habrastorage.org/files/864/91b/69d/86491b69d5bd49f8b39eed1060582199.jpg"><br><br>  We removed the plastic stand for the printed sheets (it is mounted on the latches), and we had a fairly good height difference.  This allowed us to use the force of gravity (‚ÄúUse force, Luke!‚Äù), Under the action of which tickets slid down along the tray at the angle.  At the same time I did not have to produce extra travolators to push the sheet inside the tray. <br><br>  When we brought the printer, we happily opened the box (I don‚Äôt know how you like it, but I like the smell of the new technology!) And started setting it up.  The first test went to ‚ÄúHurray‚Äù, the printer printed our test tickets regularly.  However, when more thorough testing began, it turned out that duplex printing only works on A4 paper.  And our ticket format was A5 (after all, we care about the environment and don‚Äôt want to waste too much paper).  That is, A5 tickets were printed face down.  We already started to think about how to place the camera below, but after a couple of days we found a wonderful driver for UNIX (we will tell about the server below) and did teach him to print in duplex. <br><br>  In general, the printer showed itself quite well.  About 30,000 tickets were printed, and during all this time the paper jam only happened three times (!). <br><br><h1>  Arduino, servos and sensors </h1>  For the project, two sets of Arduino Uno, Troyka Shield, servos, displays, sensors and other trifles were purchased.  In the original version, the Arduino wiring diagram looked like this: <br><br><img src="https://habrastorage.org/files/c38/4fc/145/c384fc14583f47138d7578444b9ba0d8.jpg"><br><br>  The first Arduino was responsible for opening and closing the tray.  The second is for receiving information from the gradient sensor (later another sensor appeared - the ultrasonic range finder), and outputting this information to the screen.  The quick assembly showed that there shouldn't be any problems, the engine was spinning regularly, test information was displayed on the screen. <br><br><img src="https://habrastorage.org/files/d18/a01/a19/d18a01a196254550ac60fd1e79bfe2dc.jpg"><br><br>  <a href="http://amperka.ru/product/analog-line-sensor">The analog</a> line <a href="http://amperka.ru/product/analog-line-sensor">sensor</a> gave us very well the data on the level of illumination on the test gradient: <br><br><img src="https://habrastorage.org/files/c5e/fc2/a43/c5efc2a43f7b45e3a6a61329a18569a2.png"><br><br>  We placed the gradient on the side of the urn, and above it secured the line sensor: <br><br><img src="https://habrastorage.org/files/ff2/6df/a43/ff26dfa439ac43ecac99a9a9477e50b3.png"><br><br>  Another sensor connected to the Arduino is an infrared <a href="http://amperka.ru/product/infrared-sensor-switch">obstruction sensor</a> .  It is located on the top lid of the tray, under it, a special hole is cut in the bottom wall of the tray.  Its task is to notify the server that the ticket printed out and fell into the tray: <br><br><img src="https://habrastorage.org/files/bdf/e5c/e5a/bdfe5ce5afb448eea9a7351c42f2041c.png"><br><br>  As soon as the ticket falls into the tray, the sensor sends a signal to the Arduino, which in turn sends it to the server, and that one starts recording the camera.  After a few seconds, the camera turns off and power is applied to the servo, which opens the "curtain".  The curtain we made from the elements of <a href="http://amperka.ru/product/makeblock-starter-robot-kit">Makeblock</a> . <br><br><img src="https://habrastorage.org/files/8d0/bc9/990/8d0bc999020749679d8f2d1508e0bf08.png"><br><br>  The third sensor connected to the Arduino is the ultrasonic <a href="http://amperka.ru/product/hc-sr04-ultrasonic-sensor-distance-module">range finder</a> .  It measures the distance between the bottom of the urn and the floor, is an additional source of information for calculating the weight.  After the final assembly, we did not hide the arduinks in the nightstand, but placed them behind a transparent tray so that the colored wires and flashing LEDs would please the eyes of geek-porn fans (and we work a lot in the company). <br><br><img src="https://habrastorage.org/files/08a/589/6d9/08a5896d99534a7d8ecd52b01b5857a0.png"><br><br><h1>  Tray </h1>  Another crucial place for our design is the tray.  A printed competitive ticket gets into it, and it was necessary to make the tray so that the ticket did not turn over, fell exactly under the camera and did not get stuck.  The first prototype, glued with a glue gun made of plexiglass scraps, looked like this: <br><br><img src="https://habrastorage.org/files/5a6/cc1/643/5a6cc16432b04711aef8a43feb35c2d1.png"><br><br>  After we more or less selected the dimensions, the location of the camera, the sensors and the servo with a curtain, we made a drawing and cut out all the details with a laser cutter (thanks to the guys from <a href="http://lab3dprint.ru/">lab3dprint.ru</a> ).  The parts were glued together with dichloroethane (in no case could we allow cracks and irregularities when gluing), and the result was a more decent design with smooth seams: <br><br><img src="https://habrastorage.org/files/bd8/e46/e6a/bd8e46e6a9c04c21a4e0174eae66f6f7.png"><br><br>  However, even despite the hole under the obstacle sensor, the paper sheet was often stuck (stuck to the Plexiglas), and the force of attraction was not so high as to overcome the force of friction. <br><br>  To reduce the area of ‚Äã‚Äãcontact with the surface of the tray, we pulled the badminton strings: <br><br><img src="https://habrastorage.org/files/45a/4fe/be6/45a4febe62e6437eb0e5d7ef0463a6ff.png"><br><br>  However, this did not help much either, the ticket stubbornly stuck on the last leg and did not even reach the curtain.  Then we went even further, and attached the bottom of the servo with a plastic six-petal gear, which begins to rotate immediately after the curtain opens: <br><br><img src="https://habrastorage.org/files/304/667/390/30466739033d43348c65328968cc4694.png"><br><br>  Such a ‚Äúpushing‚Äù of the ticket from the bottom solved the problem, and now the tickets slid off with a whistle.  We breathed a sigh of relief and switched to the ballot box. <br><br><h1>  Urn </h1>  As you probably already guessed, we have an urn, too, is not the simplest element of the design.  After all, we are not looking for easy ways, and decided to measure the weight not with ordinary weights (although in the very first version of the design we thought lazily about weights with Wi-Fi), but to do it with the help of two sensors that have already been written above.  And in order for these sensors to measure the dynamics of weight changes, we had to hang the ballot box on the springs.  For the test construction, we found a metal frame from an old bedside table, made a wooden box of plywood and hung it on springs from the VAZ 2101 clutch pedal: <br><br><img src="https://habrastorage.org/files/739/df4/7d0/739df47d00e04807831ebec5fc3993ee.png"><br><br>  Do not worry, not a single "Zhiguli" was hurt, all the springs were bought in the auto parts store.  :) Measurements of the estimated weight of competitive tickets, spring stretch coefficients, basket volume and other parameters showed that the design should be much larger and the springs should be more powerful: <br><br><img src="https://habrastorage.org/files/98e/f42/a19/98ef42a198b84a8c8fc65df8f992338c.png"><br><br>  The second version of the urn and frame looks like this: <br><br><img src="https://habrastorage.org/files/023/929/0cc/0239290cca4c4ca589e515da716d593a.png"><br><br><img src="https://habrastorage.org/files/709/b82/705/709b827053c74cacac75c1761e8ceff1.png"><br><br>  The urn was assembled from exhibition aluminum profiles and plexiglass, and the frame from structures known in the market as ‚ÄúJoker Uno‚Äù.  More powerful springs were purchased in the construction market, with holders we connected them with flexible metal cables: <br><br><img src="https://habrastorage.org/files/5fd/f86/676/5fdf866762b8445484450987b97a99cc.png"><br><br>  So that the frame with the urn is not accidentally moved relative to the printer, we decided to add a special nightstand for the printer to the design, as a result, everything began to look like this: <br><br><img src="https://habrastorage.org/files/023/61e/370/02361e37070e46129a3954e8e9a77103.png"><br><br><h1>  Server part </h1>  In parallel with the hardware, we worked on the "brains".  And the special script written for UNIX became the brain of our entire system.  Its task includes: <br><ol><li>  Getting data from Habr. </li><li>  Formation of the ticket of the participant on the basis of this data. </li><li>  The seal. </li><li>  Data exchange with Arduino. </li><li>  Video recording. </li><li>  Sending video to Habr. </li><li>  Trouble alert. </li></ol> <br>  For convenience, we organized the script management via SSH access, this is how the project management panel looks like: <br><br><img src="https://habrastorage.org/files/f00/271/895/f00271895ba642aa87c56865d882baa1.jpg"><br><br>  Data is transmitted in batches of 10 entries.  After the information is received, the script launches the assembly of the PDF file for the first ticket, where it inserts the avatar, nickname, surname and name of the participant, as well as his karma and rating.  The generated PDF is sent to the printer, and the waiting for the signal from the infrared obstacle sensor is triggered.  As soon as the ticket is printed and comes into view of the sensor: <br><br><img src="https://habrastorage.org/files/798/3de/986/7983de986f2e4cba898208634c39a7dc.png"><br><br>  (we tested, of course, on our most favorite Habr users) <br><br>  ... starts recording from the camera located above the tray.  After the recording is made, one of 30 video messages from Anatoly Wasserman is attached to it, and the file is put into the outbox daddy.  The next time you access the Habr server, it will take these recorded videos.  Next, we open the curtain and wait for the ticket to fall into the ballot box.  As soon as the infrared sensor stops seeing the ticket, we recalculate the weight and start printing the next ticket. <br><br>  If all the tickets received from Habr have already been printed, then we change the status to ‚Äú0‚Äù, which means that we are ready to accept a new batch of data.  Along the way, the script checks the camera, the printer and the Arduino for errors, and if suddenly there is something wrong with some of the devices, we will receive an SMS notification (you can't make the contestants wait!). <br><br><h1>  Project support </h1>  Probably, many of you are familiar with this feeling, when the project is launched and there is no longer any desire to work on it - all the most tasty things have already been passed, everything is working, and I want to switch to new tasks.  And then some users are calling and want to fix it, or is it ... <br><br>  Honestly, we are no exception.  The project lasted 45 days, and during this time, our adrenaline enthusiasm after the launch gradually changed to a slight apathy.  Nevertheless, we regularly monitored the project, and if the server sent us an SMS, we honestly connected via SSH and watched what happened there.  Sometimes it was necessary to simply restart the script, sometimes call the guard to feed the printer with paper (after hours security service performed this honorable mission, thank you so much!), Sometimes go down and pull out the stuck ticket or replace the cartridge.  Sometimes an alarming SMS caught up with us in the most unexpected places, for example, in a fitness center: <br><br><img src="https://habrastorage.org/files/b21/995/515/b219955154e14ed485fd1a80721c6ee2.jpg"><br><br>  Or driving: <br><br><img src="https://habrastorage.org/files/14b/bf7/2ca/14bbf72cab124ae4bd80061dc5b889ba.jpg"><br><br>  But now, when the project is finished, it is impossible not to admit that it was one of the most interesting in our life, and our hands are itching again to come up with something more fun!  Thanks to all of you who are not indifferent to the project and have taken part in our competition.  ;) <br><br><h1>  And now, under the crash of the drums, the list of winners of our geek contest! </h1><table><tbody><tr><th>  Prize </th><th>  Winner </th></tr><tr><td>  A laptop </td><td>  @Noizefan </td></tr><tr><td>  A laptop </td><td>  @yongchunlaohu </td></tr><tr><td>  A laptop </td><td>  @akkNightmare </td></tr><tr><td>  Samsung Galaxy S5 </td><td>  @alexeyfdv </td></tr><tr><td>  Samsung Galaxy S5 </td><td>  @Malevolent </td></tr><tr><td>  Samsung Galaxy S5 </td><td>  @BVYU </td></tr><tr><td>  Google nexus 7 </td><td>  @iusfof </td></tr><tr><td>  Google nexus 7 </td><td>  @ zolt85 </td></tr><tr><td>  Google nexus 7 </td><td>  @rmq </td></tr><tr><td>  Google nexus 7 </td><td>  @mrise </td></tr><tr><td>  Google nexus 7 </td><td>  @TomashUA </td></tr><tr><td>  Jawbone </td><td>  @thepry </td></tr><tr><td>  Jawbone </td><td>  @zloi_ezhik </td></tr><tr><td>  Jawbone </td><td>  @msdrSoul </td></tr><tr><td>  Jawbone </td><td>  @SCIF </td></tr><tr><td>  Jawbone </td><td>  @ sveta0203 </td></tr><tr><td>  Leap Motion </td><td>  @ MrMeowington5 </td></tr><tr><td>  Leap Motion </td><td>  @jackee </td></tr><tr><td>  Leap Motion </td><td>  @Feanrez </td></tr><tr><td>  Leap Motion </td><td>  @verbaux </td></tr><tr><td>  Leap Motion </td><td>  @WizardOfRain </td></tr><tr><td>  Leap Motion </td><td>  @usupport </td></tr><tr><td>  Backpack </td><td>  @koltira </td></tr><tr><td>  Backpack </td><td>  @ldinc </td></tr><tr><td>  Backpack </td><td>  @Mikele </td></tr><tr><td>  Backpack </td><td>  @ Kag0r </td></tr><tr><td>  Backpack </td><td>  @shtepochka </td></tr><tr><td>  Backpack </td><td>  @julievstout </td></tr><tr><td>  T-shirt </td><td>  @SquareLemon </td></tr><tr><td>  T-shirt </td><td>  @homm </td></tr><tr><td>  T-shirt </td><td>  @Natasha_Tolstova </td></tr><tr><td>  T-shirt </td><td>  @Allesad </td></tr><tr><td>  T-shirt </td><td>  @pettson </td></tr><tr><td>  T-shirt </td><td>  @alex_trueman </td></tr><tr><td>  T-shirt </td><td>  @Gustychg </td></tr><tr><td>  T-shirt </td><td>  @SergMerlin </td></tr><tr><td>  T-shirt </td><td>  @gyok </td></tr><tr><td>  T-shirt </td><td>  @ graycat660 </td></tr></tbody></table>  There were a lot of tickets, and we decided to pour them into the inflatable pool.  Every ticket had to literally dive. <br><br><img src="https://habrastorage.org/files/22e/c5b/82d/22ec5b82d2204c8caf60ab1cf360f983.jpg"><br><br><img src="https://habrastorage.org/files/01d/5b2/b22/01d5b2b22aec4fa297c0038ead5b7ab8.jpg"><br><br><img src="https://habrastorage.org/files/98e/7c2/a46/98e7c2a46ddd46d6803c8303108a22f8.jpg"><br><br><img src="https://habrastorage.org/files/dfa/5e3/ef0/dfa5e3ef0a49441ba123e2ba7455804d.jpg"><br><br><img src="https://habrastorage.org/files/1c0/ade/b3c/1c0adeb3c5a04fe189edaafc58424585.jpg"><br><br><img src="https://habrastorage.org/files/ee0/fc6/ed8/ee0fc6ed8c5142558958b01d87abb460.jpg"></div><p>Source: <a href="https://habr.com/ru/post/241995/">https://habr.com/ru/post/241995/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241981/index.html">Backup storage overview ExaGrid EX21000E - test with Veeam Backup & Replication</a></li>
<li><a href="../241983/index.html">jQuery 3.0: future generations</a></li>
<li><a href="../241985/index.html">A new video service for learning English by excerpts from the TV series</a></li>
<li><a href="../241989/index.html">Welcome to CocoaHeads Moscow October 31</a></li>
<li><a href="../241993/index.html">#DevNightMinsk</a></li>
<li><a href="../242001/index.html">Working with Virtual Private Cloud API: Console Clients</a></li>
<li><a href="../242003/index.html">No safety concerns.</a></li>
<li><a href="../242005/index.html">Skype for Mac got support for OS X Yosemite</a></li>
<li><a href="../242007/index.html">Hackspace in the capital of China, what is it?</a></li>
<li><a href="../242009/index.html">Flexible graphing in JavaFX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>