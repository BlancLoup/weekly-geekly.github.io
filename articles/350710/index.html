<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigate the minor features of C # 7</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="C # 7 adds a number of new features and focuses on data consumption, simplifying code and performance. The biggest features have already been consider...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Investigate the minor features of C # 7</h1><div class="post__text post__text-html js-mediator-article">  C # 7 adds a number of new features and focuses on data consumption, simplifying code and performance.  The biggest features have already been considered - <a href="https://habrahabr.ru/post/345376/">tuples</a> , <a href="https://habrahabr.ru/post/346174/">local functions</a> , <a href="https://habrahabr.ru/post/347916/">pattern matching</a> and <a href="https://habrahabr.ru/post/348658/">throw expressions</a> .  But there are other new opportunities, both large and small.  All of them are combined to make the code more efficient and understandable so that everyone will be happy and productive. <br><br>  Let's look at the other features of the new version of C #.  So!  Let's start! <a name="habracut"></a><br><br><h2>  <b>Out variables</b> </h2><br>  Currently, in C #, using <b>out parameters is</b> not as flexible as we would like.  Before calling a method with <b>out</b> parameters, you first need to declare the variables to pass to the method.  Since usually these variables are not initialized (since they will be rewritten by the method), you cannot use <b>var</b> to declare them, therefore you must specify the full type: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrintCoordinates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Point p</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x, y; <span class="hljs-comment"><span class="hljs-comment">// have to "predeclare" p.GetCoordinates(out x, out y); WriteLine($"({x}, {y})"); }</span></span></code> </pre> <br>  In C # 7, <b>out variables</b> are entered.  They allow you to declare variables right on the spot where they are passed as <b>out arguments</b> : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrintCoordinates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Point p</span></span></span><span class="hljs-function">)</span></span> { p.GetCoordinates(<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y); WriteLine(<span class="hljs-string"><span class="hljs-string">$"(</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{x}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{y}</span></span></span><span class="hljs-string">)"</span></span>); }</code> </pre> <br>  <b>Notice that the variables rise to the outer scope in the closing block, so the subsequent line can use them.</b> <br><br>  Since <b>out variables</b> are declared directly as arguments to <b>out</b> parameters, the compiler can infer their type (if there are no conflicting overloads), so you can use <b>var</b> instead of type when declaring: <br><br><pre> <code class="cs hljs">p.GetCoordinates(<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y);</code> </pre> <br>  Typically, <b>out parameters</b> are used in <b>Try ...</b> patterns, where a logical return value indicates success, and <b>out</b> parameters carry the results obtained: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrintStars</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.TryParse(s, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i)) { WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(<span class="hljs-string"><span class="hljs-string">'*'</span></span>, i)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { WriteLine(<span class="hljs-string"><span class="hljs-string">"Cloudy - no stars tonight!"</span></span>); } }</code> </pre> <br>  You can also use ‚Äú <b>wildcards</b> ‚Äù in <b>out</b> parameters in the form of <b>_</b> to ignore <b>out</b> parameters that are not needed: <br><br><pre> <code class="cs hljs">p.GetCoordinates(<span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> _); <span class="hljs-comment"><span class="hljs-comment">// I only care about x</span></span></code> </pre> <br>  Please note that you can omit the type declaration with ‚Äú <b>wildcards</b> ‚Äù. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> inputDate = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DateTime.TryParse(inputDate, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> DateTime dt)) { <span class="hljs-comment"><span class="hljs-comment">//  dt }</span></span></code> </pre> <br>  The question is, what if the conversion of a string to a <b>DateTime</b> variable is unsuccessful, and we still try to use the output value? <br><br>  The variable will <b>have a default value</b> . <br><br><h2>  <b>Literal improvements</b> </h2><br>  C # 7 allows you to use the ‚Äú <b>_</b> ‚Äù character as a delimiter of digits inside numeric literals: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-number"><span class="hljs-number">123</span></span>_456; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0xAB</span></span>_CD_EF;</code> </pre> <br>  You can put this character anywhere between the numbers just as many times as necessary to improve readability.  It does not affect the value. <br><br>  The separator can be used with the types <b>byte</b> , <b>int</b> , <b>long</b> , <b>decimal</b> , <b>float</b> and <b>double</b> : <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> BillionsAndBillions = <span class="hljs-number"><span class="hljs-number">100</span></span>_000_000_000; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> AvogadroConstant = <span class="hljs-number"><span class="hljs-number">6.022</span></span>_140_857_747_474e23; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> GoldenRatio = <span class="hljs-number"><span class="hljs-number">1.618</span></span>_033_988_749_894_848_204_586_834_365_638_117_720_309_179M;</code> </pre> <br>  In addition, C # 7 presents <b>binary literals</b> .  Now you can write the number in binary form. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = <span class="hljs-number"><span class="hljs-number">0b101010111100110111101111</span></span>;</code> </pre> <br>  <b>0b</b> at the beginning of a constant means that the number is written in binary format. <br><br>  You can also use the delimiter character, which will undoubtedly improve the readability of the literal. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = <span class="hljs-number"><span class="hljs-number">0b1010</span></span>_1011_1100_1101_1110_1111;</code> </pre> <br>  Discharge separator cannot stand at the end or at the beginning of a literal <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> a = <span class="hljs-number"><span class="hljs-number">0b</span></span>_0000_0001; <span class="hljs-comment"><span class="hljs-comment">//INVALID: Digit separator cannot be at the start or end of the value byte b = 0b1_0000_0001; //INVALID: 257 doesn't fit in a byte byte c = 0b0_0000_0001; //VALID: 1 fits into a byte just fine</span></span></code> </pre> <br><h2>  <b>Ref returns and locals</b> </h2><br>  Just as you can pass method parameters by reference (with the <b>ref</b> modifier), you can now also return them by reference, and also save them by reference in local variables. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">ref</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Find</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> number, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] numbers</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; numbers.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numbers[i] == number) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> numbers[i]; <span class="hljs-comment"><span class="hljs-comment">// return the storage location, not the value } } throw new IndexOutOfRangeException($"{nameof(number)} not found"); } int[] array = { 1, 15, -39, 0, 7, 14, -12 }; ref int place = ref Find(7, array); // aliases 7's place in the array place = 9; // replaces 7 with 9 in the array WriteLine(array[4]); // prints 9</span></span></code> </pre> <br>  This is useful for returning specific fields from large data structures.  For example, a game may contain its data in a large pre-distributed array of structures (to avoid pauses when garbage collection).  Now methods can return a link directly to a structure through which the caller can read and modify it. <br><br>  There are some security restrictions: <br><br><ul><li>  You can only return links that are ‚Äúsafe to return‚Äù: only those that were given to you, and those that point to fields in objects </li><li>  Local <b>ref</b> variables are initialized at a specific storage location and cannot be changed to point to another </li></ul><br><h2>  <b>Returned generic types in async methods</b> </h2><br>  Until now, <b>async</b> methods in C # must either return <b>void</b> , <b>Task</b> or <b>Task ‚ÄπT‚Ä∫</b> .  C # 7 allows you to define other types in such a way that they can be returned from the asynchronous method.  The return type must still match the asynchronous pattern, which means that the <b>GetAwaiter</b> method must be available.  A concrete example: a new type <b>ValueTask has been</b> added to the .NET Framework, allowing to use this new language feature <br><br>  Since <b>Task</b> and <b>Task ‚ÄπT</b> are reference types, allocating memory in performance-affecting segments (especially when allocating memory in limited cycles) can seriously degrade performance.  Support for generic types of return values ‚Äã‚Äãallows you to return a small significant type instead of a reference type, thereby preventing excessive memory allocation. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Random rnd; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">$"You rolled </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{GetDiceRoll().Result}</span></span></span><span class="hljs-string">"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> ValueTask </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDiceRoll</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"...Shaking the dice..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> roll1 = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Roll(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> roll2 = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Roll(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> roll1 + roll2; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> ValueTask </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Roll</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rnd == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) rnd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Task.Delay(<span class="hljs-number"><span class="hljs-number">500</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> diceRoll = rnd.Next(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> diceRoll; } }</code> </pre> <br><h2>  <b>Conclusion</b> </h2><br>  Use the new features of C #, because they facilitate development, save time and increase the readability of the code.  This article ends the series of articles on the C # 7 version.  All questions of interest, please in the comments or in a personal.  I will answer you for sure.  Thanks to all! </div><p>Source: <a href="https://habr.com/ru/post/350710/">https://habr.com/ru/post/350710/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350696/index.html">Notes for the source editor (development environment)</a></li>
<li><a href="../350698/index.html">400 thousand servers may be subject to RCE attacks due to a vulnerability in the Exim mail agent</a></li>
<li><a href="../350700/index.html">The girls and the fourth industrial revolution</a></li>
<li><a href="../350702/index.html">A couple of tips for beginners gamedeveloper from novice gamedeveloper</a></li>
<li><a href="../350708/index.html">Containers of the introduction of dependencies and the benefits of their use</a></li>
<li><a href="../350712/index.html">FastTrack Training. "Network Basics". "Basics of routing." Eddie Martin December 2012</a></li>
<li><a href="../350716/index.html">Rust: why do we need macros</a></li>
<li><a href="../350718/index.html">We generate levels for the game using neural networks</a></li>
<li><a href="../350720/index.html">[Not only to students] Packet Tracer Lab</a></li>
<li><a href="../350724/index.html">Germicidal emitters for smartphones. Prospects for the integration of these systems in gadgets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>