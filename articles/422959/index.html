<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Building the server: from ordering components to testing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What happens when our client orders an arbitrary configuration server? How reliable are tailor-made servers? Today we will discuss these and other iss...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Building the server: from ordering components to testing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/vz/po/aj/vzpoajgrkuxm4dals7stn1cid3a.png"><br><br>  What happens when our client orders an arbitrary configuration server?  How reliable are tailor-made servers?  Today we will discuss these and other issues in detail in a new article. <br><a name="habracut"></a><br><h2>  Server order </h2><br>  Despite the fact that there are several dozens of different configurations in the section available for ordering servers, some clients require special configuration servers.  Most often this is necessary to create a server with very high performance or with a large number of disk drives. <br><br>  In order to satisfy such a need, the service ‚Äú <a href="https://selectel.ru/services/dedicated/configurator/">Dedicated server of arbitrary configuration</a> ‚Äù was provided.  The configurator on the site allows you to create a server of any complexity and rent it in a couple of minutes.  However, few people think exactly how these servers are going. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After the client has decided on the desired configuration, placed an order and paid for it, the system automatically creates a ticket in the control panel.  Such a ticket goes to the assembly department, and the experts proceed to checking the order and, in fact, the server assembly itself. <br><br><h2>  Assembly process </h2><br><h3>  Order check </h3><br>  The configurator on the site most often chooses the ‚Äúcorrect‚Äù version of the components, but in some cases, customers may not choose the most optimal variant of the combination of hardware components.  For example, a RAID controller that will not be able to deliver maximum performance in such a configuration, or an odd number of rails of RAM in multiprocessor systems.  Therefore, the engineers first check the order and in the event of identifying potential problems, they will necessarily warn the customer on the ticket. <br><br>  If the client agrees that the configuration is not optimal, you can easily cancel the order and create a new one.  The cash on cancellation is returned to the balance of the control panel in full.  After the order is checked, we proceed to the preparation of components and server assembly. <br><br><h3>  Accessories </h3><br>  Each server consists of the following components: <br><br><ul><li>  <strong>housing</strong> (comes immediately with the power supply); </li><li>  <strong>motherboard</strong> ; </li><li>  <strong>random access memory</strong> ; </li><li>  <strong>processors</strong> ; </li><li>  <strong>drives</strong> ; </li><li>  <strong>disk controllers</strong> (if there is an order); </li><li>  <strong>video cards</strong> (if there is an order). </li></ul><br>  The engineer responsible for the assembly prepares all the components and records them in the accounting system, using the serial numbers as identifiers.  Now we will tell about all the stages that each server of an arbitrary configuration goes through. <br><br><h3>  Body preparation </h3><br>  We usually use Supermicro cases, which should be prepared for the installation of the motherboard with the help of the hardware supplied.  Different models of motherboards have different attachment points, so the number of hardware and bolts for each specific assembly should be determined. <br><br>  While the number of orders was small, we simply took a set of fasteners designed for the hull, and unused fasteners were put off.  At a certain point, it became clear that a very long time was being spent on finding the right bolt, and we decided to put up all the fasteners that were in stock. <br><br><img src="https://habrastorage.org/webt/d9/o5/va/d9o5vamvskb0khqhbllwgoarokc.png">  <i><sup>Prepackaged fasteners</sup></i> <br><br>  After the last package with fasteners was packaged, it became clear that we had not done this work in vain.  Now every bolt and every hardware lies in a place strictly designated for this, and this saves a tremendous amount of time. <br><br>  To ensure that the contacts of the motherboard are not in contact with the metal case and there is no short circuit, use a special plastic layer.  Without it, the assembly is prohibited.  In addition, it is necessary to carefully break out (yes, this is provided by the manufacturer) the holes for the ports in the stub from the back of the server.  Performed elementary with a flat screwdriver. <br><br>  After that, stickers with the order identifier are applied to the case, as well as the serial number of the future server.  For convenience, in addition to the alphanumeric identifier on the label contains bar codes that allow you to quickly read the information using a scanner. <br><br><h3>  Motherboard installation </h3><br>  Immediately before installing the motherboard, engineers perform some preparatory actions: <br><br><ul><li>  wear thin gloves; </li><li>  put on a grounding bracelet. </li></ul><br>  First of all, it is necessary not to hurt your hands.  The most frequent injury is cuts.  The grounding bracelet will not allow accidental damage to the electronic components of the board due to static electricity. <br><br>  After the motherboard has been put in place, the fastening bolts are tightened.  It should be remembered that textolite is quite fragile, and not make excessive efforts.  To save time, engineers use cordless screwdrivers. <br><br>  Now, power cables and cooling fans are connected to the motherboard.  What is important here is that sometimes the length of the cables is longer than necessary, so they are carefully tied down with the help of thin nylon ties.  If it is not possible to fasten the ties to the case, the manufacturer supplies convenient fastening platforms on double-sided tape.  The ends are carefully bite off with side cutters. <br><br>  Then the front panel and backplane are connected using appropriate cables.  Now you can begin to install processors and other elements. <br><br><h3>  Processor installation </h3><br>  This operation is perhaps the most subtle and demanding care.  Just 10 years ago, the processors had comfortable ‚Äúlegs‚Äù, and the sockets were a plastic matrix with holes.  Because of this, it was enough just to gently insert the processor into the socket and close the latch.  Starting with the socket LGA 775 processors have lost the "legs", there were only flat contact pads.  Sockets, on the contrary, now have contacts, but they are so small and fragile that any operation with the installation of the processor must be as accurate as possible. <br><br><img src="https://habrastorage.org/webt/wh/gw/xc/whgwxc2yeg68dvz6297w2icmroa.png">  <i><sup>Modern Socket FCLGA3647</sup></i> <br><br><img src="https://habrastorage.org/webt/av/ki/bb/avkibbdigluvfk4ddwiuopyrtru.png">  <i><sup>Intel Xeon Scalable line processor</sup></i> <br><br>  After the processors are installed in their place comes the turn of the installation of cooling radiators.  As a rule, passive radiators are used, but before that thermal paste is applied - a layer of thermally conductive material separating the processor and radiator.  Most often for this purpose use silicone paste, such as KPT-8. <br><br>  It should be remembered here that the main task of thermal paste is to close microscopic defects both on the surface of the processor and on the surface of the radiator, ensuring the largest contact area.  Therefore, it is applied in a very thin and even layer.  To do this, use either a special spatula, or in the old manner an unnecessary plastic card.  Excess cleaned with cotton swabs. <br><br><h3>  Install RAM </h3><br>  Each manufacturer of motherboards independently determines the correct order of installation of RAM modules, depending on its type and speed.  For Supermicro, this installation procedure is specified in the instructions for each motherboard model.  Nevertheless, there are some fairly universal rules that work in most cases: <br><br><ul><li>  <strong>it is undesirable to use an odd number of slats</strong> (relevant for Intel Xeon processors of the E5 line); </li><li>  <strong>memory should be allocated per channel</strong> so that the system can use all possible modes of control mechanisms; </li><li>  <strong>in one server, it is desirable to use memory with the same latency, voltage and frequency</strong> , in the range supported by the motherboard. </li></ul><br>  Before installation, engineers check that there are no foreign particles of dust or paper in the slots.  If necessary, use compressed air for cleaning. <br><br><h3>  Drive installation </h3><br>  It's simple.  Disk drives are fixed in a standard sled, and then inserted into the server.  If disk controllers or additional network cards were ordered, they are installed in the appropriate PCI-E slots and secured with screws.  After everything is set into place, the assembly department engineer once again checks the conformity of all components to the order and sends the server to the stand for firmware and testing. <br><br><h3>  Cable management </h3><br>  Let's touch on a topic like cable management inside the server.  Here, too, has its own nuances, the main of which is the limited space.  Most servers are designed to take up minimal rack space.  The height of one mounting unit is 43.7 mm.  Because of this, space for cables after installing the motherboard and other peripherals remains quite small. <br><br>  <strong>Fun fact:</strong> one mounting unit in height is exactly equal to one inch (Old Russian unit of length). <br><br>  It should always be borne in mind that the air must pass through the server freely to effectively cool the components.  Any obstacles in its path will worsen heat dissipation and, consequently, increase power consumption due to the increased load on the cooling system.  This is especially important for servers with multiple GPUs, the temperature of which under load reaches 80 degrees. <br><br><img src="https://habrastorage.org/webt/w1/na/zo/w1nazoelnup_oaikwb4yp6nt7v8.png">  <i><sup>The air flow is divided equally between all GPUs.</sup></i> <br><br>  Therefore, all cables are laid so as not to block the path of air passage.  Excess with the help of screeds fixed to the standard eyes, and in case of their absence to the plastic areas with double-sided tape. <br><br><img src="https://habrastorage.org/webt/ue/os/mu/ueosmu6_sodnvya3zjtnc-au7lo.png">  <i><sup>Cables are laid so as not to interfere with the passage of air flow.</sup></i> <br><br><h2>  Firmware components </h2><br>  To begin, let's answer a frequently asked question - why is this necessary?  The answer is simple - this procedure is necessary for all server components to work without errors, as well as to increase the level of security. <br><br>  Most server components are built with the expectation that they can be reprogrammed.  After leaving the assembly line, in the process of testing and operation, in most cases errors and software vulnerabilities are detected.  If the possibility of reprogramming the components were not envisaged, then to eliminate these software problems would have to withdraw all products.  Much cheaper was to create the possibility of replacing the firmware. <br><br><h3>  Flashing IPMI </h3><br>  Remote management module (IPMI / iLO / iDrac) is one of the most important elements of the server.  It is an independent microcomputer that works whenever there is an operating voltage on the motherboard. <br><br>  Even when there are no components in the server, this microcomputer works by performing the task of interpreting and correcting data from the server sensors.  The module is closely connected with all power management subsystems and allows you to perform almost any operation remotely.  Therefore, the issue of security when accessing such a device is very serious.  Timely firmware update allows you to save the module from hacking. <br><br>  Installing the firmware is usually done directly from the web interface, but in some cases it can be done over the network by sending firmware to the module with the appropriate software. <br><br><h3>  Flashing BIOS </h3><br>  The basic I / O system, in addition to the security reasons already listed, requires updating for another important point.  The BIOS firmware contains microcodes for processors supported by the motherboard, as well as microcodes for network interfaces and chipsets.  When a new version of the processor comes out, motherboard manufacturers release new versions of firmware that contain the required microcode.  Without this, the new processor will simply not be able to start. <br><br>  In addition, the release of new firmware prevents conflicts arising from the interaction of various components (both built into the motherboard and third-party devices).  Together with the BIOS firmware, the related modules are often updated, for example, Intel ME (Management Engine). <br><br>  In order not to be unfounded, we give an example.  Take the Supermicro X10SRi / X10DRi / X10DRW motherboards, which support Intel Xeon E5-XXXXv3 processors.  If you put in a processor of the next version E5-XXXXv4, the board starts, however, it will give out strange errors in the failure memory ‚ÄúFailing DIMM‚Äù in different slots.  And the problem here is not at all in the memory, but in the fact that the memory controller is located in the processor.  Therefore, incorrect recognition of the processor by the motherboard leads to the fact that such problems arise.  Re-flashing using a supported processor completely solves this situation. <br><br>  In some cases, hardware manufacturers artificially stop supporting newer motherboard models with older hardware.  A prime example is the Supermicro X11DPi motherboard, which with any BIOS firmware version will <a href="http://download.adaptec.com/pdfs/compatibility_report/sas_hba_cr_01-27-15_series6h_7h.pdf">not work with Adaptec 7th series HBA controllers</a> .  The disk controller is simply not initialized, causing the server to completely hang.  And at the moment this problem has no solution. <br><br><h3>  Flashing Disk Controllers </h3><br>  Errors in the software of important devices such as disk controllers can not only cause trouble, but also become a source of very large problems.  In most cases, the process is very simple, flashing occurs using a native utility built directly into the controller itself. <br><br>  It should be remembered that the old firmware of the disk controller can not only correct errors, but also drastically change the way metadata is stored.  To avoid unpleasant situations and keep the data intact, you should read the list of the changes made to the functionality before performing the flashing.  This information is always present on the site of the equipment manufacturer and is most often duplicated in the archive with the firmware itself. <br><br><h3>  Flashing Network Cards </h3><br>  Equally serious problems that are extremely difficult to diagnose can deliver network cards with errors at the firmware level.  In addition to eliminating errors, network card software can directly affect performance.  So this is another mandatory item for engineers who build servers. <br><br><h3>  Important </h3><br>  I would like to separately note that all the operations for reflashing components are potentially dangerous for the equipment, therefore, they can be made only by qualified specialists.  If you are already our client and have found it necessary to reflash any component of the server, then <strong>in no case do not try to do it yourself</strong> .  Just write to us in the ticket, which component should be reflashed, and this will be done with all the precautions. <br><br><h2>  Testing </h2><br>  Having finished updating the software, the assembly engineer proceeds to load test the assembled server.  Such testing allows you to identify most of the problems before the server is handed over to the client. <br><br><h3>  Memory test </h3><br>  In order to check the performance of all RAM modules installed in the server, a very popular tool called memtester is launched.  Immediately before testing, the assembly engineer checks that all memory modules installed in the server are correctly displayed in the BIOS. <br><br>  When testing is started, the process of reading and writing data into RAM, using a different sequence of data and the order of filling the cells, occurs.  The speed of execution of all tests directly depends on the volume.  Our minimum requirements are one complete test cycle. <br><br>  If the testing process reveals errors, then we are looking for a faulty RAM module and exclude it from the configuration, replacing it with a similar one.  Then the testing process is repeated in its entirety.  Only when all the test iterations are completed without errors, the server is sent for stress testing. <br><br><h3>  CPU and disk test </h3><br>  The load test simulates the maximum server load for at least 6 hours for a server with magnetic drives.  In the case of solid-state drives such a long test can dramatically increase the wear of the drive, therefore, similar testing with a shorter execution time is carried out for them. <br><br>  Load testing for Intel processors is performed using the original Intel IPDT utility (Processor Diagnostic Tool).  This process causes the processor temperature to rise to the maximum allowable operating temperature, and the cooling system must effectively remove all this heat.  Assembly engineers constantly monitor that the server passes this test and the temperature of all components does not exceed the stated operational limits. <br><br>  After testing is complete, the SMART parameters of all installed disks are checked.  If at least one parameter, declared by the manufacturer as a reason for replacing the drive, has a nonzero value, the disk is replaced with another one and is also tested to eliminate the likelihood of problems in the ‚Äúbattle mode‚Äù. <br><br><h2>  Conclusion </h2><br>    ,    ,     ,         ,        .            ,         . <br><br>         .      ?     . </div><p>Source: <a href="https://habr.com/ru/post/422959/">https://habr.com/ru/post/422959/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../422949/index.html">New CNCF Container, Cloud Native and Kubernetes Statistics</a></li>
<li><a href="../422951/index.html">Python interesting and useful. Part 3</a></li>
<li><a href="../422953/index.html">Who said that Flabber is not real: creating a homogeneous thermosetting polymer gel</a></li>
<li><a href="../422955/index.html">Picture in Picture mode in Chrome 69</a></li>
<li><a href="../422957/index.html">Easy money is over: the main trends of the ICO 2018 market</a></li>
<li><a href="../422961/index.html">Sony Xperia Ear Duo Assistant Headset Receives Important Update</a></li>
<li><a href="../422965/index.html">UniSharping: converting C # code to Java and Python</a></li>
<li><a href="../422967/index.html">Habr.com. Transparency report</a></li>
<li><a href="../422969/index.html">Anomaly Frango, Outbreak</a></li>
<li><a href="../422971/index.html">Rails Expert System</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>