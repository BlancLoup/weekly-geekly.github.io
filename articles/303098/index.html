<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a blog on symfony 2.8 lts [Part 5.1]</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! I want to wedge a bit into the cycle of articles and show how you can easily update the list of comments in the feed in real time. How does ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a blog on symfony 2.8 lts [Part 5.1]</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  I want to wedge a bit into the cycle of articles and show how you can easily update the list of comments in the feed in real time.  How does this happen, for example, on github <a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">Navigation in parts of the manual</b> <div class="spoiler_text">  <a href="https://habrahabr.ru/post/301760/">Part 1 - Configuring Symfony2 and Templates</a> <br>  <a href="https://habrahabr.ru/post/302032/">Part 2 - Contact page: validators, forms, and email</a> <br>  <a href="https://habrahabr.ru/post/302438/">Part 3 - Doctrine 2 and Data Fixtures</a> <br>  <a href="https://habrahabr.ru/post/302602/">Part 4 - Comment Model, Repository and Migrations of Doctrine 2</a> <br>  <a href="https://habrahabr.ru/post/303114/">Part 5 - Twig Extensions, Sidebar (sidebar) and Assetic</a> <br>  <a href="https://habrahabr.ru/post/303578/">Part 6 - Modular and Functional Testing</a> <br></div></div><br>  To accomplish this task we will use the <a href="https://github.com/postHawk">Post Hawk</a> service.  The code is available in the corresponding <a href="">branch</a> . <br><br><h3>  Part 1. Installing dependencies (mandatory) </h3><br>  If you have taken branch 5 as a basis, then you need to add a dependency to composer.json: <br><pre><code class="bash hljs">composer require post-hawk/hawk-api-bundle ~1.0</code> </pre> <br>  and if it is 5.1, then simply <br><pre> <code class="bash hljs">composer update</code> </pre><br>  and wait for the install (update) package (s). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Next, install erlang.  Builds for different systems are located <a href="https://www.erlang.org/downloads">here</a> , or, if you wish, you can <a href="http://erlang.org/doc/installation_guide/INSTALL.html">build from source codes</a> . <br><blockquote>  When installing in windows, do not forget to put a tick to add the path to the PATH. </blockquote><br>  Go to any place in the file system, which one you like best (you can be close to the main project) and clone the <a href="https://github.com/postHawk/hawk_server">server</a> and <a href="https://github.com/postHawk/hawk_client">client</a> <br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/postHawk/hawk_client.git git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/postHawk/hawk_server</code> </pre><br>  We collect <a href="https://github.com/rebar/rebar">rebar</a> : <br><pre> <code class="bash hljs">$ git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/rebar/rebar.git $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> rebar $ ./bootstrap</code> </pre><br>  The resulting file (rebar) is copied to both repositories.  We need it to build the project. <br><blockquote>  The project uses version 2 rebar.  Cannot run under rebar3 </blockquote><br>  Go to the folder with the server, collect it and run: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> hawk_server nano src/hawk_server.app.src <span class="hljs-comment"><span class="hljs-comment">#   </span></span></code> </pre><br><pre> <code class="erlang hljs">{env, [ {statistic, [{use, false}]}, user, #{ &lt;&lt;<span class="hljs-string"><span class="hljs-string">"login"</span></span>&gt;&gt; =&gt; &lt;&lt;<span class="hljs-string"><span class="hljs-string">"symblog"</span></span>&gt;&gt;, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"domain"</span></span>&gt;&gt; =&gt; [ <span class="hljs-comment"><span class="hljs-comment">%       &lt;&lt;"127.0.0.1:8000"&gt;&gt; ], &lt;&lt;"key"&gt;&gt; =&gt; &lt;&lt;"very secret key"&gt;&gt; %api .       }} ]}</span></span></code> </pre><br><pre> <code class="bash hljs">mv .erlang .erlang_ rebar get-deps compile mv .erlang_ .erlang erl -name <span class="hljs-string"><span class="hljs-string">'hawk_server@127.0.0.1'</span></span> -boot start_sasl -setcookie <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> -kernel inet_dist_listen_min 9000 inet_dist_listen_max 9005</code> </pre><br><br>  Similarly, build and run the client: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> hawk_client nano src/hawk_client.app.src <span class="hljs-comment"><span class="hljs-comment">#  server_node, , 'test_hawk_server@127.0.0.1'  api_key (   ).  </span></span></code> </pre><br><pre> <code class="erlang hljs">{env, [ {api_key, &lt;&lt;<span class="hljs-string"><span class="hljs-string">"very secret key"</span></span>&gt;&gt;}, {server_node, 'hawk_server@<span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.1</span></span>'} ]}</code> </pre><br><pre> <code class="bash hljs">mv .erlang .erlang_ ./rebar get-deps compile mv .erlang_ .erlang erl -name <span class="hljs-string"><span class="hljs-string">'hawk_client@127.0.0.1'</span></span> -boot start_sasl -setcookie <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> -kernel inet_dist_listen_min 9000 inet_dist_listen_max 9005</code> </pre><br><blockquote>  If you want to run the process in the background, simply add the option <b>-detached</b> to the parameter set <br>  For windows users, the startup utility should be changed from <b>erl</b> to <b>werl</b> </blockquote><br><h3>  Part 2. We are finalizing the blog (mandatory for branch 5) </h3><br><h4>  Bundle configuration: </h4><h4><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//app/AppKernel.php $bundles = array( ... new Hawk\ApiBundle\HawkApiBundle(), new FOS\JsRoutingBundle\FOSJsRoutingBundle(), );</span></span></code> </pre><br><pre> <code class="hljs lua">#app/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>.yml hawk_api: client: host: <span class="hljs-string"><span class="hljs-string">'%hawk_api.client.host%'</span></span> #ip   port: <span class="hljs-string"><span class="hljs-string">'%hawk_api.client.port%'</span></span> #,    key: <span class="hljs-string"><span class="hljs-string">'%hawk_api.client.key%'</span></span></code> </pre><br><pre> <code class="hljs lua">#app/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>/parameters.yml parameters: hawk_api.client.host: <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> hawk_api.client.port: <span class="hljs-number"><span class="hljs-number">7777</span></span> hawk_api.client.key: <span class="hljs-string"><span class="hljs-string">'very secret key'</span></span></code> </pre><br><pre> <code class="hljs lua">#app/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>/routing.yml hawk: resource: <span class="hljs-string"><span class="hljs-string">'@HawkApiBundle/Controller/'</span></span> prefix: /hawk fos_js_routing: resource: <span class="hljs-string"><span class="hljs-string">"@FOSJsRoutingBundle/Resources/config/routing/routing.xml"</span></span></code> </pre><br>  Put the assets: <br><pre> <code class="bash hljs">php app/console assets:install --symlink web</code> </pre><br></h4><h4>  We finalize the controller: </h4><br><pre> <code class="php hljs">... <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Blogger</span></span>\<span class="hljs-title"><span class="hljs-title">BlogBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">Blog</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Hawk</span></span>\<span class="hljs-title"><span class="hljs-title">ApiBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Event</span></span>\<span class="hljs-title"><span class="hljs-title">GroupMessage</span></span>;</code> </pre><br>  In the function of adding a comment, we place the sending of notifications: <br><pre> <code class="php hljs">... $em-&gt;persist($comment); $em-&gt;flush(); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sendNotification($comment, $blog); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;redirect(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;generateUrl(<span class="hljs-string"><span class="hljs-string">'BloggerBlogBundle_blog_show'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( ...</code> </pre><br>  Well, add the function itself: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *      * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> Comment $comment  * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> Blog $blog  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendNotification</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Comment $comment, Blog $blog)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   $comment_text = $this-&gt;renderView('BloggerBlogBundle:Comment:index.html.twig', [ 'comments' =&gt; [$comment] ]); //  $gMessage = new GroupMessage(); $gMessage -&gt;setFrom('comment_demon') -&gt;setGroups(['blog_' . $blog-&gt;getId()]) -&gt;setText(['comment' =&gt; $comment_text]) -&gt;setEvent('new_comment') //    ; // $api = $this -&gt;container -&gt;get('event_dispatcher') -&gt;dispatch(GroupMessage::NEW_MESSAGE, $gMessage) -&gt;getResult() //HawkApi ; //       if($api-&gt;hasErrors()){ $logger = $this-&gt;get('logger'); $logger-&gt;error('Error sending message: ' . print_r($api-&gt;getErrors(), 1)); } }</span></span></code> </pre><br></div></div><br>  I will dwell on what is happening here.  Sending messages through the service is possible in two ways.  The first is as in the example above, through the symfony event system.  A message object (simple or group) is created and sent with a specific type of event.  The second option is to send directly using api, which can be obtained from the container: <br><pre> <code class="php hljs">$api = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;get(<span class="hljs-string"><span class="hljs-string">'hawk_api.api'</span></span>)-&gt;getApi(); $api -&gt;registerUser($id) -&gt;sendMessage($from, $to, $text, $event) -&gt;execute() -&gt;getResult(<span class="hljs-string"><span class="hljs-string">'sendMessage'</span></span>) ;</code> </pre><br><br><h4>  We are finalizing the templates: </h4><br>  In src / Blogger / BlogBundle / Resources / views / Blog / show.html.twig we change the line <br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"blog"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  on <br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"blog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-blog-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ blog.id }}"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  as we will need a blog id to subscribe the user. <br><br>  We connect scripts: <br><pre> <code class="html hljs xml">{#src/Blogger/BlogBundle/Resources/views/layout.html.twig#} {% block javascripts %} {% javascripts '@BloggerBlogBundle/Resources/public/js/*' output='js/plugins,js' filter='?yui_js' %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ asset_url }}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> {% endjavascripts %} {% javascripts '../vendor/post-hawk/hawk-api/Resources/public/js/hawk_api.min.js' %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ asset_url }}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> {% endjavascripts %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ asset('bundles/fosjsrouting/js/router.js') }}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> {% endblock %}</code> </pre><br><br><h4>  Well, write a little js </h4><br><div class="spoiler">  <b class="spoiler_title">code</b> <div class="spoiler_text"><pre> <code class="javascript hljs">$(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ connectToHawk(); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connectToHawk</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    $.post(Routing.generate('hawk_token', { useSessionId: 1 }), {}, function (data) { if(data.errors === false){ //  HAWK_API.init({ user_id: data.result.id, token: data.result.token, url: data.result.ws, debug: true }); //    HAWK_API.bind_handler('new_comment', function(e, msg){ //   if(msg.from === 'hawk_client') return; //       //   var $comments = $('.previous-comments'), $last = $comments.find('.comment:last'), cls = 'odd', $comment = $(msg.text.comment) ; //    if($last.size()){ cls = $last.hasClass('odd') ? 'even' : 'odd'; } $comment .removeClass('odd') .addClass(cls) .hide() ; // $comments.append($comment); $comment.show('normal') }); //    HAWK_API.bind_handler('open', function(e, msg){ var id = $('.blog').data('blogId'); //     //  ,        HAWK_API.add_user_to_group(['blog_' + id]); }); } else { if(data.errors !== 'no_user') { console.error(data); } } }); }</span></span></code> </pre><br></div></div><br>  The first thing we do is send a request for a token to connect to the message server.  Since the user is not attributed to us, then we tell the controller to use as the user id, the id of his session. <br>  If everything is good, then we will receive in the answer: user id, connection token and server address. <br>  Next, we initialize the connection and subscribe to events.  In this case, we are interested in two of them.  The first is <b>open</b> , arises after successfully connecting to the socket.  The second is <b>new_comment</b> (we send it when sending a message), directly a new comment. <br><br>  That's all.  Thank you for attention.  The code for this part is available on <a href="https://github.com/AntoscencoVladimir/symfony-blog">github</a> in the appropriate branch. </div><p>Source: <a href="https://habr.com/ru/post/303098/">https://habr.com/ru/post/303098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303086/index.html">Intel is going to fight microprocessor-level exploits</a></li>
<li><a href="../303088/index.html">Case: a new site in the TOP Yandex for a year and a half</a></li>
<li><a href="../303090/index.html">vrf-table-label</a></li>
<li><a href="../303094/index.html">Rostelecom invites to Hakaton all who are looking for the glory of bigdat superheroes</a></li>
<li><a href="../303096/index.html">How do brands communicate with ‚Äúself generation‚Äù?</a></li>
<li><a href="../303100/index.html">Carefully, redesign: "voice of the people" vs "eye of the designer"</a></li>
<li><a href="../303104/index.html">RDS, how does it work? We get down to the lowest level of the OSI model</a></li>
<li><a href="../303108/index.html">PHPixie Social - easy integration with social networks</a></li>
<li><a href="../303110/index.html">[Letter to young] Dream. Dreams Come True. And I do not know why</a></li>
<li><a href="../303114/index.html">Creating a blog on symfony 2.8 lts [Part 5]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>