<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Perfect paginator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to talk about the evolution of "paginator" - such a component to navigate through the pages of the news feed (or a list of selected events or a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Perfect paginator</h1><div class="post__text post__text-html js-mediator-article"> I want to talk about the evolution of "paginator" - such a component to navigate through the pages of the news feed (or a list of selected events or anything else) and share one trick that allows you to install fewer handlers for homogeneous components or not to install a handler for new items each time. via Ajax request. <br><br>  The paginator component is a set of links with page numbers that in some div immerse the result of some ajax request.  At the same time, the ajax request returns not only the content, but also the links themselves for switching to other pages, so that for each download, handlers were set for each download, for this, the corresponding script tag came along with the links. <br><br>  When I came to the project, it looked like this: <a name="habracut"></a><br> <code><br> &lt;!--    --&gt; <br> &lt;span class="paginator"&gt;&lt;a href="#{%num%}"&gt;{%num%}&lt;/a&gt;&lt;/span&gt; <br> &lt;span class="prevnext"&gt;&lt;a href="#{%num_min%}"&gt;&lt;/a&gt;&lt;a href="#{%num_max%}"&gt;&lt;/a&gt;&lt;/span&gt; <br></code> <br>  Now I regret that I did not keep this masterpiece exactly ... but for the first time my hair just stood on end from this.  And it was not once on the main page, but in several sections it was replicated by copying and pasting. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first thought how to overcome this mess was to combine handlers and get rid of class selectors.  The second is to make a universal code that could have been in a separate js-file and applied on any page of the site through a one-line call.  The first was solved without problems, the second was clearly not worth it, because it turned out seven lines of code, which is embarrassing to put in a separate file.  But even if they were removed, the problem of re-running the script with each boot would not solve it: <br><br> <code>&lt;!--    --&gt; <br> &lt;div id="pages"&gt; <br> &lt;span class="paginator"&gt;&lt;a href="#{%num%}"&gt;{%num%}&lt;/a&gt;&lt;/span&gt; <br> &lt;span class="prevnext"&gt;&lt;a href="#{%num_min%}"&gt;&lt;/a&gt;&lt;a href="#{%num_max%}"&gt;&lt;/a&gt;&lt;/span&gt; <br> &lt;/div&gt; <br> <br></code> <br><br>  In addition to the lack of copy-paste and repeated execution each time the page is loaded, this solution also has the disadvantage that it is not controlled by data, that is, the path and the target element are strictly written in the code.  It is clear that here it is a page, and the data from the code are separated by several lines, but I still wanted to do it ‚Äúby mind‚Äù, so that the data from the code was stored separately and there was no need to install handlers with each page load.  The result is such a small classic - its copy is created when the page is loaded, just in $ (document) .ready <br><br> <code>;function CPaginator( $, settings ) <br> { <br> /////////////////////////////////////////////////////////////////////////////////////////// <br> function onPageSelect( e ) <br> { <br> var dash = this.href.indexOf('#'); <br> var dashslash = this.href.indexOf('#/'); <br> var path; <br> if ( -1 != dashslash ) path = this.href.substring(dashslash+1); <br> if ( -1 != dash &amp;&amp; -1 == dashslash ) path = window.location.pathname; <br> <br> if ( path &amp;&amp; this.name != "page=" ) <br> { <br> var rel = this.rel; <br> var target = $(rel||settings.defaultTarget).html("loading..."); <br> $.post( path, this.name, function( msg ) { target.html( msg ); }); <br> } <br> if ( e.preventDefault ) <br> e.preventDefault(); <br> return false; <br> } <br> /////////////////////////////////////////////////////////////////////////////////////////// <br> function catchPaginatorClick( ev ) <br> { <br> if ( !ev ) ev = window.event; <br> var target = ev.srcElement || ev.target; <br> return ( target &amp;&amp; target.name &amp;&amp; -1 != target.name.indexOf('page=') ) ? onPageSelect.call( target, ev ) : true; <br> } <br> /////////////////////////////////////////////////////////////////////////////////////////// <br> function constructor() <br> { <br> document.onclick = catchPaginatorClick; <br> } <br> /////////////////////////////////////////////////////////////////////////////////////////// <br> constructor(); <br> }</code> <br> <br>  And the links themselves now look like this: <br> <code>&lt;a href="#" name="page={%num%}" rel="div.main_left_content"&gt;{%num%}</code> <br> <br>  And after they are loaded from the newly arrived ajax file, no handlers should be installed. <br>  In the link itself in href, you can write the path after the lattice where the post-request will be followed by data, rel (although this contradicts the original purpose of this attribute) indicates the selector of the element where the result will be written, and the arguments for the request are stored in name. <br><br>  A handler for the click event is placed on the entire document, and now it does not matter how many items are on a page, how or when they were loaded - they do not need to install handlers for each person personally.  The handler itself, as soon as possible, must determine whether the click on the link for which the specific work logic has been prepared, or whether the event refers to another element for which it is necessary to allow the browser to work through the default logic. <br><br>  Thanks to onPageSelect.call, the event source element in this and the actual event in the first argument are passed to the function.  After the source properties are parsed, the ajax-post request itself goes and it will return false from the handler and preventDefault is executed in those browsers where this method is defined.  Without these lines, the browser will try to follow the link, and even if it looks like # / dir / 7 /, a characteristic click will be heard in IE that appears when opening a new page. <br><br>  In general, according to TRIZ, the ideal object is such that it does not exist, but its function is fulfilled.  Here something like this happened that there are no handlers hung directly on the constantly overloaded elements, but their function is performed.  Here you can ask, why do the server work logic such that page transition controls return from there each time?  I can only answer this by the fact that managers are driven by deadlines, bugs come decently and there is no time to refactor the server, so you have to adjust <br><br>  If that, those long comments between class methods do not fall into the production environment and will be cut by the YUI compressor <br><br>  PS: the first post on Habr√© <br>  PPS: All sorts of wishes and suggestions on style and content are welcome, because I still have something to tell (and I want to do it in the best way) </div><p>Source: <a href="https://habr.com/ru/post/45773/">https://habr.com/ru/post/45773/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45763/index.html">Developer ammunition. Latest news.</a></li>
<li><a href="../45764/index.html">Qt Software History</a></li>
<li><a href="../45766/index.html">Grails 1.1 Beta 1 Released</a></li>
<li><a href="../45767/index.html">Five unusual globes</a></li>
<li><a href="../45769/index.html">Many planets may contain the seeds of life</a></li>
<li><a href="../45776/index.html">What do independent experts think about the USE?</a></li>
<li><a href="../45778/index.html">The new version of Ruby is faster up to 5 times</a></li>
<li><a href="../45783/index.html">GECK - how to sell your MOD for Fallout 3</a></li>
<li><a href="../45786/index.html">Cartoon "Gypsy": Who is the boss ?.</a></li>
<li><a href="../45790/index.html">Create your own magnetic prototype</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>