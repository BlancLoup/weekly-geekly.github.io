<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Navigation from the inside</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I always wonder how a thing works, be it a smart watch , a smartphone or an Atari 2600 . Do you know how your navigator paves the route? I decided to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Navigation from the inside</h1><div class="post__text post__text-html js-mediator-article">  I always wonder how a thing works, be it a <a href="http://habrahabr.ru/post/212483/">smart watch</a> , a smartphone or an <a href="http://habrahabr.ru/post/213527/">Atari 2600</a> .  Do you know how your navigator paves the route?  I decided to find out how this system works from the inside using the example of one hardware and software manufacturer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ba/5fa/071/3ba5fa0712799b7dff341615dff5929c.jpg" alt="image"><br><br><a name="habracut"></a>  It does not always make sense to reinvent the wheel.  So it was judged in Shturmann and, instead of creating an engine for the navigation program and drawing maps from scratch, they used the development of BeNomad and the cartography from HERE.  At the same company, they developed information content, an interface library and a user interface built on its basis, a system of automatic updates for WinCE, and so on.  As a result, the user receives the final product. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The main partner and content provider, Yandex.Probki, has to do a lot of manipulations with the data obtained from it. <br><br>  If users only needed a map from a navigator, they could use a thick atlas of Russian roads.  The main thing in the navigation program is precisely the laying of the optimal route.  Routing is constantly and continuously optimized and configured to produce each time the closest to the ideal result. <br><br>  The route in the online version is laid using cartography and data on traffic jams, which are taken from Yandex.Probok.  From the first, everything is clear - there is a regularly updated HERE cartography.  But there are difficulties with traffic jams: they come in the form of points with 4 main characteristics: ID, speed, direction and color.  This set of points must be properly put on the map. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/039/d4c/07e/039d4c07eafaf3402585af152a422c8b.gif" alt="image"><br><br>  In addition, it is important to somehow pack the data that comes from Yandex, so that they can be unpacked quickly and without problems even on slow devices - the method was developed in Shturmann.  In addition, they implemented a resume when the connection was broken. <br><br><h4>  Cross platform </h4><br>  At the moment there are three commercial releases: for navigators on WinCE and two mobile versions - under Android OS and under iOS.  In the future - the completion of the development version under WinPhone.  There are also desktop versions for Windows and Linux that developers use.  Moreover, the Shturmann version for Linux formed the basis for joint projects with Marussia and Luxoft. <br><br>  The navigation program was originally written in such a way that it could be easily ported to any platform with a normal C ++ compiler.  Today, these are Android OS, iOS, Mac OS, Linux, WinCE, Windows (desktop). <br><br>  Thus, program versions for different platforms are developed in parallel.  However, in the development of mobile applications there are features that must be considered when writing versions: for example, the map manager in Shturmann navigation is written in Java specifically for Android. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f1/948/83f/0f194883f1178c4566c3679d32b1d0fc.gif" alt="image"><br><br><h4>  Route Example </h4><br>  Tverskaya, rush hour.  You can drive around the lanes, which are exactly known that 5 of them are, and there is no data about the 6th.  But this does not mean that the lane is free, it can mean a lack of data: closed traffic, parked cars in two rows on a narrow street - any other impossibility of passage. <br><br>  The program builds a route, giving preference to those roads about which information is more. <br><br><h4>  How does the program determine the route? </h4><br>  In cartography, roads are divided into different categories.  Data about each road contains various indicators, including the average speed on it, the length of the road and a lot of other information.  If you do not take into account traffic jams, the route is laid out taking into account the average speed and using the coefficients that determine the different categories of roads.  These factors also depend on the season. <br><br>  The program works with numbers, therefore, in order for it to build a route, given traffic jams, it is not enough for it to obtain data on traffic jams, scored in points (like in Yandex). <br><br>  Traffic jams, entering the navigation from the server, have the form of arcs - road sections.  At each such arc, you can determine the average speed of movement.  To construct the routes (taking into account these data), arc elongation factors are set.  The more loaded the road, the stronger the arc is.  And the lower the chances that the program will lead the user to traffic. <br><br>  For example, the average speed on the notorious Tverskaya without traffic jams is 50 km / h.  And suddenly a traffic jam comes at a speed of 10 km / h.  Does this mean that it is necessary to proportionally increase the coefficient of 5 times?  The answer is no.  The fact is that, in addition to the coefficients, there are coefficients that are used depending on the route, seasonality and many other factors. <br><br>  Of course, the program is experiencing a "green" roads.  If the route is laid from point A to point B along two equivalent roads with an average speed of 50 km / h, but one has a traffic jam of 40 km / h, and there is no information about the other, the program will drive through the ‚Äútraffic jam‚Äù because it interprets the second option as not reliable enough.  Although algorithms sometimes use other factors. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/38f/9af/252/38f9af252ab71310b9345d91850047c0.gif" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/741/b10/def/741b10def4d4fdac0928df8ad4a0cfb2.gif" alt="image"><br><br><h4>  Multicolored cork </h4><br>  Even at the same speed on the plot color may be different.  In other words, 15 km / h on the Moscow Ring Road and 15 km / h in some central Moscow lane are two big differences.  In one case, the traffic jam will be red, in the other, yellow - and all because different speed ranges are used. <br><br>  Another clear example: under construction junction.  The overlap of roads is taken into account using data from Yandex.  Burgundy (or brown) color in Yandex means that the road is ‚Äúworth‚Äù.  The program takes into account the colors of the arcs and does not lead the user to burgundy, for example, routes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/61c/ee6/d38/61cee6d38c5ee8bb0a8679bcfe742882.gif" alt="image"><br><br><h4>  Work, work and work on routes again </h4><br>  Work on routing is regular.  First, the speed of the roads may change with each mapping update.  Secondly, the data from Yandex also change its range - this must be taken into account.  And among other things, seasonality plays a significant role: in the summer to drive more freely, higher road to the big roads, in the winter, the navigator sends to detours, which the driver can not guess, and then can begin to use them regularly.  If he likes it. <br><br>  When laying the route takes into account a lot of data: <br>  - the number of left turns; <br>  - the number of possible turns (if the driver accidentally or deliberately turned out of the way, the program will not immediately send it back, but will re-route the route, making the ride more relaxed. This is especially true for megalopolises: it‚Äôs harder to turn around than driving 500 meters to the nearest traffic light); <br>  - the number of traffic lights and accidents. <br><br>  In fact, information about traffic jams - this is the summary data, so it was decided not to overload the cards and not distract drivers with unnecessary information.  On the map there are traffic lights and complicated turns, the user receives the rest in the final format of traffic jams. <br><br><h4>  Coefficients </h4><br>  It is very interesting that the program received the possibility of machine learning based on user preferences: a client-server solution is implemented to find the optimal transition rates from traffic jams to arc lengthening, which analyzes route history received from user groups and offers the optimal set of coefficients for routing to period of time (day, evening, etc.). <br><br>  It is interesting: <br>  <a href="http://habrahabr.ru/post/214133/">Smart City at Mobile World Congress 2014</a> <br>  <a href="http://habrahabr.ru/post/214175/">Mobile Internet tariffs without monthly fees</a> </div><p>Source: <a href="https://habr.com/ru/post/213145/">https://habr.com/ru/post/213145/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213127/index.html">How to get a free professional Wunderlist account for 12 months</a></li>
<li><a href="../213131/index.html">ASUS Zenbook UX301LA Review</a></li>
<li><a href="../213133/index.html">Online conference for .NET developers. March 1</a></li>
<li><a href="../213137/index.html">Yandex announced its own Android firmware</a></li>
<li><a href="../213143/index.html">Escene ES292 IP Phone Review</a></li>
<li><a href="../213149/index.html">Chat with the authors of LendWings</a></li>
<li><a href="../213151/index.html">Cambium 650 Core Solution</a></li>
<li><a href="../213155/index.html">The fourth free iOS school in St. Petersburg</a></li>
<li><a href="../213157/index.html">TCP / IP audio channel</a></li>
<li><a href="../213161/index.html">Skydrive officially renamed to OneDrive</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>