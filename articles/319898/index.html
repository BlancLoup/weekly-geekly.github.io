<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pure Python Architecture: A Walkthrough. Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Content 

- Part 1 
- Part 2 
- Part 3 
- Part 4 
- Part 5 

 Scripts (Part 2) 


 Git tag: Step06 



 Now that we have implemented the request and r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pure Python Architecture: A Walkthrough. Part 3</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/391/78a/428/39178a42838641ceb4945692ec5ea8d9.png"><br><div class="spoiler">  <b class="spoiler_title">Content</b> <div class="spoiler_text"><ul><li>  <a href="https://habrahabr.ru/post/319126/">Part 1</a> </li><li>  <a href="https://habrahabr.ru/post/319126/">Part 2</a> </li><li>  <em>Part 3</em> </li><li>  <a href="https://habrahabr.ru/post/320662/">Part 4</a> </li><li>  <a href="https://habrahabr.ru/post/320928/">Part 5</a> </li></ul><br></div></div><br><h3>  Scripts (Part 2) </h3><br><p>  <b>Git tag:</b> <a href="http://github.com/lgiordani/rentomatic/tree/step06">Step06</a> <br></p><br><p> Now that we have implemented the request and response objects, we add them.  We <code><font color="#900">tests/use_cases/test_storageroom_list_use_case.py</font></code> following code in the <code><font color="#900">tests/use_cases/test_storageroom_list_use_case.py</font></code> file: <br></p><a name="habracut"></a><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mock <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rentomatic.domain.storageroom <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StorageRoom <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rentomatic.use_cases <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request_objects <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ro <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rentomatic.use_cases <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> storageroom_use_cases <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> uc @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">domain_storagerooms</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> storageroom_1 = StorageRoom( code=<span class="hljs-string"><span class="hljs-string">'f853578c-fc0f-4e65-81b8-566c5dffa35a'</span></span>, size=<span class="hljs-number"><span class="hljs-number">215</span></span>, price=<span class="hljs-number"><span class="hljs-number">39</span></span>, longitude=<span class="hljs-string"><span class="hljs-string">'-0.09998975'</span></span>, latitude=<span class="hljs-string"><span class="hljs-string">'51.75436293'</span></span>, ) storageroom_2 = StorageRoom( code=<span class="hljs-string"><span class="hljs-string">'fe2c3195-aeff-487a-a08f-e0bdc0ec6e9a'</span></span>, size=<span class="hljs-number"><span class="hljs-number">405</span></span>, price=<span class="hljs-number"><span class="hljs-number">66</span></span>, longitude=<span class="hljs-string"><span class="hljs-string">'0.18228006'</span></span>, latitude=<span class="hljs-string"><span class="hljs-string">'51.74640997'</span></span>, ) storageroom_3 = StorageRoom( code=<span class="hljs-string"><span class="hljs-string">'913694c6-435a-4366-ba0d-da5334a611b2'</span></span>, size=<span class="hljs-number"><span class="hljs-number">56</span></span>, price=<span class="hljs-number"><span class="hljs-number">60</span></span>, longitude=<span class="hljs-string"><span class="hljs-string">'0.27891577'</span></span>, latitude=<span class="hljs-string"><span class="hljs-string">'51.45994069'</span></span>, ) storageroom_4 = StorageRoom( code=<span class="hljs-string"><span class="hljs-string">'eed76e77-55c1-41ce-985d-ca49bf6c0585'</span></span>, size=<span class="hljs-number"><span class="hljs-number">93</span></span>, price=<span class="hljs-number"><span class="hljs-number">48</span></span>, longitude=<span class="hljs-string"><span class="hljs-string">'0.33894476'</span></span>, latitude=<span class="hljs-string"><span class="hljs-string">'51.39916678'</span></span>, ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [storageroom_1, storageroom_2, storageroom_3, storageroom_4] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_storageroom_list_without_parameters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(domain_storagerooms)</span></span></span><span class="hljs-function">:</span></span> repo = mock.Mock() repo.list.return_value = domain_storagerooms storageroom_list_use_case = uc.StorageRoomListUseCase(repo) request_object = ro.StorageRoomListRequestObject.from_dict({}) response_object = storageroom_list_use_case.execute(request_object) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(response_object) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> repo.list.assert_called_with() <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response_object.value == domain_storagerooms</code> </pre><br><p>  The new version of the <code><font color="#900">rentomatic/use_case/storageroom_use_cases.py</font></code> now looks like this: <br></p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rentomatic.shared <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> response_object <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ro <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StorageRoomListUseCase</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, repo)</span></span></span><span class="hljs-function">:</span></span> self.repo = repo <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, request_object)</span></span></span><span class="hljs-function">:</span></span> storage_rooms = self.repo.list() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ro.ResponseSuccess (storage_rooms)</code> </pre><br><p>  Let's see what we do with this pure architecture.  We have a very lightweight model, serialized into JSON and completely independent from other parts of the system.  The code also contains a <abbr title="use_case">script</abbr> in which the <abbr title="repository">storage</abbr> provided by this API retrieves all <abbr title="models">models</abbr> and returns them inside a structured object. <br></p><br><p>  True, we still have not implemented everything.  For example, there is no negative <abbr title="response object">response</abbr> or validated incoming <abbr title="request object">request object</abbr> . <br></p><br><p>  Let's try to correct these omissions by changing the current <abbr title="use_case">script</abbr> to accept the <code><font color="#900">filters</font></code> parameter, which represents the filters applied to the <abbr title="models">model</abbr> list retrieval.  When passing this parameter, errors may occur, so we have to implement a check for the incoming <abbr title="request object">request object</abbr> . <br></p><br><h3>  Requests and validation </h3><br><p>  <b>Git tag:</b> <a href="http://github.com/lgiordani/rentomatic/tree/step07">Step07</a> <br></p><br><p>  I want to add a <code><font color="#900">filters</font></code> parameter for the query.  This option will allow the caller to add different filters, specifying a name and a value for each (for example, <code><font color="#900">{ 'price_lt': 100}</font></code> to get all the results with a price less than 100). <br></p><br><p>  The first where we start our edits is a test.  The new version of the file <code><font color="#900">tests/use_cases/test_storageroom_list_request_objects.py</font></code> looks like this: <br></p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rentomatic.use_cases <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request_objects <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ro <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_valid_request_object_cannot_be_used</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> pytest.raises(NotImplementedError): ro.ValidRequestObject.from_dict({}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_build_storageroom_list_request_object_without_parameters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> req = ro.StorageRoomListRequestObject() <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.filters <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(req) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_build_file_list_request_object_from_empty_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> req = ro.StorageRoomListRequestObject.from_dict({}) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.filters <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(req) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_build_storageroom_list_request_object_with_empty_filters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> req = ro.StorageRoomListRequestObject(filters={}) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.filters == {} <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(req) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_build_storageroom_list_request_object_from_dict_with_empty_filters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> req = ro.StorageRoomListRequestObject.from_dict({<span class="hljs-string"><span class="hljs-string">'filters'</span></span>: {}}) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.filters == {} <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(req) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_build_storageroom_list_request_object_with_filters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> req = ro.StorageRoomListRequestObject(filters={<span class="hljs-string"><span class="hljs-string">'a'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.filters == {<span class="hljs-string"><span class="hljs-string">'a'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(req) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_build_storageroom_list_request_object_from_dict_with_filters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> req = ro.StorageRoomListRequestObject.from_dict({<span class="hljs-string"><span class="hljs-string">'filters'</span></span>: {<span class="hljs-string"><span class="hljs-string">'a'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>}}) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.filters == {<span class="hljs-string"><span class="hljs-string">'a'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(req) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_build_storageroom_list_request_object_from_dict_with_invalid_filters</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> req = ro.StorageRoomListRequestObject.from_dict({<span class="hljs-string"><span class="hljs-string">'filters'</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.has_errors() <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> req.errors[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-string"><span class="hljs-string">'parameter'</span></span>] == <span class="hljs-string"><span class="hljs-string">'filters'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(req) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre><br><p>  Check <code><font color="#900">assert req.filters is None</font></code> for the initial two tests, and then add 5 more tests to check if filters can be refined and to check the behavior of an object with an invalid filter parameter. <br></p><br><p>  In order for the tests to pass, you must change our <code><font color="#900">StorageRoomListRequestObject</font></code> class.  Naturally, there are many possible solutions that you can come up with, and I recommend that you try to find your own.  It also describes the solution that I usually use myself.  The <code><font color="#900">rentomatic/use_cases/request_object.py</font></code> file now looks like <br></p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> collections <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InvalidRequestObject</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.errors = [] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parameter, message)</span></span></span><span class="hljs-function">:</span></span> self.errors.append({<span class="hljs-string"><span class="hljs-string">'parameter'</span></span>: parameter, <span class="hljs-string"><span class="hljs-string">'message'</span></span>: message}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">has_errors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> len(self.errors) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__nonzero__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> __bool__ = __nonzero__ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValidRequestObject</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> @classmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">from_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, adict)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> NotImplementedError <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__nonzero__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> __bool__ = __nonzero__ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StorageRoomListRequestObject</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ValidRequestObject)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, filters=None)</span></span></span><span class="hljs-function">:</span></span> self.filters = filters @classmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">from_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, adict)</span></span></span><span class="hljs-function">:</span></span> invalid_req = InvalidRequestObject() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'filters'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> adict <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> isinstance(adict[<span class="hljs-string"><span class="hljs-string">'filters'</span></span>], collections.Mapping): invalid_req.add_error(<span class="hljs-string"><span class="hljs-string">'filters'</span></span>, <span class="hljs-string"><span class="hljs-string">'Is not iterable'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> invalid_req.has_errors(): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> invalid_req <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> StorageRoomListRequestObject(filters=adict.get(<span class="hljs-string"><span class="hljs-string">'filters'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>))</code> </pre><br><p>  Let me explain these code changes. <br></p><br><p>  First, two helper objects were introduced, <code><font color="#900">ValidRequestObject</font></code> and <code><font color="#900">InvalidRequestObject</font></code> .  They differ from each other because an invalid request must contain validation errors, but both must be converted to a boolean value. <br></p><br><p>  Secondly, at the time of creation, the <code><font color="#900">StorageRoomListRequestObject</font></code> takes an optional <code><font color="#900">filters</font></code> parameter.  In the <code><font color="#900">__init __ ()</font></code> method, there are no checks for validity, as it is considered an internal method, which is called after the parameters have already been confirmed. <br></p><br><p>  As a result, the <code><font color="#900">from_dict()</font></code> method checks the presence of the <code><font color="#900">filters</font></code> parameter.  I use the abstract <code><font color="#900">collections.Mapping</font></code> class to check that the input parameters are dictionaries, and that an instance of an <code><font color="#900">InvalidRequestObject</font></code> or <code><font color="#900">ValidRequestObject</font></code> . <br><br>  Since we can now report the presence of correct or incorrect <abbr title="request objects">requests</abbr> , we need to introduce a new type of response to manage responses to incorrect requests or errors in the script. <br></p><br><h3>  <abbr title="Responses and failures">Answers and failures</abbr> </h3><br><p>  <b>Git tag:</b> <a href="http://github.com/lgiordani/rentomatic/tree/step08">Step08</a> <br></p><br><p>  What happens if an error occurs in the script?  A large number of errors can occur in them: not only validation errors, which we talked about in the previous section, but also business errors or errors from the storage layer.  Whatever the error, the script should always return an object with a known structure (the answer), so we need a new object that provides good support for various types of dips. <br></p><br><p>  As with queries, there is no one correct way to represent such an object, and the following code is just one of the possible solutions. <br></p><br><p>  The first thing to do is expand the <code><font color="#900">tests/shared/test_response_object.py</font></code> , adding tests for failures. <br></p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pytest <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rentomatic.shared <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> response_object <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> res <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> rentomatic.use_cases <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request_objects <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> req @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">response_value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-string"><span class="hljs-string">'key'</span></span>: [<span class="hljs-string"><span class="hljs-string">'value1'</span></span>, <span class="hljs-string"><span class="hljs-string">'value2'</span></span>]} @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">response_type</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'ResponseError'</span></span> @pytest.fixture <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">response_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'This is a response error'</span></span></code> </pre><br><p>  This is template code based on <code><font color="#900">pytest</font></code> , which we will use in the following tests. <br></p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_success_is_true</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response_value)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(res.ResponseSuccess(response_value)) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_is_false</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response_type, response_message)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(res.ResponseFailure(response_type, response_message)) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre><br><p>  Two basic tests to verify that the old <code><font color="#900">ResponseSuccess</font></code> and the new <code><font color="#900">ResponseFailure</font></code> behave consistently when converted to a boolean value. <br></p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_success_contains_value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response_value)</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseSuccess(response_value) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.value == response_value</code> </pre><br><p>  The <code><font color="#900">ResponseSuccess</font></code> object contains the result of the call in the <code>value</code> attribute. <br></p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_has_type_and_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response_type, response_message)</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseFailure(response_type, response_message) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.type == response_type <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.message == response_message <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_contains_value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response_type, response_message)</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseFailure(response_type, response_message) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.value == {<span class="hljs-string"><span class="hljs-string">'type'</span></span>: response_type, <span class="hljs-string"><span class="hljs-string">'message'</span></span>: response_message}</code> </pre><br><p>  These two tests ensure that the <code><font color="#900">ResponseFailure</font></code> object provides the same interface as on success, and that this object has <code><font color="#900">type</font></code> and <code><font color="#900">message</font></code> parameters. <br></p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_initialization_with_exception</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseFailure(response_type, Exception(<span class="hljs-string"><span class="hljs-string">'Just an error message'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(response) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.type == response_type <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.message == <span class="hljs-string"><span class="hljs-string">"Exception: Just an error message"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_from_invalid_request_object</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseFailure.build_from_invalid_request_object(req.InvalidRequestObject()) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(response) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_from_invalid_request_object_with_errors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> request_object = req.InvalidRequestObject() request_object.add_error(<span class="hljs-string"><span class="hljs-string">'path'</span></span>, <span class="hljs-string"><span class="hljs-string">'Is mandatory'</span></span>) request_object.add_error(<span class="hljs-string"><span class="hljs-string">'path'</span></span>, <span class="hljs-string"><span class="hljs-string">"can't be blank"</span></span>) response = res.ResponseFailure.build_from_invalid_request_object(request_object) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(response) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.type == res.ResponseFailure.PARAMETERS_ERROR <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.message == <span class="hljs-string"><span class="hljs-string">"path: Is mandatory\npath: can't be blank"</span></span></code> </pre><br><p>  Sometimes it is necessary to create responses from Python exceptions that can occur in <abbr title="use_cases">scripts</abbr> , so we check that <code><font color="#900">ResponseFailure</font></code> objects can be initialized with an exception. <br></p><br><p>  And <code><font color="#900">build_from_invalid_request_object()</font></code> , we have tests for the <code><font color="#900">build_from_invalid_request_object()</font></code> method that automates the initialization of the response from a non-invalid request.  If the request contains errors (remember, the request checks itself), we must send them in the response message. <br></p><br><p>  The last test uses the class attribute to classify the error.  The <code><font color="#900">ResponseFailure</font></code> class will contain three predefined errors that can occur during the execution of the script: <code><font color="#900">RESOURCE_ERROR</font></code> , <code><font color="#900">PARAMETERS_ERROR</font></code> and <code><font color="#900">SYSTEM_ERROR</font></code> .  With a similar separation, we try to cover various types of errors that can occur when working with an external system through an API.  <code><font color="#900">RESOURCE_ERROR</font></code> contains errors related to the resources contained in the repository, for example, when you cannot find a record by its unique identifier.  <code><font color="#900">PARAMETERS_ERROR</font></code> describes errors that occur with incorrect or missing query parameters.  <code><font color="#900">SYSTEM_ERROR</font></code> covers errors that occur in the base system at the operating system level, such as a file system failure or a network connection error while fetching data from the database. <br></p><br><p>  The script is responsible for interacting with various errors that occur in the Python code, and converts them into one of the three types of messages just described that have a description of this error. <br></p><br><p>  Let's write the <code><font color="#900">ResponseFailure</font></code> class, which allows tests to run successfully.  Create it in <code><font color="#900">rentomatic/shared/response_object.py</font></code> <br></p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ResponseFailure</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> RESOURCE_ERROR = <span class="hljs-string"><span class="hljs-string">'RESOURCE_ERROR'</span></span> PARAMETERS_ERROR = <span class="hljs-string"><span class="hljs-string">'PARAMETERS_ERROR'</span></span> SYSTEM_ERROR = <span class="hljs-string"><span class="hljs-string">'SYSTEM_ERROR'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, type_, message)</span></span></span><span class="hljs-function">:</span></span> self.type = type_ self.message = self._format_message(message) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_format_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, msg)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isinstance(msg, Exception): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"{}: {}"</span></span>.format(msg.__class__.__name__, <span class="hljs-string"><span class="hljs-string">"{}"</span></span>.format(msg)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> msg</code> </pre><br><p>  Using the <code><font color="#900">_format_message()</font></code> method, we allow the class to accept both a string message and a Python exception, which is very convenient when working with external libraries that can cause unknown or uninteresting exceptions. <br></p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@property def value(self): return {'type': self.type, 'message': self.message}</span></span></code> </pre><br><p>  This property makes the class consistent with the API <code><font color="#900">ResponseSuccess</font></code> , providing the <code><font color="#900">value</font></code> attribute, which is a dictionary. <br></p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__bool__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> @classmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build_from_invalid_request_object</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, invalid_request_object)</span></span></span><span class="hljs-function">:</span></span> message = <span class="hljs-string"><span class="hljs-string">"\n"</span></span>.join([<span class="hljs-string"><span class="hljs-string">"{}: {}"</span></span>.format(err[<span class="hljs-string"><span class="hljs-string">'parameter'</span></span>], err[<span class="hljs-string"><span class="hljs-string">'message'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> err <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> invalid_request_object.errors]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cls(cls.PARAMETERS_ERROR, message)</code> </pre><br><p>  As explained above, the <code><font color="#900">PARAMETERS_ERROR</font></code> type covers all those errors that occur when an incorrect set of transmitted parameters, that is, some parameters contain errors or are missing. <br></p><br><p>  Since we often have to create error responses, it is helpful to have helper methods.  Add three tests for building functions in the file <code><font color="#900">tests/shared/test_response_object.py</font></code> <br></p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_build_resource_error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseFailure.build_resource_error(<span class="hljs-string"><span class="hljs-string">"test message"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(response) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.type == res.ResponseFailure.RESOURCE_ERROR <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.message == <span class="hljs-string"><span class="hljs-string">"test message"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_build_parameters_error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseFailure.build_parameters_error(<span class="hljs-string"><span class="hljs-string">"test message"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(response) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.type == res.ResponseFailure.PARAMETERS_ERROR <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.message == <span class="hljs-string"><span class="hljs-string">"test message"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_response_failure_build_system_error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> response = res.ResponseFailure.build_system_error(<span class="hljs-string"><span class="hljs-string">"test message"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> bool(response) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.type == res.ResponseFailure.SYSTEM_ERROR <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> response.message == <span class="hljs-string"><span class="hljs-string">"test message"</span></span></code> </pre><br><p>  We added the corresponding methods in the class and added the use of the new <code><font color="#900">build_parameters_error()</font></code> method in the <code><font color="#900">build_from_invalid_request_object()</font></code> method.  The <code><font color="#900">rentomatic/shared/response_object.py</font></code> file should now contain this code. <br></p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta"> @classmethod def build_resource_error(cls, message=None): return cls(cls.RESOURCE_ERROR, message) @classmethod def build_system_error(cls, message=None): return cls(cls.SYSTEM_ERROR, message) @classmethod def build_parameters_error(cls, message=None): return cls(cls.PARAMETERS_ERROR, message) @classmethod def build_from_invalid_request_object(cls, invalid_request_object): message = "\n".join(["{}: {}".format(err['parameter'], err['message']) for err in invalid_request_object.errors]) return cls.build_parameters_error(message)</span></span></code> </pre><br><p>  To be continued in <a href="https://habrahabr.ru/post/320662/">Part 4</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/319898/">https://habr.com/ru/post/319898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319886/index.html">Control your mind</a></li>
<li><a href="../319888/index.html">How to make a cross-platform desktop application based on web technologies</a></li>
<li><a href="../319890/index.html">Custom game research</a></li>
<li><a href="../319894/index.html">Pure javascript. Objects and data structures. Asynchrony. Error processing</a></li>
<li><a href="../319896/index.html">Amazon Web Services User Group Russia First MEP</a></li>
<li><a href="../319900/index.html">How to "correctly" go to Early Access on Steam</a></li>
<li><a href="../319902/index.html">Performance comparison of analytical HPE Vertica and Exasol DBMS using TPC-H Benchmark</a></li>
<li><a href="../319904/index.html">Under and over the water: two almost fantastic projects of data centers from Microsoft and Google</a></li>
<li><a href="../319906/index.html">The first official release of Webpack 2. What's new compared to Webpack 1?</a></li>
<li><a href="../319908/index.html">Let's start the year with a positive: how admins and CIOs sit down</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>