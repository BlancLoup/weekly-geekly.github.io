<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write processing Asterisk AMI do it yourself. Part one: create a class in PHP to refer to an asterisk or how to make a php socket client yourself</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instead of the preface 
 Greetings to the community! 

 My first article Example of implementing an appeal to Asterisk CLI in PHP. Structuring the ans...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write processing Asterisk AMI do it yourself. Part one: create a class in PHP to refer to an asterisk or how to make a php socket client yourself</h1><div class="post__text post__text-html js-mediator-article"><h2>  Instead of the preface </h2><br>  Greetings to the community! <br><br>  My <a href="http://habrahabr.ru/post/253351/">first article Example of implementing an appeal to Asterisk CLI in PHP.</a>  <a href="http://habrahabr.ru/post/253351/">Structuring the answer asterisks</a> finally passed from moderation to the sandbox and the moderator immediately gave me full rights to publish to Habr√©. <br><br>  I want to start a series of articles on how you can implement your own API for handling Asterisk through AMI.  If you have the time, the desire and the most important experience, support me and try to form a team that on this portal will create a full-fledged php API for interacting with AMI Asterisk, we are talking to the dialogue. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The task is very interesting since many services dedicated to Asterisk immediately hide all the information about attempts to develop their own interfaces for Asterisk.  Although my experience, which I will explain here, can be an attempt to entertain my ‚Äúego‚Äù for many ‚Äúkodders‚Äù, but creating your own web application that will not fail every second will not create options (although if you are a javascript virtuoso, you‚Äôll even have some literate substitute for bourgeois web muzzle for aster). <br><br>  In this part, I will show that writing your own class to refer to the AMI asterisk is easy, the main thing is to go from simple to complex. <br><br>  <b>For especially lazy at the end of the article there is a ready (working) module with the class Asterisk AMI</b> .  With examples of requests.  The class is fully working and ready to use. <br><a name="habracut"></a><br><h2>  Materiel </h2><br>  I decided to implement the mechanism of the socket on fsockopen. <br><br>  Before you start coding a little educational program. <br><br><div class="spoiler">  <b class="spoiler_title">Functions and keywords php occurring in the code</b> <div class="spoiler_text">  . <br><div class="spoiler">  <b class="spoiler_title">__destruct</b> <div class="spoiler_text">  Destructor class.  The main task of the destructor is to perform user-defined actions when a class instance is destroyed (in any case, even if the script crashes). <br><br><pre><code class="php hljs">: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__destruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    . }</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">count</b> <div class="spoiler_text">  Returns the number of elements in the array. <br><pre> <code class="php hljs">: <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $a = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> (<span class="hljs-string"><span class="hljs-string">"a"</span></span>,<span class="hljs-string"><span class="hljs-string">"b"</span></span>,<span class="hljs-string"><span class="hljs-string">"c"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> count($a); <span class="hljs-comment"><span class="hljs-comment">// count  3 ( )</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">die</b> <div class="spoiler_text">  The completion of the script at this point and the output line.  Usually used to stop the script in the script body. <br><pre> <code class="php hljs">: <span class="hljs-keyword"><span class="hljs-keyword">die</span></span> (<span class="hljs-string"><span class="hljs-string">" "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      : " "</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">explode</b> <div class="spoiler_text">  Splits a string into an array using a marker. <br><pre> <code class="php hljs">: $a = explode(<span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"   "</span></span>); <span class="hljs-comment"><span class="hljs-comment">// : $a[0]="", $a[1]="", $a[2]="", $a[3]=""</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">fclose</b> <div class="spoiler_text">  Closes the handle associated with the file / socket. <br><pre> <code class="php hljs">: fclose($a); <span class="hljs-comment"><span class="hljs-comment">//    /   $a </span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">fread</b> <div class="spoiler_text">  Reads data from a file / socket. <br><pre> <code class="php hljs">: $b = fread($a,<span class="hljs-number"><span class="hljs-number">100</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  100   /   $a </span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">fsockopen</b> <div class="spoiler_text">  Opens connection to the socket. <br><pre> <code class="php hljs">: $m= fsockopen(host, port,$a,$b,<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">// $m   ()     false     .</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">function</b> <div class="spoiler_text">  Function declaration in php. <br><pre> <code class="php hljs">: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">example</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"function"</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//   example</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">fwrite</b> <div class="spoiler_text">  Write to file / socket using binary-safe mode. <br><pre> <code class="php hljs">: fwrite($a, <span class="hljs-string"><span class="hljs-string">"  "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   /   $a  "  "</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">public</b> <div class="spoiler_text">  Declaring variables, constants, functions inside a class publicly available.  Everything that is declared public can be accessed from the main code. <br><pre> <code class="php hljs">: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TempClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $a = <span class="hljs-string"><span class="hljs-string">'       '</span></span>; } $b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TempClass(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $b-&gt;a; <span class="hljs-comment"><span class="hljs-comment">//   '       </span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">rand</b> <div class="spoiler_text">  Produces a random integer.  If the maximum and minimum values ‚Äã‚Äãare specified, the number will be within the specified range. <br><pre> <code class="php hljs">: <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> rand(<span class="hljs-number"><span class="hljs-number">100</span></span>,<span class="hljs-number"><span class="hljs-number">999</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     100  999</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">return</b> <div class="spoiler_text">  Generates a function exit.  If after return there is a value / variable / any object, then the function returns the given entity. <br><pre> <code class="php hljs">: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ad</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> ad(); <span class="hljs-comment"><span class="hljs-comment">//  5</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">set_time_limit</b> <div class="spoiler_text">  Sets the maximum execution time of the script in seconds.  If the parameter contains the number 0, then the maximum time is reset and the script can run forever until the algorithm inside it completes its execution. <br><pre> <code class="php hljs">: set_time_limit (<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> ad(); <span class="hljs-comment"><span class="hljs-comment">//     5 .</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">sleep</b> <div class="spoiler_text">  Suspends the execution of the script in seconds. <br><pre> <code class="php hljs">: sleep (<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" ,    "</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      " ,    "  10 .</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">socket_get_status</b> <div class="spoiler_text">  Extracts metadata from a socket <br><pre> <code class="php hljs">: socket_get_status ($a); <span class="hljs-comment"><span class="hljs-comment">//  ()     $a.</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">stream_set_timeout</b> <div class="spoiler_text">  Sets the timeout value for a socket <br><pre> <code class="php hljs">: stream_set_timeout ($a,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>); <span class="hljs-comment"><span class="hljs-comment">//        $a.</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">trim</b> <div class="spoiler_text">  Removes spaces at the beginning and end of a line. <br><pre> <code class="php hljs">: <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> trim (<span class="hljs-string"><span class="hljs-string">"     "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   "   ";</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">var_dump</b> <div class="spoiler_text">  Gives the entire structure <br><pre> <code class="php hljs">: var_dump(<span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  int(5);</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">-&gt;</b> <div class="spoiler_text">  Reversal to objects defined inside the class <br><pre> <code class="php hljs">: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TempClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $a = <span class="hljs-string"><span class="hljs-string">'   '</span></span>; } $b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TempClass(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $b-&gt;a; <span class="hljs-comment"><span class="hljs-comment">//   '   '</span></span></code> </pre><br></div></div><br><pre> <code class="php hljs">*    ,      ,         .          .                ,     .      .</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">We get the login and password for Asterisk AMI using WinSCP</b> <div class="spoiler_text">  1. Downloading <a href="http://winscp.net/eng/download.php">WinSCP</a> from the <a href="http://winscp.net/eng/download.php">official website</a> <br><br><img src="https://habrastorage.org/files/71a/a99/9a1/71aa999a1ec041daa00645460ef11207.PNG"><br><br>  2. Run the program and go to the server filling in the fields indicated with a red marker. <br><br><img src="https://habrastorage.org/files/f3f/ef6/3bd/f3fef63bd9b744159b1581ba8fe26c8b.PNG"><br><br>  Click "yes" to all questions and if you need to re-enter the password. <br><br>  3. Next, look for the file manager.conf.  The default location for the / etc / asterisk / file. <br><br><img src="https://habrastorage.org/files/b29/e7d/861/b29e7d86102a422f9a6f353d9e1a90dd.PNG"><br><br>  Open the file by double clicking. <br><br>  4. Inside the file we find the section [admin] <br><br><img src="https://habrastorage.org/files/0a5/f93/bf4/0a5f93bf42714a4e8447034e176e750f.PNG"><br><br>  We write down the login and password from your Asterisk AMI.  In my case, this is admin and amp11. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Learning to connect via SSH tunnel to Asterisk AMI using putty</b> <div class="spoiler_text">  1. <a href="http://www.putty.org/">Download putty from the official site.</a> <br><br><img src="https://habrastorage.org/files/eea/f98/1b9/eeaf981b9e844beeb85e82ecde0f3fd3.PNG"><br><br>  2. Run putty.  Highlighted in red in the figure note.  In the line highlighted in red with the inscription 1, we write the IP address of the Asterisk server.  SSH protocol on which putty will work.  Never prevent putty from closing if the connection is broken. <br><br><img src="https://habrastorage.org/files/a97/f82/dd7/a97f82dd7da64376ad06d1c62c9c7567.PNG"><br><br>  3. At the invitation of the system, enter the user (usually this is the root) and press Enter. <br><br><img src="https://habrastorage.org/files/2e5/e28/bfd/2e5e28bfdc5b4728834138e9659fb67a.PNG"><br><br>  4. Enter the password and press Enter. <br><br><img src="https://habrastorage.org/files/a8e/9ea/32e/a8e9ea32e6d0428c8385d5c0b6e0f374.PNG"><br><br>  5. If the authorization was successful, we get something like this screen. <br><br><img src="https://habrastorage.org/files/089/d64/e94/089d64e946594e41ba29a82724e9c8f0.PNG"><br><br>  6. Enter: telnet 127.0.0.1 5038 and get the Asterisk prompt: Asterisk Call Manager <br><br><img src="https://habrastorage.org/files/fc7/ce0/1a0/fc7ce01a059c4aa1996450451d5c311d.PNG"><br><br>  7. Enter the following lines: <br>  Action: Login // Press Enter <br>  Username: Which_we_name_to_in_ through_WinSCP // Press Enter <br>  Secret: Password_to_Why_Web_Call_With_With_WinSCP // Press 2 times Enter <br><br><img src="https://habrastorage.org/files/997/5ac/bc9/9975acbc996143d79294247b13b29bd5.PNG"><br><br>  Get the message Asterisk: Message: Authentication accepted <br><br>  8. Enter the following lines: <br>  Action: Logoff // Press 2 times Enter <br><br><img src="https://habrastorage.org/files/5e4/317/82d/5e431782dc2b4ccaa95f5120c54ccead.PNG"><br><br>  Get the system message <br>  Response: Goodbye <br>  Message: Thanks for all the fish. <br><br>  * Here we learned how to connect via putty via SSH to AMI Asterisk <br></div></div><br><br><h2>  Definition of a mandatory class functional </h2><br>  Let's make the table to understand what functionality needs to be added to a class. <br><table border="1"><tbody><tr><th>  <nobr>Task.</nobr> </th><th>  <nobr>Need.</nobr> </th><th>  <nobr>Functional class.</nobr> </th></tr><tr><td>  Initial initialization of class variables. </td><td>  Required condition. </td><td>  Constructor __construct (); <br>  The global array is $ this-&gt; ini in which we will store all class variables. </td></tr><tr><td>  Class closing </td><td>  Required condition. </td><td>  Destructor __destruct (); </td></tr><tr><td>  Socket connection. </td><td>  Required condition. </td><td>  Function connect (); </td></tr><tr><td>  Socket disconnect </td><td>  Required condition. </td><td>  Function disconnect (); <br></td></tr><tr><td>  Authorization in AsterIsk AMI. </td><td>  Required condition. </td><td>  Function init (); </td></tr><tr><td>  Write to socket </td><td>  Required condition. </td><td>  Write () function; </td></tr><tr><td>  Read from socket synchronously. </td><td>  Not a prerequisite. </td><td>  Function read_syn (); </td></tr><tr><td>  Read from socket asynchronously. </td><td>  Required condition. </td><td>  Read () function; </td></tr></tbody></table><br><br>  This is a rough TZ that will allow you to write a class to interact through PHP with Asterisk AMI. <br><br><h2>  Codding </h2><br><h3>  The rules of writing code in the classroom for clarity when reading it. </h3><br>  When writing this class, I used the following rules: <br><ul><li>  $ i, $ ii, $ iii, $ iiii - all variables beginning with $ i are for for loop variables </li><li>  $ s, $ ss, $ sss, $ ssss - all variables starting with $ s are strings </li><li>  $ m, $ mm, $ mmm, $ mmmm - all variables starting with $ m are arrays </li><li>  Each level of code nesting deviates from the parent by four spaces. </li><li>  Each variable declared in a function that is not global necessarily requires direct destruction by the unset function in order for the PHP demons not to eat memory. </li></ul><br><br><h3>  __construct (), __ destruct () and $ this-&gt; ini </h3><br><br>  The main task of the constructor is to declare all the variables that will be used in the class.  All variables will be stored in the $ this-&gt; ini array. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Asterisk_ami</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $ini = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-comment"><span class="hljs-comment">/*    . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> } <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__destruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini); <span class="hljs-comment"><span class="hljs-comment">/*           $this-&gt;ini       .      php      ,                */</span></span> } } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><br>  The rest of the variables in this array, we will add as needed, and we will consider in detail each element of the functionality. <br><br><h3>  connect () and disconnect () </h3><br>  To connect to the socket, I decided to use the fsockopen function. <br><br><pre> <code class="php hljs">fsockopen(host, port,$a,$b,$c);  host - IP       , port -       , $a -      , $b -       , $c -  (  ,     ).</code> </pre><br><br>  From the description of the function, we can understand that we need to enter at least 2 variables in the global array.  This is the IP address of the server and the port for the connection.  Since $ a, $ b return values ‚Äã‚Äã(and we are not a help desk to store references), we will ignore them.  And the $ c parameter does not work at all, so we will not keep it in memory. <br><br>  <s>Why am I writing that does not work?</s>  <s>Because this is the real experience of this function in demons, which are</s> <s><br></s>  <s>drum on your own PHP specs.</s> <br><br>  For two new variables, we introduce 2 elements of the array: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"host"</span></span>] = <span class="hljs-string"><span class="hljs-string">"127.0.0.1"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* IP  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"port"</span></span>] = <span class="hljs-string"><span class="hljs-string">"5038"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span></code> </pre><br><br>  Write the function: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Asterisk_ami</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $ini = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-comment"><span class="hljs-comment">/*    . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"host"</span></span>] = <span class="hljs-string"><span class="hljs-string">"127.0.0.1"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* IP  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"port"</span></span>] = <span class="hljs-string"><span class="hljs-string">"5038"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> } <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__destruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini); <span class="hljs-comment"><span class="hljs-comment">/*           $this-&gt;ini       .      php      ,                */</span></span> } <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>] = fsockopen(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"host"</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"port"</span></span>],$a,$b,<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]) { stream_set_timeout(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">400000</span></span>); <span class="hljs-comment"><span class="hljs-comment">/*             ,             ,     ,       */</span></span> } } <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]) <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> { fclose(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]); <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> } } } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><h3>  write (); </h3><br>  To work with Asterisk AMI, we must write to the socket a packet of strings, in response to which we will also receive strings about the status of our requests.  For the record, we will use the php function fwrite. In addition, with each packet we can send the ActionID indicator of our request so that we can receive information packets from Asterisk to classify these packets according to the events sent in advance. <br><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($a)</span></span></span><span class="hljs-function"> /* $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function">         */ </span></span>{ $m = rand (<span class="hljs-number"><span class="hljs-number">10000000000000000</span></span>,<span class="hljs-number"><span class="hljs-number">99999999900000000</span></span>); <span class="hljs-comment"><span class="hljs-comment">/*  ,    ActionID */</span></span> fwrite(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;con, <span class="hljs-string"><span class="hljs-string">"ActionID: $this-&gt;action_id$m\r\n$a\r\n\r\n"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sleepi(); <span class="hljs-comment"><span class="hljs-comment">/*        . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $m; <span class="hljs-comment"><span class="hljs-comment">/*  ActionID */</span></span> }</code> </pre><br><br><h3>  sleepi (); </h3><br>  Every time our script sends a batch of strings to a socket, it returns to execute the following code.  Let us see what happens with our package.  Our packet is queued for reading by the server controlling the socket.  The server, in turn, at the moment may be busy with another operation, and will read our lines a little later.  In this regard, in my opinion, it is better to give a little time so that the server has time to read our lines and begin processing our package.  For this, I introduced a function to the class that will force the script to fall asleep for a while. <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Asterisk_ami</span></span></span><span class="hljs-class"> </span></span>{ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"host"</span></span>] = <span class="hljs-string"><span class="hljs-string">"127.0.0.1"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* IP  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"port"</span></span>] = <span class="hljs-string"><span class="hljs-string">"5038"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"sleep_time"</span></span>]=<span class="hljs-number"><span class="hljs-number">1500</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*      ,    ,  "5" */</span></span> } ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ <span class="hljs-comment"><span class="hljs-comment">/*         */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleepi</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ sleep(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"sleep_time"</span></span>]); <span class="hljs-comment"><span class="hljs-comment">/*       */</span></span> } }</code> </pre><br><h3>  init () and read (); </h3><br>  Everything is simple here.  We look code. <br><br><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $mm = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $b = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $k = <span class="hljs-number"><span class="hljs-number">0</span></span>; $s = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sleepi(); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $s.= fread(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;con,<span class="hljs-number"><span class="hljs-number">1024</span></span>); sleep(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;read_sleep_time); $mmm=socket_get_status(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;con); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($mmm[<span class="hljs-string"><span class="hljs-string">'unread_bytes'</span></span>]); $mm = explode (<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>,$s); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i=<span class="hljs-number"><span class="hljs-number">0</span></span>;$i&lt;count($mm);$i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($mm[$i]==<span class="hljs-string"><span class="hljs-string">""</span></span>) { $k++; } $m = explode(<span class="hljs-string"><span class="hljs-string">":"</span></span>,$mm[$i]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($m[<span class="hljs-number"><span class="hljs-number">1</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastRead"</span></span>][$k][trim($m[<span class="hljs-number"><span class="hljs-number">0</span></span>])] = trim($m[<span class="hljs-number"><span class="hljs-number">1</span></span>]); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastRead"</span></span>]; }</code> </pre><br><br>  As a result, we got a class for working with Asterisk AMI: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Asterisk_ami</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $ini = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"host"</span></span>] = <span class="hljs-string"><span class="hljs-string">"127.0.0.1"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"port"</span></span>] = <span class="hljs-string"><span class="hljs-string">"5038"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastActionID"</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastRead"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> (); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"sleep_time"</span></span>]=<span class="hljs-number"><span class="hljs-number">1.5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"login"</span></span>] = <span class="hljs-string"><span class="hljs-string">"admin"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"password"</span></span>] = <span class="hljs-string"><span class="hljs-string">"amp111"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__destruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>] = fsockopen(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"host"</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"port"</span></span>],$a,$b,<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]) { stream_set_timeout(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">400000</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">disconnect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]) { fclose(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastActionID"</span></span>] = rand (<span class="hljs-number"><span class="hljs-number">10000000000000000</span></span>,<span class="hljs-number"><span class="hljs-number">99999999900000000</span></span>); fwrite(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>], <span class="hljs-string"><span class="hljs-string">"ActionID: "</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastActionID"</span></span>].<span class="hljs-string"><span class="hljs-string">"\r\n$a\r\n\r\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sleepi(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastActionID"</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleepi</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ sleep(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"sleep_time"</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $mm = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $b = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $k = <span class="hljs-number"><span class="hljs-number">0</span></span>; $s = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sleepi(); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $s.= fread(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>],<span class="hljs-number"><span class="hljs-number">1024</span></span>); sleep(<span class="hljs-number"><span class="hljs-number">0.005</span></span>); $mmm=socket_get_status(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($mmm[<span class="hljs-string"><span class="hljs-string">'unread_bytes'</span></span>]); $mm = explode (<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>,$s); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastRead"</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i=<span class="hljs-number"><span class="hljs-number">0</span></span>;$i&lt;count($mm);$i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($mm[$i]==<span class="hljs-string"><span class="hljs-string">""</span></span>) { $k++; } $m = explode(<span class="hljs-string"><span class="hljs-string">":"</span></span>,$mm[$i]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($m[<span class="hljs-number"><span class="hljs-number">1</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastRead"</span></span>][$k][trim($m[<span class="hljs-number"><span class="hljs-number">0</span></span>])] = trim($m[<span class="hljs-number"><span class="hljs-number">1</span></span>]); } } <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> ($b); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> ($k); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> ($mm); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> ($mm); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> ($mmm); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> ($i); <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span> ($s); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"lastRead"</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;write(<span class="hljs-string"><span class="hljs-string">"Action: Login\r\nUsername: "</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"login"</span></span>].<span class="hljs-string"><span class="hljs-string">"\r\nSecret: "</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ini[<span class="hljs-string"><span class="hljs-string">"login"</span></span>].<span class="hljs-string"><span class="hljs-string">"\r\n\r\n"</span></span>); } } $a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Asterisk_ami(); $a-&gt;connect(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($a-&gt;ini[<span class="hljs-string"><span class="hljs-string">"con"</span></span>]) { $a-&gt;init(); $a-&gt;write(<span class="hljs-string"><span class="hljs-string">"Action: ListCommands"</span></span>); var_dump($a-&gt;read()); $a-&gt;disconnect(); } <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>($a); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Script result</b> <div class="spoiler_text">  array (4) { <br>  [0] =&gt; <br>  array (2) { <br>  ["Response"] =&gt; <br>  string (7) "Success" <br>  ["Message"] =&gt; <br>  string (23) "Authentication accepted" <br>  } <br>  [1] =&gt; <br>  array (3) { <br>  ["Event"] =&gt; <br>  string (11) "FullyBooted" <br>  ["Privilege"] =&gt; <br>  string (10) "system, all" <br>  ["Status"] =&gt; <br>  string (12) "Fully Booted" <br>  } <br>  [2] =&gt; <br>  array (2) { <br>  ["Response"] =&gt; <br>  string (7) "Success" <br>  ["Events"] =&gt; <br>  string (2) "On" <br>  } <br>  [3] =&gt; <br>  array (115) { <br>  ["Response"] =&gt; <br>  string (7) "Success" <br>  ["ActionID"] =&gt; <br>  string (17) "67932087789661188" <br>  ["WaitEvent"] =&gt; <br>  string (34) ‚ÄúWait for an event to occur.  (Priv ¬ª <br>  ["DeviceStateList"] =&gt; <br>  string (44) ‚ÄúList the current known device states.  (Priv ¬ª <br>  ["PresenceStateList"] =&gt; <br>  string (46) ‚ÄúList the current known presence states.  (Priv ¬ª <br>  ["QueueReset"] =&gt; <br>  string (30) ‚ÄúReset queue statistics.  (Priv ¬ª <br>  ["QueueReload"] =&gt; <br>  string (71) ‚ÄúReload a queue, queues, or any sub-section of a queue or queues.  (Priv ¬ª <br>  ["QueueRule"] =&gt; <br>  string (19) ‚ÄúQueue Rules.  (Priv ¬ª <br>  ["QueueMemberRingInUse"] =&gt; <br>  string (50) ‚ÄúSet the ringinuse value for a queue member.  (Priv ¬ª <br>  ["QueuePenalty"] =&gt; <br>  string (42) ‚ÄúSet the penalty for a queue member.  (Priv ¬ª <br>  ["QueueLog"] =&gt; <br>  string (38) ‚ÄúAdds custom entry in queue_log.  (Priv ¬ª <br>  ["QueuePause"] =&gt; <br>  string (52) ‚ÄúMakes a queue member temporarily unavailable.  (Priv ¬ª <br>  ["QueueRemove"] =&gt; <br>  string (35) ‚ÄúRemove interface from queue.  (Priv ¬ª <br>  ["QueueAdd"] =&gt; <br>  string (30) ‚ÄúAdd interface to queue.  (Priv ¬ª <br>  ["QueueSummary"] =&gt; <br>  string (26) ‚ÄúShow queue summary.  (Priv ¬ª <br>  ["QueueStatus"] =&gt; <br>  string (25) ‚ÄúShow queue status.  (Priv ¬ª <br>  ["Queues"] =&gt; <br>  string (14) "Queues.  (Priv ¬ª <br>  ["ControlPlayback"] =&gt; <br>  string (64) "Control the playback of a file being played to a channel.  (Priv ¬ª <br>  ["StopMixMonitor"] =&gt; <br>  string (86) "Stop the recording of a file handle.  (Priv ¬ª <br>  ["MixMonitor"] =&gt; <br>  string (178) ‚ÄúRecord a call and mix the audio during the recording.  The audio file is available for processing during the dialplan execution.  (Priv ¬ª <br>  ["MixMonitorMute"] =&gt; <br>  string (44) ‚ÄúMute / unMute a Mixmonitor recording.  (Priv ¬ª <br>  ["VoicemailRefresh"] =&gt; <br>  string (51) "Tell Asterisk to poll mailboxes for a change (Priv" <br>  ["VoicemailUsersList"] =&gt; <br>  string (43) "List All Voicemail User Information.  (Priv ¬ª <br>  ["PlayDTMF"] =&gt; <br>  string (46) ‚ÄúPlay DTMF signal on a specific channel.  (Priv ¬ª <br>  ["MuteAudio"] =&gt; <br>  string (28) ‚ÄúMute an audio stream.  (Priv ¬ª <br>  ["ConfbridgeSetSingleVideoSrc"] =&gt; <br>  string (94) "distributed to all other participants.  (Priv ¬ª <br>  ["ConfbridgeStopRecord"] =&gt; <br>  string (46) ‚ÄúStop recording a Confbridge conference.  (Priv ¬ª <br>  ["ConfbridgeStartRecord"] =&gt; <br>  string (47) ‚ÄúStart recording a Confbridge conference.  (Priv ¬ª <br>  ["Confbridge Lock"] =&gt; <br>  string (36) ‚ÄúLock a Confbridge conference.  (Priv ¬ª <br>  ["ConfbridgeUnlock"] =&gt; <br>  string (38) ‚ÄúUnlock a Confbridge conference.  (Priv ¬ª <br>  ["ConfbridgeKick"] =&gt; <br>  string (30) ‚ÄúKick a Confbridge user.  (Priv ¬ª <br>  ["ConfbridgeUnmute"] =&gt; <br>  string (32) ‚ÄúUnmute a Confbridge user.  (Priv ¬ª <br>  ["ConfbridgeMute"] =&gt; <br>  string (30) ‚ÄúMute a Confbridge user.  (Priv ¬ª <br>  ["ConfbridgeListRooms"] =&gt; <br>  string (31) ‚ÄúList active conferences.  (Priv ¬ª <br>  ["ConfbridgeList"] =&gt; <br>  string (41) "List participants in a conference.  (Priv ¬ª <br>  ["MeetmeListRooms"] =&gt; <br>  string (31) ‚ÄúList active conferences.  (Priv ¬ª <br>  ["MeetmeList"] =&gt; <br>  string (41) "List participants in a conference.  (Priv ¬ª <br>  [‚ÄúMeetmeUnmute‚Äù] =&gt; <br>  string (28) ‚ÄúUnmute a Meetme user.  (Priv ¬ª <br>  [‚ÄúMeetmeMute‚Äù] =&gt; <br>  string (26) ‚ÄúMute a Meetme user.  (Priv ¬ª <br>  ["PJSIPNotify"] =&gt; <br>  string (63) ‚ÄúSend a message to either endpoint or an arbitrary URI.  (Priv ¬ª <br>  ["PJSIPShowRegistrationsOutbound"] =&gt; <br>  string (42) ‚ÄúLists PJSIP outbound registrations.  (Priv ¬ª <br>  ["PJSIPUnregister"] =&gt; <br>  string (43) ‚ÄúUnregister an outbound registration.  (Priv ¬ª <br>  ["PJSIPShowRegistrationsInbound"] =&gt; <br>  string (41) "Lists PJSIP inbound registrations.  (Priv ¬ª <br>  ["PRIDebugFileUnset"] =&gt; <br>  string (50) "Disables file output for PRI debug messages (Priv" <br>  ["PRIDebugFileSet"] ‚Äã‚Äã=&gt; <br>  string (53) "Set the file used for PRI debug message output (Priv" <br>  ["PRIDebugSet"] ‚Äã‚Äã=&gt; <br>  string (38) "Set PRI debug levels for a span (Priv" <br>  ["PRIShowSpans"] =&gt; <br>  string (32) ‚ÄúShow status of PRI spans.  (Priv ¬ª <br>  ["DAHDIRestart"] =&gt; <br>  string (55) ‚ÄúFully Restart DAHDI channels (terminates calls).  (Priv ¬ª <br>  ["DAHDIShowChannels"] =&gt; <br>  string (37) ‚ÄúShow status of DAHDI channels.  (Priv ¬ª <br>  ["DAHDIDNDoff"] =&gt; <br>  string (54) ‚ÄúToggle DAHDI channel Do Not Disturb status OFF.  (Priv ¬ª <br>  ["DAHDIDNDon"] =&gt; <br>  string (53) "Toggle DAHDI channel Do Not Disturb status ON.  (Priv ¬ª <br>  ["DAHDIDialOffhook"] =&gt; <br>  string (45) ‚ÄúDial over DAHDI channel while offhook.  (Priv ¬ª <br>  ["DAHDIHangup"] =&gt; <br>  string (28) ‚ÄúHangup DAHDI Channel.  (Priv ¬ª <br>  ["DAHDITransfer"] =&gt; <br>  string (30) ‚ÄúTransfer DAHDI Channel.  (Priv ¬ª <br>  ["SIPpeerstatus"] =&gt; <br>  string (54) ‚ÄúShow the status of one of all sip peers.  (Priv ¬ª <br>  ["SIPnotify"] =&gt; <br>  string (25) ‚ÄúSend a SIP notify.  (Priv ¬ª <br>  ["SIPshowregistry"] =&gt; <br>  string (44) ‚ÄúShow SIP registrations (text format).  (Priv ¬ª <br>  ["SIPqualifypeer"] =&gt; <br>  string (25) ‚ÄúQualify SIP peers.  (Priv ¬ª <br>  ["SIPshowpeer"] =&gt; <br>  string (35) ‚Äúshow SIP peer (text format).  (Priv ¬ª <br>  ["SIPpeers"] =&gt; <br>  string (36) ‚ÄúList SIP peers (text format).  (Priv ¬ª <br>  ["IAXregistry"] =&gt; <br>  string (30) ‚ÄúShow IAX registrations.  (Priv ¬ª <br>  ["IAXnetstats"] =&gt; <br>  string (25) ‚ÄúShow IAX Netstats.  (Priv ¬ª <br>  ["IAXpeerlist"] =&gt; <br>  string (22) ‚ÄúList IAX Peers.  (Priv ¬ª <br>  ["IAXpeers"] =&gt; <br>  string (22) ‚ÄúList IAX peers.  (Priv ¬ª <br>  ["Park"] =&gt; <br>  string (22) ‚ÄúPark a channel.  (Priv ¬ª <br>  ["ParkedCalls"] =&gt; <br>  string (25) ‚ÄúList parked calls.  (Priv ¬ª <br>  ["Parkinglots"] =&gt; <br>  string (33) "Get a list of parking lots (Priv" <br>  ["FAXStats"] =&gt; <br>  string (35) "Responds with fax statistics (Priv" <br>  ["FAXSession"] =&gt; <br>  string (67) "Responds with a detailed description of a single FAX session (Priv" <br>  ["FAXSessions"] =&gt; <br>  string (32) "Lists active FAX sessions (Priv" <br>  ["PJSIPShowResourceLists"] =&gt; <br>  string (55) "Displays settings for configured resource lists.  (Priv ¬ª <br>  ["PJSIPShowSubscriptionsOutbound"] =&gt; <br>  string (27) ‚ÄúLists subscriptions.  (Priv ¬ª <br>  ["PJSIPShowSubscriptionsInbound"] =&gt; <br>  string (27) ‚ÄúLists subscriptions.  (Priv ¬ª <br>  ["UnpauseMonitor"] =&gt; <br>  string (39) ‚ÄúUnpause monitoring of a channel.  (Priv ¬ª <br>  ["PauseMonitor"] =&gt; <br>  string (37) ‚ÄúPause monitoring of a channel.  (Priv ¬ª <br>  ["ChangeMonitor"] =&gt; <br>  string (47) ‚ÄúChange monitoring filename of a channel.  (Priv ¬ª <br>  ["StopMonitor"] =&gt; <br>  string (33) "Stop monitoring a channel.  (Priv ¬ª <br>  ["Monitor"] =&gt; <br>  string (25) ‚ÄúMonitor a channel.  (Priv ¬ª <br>  ["PJSIPQualify"] =&gt; <br>  string (37) ‚ÄúQualify a chan_pjsip endpoint.  (Priv ¬ª <br>  ["PJSIPShowEndpoint"] =&gt; <br>  string (53) ‚ÄúDetail of the endpoint and its objects.  (Priv ¬ª <br>  ["PJSIPShowEndpoints"] =&gt; <br>  string (29) ‚ÄúLists PJSIP endpoints.  (Priv ¬ª <br>  ["BridgeKick"] =&gt; <br>  string (36) ‚ÄúKick a channel from a bridge.  (Priv ¬ª <br>  ["BridgeDestroy"] =&gt; <br>  string (24) ‚ÄúDestroy a bridge.  (Priv ¬ª <br>  ["BridgeInfo"] =&gt; <br>  string (38) "Get information about a bridge.  (Priv ¬ª <br>  ["BridgeList"] =&gt; <br>  string (43) "Get a list of bridges in the system."  (Priv ¬ª <br>  ["BlindTransfer"] =&gt; <br>  string (57) "Blind transfer channel (s) to the given destination (Priv" <br>  ["Filter"] =&gt; <br>  string (63) "Dynamically add filters for the current manager session.  (Priv ¬ª <br>  ["ModuleCheck"] =&gt; <br>  string (33) "Check if module is loaded.  (Priv ¬ª <br>  ["ModuleLoad"] =&gt; <br>  string (25) ‚ÄúModule management.  (Priv ¬ª <br>  ["CoreShowChannels"] =&gt; <br>  string (38) "List currently active channels.  (Priv ¬ª <br>  ["LoggerRotate"] =&gt; <br>  string (45) "Reload and rotate the Asterisk logger.  (Priv ¬ª <br>  ["Reload"] =&gt; <br>  string (27) ‚ÄúSend a reload event.  (Priv ¬ª <br>  ["CoreStatus"] =&gt; <br>  string (38) ‚ÄúShow PBX core status variables.  (Priv ¬ª <br>  ["CoreSettings"] =&gt; <br>  string (44) ‚ÄúShow PBX core settings (version etc).  (Priv ¬ª <br>  ["UserEvent"] =&gt; <br>  string (31) ‚ÄúSend an arbitrary event.  (Priv ¬ª <br>  ["UpdateConfig"] =&gt; <br>  string (34) ‚ÄúUpdate basic configuration.  (Priv ¬ª <br>  ["SendText"] =&gt; <br>  string (36) ‚ÄúSend text message to channel.  (Priv ¬ª <br>  ["ListCommands"] =&gt; <br>  string (39) "List available manager commands.  (Priv ¬ª <br>  ["MailboxCount"] =&gt; <br>  string (35) "Check Mailbox Message Count.  (Priv ¬ª <br>  ["MailboxStatus"] =&gt; <br>  string (21) ‚ÄúCheck mailbox.  (Priv ¬ª <br>  ["AbsoluteTimeout"] =&gt; <br>  string (28) ‚ÄúSet absolute timeout.  (Priv ¬ª <br>  ["PresenceState"] =&gt; <br>  string (27) "Check Presence State (Priv" <br>  ["ExtensionState"] =&gt; <br>  string (30) ‚ÄúCheck Extension Status.  (Priv ¬ª <br>  ["Command"] =&gt; <br>  string (36) ‚ÄúExecute Asterisk CLI Command.  (Priv ¬ª <br>  ["Originate"] =&gt; <br>  string (24) ‚ÄúOriginate a call.  (Priv ¬ª <br>  ["Atxfer"] =&gt; <br>  string (25) "Attended transfer.  (Priv ¬ª <br>  ["Redirect"] =&gt; <br>  string (34) ‚ÄúRedirect (transfer) a call.  (Priv ¬ª <br>  ["ListCategories"] =&gt; <br>  string (45) ‚ÄúList categories in configuration file.  (Priv ¬ª <br>  ["CreateConfig"] =&gt; <br>  string (60) "Creates an empty file in the configuration directory.  (Priv ¬ª <br>  ["Status"] =&gt; <br>  string (27) ‚ÄúList channel status.  (Priv ¬ª <br>  ["GetConfigJSON"] =&gt; <br>  string (44) ‚ÄúRetrieve configuration (JSON format).  (Priv ¬ª <br>  ["GetConfig"] =&gt; <br>  string (30) ‚ÄúRetrieve configuration.  (Priv ¬ª <br>  ["Getvar"] =&gt; <br>  string (49) ‚ÄúGets a channel variable or function value.  (Priv ¬ª <br>  ["Setvar"] =&gt; <br>  string (49) ‚ÄúSets a channel variable or function value.  (Priv ¬ª <br>  ["ShowDialPlan"] =&gt; <br>  string (22) "Show dialplan contexts" <br>  } <br>  } <br></div></div><br><br><h2>  Summary </h2><br>  Creating your own class for working with sockets in asynchronous mode is not difficult.  And it does not matter whether it will work with Asterisk AMI or another server application. <br><br><a name="edit1"></a>  Special thanks to <a href="http://habrahabr.ru/users/HiNeX/">HiNeX</a> for errors found in the intermediate code. <br><br><a name="edit2"></a>  Changed the finished class in connection with the recommendations of <a href="http://habrahabr.ru/users/AotD/">AotD</a> and <a href="http://habrahabr.ru/users/RUgaleFF/">RUgaleFF</a> . <br><br>  Thanks to everyone who read it.  And see you on the TM portals. <br><br>  (If you think it is worth continuing, which of the AMER Asterisk functionaries do you want me to show in the next part? Write in the comments.) <br><br>  We kindly request for those who minus the article, if it is not difficult for you, please write the reason. </div><p>Source: <a href="https://habr.com/ru/post/253387/">https://habr.com/ru/post/253387/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253373/index.html">Building an Ethernet network for IP video surveillance</a></li>
<li><a href="../253379/index.html">Simple ticket system for customer support: open beta and launch history</a></li>
<li><a href="../253381/index.html">Not everyone can write their name in Unicode.</a></li>
<li><a href="../253383/index.html">Invisible interface</a></li>
<li><a href="../253385/index.html">Modular data centers from the Middle Kingdom and Asia</a></li>
<li><a href="../253389/index.html">The hero of IT-stories: quest</a></li>
<li><a href="../253391/index.html">DUMP-2015 Conference: Serverside.Experience and Serverside.Knowledge section</a></li>
<li><a href="../253393/index.html">As we with third-graders programmed the address garland</a></li>
<li><a href="../253395/index.html">Mongoose rake</a></li>
<li><a href="../253397/index.html">Dagaz: Kicks to common sense (part 4)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>