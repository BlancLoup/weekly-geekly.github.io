<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementing the ElementTraversal Interface</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quite a lot of browsers (Opera 9.6, Google Chrome 2, Safari 4, Firefox 3.5) have got support for the very convenient ElementTraversal interface, which...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementing the ElementTraversal Interface</h1><div class="post__text post__text-html js-mediator-article">  Quite a lot of browsers (Opera 9.6, Google Chrome 2, Safari 4, Firefox 3.5) have got support for the very convenient <a href="http://www.w3.org/TR/ElementTraversal/">ElementTraversal</a> interface, which allows you to navigate the DOM tree, ignoring text nodes.  In these browsers, the following set of new <a href="https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide/Creating_New_Objects/Defining_Getters_and_Setters">getters</a> is available for each element: <ul><li>  firstElementChild is the first child; </li><li>  lastElementChild - the last child element; </li><li>  nextElementSibling - the next neighboring element; </li><li>  previousElementSibling - previous neighboring element; </li><li>  childElementCount - the number of children. </li></ul><a name="habracut"></a>  Without going into details of the implementation of these getters and relying on the words from the specification: <br><blockquote>  The ElementTraversal interface is a set of read-only <b>attributes</b> ... </blockquote>  we will call them further attributes. <br><br>  Let's clarify: the elements are called DOM-tree nodes that have the nodeType property equal to 1;  elements correspond tags. <br><br>  The use of these attributes should improve the performance of JavaScript applications when navigating the DOM tree, since there is no need to check nodeType nodes in the loop and use additional wrapper functions.  And the childElementCount attribute lets you know if the current node has children at all, unlike the almost useless hasChildNodes method.  Of course, you can check for the presence of child elements as follows: <br><blockquote><code><font color="black">node.getElementsByTagName( <font color="#A31515">"*"</font> ).length</font></code> </blockquote>  But this method is too wasteful; the childElementCount built-in attribute should theoretically work much faster. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All this is certainly good and interesting, but what to do with old browsers that do not support the ElementTraversal interface?  Obviously, you have to write additional functions for each attribute.  You can see their implementation in the article ‚Äú <a href="http://www.codeisart.ru/js-core-fast-dom-element-traversing/">Quick search for DOM elements</a> ‚Äù, although I think that for many it will not be difficult to write such functions yourself, there is nothing difficult about that. <br><br>  And now the most interesting thing is that Internet Explorer 8 has the opportunity to create these same <a href="http://msdn.microsoft.com/en-us/library/dd229916(VS.85).aspx">getters and setters</a> .  It is strange only why in any review on innovations IE8 did not sound about this powerful and useful mechanism.  In JScript, you can now create getter or setter using the defineProperty method of the built-in Object.  We recall that this possibility, through the methods __defineGetter__ and __defineSetter__, was originally in browsers based on Gecko, as it turned out already in Safari 3, and in Opera 9.6 implemented this mechanism. <br><br>  So, having the ability to create getters, we can implement support for the ElementTraversal interface in Internet Explorer 8, Mozilla Firefox 2+ and Safari 3+, but Opera 9.6 already supports it. <br><br>  It remains to write the code: <br><blockquote> <code><font color="black"><font color="#008000">//      </font> &lt;br&gt; <font color="#0000ff">var</font> element = <font color="#0000ff">document</font> .createElement( <font color="#A31515">"div"</font> );&lt;br&gt;&lt;br&gt; <font color="#008000">// ,     ElementTraversal</font> &lt;br&gt; <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> element.firstElementChild == <font color="#A31515">"undefined"</font> ) {&lt;br&gt;&lt;br&gt; <font color="#008000">//     </font> &lt;br&gt; <font color="#0000ff">var</font> ElementTravrsal = {&lt;br&gt;&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt;    firstElementChild: <font color="#0000ff">function</font> () {&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt; <font color="#0000ff">var</font> node = <font color="#0000ff">this</font> .firstChild;&lt;br&gt; <font color="#008000">//        </font> &lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">while</font> (node &amp;&amp; node.nodeType != 1) node = node.nextSibling;&lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">return</font> node;&lt;br&gt;    },&lt;br&gt;&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt;    lastElementChild: <font color="#0000ff">function</font> () {&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt; <font color="#0000ff">var</font> node = <font color="#0000ff">this</font> .lastChild;&lt;br&gt; <font color="#008000">//        </font> &lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">while</font> (node &amp;&amp; node.nodeType != 1) node = node.previousSibling;&lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">return</font> node;&lt;br&gt;    },&lt;br&gt;&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt;    nextElementSibling: <font color="#0000ff">function</font> () {&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt; <font color="#008000">//     </font> &lt;br&gt; <font color="#0000ff">var</font> node = <font color="#0000ff">this</font> ;&lt;br&gt; <font color="#008000">//        </font> &lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">do</font> node = node.nextSibling&lt;br&gt; <font color="#0000ff">while</font> (node &amp;&amp; node.nodeType != 1);&lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">return</font> node;&lt;br&gt;    },&lt;br&gt;&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt;    previousElementSibling: <font color="#0000ff">function</font> () {&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt; <font color="#008000">//     </font> &lt;br&gt; <font color="#0000ff">var</font> node = <font color="#0000ff">this</font> ;&lt;br&gt; <font color="#008000">//        </font> &lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">do</font> node = node.previousSibling;&lt;br&gt; <font color="#0000ff">while</font> (node &amp;&amp; node.nodeType != 1);&lt;br&gt; <font color="#008000">//     null</font> &lt;br&gt; <font color="#0000ff">return</font> node;&lt;br&gt;    },&lt;br&gt;&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt; <font color="#008000">// ,      children</font> &lt;br&gt;    childElementCount: <font color="#0000ff">typeof</font> element.children == <font color="#A31515">"undefined"</font> ? <font color="#0000ff">function</font> () {&lt;br&gt; <font color="#008000">//    children,</font> &lt;br&gt; <font color="#008000">//      </font> &lt;br&gt; <font color="#0000ff">var</font> list = <font color="#0000ff">this</font> .childNodes,&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt;      i = list.length,&lt;br&gt; <font color="#008000">//   </font> &lt;br&gt;      j = 0;&lt;br&gt; <font color="#008000">//       ,</font> &lt;br&gt; <font color="#0000ff">while</font> (i--)&lt;br&gt; <font color="#008000">//   ,</font> &lt;br&gt; <font color="#0000ff">if</font> (list[i].nodeType == 1)&lt;br&gt; <font color="#008000">//  </font> &lt;br&gt;          j++;&lt;br&gt; <font color="#008000">//      0</font> &lt;br&gt; <font color="#0000ff">return</font> j;&lt;br&gt;    } : <font color="#0000ff">function</font> () {&lt;br&gt; <font color="#008000">//   children,</font> &lt;br&gt; <font color="#008000">//      </font> &lt;br&gt; <font color="#008000">//    </font> &lt;br&gt; <font color="#0000ff">return</font> <font color="#0000ff">this</font> .children.length;&lt;br&gt;    }&lt;br&gt;  };&lt;br&gt;&lt;br&gt; <font color="#008000">//    IE8</font> &lt;br&gt; <font color="#0000ff">if</font> (Object.defineProperty)&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> property <font color="#0000ff">in</font> ElementTravrsal)&lt;br&gt; <font color="#0000ff">if</font> (ElementTravrsal.hasOwnProperty(property))&lt;br&gt;        Object.defineProperty(Element.prototype, property, {&lt;br&gt;          get: ElementTravrsal[property]&lt;br&gt;        });&lt;br&gt;&lt;br&gt; <font color="#008000">//  Firefox 2+  Safari 3+</font> &lt;br&gt; <font color="#0000ff">if</font> (Object.__defineGetter__)&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> property <font color="#0000ff">in</font> ElementTravrsal)&lt;br&gt; <font color="#0000ff">if</font> (ElementTravrsal.hasOwnProperty(property))&lt;br&gt;        HTMLElement.prototype.__defineGetter__(property, ElementTravrsal[property]);&lt;br&gt;&lt;br&gt;}</font></code> </blockquote>  By including this code in the project, you can now use ElementTraversal in most browsers: <ul><li>  Internet Explorer 8; </li><li>  Mozilla Firefox 2+ and other browsers based on Gecko 1.8+; </li><li>  Opera 9.6+ (maybe 9.5+); </li><li>  Safari 3+ (maybe even 2? Unfortunately, there is no way to check); </li><li>  Google Chrome 2+. </li></ul>  For the development of some services or administrative interfaces of this list may well be enough.  Well, if you need support for all browsers, without additional features, as in the article below the link above, you can not do.  Or you can still expand the list of supported browsers?  If you have ideas on how to do this in other browsers, write in the comments, even if they are irrational decisions, the implementation itself is interesting. <br><br>  The attributes of the new interface are used in the same way as the old firstChild, lastChild, nextSibling, and so on. For example, take the following XHTML code: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="test"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;  TextNode&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> TextNode <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt;  TextNode&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> TextNode <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> &lt;br&gt;  TextNode&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt;TextNode&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> TextNode <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font></font></code> </blockquote>  And let's do a few moves through the DOM tree in JavaScript: <br><blockquote> <code><font color="black"><font color="#008000">//    </font> &lt;br&gt; <font color="#008000">//   "test"</font> &lt;br&gt; <font color="#0000ff">var</font> node = <font color="#0000ff">document</font> .getElementById( <font color="#A31515">"test"</font> );&lt;br&gt;&lt;br&gt; <font color="#008000">//  tagName  </font> &lt;br&gt;alert(node.nextElementSibling.tagName); <font color="#008000">// ‚Üí "P"</font> &lt;br&gt;&lt;br&gt; <font color="#008000">//    </font> &lt;br&gt;node = node.lastElementChild;&lt;br&gt;&lt;br&gt; <font color="#008000">//  ,     ?</font> &lt;br&gt;alert(node.childElementCount); <font color="#008000">// ‚Üí "0"</font> &lt;br&gt;&lt;br&gt; <font color="#008000">//    ?</font> &lt;br&gt;alert(node.hasChildNodes()); // ‚Üí <font color="#A31515">"true"</font></font></code> </blockquote>  If it was interesting, I can write more about using getters and setters in JScript and JavaScript in the next article. <br><br>  Archive with the code from the article: <a href="">ElementTraversal.zip</a> <br><br>  <b>Update:</b> transferred to the thematic blog, thanks for the karma :-) </div><p>Source: <a href="https://habr.com/ru/post/54380/">https://habr.com/ru/post/54380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../54372/index.html">A bit of search humor</a></li>
<li><a href="../54373/index.html">iBluetooth - file transfer is now possible.</a></li>
<li><a href="../54374/index.html">Yota opens its licensed multimedia content for everyone</a></li>
<li><a href="../54375/index.html">Oddities in Delphi 7</a></li>
<li><a href="../54376/index.html">What do you need in the admin of the online store?</a></li>
<li><a href="../54381/index.html">Dance with macbook air.</a></li>
<li><a href="../54382/index.html">Freelance one day</a></li>
<li><a href="../54383/index.html">PRO aki for money or for brains</a></li>
<li><a href="../54390/index.html">Report</a></li>
<li><a href="../54392/index.html">Advertising mail.ru in gmail  ªe! WTF ?!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>