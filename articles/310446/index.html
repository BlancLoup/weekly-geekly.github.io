<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing Hello World for HoloLens</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are glad to share unique material prepared specifically for our blog by Gleb Zakharov , Zengalt's HoloLens Lead - step-by-step instructions for dev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing Hello World for HoloLens</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i>We are glad to share unique material prepared specifically for our blog by <a href="https://habrahabr.ru/users/zakbelg/">Gleb Zakharov</a> , <a href="http://zengalt.com/">Zengalt's</a> HoloLens Lead - step-by-step instructions for developing an application for Microsoft HoloLens and launching it in an emulator.</i>  <i>In the article you will also find an overview of the device itself and learn about the types of applications.</i> </blockquote><br> <a href="https://habrahabr.ru/company/microsoft/blog/310446/"><img src="https://habrastorage.org/files/3f7/9d9/907/3f79d9907e8b4afc80f8b344dbdc8532.png"></a> <br>  HoloLens is a Windows 10 PC (2GB RAM, 64GB SSD, x86 CPU, GPU, HPU, BT, WiFi, <a href="https://www.microsoft.com/microsoft-hololens/en-us/development-edition">detailed specifications can be viewed here</a> ) in the form of a device similar to glasses for skiing.  Through the glasses you can see everything around, although they darken the picture a little. <br><br>  On Habr√© already had a review of this device from the conference <a href="https://habrahabr.ru/post/281539/">// Build</a> .  In this article, I suggest you write an application for HoloLens and run it in the emulator. <br><a name="habracut"></a><br><h3>  Device overview </h3><br>  Two transparent screens are built into the visor - one before each eye.  Several cameras look ahead and to the sides, and above the ears there are two small speakers, the sound of which is superimposed on the sound of the environment. <br><br>  Stereoscopic image.  Therefore, you need to think about the focal length.  For example, we at the very beginning deduced the debug text using the focal length of 30 centimeters.  My eyes hurt.  There are no keyboards and mice, although they can be connected via Bluetooth.  The main way to control the device is the cursor, which moves along with turning the head (‚Äúgaze‚Äù), and a pinch-like gesture that replaces the usual tap (‚Äúair tap‚Äù).  Voice control works well.  Although, while only English is available. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      With the help of cameras, the device scans the surrounding space and turns it into a 3D model, access to which can be obtained directly in Unity (a special version is used for device development) or through the Windows API.  One of the most frequent applications of this feature is searching for the floor and installing holograms on it. <br><br><img src="https://habrastorage.org/files/b0f/51c/f41/b0f51cf41172436c981a15c5287b5e75.jpg"><br><br>  In the future, such devices will replace everything that has screens and sound.  Imagine that you can edit in real time how you see and hear the real world.  For example, the neighbors play music that you do not like.  You can get rid of it or replace it with the one you like.  Without the help of a drill, you can hang any number of posters or marker boards anywhere.  One gesture to rearrange (virtual) TV.  Smartphones, televisions, signs, road signs, light bulbs and displays on household appliances - all this will be a thing of the past, as soon as devices like HoloLens start to cost as much as a smartphone costs now, they will look like ordinary glasses.  These are only the most obvious examples, we are sure that the changes will be more global.  For example, the future might look like this (we hope not): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/166807261" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  That is, this technology, unlike pure VR, is the next platform for everything. <br><br>  It makes sense to start developing under HoloLens right now because there is already effective demand from banks, the oil industry, education, engineering, architects.  And you have a chance to be the first.  Devices are becoming available much faster than we expected.  A couple of months ago, they were a rarity, but now everyone can order five pieces in the American Microsoft Store. <br><br><img src="https://habrastorage.org/files/eb1/d66/ca0/eb1d66ca0fe7420f957088de0c165771.jpg"><br><br>  Since HoloLens runs on Windows 10, applications for it are developed on the Universal Windows Platform (UWP).  This means that applications developed previously for mobile devices, desktop and Xbox based on UWP can be run on HoloLens. <br><br><img src="https://habrastorage.org/files/92c/0e9/fd6/92c0e9fd67004f8199569a66499954fc.jpg"><br><br><h3>  Types of HoloLens Applications </h3><br>  A set of developer tools depends heavily on the type of application you want to make.  Currently HoloLens applications support 2 types of views (views): 2D views and Holographic views. <br><br>  The 2D view is a display of the 2D content we are used to as a plate inside the shell HoloLens.  (see screenshot above) At the same time, many applications can be rendered in a 2D view, so organizing the workspace around you with simultaneously running mail, a browser and skype will be easy. <br><br>  Holographic View - in this mode, the application can create holograms around you.  At the same time, holograms of other applications and the shell OS are not visible, and any system notifications will be pronounced in a voice using Cortana. <br><br><img src="https://habrastorage.org/files/a6d/671/343/a6d671343a4849f5b8ffa8d31956f752.jpg"><br>  <a href="https://www.microsoft.com/en-us/store/p/dinosaurs-by-zengalt/9nblggh50zx1">Land of Dinosaurs</a> is our first app in the HoloLens Store. <br><br>  You can switch between these two types.  One of the frequent scenarios for combining several views in one application is the transition from Holographic View to 2D view to enter text into the input field using the on-screen keyboard. <br><br>  For the development of 2D views, the main tool will be Visual Studio and UWP API with XAML and / or DirectX.  To develop Holographic Views, it is proposed to use 2 approaches - development using Visual Studio and DirectX or Unity3D. <br>  In this article we will look at creating an application with one Holographic View in Unity3D. <br><br><h3>  Step 0: Install Tools </h3><br><h4>  System requirements </h4><br><ul><li>  If you do not have a device, then to run the emulator you will need Windows 10 64-bit with Hyper-V support: Windows 10 Pro, Enterprise or Education.  Win 10 Home will be enough otherwise </li><li>  64-bit CPU with 4 or more cores and virtualization support </li><li>  8 Gb of RAM or more (If you plan to develop network applications, then 12Gb or more, because to run several HoloLens emulators you will need about 10-11Gb RAM </li><li>  BIOS support for the following functions: <br><ol><li>  Hardware-assisted virtualization </li><li>  Second Level Address Translation (SLAT) </li><li>  Hardware-based Data Execution Prevention (DEP) </li></ol><br></li><li>  GPU (The emulator may work with an unsupported GPU, but it will work much slower) </li></ul><br><br><img align="right" src="https://habrastorage.org/files/f10/0e0/58a/f100e058af6d40e39c99b5c8fe9e536e.png">  If your PC meets these requirements and you plan to use HoloLens Emulator for testing, you will need to activate the above settings in the BIOS. <br>  After that, you need to enable Hyper-V support in the Windows Control Panel.  To do this, go to Control Panel -&gt; Programs -&gt; Programs and Features -&gt; Turn Windows Features on or off.  Find and select the Hyper-V section.  After installation is complete, reboot. <br><br><h4>  Instruments </h4><br><ul><li>  <a href="https://www.microsoft.com/en-us/software-download/windows10/">Windows 10</a> </li><li>  <a href="https://www.visualstudio.com/en-us/news/releasenotes/vs2015-update3-vs">Visual Studio 2015 Update 3</a> (Community Edition) </li><li>  <a href="https://developer.microsoft.com/en-us/windows/downloads/windows-10-sdk">Windows 10 SDK v.</a>  <a href="https://developer.microsoft.com/en-us/windows/downloads/windows-10-sdk">1511 or higher</a> (If you did not install it with Visual Studio 2015) </li><li>  <a href="http://go.microsoft.com/fwlink/%3FLinkID%3D724053">HoloLens Emulator</a> or <a href="https://www.microsoft.com/microsoft-hololens/en-us/development-edition">HoloLens Development Edition</a> </li><li>  <a href="https://unity3d.com/partners/windows/hololens">Unity 3D HoloLens Technical Preview</a> </li></ul><br><br>  To avoid errors during the assembly of the application, it is recommended to install the tools sequentially, in the specified order. <br><br><h3>  Step 1: Create a project </h3><br>  Now we have everything we need for work, let's start to make our hello world application.  Run Unity Hololens Technical Preview (HTP) and create an empty project.  Select a name and location on the disk.  For a project type, select 3D and click <i>Create project</i> . <br><br><img src="https://habrastorage.org/files/a17/78f/15d/a1778f15d475417f86b4b031198f4437.png"><br><br><h4>  Main Camera Setup </h4><br>  After creating the project, Unity will automatically create and open an empty scene with a camera and a light source.  Pay attention to the following panels: <br><br><ol><li>  <i>Scene</i> - the elements that we put in the 3D world.  Now it is only a light source and a camera. </li><li>  <i>Game</i> viewing application in game mode </li><li>  <i>The Hierarchy</i> contains all the elements of your scene. </li><li>  <i>Inspector</i> shows the properties of the selected item. </li><li>  <i>Project</i> all rerurs files added for the current project. </li></ol><br>  Let's start with the camera setup.  In Holographic View mode, the main camera is the position between human eyes.  Therefore, reset the default offset (0,0,0).  The position and rotation of the camera while the application is running in the emulator or on the device will change with the position and tilt of the user's head. <br><br><img src="https://habrastorage.org/files/019/dd7/a4d/019dd7a4dca240f8ab1a2b6b08c3472d.png"><br><br>  You can customize the location of the tabs as you like. <br><br>  HoloLens allows you to project 3D objects in the real world.  To do this, the camera must have a transparent background.  To set it, set the camera's <i>Clear Flags</i> value to <i>Solid Color</i> .  After that, set the <i>Background</i> to [0,0,0,0] or # 00000000.  For a more accurate simulation of the device in Unity, set the camera's <i>Field of View</i> to 16-20. <br><br><h3>  Step 2: Add a 3d object to the scene </h3><br>  We have prepared for the article a 3D model of <a href="https://drive.google.com/file/d/0B-U_29IHtG_vQWJMU25HNW8yYlE/view">Hello world.</a>  Download and add the .fbx model file to the <i>Assets</i> folder of the project.  Or drag the file into the <i>Assets</i> area of ‚Äã‚Äãthe <i>Project</i> panel.  After successfully importing the model, add it to the scene. <br><br>  To do this, drag the HelloWorld model from the Project panel to the Hierarchy window.  Set the position at Z = 3 and expand the inscription to 180 so that it looks at the camera by default.  The original model is quite large, let's reduce it a bit by setting the <i>Scale</i> to 0.25 and save the scene with any name. <br><br><img src="https://habrastorage.org/files/83c/4cc/a0f/83c4cca0ff2c4b07aa95d311e7cd84fe.gif"><br><br><h4>  Meet HoloToolkit </h4><br>  Microsoft and the community have developed a set of components to accelerate the development of applications for HoloLens. <br><br>  Currently the <a href="https://github.com/Microsoft/HoloToolkit-Unity">github</a> repository contains components and examples of working with the API: <br><br><ul><li>  Input with gestures, speech generation </li><li>  Shared experience - tools for implementing joint experience in the application </li><li>  Determination and processing of surfaces in space </li><li>  Spatial sound </li><li>  Accelerating the application build process </li><li>  Ready components and scripts for the cursor, camera control and others. </li></ul><br>  Let's import HoloToolkit into our project and look at some of the components.  To do this, clone the HoloToolkit repository to your disk and open it in Unity.  In the <i>Project</i> panel in the context menu of the <i>Assets</i> root folder, select <i>Export Package</i> .  Wait for the download of the list of files to export, click <i>Export</i> and specify the path to save the package. <br><br><img src="https://habrastorage.org/files/128/09c/a95/12809ca95c1c4da88cbf3eee8197c6ad.png"><br><br>  After the end of the export, import this package into your project by calling the context menu on the root folder <i>Assets</i> .  Select <i>Import Package -&gt; Custom Package</i> . <br><br>  After the end, assets from HoloToolkit will be added to the project.  A new menu group will appear in the Unity menu, allowing you to quickly apply general settings for the project and make a quick deployment.  As part of this article, we will not use these options for the purpose of training. <br><br>  Detailed settings for importing HoloToolkit into a project can be found on the project wiki on github: <a href="">HoloToolkit Getting Started</a> <br><br><h4>  We add components for debugging in Unity </h4><br>  To begin, let's add camera control in the Unity editor.  Select the camera object in the <i>Hierarchy</i> panel.  In the <i>Inspector</i> panel, click <i>Add Component</i> and in the window that opens, enter <i>Manual</i> .  Select the <i>Manual Camera Control</i> component from the list.  Now press Ctrl + P or Play button on the bar above.  The application will start and you can navigate through it using WASD and look around using Shift. <br><br>  In the settings of the <i>Manual Camera Control</i> script, you can adjust the control keys, the sensitivity of the mouse, the axis of movement, etc., to your taste. <br><br><h4>  Display room in Unity and emulator </h4><br>  If you are developing an application for HoloLens, you will definitely encounter the need to place your holograms with reference to the surrounding space. <br><br>  Examples are easy: <br><br><ul><li>  Virtually any application under HoloLens requires an understanding of the level of the floor in the room where it is launched in order to correctly place the holograms. </li><li>  Maybe you are writing an action / strategy game. Perhaps you want monsters / robots / ships to <a href="https://www.youtube.com/watch%3Fv%3DHf9qkURqtbM">appear from the walls.</a> You need to understand where the walls are. </li></ul><br>  For this, HoloLens has a special API for getting real-time surfaces.  In Unity and HoloToolkit to work with him there are several ready-made components, which are sufficient for the implementation of most of these cases. <br><br>  First, let's load the finished room model and display it in Unity.  To do this, find in the project resources in the Project tab a ready-made component <i>SpatialMapping</i> and add it to the scene.  This component consists of 3 parts: <br><br><ul><li>  <i>SpatialMappingObserver</i> is a script that uses the Unity <i>SurfaceObserver</i> API to get surfaces from HoloLens.  In it you can specify the volume you are interested in in the space in which you want to get the surface, the number of polygons per cubic meter of space and the frequency of updates.  Surface analysis is a time consuming process, so fine tuning of parameters is extremely important for fast application operation. </li></ul><br><ul><li>  <i>SpatialMappingManager</i> - control of the source of surfaces, as a rule, this is the SpatialMappingObserver script in the emulator or ObjectSurfaceObserver in the Unity editor. </li></ul><br><ul><li>  <i>ObjectSurfaceObserver</i> - load the finished room model from the device or emulator. </li></ul><br>  The imported HoloToolkit package already has a finished room model.  Let's load it into <i>ObjectSurfaceObserver</i> .  Select the <i>Room Model</i> field in the <i>Inspector</i> panel, find the SRMesh object in the search and select it with a double click.  Launch the application and you should have a room model drawn by a white grid.  At the same time, surface objects will be dynamically added when launched into a <i>SpatialMapping</i> object. <br><br><img src="https://habrastorage.org/files/388/274/50a/38827450ad7d4f77bfee6291a31c80a2.PNG"><br><br>  As can be seen in the screenshot, the inscription added earlier is almost completely hidden by the room model.  This is also one of the nice possibilities of integrating with the space in HoloLens - you can add shadows from holograms or overlapping holograms with the surrounding world. <br><br><h4>  Look, gestures, and snapping to surfaces </h4><br>  This problem can be solved in different ways.  In this article we will allow the user to install this inscription on the surrounding surfaces using glances and gestures. <br><br>  To do this, add 2 scripts responsible for controlling the look and gestures to the main camera - <i>GazeManager</i> and <i>GestureManager</i> .  Add a <i>Tap To Place</i> and <i>Box Collider</i> script to the label object.  Disable the display of the default room through the <i>Draw Visual Meshes</i> property of the <i>SpatialMappingManager</i> component and launch the application. <br><br>  In the game mode, look at the inscription and press the spacebar.  Now the inscription will move with us and if you look at the surface - it will automatically ‚Äústick‚Äù to it. <br><br>  Each frame of <i>GazeManager</i> checks which object the user is <i>viewing</i> and remembers it using the standard Unity <a href="https://docs.unity3d.com/ScriptReference/Physics.Raycast.html">Physics.Raycast</a> API.  Remember we added a <i>box collider</i> for our label?  This object describes the shape of the object for the calculation of collisions by the physical engine, which allows us to easily check whether a person is looking at the object. <br><br>  Next, tapu (the space key in Unity) checks if a person is looking at an object, and if so, the OnSelect message is sent to the object, which calls the same-name method for our <i>text</i> in <i>TapToPlace</i> , which starts or ends its movement. <br><br>  At the same time, the <i>TapToPlace</i> script <i>,</i> at the end of the movement process, saves the position of the object in space, tying it to the so <a href="https://developer.microsoft.com/ru-ru/windows/holographic/spatial_anchors">-called spatial anchor</a> (World Anchor).  At the same time, the anchor itself is saved in the device's memory and the next time the application is launched, the script will load it and the inscription appear in the same place where the user left it. <br><br>  The standard implementation of the <i>TapToPlace</i> script has 2 problems that we need to solve: <br><br><ul><li>  when installed on the floor, the inscription will be half immersed in the floor. </li><li>  the inscription will be rotated from the user, its forward vector will coincide with the camera forward.  It would be nice to deploy it to the user. </li></ul><br>  Open the <i>TapToPlace</i> script in VisualStudio / MonoDevelop / Notepad / etc.  and change the code responsible for setting the object on the surface. <br><br><div class="spoiler">  <b class="spoiler_title">Setting an object in TapToPlace</b> <div class="spoiler_text"><pre><code class="cs hljs">RaycastHit hitInfo; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(headPosition, gazeDirection, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> hitInfo, <span class="hljs-number"><span class="hljs-number">30.0f</span></span>, SpatialMappingManager.Instance.LayerMask)) { <span class="hljs-comment"><span class="hljs-comment">// Move this object to where the raycast // hit the Spatial Mapping mesh. // Here is where you might consider adding intelligence // to how the object is placed. For example, consider // placing based on the bottom of the object's // collider so it sits properly on surfaces. Vector3 surfacePoint = hitInfo.point; surfacePoint.y += GetComponent&lt;Renderer&gt;().bounds.extents.y/2; this.transform.position = surfacePoint; // Rotate this object to face the user. Quaternion toQuat = Camera.main.transform.localRotation; toQuat.x = 0; toQuat.z = 0; this.transform.rotation = toQuat * Quaternion.AngleAxis(180, Vector3.up); }</span></span></code> </pre> </div></div><br>  In this piece, we take the position of the intersection of the user's ray of sight with the surrounding surface: <br><br><pre> <code class="cs hljs">Vector3 surfacePoint</code> </pre> <br>  and raise it along the vertical axis half the size of our inscription.  So that she was above the level of the floor. <br><br><pre> <code class="cs hljs">surfacePoint.y += GetComponent&lt;Renderer&gt;().bounds.extents.y/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transform.position = surfacePoint;</code> </pre> <br>  Next, we expand the inscription 180 degrees around the vertical axis, taking into account the rotation of the camera.  It turns out when linking the inscription will always be turned on one axis to the user. <br>  That's all, our tap to place logic is ready. <br><br><h4>  Voice commands </h4><br>  The Windows 10 API has an extremely powerful <a href="https://developer.microsoft.com/ru-ru/windows/speech">API for working with speech recognition and generation</a> .  HoloLens has 4 microphones on board and perfectly recognizes speech.  Therefore, voice control in the application successfully complements the work with gestures. <br>  As an example of the implementation of such logic, we will write with you a simple script that will respond to the phrase <i>Change color</i> and randomly change the color of the label.  Note  author: the script code is left as simple as possible and is given as an example. <br>  To do this, add <i>C # Script</i> to the project and call it Change Color Command.  To do this, in the Unity menu, select <i>Assets-&gt; Create -&gt; C # Script</i> .  Double click on it in Unity to open the editor. <br><br><div class="spoiler">  <b class="spoiler_title">Script template</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ChangeColorCommand</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Use this for initialization void Start () { } // Update is called once per frame void Update () { } }</span></span></code> </pre> </div></div><br>  Add the following line to the <i>using</i> section: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.Windows.Speech;</code> </pre> <br>  This will allow us to use the built-in Unity wrapper to work with voice commands.  Add a field-reference to an object of type KeywordRecognizer and a link to the Renderer component for which we will change color. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> KeywordRecognizer keywordRecognizer; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Renderer target;</code> </pre> <br>  Perform the initial initialization of this component inside the Start method.  The Start method will be called once after adding this script to the scene. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> commands = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-string"><span class="hljs-string">"Change color"</span></span> }; keywordRecognizer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KeywordRecognizer(commands); }</code> </pre> <br>  In the Start method, we specify an array of commands that the system will listen to.  Upon successful recognition, an OnPhraseRecognized event will be triggered by keywordRecognizer, in which we will perform a color change.  Add a subscription to the event and the start of voice recognition at the end of the method. <br><br><pre> <code class="cs hljs">keywordRecognizer.OnPhraseRecognized += KeywordRecognizerOnOnPhraseRecognized; keywordRecognizer.Start();</code> </pre> <br>  and a simple handler function: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">KeywordRecognizerOnOnPhraseRecognized</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PhraseRecognizedEventArgs args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (args.text == <span class="hljs-string"><span class="hljs-string">"Change color"</span></span>) GetComponent&lt;Renderer&gt;().material.color = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, Random.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); }</code> </pre> <br>  Inside the function, we check that the phrase ‚ÄúChange color‚Äù was recognized and change the color of the material of the object to which this script will be attached to a random one. <br><br><div class="spoiler">  <b class="spoiler_title">ChangeColorCommand.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.Windows.Speech; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ChangeColorCommand</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> KeywordRecognizer keywordRecognizer; <span class="hljs-comment"><span class="hljs-comment">// Use this for initialization void Start() { var commands = new[] { "Change color" }; keywordRecognizer = new KeywordRecognizer(commands); keywordRecognizer.OnPhraseRecognized += KeywordRecognizerOnOnPhraseRecognized; keywordRecognizer.Start(); } private void KeywordRecognizerOnOnPhraseRecognized(PhraseRecognizedEventArgs args) { if (args.text == "Change color") GetComponent&lt;Renderer&gt;().material.color = new Color(Random.value, Random.value, Random.value); } // Update is called once per frame void Update() { } }</span></span></code> </pre> </div></div><br>  Add the ChangeColorCommand script to the label object and run the application in Unity to check the result.  To test, say ‚ÄúChange color‚Äù and see how the color of the label changes. <br><h4>  Graphics optimization </h4><br>  At the moment, our label uses the slow standard Unity shader, which is more suitable for high-performance platforms than for wearable devices and HoloLens. <br><br>  In addition, there are a number of specific optimizations for HoloLens from the point of view of graphics, for example, using <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb509646.aspx">min16float</a> when implementing shaders. <br><br>  As part of this article, we will not consider in detail the writing of shaders for HoloLens.  And besides, HoloToolkit has a set of customizable optimized standard shaders that will cover most of the needs. <br><br>  Let's replace our label shader with StandardFast.  Select the inscription in the scene hierarchy, and find the section with <i>Material</i> in the <i>Inspector</i> panel.  Inside the drop-down list, select HoloToolkit -&gt; StandardFast. <br>  Even with only one label, our application could work with FPS below 60, which adversely affects the stability of the holograms. <br><br><h3>  Step 3: Configure build options </h3><br>  To run our application on HoloLens, we need to configure the appropriate build parameters in Unity - the Windows type of the project, the name and <a href="https://msdn.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations">Capabilites of the</a> package with the application. <br><br><img src="https://habrastorage.org/files/8ed/5fc/654/8ed5fc654f354acc8164c7459a0d27c7.png"><br><br><ol><li>  Open the menu <i>File -&gt; Build Settings</i> </li><li>  Select the Build Settings Windows Store window from the list and click the <i>Switch Platform</i> button </li><li>  In the <i>Windows Store</i> section <i>,</i> select the SDK - Universal 10, UWP Build Type - D3D and tick the Unity C # Projects checkbox for debugging </li><li>  Click the <i>Players Settings ...</i> button in the Build Settings window.  In the <i>Inspector</i> panel, fill in the company name and application name.  Immediately select the settings section for <i>Windows Store</i> (p.7 in the screenshot) </li><li>  Go to the <i>Other Settings</i> section in the inspector panel and tick the <i>Virtual Reality Supported</i> checkbox, you should appear in the SDK list below ‚ÄúWindows Holographic‚Äù. </li><li>  Next, scroll the inspector panel to the end and in the section <i>Publishing Settings -&gt; Capabilities</i> check the following items <br><br><ul><li>  Internet client </li><li>  Microphone </li><li>  SpatialPerception </li></ul></li></ol><br>  The final step in the configuration process is optimization and quality of resources. <br><br>  Open the menu <i>Edit -&gt; Quality</i> .  In the <i>Inspector,</i> click on the triangle in each column and select <b>Fastest</b> .  It is important to select these settings for both Unity and HoloLens in order to see a more or less current image both there and there.  This profile disables anti-aliasing, imported textures are compressed to half the resolution, shadows are disabled, etc. All these profiles can be customized to your needs, at this stage, the default settings for this performance profile are enough. <br><br><img src="https://habrastorage.org/files/04b/2ea/538/04b2ea5384b14070b2a525c9a966a513.png"><br><br><h3>  Step 4: Build the project in Visual Studio and run in HoloLens Emulator </h3><br>  So, we have our first finished project for HoloLens.  To run it on a device or an emulator, we need to generate a project for Visual Studio, build and upload the assembly to an emulator or device. <br><br><h4>  Build the project </h4><br>  Everything is a little different from the standard Unity build process. <br><br>  Open the <i>Build Settings</i> window, click <i>Add Open Scenes</i> and then <i>Build</i> .  Unity prompts you to select a folder where to generate a solution for Visual Studio.  We in our projects use for this build folder in the root of the project.  After the build process is complete, open the generated solution in Visual Studio. <br><br>  To run on the emulator, install the following parameters in the debug panel: Release, x86, HoloLens Emulator 10.0.14342.1018 <br><br><img src="https://habrastorage.org/files/e0f/6de/d06/e0f6ded06be845ccb01ce320388ba426.png"><br><br>  Press Ctrl + F5 or in the menu Debug -&gt; Start Without Debugging. <br><br>  During this process, Visual Studio: <br><br><ul><li>  will put together a project </li><li>  will start the emulator </li><li>  wait for the OS to load in the emulator </li><li>  shut down and launch our application </li></ul><br>  After downloading the application to the emulator, we will see something like the following: <br><br><img src="https://habrastorage.org/files/d1a/12c/875/d1a12c8756684a12bc5f080beedd1d6d.png"><br><br>  To move in the emulator, you can use WASD, view control - LKM + Mouse, Tap - PCM, Bloom (exit to the shell) - Esc. <br><br>  For all input management options, see the <a href="https://developer.microsoft.com/en-us/windows/holographic/using_the_hololens_emulator">documentation for the emulator</a> .  There is a big bonus that this technology was released by Microsoft - the documentation for the device, its use and API is extremely rich and complete. <br><br>  One of the key tools used with the emulator or HoloLens itself is the Device Portal.  It is easy and convenient to see: <br><br><ul><li>  Device Status: FPS, Power, CPU, GPU, I / O </li><li>  Current running and installed applications </li><li>  Make a video or screenshot </li><li>  View room surfaces defined by the device </li><li>  File system access </li><li>  Logging, network connection settings </li></ul><br><img src="https://habrastorage.org/files/2a5/d28/aa2/2a5d28aa2f71485d83a7da75625c8ce1.png"><br>  <i>My integrated GPU (Intel 5500) provides a rather modest framerate in the emulator</i> <br><br>  I made a video from the demo application on one of our devices: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/181969427" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  In the video recording mode on the device, everything looks worse than it really is, because  Video is written at 30 fps.  You can see the smooth lines and there is a feeling of a small lag.  With a normal start, this is not there, so it is important to finally see your application on a real device. <br><br>  This is a basic article about developing for HoloLens, we will be happy to write something else.  Write in the comments that you are interested.  We also plan a mitap where you can watch the device and talk to us - sign up <a href="http://www.meetup.com/Moscow-HoloLens-Meetup/">here</a> . <br><br><h3>  Resources to learn </h3><br><ul><li>  <a href="https://developer.microsoft.com/en-us/windows/holographic/documentation">Official documentation</a> - guidelines and design specifications for DirectX and Unity </li><li>  <a href="https://developer.microsoft.com/en-us/windows/holographic/academy">Holographic Academy</a> - Hololens tutorial development video series </li><li>  <a href="https://github.com/Microsoft/HoloToolkit-Unity">HoloToolkit</a> - a set of components to accelerate the development of applications for HL </li><li>  <a href="https://github.com/Microsoft/GalaxyExplorer">GalaxyExplorer</a> - opensource application for HoloLens, published in the Store for HoloLens </li><li>  <a href="http://forums.hololens.com/">HoloLens App Development Forum</a> - official development forums </li><li>  <a href="https://www.youtube.com/channel/UCT2rZIAL-zNqeK1OmLLUa6g/videos">The official HoloLens channel on Youtube</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/310446/">https://habr.com/ru/post/310446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310432/index.html">Application on Elm in seconds</a></li>
<li><a href="../310434/index.html">As we wrote freelance exchange for Telegram</a></li>
<li><a href="../310436/index.html">Your blog on vibe-d, part 1: a simple web application using encryption</a></li>
<li><a href="../310438/index.html">First steps in Java: how to start developing without installing anything</a></li>
<li><a href="../310442/index.html">USB killer type-c</a></li>
<li><a href="../310448/index.html">How do American fintech startups replace banking freelancers</a></li>
<li><a href="../310450/index.html">Development of an electronic document management system from the inside: How we prepare SED TEZIS for release</a></li>
<li><a href="../310452/index.html">The book "Command line Linux. Complete Guide ¬ª</a></li>
<li><a href="../310454/index.html">Secrets of Progressive Web Apps: Part 1</a></li>
<li><a href="../310456/index.html">Custom Software Development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>