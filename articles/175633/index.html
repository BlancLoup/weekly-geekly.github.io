<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Versioning of debian / ubuntu server configurations</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear community. 
 I decided to share a small idea, maybe someone will be interesting and useful. 

 Tired of lost and broken configurations,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Versioning of debian / ubuntu server configurations</h1><div class="post__text post__text-html js-mediator-article">  Good day, dear community. <br>  I decided to share a small idea, maybe someone will be interesting and useful. <br><br>  Tired of lost and broken configurations, authorization on servers under the root, in order to transfer new optimal configurations, I decided to create repositories from configuration folders and give them access in a more accessible place. <br><a name="habracut"></a><br><h4>  A little bit about yourself </h4><br>  I myself am a web programmer, for some time I was sitting on ubuntu, the server (VPS) almost everything was on debian.  There is not much experience in server administration, unlike colleagues and hosters, but it has always attracted knowledge in this direction.  I could sit in the console for hours and solve certain tasks.  When the time was up, the more experienced colleagues took <s>away the</s> task <s>toys</s> and told me what I was doing wrong.  But it was always interesting what exactly they did themselves and how the settings of the more loaded projects occur.  All projects we store in <a href="https://bitbucket.org/">bitbucket</a> using the <a href="http://ru.wikipedia.org/wiki/Mercurial">Mercurial</a> version control system.  One day they decided to maintain the current version of the projects on the servers using the same tool and made their lives much easier.  Now you can pick up the latest updates on the server in two commands: <br><br><pre><code class="bash hljs">hg pull &amp;&amp; hg up</code> </pre> <br>  Why hosters do not offer similar software on their shared-hosting is a mystery.  In my opinion upload via FTP yesterday.  Now new employees are coming and they are slowly giving access to the servers, but already under my control, seeing the picture from the other side, I was horrified that what they had done on the server was very difficult to find.  After several hours, the server returned to its normal state and came to me: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Idea for a million </h4><br>  Having received a new server (VPS) based on debain, without thinking twice, I created a repository in the configuration folder. <br><br><h5>  New server </h5>  We make all commands from under a root-user. <br>  First of all, we update the software on the server: <br><pre> <code class="bash hljs">apt-get update &amp;&amp; apt-get upgrade</code> </pre><br>  We put the <a href="http://packages.debian.org/stable/mercurial">Mercurial</a> package (appeared in debian 6, but saw installation articles under debian 5): <br><pre> <code class="bash hljs">apt-get install mercurial</code> </pre><br>  Go to the configuration folder: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /etc</code> </pre><br>  Create a repository: <br><pre> <code class="bash hljs">hg init</code> </pre><br>  which will create a hidden folder ".hg" <br>  Tell a little about yourself: <br><pre> <code class="bash hljs">nano /etc/.hg/hgrc</code> </pre><br>  Specify the data: <br><pre> <code class="bash hljs">[ui] username = User &lt;****@gmail.com&gt;</code> </pre><br><br>  Already, you can find out about all the files by running the command: <br><pre> <code class="bash hljs">hg status</code> </pre><br>  Mercury will only show a list of files that are still new to it. <br><br>  Let us indicate that we want to add all new files to the following commit: <br><pre> <code class="bash hljs">hg add</code> </pre><br>  Finally, we fix the first state of the configurations: <br><pre> <code class="bash hljs">hg commit -m <span class="hljs-string"><span class="hljs-string">'first commit'</span></span></code> </pre><br>  Now you can safely install and configure the rest of the software. <br><br>  At any time, you can check the status of the configurations using the command: <br><pre> <code class="bash hljs">hg status</code> </pre><br>  What exactly changed in the files can be found with the command: <br><pre> <code class="bash hljs">hg diff ./  </code> </pre><br>  You can roll back the changes with the command: <br><pre> <code class="bash hljs">hg revert ./  </code> </pre><br>  It will be even better to get acquainted with all the teams: <br><pre> <code class="bash hljs">hg <span class="hljs-built_in"><span class="hljs-built_in">help</span></span></code> </pre><br><br><h5>  Publication </h5><br>  When we raise a new server or update the old one, all the time you remember: <br><ul><li>  Where are your server setup reminders? </li><li>  On which project has similar software been raised? </li><li>  What is the root password from the server (to read the configs) </li></ul><br>  and the list can be great. <br><br>  I decided to pour everything into a private repository.  I repeat that we use <a href="https://bitbucket.org/">bitbucket</a> .  Create a repository on it, get the path, something like: <br><pre> <code class="bash hljs">https://bitbucket.org/username/etc-project<span class="hljs-_"><span class="hljs-_">-a</span></span></code> </pre><br>  re-open our repository configuration: <br><pre> <code class="bash hljs">nano /etc/.hg/hgrc</code> </pre><br>  And we specify below: <br><pre> <code class="bash hljs">[paths] default = https://bitbucket.org/username/etc-project<span class="hljs-_"><span class="hljs-_">-a</span></span></code> </pre><br>  Run the command: <br><pre> <code class="bash hljs">hg push</code> </pre><br>  To which the mercury will ask you the authorization data on the bitbeat server.  The good news is that you can set up authorization by ssh-key. <br><br>  Now our configuration in a dry, cool place.  You can always see how this or that server is set up and use the examples to raise a new one.  To do this, you need to clone the repository to a local machine, or use a completely convenient web-interface from the bitcode. <br><br>  Pros: <br><ul><li>  Store configuration versions </li><li>  You can always roll back to a stable version. </li><li>  You can determine in one team what you have done without you. </li><li>  You can quickly find out how the server is configured without logging in. </li></ul><br>  Minuses: <br><ul><li>  Do not forget to commit the latest changes. </li></ul><br>  I wanted to add automatic commits over the crown, but I thought that it was better to leave such a simple solution.  Perhaps there are other ready-made solutions about which I would gladly read.  Who knows, maybe this small article will help you come up with a simpler and more useful solution, which I hope you will share with us too. <br><br>  Thank. </div><p>Source: <a href="https://habr.com/ru/post/175633/">https://habr.com/ru/post/175633/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175617/index.html">Amazon reduces the price of Windows EC2 server</a></li>
<li><a href="../175619/index.html">RVM Autolibs: Automatic dependency management and Ruby 2.0</a></li>
<li><a href="../175623/index.html">Filter elements in cuSel</a></li>
<li><a href="../175627/index.html">Decoding of images from the human brain</a></li>
<li><a href="../175629/index.html">Wikipedia in the registry of "banned" sites</a></li>
<li><a href="../175635/index.html">HackDay # 25 - Hackathon in Nizhny Novgorod</a></li>
<li><a href="../175643/index.html">Important points when linking to your site</a></li>
<li><a href="../175645/index.html">OwnCloud installation and configuration</a></li>
<li><a href="../175651/index.html">Problems of long PHP scripts</a></li>
<li><a href="../175655/index.html">How we improved the work of the support service in Yandex.Mail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>