<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Modular Java applications. How?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="That modularity is not supported in Java is well known to all. The problem has existed for a long time, and there have been many attempts to correct t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Modular Java applications. How?</h1><div class="post__text post__text-html js-mediator-article">  That modularity is not supported in Java is well known to all.  The problem has existed for a long time, and there have been many attempts to correct the situation.  The Jigsaw project is dedicated to this goal.  In 2011, it was planned to add support for modularity in Java 7, in 2014 - in Java 8, finally, it was announced that at the end of July 2017, Java 9 will be released with the possibility of modularization.  But what to do in anticipation of this beautiful moment? <br><br><h2>  OSGi to the rescue </h2><br>  To create a truly modular architecture in the Java language, you can use the OSGi (Open Services Gateway Initiative), a specification of a dynamic modular system and service platform for Java applications (developed by OSGi Alliance).  It describes a software development model in which components have three main features of a modular application.  Speech is about encapsulation (each module hides its implementation from the external environment), weak connectivity (modules only interact with pre-specified contracts) and dynamism (components can be replaced on the fly, without stopping the entire application).  The basis of the concept of OSGi are 2 entities: sets (Bundles) and services (Services). <br><a name="habracut"></a><br><h3>  Bundles </h3><br>  When developing software in Java, as a rule, third-party libraries are used.  In the world of Java-libraries are packaged in files with the extension JAR (Java ARchive) - an ordinary ZIP-archive containing Java-classes (files with the extension .class).  In this case, the use of libraries may be associated with certain difficulties. <br><br>  As soon as you begin to use any library, all classes in it, as a rule, become available to you.  The fact is that library developers are not able to hide classes that are used to implement their internal logic.  Thus, if you use code that was not intended to be used outside the library, you may encounter incompatibilities when using the new version of the library or disrupt its proper functioning. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Another problem is the so-called JAR Hell, about which the developers broke a lot of copies.  Its essence is as follows: as soon as you start using different versions of the same library (this happens in large projects that evolve over time), you may encounter the fact that the same class has different methods in different versions of the library.  Java is designed in such a way that the first version of the library that the class loader finds will be used.  Thereby, having addressed to a class in the code during the execution of the program, you will get an error that the method to which you refer does not exist.  This is due to the fact that at runtime Java does not know anything about the version of the library that should be used in this or that case. <br><br>  The OSGi developers did not begin to change the structure of JAR files to ensure modularity, but simply added additional information to them, which is used by the OSGi environment.  Moreover, this information does not affect the use of JAR-files in conventional Java-applications.  So, to make the JAR file an OSGi set, it adds data that defines the Export-Package (packages of this set available for use outside of it) and Import-Package (packages of other sets required for this set to work).  It is possible to specify both the version of the API that the set provides for other sets, and the version or range of versions of the API that the set requires to work from them.  All collection classes that are not in its exported section are not accessible outside the collection (Private).  In this way, the OSGi set fulfills the requirement of weak connectivity. <br><br>  Today, most Java libraries are already OSGi ready, i.e.  contain information for being able to run in an OSGi container.  In addition, there are many tools and utilities with which you can create modules for OSGi from ordinary JAR-files. <br><br>  Fig.  one. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/b72/6dd/e22/b726dde22013416dad7bb014f141ccde.png"></div><br>  In OSGi, you can easily avoid JAR Hell situations, since the dependencies between the sets and the interfaces provided by these sets have clear versions.  You can dynamically load and unload new sets at runtime.  OSGi tracks dependencies between sets and dynamically resolves them. <br><br><h3>  Services </h3><br>  So, with the help of OSGi-sets, we can develop modular applications that interact through interfaces (APIs).  But where to get the class that implements the required interface?  The option ‚Äúadd to the set API‚Äù is not suitable - within the framework of the modular architecture, we have agreed not to use the internal classes of the sets outside these sets.  Another solution is to apply the ‚Äúfactory‚Äù template, implementing the interface, and add it to the set API.  But it is not too successful, because  To hide the interface implementation, you will have to develop a new class each time. <br><br>  The search for the implementation of the interface in OSGi is performed using the service registry.  In this registry, a set can register an implementation with an interface describing it.  A set that uses an interface from another set can find in the registry the desired implementation of the interface it needs.  As a rule, sets register services when launched in an OSGi container.  Plus, the same interfaces with different implementations and additional identification data can be registered in the service registry.  Using filtering, the set can select the most suitable of the presented services in the registry. <br><br>  Fig.  2 <br><div style="text-align:center;"><img src="https://habrastorage.org/files/c8e/762/49f/c8e76249fe6a4566890e3e7e971e549e.png"></div><br><h2>  Java Virtual Machine Microservices </h2><br>  Microservice architecture is a set of independent modules - individual applications.  The interaction between them takes place through well-defined interfaces using lightweight protocols (REST, Protocol Buffers, MQ, etc.).  In fact, each module is a microservice that performs one specific task and contains, as a rule, the minimum amount of code.  The advantages of this software development approach are: <br><br><ul><li>  ease (when developing microservice, only one part of the program‚Äôs functionality is implemented). </li><li>  ease of replacement (if the service does not cope with its task, it can be rewritten and replaced with a new version without stopping the current software). </li><li>  reuse (microservice can be reused where it suits). </li></ul><br>  Developers of modular applications using OSGi have long enjoyed all these advantages, but only within the framework of the Java virtual machine.  Each set with OSGi that publishes a service to the registry is a microservice inside the Java Virtual Machine, JVM (in the OSGi world, such microservices are called ¬µServices). <br><br><h3>  Red Hat JBoss Fuse </h3><br>  We at Jet use all the benefits of OSGi when developing software for telecom operators, insurance and processing companies.  To do this, we use Red Hat JBoss Fuse (Fuse Fabric configuration).  This platform provides a flexible OSGi environment for running a modular application. <br><br>  Application continuity, easy horizontal scaling, ease of deployment, the availability of cluster management tools for cluster software - all of these features are available in Fuse Fabric.  The technology allows you to deploy multiple instances of Red Hat JBoss Fuse and merge them into a cluster, and also provides a centralized tool for managing the resulting environment. <br><br>  The following abstractions exist within Fuse Fabric: <br><br>  <b>Features</b> (features) - a set of OSGi-sets that implement any functionality. <br>  <b>Profiles</b> (profiles) - a set of features that must be performed within a single container, and configuration settings for sets that are included in the feature. <br>  <b>Containers</b> (containers) are separate JVM processes that run on a specific node of a Fuse Fabric cluster under the control of a Red Hat JBoss Fuse container. <br><br>  Fig.  3 <br><div style="text-align:center;"><img src="https://habrastorage.org/files/26f/14f/ab2/26f14fab217744169d73af959f69ecfd.png"></div><br>  Any software based on Fuse Fabric technology consists of OSGi-sets, which are grouped into features and deployed as part of a separate JVM process on one or several cluster nodes in accordance with a predefined profile. <br><br>  Fuse Fabric provides many tools for easy management of the resulting cluster.  You can create profiles (and based on them, containers), create / delete / start / stop containers on any host in the cluster, connect new cluster nodes, etc.  And all this online - without interrupting the functioning of the other nodes of the cluster.  It is possible to store multiple versions of profiles, features, OSGi-sets. <br><br>  Thanks to the distributed OSGi technology, in the resulting environment, OSGi-sets can interact within the framework of one and different containers and even different hosts.  Additionally (with minimal development costs) each service that an OSGi-set provides can be turned into a REST / web-service that can be called from external systems. <br><br>  Thus, using Fuse Fabric, we can create a microservice architecture that supports ease of configuration and deployment, isolated execution of services within its JVM processes (with its specific settings, for example, different garbage collector settings), while the services interact with each other network using lightweight protocol. <br><br>  Since  Red Hat JBoss Fuse product is based on the Open Source technology stack Apache ServiceMix, we have at our disposal such powerful technologies as Apache ActiveMQ (implementation of the JMS specification), Apache Camel (implementation of enterprise application integration patterns), Apache CXF (library for developing REST / web -services), Blueprint (provides opportunities for dependency injection), Spring, etc.  Since these technologies are seamlessly integrated with each other in Red Hat JBoss Fuse, this significantly reduces the development time of the required functionality. <br><br>  The material was prepared by experts of the Jet Infosystems software solutions center. </div><p>Source: <a href="https://habr.com/ru/post/324810/">https://habr.com/ru/post/324810/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324798/index.html">Synchronization of rhythm in music games</a></li>
<li><a href="../324800/index.html">Interview with Leonid Vasilyev, Dropbox developer, about work and life in Ireland</a></li>
<li><a href="../324802/index.html">Security defects that PVS-Studio team fixed this week: Issue N3</a></li>
<li><a href="../324804/index.html">Quake source code analysis</a></li>
<li><a href="../324808/index.html">Convenient C ++ enumerator</a></li>
<li><a href="../324812/index.html">Development for Sailfish OS: Features of working with dates and time zones</a></li>
<li><a href="../324814/index.html">Learn to think in REM. Talk about the obvious and about productivity in a small web studio</a></li>
<li><a href="../324816/index.html">Launch of the project Nerepetitor</a></li>
<li><a href="../324818/index.html">Simplest HTTP server on Golang and Elixir. Performance comparison</a></li>
<li><a href="../324820/index.html">Security Week 12: dangerous feature in Windows, Chinese hackers broke everything around, HTTPS should be inspected wisely</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>