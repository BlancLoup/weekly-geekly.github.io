<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rally: Testing OpenStack with Tempest has become easy (easier)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Author: Andrey Kurilin 

 In today's world, when building cloud services, it‚Äôs not possible to limit the installation of the platform; you have to upg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rally: Testing OpenStack with Tempest has become easy (easier)</h1><div class="post__text post__text-html js-mediator-article">  <i>Author: Andrey Kurilin</i> <br><br>  In today's world, when building cloud services, it‚Äôs not possible to limit the installation of the platform; you have to upgrade components, integrate new hardware, scale, and make many changes to the settings.  But how to stay confident that after all these changes, your cloud will continue to work properly and serve the benefit of the empire to customers? <a name="habracut"></a><br><br>  At this stage, Tempest is used for these tasks (the official OpenStack component for functional testing).  Tempest tests are automatically run for each new change in almost all OpenStack projects, which reduces the likelihood of incorrect changes (broken, curves, in other words, changes that can break anything in your infrastructure). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      However, when using Tempest, users often experience some inconvenience.  Using Tempest reminds me of learning to assembler at a university.  Writing and executing assembler instructions directly caused a lot of inconvenience, even if it was impossible to correct my mistakes without pain and suffering due to possible memory shifts.  When we were offered the opportunity to use Turbo Pascal as an assembly language runtime environment, we were immensely happy, the process of studying and developing applications in Assembler was greatly simplified.  I feel similar sensations when, instead of suffering with the Tempest configuration, I can test my cloud with a couple of simple commands. <br><br>  In most cases, using Tempest is difficult and time consuming.  In addition, Tempest does not support a range of load testing functionality, such as load modeling and presenting results in graphical form. <br><br>  <a href="https://wiki.openstack.org/wiki/Rally">Rally</a> can solve these problems - the OpenStack project, which is capable of much, in particular: create environments for verification, test performance, as well as benchmarking OpenStack (including using Tempest). <br><br>  If we talk about Rally + Tempest, Rally automates the process of installing, configuring and running Tempest tests.  Unlike Tempest, which must be installed and configured separately on each cluster, once installed, the Rally service can check a huge number of clouds ‚Äî all you need to do is add information about your clusters in Rally, and you can easily switch between them later.  The benchmarking mechanism Rally is able to automatically perform tests, simulating user load.  The results of both verification and benchmarks are stored in the Rally database.  You can view them immediately, or after a certain period, to compare how changes in the configuration of your cloud affect its operation. <br><br>  Next, we will look at how to use Rally and Tempest, but before moving on to the most interesting, let's list the main reasons for integrating Rally with Tempest: <br>  1. Most OpenStack projects use CI / CD systems that are based on Tempest to automatically test new changes.  Based on this, if there is an opportunity to make life easier for developers, namely, to allow them to use Tempest more actively and conveniently, then we must do it! <br><br>  2. Load testing with Tempest tests: <br><br>  1. Within the framework of Tempest, many tests have already been developed, so there is no need to duplicate them in Rally.  The less code duplication, the better. <br><br>  2. Verification should not be limited to testing without load.  Rally can simulate the load for tempest.  In other words, the benchmarking mechanism in Rally can run Tempest tests with different numbers of (simulated) active users. <br><br>  3. Debbuging Tempest and OpenStack.  When a race condition is detected in the gates (‚Äúgates‚Äù), developers will be able to run the same test (or set of tests) under load in their environment, which will make it easier to identify the source of such errors. <br><br>  You can talk a lot about the coolness and perspective of Rally, but you will never know how good Rally is until you experience it in action.  So, you are probably ready to move from ‚Äúlyricism‚Äù to practice.  Then let's get started! <br><br><h4>  Install Rally </h4><br>  It is not surprising, but to use Rally it is necessary to start downloading it ( <a href="https://github.com/stackforge/rally">github repository</a> ), and then run the install_rally.sh installation script. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/17e/3ce/8ac/17e3ce8ac920c5d73f64ac4c8f262603.png"><br><br><h4>  Adding your cloud to Rally </h4><br>  After successful installation, you should add the cloud to Rally, which will be tested.  This operation can be performed in two ways.  One of the options for cluster initialization in Rally is using your cloud's OpenRC.  For example, like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e03/677/6d0/e036776d0899633743712cff7d044282.png"><br><br>  The second way is to describe the cloud in the <a href="https://wiki.openstack.org/wiki/Rally/HowTo">json file</a> , which should be passed to the 'rally deployment create' using the ‚Äìfile argument: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b8/fbb/77d/2b8fbb77d36b09a2cbbfaa4f992f5762.png"><br><br>  By running the `rally deployment list` command, you can see a list of all initialized‚Äú deployments ‚Äù. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d5/3c0/016/9d53c00165df6dc7d0bda83cdb9b88a0.png"><br><br><h4>  Check your cloud </h4><br>  Using the `rally deployment check` you can check the correctness of the added deployment, as well as see which services are available in your Rally cloud: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/95c/f0b/0d4/95cf0b0d4117f9a5fd9ecae2b7fd77c1.png"><br><br><h4>  Tempest preparation for your cloud </h4><br>  As mentioned earlier, Rally can simultaneously work with a huge amount of clouds, therefore for each cloud its own Tempest is customized.  In order to reduce the time it takes to clone the Tempest repository, Rally clones it once and then uses the local repository, customizing it for each cloud. <br><br>  Tempest preparation (repository cloning and installation of a virtual environment with all dependencies) is performed by the `rally-manage tempest install` command. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c9b/c7a/f45/c9bc7af454c8e7b82c33d8e089ba17e8.png"><br><br><h4>  Running tempest </h4><br>  Starting automatic cloud checking (in other words, cloud verification) is implemented using the `rally verify start` command, it only needs one argument: the name of the test set.  If this argument is not specified, smoke tests will be executed (by default).  The result of this command is similar to the result issued by Tempest. <br>  Valid test case names are full, smoke, baremetal, compute, data_processing, identity, image, network, object_storage, orchestration, telemetry, and volume. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a17/3a7/bb3/a173a7bb3c135c5071b8090f40937f48.png"><br><br><h4>  Listing all Tempest results </h4><br>  The results of all verifications are stored in the Rally database, so that you can view and compare them at any time.  Lists of running checks will be displayed on the screen with the command `rally verify list`. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/61c/552/f96/61c552f962279c9e56752d98dc4d7fd3.png"><br><br><h4>  View the results of specific verification </h4><br>  You can view the results of a specific verification with two commands: `rally verify show` and` rally verify detailed`.  The latter complements the output of the first command with traceback tests that ended with an error. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/28f/227/305/28f22730546afa016d271baadcd8558a.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/393/e4b/036/393e4b03677ad9d26cdacd8b648cd084.png"><br><br><h4>  Tempest Benchmarking </h4><br>  In addition to installing, configuring, and running Tempest, Rally can simulate user load using Tempest tests.  The results of load testing are also saved and can later be displayed. <br><br>  Run the benchmark and simulate the load (from 2 to 10 users) for the following test scenario: tempest.api.identity.admin.v3.test_domains.DomainsTestXML.test_create_update_delete_domain. <br>  After completing the test, using the command `rally task plot2html`, we will generate an HTML file with the results.  Information and examples of how the input data is correctly specified in the JSON / YAML files used to define this task can be found in the Rally repository (in the rally / doc / samples / tasks directory) or on the <a href="https://wiki.openstack.org/wiki/Rally/HowTo">OpenStack wiki</a> page. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb9/981/e51/fb9981e51bc508c971295e9551bb24a4.png"><br><br><h4>  With 2 active users: </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9cd/4cf/b34/9cd4cfb349ca0ae83650914d4775c98b.png"><br><br><h4>  With 6 active users: </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/24c/214/942/24c21494250ca2b99b88d9330acb18aa.png"><br><br><h4>  With 10 active users: </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c94/fe4/496/c94fe4496c01771dd514af62ee5e9a54.png"><br><br><h4>  Conclusion </h4><br>  When using clouds in production, you will have to deal with constant changes.  The question arises: how to check every change?  Tempest is a good, but cumbersome solution.  Rally, among other things, can simplify its use. <br>  Rally provides a mechanism for load testing OpenStack, and now, thanks to integration with Tempest, the library of test scripts has become huge.  Will your patch speed up any operations?  Do you have a fast cloud like your competitors?  Why not find out with Rally ?! <br><br>  Original article <a href="http://www.mirantis.com/blog/rally-openstack-tempest-testing-made-simpler/">in English</a> . </div><p>Source: <a href="https://habr.com/ru/post/229331/">https://habr.com/ru/post/229331/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229321/index.html">Holiday Gadgets: Nikon CoolPix AW120 and Sony Action Cam AS100V Operating Experience</a></li>
<li><a href="../229323/index.html">How I got a job at google</a></li>
<li><a href="../229325/index.html">AdWords: Now on Blogger</a></li>
<li><a href="../229327/index.html">Say a word about poor C ++ API!</a></li>
<li><a href="../229329/index.html">Javascript modules</a></li>
<li><a href="../229335/index.html">VirtualBox VirtualBox on btrfs</a></li>
<li><a href="../229337/index.html">Ritot: smart and stylish projection clock</a></li>
<li><a href="../229339/index.html">Adaptive layout with Restive.JS</a></li>
<li><a href="../229341/index.html">Sony Xperia C3 - a serious approach to selfie</a></li>
<li><a href="../229343/index.html">What is what in ‚ÄúNGFW | NGIPS | UTM ‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>