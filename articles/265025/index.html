<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We document errors in Doxygen</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article focuses on the doxygen documentation system verification. This well-known and widely used project, according to a well-founded statement ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We document errors in Doxygen</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/318/608/cc2/318608cc20b96b6895a5ba1207b00c7b.png" align="left"><br><br>  This article focuses on the doxygen documentation system verification.  This well-known and widely used project, according to a well-founded statement of developers, which has actually become the standard for documenting software written in C ++, has not yet been verified by PVS-Studio.  Doxygen scans the source code of the programs and generates documentation on it.  The time has come for us to take a look at its sources and see what PVS-Studio can find. <br><a name="habracut"></a><br><br><h2>  Introduction </h2>  Doxygen is a cross-platform source documentation system that has a wide range of target languages: C ++, C, Objective-C, Python, Java, C #, PHP, IDL, Fortran, VHDL and partially supports D. Doxygen generates source-based documentation with comments. of a special kind and can be configured to extract the structure of the program with undocumented sources.  Output formats can be HTML, LATEX, man, rtf, xml.  Doxygen is used in KDE, Mozilla, Drupal, Pidgin, AbiWorld, FOX toolkit, Torque Game Engine, Crystal Space projects. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Preparation and verification </h2>  The most recent doxygen sources can be taken from <a href="https://github.com/doxygen/doxygen">github.com/doxygen/doxygen</a> .  Initially, the repository does not contain project files for Visual Studio, but since developers use cmake, they can be generated.  I used the console version of the program and the ‚Äúcmake -G‚Äû Visual Studio 12 ‚Äùcommand to generate the project file for VS 2013. To start the check, just click Check Solution in the PVS-Studio tab in Visual Studio. <br><br><h2>  Alert Analysis </h2>  Before the immediate analysis of warnings, I would like to pay attention to the writing style of doxygen.  Often in the code, for some unknown reason, the programmer tried to put everything in one line or neglected the spaces between variables and operators, which significantly reduced the readability of the code.  In some places came across strange formatting.  And sometimes there was <a href="https://goo.gl/LTzGXn">such</a> .  To fit some code in the article, I had to format it.  After a short digression, I suggest looking at the most interesting errors found in doxygen. <br><br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0108/">warning</a> : <a href="http://www.viva64.com/ru/d/0108/">V519</a> The '* outListType1' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 8326, 8327. util.cpp 8327 <br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convertProtectionLevel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MemberListType inListType, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *outListType1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *outListType2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> extractPrivate; .... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (inListType) { .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MemberListType_priSlots: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (extractPrivate) { *outListType1=MemberListType_pubSlots; *outListType1=MemberListType_proSlots; &lt;&lt;&lt;&lt;==== } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { *outListType1=<span class="hljs-number"><span class="hljs-number">-1</span></span>; *outListType2=<span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; .... } }</code> </pre> <br>  The if body contains a double assignment of the same variable.  Obviously, this is a typo or error when copying.  The else block suggests that the value "MemberListType_proSlots" should be written to "* outListType2".  Another similar error can be found here: doxygen.cpp 5742 (see the 'da-&gt; type' variable). <br><br>  The next warning to PVS-Studio: <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'pageTitle' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 970, 971. vhdldocgen.cpp 971 <br><pre> <code class="cpp hljs">QCString VhdlDocGen::getClassTitle(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ClassDef *cd) { QCString pageTitle; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cd == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; pageTitle += cd-&gt;displayName(); pageTitle = VhdlDocGen::getClassName(cd); .... }</code> </pre> <br>  Pay attention to the assignment operation.  Most likely, this is a typo and instead of "=" should be used "+ =".  On the issue of style, this function does not contain spaces between operators and values ‚Äã‚Äãin the source code, which significantly worsens the readability of the code.  This increases the chance of an error, as it is hard to see the absence of a "+" among the continuous stream of characters.  After adding spaces, the error becomes more noticeable.  Another similar bug is hidden here: <br><br>  V519 The 'nn' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 2166, 2167. vhdldocgen.cpp 2167 <br><br>  Let's move on to the next warning. <br><br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0112/">warning</a> : <a href="http://www.viva64.com/ru/d/0112/">V523</a> The 'then' statement is equivalent to the 'else' statement.  docparser.cpp 521 <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUndocumentedParams</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (g_memberDef-&gt;inheritsDocsFrom()) { warn_doc_error(g_memberDef-&gt;getDefFileName(), g_memberDef-&gt;getDefLine(), substitute(errMsg,<span class="hljs-string"><span class="hljs-string">"%"</span></span>,<span class="hljs-string"><span class="hljs-string">"%%"</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { warn_doc_error(g_memberDef-&gt;getDefFileName(), g_memberDef-&gt;getDefLine(), substitute(errMsg,<span class="hljs-string"><span class="hljs-string">"%"</span></span>,<span class="hljs-string"><span class="hljs-string">"%%"</span></span>)); } .... }</code> </pre> <br>  The copy-paste programming method can not only save time when writing code, but also introduce errors into it.  Here the code from the if block was copied for use in the else block, but not changed after insertion.  Each time you use copy-paste, you should follow the rule ‚ÄúCopy once, check seven times‚Äù. <br><br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0112/">warning</a> : <a href="http://www.viva64.com/ru/d/0112/">V523</a> The 'then' statement is equivalent to the 'else' statement.  translator_tw.h 769 <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TranslatorChinesetraditional</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Translator { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> QCString </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trGeneratedFromFiles</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> single, ....)</span></span></span><span class="hljs-function"> </span></span>{ .... QCString result=(QCString)<span class="hljs-string"><span class="hljs-string">"?"</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (single) result+=<span class="hljs-string"><span class="hljs-string">":"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> result+=<span class="hljs-string"><span class="hljs-string">":"</span></span>; .... } .... }</code> </pre> <br>  Similar to the previous warning.  In the if block, regardless of the condition, the same character is added to the result string.  This is hardly the expected behavior, because then the condition itself does not make sense.  And again, I am inclined to think that if, following the generally accepted style, this block was separated into 4 lines, then it would not just look prettier, but also make the typo more obvious.  Interestingly, this construct was copied twice for further use in functions, but the error was never noticed.  As a result, two more warnings fall on these lines: <ul><li>  V523 The 'then' statement is equivalent to the 'else' statement.  translator_tw.h 1956 </li><li>  V523 The 'then' statement is equivalent to the 'else' statement.  translator_tw.h 1965 </li></ul><br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0119/">warning</a> : V530.  classdef.cpp 1963 <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ClassDef::writeDocumentationContents(....) { QCString pageType = <span class="hljs-string"><span class="hljs-string">" "</span></span>; pageType += compoundTypeString(); <span class="hljs-built_in"><span class="hljs-built_in">toupper</span></span>(pageType.at(<span class="hljs-number"><span class="hljs-number">1</span></span>)); .... }</code> </pre> <br>  Here the programmer misunderstood how the toupper function works.  He may have expected the function to change the transmitted character to a capital letter.  In fact, the function returns the capital equivalent of the symbol-argument, and does not change it.  This is how the toupper function is declared in the ‚Äúctype.h‚Äù header file. <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toupper</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> __c)</span></span></span></span>;</code> </pre> <br>  Already from the function declaration, one can see that the parameter is accepted by value, which means that the transmitted symbol cannot be changed.  To avoid such errors, it is enough to carefully read the description of the functions used, the behavior of which you are not sure. <br><br>  PVS-Studio warning: <br>  <a href="http://www.viva64.com/ru/d/0153/">V560</a> A part of the conditional expression is always false: (flags () &amp;! 0x0008).  qfile_win32.cpp 267 <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> IO_Truncate 0x0008 bool QFile::open(....) { .... int length = INT_MAX; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> ((flags() &amp; !IO_Truncate) &amp;&amp; length == 0 &amp;&amp; isReadable()) .... }</span></span></code> </pre> <br>  This condition will always be false due to the fact that the logical negation of a nonzero value always gives zero.  The subsequent use of "AND" does not matter when one of the arguments is zero.  As a result, the condition does not depend on the other parameters.  Here, it seems more logical to use the bitwise inversion operator ~. <br><br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0153/">warning</a> : <a href="http://www.viva64.com/ru/d/0153/">V560</a> A part of conditional expression is always true <a href="http://www.viva64.com/ru/d/0153/">:! Found</a> .  util.cpp 4264 <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDefs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> found=FALSE; <span class="hljs-function"><span class="hljs-function">MemberListIterator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mmli</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*mn)</span></span></span></span>; MemberDef *mmd; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (mmli.toFirst();((mmd=mmli.current()) &amp;&amp; !found);++mmli) { .... } .... }</code> </pre> <br>  I‚Äôll say right away that in the body of the for loop, the variable found is not changed.  Because of this, the exit condition of the loop depends only on the result of the mmli.current method.  This is fraught with the fact that the cycle will always go from start to finish, regardless of whether the desired value was found or not. <br><br>  PVS-Studio warning: <br>  <a href="http://www.viva64.com/ru/d/0205/">V595</a> 'bfd ‚Äô  Check lines: 3371, 3384. dot.cpp 3371 <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> DotInclDepGraph::buildGraph(....) { .... FileDef *bfd = ii-&gt;fileDef; QCString url=<span class="hljs-string"><span class="hljs-string">""</span></span>; .... url=bfd-&gt;getSourceFileBase(); .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bfd) .... }</code> </pre> <br>  V595 is perhaps the most common warning among all projects.  It is not always before using the pointer that you wonder whether it can be zero.  Sometimes you think about it after the second or third use and put the check.  But between it and the first dereference, there can be a very large amount of code, which makes the error very difficult to detect.  Similar warnings: <ul><li>  V595 The 'cd' pointer was used before it was verified against nullptr. <br>  Check lines: 6123, 6131. ‚Äã‚Äãdoxygen.cpp 6123 </li><li>  V595 The 'p' pointer was used against it. <br>  Check lines: 1069, 1070. htmldocvisitor.cpp 1069 </li><li>  V595 The 'Doxygen :: mainPage' pointer was used before it was verified against nullptr. <br>  Check lines: 3792, 3798. index.cpp 3792 </li><li>  V595 The 'firstMd' pointer was used before it was verified against nullptr. <br>  Check lines: 80, 93. membergroup.cpp 80 </li><li>  V595 The 'lastCompound' pointer was used before it was verified against nullptr. <br>  Check lines: 410, 420. vhdljjparser.cpp 410 </li><li>  V595 The 'len' pointer was used against it. <br>  Check lines: 11960, 11969. qstring.cpp 11960 </li><li>  V595 The 'len' pointer was used against it. <br>  Check lines: 11979, 11988. qstring.cpp 11979 </li><li>  V595 The 'fd' pointer was used before it was verified against nullptr. <br>  Check lines: 2077, 2085. doxygen.cpp 2077 </li></ul><br>  PVS-Studio warning: <br>  <a href="http://www.viva64.com/ru/d/0205/">V595</a> 'lne ‚Äôpointer  Check lines: 4078, 4089. index.cpp 4078 <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writeIndexHierarchyEntries</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OutputList &amp;ol, ....)</span></span></span><span class="hljs-function"> </span></span>{ QListIterator&lt;LayoutNavEntry&gt; li(entries); LayoutNavEntry *lne; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (li.toFirst();(lne=li.current());++li) { LayoutNavEntry::Kind kind = lne-&gt;kind(); .... <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> addToIndex=lne==<span class="hljs-number"><span class="hljs-number">0</span></span> || lne-&gt;visible(); .... } }</code> </pre> <br>  I do not describe the same type of checks, because they are too boring for an article.  However, I want to consider another warning V595.  Here, the loop is entered only if the return value of li.current () (which is assigned to the lne pointer) is not NULL.  This means that inside the loop, the pointer is guaranteed not to be zero, making subsequent verification unnecessary.  I wanted to write out this example, because usually the V595 warning indicates a potential dereference of the null pointer, and here it showed an extra check. <br><br>  Analyzer Warnings: <a href="http://www.viva64.com/ru/d/0212/">V601</a> The bool type is implicitly cast to the class type.  docsets.cpp 473 <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IncludeInfo</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> local; }; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> DocSets::addIndexItem(Definition *context,MemberDef *md, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *,<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *) { QCString decl; .... IncludeInfo *ii = cd-&gt;includeInfo(); .... decl=ii-&gt;local; .... }</code> </pre> <br>  The analyzer paid attention to the strange conversion of bool to the class type.  In the QCString class, an overloaded assignment operator is not defined for an argument of type bool, but a constructor is defined with an input parameter of type int, which indicates the size of the string.  It is this one that is called to create a temporary object with this assignment.  The compiler will find a constructor with the argument int and call it, having first converted bool to int.  The local variable can have only 2 values: true or false, which corresponds to 1 and 0. In the first case, the designer will create a string from one element.  In the second case, you get an empty string.  At the end, an assignment statement will be invoked with an argument of type QCString.  A similar, but less obvious cast is carried out in the following places: <ul><li>  V601 The bool type is implicitly cast to the class type.  Inspect the fifth argument.  context.cpp 2315 </li><li>  V601 The bool type is implicitly cast to the class type.  Inspect the fifth argument.  context.cpp 2675 </li><li>  V601 The bool type is implicitly cast to the class type.  Inspect the fifth argument.  context.cpp 4456 </li></ul><br>  PVS-Studio Warning: <a href="http://www.viva64.com/ru/d/0230/">V614</a> Potentially uninitialized pointer 't' used.  vhdlparser.cc 4127 <br><pre> <code class="cpp hljs">QCString VhdlParser::extended_identifier() { Token *t; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!hasError) t = jj_consume_token(EXTENDED_CHARACTER); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t-&gt;image.c_str(); assert(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }</code> </pre> <br>  In this section of the code, an uninitialized pointer can be dereferenced.  The real code is poorly designed, so this error went unnoticed.  For the article, I formatted the code and the error became immediately noticeable.  Two more such errors can be found here: <ul><li>  V614 Potentially uninitialized pointer 'tmpEntry' used.  vhdlparser.cc 4451 </li><li>  V614 Potentially uninitialized pointer 't' used.  vhdlparser.cc 5304 </li></ul><br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0293/">warning</a> : <a href="http://www.viva64.com/ru/d/0293/">V668 has been defined</a> as the "new" operator.  The exception will be generated in the case of memory allocation error.  outputgen.cpp 47 <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> OutputGenerator::startPlainFile(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *name) { .... file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QFile(fileName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file) .... }</code> </pre> <br>  It is no longer a news for anyone that in the case of an unsuccessful allocation of memory, new throws an exception, and does not return nullptr.  This code is a kind of archaic programming.  For modern compilers, these checks are no longer meaningful, they can be removed.  3 more such checks: <ul><li>  V668 allocated r r allocated allocated allocated allocated allocated allocated allocated allocated allocated allocated allocated allocated  The exception will be generated in the case of memory allocation error.  template.cpp 1981 </li><li>  V668 allocated allocated allocated allocated allocated allocated allocated allocated allocated allocated allocated allocated allocated  The exception will be generated in the case of memory allocation error.  qglist.cpp 1005 </li><li>  V668 has been defined as the 'allocated allocated allocated allocated allocated allocated allocated allocated.  The exception will be generated in the case of memory allocation error.  qstring.cpp 12099 </li></ul><br>  PVS-Studio <a href="http://www.viva64.com/ru/d/0340/">warning</a> : <a href="http://www.viva64.com/ru/d/0340/">V701</a> realloc () possible leak: when realloc () fails in allocating memory, original pointer 'd' is lost.  Consider assigning realloc () to a temporary pointer.  qcstring.h 396 <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BufStr</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint newlen)</span></span></span><span class="hljs-function"> </span></span>{ .... m_buf = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)<span class="hljs-built_in"><span class="hljs-built_in">realloc</span></span>(m_buf,m_size); .... } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: uint m_size; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *m_buf; .... }</code> </pre> <br>  The analyzer detected an incorrect use of the ‚Äúrealloc‚Äù function.  In case of unsuccessful allocation of memory, ‚Äúrealloc‚Äù will return nullptr, overwriting the previous value of the pointer.  To prevent this, it is recommended to store the value of the pointer in a temporary variable before using realloc.  In total, in addition to this, 8 potential memory leaks were found in the project: <ul><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'd' is lost.  Consider assigning realloc () to a temporary pointer.  qcstring.h 396 </li><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'str' is lost.  Consider assigning realloc () to a temporary pointer.  growbuf.h 16 </li><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'str' is lost.  Consider assigning realloc () to a temporary pointer.  growbuf.h 23 </li><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'str' is lost.  Consider assigning realloc () to a temporary pointer.  growbuf.h 33 </li><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'm_str' is lost.  Consider assigning realloc () to a temporary pointer.  vhdlstring.h 61 </li><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'shd-&gt; data' is lost.  Consider assigning realloc () to a temporary pointer.  qgarray.cpp 224 </li><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'm_data' is lost.  Consider assigning realloc () to a temporary pointer.  qgstring.cpp 114 </li><li>  V701 realloc () possible leak: when realloc () fails in allocating memory, the original pointer 'm_data' is lost.  Consider assigning realloc () to a temporary pointer.  qgstring.cpp 145 </li></ul><br><h2>  Conclusion </h2>  In conclusion, I would like to say that the analyzer coped well with its work and found many suspicious places, despite the fact that doxygen is a popular project and is widely used by a large number of both small and large companies.  I gave the most basic warnings and left such uninteresting as extra checks, unused variables, etc.  beyond the scope of this article.  It is worth mentioning that in some places I was surprised by the very careless, in my opinion, code design. <br><br>  I would like to wish the readers to write beautiful, readable code and avoid mistakes.  And if the first entirely depends on the programmer, then the analyzer can help with the second.  Download and try free PVS-Studio on your project here: <a href="http://www.viva64.com/ru/pvs-studio-download/">http://www.viva64.com/ru/pvs-studio-download/</a> <br><br><div style="text-align:center;"> <a href="http://www.viva64.com/en/b/0345/"><img src="https://habrastorage.org/files/9dd/4ba/bc6/9dd4babc6fba4e8184afa3a8c5148288.png"></a> </div><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Igor Shtukarev.  <a href="http://www.viva64.com/en/b/0345/">Documenting Bugs in Doxygen</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/265025/">https://habr.com/ru/post/265025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265015/index.html">Materials from the free on-site seminar "Kerio Control: Everything you wanted to know, but did not know who to ask"</a></li>
<li><a href="../265017/index.html">Optimization of data center operation at no extra cost</a></li>
<li><a href="../265019/index.html">Digest of the game industry: July</a></li>
<li><a href="../265021/index.html">SCADA and mobile phones: an assessment of the safety of applications that turn a smartphone into a plant control panel</a></li>
<li><a href="../265023/index.html">Configure D-Link DIR-320 / NRU + 3G Rostelecom R41 (Sense R41)</a></li>
<li><a href="../265027/index.html">DATA CENTER EXPEDITION 2015: Asia Tour</a></li>
<li><a href="../265029/index.html">Statistical problems of identification of network structures</a></li>
<li><a href="../265031/index.html">QIWI launched Visa payWave on Android devices</a></li>
<li><a href="../265037/index.html">7 tips on how to improve the performance of your site in Microsoft Edge and other modern browsers</a></li>
<li><a href="../265039/index.html">Git for Windows 2.5.0 released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>