<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Several "buns" for symfony 2 && Doctrine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will discuss how you can solve some problems in Symfony 2 and Doctrine using the basic components out of the box, namely: 



- The intro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Several "buns" for symfony 2 && Doctrine</h1><div class="post__text post__text-html js-mediator-article">  This article will discuss how you can solve some problems in Symfony 2 and Doctrine using the basic components out of the box, namely: <br><br><ul><li>  The introduction of service in the model </li><li>  Save change history </li><li>  Disabling SQLLogger and clearing the cache </li><li>  Environment partition (dev - console) </li></ul><a name="habracut"></a><br>  I think many who worked with Symfony 2 faced the problem of introducing a container service into a model (Entity) or some other component (service).  Before you know how to do this, consider whether you need it?  You can create a specific service (utility) and do everything that is needed there.  Well, if you decide that this is necessary, then: <br><br><h4>  Bun ‚Ññ1 The introduction of service in the model: </h4><br>  There are several ways to implement, and often all choose the easiest. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Option number 1 </h5><br>  Take and "stupidly" call the kernel from the global scope <br><br><pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyEntity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... properties // ... methods public function someAction() { global $kernel; return $kernel-&gt;getContainer() -&gt;..... } }</span></span></code> </pre> <br>  As for me, the method is very simple, but also very <u>leaky</u> , since it is impossible to verify the existence of the same variable ... <br><br><h5>  Option number 2 </h5><br>  Here it will be necessary to ‚Äúsweat‚Äù a little for a simple function, but this solution will be much better than the first one and guarantees full performance.  Here will be used <a href="http://docs.doctrine-project.org/en/latest/reference/events.html">events doctrines</a> that allow us to do anything during the load / save model. <br><br>  To begin, we will need to create either Event or Subscriber for Doctrine, which will be implemented by the necessary component during model loading ( <a href="http://docs.doctrine-project.org/en/latest/reference/events.html">postLoad</a> ).  And we will need to create this whole thing as a service so that you can transfer any service. <br><br>  Create a Subscriber for Doctrine: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">EventListener</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Doctrine</span></span>\<span class="hljs-title"><span class="hljs-title">Common</span></span>\<span class="hljs-title"><span class="hljs-title">EventSubscriber</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Doctrine</span></span>\<span class="hljs-title"><span class="hljs-title">ORM</span></span>\<span class="hljs-title"><span class="hljs-title">Event</span></span>\<span class="hljs-title"><span class="hljs-title">LifecycleEventArgs</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">MyEntity</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyEntitySubscriber</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EventSubscriber</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $container; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;container = $container; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">postLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LifecycleEventArgs $event)</span></span></span><span class="hljs-function"> </span></span>{ $entity = $event-&gt;getEntity(); <span class="hljs-comment"><span class="hljs-comment">//  ,   ,       , //     if ($entity instanceof MyEntity) { $entity-&gt; setMyComponent($this-&gt;container-&gt;get('....')); } } /** * ,       * :    -    * ,    */ public function getSubscribedEvents() { return array( 'postLoad' ); } }</span></span></code> </pre><br>  Here is the new model: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyEntity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ‚Ä¶ properties protected $myComponent; // ‚Ä¶ methods public function setMyComponent($myComponent) { $this-&gt;myComponent = $myComponent; } public function someAction() { return $this-&gt;myComponent -&gt;.... } }</span></span></code> </pre><br>  Register as a service <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my_entity.doctrine.subscriber"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Acme\DemoBundle\EventListener\MyEntitySubscriber"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    ,     subscriber --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tag</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"doctrine.event_subscriber"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">argument</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"service"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"service_container"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Well, that's all, when the model is loaded, the system will check if this model is necessary, and if so, ‚Äúplug in‚Äù the necessary component into the myComponent variable using a separate setter. <br><br>  <b>Conclusion:</b> try to avoid such cases, since the models are only for reading / writing in the database. <br><br><h4>  Bun number 2 Saving history: </h4><br>  Sometimes you have to keep the entire history of a change in a certain model, for example, the record change history for further rollback.  Events of the doctrine itself, namely <a href="http://docs.doctrine-project.org/en/latest/reference/events.html">onFlush</a> , will help greatly in this situation <a href="http://docs.doctrine-project.org/en/latest/reference/events.html">.</a> <br><br>  Suppose we have a ‚Äúnews‚Äù model that we will need to follow, namely, the title field: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">News</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $title; <span class="hljs-comment"><span class="hljs-comment">// ... properties // ... methods }</span></span></code> </pre><br>  Well, in the dogonku, you will need to create another model, which just will control the changes: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewsHistory</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $title; <span class="hljs-comment"><span class="hljs-comment">// ... properties // ... methods }</span></span></code> </pre><br>  At the event itself, it will be necessary to check whether this field has changed.  This will help <b>UnitOfWork</b> , which carefully monitors all the models in a particular manager. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">EventListener</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Doctrine</span></span>\<span class="hljs-title"><span class="hljs-title">Common</span></span>\<span class="hljs-title"><span class="hljs-title">EventSubscriber</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Doctrine</span></span>\<span class="hljs-title"><span class="hljs-title">ORM</span></span>\<span class="hljs-title"><span class="hljs-title">Event</span></span>\<span class="hljs-title"><span class="hljs-title">OnFlushEventArgs</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">DependencyInjection</span></span>\<span class="hljs-title"><span class="hljs-title">ContainerInterface</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">News</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Acme</span></span>\<span class="hljs-title"><span class="hljs-title">DemoBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">NewsHistory</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewsSubscriber</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EventSubscriber</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFlush</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OnFlushEventArgs $event)</span></span></span><span class="hljs-function"> </span></span>{ $em = $event-&gt;getEntityManager(); $uow = $em-&gt;getUnitOfWork(); <span class="hljs-comment"><span class="hljs-comment">//    ,    foreach ($uow-&gt;getScheduledEntityUpdates() as $entity) { //    if ($entity instanceof News) { //    ,   $changeSet = $uow-&gt;getEntityChangeSet($entity); //     title? if (isset($changeSet['title'])) { //      list ($oldTitle, $newTitle) = $changeSet['title']; //  entity    $newsHistory = new NewsHistory; $newsHistory-&gt;setTitle($oldTitle); //      $em-&gt;persist($newsHistory); // !!! //        ,  //  ,   ,  flush  //  ,     ,   // ,   . //     UnitOfWork,    , //       //    ClassMetadata   //    ""     $classMetadata = $em-&gt;getClassMetadata(get_class($newsHistory)); //    ""  UnitOfWork,      $uow-&gt;computeChangeSet($classMetadata, $newsHistory); } } } } public function getSubscribedEvents() { return array( 'onFlush' ); } }</span></span></code> </pre><br>  Well, as always, you need to register as a service, indicating that this is a subscriber for the doctrine: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"news.doctrine.subscriber"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Acme\DemoBundle\EventListener\NewsSubscriber"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tag</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"doctrine.event_subscriber"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <b><a href="http://docs.doctrine-project.org/en/latest/reference/working-with-objects.html">UnitOfWork</a></b> is the so-called <b>Api</b> , with which you can do any machinations with models. <br>  In the same way, you can control the creation of new models and the removal of old ones. <br><br><h4>  Bun number 3 Disable SQL logger, cleaning the cache in Doctrine: </h4><br>  Sometimes there is a need to run commands (from the console) that make so many queries to the database.  A good example is the transfer of a site from a CMS or a firewall to Symfony 2 in the presence of more than 100,000 entries in the database.  If you run a command on the Symphony from the console, then by default, the system will start in dev mode and with the debug enabled, in which the doctrine saves all requests for subsequent debag.  As a result, the memory allocated for the script is constantly increasing, which subsequently affects the speed and can throw out the critical <u>memory limit</u> error.  In such situations, we can disable all the loggers that the doctrine (manager) uses, or completely redefine to control only what is needed.  The logger itself hangs in the configuration of the doctrine. <br><br>  An example of a complete shutdown: <br><div class="spoiler">  <b class="spoiler_title">Php</b> <div class="spoiler_text"><pre> <code class="php hljs">$container-&gt;get(<span class="hljs-string"><span class="hljs-string">'doctrine'</span></span>) -&gt;getManager() -&gt;getConnection() -&gt;getConfiguration() -&gt;setSQLLogger(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     </span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Configuration</b> <div class="spoiler_text"> <code>doctrine: <br> dbal: <br> connections: <br> default: <br> logging: false</code> <br> </div></div><br>  You should also not forget that all models that were loaded from the database are saved in the manager until <u>unset</u> is called or the ‚Äústatic‚Äù cache is reset.  It was designed not to constantly make queries on a sample of the same model.  As a result, with such large scripts (which do a lot of operations with models), it is necessary to periodically clean the cache: <br><br><pre> <code class="php hljs">$container-&gt;get(<span class="hljs-string"><span class="hljs-string">'doctrine'</span></span>)-&gt;getManager()-&gt;clear();</code> </pre><br><h4>  Bun # 4 Separation of console environments: </h4><br>  When raising a new Symphony assembly, we always encounter the problem of some folders ( <u>Permission denied</u> ): <b>app / cache</b> and <b>app / logs</b> .  This problem occurs when you have already launched the site from a browser and are trying to do something in the console.  The problem is that the web server itself works under a different user. <br>  Those who have full access to the server (root), this is not necessary, look better: <a href="http://symfony.com/doc/current/book/installation.html">http://symfony.com/doc/current/book/installation.html#configuration-and-setup</a> <br>  But if you do not have full access to the system (for example, hosting) and you already have this problem, then you can divide the startup system on dev and console.  This is done as follows: <br><br><ol><li>  Create an app / config / config_console.yml file into which we import the config_dev.yml config </li><li>  In the app / console file, by default, we set not dev and console </li><li>  Correct the app / AppKernel.php file in the place where additional bundles are connected (environment is being checked) and add another console </li></ol><br>  Now when you start app / console, the system will work under a completely different environment, which will not interfere with the dev. <br>  <b>Warning</b> : this is only if the system is in dev mode! <br><br>  <b>PS</b> Codes were written for example, and not to work on prod systems.  Symfony 2.2 was used. <br>  <b>PSS</b> Please do not kick much ... My first post.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/272367/">https://habr.com/ru/post/272367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272357/index.html">We write the application for firefox os and place it in the Marketplace</a></li>
<li><a href="../272359/index.html">How does email filtering in gmail work?</a></li>
<li><a href="../272361/index.html">The devil is not so bad, or how many domains are actually used.</a></li>
<li><a href="../272363/index.html">How I won the programming contest without knowing how to program</a></li>
<li><a href="../272365/index.html">DreemChest: Chain Reaction</a></li>
<li><a href="../272371/index.html">Hacker mathematician</a></li>
<li><a href="../272373/index.html">Use TSQL to play Sudoku</a></li>
<li><a href="../272375/index.html">Apple has released Swift source code</a></li>
<li><a href="../272381/index.html">Useful Snippets for Nginx Configs</a></li>
<li><a href="../272383/index.html">Postulates Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>