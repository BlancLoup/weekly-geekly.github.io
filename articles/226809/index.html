<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Integrating PayPal Here into an iOS application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While working on one project, I was faced with the need to integrate PayPal Here into applications. PayPal never went to developers for a meeting, it ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Integrating PayPal Here into an iOS application</h1><div class="post__text post__text-html js-mediator-article">  While working on one project, I was faced with the need to integrate <a href="https://www.paypal.com/webapps/mpp/credit-card-reader">PayPal Here</a> into applications.  PayPal never went to developers for a meeting, it was quite difficult to integrate, but with PayPal Here the situation is somewhat different (there is a whole <a href="https://github.com/paypal/here-sideloader-api-samples">example</a> on gitHub).  In short, if you are the owner of an online store, online auction, or even want to make a payment in your application, then you will be interested in reading about how you can integrate PayPal Here in iOS. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa4/a68/aae/aa4a68aaeebedd4f0ee3543019ae1b9f.jpg" alt="image"><br><br>  By the way, despite the large number of online stores that are paid through PayPal, the PayPal Here service is still not available in the Russian side. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h4>  What is PayPal Here? </h4><br><br>  PayPal Here is a mobile terminal through which you can make payments, and is a direct competitor to the similar program from Square.  In addition to making payments by credit card, PayPal Here can be used to pay by check and to verify financial transactions over a specific period of time.  You can also send invoices to the recipient's e-mail through the software from PayPal Here, and the buyer, upon receiving the invoice, will be able to pay it. <br><br>  I will give an example of integration for iOS and Oblective-C.  If someone is interested in Android, then its support is also available, but I have not worked with it. <br><br><h4>  Integration process. </h4><br><br>  Unfortunately, PayPal does not provide any separate libraries for conducting transactions directly from its application.  But safety is paramount.  We have to call a third-party application - we make up the URL and do: <br><br><pre><code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">UIApplication</span></span> *application = [<span class="hljs-built_in"><span class="hljs-built_in">UIApplication</span></span> sharedApplication]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([application canOpenURL:pphUrl]){ [application openURL:pphUrl]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> *url = [<span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> URLWithString:<span class="hljs-string"><span class="hljs-string">@"itms://itunes.apple.com/us/app/paypal-here/id505911015?mt=8"</span></span>]; [application openURL:url]; }</code> </pre> <br>  where pphUrl contains all the payment data. <br><br>  Next, create a simple UIViewController to edit the data: <br><br><pre> <code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PPViewController</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITextFieldDelegate</span></span></span><span class="hljs-class">&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weak</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBOutlet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITextField</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">priceField</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weak</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBOutlet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITextField</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">taxField</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weak</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBOutlet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITextField</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nameField</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weak</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBOutlet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITextField</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">quantityField</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">weak</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBOutlet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITextField</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">descriptionField</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br>  we add all the required request fields: <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> *shirt = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> dictionary]; <span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> *itemList = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> dictionary]; <span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> *invoice = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> dictionary]; [shirt setObject:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.taxField.text forKey:<span class="hljs-string"><span class="hljs-string">@"taxRate"</span></span>]; [shirt setObject:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.priceField.text forKey:<span class="hljs-string"><span class="hljs-string">@"unitPrice"</span></span>]; [shirt setObject:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.quantityField.text forKey:<span class="hljs-string"><span class="hljs-string">@"quantity"</span></span>]; [shirt setObject:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.nameField.text forKey:<span class="hljs-string"><span class="hljs-string">@"name"</span></span>]; [shirt setObject:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.descriptionField.text forKey:<span class="hljs-string"><span class="hljs-string">@"description"</span></span>]; [shirt setObject:<span class="hljs-string"><span class="hljs-string">@"Tax"</span></span> forKey:<span class="hljs-string"><span class="hljs-string">@"taxName"</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSMutableArray</span></span> *items = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableArray</span></span> arrayWithObject:shirt]; [itemList setObject:items forKey:<span class="hljs-string"><span class="hljs-string">@"item"</span></span>]; [invoice setObject:<span class="hljs-string"><span class="hljs-string">@"DueOnReceipt"</span></span> forKey:<span class="hljs-string"><span class="hljs-string">@"paymentTerms"</span></span>]; [invoice setObject:<span class="hljs-string"><span class="hljs-string">@"0"</span></span> forKey:<span class="hljs-string"><span class="hljs-string">@"discountPercent"</span></span>]; [invoice setObject:<span class="hljs-string"><span class="hljs-string">@"USD"</span></span> forKey:<span class="hljs-string"><span class="hljs-string">@"currencyCode"</span></span>]; [invoice setObject:<span class="hljs-string"><span class="hljs-string">@"merchant@ebay.com"</span></span> forKey:<span class="hljs-string"><span class="hljs-string">@"merchantEmail"</span></span>]; [invoice setObject:<span class="hljs-string"><span class="hljs-string">@"foo@bar.com"</span></span> forKey:<span class="hljs-string"><span class="hljs-string">@"payerEmail"</span></span>]; [invoice setObject:itemList forKey:<span class="hljs-string"><span class="hljs-string">@"itemList"</span></span>];</code> </pre><br><br>  and go to the final stage (here we need <a href="https://github.com/johnezang/JSONKit">JSONKit</a> ): <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *jsonInvoice = [invoice JSONString]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *encodedInvoice = [jsonInvoice stringByAddingPercentEscapesUsingEncoding:<span class="hljs-built_in"><span class="hljs-built_in">NSASCIIStringEncoding</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *encodedPaymentTypes = [<span class="hljs-string"><span class="hljs-string">@"cash,card,paypal"</span></span> stringByAddingPercentEscapesUsingEncoding:<span class="hljs-built_in"><span class="hljs-built_in">NSASCIIStringEncoding</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *encodedReturnUrl = [<span class="hljs-string"><span class="hljs-string">@"myapp://handler?{result}?Type={Type}&amp;InvoiceId={InvoiceId}&amp;Tip={Tip}&amp;Email={Email}&amp;TxId={TxId}"</span></span> stringByAddingPercentEscapesUsingEncoding:<span class="hljs-built_in"><span class="hljs-built_in">NSASCIIStringEncoding</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *pphUrlString = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"paypalhere://takePayment?accepted=%@&amp;returnUrl=%@&amp;invoice=%@&amp;step=choosePayment"</span></span>, encodedPaymentTypes, encodedReturnUrl, encodedInvoice]; <span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> *pphUrl = [<span class="hljs-built_in"><span class="hljs-built_in">NSURL</span></span> URLWithString:pphUrlString];</code> </pre><br>  after that we open the application by pphUrl as described above. <br><br><h4>  Conclusion <br></h4><br><br>  There is one small BUT in this scheme - so far the PayPalHere application is not able to make a callback to your application after making a payment, but I think the developers will fix this soon. <br>  Personally, I recommend to build the necessary url on the server, as there is much less fuss, and it looks more resistant to errors.  Anyway, I did just that. <br><br>  I hope that this article will help someone, all successful integration! <br>  I will be glad to answer your questions and read about your experience. </div><p>Source: <a href="https://habr.com/ru/post/226809/">https://habr.com/ru/post/226809/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226793/index.html">How do mailing services relate to rules</a></li>
<li><a href="../226799/index.html">Marketing for financial institutions. Part One: Campaigns</a></li>
<li><a href="../226801/index.html">Projects for competition from Intel + workshop on wearable electronics in hackspace</a></li>
<li><a href="../226803/index.html">PHDays IV CTF: how it was</a></li>
<li><a href="../226807/index.html">Maximum Transmission Unit (MTU). Myths and reefs</a></li>
<li><a href="../226815/index.html">Adobe Photoshop CC 2014: what's new?</a></li>
<li><a href="../226817/index.html">Yandex and security. As we studied and neutralized wrappers (aggressive adware)</a></li>
<li><a href="../226823/index.html">Creating audio plug-ins, part 8</a></li>
<li><a href="../226825/index.html">Cross selling: we increase the average amount of goods in the basket</a></li>
<li><a href="../226827/index.html">Mobile software development: integration issues</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>