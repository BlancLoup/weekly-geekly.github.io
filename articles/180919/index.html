<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>KeygenMe # 2 Analysis by Paic_Citron</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="KeygenMe page on crackmes.de 
 You have to find a valid serial. 

 The only protection is the serial ...! 

 This is a kind of headache ...: D 

 Good...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>KeygenMe # 2 Analysis by Paic_Citron</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://crackmes.de/users/paic_citron/paic_citron_keygenme2/">KeygenMe page on crackmes.de</a> <br>  You have to find a valid serial. <br><br>  The only protection is the serial ...! <br><br>  This is a kind of headache ...: D 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Good luck <br>  Difficulty: 5 - Professional problem to solve <br>  Platform: Windows <br>  Language: Borland Delphi <br><a name="habracut"></a><br><br>  This keygenme is a console application, so we don‚Äôt have to look for button handlers and so on.  Therefore, we are looking for a conditional transition, during which we will be shown a success message. <br><pre>  CODE: 0040A71D mov edx, offset aSerial;  "Serial:"
 CODE: 0040A722 call Write0LString
 CODE: 0040A727 call @ Flush $ qqrr15System @ TTextRec;  Flush (System :: TTextRec &amp;)
 CODE: 0040A72C call @_IOTest
 CODE: 0040A731 mov edx, offset Serial
 CODE: 0040A736 mov eax, ds: off_40B370
 CODE: 0040A73B call @ReadLString
 CODE: 0040A740 mov eax, ds: off_40B370
 CODE: 0040A745 call @ReadLn
 CODE: 0040A74A call @_IOTest
 CODE: 0040A74F mov eax, ds: Serial
 CODE: 0040A754 call LStrLen
 CODE: 0040A759 mov edi, eax
 CODE: 0040A75B test edi, edi
 CODE: 0040A75D jle _end_of_serial
 CODE: 0040A763 mov ds: pos, 1
 CODE: 0040A76D
 CODE: 0040A76D _next_char:;  CODE XREF: start + 2FE j
 CODE: 0040A76D mov eax, ds: Serial
 CODE: 0040A772 mov edx, ds: pos
 CODE: 0040A778 movzx edx, byte ptr [eax + edx-1]
 CODE: 0040A77D mov eax, esi
 CODE: 0040A77F call ProcessCommand
 CODE: 0040A784 push offset test_z;  a4
 CODE: 0040A789 mov test_y offset;  a3
 CODE: 0040A78E mov edx, offset test_x;  a2
 CODE: 0040A793 mov eax, esi;  a1
 CODE: 0040A795 call GetPosMarker3D
 CODE: 0040A79A cmp ds: test_x, 2
 CODE: 0040A7A1 jnz _incorrect_pos
 CODE: 0040A7A7 cmp ds: test_y, 4
 CODE: 0040A7AE jnz _incorrect_pos
 CODE: 0040A7B4 cmp ds: test_z, 4
 CODE: 0040A7BB jnz _incorrect_pos
 CODE: 0040A7C1 cmp dword ptr [esi + 218h], 0Ch
 CODE: 0040A7C8 jnz _incorrect_pos
 ... displaying a message that the key was successfully found ...
 CODE: 0040A97B _incorrect_pos:;  CODE XREF: start + 11D j
 CODE: 0040A97B;  start + 12A j ...
 CODE: 0040A97B inc ds: pos
 CODE: 0040A981 dec edi
 CODE: 0040A982 jnz _next_char
 CODE: 0040A988
 CODE: 0040A988 _end_of_serial:;  CODE XREF: start + D9 j
 CODE: 0040A988 mov eax, ebx
 CODE: 0040A98A call @ WriteLn
 CODE: 0040A98F call @_IOTest
 CODE: 0040A994 mov eax, ebx
 CODE: 0040A996 mov edx, offset aNanCEstPasBon;  "Nan, c'est pas bon :)"
 CODE: 0040A99B call Write0LString
 CODE: 0040A9A0 call @ WriteLn </pre><br><br>  The same code in Delphi syntax will look like this: <br><img src="https://habrastorage.org/storage2/b37/146/e89/b37146e892232f2fe57cbc235d94298e.png"><br>  Thus, in order to successfully complete the task after processing the next character of the serial number, the coordinates of some label must be (2, 4, 4) and some variable must be equal to 12. <br><br>  Let's see what is in the function GetPosMarker3D ( <code>00409D88</code> ). <br><img src="https://habrastorage.org/storage2/326/55e/769/32655e76909eed2edbcb7f067e738faa.png"><br>  An item is searched in a three-dimensional array (cube) with a marker.  Here you can also see the dimension of the cube - 5x5x5. <br>  Each element of the cube is described by a number from 0 to 15. <br>  Initialization of the cube occurs in the function at address <b><code>00408D90</code></b> . <br>  The contents of the initialized cube in expanded form: <br><img src="https://habrastorage.org/storage2/10f/528/b6b/10f528b6be5a6c56c148c328952300fa.png"><br><br>  The list of possible values ‚Äã‚Äãin the elements of the cube: <br><table><tbody><tr><td>  0 </td><td>  regular field </td></tr><tr><td>  one </td><td>  impassable field (wall) </td></tr><tr><td>  2 </td><td>  starting position </td></tr><tr><td>  3 </td><td>  key to pass through the field with ID = 4 </td></tr><tr><td>  four </td><td>  trigger field with event pass </td></tr><tr><td>  five </td><td>  event field for passing through a field with id = 6 </td></tr><tr><td>  6 </td><td>  trigger field with event pass </td></tr><tr><td>  7 </td><td>  gateway to another level </td></tr><tr><td>  eight </td><td>  rotate the current level 90 degrees </td></tr><tr><td>  9 </td><td>  teleport starting point </td></tr><tr><td>  A </td><td>  teleport destination </td></tr><tr><td>  B </td><td>  field with constant (1,2,3,6) </td></tr><tr><td>  C </td><td>  field with arithmetic operation (+, -, /, *) </td></tr><tr><td>  D </td><td>  put the result first operand </td></tr><tr><td>  E </td><td>  calculate the expression </td></tr><tr><td>  F </td><td>  exit from the cube </td></tr></tbody></table><br><br>  The list of commands, which are characters from the entered serial number, are processed in function <b><code>0040A2C0</code></b> : <br><table><tbody><tr><td>  <b>P</b> </td><td>  move left (x + 1) </td></tr><tr><td>  <b>I</b> </td><td>  move right (X-1) </td></tr><tr><td>  <b>A</b> </td><td>  move up (Y-1) </td></tr><tr><td>  <b>C</b> </td><td>  move down (Y + 1) </td></tr><tr><td>  <b>D</b> </td><td>  move one level down (Z + 1) </td></tr><tr><td>  <b>U</b> </td><td>  move one level up (Z-1) </td></tr><tr><td>  <b>-</b> </td><td>  perform an action </td></tr></tbody></table><br>  The necessary conditions for the D and U commands are the location of the marker in the cell with ID = 7 and the presence of the same receiving gateway on another layer at the same coordinates (X, Y). <br>  The action command can be applied while in the field with ID = 5, 8, B, C, D, E. The processing of actions is performed in the procedure at address <b><code>00409FEC</code></b> . <br><br>  In fact, inside this keygenme there is a small step-by-step quest.  The main task is to pass from the field with coordinates (1,0,0) in the field with coordinates (2, 4, 4). <br><br>  Communications in teleports on the fourth level are as follows: <br><img src="https://habrastorage.org/storage2/eb0/f06/b12/eb0f06b126f1210d426256b251c681e2.png"><br><br>  Passing the first four layers is only to move around the map.  In the last fifth layer, one must also fulfill an additional condition for leaving the cube. <br>  Using a set of numbers 1,3,4,6 (fields with ID = B) and arithmetic actions +, -, *, / (fields with ID = C) you need to get the number 12, and all constants should be used.  Those.  option (3-1) * 6 is not suitable. <br>  To use this mini-calculator, you must first perform an action (- command) on two fields with ID = B and one with ID = C. After that, step onto the field with ID = E and perform the action.  To use the result as the first operand, you must perform an action on the field with ID = D. After all the operations, we stand on the field with ID = F. <br><br>  The code for the passage of the first layer: <br> <code>CIIAIPCPPPCCCIIIAIA--AD</code> <br> <br>  The passage of the second and third layers is closely interrelated, so the solution is one to two at once: <br> <code>CCCAAAAII---AAPPPDC-AUIIICC---PPAADCI---APUIIPPDIC-PAUIIDIAD</code> <br> <br>  Code for the fourth layer: <br> <code>PAICP--CPIUC-ADIICAI-ICAAAAPAD</code> <br> <br>  And finally for the last fifth layer: <br> <code>CCP-A-II-CC-PP-AAA-II-CCC-PP-AAP-IIII-PCC-P-</code> <br> <br>  Total we have a serial number: <br> <code>CIIAIPCPPPCCCIIIAIA--ADCCCAAAAII---AAPPPDC-AUIIICC---PPAADCI---APUIIPPDIC-PAUIIDIADPAICP--CPIUC-ADIICAI-ICAAAAPADCCP-A-II-CC-PP-AAA-II-CCC-PP-AAP-IIII-PCC-P-</code> <br> <br>  Enter it in the keygenme and get congratulations. <br><img src="https://habrastorage.org/storage2/971/430/8c6/9714308c659025664f336d99a305ae42.png"><br><br>  <a href="http://yadi.sk/d/yARi6vic59gng">In addition to the article, two videos of the passage of all layers of the cube in binary and pseudographic forms.</a> <br><br>  <a href="http://yadi.sk/d/w55KSse459hkn">To analyze the contents of the cube after processing each character, a simple dll was written, which was inserted into the keygenme address space.</a> </div><p>Source: <a href="https://habr.com/ru/post/180919/">https://habr.com/ru/post/180919/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180909/index.html">Google promotes project to connect remote regions of Africa and Southeast Asia to the Internet</a></li>
<li><a href="../180911/index.html">LinkMeUp. Release 3</a></li>
<li><a href="../180913/index.html">PDF to AutoCAD Converter</a></li>
<li><a href="../180915/index.html">HabraPack returns</a></li>
<li><a href="../180917/index.html">Baby monitor - good "bug"</a></li>
<li><a href="../180923/index.html">Simple JSON Schema validator for Objective-C</a></li>
<li><a href="../180925/index.html">Introduction to Wolfram Mathematica</a></li>
<li><a href="../180927/index.html">Server Visualization: NodeJS + D3.js + PhantomJS</a></li>
<li><a href="../180929/index.html">One of the six remaining in working condition Apple-1 computers sold for $ 671,400</a></li>
<li><a href="../180931/index.html">In open offices, employees are more often ill and worse off.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>