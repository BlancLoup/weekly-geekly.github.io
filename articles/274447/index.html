<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Emsisoft Specialists Discovered Javascript Extortionist</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Emsisoft specialists discovered an extortioner malware written in JavaScript. It was named Ransom32 and is used by attackers for malicious campaigns, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Emsisoft Specialists Discovered Javascript Extortionist</h1><div class="post__text post__text-html js-mediator-article">  Emsisoft specialists <a href="http://blog.emsisoft.com/2016/01/01/meet-ransom32-the-first-javascript-ransomware/">discovered an</a> extortioner malware written in JavaScript.  It was named Ransom32 and is used by attackers for malicious campaigns, similar to the distribution of many other families of this type of malware.  The attackers chose a high level of anonymity for working with Ransom32, the extortioner uses the anonymous Tor network to communicate with their C &amp; C server manager, and the ransom payment is made in bitcoins. <br><br><img src="https://habrastorage.org/files/6b8/02e/06a/6b802e06a463466b9e3d46368e5641f2.jpg"><br><br>  Using JavaScript makes the ransomware cross-platform, it can be used for both Microsoft Windows and Linux and Apple OS X. The key feature of Ransom32 is the distribution model of this ransomware for cybercriminals.  It is a Software as a service (SaaS) model, while in order to gain access to the administrative control panel of the malicious program and its generation, they only need to specify the address of their Bitcoin wallet. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/files/3c4/34b/5cd/3c434b5cd0e4440a8632178efe7cfb79.png"><br>  Fig.  Ransom32 ransomware control panel.  It can be seen that the address of the operator‚Äôs (owner‚Äôs) e-wallet, statistics of infected computers, the amount of funds already received from the users, and the settings of the malicious program are indicated there.  (Emsisoft data). <br><br>  After clicking on the ‚ÄúDownload client.scr‚Äù button, an archive of the malicious program files with the parameters specified in the control panel will be generated for the operator.  This archive has a substantial size that is over 22MB.  The size clearly exceeds the one that is commonly used for other malware files and, as a rule, does not exceed 1MB. <br><br><img src="https://habrastorage.org/files/8da/40c/e23/8da40ce231aa4f4ba827061d8cebeb72.png"><br>  Fig.  Ransomware files inside a self-extracting SFX archive. <br><br>  The malicious program uses the WinRAR scripting language to automatically unpack the contents of the archive into the directory with the user's temporary files, then the chrome.exe file is launched for execution.  The purpose of the files from the archive is as follows. <br><ul><li>  "Chrome" contains a copy of the GPL license agreement. </li><li>  ‚ÄúChrome.exe‚Äù is an <a href="http://nwjs.io/">NW.js</a> application and contains malware code as well as the framework necessary for its success. </li><li>  "Ffmpegsumo.dll", "nw.pak", "icudtl.dat" and "locales" contain the data that the NW.js environment needs to work. </li><li>  ‚ÄúRundll32.exe‚Äù is a renamed copy of the <a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)">Tor client</a> file. </li><li>  ‚ÄúS.exe‚Äù is a renamed copy of the Optimum X Shortcut tool file, which is used to create and manage shortcuts on the desktop and the start menu. </li><li>  ‚ÄúG‚Äù is the configuration file of the malicious program for which the data was specified in the control panel. </li><li>  "Msgbox.vbs" is a small script that displays custom popup text (popup). </li><li>  "U.vbs" is a small script that retrieves a list of all files in the specified directory and deletes them. </li></ul><br><img src="https://habrastorage.org/files/a7b/2a0/fa6/a7b2a0fa6c7743e9a28d06f8004046fd.png"><br>  Fig.  Malware configuration file in JSON format. <br><br>  Files NW.js is a special environment that allows you to develop JavaScript applications for Windows, Linux, OS X. The environment is based on the popular <a href="https://nodejs.org/en/">Node.js</a> and <a href="http://www.chromium.org/">Chromium</a> platforms.  Using it, the developer can integrate his script into the application for any of these platforms.  Thus, attackers can simply adapt the extortionist for Linux and OS X platforms. <br><br>  After executing the ransomware file in the system, it will extract all the above listed files into the directory with temporary files.  Next, it copies itself to the% AppData% \ Chrome Browser directory.  The s.exe file is used to create a shortcut in the user's autorun directory called ‚ÄúChromeService‚Äù.  Next, the malware launches the Tor client file to establish a connection with its C &amp; C server on port 85.  After connecting to the server, the extortionist displays a redemption message to the user. <br><br><img src="https://habrastorage.org/files/994/910/434/994910434c1947648e62807b87a16692.png"><br>  Fig.  A message demanding redemption. <br><br>  After that, Ransom32 starts the file encryption procedure for the following extensions. <br><br>  * .jpg, * .jpeg, * .raw, * .tif, * .gif, * .png, * .bmp, * .3dm, * .max, * .accdb, * .db, * .dbf, *. mdb, * .pdb, * .sql, *. * sav *, *. * spv *, *. * grle *, *. * mlx *, *. * sv5 *, *. * game *, *. * slot *, * .dwg, * .dxf, * .c, * .cpp, * .cs, * .h, * .php, * .asp, * .rb, * .java, * .jar, * .class, * .aaf, * .aep, * .aepx, * .plb, * .prel, * .prproj, * .aet, * .ppj, * .psd, * .indd, * .indl, * .indt, *. indb, * .inx, * .idml, * .pmd, * .xqx, * .xqx, * .ai, * .eps, * .ps, * .svg, * .swf, * .fla, * .as3, * .as, * .txt, * .doc, * .dot, * .docx, * .docm, * .dotx, * .dotm, * .docb, * .rtf, * .wpd, * .wps, *. msg, * .pdf, * .xls, * .xlt, * .xlm, * .xlsx, * .xlsm, * .xltx, * .xltm, * .xlsb, * .xla, * .xlam, * .xll, * .xlw, * .ppt, * .pot, * .pps, * .pptx, * .pptm, * .potx, * .potm, * .ppam, * .ppsx, * .ppsm, * .sldx, *. sldm, * .wav, * .mp3, * .aif, * .iff, * .m3u, * .m4u, * .mid, * .mpa, * .wma, * .ra, * .avi, * .mov, * .mp4, * .3gp, * .mpeg, * .3g2, * .asf, * .asx, * .flv, * .mpg, * .wmv, * .vob, * .m3u8, * .csv, *. efx, * .sdf, * .vcf, * .xml, * .ses, * .dat <br><br>  At the same time, Ransom32 does not attempt to encrypt files in directories that contain the following lines in the titles. <br><ul><li>  : \ windows \ </li><li>  : \ winnt \ </li><li>  programdata \ </li><li>  boot \ </li><li>  temp \ </li><li>  tmp \ </li><li>  $ recycle.bin \ </li></ul><br>  File encryption is performed using <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a> symmetric algorithm and a 128-bit key in <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">block CTR mode</a> .  A new encryption key is generated for each file.  The key is encrypted using the RSA algorithm and a public key that is downloaded from the management server during the first connection. <br><br><img src="https://habrastorage.org/files/849/e1f/ec9/849e1fec916047878dce04a3faccc8bc.png"><br>  Fig.  A fragment of the network interaction between the malware and the C &amp; C server, when the latter sends the RSA public key (the key length is marked yellow, the key is green) in response to sending the bitcoin wallet address (purple). <br><br>  The AES key encrypted with the public key is stored along with the data of the encrypted file.  The malware also offers the victim to decrypt a single file to demonstrate that attackers can actually decrypt the files.  At the same time, the malicious program will send an encrypted AES key of the specified file to the management server and will receive a decrypted version of the key. <br><br>  To protect our data from this type of malware, we recommend regularly updating the operating system, timely backing up data and using antivirus software. </div><p>Source: <a href="https://habr.com/ru/post/274447/">https://habr.com/ru/post/274447/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274431/index.html">Django-nonrel Google App Engine for Python website</a></li>
<li><a href="../274437/index.html">Comparison of the transition process of Angular2 applications to version beta.0 in Dart and TypeScript languages</a></li>
<li><a href="../274439/index.html">Php Inspections (EA Extended): choose a strategy for 2016</a></li>
<li><a href="../274443/index.html">Microsoft will notify users of state-sponsored cyber attacks</a></li>
<li><a href="../274445/index.html">Kill switch for OpenVPN based on iptables</a></li>
<li><a href="../274449/index.html">Own search by hand rutracker.org - implementation on Yii2</a></li>
<li><a href="../274451/index.html">Expansion of sections without data loss</a></li>
<li><a href="../274453/index.html">Black Hat USA 2015: the full story of the hacking of the very Jeep</a></li>
<li><a href="../274455/index.html">Creating a function on Rust that accepts a String or & str</a></li>
<li><a href="../274457/index.html">Defending Revel from CSRF attacks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>