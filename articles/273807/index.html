<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parse HTML in .NET and Survive: Analyzing and Comparing Libraries</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the course of working on one home project, I was faced with the need for parsing HTML. Google search gave a comment to Athari and his micro-review ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parse HTML in .NET and Survive: Analyzing and Comparing Libraries</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e9e/461/875/e9e46187540d496fadb65a61d2af95f5.png" align="left"><br>  In the course of working on one home project, I was faced with the need for parsing HTML.  Google search gave a <a href="http://habrahabr.ru/post/112325/">comment to</a> <a href="https://habrahabr.ru/users/athari/" class="user_link">Athari</a> and his micro-review of actual HTML parsers in .NET for which <a href="https://habrahabr.ru/users/athari/" class="user_link">many</a> thanks to him. <br><br>  Unfortunately, no figures and / or arguments in favor of this or that parser were found, which was the reason for writing this article. <br><br>  Today I will test popular, at the moment, libraries for working with HTML, namely: <a href="https://github.com/AngleSharp/AngleSharp">AngleSharp</a> , <a href="https://github.com/jamietre/CsQuery">CsQuery</a> , <a href="https://code.google.com/p/fizzler/">Fizzler</a> , <a href="https://htmlagilitypack.codeplex.com/">HtmlAgilityPack</a> and, of course, <a href="http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454">Regex-way</a> .  I compare them in speed and usability. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <br clear="left">  <b>TL; DR</b> : The code for all benchmarks can be found on <a href="https://github.com/forcewake/Benchmarks">github</a> .  There are also test results.  The most relevant parser at the moment is <a href="https://github.com/AngleSharp/AngleSharp">AngleSharp</a> - a convenient, fast, <s>youth</s> parser with a convenient API. <br><br>  Those who are interested in a detailed review - welcome under cat. <br><a name="habracut"></a><br><h2>  <font color="#cc0000">Content</font> </h2><br><ul><li>  <a href="https://habr.com/ru/post/273807/">Library Description</a> <br><ul><li>  <a href="https://habr.com/ru/post/273807/">HtmlAgilityPack</a> </li><li>  <a href="https://habr.com/ru/post/273807/">Fizzler</a> </li><li>  <a href="https://habr.com/ru/post/273807/">Csquery</a> </li><li>  <a href="https://habr.com/ru/post/273807/">Anglesharp</a> </li><li>  <a href="https://habr.com/ru/post/273807/">Regex</a> </li></ul><br></li><li>  <a href="https://habr.com/ru/post/273807/">Benchmark</a> <br><ul><li>  <a href="https://habr.com/ru/post/273807/">Getting addresses from links on the page</a> </li><li>  <a href="https://habr.com/ru/post/273807/">Getting data from a table</a> </li></ul><br></li><li>  <a href="https://habr.com/ru/post/273807/">findings</a> <br></li></ul><br><a name="description"></a><br><h2>  <font color="#cc0000">Library Description</font> </h2><br>  In this section there will be brief descriptions of the libraries in question, a description of licenses, and so on. <br><a name="HtmlAgilityPack"></a><br><h3>  <font color="#cc0000"><a href="https://htmlagilitypack.codeplex.com/">HtmlAgilityPack</a></font> </h3><br>  One of the most (if not the most) well-known HTML parser in the .NET world.  A lot of articles have been written about him in both Russian and English, for example, on <a href="http://habrahabr.ru/post/112325/">habrahabr</a> . <br><br>  In short, this is a fast, relatively convenient library for working with HTML (if the XPath queries are simple).  <a href="https://htmlagilitypack.codeplex.com/">The repository</a> has not been updated for a long time. <br>  <b>MS-PL</b> license. <br><br>  The parser will be convenient if the task is typical and well described by the XPath expression, for example, to get all the links from the page, we need quite a bit of code: <br><br><pre><code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Extract all anchor tags using HtmlAgilityPack </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public IEnumerable</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> HtmlAgilityPack() { HtmlDocument htmlSnippet = new HtmlDocument(); htmlSnippet.LoadHtml(Html); List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> hrefTags = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment">(); foreach (HtmlNode link in htmlSnippet.DocumentNode.SelectNodes("//a[@href]")) { HtmlAttribute att = link.Attributes["href"]; hrefTags.Add(att.Value); } return hrefTags; }</span></span></code> </pre> <br>  However, if you want to work with css-classes, then using XPath will give you a lot of headaches: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Extract all anchor tags using HtmlAgilityPack </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public IEnumerable</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> HtmlAgilityPack() { HtmlDocument hap = new HtmlDocument(); hap.LoadHtml(html); HtmlNodeCollection nodes = hap .DocumentNode .SelectNodes("//h3[contains(concat(' ', @class, ' '), ' r ')]/a"); List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> hrefTags = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment">(); if (nodes != null) { foreach (HtmlNode node in nodes) { hrefTags.Add(node.GetAttributeValue("href", null)); } } return hrefTags; }</span></span></code> </pre><br>  From the observed oddities - a specific API, sometimes incomprehensible and confusing.  If nothing is found, it returns <code>null</code> , not an empty collection.  Well, the library update was somehow delayed - for a long time nobody commited.  The bugs are not fixed ( <a href="https://habrahabr.ru/users/athari/" class="user_link">Athari</a> mentioned a critical bug <a href="https://htmlagilitypack.codeplex.com/workitem/29218">Incorrect parsing of HTML4 optional end tags</a> , which leads to incorrect processing of HTML tags, closing tags for which are optional.) <br><a name="Fizzler"></a><br><h3>  <font color="#cc0000"><a href="https://code.google.com/p/fizzler/">Fizzler</a></font> </h3><br>  Add-in to the HtmlAgilityPack, which allows the use of CSS selectors. <br>  The code, in this case, will be a clear description of what problem <a href="https://code.google.com/p/fizzler/">Fizzler</a> solves: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//     var html = new HtmlDocument(); html.LoadHtml(@" &lt;html&gt; &lt;head&gt;&lt;/head&gt; &lt;body&gt; &lt;div&gt; &lt;p class='content'&gt;Fizzler&lt;/p&gt; &lt;p&gt;CSS Selector Engine&lt;/p&gt;&lt;/div&gt; &lt;/body&gt; &lt;/html&gt;"); // Fizzler   -  HtmlAgilityPack //   QuerySelectorAll  HtmlNode var document = html.DocumentNode; // : [&lt;p class="content"&gt;Fizzler&lt;/p&gt;] document.QuerySelectorAll(".content"); // : [&lt;p class="content"&gt;Fizzler&lt;/p&gt;,&lt;p&gt;CSS Selector Engine&lt;/p&gt;] document.QuerySelectorAll("p"); //    document.QuerySelectorAll("body&gt;p"); //  [&lt;p class="content"&gt;Fizzler&lt;/p&gt;,&lt;p&gt;CSS Selector Engine&lt;/p&gt;] document.QuerySelectorAll("body p"); //  [&lt;p class="content"&gt;Fizzler&lt;/p&gt;] document.QuerySelectorAll("p:first-child");</span></span></code> </pre><br>  The speed of work is almost the same as HtmlAgilityPack, but it is more convenient due to the work with CSS selectors. <br><br>  With commits, the same problem as with HtmlAgilityPack - there are no updates for a long time and, apparently, it is not foreseen. <br><br>  License: <b>LGPL</b> . <br><a name="CsQuery"></a><br><h3>  <font color="#cc0000"><a href="https://github.com/jamietre/CsQuery">Csquery</a></font> </h3><br>  It was one of the modern HTML parsers for .NET.  The validator.nu parser for Java, which in turn is a port of the parser from the Gecko engine (Firefox), was taken as the basis. <br><br>  The API was inspired by jQuery, and the selector language is CSS.  The names of the methods are copied almost one-to-one, that is, for programmers who are familiar with jQuery, learning will be easy. <br><br>  Currently, the development of <a href="https://github.com/jamietre/CsQuery">CsQuery</a> is in a passive stage. <br><br><div class="spoiler">  <b class="spoiler_title">Message from the developer</b> <div class="spoiler_text"><blockquote>  CsQuery is not being actively maintained.  I no longer work in .NET much more these day!  Therefore, it is difficult to address any problems or questions.  If you post issues, I‚Äôm not going to be able to fix them. <br><br>  It is a stable release, it is stable, it has been found out.  However, I‚Äôm not going to know what to say about a new release. <br><br>  Making this project active again.  If you use CsQuery and are interested in being a collaborator on the project please contact me directly. <br></blockquote><br></div></div><br>  The author himself advises to use <a href="https://github.com/AngleSharp/AngleSharp">AngleSharp</a> as an alternative to your project. <br><br>  The code for getting links from the page looks nice and familiar to anyone using jQuery: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Extract all anchor tags using CsQuery </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public IEnumerable</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> CsQuery() { List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> hrefTags = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment">(); CQ cq = CQ.Create(Html); foreach (IDomObject obj in cq.Find("a")) { hrefTags.Add(obj.GetAttribute("href")); } return hrefTags; }</span></span></code> </pre><br>  License: <a href="https://github.com/jamietre/CsQuery/blob/master/LICENSE.txt"><b>MIT</b></a> <br><a name="AngleSharp"></a><br><h3>  <font color="#cc0000"><a href="https://github.com/AngleSharp/AngleSharp">Anglesharp</a></font> </h3><br>  Unlike CsQuery, it is written from scratch manually in C #.  Also includes parsers of other languages. <br><br>  The API is based on the official JavaScript specification of the HTML DOM.  In some places there are oddities unusual for developers on .NET (for example, when accessing the wrong index in the collection, null will be returned and not an exception thrown; there is a separate Url class; namespaces are very granular), but in general nothing is critical. <br><br>  The library is developing very quickly.  The number of different buns that facilitate the work is simply amazing, for example, <a href="">IHtmlTableElement</a> , <a href="">IHtmlProgressElement,</a> and so on. <br><br>  The code is clean, neat, convenient. <br>  For example, extracting links from a page is practically no different from Fizzler: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Extract all anchor tags using AngleSharp </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public IEnumerable</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> AngleSharp() { List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> hrefTags = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment">(); var parser = new HtmlParser(); var document = parser.Parse(Html); foreach (IElement element in document.QuerySelectorAll("a")) { hrefTags.Add(element.GetAttribute("href")); } return hrefTags; }</span></span></code> </pre><br>  And for more complex cases there are dozens of specialized interfaces that will help solve the problem. <br><br>  License: <a href="https://github.com/AngleSharp/AngleSharp/blob/master/LICENSE"><b>MIT</b></a> <br><a name="Regex"></a><br><h3>  <font color="#cc0000"><a href="https://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex(v%3Dvs.110).aspx">Regex</a></font> </h3><br>  Ancient and not the most successful approach to working with HTML.  I really liked the commentary of <a href="https://habrahabr.ru/users/athari/" class="user_link">Athari</a> , so I will comment on it here, and will duplicate it: <br><blockquote>  Scary and horrible regular expressions.  It is undesirable to use them, but sometimes it becomes necessary, since the parsers that build the DOM are noticeably more gluttonous than the Regex: they consume more CPU time and memory. <br><br>  If it came to regular expressions, then you need to understand that you can not build on them a universal and absolutely reliable solution.  However, if you want to parse a specific site, then this problem may not be so critical. <br><br>  For God's sake, do not turn regular expressions into unreadable mess.  You do not write C # code in one line with single-letter variable names, and regular expressions do not need to be spoiled.  The regular expression engine in .NET is powerful enough to be able to write high-quality code. <br></blockquote><br>  The code for getting links from the page looks more or less clear: <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Extract all anchor tags using Regex </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public IEnumerable</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> Regex() { List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment"> hrefTags = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;string&gt;</span></span></span><span class="hljs-comment">(); Regex reHref = new Regex(@"(?inx) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;a \s [^&gt;</span></span></span><span class="hljs-comment">]* href \s* = \s* (?</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;q&gt;</span></span></span><span class="hljs-comment"> ['""] ) (?</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;url&gt;</span></span></span><span class="hljs-comment"> [^""]+ ) \k</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;q&gt;</span></span></span><span class="hljs-comment"> [^&gt;]* &gt;"); foreach (Match match in reHref.Matches(Html)) { hrefTags.Add(match.Groups["url"].ToString()); } return hrefTags; }</span></span></code> </pre><br><br>  But if you suddenly want to work with the tables, and even in an elaborate format, please look <a href="">here</a> first. <br><br>  The license is listed on <a href="http://www.microsoft.com/net/dotnet_library_license.htm">this site</a> . <br><a name="Benchmark"></a><br><h2>  <font color="#cc0000">Benchmark</font> </h2><br>  The speed of the parser, whatever one may say, is one of the most important attributes.  The speed of HTML processing depends on how long your task will take. <br><br>  To measure the performance of parsers, I used the <a href="https://habrahabr.ru/users/dreamwalker/" class="user_link">DreamWalker</a> <a href="https://github.com/PerfDotNet/BenchmarkDotNet">BenchmarkDotNet</a> library, for which <a href="https://habrahabr.ru/users/dreamwalker/" class="user_link">many thanks</a> to him. <br><br>  The measurements were made on an Intel¬Æ Core (TM) i7-4770 CPU @ 3.40GHz, but experience suggests that the relative time will be the same on any other configurations. <br><br>  A few words about <b>Regex</b> - do not repeat this at home.  Regex is a very good tool in capable hands, but working with HTML is not exactly where to use it.  But as an experiment, I tried to implement a minimally working version of the code.  He completed his task successfully, but the amount of time spent writing this code suggests that I‚Äôm definitely not going to repeat it. <br><br>  Well, let's look at the benchmarks. <br><a name="ahref-benchmark"></a><br><h3>  <font color="#cc0000">Getting addresses from links on the page</font> </h3><br>  This problem, it seems to me, is basic for all parsers - more often with this formulation of the task, a fascinating acquaintance with the world of parsers begins (sometimes Regex). <br><br>  The benchmark code can be found on <a href="">github</a> , and below is a table with the results: <br><br><table><tbody><tr><td>  <b>Library</b> </td><td>  <b>Average time</b> </td><td>  <b>Standard deviation</b> </td><td>  <b>operations / sec</b> </td></tr><tr><td>  <a href="https://github.com/AngleSharp/AngleSharp">Anglesharp</a> </td><td>  8.7233 ms </td><td>  0.4735 ms </td><td>  114.94 </td></tr><tr><td>  <a href="https://github.com/jamietre/CsQuery">Csquery</a> </td><td>  12.7652 ms </td><td>  0.2296 ms </td><td>  78.36 </td></tr><tr><td>  <a href="https://code.google.com/p/fizzler/">Fizzler</a> </td><td>  5.9388 ms </td><td>  0.1080 ms </td><td>  168.44 </td></tr><tr><td>  <a href="https://htmlagilitypack.codeplex.com/">HtmlAgilityPack</a> </td><td>  5.4742 ms </td><td>  0.1205 ms </td><td>  182.76 </td></tr><tr><td>  <a href="http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454">Regex</a> </td><td>  3.2897 ms </td><td>  0.1240 ms </td><td>  304.37 </td></tr></tbody></table><br><br>  In general, the expected Regex was the fastest, but not the most convenient.  HtmlAgilityPack and Fizzler showed approximately the same processing time, slightly ahead of AngleSharp.  CsQuery, unfortunately, has hopelessly lagged behind.  It is likely that I do not know how to cook it.  I would be glad to hear comments from people who worked with this library. <br><br>  It is not possible to evaluate the convenience, since the code is almost identical.  But other things being equal, I liked the CsQuery and AngleSharp code more. <br><a name="table-benchmark"></a><br><h3>  <font color="#cc0000">Getting data from a table</font> </h3><br>  I encountered this task in practice.  Moreover, the table with which I was supposed to work was not easy. <br><br><div class="spoiler">  <b class="spoiler_title">A note about life in Belarus</b> <div class="spoiler_text">  I wanted to receive current information about the exchange rate of currencies in the glorious city of Minsk.  No services were found for obtaining information about courses at banks, but stumbled upon <a href="http://select.by/kurs/">http://select.by/kurs/</a> .  There, information is updated frequently and there is what I need.  But in a very inconvenient format. <br>  Guys, if you read this - make a normal service, well, or at least correct HTML. <br></div></div><br><br>  I made an attempt to hide everything as much as possible that is not specific to HTML processing, but due to the specifics of the task, not everything worked out. <br><br>  The code for all libraries is about the same, the only difference is in the API and how the results are returned.  However, it is worth mentioning two things: first, AngleSharp has specialized interfaces, which made it easier to solve the problem.  Secondly, Regex for this task does not fit at <a href="">all</a> . <br><br>  Let's see the results: <br><br><table><tbody><tr><td>  <b>Library</b> </td><td>  <b>Average time</b> </td><td>  <b>Standard deviation</b> </td><td>  <b>operations / sec</b> </td></tr><tr><td>  <a href="https://github.com/AngleSharp/AngleSharp">Anglesharp</a> </td><td>  27.4181 ms </td><td>  1.1380 ms </td><td>  36.53 </td></tr><tr><td>  <a href="https://github.com/jamietre/CsQuery">Csquery</a> </td><td>  42.2388 ms </td><td>  0.7857 ms </td><td>  23.68 </td></tr><tr><td>  <a href="https://code.google.com/p/fizzler/">Fizzler</a> </td><td>  21.7716 ms </td><td>  0.6842 ms </td><td>  45.97 </td></tr><tr><td>  <a href="https://htmlagilitypack.codeplex.com/">HtmlAgilityPack</a> </td><td>  20.6314 ms </td><td>  0.3786 ms </td><td>  48.49 </td></tr><tr><td>  <a href="http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454">Regex</a> </td><td>  42.2942 ms </td><td>  0.1382 ms </td><td>  23.64 </td></tr></tbody></table><br><br>  As in the previous example, HtmlAgilityPack and Fizzler showed about the same and very good time.  AngleSharp is behind them, but maybe I didn‚Äôt do everything in the most optimal way.  To my surprise, CsQuery and Regex showed equally bad processing time.  If everything is clear with CsQuery - it is just slow, then with Regex everything is not so simple - most likely the problem can be solved in a more optimal way. <br><a name="results"></a><br><h2>  <font color="#cc0000">findings</font> </h2><br>  Conclusions, probably, everyone made for himself.  From myself I will add that AngleSharp will be the best choice now, as it is being actively developed, it has an intuitive API and it shows well the processing time.  Does it make sense to run over AngleSharp with HtmlAgilityPack?  Most likely not - we put Fizzler and enjoy a very fast and convenient library. <br><br>  Thank you all for your attention. <br>  All code can be found in <a href="https://github.com/forcewake/Benchmarks">the github repository</a> .  Any additions and / or changes are welcome. </div><p>Source: <a href="https://habr.com/ru/post/273807/">https://habr.com/ru/post/273807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273797/index.html">How we made Rich Text Editor with support for co-editing under Android</a></li>
<li><a href="../273799/index.html">New Year Promotion for HPE ProLiant Gen9 Servers</a></li>
<li><a href="../273801/index.html">A new version of LinqTestable has been released - libraries for testing requests to the database via ORM</a></li>
<li><a href="../273803/index.html">IBM FlashSystem 900 storage system overview</a></li>
<li><a href="../273805/index.html">Zabbix + SoapUI = monitoring web services</a></li>
<li><a href="../273809/index.html">Comparison of free software accounting traffic SQUID</a></li>
<li><a href="../273811/index.html">New Year's release of PVS-Studio 6.00: check Roslyn</a></li>
<li><a href="../273813/index.html">Balancing traffic between two NATs on different providers on the same cisco physical router</a></li>
<li><a href="../273815/index.html">A bit about container virtualization</a></li>
<li><a href="../273817/index.html">7 games in 7 days: rewarded video</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>