<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Marketer Notes: How to install Ubuntu on RPI and connect to Azure IoT Hub</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What does the marketer do when he is asked to tell how to use the technology, but he cannot find instructions? Usually starts to pull all the surround...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Marketer Notes: How to install Ubuntu on RPI and connect to Azure IoT Hub</h1><div class="post__text post__text-html js-mediator-article">  What does the marketer do when he is asked to tell how to use the technology, but he cannot find instructions?  Usually starts to pull all the surrounding techies, search the Internet or silently wait for a miracle, or cry.  But, this story is about another marketer.  He just took and wrote the instructions himself.  I invite under the cut to evaluate the works and share your opinion. <br><br><img src="https://habrastorage.org/web/c6d/6ff/878/c6d6ff8783ac492dacd899925e9f2b8e.jpg"><br><a name="habracut"></a><br>  I give the word to <a href="https://habrahabr.ru/users/andvis/">Andrew</a> . <br><br><blockquote>  <b>Disclaimer</b> : <br>  Colleagues, I do not pretend to the truth - just sharing my experience.  Maybe he will save someone a little time and effort.  And yes, at the time of writing this article, I saw the Linux command line for the first time in my life. </blockquote><br>  Let's agree that below we will talk about the Raspberry Pi 2 Model B. It was during the work with him that all the screenshots were taken. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/179/258/5be/1792585bebb04c1dad8c1f590b0cd2c7.png"><br><br>  The Ubuntu Mate distribution can be downloaded, for example, <a href="https://ubuntu-mate.org/download/">here</a> . <br><br>  Having an img file - we create a bootable SDCard - for this I used Win32 Disk Imager, which I installed on my Windows 10. <br><br><img src="https://habrastorage.org/web/dfb/16d/897/dfb16d8972374461ac516c4e56715321.png"><br><br>  The resulting boot card is inserted into the Raspberry Pi, we connect the keyboard, mouse and display.  After successful loading see the window below. <br><br><img src="https://habrastorage.org/web/098/ca2/3a9/098ca23a9e2d4d0e873a0de8c17ca4a8.jpg"><br><hr><img src="https://habrastorage.org/web/d98/666/69b/d9866669bcc14a06a688b2062be18693.jpg"><br>  After installation, we execute several commands. <br><br> <code>sudo update-rc.d ssh enable</code> <br> <img src="https://habrastorage.org/web/e67/ea4/f65/e67ea4f65cce4d5b9ac50cf190d42a20.png"><br><br> <code>sudo service ssh restart</code> <br> <img src="https://habrastorage.org/web/267/e71/17f/267e7117f5b7466fba2961a35173975d.png"><br><br>  <code>sudo ifconfig</code> - shows us the network settings of the device <br><img src="https://habrastorage.org/web/2aa/c45/e0f/2aac45e0fcbf44928dd9457ba6602774.png"><br><br>  Important update and upgrade commands - to upgrade the system. <br><br> <code>sudo apt-get update</code> <br> <img src="https://habrastorage.org/web/4a7/a6e/46d/4a7a6e46db384b648ccd4d40909f741f.png"><br><br> <code>sudo apt-get upgrade</code> <br> <img src="https://habrastorage.org/web/fb2/cb6/0f3/fb2cb60f3e1f42eda01472fc1c9fbbd8.png"><br><br>  Next, add the Russian language for the keyboard. <br><img src="https://habrastorage.org/web/174/73f/075/17473f0755b74466a53802c136e4b231.jpg"><br><br>  This is how you can change the switch key combination (I spent a couple of minutes until I found this item). <br><br><img src="https://habrastorage.org/web/657/965/268/657965268ddb46f5917674c908570047.png"><br><br>  I read on one of the forums that I2C should be enabled: with the <code>sudo raspi-config</code> command. <br><br>  Here by the way, and the SSH settings can be changed. <br><br><img src="https://habrastorage.org/web/211/c61/e8e/211c61e8eadb44a2bb1ce30849038f10.jpg"><br><hr><img src="https://habrastorage.org/web/295/fc4/819/295fc481932c43f98bf58f0fac88c120.jpg"><br><br>  There are no sensors at hand yet - I try to do at least something ... I read <a href="https://www.concurrency.com/blog/march-2016/azure,-azure-automation-,-azure-iot-hub-,-iot,-l">this article</a> . <br><br>  Let's start with the fact that we need an Azure subscription!  You can get a trial version <a href="https://azure.microsoft.com/ru-ru/free/%3Fwt.mc_id%3DAID570629_QSG_BLOG_139069">here</a> . <br><br>  Our next steps. <br><br>  <b>Step 1</b> . <br><img src="https://habrastorage.org/web/aab/37c/5d5/aab37c5d5aeb480b89d1aeabff1acdd6.png"><br><br>  <b>Step 2</b> . <br><img src="https://habrastorage.org/web/8ef/e2c/18a/8efe2c18a88e4939abf37bc0d35cd213.png"><br><br>  <b>Step 3</b> . <br><img src="https://habrastorage.org/web/8eb/244/ef1/8eb244ef1ed649f5979184286c3ffa3b.png"><br><br>  <b>Step 4</b> . <br><img src="https://habrastorage.org/web/a29/990/f27/a29990f27288440db5e6f5c73881a97f.png"><br><br>  So back to the device!  The <code>node -v</code> command returns an error on my RPI. <br><br><img src="https://habrastorage.org/web/4f9/e80/9ea/4f9e809eaead4891b79efe5018cd0e15.png"><br><br>  Install Node.js.  To do this, we drive the command: <code>sudo apt install nodejs-legacy</code> . <br><br><img src="https://habrastorage.org/web/cfe/2a0/bef/cfe2a0befa13407da16d9cba1f4ac3ea.png"><br><br>  Now the <code>node -v</code> command returns the current version. <br><br><img src="https://habrastorage.org/web/1be/ce8/352/1bece83529894ff4abe60929fa6598ea.png"><br><br>  Just in case. <br><br><img src="https://habrastorage.org/web/d10/de8/d24/d10de8d244d140bd909fbe6bb1cabe45.png"><br><br>  Now you need NPM - install with the command: <code>sudo apt-get install npm</code> .  The team is not fast, but it worked! <br><br><img src="https://habrastorage.org/web/4b8/404/4df/4b84044df9254883aba7bfadc9f9b0dc.png"><br><br>  Next, run: <code>sudo npm install -g npm@2.x</code> . <br><br><img src="https://habrastorage.org/web/01f/220/e7c/01f220e7c01c4d41975a47e42f9b73c8.png"><br><br>  Now you need to install the latest version of IoT Hub transport package: <code>sudo npm install -g azure-iot-device@latest</code> . <br><br><img src="https://habrastorage.org/web/8cb/620/f5e/8cb620f5e0894b44a618dbec41ffae40.png"><br><br>  And one more command: <code>sudo npm install -g azure-iot-device-http@latest</code> . <br><br><img src="https://habrastorage.org/web/1a2/702/417/1a27024176eb4463a5767de3b29cf8af.png"><br><br>  Now you need to install IoT Explorer: <code>sudo npm install -g iothub-explorer@latest</code> . <br><br><img src="https://habrastorage.org/web/ea0/ac9/9ad/ea0ac99ad20147eb99e701bc8c7ea660.png"><br><br>  The next step is to run the following command: <code>iothub-explorer login " "</code> . <br><br><img src="https://habrastorage.org/web/c3c/d04/1bd/c3cd041bdb514d6fa4e432b5c42339f3.png"><br><br>  Next, connect the device: <code>iothub-explorer create muzeyrpi-1 --connection-string</code> .  Successfully! <br><br><img src="https://habrastorage.org/web/7ac/93d/91d/7ac93d91d99745f388019afed36e426d.png"><br><br>  The portal Azure device can be seen. <br><br><img src="https://habrastorage.org/web/418/41a/d39/41841ad399ec4e7695faa170bd3a7933.png"><br><br>  Copy the JS script from the <a href="https://www.concurrency.com/blog/march-2016/azure,-azure-automation-,-azure-iot-hub-,-iot,-l">page</a> to the device: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> connectionString = <span class="hljs-string"><span class="hljs-string">'&lt;your device connection string&gt;'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> clientFromConnectionString = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'/usr/lib/node_modules/azure-iot-device-http'</span></span>).clientFromConnectionString; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = clientFromConnectionString(connectionString); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Message = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'/usr/lib/node_modules/azure-iot-device'</span></span>).Message; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> msg = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Message(<span class="hljs-string"><span class="hljs-string">'some data from my device'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> connectCallback = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(<span class="hljs-string"><span class="hljs-string">'Could not connect: '</span></span> + err); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Client connected'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> message = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Message(<span class="hljs-string"><span class="hljs-string">'some data from my device'</span></span>); client.sendEvent(message, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(err.toString()); }); client.on(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">msg</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(msg); client.complete(msg, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'completed'</span></span>); }); }); } }; client.open(connectCallback);</code> </pre> <br>  By itself, the script does not start - you need: <br><ol><li>  In the paths inside the file, you must change <code>/usr/lib</code> to <code>/usr/local/lib</code> . </li><li>  Add connection string.  And the connection string to the device. </li></ol><br><img src="https://habrastorage.org/web/5ad/d92/89b/5add9289b25e46239dd9283326d2ae92.png"><br><br>  The script is launched by the <code>node MyScript.js</code> from the folder where the script is located. <br><br><img src="https://habrastorage.org/web/79d/618/5be/79d6185be1e94ce9b63e5d1001064824.png"><br><br>  We try again - this time in Device Explorer (more about it and the download link in the <a href="https://www.concurrency.com/blog/march-2016/azure,-azure-automation-,-azure-iot-hub-,-iot,-l)">article</a> . <br><br><img src="https://habrastorage.org/web/97c/1ef/5c4/97c1ef5c420c4b95ae99217aa7a7b210.png"><br><br>  Hit Enter ... :) <br><br><img src="https://habrastorage.org/web/6e6/fe1/749/6e6fe17490f24834adc20f8daa32d365.png"><br><br>  Congratulations - the first posts from our RPI reached Azure IoT Hub <br><br>  I sincerely hope to improve this manual and make it even more useful!  For example, passing <a href="https://docs.microsoft.com/ru-ru/azure/iot-hub/iot-hub-raspberry-pi-kit-node-get-started">this way here</a> (with or without a BME280 sensor). <br><br><h2>  For those who read </h2><br>  In order for you to try this exercise yourself, Andrei and I decided to play two pieces of Raspberry Pi 3. They will receive the first 2 people who answer correctly in messages from the <a href="https://vk.com/msdnru">Microsoft Developer</a> community to the question: ‚ÄúOn the basis of which microcontroller was the earliest version developed Raspberry Pi? ‚Äù <a href="https://vk.com/doc3861744_447958086">General rules</a> . </div><p>Source: <a href="https://habr.com/ru/post/332940/">https://habr.com/ru/post/332940/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332928/index.html">Implementing Elliptic curve Menezes-Vanstone cryptosystem based on the OpenSSL API</a></li>
<li><a href="../332930/index.html">Solution of the promo task from BI.ZONE CTF</a></li>
<li><a href="../332934/index.html">Setting up object archiving in SAP ERP for beginners</a></li>
<li><a href="../332936/index.html">Method of non-iterative learning of a single-layer network of direct distribution with a linear activation function</a></li>
<li><a href="../332938/index.html">How to build a small but good network?</a></li>
<li><a href="../332942/index.html">Post-quantum cryptography and the decline of the RSA - a real threat or an imaginary future?</a></li>
<li><a href="../332944/index.html">IoT on guard, or how to make our world a little safer</a></li>
<li><a href="../332946/index.html">Experience in implementing Apple Pay mobile payment service in a bank</a></li>
<li><a href="../332948/index.html">You are using interfaces in go wrong!</a></li>
<li><a href="../332950/index.html">Aggregation of Internet channels through mobile operators</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>