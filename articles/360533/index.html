<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>64-bit hashmap in js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How would you do a quick hashmap for 64-bit keys? If the keys are 32-bit, then you can hardly do something faster than the built-in ES6 Map , but if t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>64-bit hashmap in js</h1><div class="post__text post__text-html js-mediator-article"><p> How would you do a quick hashmap for 64-bit keys?  If the keys are 32-bit, then you can hardly do something faster than the built-in ES6 <code>Map</code> , but if the keys are 64-bit, then the complexity begins because JS is stuck on a 32-bit <code>int</code> . </p><br><img src="https://habrastorage.org/getpro/habr/post_images/6b2/be4/7fc/6b2be47fca1f3194f37a053f0efdf544.png"><a name="habracut"></a><br><p>  I came across this task when I had to compare two rather large memory dumps: a text file on the left where each line is a 64-bit address and a variable type, and a similar file on the right.  Each file contains approximately one million addresses and only 50 thousand of them are different. </p><br><p>  For the sake of interest, I wrote several simple hashmaps and compared them on a similar task: two arrays of key-value pairs are given, where the key is two 32-bit numbers, both arrays are more than a million elements and the difference between them is 10-100 thousand elements - you need to find this difference and group it by values.  It turned out that the fastest is not a built-in <code>Map</code> at all but a self-written (on JS) standard hashmap with lists for keys with identical hashes. </p><br><p><a href="https://github.com/cd48b153/hashmap-contest"></a>  <a href="https://github.com/cd48b153/hashmap-contest">https://github.com/cd48b153/hashmap-contest</a> </p><br><table><thead><tr><th></th><th>  1M-50K </th><th>  2M-100K </th><th>  3M-5K </th></tr></thead><tbody><tr><td>  es6-concat </td><td>  1.00 </td><td>  0.98 </td><td>  0.81 </td></tr><tr><td>  es6-stack </td><td>  0.57 </td><td>  0.49 </td><td>  0.55 </td></tr><tr><td>  hashmap </td><td>  1.95 </td><td>  2.13 </td><td>  1.99 </td></tr><tr><td>  list </td><td>  0.41 </td><td>  0.27 </td><td>  0.25 </td></tr><tr><td>  naive-stack </td><td>  1.33 </td><td>  1.27 </td><td>  1.33 </td></tr><tr><td>  naive </td><td>  1.00 </td><td>  1.00 </td><td>  1.00 </td></tr><tr><td>  trie </td><td>  0.75 </td><td>  0.74 </td><td>  0.58 </td></tr></tbody></table><br><p>  The construction of the <code>Map&lt;Map&lt;int, string&gt;&gt;</code> view <code>Map&lt;Map&lt;int, string&gt;&gt;</code> turns out to be 2 times slower than the self-defined hashmap.  The "naive" hasmap based on <code>{}</code> taken as a reference point.  Npm.js hashtable which is written in C ++ and uses std :: unordered_map turned out to be the slowest.  It is not in the table because it corrupts the memory and crashes the node, but on average its speed was at 2.5, that is 2.5 times slower than the naive <code>{}</code> hashmap. </p><br><p>  Can anyone do it faster than my own hashmap?  PRs welcome :) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/360533/">https://habr.com/ru/post/360533/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../360329/index.html">Stephen Wolfram "Making Great Projects"</a></li>
<li><a href="../360491/index.html">Oil and gas dilemma: in search of alternative DBMS</a></li>
<li><a href="../360495/index.html">Monitoring file changes in Node.js</a></li>
<li><a href="../360527/index.html">Personal data on GDPR. We read the law</a></li>
<li><a href="../360529/index.html">Lanitovskie environment. Why LANIT believed in blockchain</a></li>
<li><a href="../360535/index.html">FBI advises to restart its routers to get rid of VPNFilter</a></li>
<li><a href="../360863/index.html">Coin (Coin)</a></li>
<li><a href="../361131/index.html">The dreams of Robert Boyle come true. Part 1</a></li>
<li><a href="../361159/index.html">Digital events in Moscow from May 28 to June 3</a></li>
<li><a href="../361195/index.html">UniFi is my experience using</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>