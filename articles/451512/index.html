<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to disassemble the network protocol mobile MMORPG</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Over the years of playing one mobile MMORPG, I have gained some experience in its reverse engineering, which I would like to share in a series of arti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to disassemble the network protocol mobile MMORPG</h1><div class="post__text post__text-html js-mediator-article">  Over the years of playing one mobile MMORPG, I have gained some experience in its reverse engineering, which I would like to share in a series of articles.  Sample topics: <br><br><ol><li>  Parsing message format between server and client. </li><li>  Writing a listening application to view game traffic in a convenient way. </li><li>  Interception of traffic and its modification using a non-HTTP proxy server. </li><li>  The first steps to your own ("pirated") server. </li></ol><br>  In this article I will consider the <b>analysis of the message format between the server and the client</b> .  Interested please under the cat. <br><a name="habracut"></a><br><h3>  Required Tools </h3><br>  To be able to repeat the steps described below, you will need: <br><br><ul><li>  PC (I did on Windows 7/10, but MacOS might work if the points below are available there); </li><li>  Wireshark for packet analysis; </li><li>  010Editor for parsing packages by pattern (optional, but allows you to quickly and easily describe the message format); </li><li>  the mobile device itself with the game. </li></ul><br>  Additionally, it is highly desirable to have at hand data from the game in a readable form, such as a list of objects, creatures, etc. with their identifiers.  This greatly simplifies the search for key points in the packets, and sometimes allows you to filter the desired message in a constant data stream. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3><anchor>  Parsing </anchor>  message format between server and client </h3><br>  First, we need to see mobile device traffic.  It‚Äôs quite simple to do (although I‚Äôve got to this obvious solution for a very long time): on our PC we create a Wi-Fi access point, connect to it from a mobile device, select the interface you need in Wireshark - and all mobile traffic is in front of us. <br><br>  Having entered the game and waited some time so that requests not connected with the game server itself stopped, the following picture can be observed: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/in/ye/61/inye619dyp2vh8iq8nvncdb25u0.png"></div><br>  At this stage, we can already use Wireshark filters to see only the packets between the game and the server, and also only with the payload: <br><br><pre><code class="plaintext hljs">tcp &amp;&amp; tcp.payload &amp;&amp; tcp.port == 44325</code> </pre> <br>  If you stand in a quiet place, away from other players and NPCs, and do nothing, you can see constantly repeated messages from the server and client (76 and 84 bytes, respectively).  In my case, the minimum number of different packages was sent on the character selection screen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u-/n9/su/u-n9sutlnqod9lbgttfuon6g1ue.png"></div><br>  The frequency of the request from the client is very similar to pinging.  Take a few messages to check (3 groups, on top - a request from the client, below it - the server response): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v3/z9/3e/v3z93eejzkii_hh6di5dwvbowfi.png"></div><br>  The first thing that strikes you is the identity of the packages.  8 additional bytes of the response when translating into the decimal system are very similar to the timestamp in seconds: <code>5CD008F8 <sub>16</sub> = 1557137656 <sub>10</sub></code> (from the first pair).  <a href="https://www.epochconverter.com/">We check the clock</a> - yes, it is.  The previous 4 bytes are the same as the last 4 bytes in the request.  When translating, we get: <code>A4BB <sub>16</sub> = 42171 <sub>10</sub></code> , which is also very similar to the time, but in milliseconds.  It roughly coincides with the time since the launch of the game, and most likely it is. <br><br>  It remains to consider the first 6 bytes of the request and response.  It is easy to notice the dependence of the value of the first four bytes of the message (let's call this parameter <code>L</code> ) on the size of the message: the response from the server is more by 8 bytes, the value of <code>L</code> also increased by 8, but the packet size is more by 6 bytes of value <code>L</code> in both cases.  You can also notice that two bytes after <code>L</code> retain their value both in requests from the client and from the server, and given that their value differs by one, it is safe to say that this is the message code <code>C</code> (the associated message codes will most likely be determined consistently).  The general structure is understandable enough to write a minimal template for 010Editor: <br><br><ul><li>  first 4 bytes - <code>L</code> - size of the message payload; </li><li>  next 2 bytes - <code>C</code> - message code; </li><li>  the payload itself. </li></ul><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Event</span></span></span><span class="hljs-class"> {</span></span> uint payload_length &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0xFFFF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Payload Length"</span></span>&gt;; ushort event_code &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0xFF9988</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Event Code"</span></span>&gt;; byte payload[payload_length] &lt;name=<span class="hljs-string"><span class="hljs-string">"Event Payload"</span></span>&gt;; };</code> </pre><br>  Hence, the format of the client ping message: send local ping time;  server response format: send the same time and response time in seconds.  It seems not difficult, right? <br><br>  Let's try to disassemble the example more difficult.  Standing in a quiet place and hiding the ping packages, you can find messages of teleport and craft creation.  Let's start with the first.  Owning the data of the game, I knew what value of the teleport point to look for.  For the tests, I used points with the values <code>0x2B</code> , <code>0x67</code> , <code>0x6B</code> and <code>0x1AF</code> .  Compare with the values ‚Äã‚Äãin messages: <code>0x2B</code> , <code>0x67</code> , <code>0x6B</code> and <code>0x3AF</code> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y7/7r/qs/y77rqsd0mxecueorqwdip3ow3r8.png"></div><br>  Disorder.  Two problems are visible: <br><br><ol><li>  values ‚Äã‚Äãare not 4-byte, and different sizes; </li><li>  not all values ‚Äã‚Äãcoincide with data from files, and in this case the difference is 128. </li></ol><br>  Additionally, comparing with the format of the ping, you can notice some difference: <br><br><ul><li>  incomprehensible <code>0x08</code> before the expected value; </li><li>  4-byte value, 4 less <code>L</code> (let's call it <code>D</code> ) This field does not appear in all messages, which is a bit strange, but where it is, the dependence <code>L - 4 = D</code> preserved. On the one hand, for messages with simple structure (like ping) it is not required, but on the other - it looks useless). </li></ul><br>  Some of you, I think, could already guess the reason for the discrepancy between the expected values, but I will continue.  Let's see what's going on in crafting: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8f/zk/vs/8fzkvsleifr5b1yodx6a77ggx_g.png"></div><br>  The expected values ‚Äã‚Äãof 14183 and 14285 also do not correspond to the actual 28391 and 28621, but the difference here is already much more than 128. After conducting many tests (including with other types of messages), it became clear that the larger the expected number, the greater the difference between the value in the packet.  What was strange was that the values ‚Äã‚Äãup to 128 remained all by themselves.  Understood what is the matter?  The obvious situation is for those who have already encountered this, and unknowingly, I had to disassemble this ‚Äúcipher‚Äù for two days (ultimately, analysis of the values ‚Äã‚Äãin binary form helped in the ‚Äúhacking‚Äù).  The behavior described above is called <i><a href="https://en.wikipedia.org/wiki/Variable-length_quantity">Variable Length Quantity</a> (variable length value)</i> - a representation of a number that uses an indefinite number of bytes, where the eighth bit of a byte (the continuation bit) determines the presence of the next byte.  From the description it is obvious that reading the VLQ is possible only in the order of Little-Endian.  Coincidentally, all the values ‚Äã‚Äãin the packets are in this order. <br><br>  Now that we know how to get the original value, we can write a template for the type: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VLQ</span></span></span><span class="hljs-class"> {</span></span> local <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> size = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { byte obf_byte; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((obf_byte &amp; <span class="hljs-number"><span class="hljs-number">0x80</span></span>) == <span class="hljs-number"><span class="hljs-number">0x80</span></span>) { size++; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } FSeek(FTell() - size); byte bytes[size]; local uint64 _ = FromVLQ(bytes, size); };</code> </pre><br>  And the function of converting an array of bytes to an integer value: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">uint64 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FromVLQ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte bytes[], </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size)</span></span></span><span class="hljs-function"> </span></span>{ local uint64 source = <span class="hljs-number"><span class="hljs-number">0</span></span>; local <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; local byte x; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { x = bytes[i]; source |= (x &amp; <span class="hljs-number"><span class="hljs-number">0x7F</span></span>) * Pow(<span class="hljs-number"><span class="hljs-number">2</span></span>, i * <span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   &lt;&lt;   , ..     ,  uint32,        uint64 if ((x &amp; 0x80) != 0x80) { break; } } return source; };</span></span></code> </pre><br>  But back to the creation of the subject.  <code>D</code> appears again and <code>0x08</code> again <code>0x08</code> front of the changing value.  The last two bytes of the message <code>0x10 0x01</code> suspiciously similar to the number of craft items, where <code>0x10</code> has a role similar to <code>0x08</code> , but still incomprehensible.  But now you can write a template for this event: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CraftEvent</span></span></span><span class="hljs-class"> {</span></span> uint data_length &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Data Length"</span></span>&gt;; byte marker1; VLQ craft_id &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Craft ID"</span></span>&gt;; byte marker2; VLQ quantity &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Craft Quantity"</span></span>&gt;; };</code> </pre><br>  Which will look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/sl/y1/exsly1e_f3_3dtj4mhyzryehzou.png"></div><br>  Still, these were simple examples.  It will be more difficult to disassemble the event of movement of the character.  What information do we expect to see?  At a minimum, the coordinates of the character where he looks, the speed of movement and the state (standing, running, jumping, etc.).  Since the lines in the message are not visible, the state is most likely described by <code>enum</code> .  By iterating through the options, comparing them with the data from the game files, as well as through a lot of tests, one can find three XYZ vectors with the help of such a bulky template: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MoveEvent</span></span></span><span class="hljs-class"> {</span></span> uint data_length &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Data Length"</span></span>&gt;; byte marker; VLQ move_time &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; FSkip(<span class="hljs-number"><span class="hljs-number">2</span></span>); byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> position_x &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> position_y &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> position_z &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; FSkip(<span class="hljs-number"><span class="hljs-number">2</span></span>); byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> direction_x &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> direction_y &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> direction_z &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; FSkip(<span class="hljs-number"><span class="hljs-number">2</span></span>); byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speed_x &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speed_y &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; byte marker; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> speed_z &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; byte marker; VLQ character_state &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; };</code> </pre><br>  Visual result: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aw/wn/rz/awwnrzzruq2wtcnmwbpkho3q1x8.png"></div><br>  The green trio turned out to be location coordinates, the yellow triplets most likely show where the character is looking at and its speed vector, and the last solitary one is the status of the character.  You can see constant bytes (markers) between coordinate values ‚Äã‚Äã( <code>0x0D</code> before <code>X</code> value, <code>0x015</code> before <code>Y</code> and <code>0x1D</code> before <code>Z</code> ) and before the state ( <code>0x30</code> ), which are suspiciously similar in meaning to <code>0x08</code> and <code>0x10</code> .  After analyzing many markers from other events, it turned out that it determines the type of the value following it (the first three bits) and the semantic meaning, i.e.  In the example above, if you swap the vectors, while retaining their markers ( <code>0x120F</code> before the coordinates, etc.), the game (theoretically) should parse the message normally.  Given this information, you can add a couple of new types: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Packed</span></span></span><span class="hljs-class"> {</span></span> VLQ marker &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0xFFBB00</span></span>&gt;; <span class="hljs-comment"><span class="hljs-comment">//    VLQ! local uint size = marker.size; //       ( , )          switch (marker._ &amp; 0x7) { case 1: double v; size += 8; break; //     case 5: float v; size += 4; break; default: VLQ v; size += v.size; break; } }; struct PackedVector3 { Packed marker &lt;name="Marker"&gt;; Packed x &lt;name="X"&gt;; Packed y &lt;name="Y"&gt;; Packed z &lt;name="Z"&gt;; };</span></span></code> </pre><br>  Now our traffic message pattern has dropped significantly: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MoveEvent</span></span></span><span class="hljs-class"> {</span></span> uint data_length &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>, name=<span class="hljs-string"><span class="hljs-string">"Data Length"</span></span>&gt;; Packed move_time &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FFFF</span></span>&gt;; PackedVector3 position &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; PackedVector3 direction &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; PackedVector3 speed &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; Packed state &lt;bgcolor=<span class="hljs-number"><span class="hljs-number">0x00FF00</span></span>&gt;; };</code> </pre><br>  Another type that we may need in the next article is the lines that are preceded by a <code>Packed</code> value of their size: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PackedString</span></span></span><span class="hljs-class"> {</span></span> Packed length; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> str[length.v._]; };</code> </pre><br>  Now, knowing the approximate message format, you can write your own listening application for ease of filtering and analyzing messages, but this is a topic for the next article. <br><br>  <b>Upd:</b> thanks to <a href="https://habr.com/ru/users/aml/" class="user_link">aml</a> for the hint that the message structure described above is <a href="https://developers.google.com/protocol-buffers/docs/encoding">Protocol Buffer</a> , and also <a href="https://habr.com/ru/users/tatikoma/" class="user_link">Tatikoma</a> for the link to the useful relevant <a href="https://habr.com/ru/post/321790/">article</a> . </div><p>Source: <a href="https://habr.com/ru/post/451512/">https://habr.com/ru/post/451512/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451502/index.html">Digital events in Moscow from May 13 to 19</a></li>
<li><a href="../451504/index.html">Pictures on the web 2019</a></li>
<li><a href="../451506/index.html">How DNSCrypt solved the problem of expired certificates by entering a validity period of 24 hours</a></li>
<li><a href="../451508/index.html">A Guide for Dummies: Creating DevOps Chains with Open Source Tools</a></li>
<li><a href="../451510/index.html">Some technical lyrics about C ++ Tools from JetBrains, and what's the point about unicorns</a></li>
<li><a href="../451516/index.html">Design Patterns Used in the Spring Framework</a></li>
<li><a href="../451518/index.html">Our reduced mobile websites</a></li>
<li><a href="../45152/index.html">Survival Campaign Report (Episode III)</a></li>
<li><a href="../451522/index.html">We develop automation in a couple of hours: TypeScript, Protractor, Jasmine</a></li>
<li><a href="../451524/index.html">Tale of how the maker Autoplay Media Studio 8.5.3.0 broke</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>