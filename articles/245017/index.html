<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Increased confidence in the IC while maintaining the privacy of personal data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This post is the answer to habrahabr.ru/post/244753 

 To increase confidence and transparency in the IC, you can apply a fairly simple solution descr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Increased confidence in the IC while maintaining the privacy of personal data</h1><div class="post__text post__text-html js-mediator-article">  This post is the answer to <a href="http://habrahabr.ru/post/244753/">habrahabr.ru/post/244753</a> <br><br>  To increase confidence and transparency in the IC, you can apply a fairly simple solution described in this post.  When a user votes for, against, or withdraws his vote for any initiative, it is necessary for the ROI to generate a special verification code, but not containing the user's personal information.  A list of such codes should be available for general use.  Thus, everyone could check the result of taking into account his vote in public access.  This technical solution is simple, it gives an opportunity to control the counting of votes to some extent and, thus, increases the confidence of citizens in the IC. <br><br>  <b>Proposed protocol of action.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For starters, ROI generates a 2048-bit RSA key-pair (SK, PK) for use as an electronic digital signature (EDS), where is the SK-secret key and PK is the public key.  The public key is published in the public domain, and the secret key is stored and used only on the POI server.  There may be one such key for the entire IC or many different for different initiatives.  For example, you can generate your own separate key for each initiative.  Or update the key for the entire ROI from time to time.  To identify the key, we will use the concept of ‚Äúkey version‚Äù (or index, key number).  Additionally, but not necessarily for the first version of the system, the POI can publish the key certificate. <br><br>  Structure and generation of codes that should be publicly available. <br><br>  <b>1.</b> When voting by the user, ROI forms the following vector V, 49 bytes long: <br>  Key version (number): 4 bytes <br>  Initiative number: 4 bytes <br>  Event time (UTC time): 8 bytes <br>  Event Type: 1 byte (FOR, AGAINST, FEEDBACK) <br>  Hash voted user, calculated as <br>  H = SHA256 (UserSecret; SNILS; Initiative Number): 32 bytes. <br><br>  UserSecret is a secret whose source is the user himself.  For example, it may be a password for a voice that a user enters on the ROI website when voting.  If the POI technically allows, then it can be a password when entering the POI or its hash, in which case the ROI can automatically insert it into the field.  In any case, it should be what comes from the user, and what is known to him alone and to no one else.  About the reasons for innovation - read the spoiler comments. <br><div class="spoiler">  <b class="spoiler_title">UPD: Changes to the first edition, motivation</b> <div class="spoiler_text">  It was: <s>H = SHA256 (SK; SNILS; Initiative Number): 32 bytes.</s> <br>  As a result of discussions, it became clear that there is a hole in the system.  Imagine the following scenario: ROI caches the results and returns them, say, every 5 minutes.  Suppose some user has voted, and the correct code (Vx, Sx) is generated and sent to him.  Suppose someone else also votes in these 5 minutes, and the ROI can send him not a new code, but the code of the previous user (Vx, Sx).  Later, when checking their codes, both users will see that their code is in the statement, but the counter on the ROI will increase only by 1, and it is impossible to verify this.  That is, we will get a scenario in which a voice may disappear on the IC.  The weak link here is the vector Hx.  Therefore, it is necessary that the user himself could verify the correctness of the initial data of this vector, but no one else could.  This complicates the system a bit. <br><br>  Here it should be noted that if a user performs several actions, for example, FOR-RELEASE-VS, then UserSecret should remain unchanged for all these actions, so that in the Hx logs the same for these operations is for one user and the selected initiative.  In the case when it is impossible to recall a voice (as it is now on the IC), then this question becomes irrelevant and there is no problem. <br><br>  Corollary: Now the user needs not only to verify that his code (Vx, Sx) is in the list of paged logs, but also to verify that the unique Hx vector from Vx was formed correctly. <br></div></div> <br><br>  <b>2.</b> Further, ROI uses the corresponding secret RSA key SK in order to obtain the second part of the code - a digital signature (EDS): <br>  S = RSA_Sign (SK; V) - the result will be 256 bytes. <br><br>  <b>3.</b> A pair (V; S) is sent by e-mail to a voted user, and is also placed in public access (for example, in text PEM format). <br><a name="habracut"></a><br>  <b>Pros:</b> <br><br>  ‚Ä¢ Any person using the open list of {V; S} pairs can calculate the total number of votes for the selected initiative, having previously verified each Vx value using the ROI public key as follows: RSA_Verify (PK; Sx; Vx) returns ‚Äúsuccess‚Äù or ‚Äúnot success".  In essence, the function decrypts the Sx signature using the PK public key and checks the result against Vx, if "success" is equal. <br><br>  ‚Ä¢ Anyone on the {V; S} list can find their voting code, since it must be emailed to the user immediately after the vote.  If the code is not found in the general list, the user can present his pair (Vx, Sx) as evidence of unrecorded voice.  In addition, the user must verify that his own Hx vector from Vx was formed correctly, excluding the possibility of a scenario where the ROI sends the same pair (Vx, Sx) to two users, and takes only one vote into account. <br><br>  ‚Ä¢ Third parties will not be able to talk about the unrecorded voice of the Vx without providing the corresponding Sx signature pair, since for this you need to know the secret key of the IC.  Thus, the IC is protected from unfounded claims of this kind. <br><br>  ‚Ä¢ The H field is added to the V line in order to uniquely identify the actions of the same user within the framework of the selected initiative.  For example, the FOR-CANCEL-AGN sequence must be tied to a specific user so that this sequence can be tracked in the {V; S} event list.  At the same time, the SNILS of the user itself is inaccessible, since the secret key of the ROI is included in the hash that is generated on the ROI server.  According to the hash, it is impossible to know either the secret key or the person's SNILS.  And even if the SNILS is known, it is impossible to know the secret key of the ROI by hash.  Also, it is impossible to check how this or that person voted, knowing his SNILS, since the connection between SNILS and H is not public information, it is known only to the person who voted, as well as the result of the vote ‚Äî this information is now sent to the user via email.  Thus, this design does not change the current level of security of personal information (as a person voted), and there is no leakage of information on the SNILS or the ROI secret key. <br><br>  ‚Ä¢ When presenting a lost voice (Vx, Sx) to a specific user in public access, a connecting pair is created between the voice and a specific person, and then it becomes clear to all how that particular person voted.  But now the situation is similar - if I voted and my vote was not taken into account, then, declaring this, I give out publicly information about how I voted.  However, the plus is that the lost voice (Vx, Sx) and, thus, the claim to the IC, can be transferred to the public space anonymously, without giving out a connection with a specific user. <br><br>  <b>Minuses:</b> <br><br>  ‚Ä¢ It is impossible to track the scenario in which the ROI can add votes for or against non-existing SNILS.  But this scenario is possible now. <br><br>  <b>Technical implementation:</b> <br><br>  To implement the idea, the IC can set up OpenSSL (an open and free cryptographic library widely used in many systems as well as establishing encrypted channels in IP connections, browsers and many other applications), and using it from its scripts for all the above operations: generation RSA key (for EDS), signing and SHA256 hashing.  Key generation is a slow operation, but rare (once or when opening a new initiative).  Signing with a secret key and hashing is a quick operation.  OpenSSL can be used either from a command line or a script, or from various compiled programming languages, such as C / C ++.  The implementation does not require any infrastructural or other complex steps, and may well fit into several lines of the script or code. <br><br>  <b>UPD: Updates and additions at the request of readers.</b> <br>  <i>I have a feeling that if all the opinions are folded, then it will be zero.</i>  <i>But I'll try:</i> <br><br>  1. Clarified in the text that the RSA key is generated on the side of the IC for use as a digital signature.  Also RSA_Encrypt / RSA_Decrypt were replaced with RSA_Sign / RSA_Verify, respectively. <br><br>  2. A question was asked why not ECDSA 256 bits (elliptic curve digital signing algorithm).  Yes, there are advantages in the size of the digital signature S. There will be not 256 bytes, as in the case of RSA, but 72. But there are also disadvantages in speed.  The RSA_Verify operation works many times faster than ECDSA_Sign and Verify.  And if we just change RSA_Sign / Verify to RSA_Encrypt / Decrypt and publish SK instead of PK, then we will get a server that can quickly sign, many times faster than ECDSA. <br><br>  3. Why not GOST?  I generally heard about our Soviet standards with an ear of the ear, I just know that some of them were copied from foreign ideas and there was something added a little to make it look different.  An example is the GOST cipher created in the KGB (well, I know it by that name in the scientific community), which copies 3DES with slight variations.  The same questions according to GOST hash algorithm - I have no idea. <br><br>  4. Let us, in order to prevent such questions of the Chinese (they have something there too), as in PP.2-3, we can immediately replace it: let the asymmetric algorithm be X, and the hashing algorithm Y, and choose which one you want.  Just keep the security level at least 128 bits for the algorithms used (and preferably 256), but otherwise this is a matter of choice and does not greatly affect the essence. <br><br>  Thank! </div><p>Source: <a href="https://habr.com/ru/post/245017/">https://habr.com/ru/post/245017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245003/index.html">Educational series about marketing and sales issues in a studio / agency</a></li>
<li><a href="../245007/index.html">Go beyond the edge of the browser</a></li>
<li><a href="../245011/index.html">No cON Name CTF 2014 Final</a></li>
<li><a href="../245013/index.html">Split nodejs</a></li>
<li><a href="../245015/index.html">Postgis data type Geometry on the example of imported OpenStreetMap maps</a></li>
<li><a href="../245019/index.html">Why did you need a static analyzer message suppression system</a></li>
<li><a href="../245021/index.html">What prevents outsourcers from working better than the regular admin</a></li>
<li><a href="../245025/index.html">Conversion: several useful graphs and tables</a></li>
<li><a href="../245027/index.html">Localization of applications for the Chinese market-2. Block lists</a></li>
<li><a href="../245029/index.html">Merchium is looking for partners</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>