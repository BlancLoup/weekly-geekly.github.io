<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As our customer did not want to let go of the provider</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The story is rather short, but funny. Our customer actually encountered it. It all started at the moment when one of the IT infrastructure providers d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As our customer did not want to let go of the provider</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/bn/pi/dm/bnpidmhskhwx4ny1zrc4y-jozuc.jpeg"><br><br>  The story is rather short, but funny.  Our customer actually encountered it.  It all started at the moment when one of the IT infrastructure providers decided to transport their data center.  And he warned all his clients about the three-day downtime in about half a year, but he so timed and organized bureaucratic red tape that some customers simply did not have time to prepare for migration. <br><br>  Imagine: you are CIO.  You do not have a budget for an emergency backup site.  Old equipment either.  The business is connected with the provision of medical services, here every extra hour of delay is expensive: one day of inactivity threatens with financial and image losses equal to the annual profit, two hours the customers will suffer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now the finishing chord: moving is in fact difficult for you, putting in frames and coordinating every month.  Because you pay the provider a lot, why should you let go? <br><a name="habracut"></a><br><h3>  Provider logic </h3><br>  Everything is quite simple: the customer has lived with them for many years with the whole infrastructure and if it survives downtime, then it will live for many years.  And all the time will pay.  Therefore, it is necessary to preserve it as much as possible.  Therefore, it is necessary to insert stick into the wheels to the end of the move.  Where is he going?  Well, yes, slightly compensate for the inconvenience within the framework of the SLA or make a symbolic discount. <br><br><h3>  Customer logic </h3><br>  The customer, to put it mildly, did not understand the humor.  More precisely, he immediately understood everything and turned to us in order to transfer the entire infrastructure as soon as possible.  And then do two sites already after this crisis is over. <br><br>  Our task is to pull out all the data and deploy all the same in our <a href="https://cloud.croc.ru/services/laas/kvm/%3Futm_source%3Dhabr%26utm_medium%3Dblog%26utm_campaign%3D24_05_18">cloud</a> , which lies in two fault-tolerant distributed data centers certified by Uptime.  Routine procedure, three days for everything, if there are no rare operating systems, for example, or hardware keys.  There are no rare operating systems, hardware keys, old storage systems and heavy thresher servers.  Just 5 TB of data. <br><br>  This is where the problems started. <br><br><h3>  Problems </h3><br>  In the SLA provider, the response time was indicated - 3 days.  In the last hour of the SLA term, all our requests were answered in the spirit of unforgettable Bangladeshi support with the clarification of some trifles.  Then again 2 days and 23 hours. <br><br>  Internet speed was up to 50 Mbit / s (this is taking into account that the customer utilizes this channel at least half live in production and there is a more or less normal part of the band only late at night).  The provider refused to extend the bandwidth even for extra money. <br><br>  It remains two weeks. <br><br>  ‚ÄúCheckmate‚Äù, the administrator probably thought. <br>  ‚ÄúBut to hell with you,‚Äù we decided. <br><br><h3>  Doubleback </h3><br>  There is such a thing - Carbonite (formerly DoubleTech), designed for asynchronous replications.  He has an extension Carbonite Move, designed to move.  That is, the license is only for one time - until everything is settled. <br><br>  Put this thing at the OS level, and then begins to monitor the recording activity.  The task of the agent from the replicated machine is to send data to the channel and keep track of what is being written new after the synchronization begins.  When the first hefty piece of data is transferred to the target infrastructure, at the OS level, the rest of the software will be muted and Move will highlight and send the difference between what was at the beginning of the copy and what was written while the copy was going. <br><br>  The downtime for getting the difference in a week is quite small, about an hour, plus another hour for work on initiating a new infrastructure.  Total registered four, but met much faster.  Four hours a night they could afford.  Eight is no longer. <br><br>  Why a week?  Because so much we dragged data from agents - given that the channel was impoverished. <br><br>  Next - full-time deployment and recovery, quick tests, production day, and then the customer completely stops the virtual machines at our opponent‚Äôs site. <br><br>  For the provider, it was a surprise, because when we stopped writing to them, they apparently decided that everything was a victory in their pocket. <br><br><h3>  What is this software? </h3><br>  Here is the <a href="https://www.carbonite.com/products/doubletake-migration-software/">software page</a> . <br>  On the main page it is written about okolonulevoy downtime, and this is true when there were few changes during the copying.  That is, when it is possible to transfer systems one by one or the channel is wide.  We had it wrong. <br><br>  Using this thing, you can test new sites before launching them in production (the license allows), or using another package solution, simply set up replication in Active-Passive mode. <br><br>  Simple console control: <br><br><img src="https://habrastorage.org/webt/a5/eu/aj/a5euaj2yyswsykyugz16gww0xtg.png"><br><br>  Everything is copied, connectors are not needed - simply DoubleTech makes everything almost sectoral from the machines (more precisely, by the units of storage logic, they fix exactly the facts of a successful recording and their coordinates).  The channel is protected in the process, and what exactly is pouring is not visible to anyone. <br><br><h3>  What did not work </h3><br>  Not everything can be taken according to the scenario above.  There was one loaded virtual machine (by processor under 100 percent), there was a hot database spinning.  And when we put the agent, he began to otzhirat power and the impact began on the base.  At night, the load on the base was less, but the base was very large, and the window was small.  We realized that we would have to endure for a very long time, and as a result, by copying at night, we simply did not have time to migrate. <br><br>  We made a backup of the virtual machine, brought it physically to our site on the disk and poured it into the cloud.  We turned around from backup, rolled up the update difference using standard MS SQL tools.  Everything.  It sounds simple, but it was necessary to do it quickly and the first time. <br><br>  So good for you moving. <br><br><h3>  Links </h3><br><ul><li>  <a href="https://habr.com/company/croc/blog/261441/">Physical moves and their damn features.</a> </li><li>  <a href="https://habr.com/company/croc/blog/272015/">Disaster Recovery and risks.</a> </li><li>  My mail is RSayfutdinov@croc.ru. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/359190/">https://habr.com/ru/post/359190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../359180/index.html">Hysteria around GDPR, part 2. Useful tips</a></li>
<li><a href="../359182/index.html">The book "Programming for children. Learning to create games on Scratch ¬ª</a></li>
<li><a href="../359184/index.html">AI, practical course. Comparison of deep learning software</a></li>
<li><a href="../359186/index.html">MTS will spend on the implementation of the law of Spring 60 billion rubles</a></li>
<li><a href="../359188/index.html">Intelligent Decision Support Systems - Brief Overview</a></li>
<li><a href="../359192/index.html">Classic JavaScript algorithms and data structures</a></li>
<li><a href="../359194/index.html">Java and Project Reactor. Episode 2</a></li>
<li><a href="../359196/index.html">Google Tag Manager usage examples for customTask</a></li>
<li><a href="../359198/index.html">Create a calculator with units</a></li>
<li><a href="../359200/index.html">Google accused of spying on users Safari on iPhone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>