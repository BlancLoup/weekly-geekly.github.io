<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In continuation of the topic (We are testing p2p video for overload)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 
 Thank you all for your interest and participation in trial testing . 

 First, the results with their pluses minuses and surprises. 
 Perhaps...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In continuation of the topic (We are testing p2p video for overload)</h1><div class="post__text post__text-html js-mediator-article">  Hello. <br>  Thank you all for your interest and participation in <a href="http://habrahabr.ru/post/272947/">trial testing</a> . <br><br>  First, the results with their pluses minuses and surprises. <br>  Perhaps the most important thing to note is that at the moment this technology of broadcasting is not yet able to completely replace the CDN.  It can reduce server load by about 75%.  And based on a more detailed acquaintance with the technology, it turns out that the authors do not set themselves the task of reducing the CDN to the maximum, but save traffic and ensure that users do not freeze the video, even when the server‚Äôs Internet channel is fully loaded (within reasonable limits). <br><a name="habracut"></a><br>  Pros: <br>  1. Save traffic up to 75%. <br><div class="spoiler">  <b class="spoiler_title">Analyzing CDN / P2P traffic on my PC</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/60d/216/9b3/60d2169b3cf54861b89d3b839455809e.JPG"><br></div></div><br>  2. Does not require additional settings from the user. <br>  3. Simple enough to set up. <br>  4. Supports most common streaming formats. <br><div class="spoiler">  <b class="spoiler_title">Formats</b> <div class="spoiler_text">  HLS (.m3u8), MPEG-DASH (.mpd) and Smooth Streaming (.ism) manifests with H264 / aac encoding. <br></div></div><br>  Minuses: <br>  1. Not supported by all browsers. <br>  2. There is no data on compatibility with all OS. <br>  3. I can not say anything about how the system will interact with computers behind NAT.  (refer to the <a href="http://habrahabr.ru/post/272947/">comment by user grey_rat</a> ) <br><br>  My subjective opinion: <br>  The system showed itself quite well in operation, especially with the HLS stream (.m3u8) <br>  Despite the fact that the download of the Internet channel was not even close, a maximum of about 10 users at a time.  It is possible to draw some conclusions, with 10 users uploading video on demand, the maximum load on the network was about 8-10 mega bits, while not constant but the peak at regular intervals of time, up to about 3s. <br>  From what I can conclude that with my 100 mega bit network, a little more than 100 users could watch streaming video from my PC without any problems. (Correct if I'm wrong) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The load on my computer with 10 users was almost not noticeable, the use of RAM increased slightly, up to 200-300 megabytes. <br><br><h4>  Description of the settings of this system: </h4><br>  <i>(I have to say that for this test I used trial periods of commercial programs, they are enough for simple acquaintance with technology, if it suits you, you can buy them or use free alternatives, which I will also try to indicate.)</i> <br><br>  So, I used the Wowza Streaming Engine for broadcasting video on demand (as a free alternative, you can use Nginx for streaming).  Wowza Streaming Engine can be downloaded for free on the website with a trial period of 180 days.  After installation, there is a built-in test video on the first page, the link from which I used for broadcasting.  It can be found on the Mobile tab, in the IOS column.  (There are quite a few instructions for installing and configuring Wowza, so I will not stop here) <br><div class="spoiler">  <b class="spoiler_title">Picture</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/957/987/417/957987417167416a8abc9ada59fe15a2.JPG"><br></div></div><br>  Next, I signed up for 30 days in streamroot (the alternative to Viblast is also paid, but they write that it is more finished, I have not tried it yet) <br><div class="spoiler">  <b class="spoiler_title">Why am I more prone to streamroot</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/518/8ed/dbf/5188eddbf10541dfbc4abb98a7bc8191.JPG"><br></div></div><br>  In streamroot, create a new stream in the Getting started tab.  This is where the pitfalls begin.  To streamroot saw the stream from Wowza need to do the following: <br><div class="spoiler">  <b class="spoiler_title">Instruction</b> <div class="spoiler_text"><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/RNtLEk1Hi38%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjwJMKJVve8q7VKA-n-RCw7jBE0Lw" frameborder="0" allowfullscreen=""></iframe><br><br>  Select your Application. <br>  Go to your application properties. <br>  Add a custom property. <br>  Fill in the fields with the following values. <br><br>  <b>Path:</b> / Root / Application / HTTPStreamer <br>  <b>Name:</b> <br>  Depending on your stream format: <br>  mpegdashUserHTTPHeaders for MPEG-DASH <br>  cupertinoUserHTTPHeaders for HLS <br>  smoothUserHTTPHeaders for Smooth Streaming <br>  <b>Type:</b> String <br>  <b>Value:</b> Access-Control-Allow-Origin: * | Access-Control-Allow-Methods: GET, POST, OPTIONS | Access-Control-Allow-Headers: Range <br>  <b>The Properties tab appears in Wowza only after enabling the <i>Allow access to advanced properties and features</i> checkbox in the section Server / users / User name / edit</b> <br></div></div><br>  Further, if streamroot saw our stream, we will see the following window: <br><div class="spoiler">  <b class="spoiler_title">Window</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/1ae/2c7/395/1ae2c7395631426bbeae70494701a6e4.JPG"><br></div></div><br>  Where on the right is our HTML code. <br>  The first window to insert into your page without any changes. <br>  To use the second window, we must first have access to the player. <br>  As a player for viewing, I chose JW7, you can register for a paid or free plan. <br>  On the PLAYERS tab, go to License Keys &amp; Downloads and find out the key in the table opposite JW Player 7 (Self-Hosted) <br>  Next, go back to streamroot and in the lower window we correct the following: <br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"streamroot"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> jwplayer.key = </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"YOUR-JWPLAYER7-LICENSE"</span></span></span><span class="actionscript"> jwplayer(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'streamroot'</span></span></span><span class="actionscript">).setup({ playlist: { sources: [{ file: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"http://media.streamroot.io/dash/examples/snow15/snowboard1_720p_dash.mpd"</span></span></span><span class="actionscript"> }], }, autostart: </span><span class="hljs-number"><span class="actionscript"><span class="hljs-number">1</span></span></span><span class="actionscript">, p2pConfig: {streamrootKey: </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"  -"</span></span></span><span class="actionscript">}, }, hlsjs_options: {}, </span><span class="hljs-comment"><span class="actionscript"><span class="hljs-comment">// possible hls.js options srdash_options: {} // possible streamroot-dash options }); </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Instead of ‚ÄúYOUR-JWPLAYER7-LICENSE‚Äù we insert the code that we learned in the JW player. <br><br>  if you also need to insert a graph reflecting CDN / P2P add to the line: <br>  p2pConfig: {streamrootKey: ‚Äúyour key is xx-xxxxxxxx‚Äù, <b>debug: true</b> }, <br><br>  and more lines at the end <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://cdnjs.cloudflare.com/ajax/libs/rickshaw/1.4.6/rickshaw.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://cdnjs.cloudflare.com/ajax/libs/rickshaw/1.4.6/rickshaw.min.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.9/d3.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://files.streamroot.io/release/latest/scripts/p2pGraph.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Now we insert all this into the body of your site and check for performance. <br><br>  Last we do not forget to open the port in the firewall on which the video stream goes. <br><br>  PS I spent all this as an experiment, so I‚Äôm looking for ways to create free and not expensive video channels on the Internet (so far without success), if you know more interesting ways to create such a channel, please share it in the comments. </div><p>Source: <a href="https://habr.com/ru/post/273271/">https://habr.com/ru/post/273271/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273259/index.html">PHP vs Node.js</a></li>
<li><a href="../273261/index.html">Universal data container</a></li>
<li><a href="../273263/index.html">Development of database service based on graphs: from prototype to reliable and scalable solution in the cloud</a></li>
<li><a href="../273267/index.html">JavaScript Shortcuts</a></li>
<li><a href="../273269/index.html">Development environment andriod applications App Inventor 2 and its application in the community Arduino</a></li>
<li><a href="../273273/index.html">Data Storage: Something about 3D Disks</a></li>
<li><a href="../273275/index.html">C-like structures in javascript</a></li>
<li><a href="../273279/index.html">Apache Spark in combat projects - survival experience</a></li>
<li><a href="../273281/index.html">Creating a business process in BPEL using the Serena Business Manager platform</a></li>
<li><a href="../273283/index.html">Open source application architecture: How nginx works</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>