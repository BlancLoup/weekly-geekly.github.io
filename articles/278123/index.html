<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Symfony how to use FOSRestBundle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post, I would like to talk about how to properly build the RESTfull API for AngularJS and other frontend frameworks with backend on symfony. 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Symfony how to use FOSRestBundle</h1><div class="post__text post__text-html js-mediator-article"> In this post, I would like to talk about how to properly build the RESTfull API for AngularJS and other frontend frameworks with backend on symfony. <br>  And, as you probably already guessed, I will use the FOSRestBundle - a wonderful bundle, which will help us to implement the backend. <br>  There will not be examples of how to work with Angulyar, I will only describe working with Symfony FosRestBundle. <br><br>  To work, we also need <a href="http://jmsyst.com/bundles/JMSSerializerBundle">JMSSerializerBundle</a> to serialize data from Entity to JSON or other formats, exclude certain fields for a particular entity (for example, the password for the API method for getting a list of users) and much more.  You can read more in the documentation. <br><a name="habracut"></a><br><br>  <b>Installation and configuration</b> <br>  <i>1) Download the necessary dependencies in our composer.json</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>"friendsofsymfony/rest-bundle": "^1.7", <br> "jms/serializer-bundle": "^1.1" <br></code> <br><br>  <i>2) Configuration</i> <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// app/AppKernel.php class AppKernel extends Kernel { public function registerBundles() { $bundles = array( // ... new JMS\SerializerBundle\JMSSerializerBundle(), new FOS\RestBundle\FOSRestBundle(), ); // ... } }</span></span></code> </pre><br><br>  Now edit our config.yml <br>  To begin, we will customize our FOSRestBundle <br><pre> <code class="hljs pgsql">fos_rest: body_listener: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>: view_response_listener: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> serializer: serialize_null: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> body_converter: enabled: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> format_listener: rules: - { <span class="hljs-type"><span class="hljs-type">path</span></span>: <span class="hljs-string"><span class="hljs-string">'^/api'</span></span>, priorities: [<span class="hljs-string"><span class="hljs-string">'json'</span></span>], fallback_format: <span class="hljs-type"><span class="hljs-type">json</span></span>, exception_fallback_format: html, prefer_extension: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> } - { <span class="hljs-type"><span class="hljs-type">path</span></span>: <span class="hljs-string"><span class="hljs-string">'^/'</span></span>, priorities: [ <span class="hljs-string"><span class="hljs-string">'html'</span></span>, <span class="hljs-string"><span class="hljs-string">'*/*'</span></span>], fallback_format: html, prefer_extension: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }</code> </pre><br>  <b>body_listener</b> includes an EventListener in order to keep track of which response format a user needs, based on his Accept- * headers <br>  <b>view_response_listener</b> - this setting allows you to simply return the View for a particular request <br>  <b>serializer.serialize_null</b> - this setting says that we also want NULL to be serialized, like everything, if it is not set or set to false, then all fields that are null will simply not be displayed in the server response. <br>  PS: thank you for reminding <a href="https://habrahabr.ru/users/lowadka/" class="user_link">lowadka</a> <br>  <b>body_converter.rules</b> - contains an array for settings oriented to a particular address, in this example we will return JSON for all requests that have the prefix <i>/ api</i> , in all other cases - html. <br><br>  Now we will start setting up our JMSSerializeBundle <br><pre> <code class="hljs lua">jms_serializer: property_naming: separator: _ lower_case: <span class="hljs-literal"><span class="hljs-literal">true</span></span> metadata: cache: file <span class="hljs-built_in"><span class="hljs-built_in">debug</span></span>: <span class="hljs-string"><span class="hljs-string">"%kernel.debug%"</span></span> file_cache: dir: <span class="hljs-string"><span class="hljs-string">"%kernel.cache_dir%/serializer"</span></span> directories: FOSUserBundle: namespace_prefix: FOS\UserBundle <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: %kernel.root_dir%/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>/serializer/FosUserBundle AppBundle: namespace_prefix: AppBundle <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: %kernel.root_dir%/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>/serializer/AppBundle auto_detection: <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre><br><br>  Here, it makes sense to dwell on the moment with <b>jms_serializer.metadata.directories</b> , where we tell the serializer that the configuration for a particular class (entity) is there or there :) <br>  We agree that we need to display the entire list of users, I personally use FosUserBundle in my projects and here is my essence: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AppBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">JMS</span></span>\<span class="hljs-title"><span class="hljs-title">Serializer</span></span>\<span class="hljs-title"><span class="hljs-title">Annotation</span></span>\<span class="hljs-title"><span class="hljs-title">Expose</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">JMS</span></span>\<span class="hljs-title"><span class="hljs-title">Serializer</span></span>\<span class="hljs-title"><span class="hljs-title">Annotation</span></span>\<span class="hljs-title"><span class="hljs-title">Groups</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">JMS</span></span>\<span class="hljs-title"><span class="hljs-title">Serializer</span></span>\<span class="hljs-title"><span class="hljs-title">Annotation</span></span>\<span class="hljs-title"><span class="hljs-title">Exclude</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">JMS</span></span>\<span class="hljs-title"><span class="hljs-title">Serializer</span></span>\<span class="hljs-title"><span class="hljs-title">Annotation</span></span>\<span class="hljs-title"><span class="hljs-title">VirtualProperty</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">JMS</span></span>\<span class="hljs-title"><span class="hljs-title">Serializer</span></span>\<span class="hljs-title"><span class="hljs-title">Annotation</span></span>\<span class="hljs-title"><span class="hljs-title">ExclusionPolicy</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Doctrine</span></span>\<span class="hljs-title"><span class="hljs-title">ORM</span></span>\<span class="hljs-title"><span class="hljs-title">Mapping</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">ORM</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">FOS</span></span>\<span class="hljs-title"><span class="hljs-title">UserBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">User</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">BaseUser</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">FOS</span></span>\<span class="hljs-title"><span class="hljs-title">UserBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>\<span class="hljs-title"><span class="hljs-title">Group</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * User * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ORM</span></span></span><span class="hljs-comment">\Table(name="user") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ORM</span></span></span><span class="hljs-comment">\Entity(repositoryClass="AppBundle\Repository\UserRepository") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ExclusionPolicy</span></span></span><span class="hljs-comment">("all") */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseUser</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ORM</span></span></span><span class="hljs-comment">\Id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ORM</span></span></span><span class="hljs-comment">\Column(type="integer") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ORM</span></span></span><span class="hljs-comment">\GeneratedValue(strategy="AUTO") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Exclude</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $id; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ORM</span></span></span><span class="hljs-comment">\Column(type="integer") * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Groups</span></span></span><span class="hljs-comment">({"user"}) * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Expose</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $balance = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Set balance * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> integer $balance * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> User */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setBalance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($balance)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;balance = $balance; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/** * Get balance * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> integer */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBalance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;balance; } }</code> </pre><br><br>  I cite as an example precisely this entity, which is inherited from the main FosUserBundle model.  This is important because both classes will have to be configured separately for the JmsSerializerBundle. <br>  So back <b>jms_serializer.metadata.directories</b> : <br><pre> <code class="hljs lua">directories: FOSUserBundle: namespace_prefix: FOS\UserBundle <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: %kernel.root_dir%/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>/serializer/FosUserBundle AppBundle: namespace_prefix: AppBundle <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: %kernel.root_dir%/<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>/serializer/AppBundle</code> </pre><br>  Here we just specify that for AppBundle classes we will look for a configuration for serialization in app / config / serializer / AppBundle, and for FosUserBundle - in app / config / serializer / FosUserBundle. <br>  The configuration for the class will be automatically in the format: <br>  For the AppBundle \ Entity \ User class - app / config / serializer / AppBundle / Entity.User. (Yml | xml | php) <br>  For the base model class FosUserBundle - app / config / serializer / FosUserBundle / Model.User. (Yml | xml | php) <br><br>  Personally, I prefer to use YAML.  Let's finally start telling JMSSerializer how we need it to set up a particular class. <br>  <i>app / config / serializer / AppBundle / Entity.User.yml</i> <br><pre> <code class="hljs pgsql">AppBundle\Entity\<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>: exclusion_policy: <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span> properties: balance: expose: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre><br><br>  <i>app / config / serializer / FosUserBundle / Model.User.yml</i> <br><pre> <code class="hljs pgsql">FOS\UserBundle\Model\<span class="hljs-keyword"><span class="hljs-keyword">User</span></span>: exclusion_policy: <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> properties: id: expose: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> username: expose: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> email: expose: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> balance: expose: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre><br><br>  So simply we could tell that we want to see approximately the following response format from the server when receiving data from 1 user: <br><pre> <code class="hljs json">{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-attr"><span class="hljs-attr">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"admin"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"email"</span></span>:<span class="hljs-string"><span class="hljs-string">"admin"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"balance"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>}</code> </pre> <br><br>  In principle, this configuration is not necessary to register and the server will return all the data about the entity.  Only in this case it is illogical for us to show many things, for example, such as a password.  Therefore, I considered it necessary to demonstrate in this example exactly such an implementation. <br><br>  <b>Now let's start creating the controller.</b> <br>  First of all, create a route: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">backend_user</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">resource</span></span>: "@<span class="hljs-keyword"><span class="hljs-keyword">BackendUserBundle</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">Resources</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">config</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">routing</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">yml</span></span>" prefix: /api</code> </pre><br>  <i>Pay attention to / api - do not forget to add it, and if you want to change, you will have to change the configuration for fos_rest in config.yml</i> <br><br>  Now BackendUserBundle / Resources / config / routing.yml itself: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">backend_user_users</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">type</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">rest</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">resource</span></span>: "@<span class="hljs-keyword"><span class="hljs-keyword">BackendUserBundle</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">Controller</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">UsersController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">php</span></span>" prefix: /v1</code> </pre><br><br>  Now you can start creating the controller itself: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Backend</span></span>\<span class="hljs-title"><span class="hljs-title">UserBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">AppBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Entity</span></span>\<span class="hljs-title"><span class="hljs-title">User</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">FOS</span></span>\<span class="hljs-title"><span class="hljs-title">RestBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>\<span class="hljs-title"><span class="hljs-title">FOSRestController</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">FOS</span></span>\<span class="hljs-title"><span class="hljs-title">RestBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>\<span class="hljs-title"><span class="hljs-title">Annotations</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">Rest</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">FOS</span></span>\<span class="hljs-title"><span class="hljs-title">RestBundle</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>\<span class="hljs-title"><span class="hljs-title">Annotations</span></span>\<span class="hljs-title"><span class="hljs-title">View</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpKernel</span></span>\<span class="hljs-title"><span class="hljs-title">Exception</span></span>\<span class="hljs-title"><span class="hljs-title">NotFoundHttpException</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * Class UsersController * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@package</span></span></span><span class="hljs-comment"> Backend\UserBundle\Controller */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FOSRestController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> \Symfony\Component\HttpFoundation\Response * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@View</span></span></span><span class="hljs-comment">(serializerGroups={"user"}) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsersAllAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $users = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getDoctrine()-&gt;getRepository(<span class="hljs-string"><span class="hljs-string">'AppBundle:User'</span></span>)-&gt;findAll(); $view = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;view($users, <span class="hljs-number"><span class="hljs-number">200</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;handleView($view); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> $id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> \Symfony\Component\HttpFoundation\Response * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@View</span></span></span><span class="hljs-comment">(serializerGroups={"user"}) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUserAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id)</span></span></span><span class="hljs-function"> </span></span>{ $user = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getDoctrine()-&gt;getRepository(<span class="hljs-string"><span class="hljs-string">'AppBundle:User'</span></span>)-&gt;find($id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$user <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> User) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotFoundHttpException(<span class="hljs-string"><span class="hljs-string">'User not found'</span></span>); } $view = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;view($user, <span class="hljs-number"><span class="hljs-number">200</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;handleView($view); } }</code> </pre><br><br>  Note that we now inherit from <b>FOS \ RestBundle \ Controller \ FOSRestController</b> . <br>  By the way, you probably noticed the <a href="https://habrahabr.ru/users/view/" class="user_link">View</a> annotation (serializerGroups = {"user"}). <br>  The fact is that  we want to see both the App \ Entity \ User data and the main FosUserBundle model, in which all the other fields are stored, we need to create a specific group, in this case ‚Äúuser‚Äù. <br><br>  So, we have 2 actions getUserAction and getUsersAllAction.  Now you will understand the specifics of the names of the controller methods. <br>  Make a debug of all routes: <br>  $ app / console debug: route |  grep api <br>  We get: <br><pre> <code class="hljs pgsql">get_users_all <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> /api/v1/users/<span class="hljs-keyword"><span class="hljs-keyword">all</span></span>.{_format} get_user <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ANY</span></span> /api/v1/users/{id}.{_format}</code> </pre><br><br>  Consider the following example with new methods: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersComment</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">postUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id)</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-comment"><span class="hljs-comment">// "post_user_comment_vote" [POST] /users/{id} public function getUser($id) {} // "get_user" [GET] /users/{id} public function deleteUserAction($id) {} // "delete_user" [DELETE] /users/{id} public function newUserAction($id) {} // "new_user" [GET] /users/{id}/new public function editUserAction($slug, $id) {} // "edit_user" [GET] /users/{id}/edit public function removeUserAction($slug) {} // "remove_user" [GET] /users/{slug}/remove }</span></span></code> </pre><br>  Reminds Laravel Resource Controller, right? <br><br>  The comments show which address and method of the request will be executed by one or another method. <br>  Next time I will tell you how to correctly use FOSRestBundle to, for example, display comments of a specific user at the address: "/ users / {id} / comments", create / update user data. </div><p>Source: <a href="https://habr.com/ru/post/278123/">https://habr.com/ru/post/278123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278101/index.html">Consul.io Part 2</a></li>
<li><a href="../278103/index.html">Integrating Webpack in Visual Studio 2015</a></li>
<li><a href="../278109/index.html">Jade tutorial for beginners</a></li>
<li><a href="../278111/index.html">My "Smart Home" on the PLC and with the web interface. Part 2. Web interface</a></li>
<li><a href="../278115/index.html">BIM technology: an example of practical interdisciplinary interaction</a></li>
<li><a href="../278125/index.html">Automation of business processes in CRM. Comparison of approaches</a></li>
<li><a href="../278127/index.html">Anniversary digest of interesting materials from the world of web development and IT for the last week No. 200 (February 22 - 28, 2016)</a></li>
<li><a href="../278129/index.html">Azure Backup Server - free DPM</a></li>
<li><a href="../278137/index.html">PHP Digest number 80 - interesting news, materials and tools (February 14 - 28, 2016)</a></li>
<li><a href="../278151/index.html">Pathfinding: A simple implementation of a funnel algorithm (Funnel Algorithm)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>