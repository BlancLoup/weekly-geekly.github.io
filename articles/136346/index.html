<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MSSQL system database transfer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="MSSQL and bases 1c 8.2 

 Here I will describe my observations, as well as small utilities collected by Google for the effective operation of these tw...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MSSQL system database transfer</h1><div class="post__text post__text-html js-mediator-article"> MSSQL and bases 1c 8.2 <br><br>  Here I will describe my observations, as well as small utilities collected by Google for the effective operation of these two software products. <br>  Everyone knows that you need to store user databases on a separate disk, for example, here D: \ Base.  And it is also desirable to transfer to a separate disk and transaction files, for example E: \ Logs.  Well, since we are talking about transferring databases and logs to different disks, then to increase performance, you need to spread them across different physical disks.  Expensively, you say, not quite, it‚Äôs a penny within the company, and the headache will be less, even with free space it will be easier. <br>  After all this, it will be advisable to transfer the system databases.  Previously, I did not think about it, but I pressed it.  And it was like that.  Valiant accounting, rolled a new version of the yellow program, and everything was great until it was necessary for them to "close the month."  The procedure is long and therefore left it overnight.  And in the morning we saw a nice MSSQL database error message.  The investigation led me to the fact that there was no free space on the C: \ drive.  Namely, the logs of the system databases have expanded beyond any measure.  It was decided to transfer. <a name="habracut"></a><br>  If the transfer of user bases is not difficult, then the system transferred using Google and admin's ingenuity.  Since no exact article was found on the Internet, I decided to describe it here. <br><br>  And do <b>not forget to</b> remind, <b>do not forget about backup!</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now, I will tell how to transfer the MSSQL system bases. <br>  For example, I will transfer them from the folder <br>  C: \ Program Files \ Microsoft SQL Server \ MSSQL.1 \ MSSQL \ Data \ <br>  at <br>  1. D: \ System (base) <br>  2. E: \ System (logs) <br><br>  Stop the MSSQL service. <br><br>  We start MSSQL in the exclusive mode and we transfer the mssqlsystemresource base <br>  To do this, in cmd, run as administrator, type the command <br><br> <code>net start MSSQLSERVER /c /m /T3608</code> <br> <br>  then we enter <br> <code>sqlcmd -A</code> <br> <br>  Then we successively type three commands to change the path to mssqlsystemresource.mdf. <br><br> <code>1&gt; ALTER DATABASE mssqlsystemresource <br> <br> 2&gt; MODIFY FILE (name = 'data', filename = 'D:\System\mssqlsystemresource.mdf') <br> <br> 3&gt; GO</code> <br> <br>  If we see the answer: <br>  <b>The file "data" has been modified in the system catalog.</b>  <b>The database is started.</b> <br>  So everything is in order. <br><br>  We drive 3 more commands to change the path to mssqlsystemresource.ldf <br><br> <code>1&gt; ALTER DATABASE mssqlsystemresource <br> <br> 2&gt; MODIFY FILE (name = 'log', filename = 'E:\System\mssqlsystemresource.ldf') <br> <br> 3&gt; GO</code> <br> <br>  Again, if we see the answer: <br>  <b>The file "data" has been modified in the system catalog.</b>  <b>The database is started.</b> <br>  So everything is in order, and we were not mistaken. <br><br>  Exit sqlcmd with the QUIT command. <br><br>  Stop the MSSQL service with the command: <code>net stop mssqlserver</code> <br>  Here‚Äôs how it should look: <br><img src="https://habrastorage.org/getpro/habr/post_images/44a/09c/d5f/44a09cd5fbb19fc868d793f6b7c9f87d.jpg" alt="image"><br><br><br>  Copy the files .mdf and .ldf from the databases mssqlsystemresource and master in the proper places for them, <br>  in ‚ÄúD: \ System‚Äù we put the bases (.mdf) and in ‚ÄúE: \ System‚Äù, respectively, logies (.ldf). <br><br>  Run SQL Server Configuration Manager. <br><br>  Go to: Start-&gt; All Programs-&gt; Microsoft SQL Server 2005-&gt; Configuration Tools-&gt; SQL Server Configuration Manager <br>  In the opened window, go to: SQL Server 2005 Services -&gt; SQL Server (MSSQLSERVER) -&gt; Properties <br>  Tab: Advanced <br>  Line: Startup Parameters <br>  Change the path from the standard: <br>  -dC: \ Program Files \ Microsoft SQL Server \ MSSQL.1 \ MSSQL \ DATA \ master.mdf; -eC: \ Program Files \ Microsoft SQL Server \ MSSQL.1 \ MSSQL \ LOG \ ERRORLOG; -lC: \ Program Files \ Microsoft SQL Server \ MSSQL.1 \ MSSQL \ DATA \ mastlog.ldf <br>  on <br>  -dD: \ System \ master.mdf; -eC: \ Program Files \ Microsoft SQL Server \ MSSQL.1 \ MSSQL \ LOG \ ERRORLOG; -lE: \ System \ mastlog.ldf <br>  Click the button "Apply" <br>  Illustration: <br><img src="https://habrastorage.org/getpro/habr/post_images/629/fb0/f16/629fb0f16d8c7ed1fe1916b427a4a768.jpg" alt="image"><br><br>  We start SQL as usual. <br><br>  Further we transfer the msdb, model, tempdb bases. <br><br>  In MSSQL Server Management Studio we will execute the following query: <br> <code>ALTER DATABASE msdb <br> <br> MODIFY FILE (name = 'MSDBDATA', filename = 'D:\System\MSDBDATA.mdf') <br> <br> ALTER DATABASE msdb <br> <br> MODIFY FILE (name = 'MSDBLOG', filename = 'E:\System\MSDBLOG.ldf') <br> <br> ALTER DATABASE model <br> <br> MODIFY FILE (name = 'modeldev', filename = 'D:\System\model.mdf') <br> <br> ALTER DATABASE model <br> <br> MODIFY FILE (name = 'modellog', filename = 'E:\System\modellog.ldf') <br> <br> ALTER DATABASE tempdb <br> <br> MODIFY FILE (name = 'tempdev', filename = 'D:\System\tempdb.mdf') <br> <br> ALTER DATABASE tempdb <br> <br> MODIFY FILE (name = 'templog', filename = 'E:\System\templog.ldf')</code> <br> <br>  Looks like that: <br><img src="https://habrastorage.org/getpro/habr/post_images/c17/c0d/45f/c17c0d45fec5c44238e8b1ecb13822d3.jpg" alt="image"><br><br>  Stop MSSQL. <br>  We decompose the files .mdf and .ldf in the necessary places. <br>  We start service MSSQL. <br>  On this, the transfer of system databases is complete. <br><br>  I also want to mention the backup.  My observations led me to the fact that I refused to backup transaction files.  In my particular case, they are not needed, I can‚Äôt argue in yours, but maybe also.  Therefore, I only copy the database, that is, files with the extension .bak.  But you cannot restore the database using Management Studio with a simple mouse click, since MSSQL is offended by the absence of .ldf files, but you can use a simple script for our selfish purposes. <br><br> <code>RESTORE DATABASE basename <br> <br> FILE = 'basename' <br> <br> FROM DISK = 'X:\mssql_backup\folder_ basename\basename_backup_xxxxxxxxxxx.bak' <br> <br> WITH MOVE 'basename' TO 'E:\MSSQL_DATA\ basename' <br></code> <br>  Where: <br>  "Basename" is the name of the base <br>  "X: \ mssql_backup \ folder_ basename \" path to database backup. <br><br>  And just in case, the mdf mount script without ldf.  This is for the case when there are manually copied files but there are no transaction files for them. <br> <code>USE [master] <br> GO <br> CREATE DATABASE [ ] ON <br> ( FILENAME = N'  file.mdf' ) <br> FOR ATTACH _REBUILD_LOG</code> </div><p>Source: <a href="https://habr.com/ru/post/136346/">https://habr.com/ru/post/136346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136341/index.html">Call Center Megafon in Kislovodsk</a></li>
<li><a href="../136342/index.html">Cisco 1812 as a home router</a></li>
<li><a href="../136343/index.html">Select a color palette from a photo</a></li>
<li><a href="../136344/index.html">We disassemble iPhone Core Data Recipes. Part 2</a></li>
<li><a href="../136345/index.html">Everything is in the details</a></li>
<li><a href="../136347/index.html">Robbers stop taking CDs and DVDs</a></li>
<li><a href="../136348/index.html">Spaces in indesign and how i put them</a></li>
<li><a href="../136350/index.html">3D editors, pros and cons</a></li>
<li><a href="../136351/index.html">CSS modal windows</a></li>
<li><a href="../136352/index.html">Change your hard disk on your MacBook Pro in three clicks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>