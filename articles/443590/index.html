<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data Science: predicting business events to improve service</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Algorithms of recommendations, prediction of events or risk assessment are a trend decision in banks, insurance companies and many other business sect...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data Science: predicting business events to improve service</h1><div class="post__text post__text-html js-mediator-article">  Algorithms of recommendations, prediction of events or risk assessment are a trend decision in banks, insurance companies and many other business sectors.  For example, these programs help, based on data analysis, to suggest when a client returns a bank loan, what will be the demand in retail, what is the probability of an insured event or an outflow of customers in a telecom, etc.  For business, this is a valuable opportunity to optimize your expenses, increase your speed of work and, in general, improve service. <br><br>  At the same time, traditional approaches ‚Äî classification and regression ‚Äî are not suitable for building such programs.  Consider this problem on the example of a case dedicated to the prediction of medical episodes: analyze the nuances in the nature of the data and possible approaches to modeling, build a model and analyze its quality. <a name="habracut"></a><br><br><h3>  The task of predicting medical episodes </h3><br>  We predict episodes based on an analysis of historical data.  Dataset consists of two parts.  The first is data on services previously provided to the patient.  This part of the dataset includes socio-demographic data about the patient, such as age and gender, as well as diagnoses made in ICD10-CM [1] and different HCPCS procedures [2] performed at different points in time.  These data form sequences in time, which allow you to get an idea of ‚Äã‚Äãthe patient's condition at the moment of interest.  For training models, as well as for work in production, personalized data is enough. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The second part of the dataset is the list of episodes arising for the patient.  For each episode, we indicate its type and date of occurrence, as well as the time period, included services and other information.  Target variables for prediction are formed from this data. <br><br>  In the problem being solved, the time aspect is important: we are only interested in episodes that may arise in the near future.  On the other hand, the data at our disposal was collected for a limited period of time, beyond which there is no data.  Thus, we cannot say whether episodes occur outside of the observation period, what episodes are, at what point in time they occur.  This situation is called right censoring. <br><br>  In the same way, left censoring occurs in the same way: for some patients, the episode may begin to develop earlier than is available to our observation.  For us it will look like an episode that arose without any history. <br><br>  There is another type of data censoring - interruption of observation (if the observation period is not over and the event has not come).  For example, due to patient relocation, failure of the data collection system, and so on. <br><br>  In fig.  1 shows schematically different types of data censoring.  All of them distort the statistics and make it difficult to build a model. <br><img src="https://habrastorage.org/webt/dz/qk/wd/dzqkwdyt50tyh7ehpsxwipu2j3m.png"><br><br>  <i>Notes: 1 - uncensored observations;</i>  <i>2, 3 - left and right censoring, respectively;</i>  <i>4 - left and right censoring at the same time;</i> <i><br></i>  <i>5 - interruption of observation.</i> <br><br>  Another important feature of dataset is related to the nature of data flow in real life.  Some data may come late, in which case they are not available at the time of the prediction.  To take into account this feature, it is necessary to add datasets, throwing out several elements from the tail of each of the sequences. <br><br><h3>  Classification and Regression </h3><br>  Naturally, the first thought would be to reduce the task to a well-known classification and regression.  However, these approaches encounter serious difficulties. <br><br>  Why regression does not suit us is clear from the considered phenomena of right and left censoring: the distribution of the time of the occurrence of an episode in a dataset can be shifted.  In this case, the magnitude and the fact of the presence of this offset cannot be determined using the dataset itself.  The constructed model can show arbitrarily good results with any approach to validation, but with its suitability for forecasting on production-data this most likely will have nothing in common. <br><br>  At first glance, an attempt to reduce the task to classification looks more promising: to set a certain period of time and determine the episode that will arise during this period.  The main difficulty here is the binding of the time interval of interest to us.  Reliably, it can only be tied to the time of the last update of the patient's history.  At the same time, the request for prediction of the episode is not tied to time at all and can come at any time, both within this period (and then the effective period of interest is reduced) and beyond it - and then the prediction loses its meaning at all (see. 2).  This naturally induces an increase in the period of interest, which ultimately reduces the value of the prediction. <br><br><img src="https://habrastorage.org/webt/rm/-g/uk/rm-gukebroujw_awxfgxibqfpv4.png"><br><br>  <i>Notes: 1 - patient history updates;</i>  <i>2 - the last update and the time span associated with it;</i>  <i>3, 4 - requests for prediction of episodes received during this period.</i>  <i>It is seen that the effective prediction gap for them is smaller;</i>  <i>5 - request received outside the gap.</i>  <i>For him, prediction is impossible.</i> <br><br><h3>  Survival Analysis </h3><br>  Alternatively, you can consider an approach in the Russian-language literature called survival analysis (survival analysis, or time-to-event analysis) [3].  This is a family of models created specifically for working with censored data.  It is based on the approximation of the risk function (hazard function, intensity of the occurrence of events), which estimates the probability distribution of the occurrence of an event over time.  This approach allows you to correctly take into account the presence of different types of censoring. <br><br>  For the problem being solved, such an approach additionally allows one to combine both aspects of the problem in one model: determining the type of episode and predicting the time of its occurrence.  To do this, it is enough to build a separate model for each type of episode, similar to the one-vs-all approach in the classification.  Then the occurrence of a untargeted episode can be interpreted as the exclusion of an object from the observed sample without the occurrence of an event, which is another type of data censoring and is also correctly taken into account by the model.  This interpretation is also correct from the point of view of business logic: if a patient has a cataract underwent surgery, this does not exclude other episodes for him in the future. <br><br>  Among the family of models for the analysis of survival can be distinguished two varieties: analytical and regression.  Analytical models are purely descriptive, they are built for the population as a whole, do not take into account the characteristics of its individual members, and therefore, they can only predict the occurrence of an event for some typical member of the population.  In contrast to the analytical, regression models are constructed taking into account the characteristics of individual members of the population and allow you to build forecasts for individual members, taking into account their characteristics.  In the problem to be solved, it was precisely this variety that was used, and more specifically, the Cox's Proportional Hazard model (hereinafter referred to as CoxPH). <br><br><h3>  Survival regression and cataract surgery </h3><br>  The simplest approach will be the same as the usual regression: as an output, take the expectation of the time of the event.  Since CoxPH accepts input as a numerical vector, and our dataset is essentially a sequence of diagnostic codes and procedures (categorical data), a preliminary transformation of the data is required: <br><br><ul><li>  Translating codes into an embedded representation using a pre-trained GloVe model [4]; </li><li>  Aggregation of all codes available in the last period of the patient's history into a single vector; </li><li>  One-hot coding of the patient's gender and age scaling. </li></ul><br><br>  We then use the obtained feature vectors for training the model and its validation.  The resulting model shows the following values ‚Äã‚Äãof the concordance index (c-index or c-statistic) [5]: <br><br><ul><li>  0.71 per 5-fold validation; </li><li>  0,69 on the delayed sample. </li></ul><br>  This is comparable to the usual level of 0.6-0.7 for such models [6]. <br><br>  However, if you look at the mean absolute error between the predicted expected time of the episode and the actual, it turns out that the error is 5 days.  The reason for such a large error is that optimization under c-index guarantees only the correctness of the order of values: if one event should occur before another, then the predicted values ‚Äã‚Äãof the expected time before the events will be one less than the other, respectively.  At the same time, no statements are made regarding the predicted values ‚Äã‚Äãthemselves. <br><br>  Another possible variant of the output value of the model is a table of values ‚Äã‚Äãof the risk function at different points in time.  This option has a more complex structure, it is more difficult to interpret than the previous one, but at the same time it provides more information. <br><br>  Changing the output format requires a different way to assess the quality of the model: we need to make sure that for positive examples (when an episode occurs) the risk level is higher than for negative examples (when an episode does not occur).  To do this, for each predicted distribution of the risk function on a delayed sample, we move from a table of values ‚Äã‚Äãto a single value ‚Äî the maximum.  Considering the median values ‚Äã‚Äãfor positive and negative examples, we will see that they reliably differ: 0.13 versus 0.04, respectively. <br><br>  Next, we use these values ‚Äã‚Äãto build the ROC curve and calculate the area under it - ROC AUC, which is 0.92, which is acceptable for the problem to be solved. <br><br><h3>  Conclusion </h3><br>  Thus, we saw that the survival analysis is the approach best applied to solving the problem of predicting medical episodes, taking into account all the nuances of the problem and the available data.  However, its use suggests a different format of the model output data and a different approach to assessing its quality. <br><br>  Applying the CoxPH model to predicting episodes of cataract surgery has led to acceptable model quality indicators.  A similar approach can be applied to other types of episodes, but specific indicators of model quality can only be assessed directly in the modeling process. <br><br><h3>  Literature </h3><br>  [1] ICD-10 Clinical Modification <a href="https://en.wikipedia.org/wiki/ICD-10_Clinical_Modification">en.wikipedia.org/wiki/ICD-10_Clinical_Modification</a> <br>  [2] Healthcare Common Procedure Coding System <a href="https://en.wikipedia.org/wiki/Healthcare_Common_Procedure_Coding_System">en.wikipedia.org/wiki/Healthcare_Common_Procedure_Coding_System</a> <br>  [3] Survival analysis <a href="https://en.wikipedia.org/wiki/Survival_analysis">en.wikipedia.org/wiki/Survival_analysis</a> <br>  [4] GloVe: Global Vectors for Word Representation <a href="https://nlp.stanford.edu/projects/glove/">nlp.stanford.edu/projects/glove</a> <br>  [5] C-Statistic: Definition, Examples, Weighting and Significance <a href="https://www.statisticshowto.datasciencecentral.com/c-statistic/">www.statisticshowto.datasciencecentral.com/c-statistic</a> <br>  [6] VC Raykar et al.  On- <a href="https://papers.nips.cc/paper/3375-on-ranking-in-survival-analysis-bounds-on-the-concordance-index.pdf">line Conclusion</a> : Index of <a href="https://papers.nips.cc/paper/3375-on-ranking-in-survival-analysis-bounds-on-the-concordance-index.pdf">Bills</a> on the Concordance Index <a href="https://papers.nips.cc/paper/3375-on-ranking-in-survival-analysis-bounds-on-the-concordance-index.pdf">papers.nips.cc/paper/3375-on-ranking-in-survival-analysis-bounds-on-the-concordance-index.pdf</a> </div><p>Source: <a href="https://habr.com/ru/post/443590/">https://habr.com/ru/post/443590/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443576/index.html">[Peter] Containers and Distributions - JUG.ru meets Dmitry Chuiko and Alexander Belokrylov</a></li>
<li><a href="../443580/index.html">Government experiment on testing drones experiencing financial difficulties</a></li>
<li><a href="../443584/index.html">We follow high-quality digital releases of films without fuss</a></li>
<li><a href="../443586/index.html">GeekBrains launches free online marathon dedicated to remote work</a></li>
<li><a href="../443588/index.html">Professor Massachusetts Institute of Technology presented the future of prosthetics at the TED conference</a></li>
<li><a href="../443594/index.html">Crossing Testing and Architecture: An Interview with Neil Ford</a></li>
<li><a href="../443596/index.html">The Federation Council passed laws on contempt of government and fake news</a></li>
<li><a href="../443598/index.html">There is a massive revocation of TLS certificates from a variety of CAs, mistakenly generated on a 63-bit RNG instead of 64-bit</a></li>
<li><a href="../443600/index.html">Best and worst trends MWC 2019</a></li>
<li><a href="../443602/index.html">What is Strict Aliasing and why should we care? Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>