<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Entity Framework and Rule Names</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Remember, Ursula Le Guin in The Wizard of Earthsea: ‚ÄúNever ask a person about his name. Never call yours. ‚Äù Unfortunately, the Entity Framework is out...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Entity Framework and Rule Names</h1><div class="post__text post__text-html js-mediator-article">  Remember, Ursula Le Guin in The Wizard of Earthsea: ‚ÄúNever ask a person about his name.  Never call yours. ‚Äù  Unfortunately, the Entity Framework is out of the box absolutely not guided by this remarkable rule, and when generating classes based on the database schema (Database First strategy) it names the classes, class properties and navigation properties exactly as the corresponding table in the database is named. <br><br>  And what to do if there is a task to develop a new project to an already existing database, in which the tables are named after a certain pattern, say, according to the t_tablename pattern (for example, t_order_product).  A completely different naming convention has been adopted in the project, and developers want to see ‚Äúhuman,‚Äù from their point of view, names (OrderProduct).  Of course, you can get out of the situation by taking the appropriate administrative decision, but sometimes you really don't want to go against the sense of beauty. <br><a name="habracut"></a><br>  In addition, code generation templates appeared at the Entity Framework.  It would seem: for this they appeared, so that the developer could manage the process of creating classes based on the database schema.  However, it was not possible to confine with templates alone, but more on that below. <br><br>  So, the challenge: to achieve automatic renaming of entities when creating / updating the data model.  For simplicity, we assume that the column names are in an acceptable format, and we will only use table names. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The table name spawns the following names: <br><br><ul><li>  Actually class name (Entity) </li><li>  The name of the file where the class is stored (Entity.cs) </li><li>  Property name for accessing multiple classes from a database context (DbContext.Entities) </li><li>  Names of navigation properties </li><li>  The name of the figures in the visual designer </li></ul><br><br>  The T4 template itself generates only the file names, and it draws everything else from the Model.edmx file.  This file contains a description of database entities, a conceptual model, and the mapping of one to another.  Theoretically, you can force the template to generate the changed names of the entities, but this will lead to sad consequences.  Since the new name will not be matched in the .edmx file, any query to the database will fail ‚Äî the QueryProvider component of the SQL query simply does not detect the table name by the class name.  To verify this, it is enough to automatically refactor try renaming the name of some class.  A simple conclusion follows from this - it is required to modify the .edmx file itself. <br><br>  In fact, this task is not so much difficult as a dreary.  Knowledge of the .edmx structure and understanding of what is appropriate there is necessary.  In addition, in order for everything to be at its best, it will be necessary in some cases to translate the name into the plural.  With DbContext, everything is simple: take and translate.  With navigation properties it is more difficult: it is necessary to analyze the connections and determine which side this connection ‚Äúcomes in‚Äù: one or many.  In addition to the .edmx file, you also need to modify the .edmx.diagram file - this is where the description of the beautiful tablets that can be seen in the model designer is stored. <br><br>  The result of solving the problem described above was the class EntityTransformer, which I want to bring to your attention.  All it does is load the .edmx file, analyze its contents, change the values ‚Äã‚Äãof the corresponding attributes, and save the modified file.  If you want to use it for your own purposes, all you need to do is modify the <code>Transform(string inputString, bool pluralize)</code> method <code>Transform(string inputString, bool pluralize)</code> , which defines the rules for renaming entities. <br><br>  You can start the conversion in several ways - for example, create an external console application.  However, since I wanted to get as much as possible a ‚Äúseamless‚Äù solution and still use the templates (if there are any), the class was decorated in a template and connected to the main code generation template.  The connection itself is trivial, just add the EntityTransformer.ttinclude file to the project, copy the template below into it and add the selected lines to the Model.tt file: <br><br><img src="https://habrastorage.org/files/dc0/5cd/10c/dc05cd10c1164887b5bc0b80aa3e2cc6.jpg"><br><br>  In addition, you will need to add a reference to the <code>System.Data.Entity.Design</code> in the project - this is necessary for using <code>PluralizationService</code> .  If you do not need to convert to the plural, then you can not add the link, and exclude the corresponding lines of code from the template. <br><br>  To run the templates, they will have to be opened and saved, and this will have to be done twice: for Model.tt and for Model.Context.tt.  Otherwise, either the DbContext or the entity classes will retain the original names (table names).  Unfortunately, I could not find a way to automatically launch templates. <br><br><div class="spoiler">  <b class="spoiler_title">EntityTransformer.ttinclude template</b> <div class="spoiler_text"><pre> <code class="cs hljs">&lt;<span class="hljs-meta"><span class="hljs-meta">#@ assembly name="System.Data.Entity.Design" #&gt; &lt;#@ import namespace="System" #&gt; &lt;#@ import namespace="System.Data.Entity.Design.PluralizationServices" #&gt; &lt;#@ import namespace="System.Globalization" #&gt; &lt;#@ import namespace="System.Linq" #&gt; &lt;#@ import namespace="System.Text.RegularExpressions" #&gt; &lt;#@ import namespace="System.Xml.Linq" #&gt; &lt;#+ public class EntityTransformer { readonly PluralizationService _pluralizationService = PluralizationService.CreateService(CultureInfo.GetCultureInfo("en-US")); const string DESIGNER_NAMESPACE = "http://schemas.microsoft.com/ado/2009/11/edmx"; private string Transform(string inputString, bool pluralize) { string result = string.Empty; const string PREFIX = "t_"; Regex regex = new Regex(string.Format(@"(?&lt;namespace&gt;\w+?\.)*(?&lt;prefix&gt;{0})*(\w+)", PREFIX)); var groups = regex.Match(inputString).Groups; string namespc = groups["namespace"].Value; string[] parts = groups[1].Value.Split(new[] {"_"}, StringSplitOptions.RemoveEmptyEntries); for (int i = 0; i &lt; parts.Length; i++) { string addingPart = FirstCharToUpper(parts[i]); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (pluralize &amp;&amp; i == parts.Length - 1) addingPart = _pluralizationService.Pluralize(addingPart); result += addingPart; } result = namespc + result; return result; } private string Transform(string inputString) { string result = Transform(inputString, false); return result; } private void Transform(XAttribute attribute) { attribute.Value = Transform(attribute.Value); } private void Transform(XAttribute attribute, bool pluralize) { attribute.Value = Transform(attribute.Value, pluralize); } public void TransformEntities(string inputFile) { XDocument document = XDocument.Load(inputFile); const string SSDL_NAMESPACE = "http://schemas.microsoft.com/ado/2009/11/edm/ssdl"; const string CSDL_NAMESPACE = "http://schemas.microsoft.com/ado/2009/11/edm"; const string MSL_NAMESPACE = "http://schemas.microsoft.com/ado/2009/11/mapping/cs"; XElement ssdl = document.Descendants(XName.Get("Schema", SSDL_NAMESPACE)).First(); XElement csdl = document.Descendants(XName.Get("Schema", CSDL_NAMESPACE)).First(); XElement msl = document.Descendants(XName.Get("Mapping", MSL_NAMESPACE)).First(); XElement designerDiagram = document.Descendants(XName.Get("Designer", DESIGNER_NAMESPACE)).First(); TransformCsdl(csdl, ssdl); TransformMsl(MSL_NAMESPACE, msl); TransformDesigner(DESIGNER_NAMESPACE, designerDiagram, inputFile); document.Save(inputFile); } private void TransformDesigner(string designerNamespace, XElement designerDiagram, string modelFilePath) { Action&lt;XElement&gt; transformDesigner = diagram =&gt; { var shapes = diagram.Descendants(XName.Get("EntityTypeShape", designerNamespace)); foreach (var item in shapes) Transform(item.Attribute("EntityType")); }; transformDesigner(designerDiagram); string diagramFilePath = string.Format("{0}.diagram", modelFilePath); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (File.Exists(diagramFilePath)) { XDocument document = XDocument.Load(diagramFilePath); designerDiagram = document.Descendants(XName.Get("Designer", DESIGNER_NAMESPACE)).First(); transformDesigner(designerDiagram); document.Save(diagramFilePath); } } private void TransformMsl(string mslNamespace, XElement msl) { var entityContainerMapping = msl.Element(XName.Get("EntityContainerMapping", mslNamespace)); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (entityContainerMapping == null) throw new Exception("Element EntityContainerMapping not found."); foreach (var entitySetMapping in entityContainerMapping.Elements(XName.Get("EntitySetMapping", mslNamespace))) { Transform(entitySetMapping.Attribute("Name"), true); foreach (var entityTypeMapping in entitySetMapping.Elements(XName.Get("EntityTypeMapping", mslNamespace))) Transform(entityTypeMapping.Attribute("TypeName")); } } private void TransformCsdl(XElement csdl, XElement ssdl) { string csdlNamespace = csdl.GetDefaultNamespace().NamespaceName; Func&lt;XElement, string, IEnumerable&lt;XElement&gt;&gt; getElements = (root, localName) =&gt; root.Elements(XName.Get(localName, csdlNamespace)); var entityContainer = csdl.Element(XName.Get("EntityContainer", csdlNamespace)); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (entityContainer == null) throw new Exception("Element EntityContainer not found."); foreach (var entitySet in getElements(entityContainer, "EntitySet")) { Transform(entitySet.Attribute("Name"), true); Transform(entitySet.Attribute("EntityType")); } foreach (var associationSet in getElements(entityContainer, "AssociationSet")) foreach (var end in getElements(associationSet, "End")) Transform(end.Attribute("EntitySet"), true); foreach (var entityType in getElements(csdl, "EntityType")) Transform(entityType.Attribute("Name")); foreach (var association in getElements(csdl, "Association")) foreach (var end in getElements(association, "End")) Transform(end.Attribute("Type")); TransformNavigationProperties(csdl, ssdl); } private void TransformNavigationProperties(XElement csdl, XElement ssdl) { string ssdlNamespace = ssdl.GetDefaultNamespace().NamespaceName; string csdlNamespace = csdl.GetDefaultNamespace().NamespaceName; var associationSets = ssdl.Descendants(XName.Get("AssociationSet", ssdlNamespace)); foreach (XElement associationSet in associationSets) { var association = ssdl.Descendants(XName.Get("Association", ssdlNamespace)) .Single(a =&gt; a.Attribute("Name").Value == associationSet.Attribute("Name").Value); var roles = association.Elements().Where(e =&gt; e.Name.LocalName == "End"); var manyRole = roles.FirstOrDefault(e =&gt; e.Attribute("Multiplicity").Value == "*"); var csdlAssotiationSet = csdl.Descendants(XName.Get("AssociationSet", csdlNamespace)) .Single(e =&gt; e.Attribute("Name").Value == associationSet.Attribute("Name").Value); string associationName = csdlAssotiationSet.Attribute("Association").Value; var navigationProperties = csdl.Descendants(XName.Get("NavigationProperty", csdlNamespace)) .Where(e =&gt; e.Attribute("Relationship").Value == associationName); foreach (XElement navigationProperty in navigationProperties) { bool pluralize = manyRole != null &amp;&amp; navigationProperty.Attribute("ToRole").Value == manyRole.Attribute("Role").Value; Transform(navigationProperty.Attribute("Name"), pluralize); } } } private static string FirstCharToUpper(string input) { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (String.IsNullOrEmpty(input)) throw new ArgumentException("Empty string"); return input.First().ToString().ToUpper() + input.Substring(1); } } #&gt;</span></span></code> </pre><br></div></div><br><br>  To test the pattern, we used a database that emulates the most typical situations: one-to-many, one-to-one, many-to-many relationships, several relationships between two tables. <br><br><div class="spoiler">  <b class="spoiler_title">Script to create test tables</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_address]( [AddressId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [AddressName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">500</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [PK_t_address] PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED ( [AddressId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (PAD_INDEX = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, STATISTICS_NORECOMPUTE = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, IGNORE_DUP_KEY = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, ALLOW_ROW_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>, ALLOW_PAGE_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer]( [CustomerId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [CustomerName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LocationAddressId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [PostalAddressId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED ( [CustomerId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (PAD_INDEX = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, STATISTICS_NORECOMPUTE = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, IGNORE_DUP_KEY = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, ALLOW_ROW_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>, ALLOW_PAGE_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer_info]( [CustomerId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [CustomerDescription] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [PK_t_customer_info] PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED ( [CustomerId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (PAD_INDEX = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, STATISTICS_NORECOMPUTE = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, IGNORE_DUP_KEY = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, ALLOW_ROW_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>, ALLOW_PAGE_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order]( [OrderId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [CustomerId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [CreateDate] <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">getdate</span></span>()), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [PK__t_Order__C3905BCFC0AF501C] PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED ( [OrderId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (PAD_INDEX = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, STATISTICS_NORECOMPUTE = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, IGNORE_DUP_KEY = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, ALLOW_ROW_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>, ALLOW_PAGE_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order_product]( [OrderId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ProductId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Count</span></span>] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [PK_t_order_product] PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED ( [OrderId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span>, [ProductId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (PAD_INDEX = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, STATISTICS_NORECOMPUTE = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, IGNORE_DUP_KEY = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, ALLOW_ROW_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>, ALLOW_PAGE_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_product]( [ProductId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ProductName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ProductPrice] [<span class="hljs-built_in"><span class="hljs-built_in">decimal</span></span>](<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [PK_t_product] PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED ( [ProductId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (PAD_INDEX = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, STATISTICS_NORECOMPUTE = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, IGNORE_DUP_KEY = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, ALLOW_ROW_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>, ALLOW_PAGE_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_test_person]( [TestId] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [PK_t_test_person] PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> CLUSTERED ( [TestId] <span class="hljs-keyword"><span class="hljs-keyword">ASC</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (PAD_INDEX = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, STATISTICS_NORECOMPUTE = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, IGNORE_DUP_KEY = <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>, ALLOW_ROW_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>, ALLOW_PAGE_LOCKS = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer] <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_customer_t_address] <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>([LocationAddressId]) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> [dbo].[t_address] ([AddressId]) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer] <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_customer_t_address] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer] <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_customer_t_address1] <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>([PostalAddressId]) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> [dbo].[t_address] ([AddressId]) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer] <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_customer_t_address1] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer_info] <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_customer_info_t_customer] <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>([CustomerId]) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> [dbo].[t_customer] ([CustomerId]) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_customer_info] <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_customer_info_t_customer] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order] <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_Order_To_t_Customer] <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>([CustomerId]) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> [dbo].[t_customer] ([CustomerId]) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASCADE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order] <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_Order_To_t_Customer] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order_product] <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_order_product_t_order] <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>([OrderId]) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> [dbo].[t_order] ([OrderId]) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASCADE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order_product] <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_order_product_t_order] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order_product] <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_order_product_t_product] <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span>([ProductId]) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> [dbo].[t_product] ([ProductId]) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASCADE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[t_order_product] <span class="hljs-keyword"><span class="hljs-keyword">CHECK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> [FK_t_order_product_t_product] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre><br></div></div><br><br>  Successful to you renaming! </div><p>Source: <a href="https://habr.com/ru/post/236371/">https://habr.com/ru/post/236371/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236361/index.html">Festival 404: What will be interesting this year?</a></li>
<li><a href="../236363/index.html">Changing the rules of the Tizen App Challenge contest</a></li>
<li><a href="../236365/index.html">How I chose a hedgehog copywriter - and how much it costs to write trash and burn</a></li>
<li><a href="../236367/index.html">Not just gadgets: Apple iAd ad network</a></li>
<li><a href="../236369/index.html">Analyzing the cloud contact center: where to start</a></li>
<li><a href="../236373/index.html">Google Chrome: Sunset for SHA-1</a></li>
<li><a href="../236375/index.html">Implementation of the stack, queue and soundboard in the F # language in a functional style</a></li>
<li><a href="../236377/index.html">Introducing the updated Webmaster Tools API</a></li>
<li><a href="../236379/index.html">Fighting sms at the wheel</a></li>
<li><a href="../236383/index.html">Equation or all the same observation?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>