<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Perimeter defense: old attacks are not worse than new ones</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="External threats to information security are usually associated with hacker attacks on the network perimeter, including complex targeted attacks again...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Perimeter defense: old attacks are not worse than new ones</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/309072/"><img src="https://habrastorage.org/files/926/e6c/1fd/926e6c1fd07c4579888a91d11516a9e7.jpg"></a> <br><br>  External threats to information security are usually associated with hacker attacks on the network perimeter, including complex targeted attacks against large companies and government agencies (APT).  A recent example is the <a href="https://habrahabr.ru/company/pt/blog/308064/">hacking of the Equation Group</a> with the subsequent publication of part of their toolkit for overcoming the network perimeter.  As it turned out, many exploits from this set used long-known vulnerabilities, although the ‚Äúcherry on the cake‚Äù was 0-Day for SNMP services (an abbreviation of ‚Äú <b>S</b> security <b>N</b> o <b>M</b> y <b>P</b> roblem‚Äù).  Unfortunately, we do not have a complete set of merged exploits to fully appreciate the scale of the disaster.  However, we can use the approach from the reverse - to assess the degree of security of corporate perimeters based on the actual statistics of their vulnerabilities. <br><br>  One of such studies was presented at the PHDays VI conference in our traditional collection Positive Research 2016. The sample included about 10,000 available addresses and 15,000 vulnerabilities, the study period was two years (2014-2015).  However, it is necessary to clarify that the study was carried out only for network perimeters with a security level above the average: that is, only companies that have established asset inventory and vulnerability management processes (which actually allows collecting statistics) have been considered. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's start with the hottest topic in the published exploit pack: SNMP 0-Day.  Is this threat relevant?  Our research shows that yes.  Here are some reasons for this situation: <br><a name="habracut"></a><br><ul><li>  Analysis using honeypot systems shows that SNMP services are very popular with potential intruders - a wide range of hackers already knows about the availability of these services.  And who else does not know, without complications can learn through Shodan. <br><br></li><li>  There are a lot of SNMP services, they are available on most modern network infrastructures.  In particular, we <a href="https://habrahabr.ru/company/pt/blog/247355/">have already said</a> that the exploitation of SNMP vulnerabilities can penetrate the technological networks of telecom operators. <br><br></li><li>  Many SNMP services run on outdated software versions.  According to our research, in the category of DNS, NTP and SNMP-services every tenth is vulnerable: </li></ul><br><img src="https://habrastorage.org/files/86c/369/6ea/86c3696eae5f444cadb4a487dd5b18b1.png"><br><br>  Based on these statistics, you can definitely evaluate the published exploit: it is very dangerous and can be used to overcome the network perimeter of many organizations. <br><br>  However, another interesting question remains.  Why did the Equation Group, which is loudly called the ‚Äúcomplete state cyber weapon set,‚Äù turn out to have many exploits for old vulnerabilities, including those for which security updates were released more than 5 years ago?  It would seem that such a cool hacker group should actively use new, unknown vulnerabilities. <br><br>  The answer is paradoxically simple, if we correctly reformulate the question: why should hacker groups spend their precious time on 0-Days, if a significant part of the systems available via the Internet has not been updated for years? <br><br>  Our study showed that three-quarters of all detected vulnerabilities are older than one year, 30% of vulnerabilities are older than 5 years, and almost every tenth vulnerability could be fixed 10 years ago.  Over the investigated time interval, vulnerabilities were detected on 37% of the systems. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c74/d2f/0b5/c74d2f0b57d84c51b1692454bdd65eb4.png"></div><br>  <i>By clicking the picture will open in full size.</i> <br><br>  Thus, for successful attack there is no need to use the latest vulnerabilities: the old ones are great.  They are cheaper, and the hacker group to disclose information about the exploitation of the old vulnerability is less critical than to ‚Äúlight up‚Äù 0-Day. <br><br>  But so far we have considered only the situation with exploits in a closed toolkit.  Are exploits from old open source vulnerabilities, say, MSF, suitable?  To answer this question, we chose vulnerabilities with CVSS ‚ÄúHigh‚Äù values ‚Äã‚Äãthat were available at the beginning of the study period in the systems under test, and compared them with known exploit packs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/626/034/e1e/626034e1eeae46a7ae16a8dc97c66b23.png"></div><br>  From this statistics it is clear that at the perimeters of the companies studied there are vulnerabilities that can be exploited through public exploits.  However, this sample contains a very small set of vulnerabilities.  Does this really mean that there are few of them?  As we said earlier, the sampling on vulnerabilities in the previous picture was made only for the initial period of the study, and the level of perimeter security never remains the same.  The dynamics of changes over two years are clearly shown by the following graphs: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e8b/3a4/01b/e8b3a401b2c0471180123805e841a9a9.png"></div><br>  <i>By clicking the picture will open in full size.</i> <br><br>  So, a summary: to overcome the perimeters, the security level of which is estimated above the average, does not require any exploits from sealed sources, and the more secret knowledge of the APT-groups on the use of their own 0-Day.  Enough standard tools. <br><br><h3>  How to defend </h3><br>  Taking into account the findings, we highlight the following main areas to improve the overall security level of the network perimeter: <br><br><ol><li>  Permanent monitoring of the company's network perimeter, the result of which should be the rapid detection of services located on the perimeter and accessible from the Internet. <br><br></li><li>  Automated search for vulnerabilities in services located on the perimeter.  The result should be the identification of vulnerabilities and monitoring their removal. <br><br></li><li>  Elimination of unnecessary services, the need to place them on the perimeter is not due to any objective necessity.  These categories of services may include NTP, SNMP, database services, administrative interfaces, and other categories of potentially dangerous services. <br><br></li><li>  Implementing a patch management policy, with first of all, attention should be paid to systems with vulnerabilities for which there are open source exploits, as well as to the most vulnerable systems.  The remaining systems should be updated in accordance with the prioritization of critical systems and vulnerabilities. <br><br></li><li>  Using an integrated approach to information security.  Securing the network perimeter is the basis for ensuring information security, but the perimeter is not the only vector of intruder penetration into the company's infrastructure. </li></ol><br><blockquote>  Full version of the report on the level of corporate perimeter security can be found <a href="http://www.ptsecurity.ru/research/analytics/">here.</a> </blockquote><br>  <b>Author:</b> Vladimir Lapshin, Head of Information Security Monitoring, Positive Technologies </div><p>Source: <a href="https://habr.com/ru/post/309072/">https://habr.com/ru/post/309072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309060/index.html">The benefits of standardization</a></li>
<li><a href="../309062/index.html">Android to the State Duma will bring or mobilization of civic consciousness</a></li>
<li><a href="../309064/index.html">Example of exploiting one old vulnerability</a></li>
<li><a href="../309068/index.html">What we know about 5G networks</a></li>
<li><a href="../309070/index.html">Smart home software</a></li>
<li><a href="../309074/index.html">Type inference in programming</a></li>
<li><a href="../309076/index.html">Unreachable web: how we made such a mess</a></li>
<li><a href="../309078/index.html">Tips for working with Steam GreenLight or how not to get bogged down in a swamp</a></li>
<li><a href="../309080/index.html">On the process of creating a server - from idea to detail</a></li>
<li><a href="../309086/index.html">NVMe over Fabric, Fiber Channel and others</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>