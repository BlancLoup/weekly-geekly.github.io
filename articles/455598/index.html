<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Update exim urgently to 4.92 - an active infection is in progress</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Colleagues who use Exim versions 4.87 ... 4.91 on their mail servers - urgently update to version 4.92, after having stopped Exim itself to avoid hack...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Update exim urgently to 4.92 - an active infection is in progress</h1><div class="post__text post__text-html js-mediator-article">  Colleagues who use Exim versions 4.87 ... 4.91 on their mail servers - urgently update to version 4.92, after having stopped Exim itself to avoid hacking via CVE-2019-10149. <br><br>  Potentially vulnerable to several million servers worldwide, the vulnerability is rated as critical (CVSS 3.0 base score = 9.8 / 10).  Criminals can run arbitrary commands on your server, in many cases from the root. <br><a name="habracut"></a><br>  Please make sure that you use the corrected version (4.92) or the already patched version. <br>  Either patch the existing one, see the <a href="https://habr.com/ru/post/455598/">comment</a> branch <a href="https://habr.com/ru/post/455598/">immaculate</a> . <br><br>  Update for <b>centos 6</b> : see the <a href="https://habr.com/ru/post/455598/">comment Theodor</a> - for centos 7 it also works, if it hasn't flown directly from epel. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      UPD: Ubunt affected on <b>18.04 and 18.10</b> , an update has been released for them.  Versions 16.04 and 19.04 are not affected, if only custom options are not installed on them.  More <a href="https://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-10149.html">on their official website</a> . <br><br>  <a href="http://www.opennet.ru/opennews/art.shtml%3Fnum%3D50819">Opennet Issue Information</a> <br>  <a href="https://www.exim.org/static/doc/security/CVE-2019-10149.txt">Information on the Exim website</a> <br><br>  Now the problem described there is being actively exploited (by a bot, I suppose), I noticed an infection on some servers (running at 4.91). <br><br>  Further reading is relevant only for those who have already "got" - it is necessary either to transport everything to a clean VPS with a fresh software, or to look for a solution.  Let's try?  Write if someone can overcome this malware. <br><br>  If you, being an Exim user and reading this, are still not updated (you were not convinced that 4.92 or the patched version is available), please stop and run to update. <br><br>  For those already hit, let's continue ... <br><br>  UPD: <a href="https://habr.com/ru/post/455598/">supersmile2009 found another type of malware</a> and gives the right advice: <blockquote>  There can be a great many malware.  Having started the medicine by not having cleaned the queue and the user will not be cured and may not know what he needs to be treated for. </blockquote><br><br>  Infection is noticeable like this: [kthrotlds] loads the processor;  on weak VDS by 100%, on servers it is weaker but noticeable. <br><br>  After infection, the malware deletes the entries in cron, registering there only itself in the launch every 4 minutes, while the krontab file is immutable.  <i>Crontab -e</i> cannot save changes, gives an error. <br><br>  Immutable can be removed for example, and then delete the command line (1.5kb): <br><pre><code class="bash">chattr -i /var/spool/cron/root
crontab -e</code></pre><br>
    crontab (vim)    :<code>dd<br>
:wq</code><br>
<br>
 -     , .<br>
<br>
     wget' ( curl')      (. ),     ,    :<br>
<br>
<pre><code class="bash">ps aux | grep wge[t]
ps aux | grep cur[l]
echo "Stopping..."
kill -9 `ps aux | grep wge[t] | awk '{print $2}'`
kill -9 `ps aux | grep cur[l] | awk '{print $2}'`
</code></pre><br>
<br>
     (centos): /usr/local/bin/nptd‚Ä¶    ,        shell ,   . <br>
<br>
    .<br>
<br>
UPD 1:   (  chattr -i) /etc/cron.d/root, /etc/crontab, rm -Rf /var/spool/cron/root  ,      ‚Äî      (bin- ).<br>
<br>
UPD 2:        ,    : <br>
find / -size 19825c<br>
<br>
UPD 3: <b>!</b>   selinux     <b>SSH-</b>  ${sshdir}/authorized_keys!      /etc/ssh/sshd_config,        YES:<br>
PermitRootLogin yes<br>
RSAAuthentication yes<br>
PubkeyAuthentication yes<br>
echo UsePAM yes<br>
PasswordAuthentication yes<br>
<br>
UPD 4:    :  exim, cron ( ),      ssh    sshd,  sshd!        ,     .<br>
<br>
     /    ,     .<br>
<br>
UPD 5: <a href="https://habr.com/ru/post/455598/">AnotherDenni </a>      WordPress.<br>
<br>
UPD 6: <a href="https://habr.com/ru/post/455598/">Paulmann   </a>, !        ,    . <br>
<br>
  ( )  ,  ,  .<br>
<br>
UPD 7: <a href="https://habr.com/ru/users/clsv/"> clsv</a> :<br>
<blockquote>           exim,       ,   /var/spool/exim4</blockquote><br>
   exim  :<br>
exipick -i | xargs exim -Mrm<br>
    :<br>
exim -bpc<br>
<br>
UPD 8:  <a href="https://habr.com/ru/post/455598/">   AnotherDenni</a>: FirstVDS      ,  !<br>
<br>
UPD 9:  <b> </b>,  <a href="https://habr.com/ru/users/bananaseverywhere/"></a>  ! <br>
<br>
             -   (   ) .<br>
<br>
       (vds),       ‚Äî  -  ,    , ..        ‚Ä¶<br>
<br>
UPD 10:    <a href="https://habr.com/ru/users/clsv/" class="user_link">clsv</a>:       ,    <b>Raspberry Pi</b>,   ‚Ä¶          ,   .<br>
<br>
UPD 11:  <a href="https://habr.com/ru/company/first/blog/455636/">  </a>    ¬´ ¬ª: <br>
(         )<br>
<blockquote>   ‚Äî   -    , ,  ,          30</blockquote><br>
UPD 12: <a href="https://habr.com/ru/post/455598/">supersmile2009 </a>     exim (?)        ,   .<br>
<br>
UPD 13: <a href="https://habr.com/ru/post/455598/">lorc </a>     ,     , ..          ,      .<br>
<br>
UPD 14:            ‚Äî   <a href="https://habr.com/ru/post/455598/">   clsv</a>:<br>
<blockquote>        ‚Ä¶    OrangePi  debian <s>jessie</s> UPD: stretch, exim   Debian-exim     ,    .</blockquote><br>
UPD 15:           , <a href="&amp;xid=25657,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhhofa8oEynFSR7g6TodA0o_l_X8IA#comment_20274960">   w0den</a>:<blockquote>           ,         (,  MySQL    CREATE TRIGGER  CREATE EVENT). ,    .html, .js, .php, .py     (   ,    ,         ).</blockquote><br>
UPD 16: <a href="https://habr.com/ru/users/daykkin/" class="user_link">daykkin</a>  <a href="https://habr.com/ru/users/savage_me/" class="user_link">savage_me</a> <a href="https://habr.com/ru/post/455598/">   </a>:        exim,     .<br>
<br>
   <b>   </b>     !<br>
<pre><code class="bash">exim --version</code></pre>      .<br>
<br>
   DirectAdmin      da_exim ( ,  ).<br>
<br>
    DirectAdmin'   custombuild         exim,  .<br>
<br>
        custombuild.<br>
<br>
      ,     /    exim   <a href="https://habr.com/ru/post/455598/"> </a>   ¬´¬ª  .</div><p>Source: <a href="https://habr.com/ru/post/455598/">https://habr.com/ru/post/455598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455586/index.html">Robotics lecture series by Professor Gregor Sch√∂ner, Director of the Institute of Neuroinformatics (INI) Bochum, Germany</a></li>
<li><a href="../455588/index.html">How to educate your community, not to dance with a tambourine</a></li>
<li><a href="../455592/index.html">Viruses attacking industrial plants as a threat to physical security</a></li>
<li><a href="../455594/index.html">Operating Microsoft Edge from CVE to RCE on Windows 10</a></li>
<li><a href="../455596/index.html">DevConfX :: Management - reports of managers in simple words</a></li>
<li><a href="../4556/index.html">Another site safely "zaguglen"</a></li>
<li><a href="../455600/index.html">3DEXPERIENCE Platform Helps Build Future Public Transport</a></li>
<li><a href="../455602/index.html">Providing browser crashes with behavioral fuzzing</a></li>
<li><a href="../455606/index.html">Machine learning and data analysis: magistracy of the Higher School of Economics in St. Petersburg</a></li>
<li><a href="../455610/index.html">Legendary Intel Core i7-2600K: Sandy Bridge Testing in 2019 (Part 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>