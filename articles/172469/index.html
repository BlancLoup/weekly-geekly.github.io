<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Shooting Time Lapse video for Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let's write a program to create your own movies in the Time Lapse technique. A fascinating video shot in this technique from the ISS can be viewed her...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Shooting Time Lapse video for Android</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3a0/01b/fe8/3a001bfe8b4af4bf2c957537e8520c7d.jpg" alt="image" align="right">  Let's write a program to create your own movies in the <a href="http://en.wikipedia.org/wiki/Time-lapse_photography">Time Lapse</a> technique.  A fascinating video shot in this technique from the ISS can be viewed <a href="http://www.youtube.com/watch%3Fv%3DIp2ZGND1I9Q">here</a> , a more affordable version, which can be repeated using the described program - <a href="http://www.youtube.com/watch%3Fv%3DTt-juyvIWMQ">here</a> . <br><br>  The program has a simple interface and simple principle of operation: <br>  ‚Ä¢ the user sets the frequency of images with an integrated camera (for example, 10 s) and the desired frame rate of the generated video (for example, 25 frames per second); <br>  ‚Ä¢ after pressing the ‚ÄúStart‚Äù button, the program takes a photo every 10 seconds and writes a jpg file to the SD card; <br>  ‚Ä¢ the procedure is repeated until the ‚ÄúStop‚Äù and ‚ÄúCreate video‚Äù buttons are clicked, after which the sequence of photos is converted into a <a href="http://ru.wikipedia.org/wiki/MJPEG">Motion JPEG</a> video file, which shows the footage 250 times (25 * 10) faster than the actual speed of the events. <br><br>  The program has two main classes - <em>MainActivity</em> , which deals with user interaction and the accumulation of images, and the <em>MJPEGGenerator</em> , which is responsible for turning a sequence of images into a video file. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The <em>MJPEGGenerator</em> class, taken from <a href="">code.google.com</a> , was slightly reworked due to the fact that Android Java is missing the java.awt package. <br><br>  Procedures for working with the camera were mainly taken from the material <a href="http://habrahabr.ru/post/112272/">Working with the camera in Android</a> , where there is a good description of the applied solutions, the problem of ‚Äústicking‚Äù the camera after the Android device lock / unlock was eliminated thanks to <a href="http://stackoverflow.com/questions/7186007/camera-example-bug-when-locking-unlocking-device">stackoverflow</a> . <br><br>  The program was debugged on the Prestigio MultiPad 7.0 Prime tablet for Android 4.0. <br><br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/53b/261/4f2/53b2614f2d6ec3cd2f1f966d692216b4.png" alt="image"></div><br><br>  Let us consider in more detail the work of the individual components of the program, not related to the camera itself. <br><br>  In order to prevent the screen from <em>turning</em> off, the <em>PowerManager.WakeLock</em> mechanism was applied: <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> PowerManager.WakeLock wl; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Bundle savedInstanceState</span></span></span><span class="hljs-function">)</span></span> { ... PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE); wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, <span class="hljs-string"><span class="hljs-string">"DoNotDimScreen"</span></span>); }</code> </pre> <br><br>  The frequency of starting the camera is controlled by the timer: <br><br><pre> <code class="hljs cs">Timer updateTimer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Timer(); ... updateTimer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Timer(); updateTimer.scheduleAtFixedRate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimerTask() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((camera != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) &amp;&amp; (workMode == <span class="hljs-number"><span class="hljs-number">1</span></span>)) { camera.takePicture(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }} }, <span class="hljs-number"><span class="hljs-number">0</span></span>, capturePeriod * <span class="hljs-number"><span class="hljs-number">1000</span></span>);</code> </pre><br><br>  Before starting, check the availability of the SD card: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">if</span></span> (!<span class="hljs-selector-tag"><span class="hljs-selector-tag">Environment</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.getExternalStorageState</span></span>()<span class="hljs-selector-class"><span class="hljs-selector-class">.equals</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">Environment</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.MEDIA_MOUNTED</span></span>)) <span class="hljs-selector-tag"><span class="hljs-selector-tag">Toast</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.makeText</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">MainActivity</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.this</span></span>, "<span class="hljs-selector-tag"><span class="hljs-selector-tag">Please</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mount</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SD</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">card</span></span>", <span class="hljs-selector-tag"><span class="hljs-selector-tag">Toast</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LENGTH_LONG</span></span>)<span class="hljs-selector-class"><span class="hljs-selector-class">.show</span></span>();</code> </pre><br><br>  The data entered by the user is pre-processed: commas entered as a decimal separator are replaced by a period;  checks for non-numeric values;  values ‚Äã‚Äãof the entered period and frame rate are checked for entry into the allowable range: <br><br><pre> <code class="hljs cs">periodEditText.addTextChangedListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextWatcher() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">afterTextChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Editable s</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (periodEditText.getText().toString().length() == <span class="hljs-number"><span class="hljs-number">0</span></span>) capturePeriod = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isNum(periodEditText.getText().toString().replace(<span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> a = Float.valueOf(periodEditText.getText().toString().replace(<span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>)); capturePeriod = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) a; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, periodEditText.getText().toString() + <span class="hljs-string"><span class="hljs-string">" - not a digit."</span></span>, Toast.LENGTH_LONG).show(); }} ... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((fps &lt; FPSMIN) || (fps &gt; FPSMAX)) Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"FPS should be "</span></span> + FPSMIN + <span class="hljs-string"><span class="hljs-string">" to "</span></span> + FPSMAX + <span class="hljs-string"><span class="hljs-string">" frames per second"</span></span>, Toast.LENGTH_LONG).show();</code> </pre><br><br>  At the beginning of work, all the * .jpg files remaining from the previous session are deleted from the program folder: <br><br><pre> <code class="hljs matlab">String sdPath = Environment.getExternalStorageDirectory().getPath() + <span class="hljs-string"><span class="hljs-string">"/TimeLapseFolder/"</span></span>; File saveDir = new File(sdPath); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (saveDir.isDirectory()) { String[] children = saveDir.list(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> &lt; children.<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (children[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>].endsWith(<span class="hljs-string"><span class="hljs-string">".jpg"</span></span>)) new File(saveDir, children[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]).delete(); }} saveDir.delete();</code> </pre><br><br>  After shooting the next frame, the user is shown the remaining space on the map: <br><br><pre> <code class="hljs vbscript">modeText.setText(<span class="hljs-string"><span class="hljs-string">"Work mode: capturing, "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.valueOf(roundOneDecimal(megAvailable)) + <span class="hljs-string"><span class="hljs-string">" Mbyte available on SD card"</span></span>);</code> </pre><br><br>  Actually video generation: <br><br><pre> <code class="hljs vbscript">generator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MJPEGGenerator(videofile, aviWidth, aviHeight, fps, lastPicture); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">int</span></span> addpic = <span class="hljs-number"><span class="hljs-number">1</span></span>; addpic &lt;= lastPicture; addpic++) { <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> numWithZeroes = intToString(addpic, <span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> curjpg = sdPath + numWithZeroes + <span class="hljs-string"><span class="hljs-string">".jpg"</span></span>; publishProgress(numWithZeroes); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DEBUG) <span class="hljs-built_in"><span class="hljs-built_in">Log</span></span>.v(TAG, <span class="hljs-string"><span class="hljs-string">"Rendering jpg sdPath = "</span></span> + curjpg); Bitmap bmp = BitmapFactory.decodeFile(curjpg); generator.addImage(bmp); }</code> </pre><br><br>  <em>MJPEGGenerator</em> starts with the following parameters: <br>  videofile - the name of the video file is taken every time a new one, numbered by the mask TimeLapseMovieXXX.avi, in order to save the files previously shot; <br>  aviWidth, aviHeight - taken from the properties of the camera; <br>  fps - user defined; <br>  lastPicture - the number of the last picture taken. <br><br>  In order not to suspend the user interface, video generation is launched in a separate <em>AsyncTask</em> stream interacting with the GUI via <em>onProgressUpdate</em> . <br><br>  The contents of the key files are shown below, the project archive can be downloaded from <a href="http://sourceforge.net/projects/android-tlapse/">sourceforge.net</a> . <br><br><div class="spoiler">  <b class="spoiler_title">MainActivity.java</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">package com.sample.timelapse; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.text.DecimalFormat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Timer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.TimerTask; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.annotation.SuppressLint; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.SharedPreferences; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.Bitmap; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.BitmapFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.Color; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.graphics.Point; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Camera; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.hardware.Camera.Size; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.AsyncTask; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Build; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Environment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.<span class="hljs-keyword"><span class="hljs-keyword">Handler</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.PowerManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.StatFs; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.text.Editable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.text.TextWatcher; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.<span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.TypedValue; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.Display; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.SurfaceHolder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.SurfaceView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">View</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">View</span></span>.OnFocusChangeListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.ViewGroup.LayoutParams; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">Window</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.WindowManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.inputmethod.InputMethodManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.EditText; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MainActivity extends Activity implements SurfaceHolder.Callback, <span class="hljs-keyword"><span class="hljs-keyword">View</span></span>.OnClickListener, Camera.PictureCallback, Camera.PreviewCallback { private MJPEGGenerator generator; Timer updateTimer = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Timer(); // Main shoot timer private static final <span class="hljs-type"><span class="hljs-type">int</span></span> PERIODMIN = <span class="hljs-number"><span class="hljs-number">2</span></span>; // Seconds private static final <span class="hljs-type"><span class="hljs-type">int</span></span> PERIODMAX = <span class="hljs-number"><span class="hljs-number">1000</span></span>; // Seconds private static final <span class="hljs-type"><span class="hljs-type">int</span></span> FPSMIN = <span class="hljs-number"><span class="hljs-number">2</span></span>; private static final <span class="hljs-type"><span class="hljs-type">int</span></span> FPSMAX = <span class="hljs-number"><span class="hljs-number">30</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> aviHeight = <span class="hljs-number"><span class="hljs-number">0</span></span>; // Dimensions <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> final video <span class="hljs-type"><span class="hljs-type">int</span></span> aviWidth = <span class="hljs-number"><span class="hljs-number">0</span></span>; // <span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode // <span class="hljs-number"><span class="hljs-number">0</span></span>: Ready <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> // <span class="hljs-number"><span class="hljs-number">1</span></span>: Capturing photos // <span class="hljs-number"><span class="hljs-number">2</span></span>: Ready <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> video // <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> video private <span class="hljs-type"><span class="hljs-type">int</span></span> workMode = <span class="hljs-number"><span class="hljs-number">0</span></span>; private <span class="hljs-type"><span class="hljs-type">int</span></span> capturePeriod = <span class="hljs-number"><span class="hljs-number">0</span></span>; private <span class="hljs-type"><span class="hljs-type">int</span></span> fps = <span class="hljs-number"><span class="hljs-number">0</span></span>; private Camera camera; private SurfaceHolder surfaceHolder; private SurfaceView preview; private static <span class="hljs-type"><span class="hljs-type">int</span></span> LOGLEVEL = <span class="hljs-number"><span class="hljs-number">2</span></span>; // <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> private static <span class="hljs-type"><span class="hljs-type">boolean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span> = LOGLEVEL &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>; @SuppressWarnings("unused") private static <span class="hljs-type"><span class="hljs-type">boolean</span></span> <span class="hljs-built_in"><span class="hljs-built_in">WARNING</span></span> = LOGLEVEL &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static final String PREFS_NAME = "MyPrefsFile"; // <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> save <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> restore preferences private static final String TAG = "MainActivity"; // <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> logging tag <span class="hljs-type"><span class="hljs-type">int</span></span> lastPicture = <span class="hljs-number"><span class="hljs-number">0</span></span>; // <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> picture counter <span class="hljs-type"><span class="hljs-type">int</span></span> lastVideo = <span class="hljs-number"><span class="hljs-number">0</span></span>; // <span class="hljs-keyword"><span class="hljs-keyword">Current</span></span> video file counter <span class="hljs-type"><span class="hljs-type">int</span></span> sWidth = <span class="hljs-number"><span class="hljs-number">0</span></span>; // Screen width <span class="hljs-type"><span class="hljs-type">int</span></span> sHeight = <span class="hljs-number"><span class="hljs-number">0</span></span>; // Screen height <span class="hljs-type"><span class="hljs-type">int</span></span> prevsWidth = <span class="hljs-number"><span class="hljs-number">1</span></span>; // Previous screen width (<span class="hljs-keyword"><span class="hljs-keyword">after</span></span> previous onWindowFocusChanged) <span class="hljs-type"><span class="hljs-type">int</span></span> prevsHeight = <span class="hljs-number"><span class="hljs-number">1</span></span>; // Previous screen height (<span class="hljs-keyword"><span class="hljs-keyword">after</span></span> previous onWindowFocusChanged) <span class="hljs-type"><span class="hljs-type">int</span></span> commentTextBottom = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> oldLandCommentTextBottom = <span class="hljs-number"><span class="hljs-number">0</span></span>; private TextView periodText; private TextView framerateText; private TextView totalsnapshotsText; private Button startButton; // "Start capture" private Button createButton; // "Create video" <span class="hljs-type"><span class="hljs-type">int</span></span> nativeButtonColor = <span class="hljs-number"><span class="hljs-number">0</span></span>; private EditText periodEditText; // Period private TextView secondsText; private EditText fpsEditText; // Frame rate private TextView fpsText; private TextView modeText; // <span class="hljs-keyword"><span class="hljs-keyword">Show</span></span> comments <span class="hljs-type"><span class="hljs-type">float</span></span> roundOneDecimal(<span class="hljs-type"><span class="hljs-type">float</span></span> toround) { DecimalFormat twoDForm = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> DecimalFormat("#.#"); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Float</span></span>.valueOf(twoDForm.format(toround)); } static String intToString(<span class="hljs-type"><span class="hljs-type">int</span></span> num, <span class="hljs-type"><span class="hljs-type">int</span></span> digits) { <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> digits &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> : "Invalid number of digits"; <span class="hljs-type"><span class="hljs-type">char</span></span>[] zeros = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">char</span></span>[digits]; // <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> variable length <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> zeros Arrays.fill(zeros, <span class="hljs-string"><span class="hljs-string">'0'</span></span>); DecimalFormat df = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> DecimalFormat(String.valueOf(zeros)); // <span class="hljs-keyword"><span class="hljs-keyword">Format</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> String <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> df.format(num); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">boolean</span></span> isNum(String s) { try { <span class="hljs-type"><span class="hljs-type">Double</span></span>.parseDouble(s); } catch (NumberFormatException e) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } private PowerManager.WakeLock wl; // Stop screen <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dimming <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> enforcing wake <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> @Override protected <span class="hljs-type"><span class="hljs-type">void</span></span> onPause() { super.onPause(); // onPause <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the parent <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.v(TAG, "onPause"); surfaceHolder.removeCallback(this); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (camera != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { camera.setPreviewCallback(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); camera.stopPreview(); camera.<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>(); camera = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } preview.setVisibility(<span class="hljs-keyword"><span class="hljs-keyword">View</span></span>.GONE); wl.<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>(); } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); // onCreate <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the parent <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.v(TAG, "onCreate"); requestWindowFeature(<span class="hljs-keyword"><span class="hljs-keyword">Window</span></span>.FEATURE_NO_TITLE); // App <span class="hljs-keyword"><span class="hljs-keyword">without</span></span> a title getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN); // App <span class="hljs-keyword"><span class="hljs-keyword">without</span></span> a status bar setContentView(R.layout.activity_main); // <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> interface PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE); wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "DoNotDimScreen"); periodText = (TextView) findViewById(R.id.periodText); // <span class="hljs-type"><span class="hljs-type">Text</span></span> fields framerateText = (TextView) findViewById(R.id.framerateText); totalsnapshotsText = (TextView) findViewById(R.id.totalsnapshotsText); startButton = (Button) findViewById(R.id.startButton); // <span class="hljs-keyword"><span class="hljs-keyword">Start</span></span> capture button startButton.setOnClickListener(this); createButton = (Button) findViewById(R.id.createButton); // <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> video button createButton.setOnClickListener(this); nativeButtonColor = createButton.getCurrentTextColor(); createButton.setTextColor(Color.GRAY); periodEditText = (EditText) findViewById(R.id.periodEditText); // Period secondsText = (TextView) findViewById(R.id.secondsText); periodEditText.addTextChangedListener(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TextWatcher() { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> afterTextChanged(Editable s) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (periodEditText.getText().toString().length() == <span class="hljs-number"><span class="hljs-number">0</span></span>) capturePeriod = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isNum(periodEditText.getText().toString().replace(<span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>))) { <span class="hljs-type"><span class="hljs-type">float</span></span> a = <span class="hljs-type"><span class="hljs-type">Float</span></span>.valueOf(periodEditText.getText().toString().replace(<span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>)); capturePeriod = (<span class="hljs-type"><span class="hljs-type">int</span></span>) a; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Toast.makeText(MainActivity.this, periodEditText.getText().toString() + " - not a digit.", Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> beforeTextChanged(CharSequence s, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> count, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span>) { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> onTextChanged(CharSequence s, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">before</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> count) { } }); fpsEditText = (EditText) findViewById(R.id.fpsEditText); // fps EditText fpsText = (TextView) findViewById(R.id.fpsText); fpsEditText.setOnFocusChangeListener(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> OnFocusChangeListener() { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> onFocusChange(<span class="hljs-keyword"><span class="hljs-keyword">View</span></span> v, <span class="hljs-type"><span class="hljs-type">boolean</span></span> hasFocus) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!hasFocus) { // Hide soft keyboard <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> <span class="hljs-keyword"><span class="hljs-keyword">input</span></span> InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE); imm.hideSoftInputFromWindow(fpsEditText.getWindowToken(), <span class="hljs-number"><span class="hljs-number">0</span></span>); } } }); fpsEditText.addTextChangedListener(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TextWatcher() { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> afterTextChanged(Editable s) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fpsEditText.getText().toString().length() == <span class="hljs-number"><span class="hljs-number">0</span></span>) fps = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isNum(fpsEditText.getText().toString().replace(<span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>))) { <span class="hljs-type"><span class="hljs-type">float</span></span> a = <span class="hljs-type"><span class="hljs-type">Float</span></span>.valueOf(fpsEditText.getText().toString().replace(<span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>)); fps = (<span class="hljs-type"><span class="hljs-type">int</span></span>) a; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Toast.makeText(MainActivity.this, fpsEditText.getText().toString() + " - not a digit.", Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> beforeTextChanged(CharSequence s, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> count, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span>) { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> onTextChanged(CharSequence s, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">before</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> count) { } }); modeText = (TextView) findViewById(R.id.modeText); // <span class="hljs-keyword"><span class="hljs-keyword">Show</span></span> comments SharedPreferences settings = getSharedPreferences(PREFS_NAME, <span class="hljs-number"><span class="hljs-number">0</span></span>); // Restore preferences oldLandCommentTextBottom = settings.getInt("oldLandCommentTextBottom", <span class="hljs-number"><span class="hljs-number">0</span></span>); } @Override protected <span class="hljs-type"><span class="hljs-type">void</span></span> onResume() { super.onResume(); // onResume <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the parent <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.v(TAG, "onResume"); preview = (SurfaceView) findViewById(R.id.mSurfaceView); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (camera == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { camera = Camera.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(); camera.startPreview(); } surfaceHolder = preview.getHolder(); surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS); surfaceHolder.setSizeFromLayout(); surfaceHolder.addCallback(this); preview.setVisibility(<span class="hljs-keyword"><span class="hljs-keyword">View</span></span>.VISIBLE); wl.acquire(); Size previewSize = camera.getParameters().getPreviewSize(); aviHeight = previewSize.height; aviWidth = previewSize.width; modeText.setFocusableInTouchMode(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); // <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> focus (<span class="hljs-keyword"><span class="hljs-keyword">and</span></span> hide soft keyboard) modeText.requestFocus(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceChanged(SurfaceHolder holder, <span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">format</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> width, <span class="hljs-type"><span class="hljs-type">int</span></span> height) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.v(TAG, "surfaceChanged"); try { camera.setPreviewDisplay(surfaceHolder); } catch (IOException e) { Toast.makeText(MainActivity.this, "Error 1: " + e.toString(), Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); } camera.startPreview(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceCreated(SurfaceHolder holder) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.v(TAG, "surfaceCreated"); try { camera.setPreviewDisplay(holder); camera.setPreviewCallback(this); } catch (IOException e) { Toast.makeText(MainActivity.this, "Error 2: " + e.toString(), Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); camera.<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>(); camera = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } Size previewSize = camera.getParameters().getPreviewSize(); <span class="hljs-type"><span class="hljs-type">float</span></span> aspect = (<span class="hljs-type"><span class="hljs-type">float</span></span>) previewSize.width / previewSize.height; <span class="hljs-type"><span class="hljs-type">int</span></span> previewSurfaceWidth = preview.getWidth(); LayoutParams lp = preview.getLayoutParams(); //     preview   ,     // camera.setDisplayOrientation(<span class="hljs-number"><span class="hljs-number">0</span></span>); lp.width = previewSurfaceWidth; lp.height = (<span class="hljs-type"><span class="hljs-type">int</span></span>) (previewSurfaceWidth / aspect); preview.setLayoutParams(lp); camera.startPreview(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceDestroyed(SurfaceHolder holder) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.v(TAG, "surfaceDestroyed"); } @SuppressLint("NewApi") @SuppressWarnings("deprecation") <span class="hljs-type"><span class="hljs-type">void</span></span> getDisplaySize() { try { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Build.<span class="hljs-keyword"><span class="hljs-keyword">VERSION</span></span>.SDK_INT &gt;= <span class="hljs-number"><span class="hljs-number">13</span></span>) { Display display = getWindowManager().getDefaultDisplay(); <span class="hljs-type"><span class="hljs-type">Point</span></span> size = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">Point</span></span>(); display.getSize(size); sWidth = size.x; sHeight = size.y; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Display display = getWindowManager().getDefaultDisplay(); sWidth = display.getWidth(); sHeight = display.getHeight(); } } catch (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> e) { Toast.makeText(MainActivity.this, "Error 3: " + e.toString(), Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); } } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> onWindowFocusChanged(<span class="hljs-type"><span class="hljs-type">boolean</span></span> hasFocus) { super.onWindowFocusChanged(hasFocus); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasFocus) { getDisplaySize(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((prevsWidth != sWidth) || (prevsHeight != sHeight)) { // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> orientation changed commentTextBottom = modeText.getTop() + modeText.getHeight(); // Calculate magnification factor <span class="hljs-type"><span class="hljs-type">float</span></span> heightRatio = <span class="hljs-number"><span class="hljs-number">0</span></span>; // Landscape heightRatio = (<span class="hljs-type"><span class="hljs-type">float</span></span>) sHeight / (<span class="hljs-type"><span class="hljs-type">float</span></span>) commentTextBottom; oldLandCommentTextBottom = commentTextBottom; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (heightRatio &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) heightRatio = <span class="hljs-number"><span class="hljs-number">0.7</span></span>f * heightRatio; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> heightRatio = heightRatio / <span class="hljs-number"><span class="hljs-number">0.7</span></span>f; // Adjust fonts periodText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * periodText.getTextSize()); periodEditText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * periodEditText.getTextSize()); secondsText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * secondsText.getTextSize()); framerateText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * framerateText.getTextSize()); fpsEditText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * fpsEditText.getTextSize()); fpsText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * fpsText.getTextSize()); totalsnapshotsText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * totalsnapshotsText.getTextSize()); modeText.setTextSize(TypedValue.COMPLEX_UNIT_PX, heightRatio * modeText.getTextSize()); // <span class="hljs-keyword"><span class="hljs-keyword">Some</span></span> components have <span class="hljs-type"><span class="hljs-type">text</span></span> size a little less startButton.setTextSize(TypedValue.COMPLEX_UNIT_PX, <span class="hljs-number"><span class="hljs-number">0.8</span></span>f * heightRatio * startButton.getTextSize()); createButton.setTextSize(TypedValue.COMPLEX_UNIT_PX, <span class="hljs-number"><span class="hljs-number">0.8</span></span>f * heightRatio * createButton.getTextSize()); // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">comment</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> formed <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (modeText.getText().equals(getResources().getString(R.string.longestComment))) modeText.setText(getString(R.string.modeText)); } prevsWidth = sWidth; prevsHeight = sHeight; } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> onClick(<span class="hljs-keyword"><span class="hljs-keyword">View</span></span> v) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v == startButton) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (workMode == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)) Toast.makeText(MainActivity.this, "Please mount SD card", Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((capturePeriod &lt; PERIODMIN) || (capturePeriod &gt; PERIODMAX)) Toast.makeText(MainActivity.this, "Snapshots period should be " + PERIODMIN + " to " + PERIODMAX + " seconds", Toast.LENGTH_LONG) .<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((fps &lt; FPSMIN) || (fps &gt; FPSMAX)) Toast.makeText(MainActivity.this, "FPS should be " + FPSMIN + " to " + FPSMAX + " frames per second", Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (updateTimer != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) updateTimer.cancel(); try { updateTimer = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Timer(); updateTimer.scheduleAtFixedRate(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TimerTask() { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> run() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((camera != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) &amp;&amp; (workMode == <span class="hljs-number"><span class="hljs-number">1</span></span>)) { camera.takePicture(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, MainActivity.this); } } }, <span class="hljs-number"><span class="hljs-number">0</span></span>, capturePeriod * <span class="hljs-number"><span class="hljs-number">1000</span></span>); } catch (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> e) { Toast.makeText(MainActivity.this, "Error 4: " + e.toString(), Toast.LENGTH_LONG).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(); } // <span class="hljs-keyword"><span class="hljs-keyword">Delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> jpg<span class="hljs-string"><span class="hljs-string">'s try { String sdPath = Environment.getExternalStorageDirectory().getPath() + "/TimeLapseFolder/"; if (DEBUG) Log.v(TAG, "Delete jpg'</span></span>s sdPath = " + sdPath); File saveDir = new File(sdPath); if (saveDir.isDirectory()) { String[] children = saveDir.list(); for (int i = 0; i &lt; children.length; i++) { if (children[i].endsWith(".jpg")) new File(saveDir, children[i]).delete(); } } saveDir.delete(); } catch (Exception e) { Toast.makeText(MainActivity.this, "Error <span class="hljs-number"><span class="hljs-number">5</span></span>: " + e.toString(), Toast.LENGTH_LONG).show(); } lastPicture = 0; workMode = 1; startButton.setText("Stop capture"); modeText.setText("<span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode: capturing"); totalsnapshotsText.setText("Total snapshots: " + String.valueOf(lastPicture)); } } else if (workMode == 1) { workMode = 2; createButton.setTextColor(nativeButtonColor); startButton.setText("<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span> capture"); startButton.setTextColor(Color.GRAY); modeText.setText("<span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode: ready <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>"); } } if (v == createButton) { if (workMode == 2) { if (!Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED)) Toast.makeText(MainActivity.this, "Please mount SD card", Toast.LENGTH_LONG).show(); else if ((capturePeriod &lt; PERIODMIN) || (capturePeriod &gt; PERIODMAX)) Toast.makeText(MainActivity.this, "Snapshots period should be " + PERIODMIN + " <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> " + PERIODMAX + " seconds", Toast.LENGTH_LONG) .show(); else if ((fps &lt; FPSMIN) || (fps &gt; FPSMAX)) Toast.makeText(MainActivity.this, "FPS should be " + FPSMIN + " <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> " + FPSMAX + " frames per second", Toast.LENGTH_LONG).show(); else { workMode = 3; createButton.setTextColor(Color.GRAY); startButton.setTextColor(Color.GRAY); modeText.setText("<span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode: <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> video file, please wait"); new CreateMovieInBackground().execute(); } } } } @Override protected void onSaveInstanceState(Bundle outState) { super.onSaveInstanceState(outState); // onSaveInstanceState method in the parent class if (DEBUG) Log.v(TAG, "onSaveInstanceState"); SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0); SharedPreferences.Editor editor = settings.edit(); editor.putInt("oldLandCommentTextBottom", oldLandCommentTextBottom); editor.commit(); } @Override protected void onRestoreInstanceState(Bundle savedInstanceState) { super.onRestoreInstanceState(savedInstanceState); // onRestoreInstanceState method in the parent class if (DEBUG) Log.v(TAG, "onRestoreInstanceState"); } public void onPictureTaken(byte[] paramArrayOfByte, Camera paramCamera) { new SaveInBackground().execute(paramArrayOfByte); if (DEBUG) Log.v(TAG, "onPictureTaken"); //  ,   ,   .    paramCamera.startPreview(); totalsnapshotsText.setText("Total snapshots: " + String.valueOf(lastPicture)); StatFs stat = new StatFs(Environment.getExternalStorageDirectory().getPath()); long bytesAvailable = (long) stat.getBlockSize() * (long) stat.getAvailableBlocks(); float megAvailable = bytesAvailable / (1024.f * 1024.f); modeText.setText("<span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode: capturing, " + String.valueOf(roundOneDecimal(megAvailable)) + " Mbyte available <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> SD card"); } class SaveInBackground extends AsyncTask&lt;byte[], String, String&gt; { @Override protected String doInBackground(byte[]... arrayOfByte) { try { String sdPath = Environment.getExternalStorageDirectory().getPath() + "/TimeLapseFolder/"; File saveDir = new File(sdPath); if (!saveDir.exists()) saveDir.mkdirs(); lastPicture++; String numWithZeroes = intToString(lastPicture, 7); String curjpg = sdPath + numWithZeroes + ".jpg"; if (DEBUG) Log.v(TAG, "Save jpg sdPath = " + curjpg); FileOutputStream os = new FileOutputStream(curjpg); os.write(arrayOfByte[0]); os.close(); } catch (Exception e) { Toast.makeText(MainActivity.this, "Error <span class="hljs-number"><span class="hljs-number">6</span></span>: " + e.toString(), Toast.LENGTH_LONG).show(); } return (null); } } class CreateMovieInBackground extends AsyncTask&lt;byte[], String, String&gt; { protected void onProgressUpdate(String... values) { modeText.setText("<span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode: rendering " + values[0] + ".jpg"); } protected void onPostExecute(String result) { workMode = 0; totalsnapshotsText.setText("Total snapshots: <span class="hljs-number"><span class="hljs-number">0</span></span>"); lastPicture = 0; String sdPath = Environment.getExternalStorageDirectory().getPath() + "/TimeLapseFolder/"; modeText.setText("<span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode:" + sdPath + "TimeLapseMovie" + intToString(lastVideo, 3) + ".avi <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> rendered"); Handler handler = new Handler(); handler.postDelayed(new Runnable() { public void run() { modeText.setText("<span class="hljs-keyword"><span class="hljs-keyword">Work</span></span> mode: ready <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>"); startButton.setTextColor(nativeButtonColor); } }, 5000); } @Override protected String doInBackground(byte[]... arrayOfByte) { try { File videofile = null; String sdPath = Environment.getExternalStorageDirectory().getPath() + "/TimeLapseFolder/"; // Choosing a name for the file do { lastVideo++; String curavi = sdPath + "TimeLapseMovie" + intToString(lastVideo, 3) + ".avi"; if (DEBUG) Log.v(TAG, "AVI <span class="hljs-type"><span class="hljs-type">name</span></span> = " + curavi); videofile = new File(curavi); } while (videofile.exists()); generator = new MJPEGGenerator(videofile, aviWidth, aviHeight, fps, lastPicture); for (int addpic = 1; addpic &lt;= lastPicture; addpic++) { String numWithZeroes = intToString(addpic, 7); String curjpg = sdPath + numWithZeroes + ".jpg"; publishProgress(numWithZeroes); if (DEBUG) Log.v(TAG, "Rendering jpg sdPath = " + curjpg); Bitmap bmp = BitmapFactory.decodeFile(curjpg); generator.addImage(bmp); } // Delete all jpg's try { if (DEBUG) Log.v(TAG, "<span class="hljs-keyword"><span class="hljs-keyword">Delete</span></span> jpg<span class="hljs-string"><span class="hljs-string">'s sdPath = " + sdPath); File saveDir = new File(sdPath); if (saveDir.isDirectory()) { String[] children = saveDir.list(); for (int i = 0; i &lt; children.length; i++) { if (children[i].endsWith(".jpg")) new File(saveDir, children[i]).delete(); } } saveDir.delete(); } catch (Exception e) { Toast.makeText(MainActivity.this, "Error 7: " + e.toString(), Toast.LENGTH_LONG).show(); } generator.finishAVI(); } catch (Exception e) { Toast.makeText(MainActivity.this, "Error 8: " + e.toString(), Toast.LENGTH_LONG).show(); } return "OK"; } } public void onPreviewFrame(byte[] paramArrayOfByte, Camera paramCamera) { } }</span></span></code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">MJPEGGenerator.java</b> <div class="spoiler_text"><pre> <code class="hljs lua"><span class="hljs-built_in"><span class="hljs-built_in">package</span></span> com.sample.timelapse; // // MJPEGGenerator.java // // Created on April <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">2006</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>:<span class="hljs-number"><span class="hljs-number">48</span></span> PM // // To change this template, choose Tools | Options <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> locate the template under // the Source Creation <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Management node. Right-click the template <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> choose // Open. You can <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> make changes to the template <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the Source Editor. // import java.<span class="hljs-built_in"><span class="hljs-built_in">io</span></span>.ByteArrayOutputStream; import java.<span class="hljs-built_in"><span class="hljs-built_in">io</span></span>.File; import java.<span class="hljs-built_in"><span class="hljs-built_in">io</span></span>.FileOutputStream; import java.<span class="hljs-built_in"><span class="hljs-built_in">io</span></span>.RandomAccessFile; import java.nio.channels.FileChannel; import java.util.ArrayList; import java.util.Arrays; import java.util.List; import android.graphics.Bitmap; // // // @author monceaux // public class MJPEGGenerator { // // Info needed <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> MJPEG AVI // // - size of file minus <span class="hljs-string"><span class="hljs-string">"RIFF &amp; 4 byte file size"</span></span> // int width = <span class="hljs-number"><span class="hljs-number">0</span></span>; int height = <span class="hljs-number"><span class="hljs-number">0</span></span>; double framerate = <span class="hljs-number"><span class="hljs-number">0</span></span>; int numFrames = <span class="hljs-number"><span class="hljs-number">0</span></span>; File aviFile = null; FileOutputStream aviOutput = null; FileChannel aviChannel = null; long riffOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; long aviMovieOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; AVIIndexList indexlist = null; // Creates a new instance of MJPEGGenerator public MJPEGGenerator(File aviFile, int width, int height, double framerate, int numFrames) throws Exception { this.aviFile = aviFile; this.width = width; this.height = height; this.framerate = framerate; this.numFrames = numFrames; aviOutput = new FileOutputStream(aviFile); aviChannel = aviOutput.getChannel(); RIFFHeader rh = new RIFFHeader(); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(rh.toBytes()); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(new AVIMainHeader().toBytes()); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(new AVIStreamList().toBytes()); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(new AVIStreamHeader().toBytes()); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(new AVIStreamFormat().toBytes()); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(new AVIJunk().toBytes()); aviMovieOffset = aviChannel.position(); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(new AVIMovieList().toBytes()); indexlist = new AVIIndexList(); } public void addImage(Bitmap image) throws Exception { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] imagedata = writeImageToBytes(image); int useLength = imagedata.length; long position = aviChannel.position(); int extra = (useLength + (int) position) % <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (extra &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) useLength = useLength + extra; indexlist.addAVIIndex((int) position, useLength); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(useLength))); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(imagedata); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (extra &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; extra; i++) aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } imagedata = null; } public void finishAVI() throws Exception { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] indexlistBytes = indexlist.toBytes(); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(indexlistBytes); aviOutput.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); long size = aviFile.length(); RandomAccessFile raf = new RandomAccessFile(aviFile, <span class="hljs-string"><span class="hljs-string">"rw"</span></span>); raf.seek(<span class="hljs-number"><span class="hljs-number">4</span></span>); raf.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt((int) size - <span class="hljs-number"><span class="hljs-number">8</span></span>))); raf.seek(aviMovieOffset + <span class="hljs-number"><span class="hljs-number">4</span></span>); raf.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt((int) (size - <span class="hljs-number"><span class="hljs-number">8</span></span> - aviMovieOffset - indexlistBytes.length)))); raf.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); } public static int swapInt(int v) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (v &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>) | (v &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) | ((v &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x00FF0000</span></span>) | ((v &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0000FF00</span></span>); } public static short swapShort(short v) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (short) ((v &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | (v &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>)); } public static <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] intBytes(int i) { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] b = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[<span class="hljs-number"><span class="hljs-number">4</span></span>]; b[<span class="hljs-number"><span class="hljs-number">0</span></span>] = (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>) (i &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>); b[<span class="hljs-number"><span class="hljs-number">1</span></span>] = (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>) ((i &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x000000FF</span></span>); b[<span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>) ((i &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x000000FF</span></span>); b[<span class="hljs-number"><span class="hljs-number">3</span></span>] = (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>) (i &amp; <span class="hljs-number"><span class="hljs-number">0x000000FF</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> b; } public static <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] shortBytes(short i) { <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] b = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>]; b[<span class="hljs-number"><span class="hljs-number">0</span></span>] = (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>) (i &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>); b[<span class="hljs-number"><span class="hljs-number">1</span></span>] = (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>) (i &amp; <span class="hljs-number"><span class="hljs-number">0x000000FF</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> b; } private class RIFFHeader { public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'R'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>, <span class="hljs-string"><span class="hljs-string">'F'</span></span>, <span class="hljs-string"><span class="hljs-string">'F'</span></span> }; public int fileSize = <span class="hljs-number"><span class="hljs-number">0</span></span>; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc2 = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'A'</span></span>, <span class="hljs-string"><span class="hljs-string">'V'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> }; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc3 = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'L'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>, <span class="hljs-string"><span class="hljs-string">'S'</span></span>, <span class="hljs-string"><span class="hljs-string">'T'</span></span> }; public int listSize = <span class="hljs-number"><span class="hljs-number">200</span></span>; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc4 = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'h'</span></span>, <span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, <span class="hljs-string"><span class="hljs-string">'l'</span></span> }; public RIFFHeader() { } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(fileSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc2); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc3); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(listSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc4); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIMainHeader { // // // FOURCC fcc; DWORD cb; DWORD dwMicroSecPerFrame; DWORD dwMaxBytesPerSec; DWORD dwPaddingGranularity; DWORD // dwFlags; DWORD dwTotalFrames; DWORD dwInitialFrames; DWORD dwStreams; DWORD dwSuggestedBufferSize; DWORD // dwWidth; DWORD dwHeight; DWORD dwReserved[<span class="hljs-number"><span class="hljs-number">4</span></span>]; // public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'v'</span></span>, <span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-string"><span class="hljs-string">'h'</span></span> }; public int cb = <span class="hljs-number"><span class="hljs-number">56</span></span>; public int dwMicroSecPerFrame = <span class="hljs-number"><span class="hljs-number">0</span></span>; // (<span class="hljs-number"><span class="hljs-number">1</span></span> // / // frames // per // sec) // * // <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">000</span></span>,<span class="hljs-number"><span class="hljs-number">000</span></span> public int dwMaxBytesPerSec = <span class="hljs-number"><span class="hljs-number">10000000</span></span>; public int dwPaddingGranularity = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwFlags = <span class="hljs-number"><span class="hljs-number">65552</span></span>; public int dwTotalFrames = <span class="hljs-number"><span class="hljs-number">0</span></span>; // replace // with // correct // value public int dwInitialFrames = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwStreams = <span class="hljs-number"><span class="hljs-number">1</span></span>; public int dwSuggestedBufferSize = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwWidth = <span class="hljs-number"><span class="hljs-number">0</span></span>; // replace // with // correct // value public int dwHeight = <span class="hljs-number"><span class="hljs-number">0</span></span>; // replace // with // correct // value public int[] dwReserved = new int[<span class="hljs-number"><span class="hljs-number">4</span></span>]; public AVIMainHeader() { dwMicroSecPerFrame = (int) ((<span class="hljs-number"><span class="hljs-number">1.0</span></span> / framerate) * <span class="hljs-number"><span class="hljs-number">1000000.0</span></span>); dwWidth = width; dwHeight = height; dwTotalFrames = numFrames; } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(cb))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwMicroSecPerFrame))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwMaxBytesPerSec))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwPaddingGranularity))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwFlags))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwTotalFrames))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwInitialFrames))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwStreams))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwSuggestedBufferSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwWidth))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwHeight))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwReserved[<span class="hljs-number"><span class="hljs-number">0</span></span>]))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwReserved[<span class="hljs-number"><span class="hljs-number">1</span></span>]))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwReserved[<span class="hljs-number"><span class="hljs-number">2</span></span>]))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwReserved[<span class="hljs-number"><span class="hljs-number">3</span></span>]))); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIStreamList { public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'L'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>, <span class="hljs-string"><span class="hljs-string">'S'</span></span>, <span class="hljs-string"><span class="hljs-string">'T'</span></span> }; public int size = <span class="hljs-number"><span class="hljs-number">124</span></span>; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc2 = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'s'</span></span>, <span class="hljs-string"><span class="hljs-string">'t'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, <span class="hljs-string"><span class="hljs-string">'l'</span></span> }; public AVIStreamList() { } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(size))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc2); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIStreamHeader { // // FOURCC fcc; DWORD cb; FOURCC fccType; FOURCC fccHandler; DWORD dwFlags; WORD wPriority; WORD wLanguage; DWORD // dwInitialFrames; DWORD dwScale; DWORD dwRate; DWORD dwStart; DWORD dwLength; DWORD dwSuggestedBufferSize; // DWORD dwQuality; DWORD dwSampleSize; struct { short int left; short int top; short int right; short int // bottom; } rcFrame; // public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'s'</span></span>, <span class="hljs-string"><span class="hljs-string">'t'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, <span class="hljs-string"><span class="hljs-string">'h'</span></span> }; public int cb = <span class="hljs-number"><span class="hljs-number">64</span></span>; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fccType = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'v'</span></span>, <span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'s'</span></span> }; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fccHandler = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'M'</span></span>, <span class="hljs-string"><span class="hljs-string">'J'</span></span>, <span class="hljs-string"><span class="hljs-string">'P'</span></span>, <span class="hljs-string"><span class="hljs-string">'G'</span></span> }; public int dwFlags = <span class="hljs-number"><span class="hljs-number">0</span></span>; public short wPriority = <span class="hljs-number"><span class="hljs-number">0</span></span>; public short wLanguage = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwInitialFrames = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwScale = <span class="hljs-number"><span class="hljs-number">0</span></span>; // microseconds // per // frame public int dwRate = <span class="hljs-number"><span class="hljs-number">1000000</span></span>; // dwRate // / // dwScale // = // frame // rate public int dwStart = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwLength = <span class="hljs-number"><span class="hljs-number">0</span></span>; // num // frames public int dwSuggestedBufferSize = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwQuality = <span class="hljs-number"><span class="hljs-number">-1</span></span>; public int dwSampleSize = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int left = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int top = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int right = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int bottom = <span class="hljs-number"><span class="hljs-number">0</span></span>; public AVIStreamHeader() { dwScale = (int) ((<span class="hljs-number"><span class="hljs-number">1.0</span></span> / framerate) * <span class="hljs-number"><span class="hljs-number">1000000.0</span></span>); dwLength = numFrames; } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(cb))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fccType); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fccHandler); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwFlags))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(shortBytes(swapShort(wPriority))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(shortBytes(swapShort(wLanguage))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwInitialFrames))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwScale))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwRate))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwStart))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwLength))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwSuggestedBufferSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwQuality))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwSampleSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(left))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(top))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(right))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(bottom))); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIStreamFormat { // // FOURCC fcc; DWORD cb; DWORD biSize; LONG biWidth; LONG biHeight; WORD biPlanes; WORD biBitCount; DWORD // biCompression; DWORD biSizeImage; LONG biXPelsPerMeter; LONG biYPelsPerMeter; DWORD biClrUsed; DWORD // biClrImportant; // public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'s'</span></span>, <span class="hljs-string"><span class="hljs-string">'t'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, <span class="hljs-string"><span class="hljs-string">'f'</span></span> }; public int cb = <span class="hljs-number"><span class="hljs-number">40</span></span>; public int biSize = <span class="hljs-number"><span class="hljs-number">40</span></span>; // same // as // cb public int biWidth = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int biHeight = <span class="hljs-number"><span class="hljs-number">0</span></span>; public short biPlanes = <span class="hljs-number"><span class="hljs-number">1</span></span>; public short biBitCount = <span class="hljs-number"><span class="hljs-number">24</span></span>; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] biCompression = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'M'</span></span>, <span class="hljs-string"><span class="hljs-string">'J'</span></span>, <span class="hljs-string"><span class="hljs-string">'P'</span></span>, <span class="hljs-string"><span class="hljs-string">'G'</span></span> }; public int biSizeImage = <span class="hljs-number"><span class="hljs-number">0</span></span>; // width // x // height // <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> // pixels public int biXPelsPerMeter = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int biYPelsPerMeter = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int biClrUsed = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int biClrImportant = <span class="hljs-number"><span class="hljs-number">0</span></span>; public AVIStreamFormat() { biWidth = width; biHeight = height; biSizeImage = width * height; } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(cb))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biWidth))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biHeight))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(shortBytes(swapShort(biPlanes))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(shortBytes(swapShort(biBitCount))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(biCompression); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biSizeImage))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biXPelsPerMeter))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biYPelsPerMeter))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biClrUsed))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(biClrImportant))); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIMovieList { public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'L'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>, <span class="hljs-string"><span class="hljs-string">'S'</span></span>, <span class="hljs-string"><span class="hljs-string">'T'</span></span> }; public int listSize = <span class="hljs-number"><span class="hljs-number">0</span></span>; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc2 = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'m'</span></span>, <span class="hljs-string"><span class="hljs-string">'o'</span></span>, <span class="hljs-string"><span class="hljs-string">'v'</span></span>, <span class="hljs-string"><span class="hljs-string">'i'</span></span> }; // <span class="hljs-number"><span class="hljs-number">00</span></span>db size jpg image data ... public AVIMovieList() { } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(listSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc2); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIIndexList { public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'x'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span> }; public int cb = <span class="hljs-number"><span class="hljs-number">0</span></span>; public List ind = new ArrayList(); public AVIIndexList() { } @SuppressWarnings(<span class="hljs-string"><span class="hljs-string">"unused"</span></span>) public void addAVIIndex(AVIIndex ai) { ind.add(ai); } public void addAVIIndex(int dwOffset, int dwSize) { ind.add(new AVIIndex(dwOffset, dwSize)); } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { cb = <span class="hljs-number"><span class="hljs-number">16</span></span> * ind.size(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(cb))); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; ind.size(); i++) { AVIIndex <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> = (AVIIndex) ind.get(i); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>.toBytes()); } baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIIndex { public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span> }; public int dwFlags = <span class="hljs-number"><span class="hljs-number">16</span></span>; public int dwOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; public int dwSize = <span class="hljs-number"><span class="hljs-number">0</span></span>; public AVIIndex(int dwOffset, int dwSize) { this.dwOffset = dwOffset; this.dwSize = dwSize; } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwFlags))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwOffset))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(dwSize))); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private class AVIJunk { public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] fcc = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] { <span class="hljs-string"><span class="hljs-string">'J'</span></span>, <span class="hljs-string"><span class="hljs-string">'U'</span></span>, <span class="hljs-string"><span class="hljs-string">'N'</span></span>, <span class="hljs-string"><span class="hljs-string">'K'</span></span> }; public int size = <span class="hljs-number"><span class="hljs-number">1808</span></span>; public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] data = new <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[size]; public AVIJunk() { Arrays.fill(data, (<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>) <span class="hljs-number"><span class="hljs-number">0</span></span>); } public <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] toBytes() throws Exception { ByteArrayOutputStream baos = new ByteArrayOutputStream(); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(fcc); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(intBytes(swapInt(size))); baos.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(data); baos.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baos.toByteArray(); } } private <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>[] writeImageToBytes(Bitmap image) throws Exception { ByteArrayOutputStream stream = new ByteArrayOutputStream(); image.compress(Bitmap.CompressFormat.JPEG, <span class="hljs-number"><span class="hljs-number">100</span></span>, stream); stream.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stream.toByteArray(); } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">activity_main.xml</b> <div class="spoiler_text"><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ads</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/lib/com.google.ads"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@color/appBackgroundColor"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/centerEmptyText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_centerHorizontal</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_centerVertical</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SurfaceView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/mSurfaceView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_toRightOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/centerEmptyText"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SurfaceView</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_toLeftOf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/centerEmptyText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableRow</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/periodRow"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/periodText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:focusable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:focusableInTouchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/periodText"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">requestFocus</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EditText</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/periodEditText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:ems</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:inputType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"numberDecimal"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:singleLine</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/secondsText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/seconds"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableRow</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableRow</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/fpsRow"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/framerateText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:focusable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:focusableInTouchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/framerateText"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EditText</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/fpsEditText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:ems</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:inputType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"numberDecimal"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:singleLine</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/fpsText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/fps"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableRow</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/startButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"?android:attr/buttonStyleSmall"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/startButtonText"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/createButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"?android:attr/buttonStyleSmall"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/createButtonText"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableRow</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/totalsnapshotsRow"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/totalsnapshotsText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/totalsnapshotsText"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableRow</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TableLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/modeText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/baseui_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/longestComment"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AndroidManifest.xml</font></font></b> <div class="spoiler_text"><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.sample.timelapse"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:installLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"preferExternal"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:versionCode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:versionName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.8"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-sdk</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:minSdkVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetSdkVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.VIBRATE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CAMERA"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-feature</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.hardware.camera"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-feature</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.hardware.camera.autofocus"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-feature</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"there.isnt.a.vibrate.feature"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/title_activity_main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"landscape"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://habrahabr.ru/users/devandrew/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DevAndrew</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> noticed that the ij.jar library is needed to compile the project ( </font></font><a href="http://ru.wikipedia.org/wiki/ImageJ"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageJ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is needed for the MJPEGGenerator to work). </font><font style="vertical-align: inherit;">The library is added to the sourceforge project files.</font></font></div><p>Source: <a href="https://habr.com/ru/post/172469/">https://habr.com/ru/post/172469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../172417/index.html">Recommender system: useful text mining tasks</a></li>
<li><a href="../172419/index.html">Creating a video broadcast on JS</a></li>
<li><a href="../172463/index.html">Recognizing gender in images and videos</a></li>
<li><a href="../172465/index.html">Boeing 787 and 500 Gb or in brief about the means of objective control</a></li>
<li><a href="../172467/index.html">Intel division has released an Android version optimized for Intel chips (with UEFI support)</a></li>
<li><a href="../172473/index.html">Distributed rendering</a></li>
<li><a href="../172475/index.html">Check input parameters or indirect references to BASH</a></li>
<li><a href="../172479/index.html">How I used Google Glass: the future, but with monthly updates (part 1)</a></li>
<li><a href="../172481/index.html">Configuring CCBoot v.3 to work in Active Directory</a></li>
<li><a href="../172485/index.html">The collective mind HabraHabra chose the best games of all times and peoples for 2013</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>