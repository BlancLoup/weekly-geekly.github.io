<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Big battalions" in continuous time (battle simulation)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""God is always on the side of the big battalions" - Jacques d'Estamp de Fert√©, French marshal 

 Fig. one 

 Many computer games need to simulate batt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Big battalions" in continuous time (battle simulation)</h1><div class="post__text post__text-html js-mediator-article">  "God is always on the side of the big battalions" - Jacques d'Estamp de Fert√©, French marshal <br><br><img src="https://habrastorage.org/files/5df/5e4/3a2/5df5e43a2c8946caaace39fde0a1c1d9.png">  Fig.  one <br><br>  Many computer games need to simulate battles without displaying their progress on the screen.  For example, it could be a Rogue-like turn-based game in which the computer should count only the outcome of the battle (who won) and the loss of the parties.  Even in interactive games, battles that occur outside of the player‚Äôs field of view can be modeled oversimplified.  I developed an interesting mathematical model for such modeling and present it to readers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The article discusses the "continuous" approach - that is, the forces of the parties are continuous quantities, and their interaction occurs in continuous time.  This allows you to use the methods of the mat.  analysis and get the solution explicitly.  For armies consisting of a large number of combat units, such a simplification does not introduce a large margin of error.  At the same time, the solution explicitly allows us to understand a lot about the problem. <br><a name="habracut"></a><br><h1>  Initial data </h1><br>  Baseline data for battle simulation is usually the strength of the parties ‚Äî the number of soldiers or other combat units.  There are cases of heterogeneous armies consisting of several types of combat units.  But for the time being we will leave these difficulties aside and consider the simplest case: the meeting of two armies consisting of identical soldiers, in equal combat conditions, and differing only quantitatively. <br><br>  Therefore, the initial data we will have two numbers - the number of soldiers in each army at the time of the start of the battle. <br><br><h1>  Interaction model </h1><br>  In real battles, soldiers shoot at each other or attack in melee.  Each act of attack is discrete, the attack can lead to the defeat of the enemy or pass by.  After the attack, the soldier must reload or refocus his gun, or wipe the sword again, i.e.  one way or another, he may not make another attack right away.  The effectiveness of attacks depends on the power of the soldier‚Äôs weapons, the strength of the enemy‚Äôs armor, the agility of both, and other factors.  But all these difficulties without much damage to the accuracy of modeling can be replaced by one factor. <br><br>  Let k be a coefficient that determines how many opponents on average kill each soldier per unit of time.  Practically everything can be taken into account in this coefficient: the improvement of a weapon or accuracy increases k;  armor and dodge of the enemy - reduce;  You can also take into account the influence of the terrain on the battlefield, time of day, etc. <br><br>  It rarely happens that armies consist of completely similar soldiers and are found in absolutely equal conditions.  "The defense is stronger than the offensive" (R. Clausewitz).  Therefore, the coefficient k for each army will be different.  But we will not complicate it yet and assume that the coefficient k is the same for both armies, and later we will generalize the results to the case of different coefficients. <br><br><h1>  Basic equations and their solution </h1><br>  Let x (t) be the number of soldiers of the first army, which decreases as the enemy kills them.  Let y (t) be the number of soldiers of the second army.  Then the interaction model described above can literally be literally translated into a mathematical language: <br><br><img src="https://habrastorage.org/files/d0f/e92/f90/d0fe92f902d74b4ca450b9a6dc641048.png"><br><br>  That is: the rate of loss of soldiers of the first army is proportional to the number of soldiers in the second army, and vice versa. <br><br>  The result was a system of differential equations.  It is easily solved, in particular, with the help of Wolfram Alpha.  Common decision: <br><br><img src="https://habrastorage.org/files/2ce/3e8/7b2/2ce3e87b201b4a2e83b673868be44613.png"><br><br>  Where C1 and C2 are the integration constants that must be found on the basis of the initial conditions.  If the number of soldiers of the first army at the start of the battle t = 0 is x0, and the second army, respectively, y0 - then we substitute and get C1 = x0, C2 = y.  After simplification, the particular solution we need finally looks like this: <br><br><img src="https://habrastorage.org/files/a2a/e9a/979/a2ae9a9794604716b1bcf81b9dcd7968.png"><br><br>  So, we found functions that establish the dependence of the number of remaining soldiers of each of the parties on the time spent in the battle.  An example of the graph of such functions is shown in Fig.  one. <br><br><h1>  Results analysis </h1><br>  What behavior can be expected from the functions obtained? <br><br>  For example, we substitute x0 = y0, i.e.  we will model the battle between equal armies and see what happens.  The term c exp (2 * k * t) is destroyed, and x (t) = y (t) = x0 * exp (-k * t) remains.  Both armies destroy each other exponentially, their numbers decrease very quickly, but they never reach zero.  The battle will last forever, and the infinitesimal number of the remaining soldiers will be compensated by the infinitesimal speed of their loss. <br><br>  If we now substitute different values, for example, x0 = 90 and y0 = 100 (as in Fig. 1), then the term with exp (2 * k * t) will act differently for each army.  That army, which initially had more soldiers, will receive a "supplement" from exp (2 * k * t) in a positive direction, that is, its speed of decline will slow down.  The other army, smaller, will receive the same ‚Äúadditive‚Äù in the minus, so that it will thin out faster.  As a result, in a finite time t1, the number of the weaker army will reach zero.  The battle will end with the defeat of this army. <br><br>  Look at pic again.  1. It can be seen that at the beginning of the graph, both functions decrease approximately equally, since the difference in the number of armies is small.  But gradually the difference in the rate of decline increases, and this is a self-sustaining effect.  A small initial numerical advantage (only 10%) not only ensures victory in the battle, but almost half of the soldiers of the victorious army survive. <br><br>  The result is all the more impressive that the graph in fig.  1 was built based on the value of k = 0.01.  Imagine that time is measured in minutes.  This means that every minute an army soldier kills an average of 0.01 enemy soldiers.  That is, for example, he shoots every minute once, and hits with a probability of 1%.  This is a very low rate of fire and the probability of hitting.  However, the battle ends in about 150 minutes with the complete destruction of a weaker army.  This is all due to the fact that we have exhibitors in the solutions. <br><br>  Calculating x (t) and y (t) after one of these functions has reached zero (that is, after the victory of one of the parties) makes no sense.  So, in particular, when t&gt; t1, x (t) will become less than zero, and y (t) will start to grow.  To know to what value of t to conduct calculations, one should find t1. <br><br><h1>  Derivation of formulas for the victory time t1 and the losses of the winning army </h1><br>  Let us find the moment of the defeat of t1 for the case of x0 &lt;y0.  Substitute x (t1) = 0 into formula (3) and after transformations we get: <br><br><img src="https://habrastorage.org/files/fec/180/966/fec1809660f143a5a573d8249dc37533.png"><br><br>  Now you can bring Matlab-code, which uses formulas (3) and (4) to plot the course of the battle. <br><br><div class="spoiler">  <b class="spoiler_title">Drawing drawing program for fig.</b>  <b class="spoiler_title">one</b> <div class="spoiler_text"><pre><code class="matlab hljs">x0 = <span class="hljs-number"><span class="hljs-number">90</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Number of soldiers in army-1 y0 = 100; % Number of soldiers in army-2 k = 0.01; % Damage to armor factor %---------------------------------- if x0~=y0 t_end = log((x0+y0)./abs(x0-y0))./2./k; else t_end = 1000; end t = [0:floor(t_end) t_end]; x = 0.5*exp(-k*t).*((x0-y0)*exp(2*k*t)+x0+y0); y = 0.5*exp(-k*t).*((y0-x0)*exp(2*k*t)+x0+y0); figure(1); plot(t,x); hold on plot(t,y,'r'); hold off grid on ylim([0 max(x0,y0)]); xlabel('Time') ylabel('Forces remaining') legend({'Player 1','Player 2'}) title('Battle progress')</span></span></code> </pre> </div></div><br>  It is also of interest to find the loss of the winning side.  Substituting the found t1 from formula (4) into formula (3), after transformations, we get: <br><br><img src="https://habrastorage.org/files/875/3f7/2b7/8753f72b7d39460e82204dd17a9fb139.png"><br><br>  In principle, formula (5) is the main result of this article, as it was already clear that the larger army wins, and if we are not interested in the course of the battle, but only its result, then it is necessary to find only the losses of the winning party. <br><br>  It is curious that the losses of the winner do not depend on k, but depend only on the initial balance of forces.  Only the duration of the battle depends on k. <br><br>  Let us try to express the time of the battle and the loss of the winner not through the absolute values ‚Äã‚Äãx0 and y0, but through their ratio.  Let r = x0 / y0 (0 &lt;r &lt;1 for x0 &lt;y0), then x0 = r * y0 and after transformations we get: <br><br><img src="https://habrastorage.org/files/89e/dfa/826/89edfa826bcf4572a246c375729a1cc9.png"><br><br>  Losses of the winner will be found as the ratio of the number of soldiers after the battle to the number of soldiers before the battle: <br><br><img src="https://habrastorage.org/files/2c3/e43/216/2c3e4321679746e28cc095705d95f30f.png"><br><br>  In fig.  2 shows a graph of the function Ry (r): <br><br><img src="https://habrastorage.org/files/f56/103/858/f5610385826b4a999199746899845869.png">  Fig.  2 <br><br>  It can be seen that the victorious army suffers small losses in general, which confirms the thesis on large battalions in the epigraph.  Even with a 10: 9 aspect ratio, almost half of the victorious army survive, and only when r&gt; 0.95, the winner has significant losses, which can be said about ‚ÄúPyrrhic Pobda‚Äù. <br><br><h1>  Generalization in case of unequal combat conditions </h1><br>  Unequal combat conditions (differences in training of soldiers, armaments, armor, defense against offensive, terrain factors) can be taken into account if different coefficients k1 and k2 are introduced in the system of equations (1) instead of one k.  That is, the average rate of extermination of the enemy from the soldiers of each of the armies will differ: <br><br><img src="https://habrastorage.org/files/cc9/0d7/70a/cc90d770a0cc4eb9bf95d8010d371d0d.png"><br><br>  The particular solution of such a system we need, similar to formula (3), looks like this: <br><br><img src="https://habrastorage.org/files/57b/8e8/e5a/57b8e8e5ab3441f5afec192e17b8e410.png"><br><br>  The expressions were more cumbersome, but if we introduce the substitution: p = sqrt (k1 * k2), r = sqrt (k1 / k2) * x0 / y0 - then everything is greatly simplified: <br><br><img src="https://habrastorage.org/files/bff/759/9f5/bff7599f565d4f868d99dd60f3ba854b.png"><br><br>  In principle, if we make a similar substitution for system (3), then systems (3) and (10) will look the same, and the difference between them will be only in the expression for r: for the case of different k1 and k2, the multiplier appears in the expression for r sqrt type (k1 / k2). <br><br>  The victory criterion is now a comparison of r with 1. If r&gt; 1, then the first army (x) wins, if r &lt;1, ‚Äã‚Äãthen the second (y).  With r = 1, both armies are mutually destroyed in infinite time. <br><br>  The time of victory coincides with formula (6) with the only difference that instead of k now p appears: <br><br><img src="https://habrastorage.org/files/28d/51e/d82/28d51ed82d514ca598196388814bf8d8.png"><br><br>  And finally, the remaining soldiers of the winner: the formula (7) is applicable without changes in the case of using a new substitution for r. <br><br><h1>  Conclusion </h1><br>  Simulating battles in continuous functions allows you to get reasonable results with minimal computational overhead.  Even in the more complicated case of unequal battle conditions, the result of the battle can be calculated with just three calls of a square root and several additions, multiplications and divisions.  Computational complexity - O (1). <br><br>  The advantage of the "big battalions" very clearly follows from the above formulas and graphs.  Particularly impressive is the fact that even a small numerical advantage in the model leads to the complete defeat of the enemy with much smaller losses than can be intuitively expected. <br><br>  Why is the outcome of real battles so unpredictable, unlike the model?  Of course, due to the influence of random factors that are unknown during the calculations.  In my model, the effect of randomness can be reflected somewhere in the coefficients k1 and k2.  These coefficients in a decisive way influence the outcome of the battle and can outweigh the balance in one direction or another. <br><br>  The approach proposed by me can be developed in that direction in order to apply a theorem and a mat to it.  statistics.  It would also be interesting to develop a model for heterogeneous armies consisting of several types of troops.  But this is a topic for individual research and a new article.  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/260255/">https://habr.com/ru/post/260255/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260233/index.html">When does not help the DAC. Digital potentiometers in detail. Part one</a></li>
<li><a href="../260237/index.html">Problems mounting CIFS clients when upgrading samba on the server</a></li>
<li><a href="../260239/index.html">Haskell Code Generator</a></li>
<li><a href="../260249/index.html">Programmers and Depression</a></li>
<li><a href="../260253/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ164 (June 8 - 14, 2015)</a></li>
<li><a href="../260257/index.html">PHP Digest 64 - interesting news, materials and tools (June 1 - 14, 2015)</a></li>
<li><a href="../260259/index.html">Ingredients of IoT Fast Food Delicacies: Intel Edison + Intel XDK + JavaScript + Grove Kit</a></li>
<li><a href="../260269/index.html">Antivirus Self-Defense</a></li>
<li><a href="../260271/index.html">Salad "Microsoft Guide for SymbolTable with a delicate aftertaste Antlr4"</a></li>
<li><a href="../260273/index.html">Challenge the tradition of hi-fi. Digital potentiometers in detail. Part two</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>