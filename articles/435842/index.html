<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating gaming 3D models for the poor: the indie way</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Have you ever wondered how a small indie video game studio works? 

 It is possible to create games with a very small budget, but this requires ingenu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating gaming 3D models for the poor: the indie way</h1><div class="post__text post__text-html js-mediator-article">  Have you ever wondered how a small indie video game studio works? <br><br>  It is possible to create games with a very small budget, but this requires ingenuity, a lot of work and even more love for their work. <br><br>  We are a small team from Poland.  There are only three of us, but only two people are engaged in a full-time project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c7/bbd/a99/8c7bbda9999b4823fb207b6cdbfdeb36.jpg"></div><br>  Today we will talk about the character creation process for our game The End of the Sun.  Keep in mind that the screenshots shown in the article are taken from a project that is still in development. <br><br>  This text is devoted only to static elements of the characters: we will describe how the character and clothes were scanned, how additional elements were created, and how we configured the Unity engine to get such screenshots: <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/08a/871/3c5/08a8713c5308e1eb7e7d01e3f3efc4e0.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d81/3d8/8f1/d813d88f11278c3285d981253beb8cd9.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7a0/ad0/d4c/7a0ad0d4c733d6cdde9983cfb0044b2e.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd9/471/984/bd94719848a442afff7c0d937ce2d36b.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dd3/014/2e3/dd30142e35b4348509eb5d9734f533fa.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/76e/d6a/53f/76ed6a53f0777e1a41a41631114fe04a.jpg"></div><br>  But let's start from the beginning.  Before starting work, we prepared a list of properties required by our characters: <br><br><ol><li>  <strong>80% of our game elements are scanned using photogrammetry</strong> .  In addition, we wanted to give our heroes a human appearance, so we decided to scan people's faces. </li><li>  Beautiful hair compatible with Unity game engine. </li><li>  In our game it will be possible to <strong>meet the same character in different periods of his life</strong> .  What does it mean?  We needed to create as many as four versions of characters for each period (child, teenager, adult, elderly).  Therefore, it was important for us to find a way to create older versions of characters as quickly as possible. </li><li>  In order to emphasize the characters Slavic appearance, typical of the places where we live, <strong>traditional folk clothing was also scanned</strong> . </li><li> Some elements that do not exist in the real world or cannot be scanned, we created manually in a standard way (3D modeling). </li><li>  <strong>Each element of the character can be turned on or off</strong> .  What does it mean?  For example, we can replace the character's skirt, take off the hat if it is not needed.  This gives ample opportunities to create a new look - in one cutscene the hero can be shirtless, in the second - fully dressed. </li><li>  Our characters are non-interactive, that is, the player cannot control them (at least, directly).  But this is a game about their history, so it is very important for us to be able to control the entire character with the movement of the facial muscles (this will be discussed in more detail in another post). </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/133/24e/cd3/13324ecd3d12cab002c89c5e9163505d.jpg"></div><br>  In the article we will tell only about one character in a young and elderly state, because in our game the plot is very important and we do not want to spoil the pleasure of the players. <br><br>  So, making a list, you can start working on graphics. <br><br><h3>  1. Photogrammetry of the face and preparation of a three-dimensional body </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9d4/4ea/15f/9d44ea15f552111902577f48b31c358a.jpg"></div><br>  <i>Actress in the process of photogrammetry.</i> <br><br><h5>  Fotogra ... what? </h5><br>  We started by scanning our model's face using <strong>photogrammetry</strong> .  This is a topic for a separate post, but you can learn more about it on our <a href="https://www.youtube.com/channel/UCFoSXpa4XVRZECdn4KCw7UA">youtube channel</a> . <br><br>  Turn to Wikipedia: <br><br><blockquote>  Photogrammetry is a scientific and technical discipline that determines the shape, size, position and other characteristics of objects from their photographic images. </blockquote><br>  In other words: <strong>photogrammetry</strong> is a way to restore the 3D depth over several photos (or multiple images) to create a three-dimensional virtual model that looks like an object in the real world. <br><br>  A large AAA studio with a large budget for scanning a character uses multiple cameras.  They are located around the actor and take a bunch of pictures at about the same time ... <br><br><h5>  ... But what if we only have one camera? </h5><br>  Yes, there is a problem here, and how did we solve it?  Scans created in this way will be worse than working with multiple cameras, but this is enough for us to create a basic face shape and a baked, high-quality texture.  This is an ‚Äúindie way‚Äù of creating photogrammetry. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e98/aa5/ea5/e98aa5ea5e77987917360d346367a6f4.gif"></div><br><h5>  We made many attempts, so here are tips on taking pictures with just one camera: </h5><br>  An actor or actress should not move until you finish taking pictures of your face.  They can't even blink and breathe.  (The shooting usually takes about 10-20 seconds, but this is still difficult to achieve) <br><br>  We had to very quickly take pictures from different sides of the actress.  For this, we used burst mode.  Sometimes there were problems with focusing, but this way to make the fastest pictures so that the actress remained still. <br><br>  It is better to put the actor on a chair with armrests, it is easier to sit still. <br><br>  We took pictures only from the front of the actress.  In the screenshots you can see the photos and the back, but in the final scan we did not use them.  In general, to create a scan <strong>you need only 8-10 good photos in front</strong> . <br><br>  It is also good to use a polarizing filter with the camera, because it reduces the light on the skin, which improves the model's shape and texture. <br><br>  For such a scheme, <strong>use at least four softboxes</strong> to improve the texture and reduce the amount of post-processing. <br><br>  Use the shutter speed as fast as possible to avoid motion blur, as well as the aperture size as small as possible (I mean f.5 and up) to get a wide range of focus on photos.  That is why we need at least four very powerful softboxes.  Of course, the ISO should be as low as possible to avoid noise. <br><br>  We used <strong>Photoscan 3D</strong> software to analyze photos and create models.  This is what a point cloud looks like after photo processing: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1cc/8e2/1e3/1cc8e21e3594c48e3987cfafc594c667.jpg"></div><br>  <i>Point cloud and visualization of the layout of photos.</i> <br><br>  As you can see, there are photos above and below the character, but now I can say that we do not recommend them.  It is much better to make about 8-12 good photos of the front of the face (arc from the left to the right ear).  This gives much better results for the texture and model.  The only <i>drawback</i> is that the neck of the model must be created manually, but this is a small problem. <br><br>  After creating a point cloud, we process it into a <strong>three-dimensional high-poly model</strong> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8eb/525/2b1/8eb5252b1c1745c0d9e33e575363a406.jpg"></div><br>  Already looks better, right?  But on the 3D model you can see a lot of noise: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/66c/55c/64b/66c55c64b61ae4eb2fe361c6361f531c.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e3/e63/386/6e3e633869ddcd48df0f063f6dd9dbc8.jpg"></div><br>  <strong>It occurs for the following reasons:</strong> <br><br>  - Motion blur with very fast snapshots <br><br>  - Micromovements of our actress (yes, even moving a face one millimeter leads to a similar noise) <br><br>  Most of you probably think it looks terrible, and you are right.  That is why we took a few more steps. <br><br>  Now you can do the operation called <strong>"retopologiya</strong> . <strong>"</strong>  This is a technique for creating a 3D model of a simpler and more optimal shape based on a high-poly model. <br><br>  Here is how it looks in practice: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/827/49e/913/82749e913d1cc1f2b1f26b85c32adc43.gif"></div><br>  <i>The rotopology of the character.</i> <br><br>  This is done because the model shown above <strong>contains more than a million triangles</strong> .  A typical computer for work with a frame rate of 30-60 fps is capable of processing 5-6 million.  <em>(This information is given simply for a general understanding, in fact, many other aspects affect performance.)</em> That is, only a few models with so many triangles can be displayed in the game. <br><br>  Another important aspect of retopology is the <strong>creation of a smooth face model</strong> , ready for facial animation.  To perform retopology, we use Topogun 2 software. <br><br>  Here is our face model after retopology (we will polish it later, after texturing): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/78e/8db/22c/78e8db22c05056d58ec7896be1bafb79.jpg"></div><br>  <strong>Then we baked</strong> (in 3D slang, this means simply preparing / creating) the <strong>texture of the face</strong> using our photos. This operation is performed almost automatically.  That is why we decided to use photogrammetry - the face model and good texture make our character natural. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d73/b57/857/d73b57857cdcea27f5dc564b0d792c36.jpg"></div><br>  Hmm, there is still much to be done - as you can see, there are small mistakes in the texture.  Another small problem is the lack of the back of the head and eyes. <br><br>  Therefore, the next step will be to <strong>create unscanned items and items that cannot be scanned, for example eyelashes, hair, eyes.</strong>  So let's find out how this is done.  We use another software package called Cinema 4D.  In this software, we can create the rest of the model and improve its texture. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82b/411/734/82b411734529943fd886b51323a09e03.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0b/bea/44e/f0bbea44eabb14171e813dcb4444b319.jpg"></div><br>  Great, looks much better.  Before we start working on the texture, you need <strong>to create a body with bones for animating</strong> .  (About this in our blog will be a separate post.) <br><br>  For our first character, we created the whole body manually, but it was a completely unnecessary waste of time, especially considering that when we dressed it, bare parts of the body were visible only in rare moments of the game. <br><br>  With a bit of searching, we found a great way to create 3D bodies for our scanned faces.  We use for this task free commercial software <strong>Make human</strong> .  With this software, you can create a whole body, even with the face and skeleton.  It is enough just to move the sliders until you get the desired result, besides, it will have a skeleton compatible with the Unity 3d engine. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7f/264/891/e7f264891d6bab9471844617c862fbd7.jpg"></div><br>  Therefore, in just a few minutes, we got a <strong>whole body with excellent topology and even weights, ready to animate!</strong>  <em>(If you don‚Äôt understand what I‚Äôm talking about, then read the second post about animating the characters that will be released soon!)</em> This is very useful software. <br><br>  The only problem is that <strong>we need to destroy part of the model</strong> , cutting off the head from the body (it sounds scary).  We need to do this in order to replace it with a scanned model. <br><br>  The most important thing here is that, thanks to the software Make human, we have weights on the bones prepared for animating. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a02/86c/890/a0286c890de237ca6e93af8eccda7602.jpg"></div><br>  We just need to <strong>add the bones of the face to be able to animate facial emotions</strong> or to synchronize lip movements with dialogues.  But more about this will soon be the next post on our blog. <br><br>  Creating a proper system of facial bones can take a whole day (yes, I know, there are no bones on the face, but muscles, but this is what they are called in 3D graphics). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e6/059/28d/9e605928ded143802a59d97e1f2d870d.jpg"></div><br>  Of course, to create beautiful textures you also need a lot of work.  We use <b>Frequency Separation Technique</b> in Photoshop to eliminate glares and skin retouching.  This creates a workflow that is well suited for removing unnecessary lighting from textures (even when it is a scanned model of a stone, not a human face).  You should also try this process.  (There is a lot of information about Frequency Separation on the Internet.) <br><br>  <strong>The final Albedo-texture looks like this</strong> : (sorry, but before the release of the game we don‚Äôt want to lay out a high-resolution texture) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/350/d93/e7c/350d93e7cd8e122e0f677b189c864a92.jpg"></div><br>  <i>Albedo-texture</i> <br><br>  <strong>But what a model looks like with an already imposed albedo texture.</strong> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d20/d53/b7b/d20d53b7b710bd45e60b49576f5354d5.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f2/d7e/02b/7f2d7e02b0b58da0edf08be6446a8500.jpg"></div><br>  Now we add <strong>teeth, tongue and eyes:</strong> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9db/9e0/b90/9db9e0b90a4907b8e89fd17b12f99984.jpg"></div><br>  <strong>Here‚Äôs what the finished model looks like from the scanned face and body joined together with the finished texture</strong> (censorship is imposed so that you can share the picture in social networks). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f2e/d13/c49/f2ed13c49cd361f59e7b1140e484b32b.jpg"></div><br>  <i>The finished appearance of the 3D body and face.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/392/aac/730/392aac730a5dc3047986ff3b24428269.png"></div><br><h3>  2. Creation of hair of a head and eyelashes of real time. </h3><br>  I wrote this chapter because creating hair that works and looks good in a video game is a pretty broad topic.  Probably, you could see some of the most beautiful hair in AAA games.  We are indie, so we cannot spend as much time on one aspect of our characters as big companies. <br><br>  Therefore, we <strong>have created hair from polygons with a texture with transparency applied on them.</strong> <br><br>  <strong>How it works?</strong>  First, we model hair-shaped polygons, and then place them on the character's head and move / distribute them using 3D modeling tools.  (In our case, Cinema 4D.) You can also do this in the spline generator - create a spline with a dynamic mesh along it, then the manipulation of the hair is simplified. <br><br>  <strong>So, all hairstyles were created from such parts:</strong> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2df/a3a/cf0/2dfa3acf0f2a3362d1381ffb5711ccbb.jpg"></div><br>  Hair without material look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ba/8bc/3e0/3ba8bc3e0fd9b7e894555949cd5551a3.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/69b/543/370/69b543370175e4ad353b20104da0a63b.jpg"></div><br>  <strong>Here is a hairstyle with a finished texture:</strong> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d4/e6b/4ae/7d4e6b4ae190a2e8a991ae65257a52d6.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/19b/25c/75f/19b25c75faf94ce6429ac6c5de63c984.jpg"></div><br>  And here is the hairstyle from the screenshots, which is shown at the beginning of the post. <br><br>  As you can see, we can <strong>change hairstyles, so there are no problems</strong> , for example, in adding an older character to a young hairstyle. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b7a/efa/6b0/b7aefa6b03dacc3368fdda12853351cd.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/83a/03c/52c/83a03c52c035efd9db0f41b66e9ba876.jpg"></div><br>  Of course, when creating hair, we <strong>use Photoshop and BodyPaint 3d</strong> to draw stripes on hair and elements of different shapes.  You can use any other software, but it would be great if it had an alpha transparency mode in real time.  Then you will see exactly what you are doing (and not just the gray stripes on the character's head). <br><br>  <strong>The hair texture is as follows:</strong> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4bf/e46/e75/4bfe46e756e825ff0f51e391d3202104.jpg"></div><br>  <i>Albedo-hair texture with transparency</i> <br><br>  To give the hair a natural behavior, we tried to use the Unity 3d fabric component on the hair mesh to add a slight wind or gravity effect, but more about this in another post. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f00/c4a/c1d/f00c4ac1d78d7de859ae20f10d3d30af.png"></div><br><h3>  3. Creating older versions of characters </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c7/bbd/a99/8c7bbda9999b4823fb207b6cdbfdeb36.jpg"></div><br>  <strong>"Girl you will be a women soon"</strong> <br><br>  As I said above.  In our game you can meet characters in different stages of their life.  This adds interest to the players, and also forces us to do additional interesting work. <br><br>  I will show how we made a beautiful girl much older.  We watched a lot of videos, pictures and web pages about how the human body is aging. <br><br>  It's not just a matter of wrinkles, the whole face of a person changes its shape.  Read more about this for example <a href="https://www.womenshealthmag.com/beauty/a19926713/how-your-face-changes-as-you-age/">here</a> . <br><br>  In the article I will talk about the technical side of the issue.  So, first we completed the 3D model of the young character with all the bones.  This is very important because it takes a very long time to prepare the skeleton and add weights.  After that, we just copied it and started working with a copy of the model.  Thanks to this workflow, we do not need to re-engage in rigging the older version of the character, because it uses the same skeleton system.  This is much more important in the engine.  Such a system speeds up the loading and unloading of resources, because we load / unload only what we need. <br><br>  So, first we change the base mesh and drop some parts of the face to the ground, as mother gravity does in aging.  Nose, cheeks, eyebrows, ears.  But we are not too keen on, because the model has the same facial bones as the model of the young character.  (That is, if you change the base mesh too much, you may have problems.) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e4/5f3/c51/5e45f3c51988288ed0e383746706f1f4.jpg"></div><br>  <i>Only mesh deformation</i> <br><br>  Then we sculpt large wrinkles and details in some sculpturing software.  For example, you can use free Scupltris.  Then we bake them in a texture called a normal map.  Why?  Because it gives us the result shown below without adding extra triangles to the model.  (So ‚Äã‚Äãthat your PC can handle its processing.) We also create a normal map of some parts based on the skin texture, and then mix them together. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d6d/4aa/d81/d6d4aad81948c286e10f6e6a02cb6246.jpg"></div><br>  <i>Mesh plus normal map</i> <br><br>  Finally, <strong>we add wrinkles to the albedo texture</strong> (the texture with the base color).  We took pictures of several older people, and then added wrinkles to the model using blending in Photoshop. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea1/60e/337/ea160e3373d2844a83757f4db37fbaea.jpg"></div><br>  <i>Mesh plus normal map of large details and albedo-texture of old skin</i> <br><br>  So, as a result, the skin of our model of an elderly character uses the normal part map and albedo texture.  We also prepare the subsurface scattering texture, the light translucency effect through the skin) and the specular map, but in what you see on the screen, only albedo and the normal map are used (mixed into one normal map of large parts + the normal map of parts) . <br><br>  <strong>Here we can see the following parts:</strong> <br><br>  1. Albedo-map. <br><br>  2. A normal map of large parts based on the model's molded parts. <br><br>  3. A normal map of large parts, mixed with skin details created from albedo textures. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/91b/243/dcd/91b243dcd71058795cae4f52aec9fdde.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ffc/6d0/8c5/ffc6d08c5421f63e809042f91b3d838c.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9be/551/ae6/9be551ae6b8e14bdd3cbc6146fecfc68.jpg"></div><br>  The elderly character looks much better in the Unity 3D engine, where we use suitable shaders: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2dc/b78/d7c/2dcb78d7cbcb8e09fc1c78c2c55506cf.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd9/471/984/bd94719848a442afff7c0d937ce2d36b.jpg"></div><br>  But two versions of the character connected in Photoshop (placed in the engine in one place) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/76e/d6a/53f/76ed6a53f0777e1a41a41631114fe04a.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f00/c4a/c1d/f00c4ac1d78d7de859ae20f10d3d30af.png" alt="image"></div><br><h3>  4. Scanning for characters of real clothes. </h3><br>  So, we got almost to the end, but to achieve the final appearance of the character, there is still much to be done. <br><br>  We scanned a lot of different clothes.  The scanning technique is similar to scanning a face or other objects, but now it can be done slowly, <i>usually the</i> clothes do not move (the wind or cats running past can be very annoying, especially when even a small movement can ruin the opening hours). <br><br><h5>  We could not pick up tips or ready-made solutions for the correct scanning of clothes, because here are our tips on what you need and what not to do: </h5><br>  - The most important thing is to secure the design so that the clothes are motionless;  it is even better to arrange the clothes in a stable T-pose.  What does it mean?  This is a posture with arms wide apart, a standard position for game characters to whom animation is applied.  Also in this position is best to scan clothes. <br><br>  For this, we bought a mannequin.  We were not able to immediately find a dummy in the T-pose, so shooting at hand was very difficult, and even more work was required to combine the 3D-models of the scanned clothes with the arms lowered along the bodies of the characters.  Initially, the system looked like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0d7/426/2d1/0d74262d19095bc2d008c3dc65a6cb71.jpg"></div><br>  <i>Our first mannequin with arms down</i> <br><br>  ... so we modified it so that he raised his hands.  We made new hands from PVC pipe.  Here is what our ‚Äútruboneken‚Äù in the T-pose now looks like: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c2a/750/a1f/c2a750a1f0868424b984ef5e483a0a9a.jpg"></div><br>  <i>This mannequin has arms made of PVC and is in a T-pose.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a79/432/107/a79432107d67a127d02b2d366a27aece.jpg"></div><br>  <i>We can shoot this tube to simplify the dressing of the dummy.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/53a/722/500/53a7225006adb67f918534edb7087bfb.jpg"></div><br>  Well, that's fine, but why on our plastic friend these black points? <br><br>  This is because the surface is very shiny, and the point matching scripts in photogrammetry do not like shiny things very much, but they adore points and characteristic features, so we marked so many points with a marker.  This allowed us to better compare the positions of photos in the software in order to get better scans of clothing. <br><br>  This is how clothes look on it, in this case, fur (in T-pose): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/341/a61/e75/341a61e75144b07eac588708aa94eb32.jpg"></div><br>  - The second important aspect when creating clothes using photogrammetry is not to forget to take pictures at hand and below the clothes.  Here are how many photos we had to take to create a pretty good scan of these clothes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/81b/b2d/03e/81bb2d03e7f47d91b912251130446547.jpg"></div><br>  Here you can see the point cloud scan: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ab/6c7/5cc/6ab6c75cc721768b5fd61f15091c7dea.jpg"></div><br>  - Some types of clothing are very difficult to scan, for example, with long fur or from very shiny materials, so sometimes it is easier not to scan them, but to create them manually. <br><br>  For example, to improve the appearance of this fur, we created additional fur elements with alpha transparency channel.  This is similar to what we did with the hair of the characters. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ebd/56e/d3b/ebd56ed3b9ba6a616629242ff731987b.jpg"></div><br>  <i>The red part is the elements of fur, created manually with an alpha channel.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/77a/49b/ebf/77a49bebf4d10fcb215b2fa279df566b.jpg"></div><br>  <i>This is how it looks without texture.</i> <br><br>  - Some types of objects are easier to scan, for example, this matte skirt looks very good because it is made of matte material.  Also here we used HDR images to get more information in the shadows and highlights, but hdr photogrammetry takes a lot of time.  Why?  Because each picture needs to be done with a tripod, otherwise the photos will be blurred.  Now imagine the level of irritation, when after an hour of work one of our cats just jumped on this fur.  We had to start all over again. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d52/cf3/298/d52cf32987876ef41f8ed308e60f03c8.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a0a/cf6/169/a0acf6169989a1ed75d9e1c89322ce6f.jpg"></div><br>  Looks good, right?  In general, the more time you spend on the scan, the better the result you get, and less you do post-processing. <br><br>  - One more elements that are better done manually, and not scanned - this is a belt.  We created them manually.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We made the textures go in cycles, so that even with a small resolution of textures, the quality of the game was high. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/afe/bb6/e2b/afebb6e2bce69da2b6f35afe2bc436e2.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad4/623/f83/ad4623f834a474ca3f81d7c92c3a3b36.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- The wreath was also made similar to the hair, using transparency. </font><font style="vertical-align: inherit;">It is not ready yet, but it can be seen in the screenshots:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/133/24e/cd3/13324ecd3d12cab002c89c5e9163505d.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Well, this is all about clothes. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f00/c4a/c1d/f00c4ac1d78d7de859ae20f10d3d30af.png" alt="image"></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5. Connecting everything in the game engine. </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I said earlier that we use the Unity 3D engine. </font><font style="vertical-align: inherit;">I'll tell you about the shaders and settings we used to make the model look like in the screenshots. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For all the elements of the characters, we now use the free Alloy Shader. </font><font style="vertical-align: inherit;">We chose it because it has everything we need, especially the dissolve option for each variation of the shader and many other options in the segments. </font><font style="vertical-align: inherit;">You can use any other shader, but we use Alloy (besides, it is free).</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8b/3bb/e61/a8b3bbe61eca90dc42a3eab11fea7625.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Different position of the light gives interesting effects</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Skin: for this part of the characters we use a skin shader with the effect of subsurface scattering and transmission of light. </font><font style="vertical-align: inherit;">What is the effect of subsurface scattering? </font><font style="vertical-align: inherit;">This is a simulation of the light transmission factor through the skin. </font><font style="vertical-align: inherit;">Look at the pictures we took:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f7a/aca/cfd/f7aacacfd172c912092890fc54d2d11c.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is how subsurface scattering on a hand in the real world looks like.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As you can see, the lighting (if it is strong enough) passes through the skin. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This gives a very natural appearance, especially in low light. </font><font style="vertical-align: inherit;">You can see how this effect behaves in The End of the Sun on the example of this gif and the screenshots shown above. </font><font style="vertical-align: inherit;">(Note that while the model does not even have a specular texture and a subsurface map, it will look a little better at the final stage.)</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff4/f8d/402/ff4f8d402a1e3542805caf6bcd8e2023.gif"></div><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Eyes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : as you know, eyes are the mirror of the soul. </font><font style="vertical-align: inherit;">And this is true - it is very difficult to give a character a natural look without making his eyes perfect. </font><font style="vertical-align: inherit;">The eye is not just a sphere. </font><font style="vertical-align: inherit;">It is flat where the iris is and the pupil is even lower. </font><font style="vertical-align: inherit;">That is why we use the Parallax shader. </font><font style="vertical-align: inherit;">This is the surface that creates the illusion that there is something else deeper, and it gives very good results!</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9d2/ff0/66e/9d2ff066e07cd03d9cb25d71ddc3ba80.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/365/66e/7ab/36566e7abcf1ecec9fa59dc3075b4fa2.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eyes with an extra large transparent sphere for far-reflection effect</font></font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e4d/6dc/c9f/e4d6dcc9f3bbee4141a5630e80586795.jpg"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eyes without this sphere. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moreover, now we can control the expansion of the pupils, and in the cutscene it creates a very natural look (it scares a little when the pupil is maximally expanded, but for fantasy purposes this effect is still useful).</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/252/407/d26/252407d2689545046ee3b949843ad482.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- And the last thing: since we use one skeleton for all versions of clothes and bodies, we can turn a young character into an elderly person or change his clothes without any problems. </font><font style="vertical-align: inherit;">This creates excellent opportunities for creating cinematic scenes, as well as perfectly optimizes the game.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94c/c99/6b9/94cc996b939400e011d4e0b89376dbd6.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is how we can mix elements of the character created in this way. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- For clothes, we use a double-sided shader so that you can see it on both sides.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b9/a16/3c0/9b9a163c059af062231c7af2cf79b414.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - For hair, we use a special double-sided shader with smooth transparent edges. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f00/c4a/c1d/f00c4ac1d78d7de859ae20f10d3d30af.png"></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. Final results </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Under the cut is a complete gallery of how the final version of the character in the Unity 3D engine looks like: (but it is still in development) </font></font><br><br><div class="spoiler">  <b class="spoiler_title">Gallery</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c7/bbd/a99/8c7bbda9999b4823fb207b6cdbfdeb36.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/08a/871/3c5/08a8713c5308e1eb7e7d01e3f3efc4e0.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/76e/d6a/53f/76ed6a53f0777e1a41a41631114fe04a.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b9/a16/3c0/9b9a163c059af062231c7af2cf79b414.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3af/f19/73d/3aff1973d1e6e33d9e727b45fb248391.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8b/3bb/e61/a8b3bbe61eca90dc42a3eab11fea7625.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7a0/ad0/d4c/7a0ad0d4c733d6cdde9983cfb0044b2e.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9a0/12b/20b/9a012b20b194ffb60721802c4c056971.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d81/3d8/8f1/d813d88f11278c3285d981253beb8cd9.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2dc/b78/d7c/2dcb78d7cbcb8e09fc1c78c2c55506cf.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd9/471/984/bd94719848a442afff7c0d937ce2d36b.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/161/b24/e8a/161b24e8a88c983f900d169ab8f70eca.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dd3/014/2e3/dd30142e35b4348509eb5d9734f533fa.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/133/24e/cd3/13324ecd3d12cab002c89c5e9163505d.jpg"></div></div></div></div><p>Source: <a href="https://habr.com/ru/post/435842/">https://habr.com/ru/post/435842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435830/index.html">OMEGA - Automation of counting time at sporting events</a></li>
<li><a href="../435834/index.html">EXAM - State-of-the-art text classification method</a></li>
<li><a href="../435836/index.html">The largest Wall Street firms have agreed to launch a new exchange to compete with the Nasdaq and the NYSE.</a></li>
<li><a href="../435838/index.html">Lazy functions in javascript</a></li>
<li><a href="../435840/index.html">A small review of SIMD in .NET / C #</a></li>
<li><a href="../435846/index.html">Conferences and hackathons for schoolchildren and students: 11 thematic events</a></li>
<li><a href="../435848/index.html">New devices and technologies from CES 2019 from Microsoft and partners</a></li>
<li><a href="../435854/index.html">Notes phytochemist. Radio banana</a></li>
<li><a href="../435856/index.html">What antiviruses are used in modern firewalls</a></li>
<li><a href="../435858/index.html">Programmable hardware TOTP keys with the ability to synchronize time</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>