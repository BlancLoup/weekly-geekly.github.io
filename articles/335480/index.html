<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn App Shortcuts on Android Nougat 7.1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! I offer you a free translation of the article ‚Äú Exploring Android Nougat 7.1 App Shortcuts ‚Äù by Andrei Catinean . 


 Google released Android...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn App Shortcuts on Android Nougat 7.1</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/d4a/482/f61/d4a482f61a4382dad7b581a14e7d6510.png" alt="image"></p><br><p>  Hi Habr!  I offer you a free translation of the article ‚Äú <a href="https://www.novoda.com/blog/exploring-android-nougat-7-1-app-shortcuts/">Exploring Android Nougat 7.1 App Shortcuts</a> ‚Äù by <a href="https://www.novoda.com/blog/author/andrei-catinean/">Andrei Catinean</a> . </p><br><p>  Google released Android Nougat with version 7.1 (API 25).  There were some interesting features under the hood.  One of these additional features is app shortcuts.  This article will tell you what they are, how they work, and how you can implement them. </p><a name="habracut"></a><br><h3 id="konechnyy-rezultat-vyglyadit-tak">  The end result looks like this: </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/8a8/d77/1c2/8a8d771c27466c3a3185afe6dfcd46a9.gif" alt="image"></p><br><h3 id="chto-takoe-app-shortcuts-i-zachem-oni-nuzhny">  What is the App Shortcuts and why are they needed? </h3><br><p>  Application shortcuts are a means of displaying common actions or tasks of your application on the user's home screen.  Your users can open shortcuts with a long press of the program launch.  From a technical point of view, application shortcuts are a quick and easy way to use intents. </p><br><h3 id="oni-byvayut-dvuh-tipov">  They are of two types: </h3><br><ul><li>  Static: these are shortcuts that are statically defined in the resource file.  <strong>They cannot be changed unless you change the file and deploy the application.</strong> </li><li>  Dynamic: These are shortcuts that are published at runtime.  <strong>They can be updated without having to redeploy the application.</strong> </li></ul><br><p>  By providing your common tasks, you can make it easier for users to quickly return to certain parts of your application without additional navigation and without having to go through activities. </p><br><h3 id="dobavlenie-yarlykov">  Add shortcuts </h3><br><p>  Adding shortcuts to your application is quite simple.  Start by creating a simple static shortcut. </p><br><h4 id="static-shortcuts">  STATIC SHORTCUTS </h4><br><p>  This example assumes that you have already created a project in Android Studio. <br>  Go to AndroidManifest.xml and add the following metadata tag to your main activity: </p><br><pre><code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:supportsRtl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/AppTheme"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.shortcuts"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/shortcuts"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  In the <strong>meta-data</strong> tag, the <em>android: resource</em> key corresponds to the resource defined in the <strong><em>res / xml / shortcuts.xml</em></strong> file.  Here you need to define all your static shortcuts.  Let's add one that will open a certain activity from your application. </p><br><p>  In the example below, I created a dummy <strong>StaticShortcutActivity</strong> : </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcuts</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcut</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/ic_static_shortcut"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:shortcutDisabledMessage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/static_shortcut_disabled_message"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:shortcutId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"static"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:shortcutLongLabel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/static_shortcut_long_label"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:shortcutShortLabel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/static_shortcut_short_label"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.VIEW"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetClass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo.StaticShortcutActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetPackage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcut</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcuts</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><p>  You can see that the root tag of this file is <code>&lt;shortcuts&gt;</code> , which can contain several <code>&lt;shortcut&gt;</code> blocks.  Each of them, as you might have guessed, is a static label.  Here you can set the following properties for a single shortcut: </p><br><ul><li>  <strong>enabled</strong> : As indicated in the title, whether the label is enabled or not.  If you decide to disable the static shortcut, you can either set the value to <em>false</em> or simply remove it from the <code>&lt;shortcuts&gt;</code> . </li><li>  <strong>icon</strong> : The icon that will be displayed on the left side of the shortcut. </li><li>  <strong>shortcutDisabledMessage</strong> : this is the string that will be shown to the user if he tries to start the disabled shortcut.  Note  translator: This can happen when the shortcut is not removed from the main screen of the device. </li><li>  <strong>shortcutLongLabel</strong> : This is a longer version of the label description, which is displayed when there is enough space. </li><li>  <strong>shortcutShortLabel</strong> : a short label description.  This field is required.  This is the text of the label that the user sees on his main screen. </li><li>  <strong>intent</strong> : here you define your intention (or several intentions), which your shortcut will open when clicked. </li></ul><br><p>  Here is how this shortcut will be displayed to the user of your application: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/5af/095/bcf/5af095bcffb425fd2902bfa58e017fc9.gif" alt="image"></p><br><hr><br><p>  Simple and understandable, but if you implement this, then you may notice that when you click on the "back" button, the user returns to the home screen. </p><br><p>  How about going into the app instead?  To do this, we can add several intent tags in the labels we created earlier: </p><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcuts</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcut</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetClass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo.MainActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetPackage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.VIEW"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetClass</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo.StaticShortcutActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetPackage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcut</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shortcuts</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Notice how we added an additional <code>&lt;intent&gt;</code> to what we had, pointing to <em>MainActivity</em> .  This will create a <strong>back stack of</strong> intentions, the last of which will be opened with a shortcut.  In our case, <strong>back stack</strong> looks like <em>MainActivity ‚Üí Static ShortcutActivity</em> , so when you click back, the user goes into MainActivity: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/17e/283/660/17e2836602cce02c99d2dade925310cc.gif" alt="image"></p><br><p>  Adding static shortcuts is pretty simple.  Let's move to dynamic. </p><br><h4 id="dynamic-shortcuts">  DYNAMIC SHORTCUTS </h4><br><p>  As their name suggests, dynamic shortcuts can be changed at runtime without the need to re-open your application.  As you might guess, they are not defined through a static resource ( <del>  shortcuts.xml </del>  ), as static, but created in code. </p><br><p>  Let's add our first dynamic label!  To do this, you will need to use the <a href="https://developer.android.com/reference/android/content/pm/ShortcutManager.html">ShortcutManager</a> and <a href="https://developer.android.com/reference/android/content/pm/ShortcutInfo.Builder.html">ShortcutInfo.Builder</a> .  I will create the first dynamic shortcut in my <em>MainActivity. # OnCreate ()</em> : </p><br><pre> <code class="hljs java"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ ... ShortcutManager shortcutManager = getSystemService(ShortcutManager.class); ShortcutInfo webShortcut = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShortcutInfo.Builder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"shortcut_web"</span></span>) .setShortLabel(<span class="hljs-string"><span class="hljs-string">"novoda.com"</span></span>) .setLongLabel(<span class="hljs-string"><span class="hljs-string">"Open novoda.com web site"</span></span>) .setIcon(Icon.createWithResource(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.drawable.ic_dynamic_shortcut)) .setIntent(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(Intent.ACTION_VIEW, Uri.parse(<span class="hljs-string"><span class="hljs-string">"https://novoda.com"</span></span>))) .build(); shortcutManager.setDynamicShortcuts(Collections.singletonList(webShortcut)); }</code> </pre> <br><p>  In the example above, we use <em>shortcutManager</em> and create a <em>ShortcutInfo</em> .  Using <em>ShortcutInfo.Builder</em> , we can set various properties for the shortcut we want to create.  All the methods we use above are the same as for the static label.  However, one property that is slightly obscure is the label identifier, which is defined in the <em>StaticInfo.Builder</em> constructor as the second parameter, <strong>shortcut_web</strong> .  In the example above, I determined the intent that will open my site.  Finally, I set the dynamic shortcut in the <em>ShortcutManager</em> .  Now let's see how our labels look like: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/aee/87b/31a/aee87b31a6bad6abe57e2d6201fdbd9d.gif" alt="image"></p><br><hr><br><p>  Cool!  Now we have 2 quick shortcuts in our application - one <strong>static</strong> and one <strong>dynamic</strong> . </p><br><p>  Let's add another one that will indicate activity inside the application and see how we can create back stack for it: </p><br><pre> <code class="hljs java"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ ... ShortcutInfo dynamicShortcut = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShortcutInfo.Builder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"shortcut_dynamic"</span></span>) .setShortLabel(<span class="hljs-string"><span class="hljs-string">"Dynamic"</span></span>) .setLongLabel(<span class="hljs-string"><span class="hljs-string">"Open dynamic shortcut"</span></span>) .setIcon(Icon.createWithResource(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.drawable.ic_dynamic_shortcut_2)) .setIntents( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent[]{ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(Intent.ACTION_MAIN, Uri.EMPTY, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, MainActivity.class).setFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(DynamicShortcutActivity.ACTION) }) .build(); shortcutManager.setDynamicShortcuts(Arrays.asList(webShortcut, dynamicShortcut)); }</code> </pre> <br><p>  You can see that now we create <strong>setIntents ()</strong> in the builder to build the back stack: </p><br><ul><li><p>  The first intention corresponds to the <em>MainActivity</em> .  We define the <a href="https://developer.android.com/reference/android/content/Intent.html"><strong>FLAG_ACTIVITY_CLEAR_TASK</strong></a> flag to clear all existing tasks associated with the application and make the <em>MainActivity the</em> current root action. </p><br></li><li>  The second corresponds to <em>DynamicShortcutActivity</em> (an empty activity that I created).  To do this, we need to provide an <strong>Intent with a</strong> specific action, which is defined as a static <em>String</em> in <em>DynamicShortcutActivity</em> and corresponds to the action name <em>intent-filter</em> defined in <em>AndroidManifest.xml</em> for the same activity: </li></ul><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".DynamicShortcutActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Dynamic shortcut activity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.catinean.appshortcutsdemo.OPEN_DYNAMIC_SHORTCUT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  By declaring an array of intentions in this order, we guarantee that when the user returns after opening <em>DynamicShortcutActivity</em> , the <em>MainActivity</em> will be opened. </p><br><p>  What it looks like: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ea3/401/9b8/ea34019b8463c9407d8e9df08ae81b3d.gif" alt="image"></p><br><hr><br><h4 id="shortcut-ordering">  SHORTCUT ORDERING </h4><br><p>  Now that we have 1 static label and 2 dynamic ones, how can we give them an order?  If we take a closer look at the methods of <em>ShortcutInfo.Builder</em> , in particular: <em>setRank (int)</em> .  By setting a custom rank to a dynamic label, we can control the order in which they appear: the higher the rank, the higher the label. </p><br><p>  As an example, let's say we want label # 2 (novoda.com) to be on top.  We can dynamically change the rows of already added dynamic shortcuts.  Let's do this by clicking the button in <em>MainActivity</em> : </p><br><pre> <code class="hljs java">findViewById(R.id.main_rank_button).setOnClickListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View.OnClickListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view)</span></span></span><span class="hljs-function"> </span></span>{ ShortcutInfo webShortcut = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShortcutInfo.Builder(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"shortcut_web"</span></span>) .setRank(<span class="hljs-number"><span class="hljs-number">1</span></span>) .build(); ShortcutInfo dynamicShortcut = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShortcutInfo.Builder(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"shortcut_dynamic"</span></span>) .setRank(<span class="hljs-number"><span class="hljs-number">0</span></span>) .build(); shortcutManager.updateShortcuts(Arrays.asList(webShortcut, dynamicShortcut)); } });</code> </pre><br><p>  In the button listener, we create a new <em>ShortcutInfo</em> for each label that we previously added with the same identifiers, but now we set a higher rank to <strong>shortcut_web</strong> , and a lower rank for <strong>shortcut_dynamic</strong> .  Finally, we use the <em>updateShortcuts (List <code>&lt;ShortcutInfo&gt;</code> )</em> method to update the shortcuts: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/429/62b/aaa/42962baaa959f047f1b65ea0e73c2b3d.gif" alt="image"></p><br><p>  You can see from the above gif that the static label is at the bottom of the list.  Important note: you cannot change the rank of a static label.  They will be shown in the order in which they are defined in the <strong>shortcuts.xml</strong> file.  Since we only have one static label, it has a default rank of 0, which cannot be changed. </p><br><h4 id="extra-bits">  EXTRA BITS </h4><br><p>  If we take a closer look at the <em>setShortLabel (CharSequence)</em> method, we will see that it takes a <strong>CharSequence</strong> as a parameter.  What does it mean?  Well, it means that we can play a little with him :-) </p><br><p>  Suppose we want to change the color to red by clicking on the button created above.  We can create a <em>SpannableStringBuilder</em> and set the <em>foreground</em> color for it to <em>ForegroundColorSpan</em> , then pass the <em>spannableStringBuilder</em> as <em>shortLabel</em> (because <em>SpannableStringBuilder</em> implements <em>CharSequence</em> ): </p><br><pre> <code class="hljs java">findViewById(R.id.main_rank_button).setOnClickListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View.OnClickListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view)</span></span></span><span class="hljs-function"> </span></span>{ ForegroundColorSpan colorSpan = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ForegroundColorSpan(getResources().getColor(android.R.color.holo_red_dark, getTheme())); String label = <span class="hljs-string"><span class="hljs-string">"novoda.com"</span></span>; SpannableStringBuilder colouredLabel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpannableStringBuilder(label); colouredLabel.setSpan(colorSpan, <span class="hljs-number"><span class="hljs-number">0</span></span>, label.length(), Spanned.SPAN_INCLUSIVE_INCLUSIVE); ShortcutInfo webShortcut = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShortcutInfo.Builder(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"shortcut_web"</span></span>) .setShortLabel(colouredLabel) .setRank(<span class="hljs-number"><span class="hljs-number">1</span></span>) .build(); ... } });</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/8a8/d77/1c2/8a8d771c27466c3a3185afe6dfcd46a9.gif" alt="image"></p><br><h3 id="itog">  Total </h3><br><ul><li>  Application shortcuts are great for viewing your application's activities and engaging users. </li><li>  They can be static or dynamic. </li><li>  Static shortcuts are installed and you can update them only when you redeploy the application. </li><li>  Dynamic shortcuts can be changed on the fly. </li><li>  You can create back stack activities for each shortcut. </li><li>  Labels can be reordered, but only in the appropriate type. </li><li>  Static shortcuts will always be at the bottom, as they are added first. </li><li>  Label descriptions accept <em>CharSequence</em> , so you can manipulate them. </li></ul><br><p>  <a href="https://github.com/Electryc/AppShortcutsDemo">Sources of</a> application from the article </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/335480/">https://habr.com/ru/post/335480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335468/index.html">IOTV - a simple HTTP protocol for working with messages and commands of IOT objects in the VIALATM service</a></li>
<li><a href="../335470/index.html">Security Week 32: A spy got into the npm repository, Disney banned from watching children, Juniper patched a one-year bug</a></li>
<li><a href="../335474/index.html">How to get to the TOP: PR to release and in case of failure</a></li>
<li><a href="../335476/index.html">Practical business of ontology: a story c advanced</a></li>
<li><a href="../335478/index.html">Writing extensions for PHP 7 in C ++</a></li>
<li><a href="../335484/index.html">Create a checklist for helpdesk implementation</a></li>
<li><a href="../335488/index.html">Rethinking PID 1. Part 2</a></li>
<li><a href="../335490/index.html">Developing a telegram bot using Spring</a></li>
<li><a href="../335492/index.html">Information economy: why the cost of technology companies is so high</a></li>
<li><a href="../335494/index.html">Accuracy through inaccuracy: Improving Time-objects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>