<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Working with GtkTreeView and GtkListStore using Glade for Beginners</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post I want to tell you about working with very interesting widgets (objects) of the GTK + GUI Library: GtkTreeView and GtkListStore . GtkTree...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Working with GtkTreeView and GtkListStore using Glade for Beginners</h1><div class="post__text post__text-html js-mediator-article">  In this post I want to tell you about working with very interesting widgets (objects) of the GTK + GUI Library: <b>GtkTreeView</b> and <b>GtkListStore</b> .  GtkTreeView is a widget for displaying trees and lists.  GtkListStore is a widget representing a list model. <br>  I will create them with the help of the Glade editor, there is very little material on the Internet specifically for working with GTK + widgets (and especially with these) using this interface editor.  I already wrote a little about working with him.  Those who have never worked with him - I advise you to read <a href="http://habrahabr.ru/blogs/development/107403/">this</a> post. <br><br>  There are a lot of opportunities to work with these widgets and I plan to write a few more articles on this topic (if it will of course interest the readers).  This post is designed for beginners to get acquainted with the GTK + library and its capabilities.  Therefore, today I will consider a fairly simple example. <br><br>  Its meaning will be that we will add data to the object of the GtkListStore class (I will sometimes call it a repository) about a computer game character and display it on the screen in a visual form using GtkTreeView. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage1/97c92fbf/4ed22912/bb1864ca/67af6055.png"><br><a name="habracut"></a><br>  But adding to the GtkListStore will not only be information about the character.  This storage allows you to store various data.  For example, font styles, font name, colors, images, various widget settings.  In this example, I will show how for each individual character to set separately the color of his writing in GtkTreeView (it is also called the tree viewing widget, although in this example we will view the structure of the list format, not the tree view). <br><br>  To begin with, consider the data warehouse - the GtkListStore widget.  It presents a data structure similar to a table (just like a table in a database), each row is a record, the record consists of data (atomic) of different types.  Each column sets its own data type.  Columns are identified by a sequence number: the first column is 0, the second column is 1, the third column is 2, and so on. <br><br>  Usually, an enumeration is created for more understandable access to the storage columns: <br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { NAME = <span class="hljs-number"><span class="hljs-number">0</span></span>, HEALTH, POWER, SELECTED, FONT_COLOR };</code> </pre> <br>  To start, open Glade (for example, I will use version 3.6.7 - from the Ubuntu repository, although there are newer versions that support GTK + 3.0).  Create a form, on the left in the object pane, look for the Window and put it on the workspace.  On the left, on the property panels in the General tab, look for the Window Title and set it as: <i>‚ÄúExample of working with GtkTreeView and GtkListStore‚Äù</i> , in the Common tab, specify Width request and Height requst: <i>650</i> and <i>350,</i> respectively.  Next, you will need to put on it Horizontal Panes, in two compartments which are put Scrolled Window.  You should be able to do this step, as shown in the image below (clickable): <br><br> <a href=""><img src="https://habrastorage.org/storage/habraeffect/ca/49/ca49509b110a5e37e1e772c5af6a568b.png" alt="image"></a> <br><br>  now go to the object panel, click on the Tree Model and look for the List Store - our future storage (GtkLitStore widget). <br><br><img src="https://habrastorage.org/storage/habraeffect/4d/59/4d59b7c221af894db3f6ff2feaf97df0.png" alt="image"><br><br>  By clicking on this widget, it will automatically appear in the widget tree on the right in the Objects tab.  Click on it and look at the properties.  Such settings will appear, though you can scroll even lower and there will be Add and remove rows, but we don‚Äôt need it, because  We will enter the data from the controls (which we will do later). <br><br><img src="https://habrastorage.org/storage/habraeffect/c0/d1/c0d14975aaf99494b1f10f11131df5d5.png" alt="image"><br><br>  First, change the name to <i>liststorePlayers</i> .  Secondly, in Add and Remove Columns we need to add the following columns: Name (name) - string, Health (non-health) - integer, Power (power) - integer, Selection flag (seleted) - logical and font color (colortext) - type of color. <br><br>  So we add the first column name - choose the type <i>gchararray</i> in the Column type, and in the Column name write the <i>name</i> .  Then the second health column - in the Column type we write <i>gint</i> , in the Column name <i>health</i> .  Similarly for <i>power</i> type <i>gint</i> .  Next flag selection - choose the type <i>gboolean</i> , and in the Column name <i>selected</i> .  And then ... And then we are waiting for a little trouble.  We need the font color of the GdkColor type (the structure used in GTK + to represent color).  You look at the large number of possible choices for the type, but GdkColor is not there.  Apparently this is a flaw in the Glade developers and will come to add to ourselves.  If we try to put it in there, it still won't work.  It is necessary to remember that Glade stores the description of the interface in an XML file, and therefore it can be corrected.  So, we create another field of type <i>gchararray</i> , for example, in the Column type we write <i>colortext</i> . <br><br><img src="https://habrastorage.org/storage/habraeffect/70/b5/70b5771ffb9466db38e709e036c59f67.png" alt="image"><br><br>  Save our interface description with the name mainForm and open the resulting file.  We are looking for GtkListStore there. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GtkListStore"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"liststorePlayers"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">columns</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name name --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gchararray"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name health --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gint"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name power --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gint"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name selected --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gboolean"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name colortext --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gchararray"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">columns</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Change our <i>gchararray</i> to <i>GdkColor</i> <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GtkListStore"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"liststorePlayers"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">columns</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name name --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gchararray"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name health --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gint"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name power --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gint"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name selected --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gboolean"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- column-name colortext --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GdkColor"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">columns</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Save and open again in Glade.  We look at the type of the column and see that everything is as we need it: <br><br><img src="https://habrastorage.org/storage1/0a754acc/5de94b04/106e7277/d5e0125a.png"><br><br>  The configuration of the GtkListStore is now complete.  Now we need to make it so that the data can be displayed in a less beautiful form.  To do this, go back to the object panel and look for the Tree View there - this is the GtkTreeView widget. <br><br><img src="https://habrastorage.org/storage/habraeffect/3b/49/3b494a999fd1c55c588f0efae56bc78b.png" alt="image"><br><br>  We put it on the left scrolledwindow (I have it called scrolledwindow1, you can rename all objects in general, but I rename only those that will be used in the code later, in general, it is desirable to rename everything).  After you have taken the Tree View in the object panel and clicking on the left scrolledwindow, you will get a message saying that you should specify the TreeView Model. <br><br><img src="https://habrastorage.org/storage/habraeffect/5f/9f/5f9f0116b6a269fcceb6412811441724.png" alt="image"><br><br>  In our case, the TreeView Model is our repository - the GtkListStore, namely the liststorePlayers widget.  Click <b>...</b> and select <i>liststorePlayers</i> there. <br><br><img src="https://habrastorage.org/storage1/7bdf5b53/106cb872/896054b9/406a0215.png"><br><br>  Click OK for this dialog and for the previous one.  Now we need to set up or it will be more correct to say to link the data from the storage with a specific form of displaying them on the screen.  Click on treeview1 (this is what you call it) on the right panel of objects and go to the top menu where we are looking for Edit. <br><br><img src="https://habrastorage.org/storage/habraeffect/62/d4/62d496d4180be88b87ffa721199e1917.png" alt="image"><br><br>  The edit dialog of our Tree View opens. <br><br><img src="https://habrastorage.org/storage/habraeffect/72/b2/72b268f677b4a53a5081137529e3e1ff.png" alt="image"><br><br>  The General tab contains general properties for the entire Tree View as a whole.  First, change Name to <i>treeviewPlayers</i> .  We also set the Enable Grid Lines property in <i>Horizontal and Vertical</i> - displaying the visual separation of rows and columns.  Go to the tab Hierarcy.  In it, we will link data from the repository with a specific implementation of their display. <br><br><img src="https://habrastorage.org/storage/habraeffect/63/e4/63e46d5ca5e0624e450c10bb8ee291a7.png" alt="image"><br><br>  A bit of theory.  Remember that the columns in the List Store and the columns in the Tree View are completely different things and there is no connection between them.  Specific data is not tied to the columns of the Tree View.  Tree View columns serve more as a logical-visual separation for the output data.  To represent specific data from the repository, <b>GtkCellRenderer</b> class objects are <b>used</b> . <br><br>  In our example, 4 different types of presentation objects will be used: <br>  <b>GtkCellRendererText</b> - plain text to display the name from the repository; <br>  <b>GtkCellRendererProgress</b> - the scale of execution, and if it is more simple - this is the usual ProgressBar, with the help of it we will display health and power from the storage; <br>  <b>GtkCellRendererSpin</b> - the ‚Äúcarousel‚Äù button, with the help of it we will be able to change the power value directly in the Tree View; <br>  <b>GtkCellRendererToggle</b> - the switch button in the cell, with its help we will display the record selection flag. <br><br>  We return to the Glade.  Click the Add button and we will have one column.  In general, you can not add columns in principle.  One is enough, but it will not be very nice and not very flexible in terms of output.  Therefore, we do as follows.  We will have 4 columns: Name, Health, Power, Seleted.  But in the Power column, we will derive the Power value from the repository and in the GtkCellRendererSpin and in the GtkCellRendererProgress. <br><br>  Right-click on the added line: column column and select there Add child Text item.  As a result, you should get the following: <br><br><img src="https://habrastorage.org/storage/habraeffect/bb/93/bb93eed02e91d3689bf7713d02a4ca20.png" alt="image"><br><br>  Thus, we added GtkCellRendererText - to display text content.  Begin to change the properties that are located on the right.  In Name we put the name <i>cellrenderertextName</i> .  Next is the Text property.  Where u is written unset click on the arrows and in the drop-down menu, select the <i>name - gchararray</i> .  Zero means that the column with number 0 is attached from the storage (GtkListStore) with the data stored there (the character name string we specified in the GtkListStore: <i>name</i> of the <i>gchararray</i> type). <br><br><img src="https://habrastorage.org/storage/habraeffect/19/d2/19d2cea415085ff98ad64a223ab95ca0.png" alt="image"><br><br>  Scroll down the list of properties and look for Background color.  I propose to ask it hard, i.e.  for all the rows of this GtkCellRendererText will be the same background color.  To do this, remove the check mark and the color selection button will appear.  Click on it and choose the color that you prefer.  But below is the property Foreground color.  I already suggest to take it from storage.  Thus, for each specific line it will be possible to have a different font color property.  To do this, click on the right unset and select there <i>colortext - GdkColor</i> .  And you should have the number 4. i.  the column number from the GtkListStore where we store the color.  It is also necessary to make it so that you can edit the name directly in the Tree View.  To do this, scroll through the properties even lower and look for Editable there.  Remove the check mark and press the button so that Yes appears.  You should be able to: <br><br><img src="https://habrastorage.org/storage/habraeffect/88/e7/88e7c722f81d6c12d5096dfe087636f5.png" alt="image"><br><br>  I think it has become more or less clear what the essence of the attachment is.  When the property has a tick, then the data is taken from the repository.  By default, all properties are -1, i.e.  Nothing from the GtkListStore repository column takes anything.  Our task is to specify the column number of the storage where the values ‚Äã‚Äãfor the property will be taken from.  If we want to set something hard ourselves, remove the check mark and set it up as we want.  But then these settings will not depend on the data in the GtkListStore and will be applied to absolutely all rows of this view object. <br><br>  Next, create another column.  Click on our first column, it will be highlighted and click Add.  One more column will be added.  If we had allocated our GtkCellRendererText, then one more view object would be added to the first column.  Glade is sometimes a bit uncomfortable.  But that's okay. <br><br>  Now add the view object GtkCellRendererProgress, where we will display the Health - the health of our character using the ProgressBar.  Right-click on the new column and select the Add child Progress item.  Set the Name property in the <i>cellrendererprogressHealth</i> , choose <i>Health - gint</i> in the Value, the number 1 appears - it means the data will be taken from the first column of the GtkListStore. <br><br><img src="https://habrastorage.org/storage/habraeffect/58/ec/58eceb4654d78ab06103cec6aaef54ce.png" alt="image"><br><br>  Set the property Background color.  You can choose the same color as for GtkCellRendererText in the previous step (I did just that) and you can choose your own color.  It may turn out to be a small bug, when you select a color on the button, it will be displayed, and in the line the color code will be # 000000000000.  Dont be upset.  The color is set normally, after you close the edit dialog of this Tree View and open it again, everything will be fine.  A small Glade glitch. <br><br><img src="https://habrastorage.org/storage/habraeffect/73/42/73428088a1ce47ca07feef7f17814aaf.png" alt="image"><br><br>  Now add one more column and insert GtkCellRendererSpin and GtkCellRendererProgress into it (just like we inserted GtkCellRendererText above).  For the first Add child Spin item, for the second Add child Progress item.  <i>Let's name</i> them respectively <i>cellrendererspinPower</i> and <i>cellrendererprogressPower</i> (Name property). <br><br><img src="https://habrastorage.org/storage1/e2154a5d/3c680e93/8ca85b98/408178af.png"><br><br>  Now you need to temporarily close the Tree View Editor window and create a GtkAdjustment widget called <i>adjCellRendererSpinPower for the cellrendererspinPower</i> .  On the object panel, select Adjustment, as shown in the figure below, and it will appear in the widget tree in Objects. <br><br><img src="https://habrastorage.org/storage1/881c6e41/a37eda7f/23329e06/3506f05d.png"><br><br>  In the properties of adjCellRendererSpinPower set the Maximum value: <i>100.00</i> , Page Size: <i>0.00</i> .  Go back to edit mode of our GtkTreeView widget.  Now you need to determine the adjCellRendererSpinPower for cellrendererspinPower.  Uncheck the Adjustment, click <b>...</b> and select adjCellRendererSpinPower. <br><br><img src="https://habrastorage.org/storage1/7430b0f4/c6230821/4fab8aee/1cd3494a.png"><br><br>  Glade has another bad bug.  When you open a new GladeXML file with a description of the interface that we create, this same Adjustment box is reset.  Do not forget about it.  Now we set other properties, let's start with Text.  Choose from the dropdown list <i>power - gint</i> , i.e.  bind from the storage column number 2 with the data with the data on the force. <br><br><img src="https://habrastorage.org/storage1/4b21f7f6/d9a11f06/2e822b60/75eae3ff.png"><br><br>  <i>Yes,</i> we also do <i>Yes</i> : <br><br><img src="https://habrastorage.org/storage1/6fb84ee8/02857414/4fe148bc/c51959e1.png"><br><br>  It is also necessary to set, as for past objects width: <i>60</i> ;  Cell background color: <i># c0c0e5e5e7e7</i> (I remind you that you may have a different color) and Horizontal Padding: <i>5</i> .  Now for the cellrendererprogressPower, set the Text (the displayed text on the scale) and Value (the scale value) also in <i>power - gint</i> . <br><br><img src="https://habrastorage.org/storage1/e537c36f/8c5bdd62/68fd02d0/90ff5ef2.png"><br><br>  And of course, we install as for past objects width: <i>100</i> ;  Cell background color: <i># c0c0e5e5e7e7</i> and Horizontal Padding: <i>5</i> . <br><br>  It remains to add the last object in the GtkTreeView - cellrenderertoggleSelected - widget of the type Toggle (Add Toggle Item).  We correlate its Toggle State property with <i>selected gboolean</i> , with column number 3 from the data store: <br><br><img src="https://habrastorage.org/storage1/f26e7a04/b7adec0a/e8aa6638/c29e60d1.png"><br><br>  Also set the Cell background color: <i># c0c0e5e5e7e7</i> . <br><br>  Lastly, it is necessary to sign the columns, i.e.  set the Column Title property for all.  The corresponding values ‚Äã‚Äãare: <i>Name</i> , <i>Health</i> , <i>Power</i> , <i>Selected</i> : <br><br><img src="https://habrastorage.org/storage1/fad43ae2/4b65e827/b6277f54/bea44e91.png"><br><br>  This completes the GtkTreeView setup.  Now the widget tree will look like this: <br><br><img src="https://habrastorage.org/storage1/d7543dbb/21ee6c10/1ca4eb38/fe127ee4.png"><br><br>  Next, you need to register signal handlers (events) for some GtkTreeView widgets and for it.  Click on the cellrenderertextName widget and go to the Signals tab, look for the event (I‚Äôll still call the signals as events) <i>edited</i> - editing the text field.  Using the drop-down list or manually write the name of the handler for this event <i>on_cellrenderertextName_edited</i> , as shown in the figure below: <br><br><img src="https://habrastorage.org/storage1/cd005040/b398d1bb/97fa8087/d53a9603.png"><br><br>  We do the same for the cellrendererspinPower widget for the edited event. Handler <i>on_cellrendererspinPower_edited</i> - changing the value using the carousel.  For the cellrenderertoggleSelected widget, look for the toggled event - change the state of the switch and select the name of the <i>on_cellrenderertoggleSelected_toggled</i> handler.  And now click on our own treeviewPlayers widget and look for the row_activated tab in the Signals tab.  We write or choose the name of the on_treeviewPlayers_row_activated handler. <br>  Although, in principle, you can, as you prefer, call event handlers. Most importantly, just like in Glade, specify them later in the code. <br><br>  Now you need to add a small dialog box with which you can quickly add new characters and cause other manipulations.  I will not describe in detail the process of creating this menu, because  The purpose of the post is to tell about GtkTreeView and GtkListStore, I‚Äôll just briefly tell you the basic steps and show you how it should end up. <br><br>  First, for scrolledwindow1, we set both the Resize and Shrink properties to <i>Yes</i> (the Packing tab) and Width request to <i>370</i> (the Common tab).  For scrolledwindow2, the Resize property is <i>No</i> , and Shrink is <i>Yes</i> , and Width request is <i>250</i> .  Next, add the GtkViewport widget to scrolledwindow2, and already have a GtkVBox widget (vertical container) consisting of 8 cells.  The first four will be GtkHBox widgets (horizontal container) consisting of GtkLabel (signatures) and control panels: entryName (GtkEntry), spinbuttonHealth (GtkCpinButton), spinbuttonPower (GtkSpinButton) and colorbutFontColor (Gtkkpin) (color GutkSpinButton) and colorbutFontColor (GtkCpinButton), spinbuttonPower (GtkSpinButton), and colorbutFontColor (GtkCpinButton), spinbuttonPower (GtkSpinButton), and colorbutFontColor (GtkCpinButton), spinbuttonPower (GtkSpinButton), and colorbutFontColor (GtkCpinButton)  I explain: it is necessary to add 4 GtkHBox consisting of 2 two cells: one for the signature (left), the other for the control (right) listed above. <br>  The four lower buttons are: butAdd, butDelete, butPrint, butQuit.  For all widgets inside GtkVBox, I recommend setting Expand and Fill properties in <i>No</i> in the Packing tab (these properties are described in my previous <a href="http://habrahabr.ru/blogs/development/107403/">post</a> ).  Also, spinbuttonHealth and spinbuttonPower widgets must be associated with the corresponding GtkAdjustment widgets.  I called them adjHealth and adjPower.  And set the appropriate settings: <br><br><img src="https://habrastorage.org/storage1/46baeaef/c888e299/44d2b7e1/97e1cd6b.png"><br><br>  Linking to spinbuttonHealth and spinbuttonPower occurs by selecting the Adjustment created by <i>adjHealth</i> and <i>adjPower</i> in their properties. <br><br>  All that remains to be done in Glade is to define handlers for the buttons: butAdd, butDelete, butPrint, butQuit.  Click on each widget and in the Event tab for the clicked property, select <i>on_butAdd_clicked</i> , <i>on_butDelete_clicked</i> , <i>on_butPrint_clicked</i> , <i>on_butQuit_clicked</i> . <br><br>  The result should be the following: <br><br><img src="https://habrastorage.org/storage1/42b125f3/88b1b4c6/bd14a3b1/b802e1fb.png"><br><br>  But in general, the whole window of our training application looks like this: <br><br><img src="https://habrastorage.org/storage1/816c8eb7/d7804568/b5679a8c/66373dc3.png"><br><br>  Now we are going to write the code.  All code will be contained in the file Example1.cpp, although you can name it as you like. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdlib.h&gt; #include &lt;gtk/gtk.h&gt; #define UI_FILE "mainForm.glade"</span></span></span></span></code> </pre><br><br>  The structure for working with the repository, which was mentioned at the beginning: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { NAME = <span class="hljs-number"><span class="hljs-number">0</span></span>, HEALTH, POWER, SELECTED, FONT_COLOR };</code> </pre><br><br>  Protopips of event handlers, the names should be the same as we specified in the Signals tab for widgets in the Glade editor.  Because  C ++ compiler is used, then we indicate that they should be linked according to the binding order in the C language. <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butQuit_clicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkWidget *TopWindow, gpointer data)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butAdd_clicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkWidget *window, gpointer data)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butDelete_clicked</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkButton *remove, gpointer data)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butPrint_clicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkWidget *button, gpointer data)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_cellrendererspinPower_edited</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkCellRendererText *render, gchar *path, gchar *new_text, gpointer data)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_cellrenderertoggleSelected_toggled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkCellRendererToggle *render, gchar *path, gpointer data)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_treeviewPlayers_row_activated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkTreeView *treeview, GtkTreePath *path, GtkTreeViewColumn *col, gpointer data)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_cellrenderertextName_edited</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkCellRendererText *renderer, gchar *path, gchar *new_text, gpointer data)</span></span></span></span>;</code> </pre><br><br>  A structure containing pointers to widgets that were created in Glade and will be obtained from GladeXML in the main function. <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainWindowObjects</span></span></span><span class="hljs-class"> {</span></span> GtkWindow *topWindow; GtkTreeView *treeviewPlayers; GtkListStore *liststorePlayers; GtkEntry *entryName; GtkAdjustment *adjHealth; GtkAdjustment *adjPower; GtkColorButton *colorbutFontColor; } mainWindowObjects;</code> </pre><br><br>  In main, we get widgets from the GladeXML format.  Using gtk_tree_selection_set_mode, we set the ability to select multiple lines in GtkTreeView.  We bind our event handlers using the gtk_builder_connect_signals function and at the same time pass pointers to widgets using the mainWindowObjects link.  Thus, as you will see later using the gpointer data pointer, it will be possible to access all widgets from the handler function. <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">** argv)</span></span></span><span class="hljs-function"> </span></span>{ GtkBuilder *builder; GError *error = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; gtk_init( &amp;argc, &amp;argv ); builder = gtk_builder_new(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ! gtk_builder_add_from_file( builder, UI_FILE, &amp;error ) ) { g_warning( <span class="hljs-string"><span class="hljs-string">"%s\n"</span></span>, error-&gt;message ); g_free( error ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>( <span class="hljs-number"><span class="hljs-number">1</span></span> ); } mainWindowObjects.topWindow = GTK_WINDOW(gtk_builder_get_object(builder, <span class="hljs-string"><span class="hljs-string">"topWindow"</span></span>)); mainWindowObjects.treeviewPlayers = GTK_TREE_VIEW( gtk_builder_get_object( builder, <span class="hljs-string"><span class="hljs-string">"treeviewPlayers"</span></span> ) ); mainWindowObjects.liststorePlayers = GTK_LIST_STORE( gtk_builder_get_object(builder, <span class="hljs-string"><span class="hljs-string">"liststorePlayers"</span></span>) ); mainWindowObjects.entryName = GTK_ENTRY( gtk_builder_get_object(builder, <span class="hljs-string"><span class="hljs-string">"entryName"</span></span>) ); mainWindowObjects.adjHealth = GTK_ADJUSTMENT( gtk_builder_get_object(builder, <span class="hljs-string"><span class="hljs-string">"adjHealth"</span></span>) ); mainWindowObjects.adjPower = GTK_ADJUSTMENT( gtk_builder_get_object(builder, <span class="hljs-string"><span class="hljs-string">"adjPower"</span></span>) ); mainWindowObjects.colorbutFontColor = GTK_COLOR_BUTTON( gtk_builder_get_object(builder, <span class="hljs-string"><span class="hljs-string">"colorbutFontColor"</span></span>) ); GtkTreeSelection *selection; selection = gtk_tree_view_get_selection( GTK_TREE_VIEW(mainWindowObjects.treeviewPlayers) ); gtk_tree_selection_set_mode( selection, GTK_SELECTION_MULTIPLE ); gtk_builder_connect_signals (builder, &amp;mainWindowObjects); g_object_unref( G_OBJECT( builder ) ); gtk_widget_show_all ( GTK_WIDGET (mainWindowObjects.topWindow) ); gtk_main (); }</code> </pre><br><br>  Implement a new character handler.  gtk_list_store_append - adds a new line to the model (storage) and returns iter - a link to it (or else it is called an iterator pointing to the line).  And the gtk_list_store_set function sets the cell values ‚Äã‚Äãin the row that iter points to.  Values ‚Äã‚Äãare specified using the enumeration: NAME, HEALTH, etc.  The sign of the end is -1. <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butAdd_clicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkWidget *button, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ MainWindowObjects* mwo = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;MainWindowObjects*&gt;( data ); GtkTreeIter iter; GdkColor color; gtk_color_button_get_color( mwo-&gt;colorbutFontColor, &amp;color ); gtk_list_store_append(GTK_LIST_STORE( mwo-&gt;liststorePlayers ), &amp;iter); gtk_list_store_set(GTK_LIST_STORE( mwo-&gt;liststorePlayers ), &amp;iter, NAME, gtk_entry_get_text(mwo-&gt;entryName), HEALTH, <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;( gtk_adjustment_get_value(mwo-&gt;adjHealth) ), POWER, <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;( gtk_adjustment_get_value(mwo-&gt;adjPower) ), SELECTED, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, FONT_COLOR, &amp;color, <span class="hljs-number"><span class="hljs-number">-1</span></span> ); }</code> </pre><br><br>  Implementing a handler for editing a cell with the name.  Using the gtk_tree_view_get_model function, we get the model (storage) associated with our GtkTreeView.  Using the gtk_tree_model_get_iter_from_string function, we get a reference to the string from the path path (which is in the function signature, for this storage view this path is just the line number that was changed), and then using the gtk_list_store_set already familiar to us, we set the new value, which is in new_text.  In general, the signature of this handler (as well as other handlers) is taken from the official Gtk + <a href="http://developer.gnome.org/gtk/2.24/GtkCellRendererText.html">documentation</a> . <br>  Those.  for each widget, you can find the event signature there (or how they write signal - the signal signature). <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_cellrenderertextName_edited</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkCellRendererText *renderer, gchar *path, gchar *new_text, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ MainWindowObjects* mwo = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;MainWindowObjects*&gt;( data ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( g_ascii_strcasecmp(new_text, <span class="hljs-string"><span class="hljs-string">""</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span> ) { GtkTreeIter iter; GtkTreeModel *model; model = gtk_tree_view_get_model (mwo-&gt;treeviewPlayers); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gtk_tree_model_get_iter_from_string(model, &amp;iter, path) ) gtk_list_store_set(GTK_LIST_STORE (model), &amp;iter, NAME, new_text, <span class="hljs-number"><span class="hljs-number">-1</span></span> ); } }</code> </pre><br><br>  Implementing an event handler using the carousel button.  It is almost the same as described above.  Except that you need to convert a new value to an int.  For simplicity, I used the old C-shnu function atoi, although it could be implemented using stringstream. <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_cellrendererspinPower_edited</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkCellRendererText *renderer, gchar *path, gchar *new_text, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ MainWindowObjects* mwo = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;MainWindowObjects*&gt;( data ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( g_ascii_strcasecmp(new_text, <span class="hljs-string"><span class="hljs-string">""</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span> ) { GtkTreeIter iter; GtkTreeModel *model; model = gtk_tree_view_get_model (mwo-&gt;treeviewPlayers); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gtk_tree_model_get_iter_from_string(model, &amp;iter, path) ) gtk_list_store_set(GTK_LIST_STORE (model), &amp;iter, POWER, atoi(new_text), <span class="hljs-number"><span class="hljs-number">-1</span></span> ); } }</code> </pre><br><br>  Implementing a click handler on a cell with a switch (flag) - 4th column.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Using gtk_tree_model_get, we get the current state of the switch and set the opposite:! Selected </font></font><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_cellrenderertoggleSelected_toggled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkCellRendererToggle *render, gchar *path, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ MainWindowObjects* mwo = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;MainWindowObjects*&gt;( data ); GtkTreeIter iter; GtkTreeModel *model; gboolean selected; model = gtk_tree_view_get_model ( mwo-&gt;treeviewPlayers ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gtk_tree_model_get_iter_from_string(model, &amp;iter, path) ) { gtk_tree_model_get( model, &amp;iter, <span class="hljs-number"><span class="hljs-number">3</span></span>, &amp;selected, <span class="hljs-number"><span class="hljs-number">-1</span></span> ); gtk_list_store_set( GTK_LIST_STORE (model), &amp;iter, SELECTED, !selected, <span class="hljs-number"><span class="hljs-number">-1</span></span> ); } }</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The implementation of the method of printing selected lines. </font><font style="vertical-align: inherit;">Using the gtk_tree_model_get_iter_first function, we get a link to the first line and at the same time we check if the storage is empty (reader flag). </font><font style="vertical-align: inherit;">Using the gtk_tree_model_get method, we obtain the cell values ‚Äã‚Äãof interest to us for the current row, which iter "looks" at. </font><font style="vertical-align: inherit;">Go to the next line using gtk_tree_model_iter_next.</font></font><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butPrint_clicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkWidget *button, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ MainWindowObjects* mwo = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;MainWindowObjects*&gt;( data ); GtkTreeIter iter; gboolean reader = gtk_tree_model_get_iter_first(GTK_TREE_MODEL( mwo-&gt;liststorePlayers ), &amp;iter); g_print( <span class="hljs-string"><span class="hljs-string">"Selected rows:\n"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( reader ) { gboolean selected; gtk_tree_model_get (GTK_TREE_MODEL( mwo-&gt;liststorePlayers ), &amp;iter, SELECTED, &amp;selected, <span class="hljs-number"><span class="hljs-number">-1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( selected ) { gchar* name; gint health; gint power; gtk_tree_model_get (GTK_TREE_MODEL( mwo-&gt;liststorePlayers ), &amp;iter, NAME, &amp;name, HEALTH, &amp;health, POWER, &amp;power, <span class="hljs-number"><span class="hljs-number">-1</span></span>); g_print( <span class="hljs-string"><span class="hljs-string">"%s %d %d\n"</span></span>, name, health, power ); } reader = gtk_tree_model_iter_next(GTK_TREE_MODEL( mwo-&gt;liststorePlayers ), &amp;iter); } }</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">An implementation of a method that double-clicks a row in a GtkTreeView. </font><font style="vertical-align: inherit;">Using the gtk_tree_model_get_iter function, we get the iter from the path, and then we get the data we are interested in using gtk_tree_model_get and output them to the console.</font></font><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_treeviewPlayers_row_activated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkTreeView *treeview, GtkTreePath *path, GtkTreeViewColumn *col, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ GtkTreeModel *model; GtkTreeIter iter; model = gtk_tree_view_get_model( treeview ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( gtk_tree_model_get_iter(model, &amp;iter, path) ) { gchar* name; gint health; gint power; gtk_tree_model_get(model, &amp;iter, NAME, &amp;name, HEALTH, &amp;health, POWER, &amp;power, <span class="hljs-number"><span class="hljs-number">-1</span></span>); g_print( <span class="hljs-string"><span class="hljs-string">"Current row: %s %d %d\n"</span></span>, name, health, power); } }</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This function is auxiliary for deleting selected lines in GtkTreeView. </font><font style="vertical-align: inherit;">gtk_list_store_remove - removes the given line from the list referenced by iter. </font><font style="vertical-align: inherit;">Before this, we extract the path using gtk_tree_row_reference_get_path, and then convert the path to iter using gtk_tree_model_get_iter.</font></font><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remove_row</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkTreeRowReference *ref, GtkTreeModel *model)</span></span></span><span class="hljs-function"> </span></span>{ GtkTreeIter iter; GtkTreePath *path; path = gtk_tree_row_reference_get_path (ref); gtk_tree_model_get_iter (model, &amp;iter, path); gtk_list_store_remove (GTK_LIST_STORE (model), &amp;iter); }</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using the gtk_tree_selection_get_selected_rows function, we get a list of selected lines, then use the while loop to go through each selected line and create a reference based on the path using the gtk_tree_row_reference_new function and add this link to the references list using g_list_prepend. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Call the remove_row function for each link using g_list_foreach. </font><font style="vertical-align: inherit;">And at the end, likewise, using g_list_foreach, we release our lists.</font></font><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butDelete_clicked</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkButton *remove, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ MainWindowObjects* mwo = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;MainWindowObjects*&gt;( data ); GtkTreeSelection *selection; GtkTreeRowReference *ref; GtkTreeModel *model; GList *rows, *ptr, *references = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; selection = gtk_tree_view_get_selection ( mwo-&gt;treeviewPlayers ); model = gtk_tree_view_get_model ( mwo-&gt;treeviewPlayers ); rows = gtk_tree_selection_get_selected_rows (selection, &amp;model); ptr = rows; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (ptr != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { ref = gtk_tree_row_reference_new (model, (GtkTreePath*) ptr-&gt;data); references = g_list_prepend (references, gtk_tree_row_reference_copy (ref)); gtk_tree_row_reference_free (ref); ptr = ptr-&gt;next; } g_list_foreach ( references, (GFunc) remove_row, model ); g_list_foreach ( references, (GFunc) gtk_tree_row_reference_free, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); g_list_foreach ( rows, (GFunc) gtk_tree_path_free, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); g_list_free ( references ); g_list_free ( rows ); }</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Implementing GTK + Application Close Handler </font></font><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_butQuit_clicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GtkWidget *window, gpointer data)</span></span></span><span class="hljs-function"> </span></span>{ gtk_main_quit(); }</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To compile, you need to create a makefile: </font></font><br><pre> <code class="bash hljs">CC=g++ LDLIBS=`pkg-config --libs gtk+-2.0 gmodule-2.0` CFLAGS=-Wall -g `pkg-config --cflags gtk+-2.0 gmodule-2.0` example1: example1.o $(CC) $(LDLIBS) example1.o -o example1 example1.o: example1.cpp $(CC) $(CFLAGS) -c example1.cpp clean: rm -f example1 rm -f *.o</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now you can compile this example and try to ‚Äúplay around‚Äù with what we have done. </font><font style="vertical-align: inherit;">I advise you to run from the console distribution of your Linux distribution. </font><font style="vertical-align: inherit;">Try to add a few characters, choosing different colors of their name. </font><font style="vertical-align: inherit;">Try to select several lines in the 4th column and click Print, then the selected ones will be printed in the console. </font><font style="vertical-align: inherit;">Try changing the Power value using the carousel (double click on it, to the left of the Progress bar). </font><font style="vertical-align: inherit;">Try using the pressed Ctrl or Shift keys to select a few added lines and delete them by pressing Delete. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This example can be downloaded </font></font><a href="https://bitbucket.org/goran_src/example1/src"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compilation is done with the command:</font></font><br><pre> <code class="bash hljs">$ make</code> </pre><br><br>  Run: <br><pre> <code class="bash hljs">$ ./example1</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I tried to describe as many things as possible in some detail (some may even be too), but all this was done to understand this topic more quickly. </font></font></div><p>Source: <a href="https://habr.com/ru/post/116268/">https://habr.com/ru/post/116268/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116261/index.html">iPad for young parents</a></li>
<li><a href="../116262/index.html">Rails. Adding an element when using nested attributes</a></li>
<li><a href="../116264/index.html">The Festo development team created the SmartBird robot robot</a></li>
<li><a href="../116266/index.html">Calculating the number of comments</a></li>
<li><a href="../116267/index.html">Footer pressed to the bottom of the page</a></li>
<li><a href="../116269/index.html">Time management is really easy.</a></li>
<li><a href="../116270/index.html">COBOL (Part 4.) - IF and his friends ...</a></li>
<li><a href="../116271/index.html">Increased performance of lsi logic sas1064E</a></li>
<li><a href="../116272/index.html">Japanese Tweet Speaking</a></li>
<li><a href="../116274/index.html">HTML vs. Plain / text</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>