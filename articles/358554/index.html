<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Confrontation: results</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The long-awaited ‚ÄúOpposition‚Äù cyber-battle took place, which unfolded on the basis of the eighth annual information forum Positive Hack Days. We speak...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Confrontation: results</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/p2/9z/oz/p29zozqgy2xzgm9lmy9vukgyfac.png"><br><br>  The long-awaited ‚ÄúOpposition‚Äù cyber-battle took place, which unfolded on the basis of the eighth annual information forum Positive Hack Days.  We speak on behalf of the direct participants of the competition - the teams of the Jet Secuirty Team and the Jet Antifraud Team, about the brightest technical details of the hacker-defenders contest.  Dirty tricks of the attackers, non-standard ways of hacking, clever traps and surprises of the defenders - all this awaits you under the cut. <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/c4/la/qn/c4laqnc-tdomis1lvag-8pqtbd4.jpeg"><br><br>  The participants of the competition were three structures, based on their role in the ‚ÄúConfrontation‚Äù: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  team of attackers: their goal is to gain unauthorized access to infrastructure, to destabilize the operation of systems and to clean out bank accounts; </li><li>  team of defenders: the main goal is to prevent hackers from successfully attacking the protected objects of the urban infrastructure; </li><li>  Observers: carry out operational monitoring of suspicious information security events and notify defenders about incidents. </li></ul><br>  Jet Infosystems was represented by two defense teams - the Jet Security Team and the Jet Antifraud Team.  The task of the former was to protect the SCADA refinery, the latter dealt with the identification of fraud in the financial transactions of the residents of the virtual city. <br><br><img src="https://habrastorage.org/webt/wk/5j/f9/wk5jf9qimh6hmfk_-zk0ykkhisc.jpeg"><br><br>  The attackers were represented mainly by several CTF teams. <br><br><img src="https://habrastorage.org/webt/z1/07/zz/z107zziqntt9lcwgnqdeo8xwoe8.jpeg"><br><br><h3>  Confrontation, day one </h3><br>  On the first day, the attackers were actively engaged in the exploration of the network infrastructure and unsuccessful attempts to attack the protected infrastructure in the forehead. <br><br>  The first was attacked by one of the offices of the city, according to legend, is without protection.  Attackers gained access to office workstations through the now classic exploits SambaCry (CVE-2017-7494) and EternalBlue / MS17-010 (CVE-2017-0144). <br><br><img src="https://habrastorage.org/webt/lt/eo/sl/lteoslsqgbqykftaeu9m4vgqbes.png"><br><br>  Also, the attackers actively ‚Äúbrute‚Äù the service credentials, administrative and user accounts.  They managed to access TeamViewer. <br><br>  Web applications were also a tasty morsel - attackers tried to pinpoint critical content using tools like dirbuster, exploit the XXE (XML External Entity) vulnerability, and many others. <br><br>  The organizers did not pass over the fresh vulnerability of Drupalgeddon2 - the attackers were able to successfully exploit this attack vector and flood the so-called.  web shells to web server. <br><br>  The Jet Antifaud Team team managed to block 4 illegal transactions - these were the attempts of the attackers' pen before the attack of the next day. <br><br><img src="https://habrastorage.org/webt/ce/io/fp/ceiofpbxkyygrhjjcqw8upd-0yc.jpeg"><br><br>  In addition to observer monitoring systems (SOC), it was possible to identify and muffle the activity of the attackers, using several techniques.  offensive defenses against manually created (zip-bombs, bankmodule.exe module, containing back-connect functionality) to the automated system TrapX. <br><br><img src="https://habrastorage.org/webt/fa/qp/cb/faqpcbomenfi_-mxb4cgpzpw4me.jpeg"><br><br>  The TrapX Deception in Depth architecture is used for disinformation, distraction and detection of sophisticated criminals and is new generation honeypots.  This is achieved through the use of masking techniques, including the creation of automatic false markers (baits), as well as traps with medium and high levels of interaction (false targets).  It attracts attackers by introducing hidden traps and markers.  Pitfalls look in every sense identical to real working IT assets and connected loT devices.  All of these factors disorient intruders, creating and maintaining an imitation of real network traffic between traps. <br><br><img src="https://habrastorage.org/webt/gn/bg/q4/gnbgq4ure8w1cqp75ksace3nymk.png"><br><br>  The attackers managed to compromise the access point, which was included in the protected network through 2 intermediate network devices (that is why the Wi-Fi point leading to the ACS TP segment was not immediately detected).  Once in the network 172.20.5.0/24, the attacker began to carefully, trying not to attract attention, to scan the network without going beyond its limits and not touching the gate. <br><br><img src="https://habrastorage.org/webt/11/mc/ah/11mcahqbbyqjltcuecgk9tqjyqq.png"><br><br>  Thanks to the deployed traps in this network segment, its scanning was easy to detect.  However, no other traces on the network have been identified. <br><br>  Also, when scanning on traps, an attempt was discovered to exploit the EternalBlue vulnerability, since network balls were opened on the traps without authorization. <br><br><img src="https://habrastorage.org/webt/r2/0p/ot/r20pot0chcnygndwslm3347xbxq.png"><br><br>  Then the attacker began to change his IP address and scan the network again.  This was repeated 3-4 times, and each time the scan was more massive, the ‚Äúattacker‚Äù no longer tried to hide his presence in this network segment. <br><br><img src="https://habrastorage.org/webt/um/ec/sg/umecsgcjfttjhcbsst6o5umyoiy.png"><br><br>  Early detection of the attacker helped to respond in time to find his connection point.  Upon detection, the Wi-Fi point was immediately turned off, and then the password was changed to a more complex one. <br><br>  During the night, scans within the network were also detected, but it turned out to be the organizers who inventory the network.  Addresses of scanners are added to the white list in TrapX. <br><br><img src="https://habrastorage.org/webt/cs/cg/wb/cscgwbvsacv-sbtgnjvzcikhsfw.png"><br><br>  A more interesting case was last year.  At the end of the confrontation, the organizers let the attackers into the automated process control system segment via Wi-Fi, suggesting just attacking vulnerable hosts, among which were completely outdated systems, for example, Windows XP, which was forbidden to patch.  The attackers had about 40 minutes left.  Going into the network and scanned it, they came across traps, attracting again with its open network resources.  Watching the actions of the ‚Äúintruders‚Äù in the TrapX interface, it was clear that they spent at least 5-7 minutes on each trap in order to understand that nothing useful could be obtained from this host.  It also revealed attempts to exploit vulnerabilities and copy malicious files to the host.  The files were automatically placed in the TrapX sandbox and analyzed.  All of them could be downloaded later for a detailed analysis and investigation of the actions of the attackers.  Due to the fact that the attackers are bogged down in traps, they did not have time to attack real targets. <br><br>  Also, all traps were scattered bait with fake accounts and addresses of other traps.  The lures were located on real hosts to knock the attackers out of the way.  After the hackers tried to use their credentials, they were immediately displayed in the SIEM system. <br><br><h3>  Standoff night </h3><br>  Night is the time for dirty tricks.  At night, the attackers launched a raid into the camp of the defenders of the virtual city and connected directly to the virtual city system.  Despite the fact that they were driven away by the huge fighting humanoid robots, the attackers were able to realize several attack vectors.  Including getting a password from the access point. <br><br>  As I wrote earlier, the <a href="https://habr.com/company/jetinfosystems/blog/354884/">city ‚Äã‚Äãfalls asleep, hackers wake up</a> - at night the intensity of the attacks has increased significantly.  The attacking teams hoped that the defenders would lose their vigilance and allow systems to be compromised. <br><br><img src="https://habrastorage.org/webt/b8/wj/je/b8wjje30mtwczdlvr3lug19zq0y.jpeg"><br><br><h3>  Confrontation, the second day </h3><br>  On the last day of "Confrontation", hackers made maximum efforts to attack the infrastructure. <br><br>  ‚ÄúWe must pay tribute to the attackers, they were experienced and trained guys.  On the second day of the confrontation, the attack team was able to gain access to the operator‚Äôs station through a TeamViewer session of the contractor who, according to legend, set up the process control system.  After unsuccessful attempts to install malware, they made a network scanner using a notepad and ping command in 5 minutes.  The guys off!  Participation in such a competition requires a concentrate of knowledge, effort, experience and ingenuity for all members of the defense team.  In this ‚Äúbattle,‚Äù we used the arsenal of what we use when implementing projects to protect our real customers, ‚Äùcommented the participation of the captain of the Jet Security Team, Ilya Sapunov, deputy head of the Jet Systems Infosystems Design Department. <br><br>  The attackers entrenched themselves at the compromised AWP SCADA and examined the subnet for new targets.  What is noteworthy is that the attackers used what was at hand (since loading nmap, Metasploit, etc., blocked anti-virus tools): using the ping command, they detected ‚Äúlive‚Äù hosts. <br><br><img src="https://habrastorage.org/webt/np/gt/sp/npgtsp3v48tyqf1hynknkaqoo2o.jpeg"><br><br>  One of the teams in the attacked network raised a VPN server to connect the booster from the external Internet.  Others merged control programs and control system specifications from torrents. <br><br>  The attackers on the financial system also became more active - the defenders from the Jet Antifaud Team team repulsed several thousand illegitimate transactions. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/RfxiGGeHK8U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  To prevent fraudulent transactions, the Jet Detective software was used, in which the entire volume of transaction data was analyzed using both expert rules and ML models.  Jet Detective has a set of algorithms for detecting illegal actions, developed on the basis of the experience of specialists in combating fraud. <br><br>  Experts were helped by mathematical models to cope with the huge flow of data.  Three variants of the models were used in the solution: the classic ‚Äúwith the teacher‚Äù, which allows to identify events similar to the fraud previously identified;  models aimed at identifying anomalies in the behavior of business objects and the flow of various processes, both trainees and experts;  business process control models aimed at identifying anomalies in technological and process chains of actions that allow to assess the tolerances from the standard conduct of a particular operation or their sequence. <br><br>  The business objects with which the system works are data combined from various sources into a holistic business entity (for example, ‚ÄúCustomer‚Äù, ‚ÄúPayment‚Äù, ‚ÄúService point‚Äù, etc.).  The system forms a profile of the typical behavior of the object and identifies deviations from it.  In this way, suspicious events that have not previously been recorded are detected. <br><br>  Despite the hacker's active attacks on the financial system, especially those that had intensified at night, the defenders of the Jet Antifraud Team team repulsed several tens of thousands of illegitimate transactions, not allowing any of them to take place.  Given that not a single component of the classical information security system was installed in the protected ‚Äúbank‚Äù.  At the end of the 30-hour non-stop competition, the organizers decided to turn off the antifraud system in order to give the attackers the opportunity to implement some of the attacks on withdrawing money from the accounts of city residents.  Taking advantage of this fact in the end and became the winners of the "Confrontation" by the attackers. <br><br>  ‚ÄúThese were very tense 2 days.  And if on the first day of the attacks there were very few, which gave us a good amount of time to train the components and pick up the statistics, then the night, like last year, was full of attacks.  Someone was playing a fairly straightforward game, trying to withdraw money to the target accounts of the attacking teams, someone clearly tested our mechanisms for vulnerabilities, trying various options for operations, tangling traces through the internal accounts, - said Alexei Sizov, captain of the Jet Antifraud Team, boss of Jet Infosystem's anti-fraud solution implementation department, - It‚Äôs generally quite difficult to make quality decisions when incorrect blocking of operations is immediately reflected on your account - the organizers did a lot to get the anti-fraud  l closest to the battle mode and sizable flows of legitimate operations on updating mobile operator accounts, utility payments and operations just "law-abiding citizens," did not allow analysts to relax for a minute.  But the result speaks for itself: in 29 hours not a single missed operation, and for every 1000 fraudulent attempts there are only a few false positives, and after our disconnection - more than 60,000 operations and the withdrawal of all the ‚Äústocks‚Äù of the bank in just 20 minutes. ‚Äù <br><br>  With the Jet Detective system running, the attacker failed to carry out any illegitimate transaction.  Only after a complete shutdown of the system, were the attackers able to transfer funds to their account.  This was succeeded by the Hack.ERS team at the very end of the competition, quickly taking the first place.  Just like in life - if you do not protect the finances, they will be immediately taken away. <br><br><h3>  Impressions: </h3><br>  <b>Alexey Sizov, captain of Jet Antifraud Team,</b> head of the department for implementing solutions to counter fraud of Jet Infosystems: ‚ÄúThe impressions are unforgettable, our result speaks for itself.  However, in our segment, some attacking teams clearly lacked time and experience in attacking banking mechanisms.  At night, I wanted to give an attacker a couple of options for attempts.  Brute force allowed us to achieve a result after our disconnection, but there were still many more interesting options.  We will wait for their implementation next year) " <br><br>  <b>Ilya Sapunov, captain of the Jet Security Team:</b> ‚ÄúThe event passed in different directions.  There was a preparation in a very short time.  The serious composition of the enemy kept our team in suspense and constant readiness.  Unfortunately, the time for the development of attacks from the attackers was significantly limited.  I hope that the next event will result in a more active and dense confrontation. ‚Äù <br><br><h3>  Conclusion </h3><br>  The Opposition contest is one of the most exciting events in the Russian information security community, which allows you to test your skills in real-time both in penetration and in protection of critical infrastructure, to confirm the correctness of the chosen decisions and tactics. <br><br>  See you next year! </div><p>Source: <a href="https://habr.com/ru/post/358554/">https://habr.com/ru/post/358554/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358544/index.html">One day as a user support employee. What does it change?</a></li>
<li><a href="../358546/index.html">How to plan the capacity of the Apache Ignite cluster</a></li>
<li><a href="../358548/index.html">Create a fighting game in Unity: the implementation of Hitbox and Hurtbox</a></li>
<li><a href="../358550/index.html">Monitoring Elasticsearch without pain and suffering</a></li>
<li><a href="../358552/index.html">Best practices for designing productive mobile APIs</a></li>
<li><a href="../358558/index.html">The whole program Backend Conf: from microservices to endless data</a></li>
<li><a href="../358560/index.html">Digest news from the world of PostgreSQL. Issue number 6</a></li>
<li><a href="../358562/index.html">Open Testing Conference Free Broadcast - Heisenbug 2018 Piter</a></li>
<li><a href="../358564/index.html">Automatic generation of test scripts using neural networks</a></li>
<li><a href="../358566/index.html">Open webinar: "Scopes and invisibility"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>