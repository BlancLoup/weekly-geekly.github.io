<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We collect ProGit documentation, under Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 Good day. 

 For about six months, our company has moved from the SVN version control system to Git. I will not write about the advantages ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We collect ProGit documentation, under Windows</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  Good day. <br><br>  For about six months, our company has moved from the SVN version control system to Git.  I will not write about the advantages or disadvantages; they have been discussed more than once.  The guys who did this in our team wrote several internal articles with the main scenarios: the creation of brunch, merdzhi, etc. <br>  But life presents its surprises and the exit for the main scenarios was always denoted by the phrase WTF or speaking Russian ‚ÄúI thought Git would do it, why did he do it differently?‚Äù <br><br>  And it all came down to the fact that you need to read the documentation for the Gita.  <i>(And there is always no time to read the documentation.)</i> <br>  On this occasion, there was an article <a href="http://habrahabr.ru/post/150673/">Completed the translation of the book "Pro Git"</a> on Habr√©. <br>  But as it turned out, the documentation is still being modified.  Not often, but still, it is clearly visible when the latter were introduced. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And the idea to make the last version of the docks ... <br><a name="habracut"></a><br><h4>  Git + Pandoc + Windows </h4><br>  To do this, we need to install <a href="http://code.google.com/p/gitextensions/">Git Extensions</a> , in the <i>Commands</i> menu, select <i>Clone Repository.</i>  by linking to the 'https://github.com/progit/progit.git' repository <br><img src="https://habrastorage.org/storage2/d7a/613/dcc/d7a613dcc993510bf39cadcc92feb059.jpg"><br><br>  And click Clone. <br>  <i>PS To download the docks, anonymous access is used, so no keys are required.</i> <br><br>  But then a surprise was waiting for me, the documentation was in an unknown markdown format, and in order to create an option for an EBook, it was suggested to do this: <br><br>  <b>Making ebooks</b> <br>  On Fedora you can run something like this: <br><br><pre><code class="tex hljs"><span class="hljs-formula"><span class="hljs-formula">$ yum install ruby calibre rubygems ruby-devel rubygem-ruby-debug $</span></span> gem install rdiscount <span class="hljs-formula"><span class="hljs-formula">$ makeebooks en # will produce a mobi</span></span></code> </pre> <br>  The prospect of setting up a Linux virtual machine, just to collect the documentation, was not pleasant.  Perhaps there are other solutions, then only my bike. <br>  <i>Oh great internet!</i>  There in the open spaces, I managed to find a <a href="http://johnmacfarlane.net/pandoc/installing.html">Pandoc</a> utility that can turn markdown format files into docx, pdf, txt, etc. <br>  Features and syntax can be found <a href="http://johnmacfarlane.net/pandoc/demos.html">here</a> . <br>  Download, install, go to the folder <i>E: \ sources.git \! \ Progit \ ru</i> <br>  If you look, the syntax when converting is simple <br><br><pre> <code class="tex hljs">pandoc -S 01-introduction<span class="hljs-tag"><span class="hljs-tag">\</span></span>01-chapter1.markdown -o gitbook.docx</code> </pre><br>  From the nuances: <br><ol><li>  It was necessary to pick up when generating multiple files. </li><li>  The links to the pictures were indicated in the format <pre> <code class="javascript hljs"> Insert <span class="hljs-number"><span class="hljs-number">18333</span></span>fig0101.png  <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-number"><span class="hljs-number">-1.</span></span>   .</code> </pre>  , but you must <pre> <code class="javascript hljs">![  <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-number"><span class="hljs-number">-1.</span></span>   .](..\figures\<span class="hljs-number"><span class="hljs-number">18333</span></span>fig0101-tn.png)</code> </pre></li></ol><br><br>  Therefore, I wanted to automate the process and was written in VBScript (I am not a guru of this language, I just needed to solve my problem).  VBS is not so complicated and it was quite enough to solve it. <br><br>  1. It is solved by searching all the files in the folder with the markdown extension. <br>  2. Solved by RegExp. <br>  Such script will turn out: <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> ForReading = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> ForWriting = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> ForAppending = <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objFSO = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objRegEx = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"VBScript.RegExp"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> sCurPath, tempFolder, files sCurPath = objFSO.GetAbsolutePathName(<span class="hljs-string"><span class="hljs-string">"."</span></span>) tempFolder = sCurPath + <span class="hljs-string"><span class="hljs-string">"\!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> objFSO.FolderExists(tempFolder) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> objFSO.DeleteFolder(tempFolder) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> objFSO.CreateFolder(tempFolder) CopyFiles sCurPath, tempFolder <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> cmd cmd = <span class="hljs-string"><span class="hljs-string">"pandoc -S "</span></span> + files + <span class="hljs-string"><span class="hljs-string">" -o gitbook.docx"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-built_in"><span class="hljs-built_in">createobject</span></span>(<span class="hljs-string"><span class="hljs-string">"wscript.shell"</span></span>) .Run(cmd), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> WScript.Echo(<span class="hljs-string"><span class="hljs-string">"Completed"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> CopyFiles(CurrentFolderName, TempFolderName) <span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> ObjFolder <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> ObjSubFolders <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> ObjSubFolder <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> ObjFiles <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> ObjFile <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> ObjFolder = objFSO.GetFolder(CurrentFolderName) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> ObjFiles = ObjFolder.Files <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> ObjFile <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> ObjFiles <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> objFSO.GetExtensionName(ObjFile.name) = <span class="hljs-string"><span class="hljs-string">"markdown"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> openedFile = objFSO.OpenTextFile(ObjFile.Path, ForReading) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> outputfile = objFSO.CreateTextFile(TempFolderName + <span class="hljs-string"><span class="hljs-string">"\"</span></span> + ObjFile.name, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) files = files + <span class="hljs-string"><span class="hljs-string">"!\"</span></span> + ObjFile.name + <span class="hljs-string"><span class="hljs-string">" "</span></span> objRegEx.IgnoreCase = <span class="hljs-literal"><span class="hljs-literal">True</span></span> objRegEx.MultiLine = <span class="hljs-literal"><span class="hljs-literal">True</span></span> objRegEx.Global = <span class="hljs-literal"><span class="hljs-literal">True</span></span> objRegEx.Pattern = <span class="hljs-string"><span class="hljs-string">"Insert (.*).png\n*\s*(.*)$"</span></span> text = openedFile.ReadAll openedFile.Close result = objRegEx.<span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(text, <span class="hljs-string"><span class="hljs-string">"![$2](../figures/$1-tn.png)"</span></span>) outputfile.Write result outputfile.Close <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-comment"><span class="hljs-comment">'Getting all subfolders Set ObjSubFolders = ObjFolder.SubFolders For Each ObjFolder In ObjSubFolders 'Getting all Files from subfolder CopyFiles ObjFolder.Path, TempFolderName Next End Function</span></span></code> </pre> <br><br>  Run the script from the folder <i>E: \ sources.git \! \ Progit \ ru</i> , we get <i>gitbook.docx</i> . <br><br><h4>  Conclusion </h4><br><ol><li>  Where to run the script is important because it takes into account the path to the pictures. </li><li>  To build pdf you need latex, so I did not try it. </li><li>  If the file is needed in a different format, you can already use other utilities to convert docx to pdf, fb2, etc ... </li><li>  I didn‚Äôt start reading the documentation, but one step closer :). </li></ol><br><br><h4>  Links </h4><br>  <a href="http://rusfolder.com/33562236">Download dock</a> </div><p>Source: <a href="https://habr.com/ru/post/158151/">https://habr.com/ru/post/158151/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../158131/index.html">Transfer files from designer to programmer. Scripts</a></li>
<li><a href="../158139/index.html">Convenient debugger for Python / Django projects</a></li>
<li><a href="../158141/index.html">Ipv6 configuration in proxmox and lvm notes</a></li>
<li><a href="../158143/index.html">Evaluation of information security in the activities of organizations</a></li>
<li><a href="../158145/index.html">Google launched a strange site Niantic Project</a></li>
<li><a href="../158155/index.html">Inline editing in Django</a></li>
<li><a href="../158157/index.html">Mobile client server development</a></li>
<li><a href="../158159/index.html">The history of the struggle for IOPS in the self-assembly SAN</a></li>
<li><a href="../158161/index.html">Theory of radio waves: educational program</a></li>
<li><a href="../158165/index.html">Text Mining Framework (Java)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>