<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PXE boot Thinstation depending on the hardware of the thin client</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the process of work, it is systematically necessary to replenish the fleet of thin clients and each time customers may differ in configuration from...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PXE boot Thinstation depending on the hardware of the thin client</h1><div class="post__text post__text-html js-mediator-article">  In the process of work, it is systematically necessary to replenish the fleet of thin clients and each time customers may differ in configuration from previous ones and from one manufacturer.  Well, if the differences are small and the client works on the previous build of Thinstation, in practice it turns out that the working assembly is not compatible with new computers. <br><br>  By itself, the first thought is to assemble a universal boot image, but this is not always the case - either the image is very large, or the modules or packages are incompatible.  Exit - to collect several images and give them to the right customers at boot.  There are <a href="http://it-advisor.ru/thin/81-select.html">several</a> ways, here I will describe my favorite. <a name="habracut"></a><br><br>  For example, I have two different types of thin clients: a long-standing batch of <abbr title="Processor Via Eden 400 MHz System memory 128 MB Flash memory 64 MB"><b>HP Compaq t5135</b></abbr> and a batch of newer <abbr title="Processor Intel Atom 230 1.6Ghz System memory 1024 MB Flash memory 16 GB"><b>USN BQ 656</b></abbr> , iron is all different, I had to make two boot images - TS-2.2.2i and TS-5.3.  I will not write about how to <a href="http://it-advisor.ru/thin/103-dnsmasq.html">set up a PXE boot</a> , but how to give the necessary images using DHCP. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We create two folders on the TFTP server for the images sent via PXE, <b>hp</b> and <b>usn</b> , respectively, and <b>store</b> our loaders in them.  Distribution will be carried out on MAC-addresses, or rather on their first half, because  each vendor has its own identifier and in one batch usually the first half of the MAC is the same. <br>  As expected, all my <b>HP</b> MAC clients start at <b>00: 1E: 0B</b> and are reserved for the Hewlett-Packard Company, and for the <b>USN</b> , from <b>38:60:77</b> and reserved for the PEGATRON CORPORATION. <br><br>  We add the conditions in the <b>dhcpd.conf</b> server configuration file to the <b>subnet</b> description: <br><br><pre><code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (binary-to-ascii (16,8,<span class="hljs-string"><span class="hljs-string">":"</span></span>,substring(hardware, 0, 4)) = <span class="hljs-string"><span class="hljs-string">"1:0:1E:B"</span></span>) { filename <span class="hljs-string"><span class="hljs-string">"/hp/pxelinux.0"</span></span>; } elsif (binary-to-ascii (16,8,<span class="hljs-string"><span class="hljs-string">":"</span></span>,substring(hardware, 0, 4)) = <span class="hljs-string"><span class="hljs-string">"1:38:60:77"</span></span>) { filename <span class="hljs-string"><span class="hljs-string">"/usn/pxelinux.0"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { filename <span class="hljs-string"><span class="hljs-string">"pxelinux.0"</span></span>; }</code> </pre> <br>  Here, initial, identical for a certain manufacturer, MAC-address values ‚Äã‚Äãare written and if the condition coincides with the client's poppy start, then it is assigned the bootstrap file defined in the condition from the corresponding TFTP server folder. <br><br>  It is important to note that in the ‚Äúvariable‚Äù hardware for network cards there is a leading block: ‚Äú01:‚Äù, so you have to take it into account.  It is also important that if a part of the MAC address starts from zero, it is discarded during translation.  Thus, the MAC address with the beginning ‚Äú00: 1E: 0B‚Äù is converted to ‚Äú1: 0: 1E: B‚Äù. <br><br>  As always, <b>dnsmasq</b> is even simpler: <br><br><pre> <code class="bash hljs">dhcp-mac=hp,00:1E:0B:*:*:* dhcp-boot=net:hp,hp/pxelinux.0,boothost,192.168.111.254 dhcp-mac=usn,38:60:77:*:*:* dhcp-boot=net:usn,usn/pxelinux.0,boothost,192.168.111.254 dhcp-boot=pxelinux.0,boothost,192.168.111.254</code> </pre> <br>  There is nothing to clarify, assign an identifier by mas and give the loader by identifier, if nothing matched - we give the default image, I have it in the assembly version with the - <b>allmodules</b> option to get the client parameters. </div><p>Source: <a href="https://habr.com/ru/post/268891/">https://habr.com/ru/post/268891/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268871/index.html">Composer - the right way</a></li>
<li><a href="../268875/index.html">Thoughts of a cyber-criminal: what does he look for and why has he chosen your enterprise?</a></li>
<li><a href="../268877/index.html">Thematic Cartography: Common Questions</a></li>
<li><a href="../268885/index.html">Manage HP ProLiant servers through open REST APIs or ‚ÄúiLO on steroids‚Äù</a></li>
<li><a href="../268889/index.html">Animate component resizing in Android</a></li>
<li><a href="../268893/index.html">Mastering the Data Science specialty on Coursera: personal experience (part 2)</a></li>
<li><a href="../268895/index.html">IoT cloud on Netty or 10k rec-sec per core</a></li>
<li><a href="../268897/index.html">Difficulties of "translation"</a></li>
<li><a href="../268899/index.html">The scandal around Volkswagen and the role of programmers in it</a></li>
<li><a href="../268903/index.html">Hibernate Developer Documentation - Chapter V. Locks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>