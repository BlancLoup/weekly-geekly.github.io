<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How ABBYY technologies help improve data leak detection systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despite predictions about the imminent onset of a bright paperless future, the volume of paper documents is still huge. Some of them are scanned and c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How ABBYY technologies help improve data leak detection systems</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/bda/deb/f97/bdadebf97b054709a10a2a0685fcd298.JPG" align="left">  Despite predictions about the imminent onset of a bright paperless future, the volume of paper documents is still huge.  Some of them are scanned and continue their ‚Äúlife‚Äù already in electronic form - but only in the form of images.  On average, organizations have scanned copies of <abbr title="estimated 2016 SearchInform">30% of all documents</abbr> that are stored electronically.  In the public sector, it reaches 41.5%, in retail - 17%, in the service sector - 23%, in banks and the telecom sector is approaching 45%.  When scans of documents are in the right folder for themselves or do the work for which they are intended, this is good.  It is bad when someone tries to use data from these scans in fraudulent schemes or otherwise abuse them.  To keep confidential information from leaking, DLP leak prevention systems are installed in company information systems. <br><br>  Today we will explain how the <a href="https://www.abbyy.com/ru-ru/ocr-sdk/">ABKY FineReader Engine</a> SDK product was integrated into one of such programs, the <a href="http://searchinform.ru/products/kib/">Information Security Circuit of</a> SearchInform, and what came of it. <br><a name="habracut"></a><br>  We believe that not all readers of the ABBYY blog are well versed in information security, so we first briefly describe how the Information Security Contour works in general.  If you are a frequenter of the ‚ÄúIB‚Äù hub and are familiar with the principles of operation of DLP systems, you can skip this section. <br><br><div class="spoiler">  <b class="spoiler_title">How DLP works</b> <div class="spoiler_text"><br>  The information security contour SearchInform is designed to control information flows within the local area network.  Control is possible in two ways, depending on the server component used: on the network or on users' workstations.  Server components are the platforms on which data interception modules are running.  Each interception module acts as a traffic analyzer and monitors its data transmission channel. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first module intercepts and, if necessary, blocks information flows at the network level.  It allows you to work with mirrored traffic, proxy servers, mail servers and other corporate software, for example, Lyn.  Network traffic is intercepted at the network protocol level (mail, Internet, instant messengers, FTP, cloud storage).  The second one intercepts and blocks information with the help of agents that are installed on employees' computers.  It controls: Internet, corporate and personal e-mail, all popular instant messengers (Viber, ICQ, etc.), Skype, cloud storages, FTP, Sharepoint, output of documents to printers, the use of external storage devices.  The file system, the activity of processes and sites are monitored, the information displayed on the PC monitors and captured by the microphones, keystrokes, remote online monitoring of the PC is available. <br><br>  The system also allows you to index documents "alone" - on users' workstations or network devices - and can index any textual information from any sources that have an API or the ability to connect via ODBC. <br><br>  The system searches for confidential information that should not ‚Äúleak out‚Äù in different ways: by keywords, taking into account morphology and synonyms, by phrases, by taking into account the word order and distance between them, by attributes or by featured documents (format, sender or recipient name, etc. ).  The analysis algorithms are so sensitive that they are able to find even a seriously modified document, if it is close in meaning or content to the ‚Äústandard‚Äù <br><br>  The system can set security policies and monitor their execution.  DLP is able to collect statistics and creates reports on cases of violation of security policies. <br><br>  The system architecture - for those interested - is well described <a href="http://www.anti-malware.ru/reviews/kib_SearchInform_part1">in this review</a> , we will not repeat. </div></div><br><br>  Most of the tasks in DLP are solved by text analysis.  But, as we remember, in many companies a large number of scans (images) of documents are stored and transmitted through different channels.  If you leave the picture "as is" - the picture, the DLP-system will not be able to work with it. <br><br>  In order for the system to understand what information is contained in the image and whether it can be stored / transmitted in one way or another, the image needs to be recognized and received text.  In this case, the entrance serves a variety of images, and their quality can be completely different.  If a fuzzy picture falls into the interception, you have to work with what you have, not to ask the user to send it again, in a higher quality. <br><br>  SearchInform DLP system was previously equipped with OCR technology.  But this engine had serious drawbacks both in recognition quality and speed.  I had no sense in developing my own engine for SearchInform, so we started looking for ready-made technologies.  Now in the SearchServer module, ABBYY technologies can be used as a full-text recognition engine. <br><br><h1>  How did the FineReader Engine integrate into the system? </h1><br>  The development is divided into two directions.  First, it was necessary to integrate ABBYY technologies seamlessly and create a user-friendly DLP recognition module.  Secondly, to adapt the recognition and classification of ABBYY documents for applied tasks. <br><br>  The first problem was solved quickly: it was implemented through its own pre-configured installer in the DLP system.  Deploying an OCR module based on ABBYY technology comes down to installing an additional component in the ‚Äúnext - next‚Äù style, and activating the necessary ‚Äútick‚Äù in the DLP.  The component is installed on the DLP server, so no configuration for the ‚Äúconnection‚Äù of DLP and OCR is required in principle; the user doesn‚Äôt need to do anything else. <br><br><img src="https://habrastorage.org/files/267/102/e10/267102e10dc74333bbf89f3934094b67.png"><br><br>  The inclusion of the FineReader Engine is implemented via the DLP interface; it is activated in one click by selecting the corresponding item from the drop-down list.  More detailed settings are also available here (if desired). <br><br><img src="https://habrastorage.org/files/125/f1a/481/125f1a481bec48ada19b46d7b87cab26.png"><br><br>  Moreover, the user does not need to interact with ABBYY, the licensing of the FineReader Engine is performed by SearchInform at the license level to DLP.  The implementation turned out to be really user friendly and the customers liked SearchInform. <br><br>  With the second task - adaptation of the ABBYY technology for applied tasks - there was much more work. <br><br>  When the programmers of SearchInform began to study technologies, they revealed a lot of opportunities potentially useful for solving information security tasks.  Everyone is used to the fact that ABBYY is, above all, OCR.  But FineReader Engine can also classify documents by appearance and content.  To set up the classification process, at the first stage it is necessary to set the categories for which the documents will be distributed (for example, ‚ÄúPassport‚Äù, ‚ÄúAgreement‚Äù, ‚ÄúCheck‚Äù).  After this, the program must be trained: ‚Äúshow‚Äù documents corresponding to each class in all possible design options. <br><br><div class="spoiler">  <b class="spoiler_title">How does the classifier in FineReader Engine</b> <div class="spoiler_text">  In order for such a machine to work, the classifier must first be trained.  You pick up a small database of documents representing each category that you go to define.  With the help of this base you are training a classifier.  Then you take another base, check the classifier‚Äôs work on it, and if you are satisfied with the results, you can start the classifier ‚Äúinto battle‚Äù. <br><br>  During work and training, the classifier uses a set of features that help separate documents of one type from documents of another type.  All signs can be divided into graphic and textual. <br><br>  Graphic signs well divide groups of documents that are very different from each other.  Relatively speaking, if you look at a document from a distance so that you cannot read the text on it, but you can understand what type it is, then the graphic signs here will work well. <br><br>  So, graphic signs can well separate the fused and non-text text, for example, letters and payment receipts.  They look at the size of the image, the density of colors in different parts of it, various other characteristic elements such as vertical and horizontal lines. <br><br>  And if the documents are similar in appearance, or one group, without reading the text, cannot be separated from the other group, then textual signs help.  They are very similar to those used in spam filters and allow for the characteristic words to determine whether a document belongs to a particular type.  It is convenient to separate letters from contracts, checks from business cards with the help of text signs. <br><br>  Also, text signs help to separate documents of a similar type, but differing in the value of one or several fields.  For example, checks from McDonalds and Teremka look very similar, but if we consider them as text, the differences will be very noticeable. <br><br>  As a result, the classifier for each training sample gives more weight to those text or graphic features that allow the best way to separate the documents from this sample by type. </div></div><br><br><h1>  How is the classification implemented in the DLP + ABBYY bundle? </h1><br>  The developers of SearchInform asked the program several categories of documents that users might need in the first place - different types of passports and bank cards. <br>  The categorization of passports and credit cards begins to work for the user without learning the system, almost immediately after deploying the FineReader Engine.  The user simply needs to include a classifier in the settings - and all new documents will be categorized; to classify documents from the archive, you just need to restart the check on them. <br><br>  At the same time, the user is allowed to create additional categories.  He can set any classes (categories), or add his documents to the existing ones (passports and credit cards).  To do this, he needs to create subfolders with the names of classes in a special folder, put document standards there and start the learning process.  This procedure is usually performed in conjunction with SearchInform engineers, who all clearly demonstrate and talk about the requirements for images, together with the customer form the base of standards, advise which documents are better suited as standards of a particular category.  Immediately after tuning, a check is made on real data, often after checking, a reconfiguration is needed, a slight adjustment of settings or standards.  Usually this procedure takes half an hour. <br><br>  The accuracy of the classification depends on how much the system can ‚Äúsee‚Äù the difference between documents in different categories.  If you apply for documents in two different categories that are similar in appearance and contain many identical keywords, the technology will become confused and the classification accuracy will decrease. <br><br>  So, when detecting scans of only the main page of passports, SearchInform engineers encountered a large number of false positives.  The ABBYY algorithm found in the archive of 10,000 images 300 pictures similar to passports, while there were only a few passports. <br><br>  If for arbitrary categories this is a valid percentage of relevance, then for key objects, for example, credit cards, this is too large an error.  To improve the level of relevance, SearchInform engineers have also developed their own verification algorithms, which are already applied to the results of the ABBYY classification.  For each category of data, an individual validator was created that works only with its group. <br><br><h1>  How the DLP + ABBYY system works with images </h1><br>  Data processing in DLP deals with a special component - SearchServer.  When this component finds an image in the intercepted data (and it doesn‚Äôt matter whether it is part of a document or a separate picture), it transfers it to the FineReader Engine module, which performs optical recognition and classifies images into specified categories.  Moreover, together with the category FineReader Engine gives and "percentage of similarity" of the image to the corresponding class, for example, image number 1 looks like a passport by 83%, image number 2 looks like a driver's license by 35%.  The result is transmitted to SearchServer.  In SearchServer, a special parameter is set, for ease of understanding, let's call it ‚Äúthe lowest possible percentage‚Äù - by default it is 40%.  If the FineReader Engine has assigned a percentage less than this value, the class is deleted, and this document goes without a class to DLP.  If the percentage is higher, there will be the following: <br><br>  1. For passports and credit cards, the SearchInform validator works, it checks the document using both recognized text and a graphic component (for example, for passports it turns out whether there is a face on the image, where it is located, how much space it takes, whether there are graphic elements inherent only in passports (for the Russian Federation - a special pattern), other characteristic elements).  The more ‚Äúmarkers‚Äù are confirmed, the higher the resulting ‚Äúmultiplier‚Äù will be.  For example, the FineReader Engine classifier is confident in image similarity to a passport by 63%, the validator found the keywords ‚ÄúPassport of the Russian Federation‚Äù, ‚ÄúLast Name‚Äù, ‚ÄúIssued by‚Äù and a photo on which a person was detected on it - in this case the factor is , for example, 1.5 - and the final relevance is 94.5% <br><br>  The relevance of such a post-check has increased significantly, and the performance has remained the same.  The ABBYY algorithm works fairly quickly and is applied to large data arrays, which allows the program to speed up several times, the SearchInform category validator works slower, but thanks to the ABBYY classification, it is used only when necessary and applied to a significantly smaller data array. <br><br>  The complexity of this implementation was that we had to do validators for many types of data from scratch.  After all, the same passports of different countries have their own unique features, and the algorithm for searching for a passport of the Russian Federation is absolutely not suitable for searching for a passport of a citizen of Ukraine.  The same with credit cards - the characteristics for VISA differ significantly from MasterCard. <br><br>  2.If the document is similar to some category, but it does not belong to passports or credit cards, the relevance assigned by the FineReader Engine module remains unchanged - the SearchInform validator for such categories does not apply at all. <br><br>  After the final relevance is calculated, the rule once again works, in which the threshold is no longer the ‚Äúminimum percentage of similarity‚Äù value, but the value configured by the user.  The default is 70%.  Total, if relevance is greater than or equal to this value - such documents confirm the class, and you can search for this class.  If it is smaller, the class label is removed and the document is considered ‚Äúwithout class‚Äù. <br><br><h1>  Solving applied problems </h1><br>  The Information Security Contour has specialized analytics tools that allow you to work with an archive of data or execute specified security policies. <br>  Of course, passports and credit cards are critical data because they contain personal data, so their control is very important to customers.  Moreover, it is usually extremely difficult to develop a blocking rule that will ‚Äúcut‚Äù such data - when creating such rules in real projects, there are a lot of subtleties that become clear gradually, and each such case leads to a violation of the client‚Äôs business processes (because lock is activated).  Therefore, most often customers just want to see all the movements of such documents within the organization and, especially, beyond its limits.  And considering that it can be not only passports / credit cards, but also any other types of data - the method gives greater flexibility in the analysis. <br><br>  Consider a real case.  The customer‚Äôs company works with passport scans.  It has a specific set of rules regulating where and how it is necessary to store such things, through which electronic channels and to whom it can be transmitted.  Part of the data is blocked during transmission - for example, if it is outgoing mail that is not intended for an employee of the company and has a passport scan, passport data, or something even remotely resembling passport data.  Send a scan of the passport out only in coordination with the IB. <br><br><img src="https://habrastorage.org/files/f5e/060/ec5/f5e060ec5a7649c28b34e0db9ecccf82.png"><br><br>  Also, information security specialists monitor the transfer of such data through ‚Äúpersonal‚Äù channels and the storage of this data on media (storage is regulated, but if the transfer to third parties is considered a critical violation, then copying to the ‚Äúwrong daddy‚Äù is a minor violation). <br><br>  When working in normal mode, the IB relies on DLP automation and works exclusively with system reports.  When some kind of investigation is underway, intent checks begin and the data flow begins to work manually.  If it is necessary to identify all actions that take place with the object ‚Äúpassport‚Äù, the relevance of the policy is 70-80%, out of a million events 500 are filtered out, they are manually reviewed and appropriate measures are taken.  If something serious happens, the policy is narrowed down to ‚Äúemployee \ date \ time‚Äù and relevancy greatly reduces (up to 1%) - irrelevant data will be an order of magnitude larger, but the probability of missing critical events is greatly reduced. <br><br><img src="https://habrastorage.org/files/63f/92a/750/63f92a7506704c129ab1bae62999f06a.png"><br><br>  <i>Svetlana Luzgina, ABBYY Corporate Communications Service,</i> <i><br></i>  <i>Alexey Parfentiev, Technical Analyst, SearchInform</i> </div><p>Source: <a href="https://habr.com/ru/post/314830/">https://habr.com/ru/post/314830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314818/index.html">Search optimization when choosing a campaign</a></li>
<li><a href="../314820/index.html">Tricks for taking complex integrals</a></li>
<li><a href="../314822/index.html">Manage identity verification with Windows Hello for Business</a></li>
<li><a href="../314824/index.html">5 lessons of a seven-month stay in a start-up hell</a></li>
<li><a href="../314826/index.html">JetBrains Night in Moscow. Video. Kotlin as the first step to JVM</a></li>
<li><a href="../314832/index.html">Work with cab-archives via IStream</a></li>
<li><a href="../314834/index.html">Go programming language - seven years</a></li>
<li><a href="../314838/index.html">Cicerone - simple navigation in Android application</a></li>
<li><a href="../314840/index.html">Symfony - upload files to MongoDB GridFS</a></li>
<li><a href="../314842/index.html">Laboratory penetration testing "Test lab v.10" - beyond the hacker capabilities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>