<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Scaling is simple. Part Two - Caching</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous part, we talked about the basic architectural principles for building scalable portals. Today let's talk about optimizing a properly b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Scaling is simple. Part Two - Caching</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="http://habrahabr.ru/post/209202/">previous part,</a> we talked about the basic architectural principles for building scalable portals.  Today let's talk about optimizing a properly built portal.  So: the first type of optimization is local cache. <br><br><a name="habracut"></a><br><br><h4>  Part two.  Caching </h4><br>  As I mentioned in the <a href="http://habrahabr.ru/post/209202/">previous part</a> , we are talking, first of all, about B2C portals.  These portals have a common property: the predominance of reading requests over writers.  And often, the predominance of 10-fold or more.  It is clear why caching is such a promising tool. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Caches are an interesting and almost endless topic.  Therefore, I will try to describe it rather shortly for the first round of optimization, without going into details about level 1 and 2 cache, distributed cache, etc. Since we need to cache the object, we will skip the write cache ( write cache). <br><br>  When we start local caching, we usually have a choice: query or object cache (call or object caching).  Query cache (or method cache) is a cache that can be used ‚Äúoutside‚Äù: it records the results of method calls (query), and we assume that the same queries cause the same answers.  If you repeat the same request several times, you can, starting from the second time, skip complex and lengthy processing, and simply return the previous result.  The advantage of such caches is that they do not depend on either the architecture or the domain, that is, they are integrated as a utility (for example, aspect) into the finished product, without much changing it.  In contrast to this advantage, they have a number of disadvantages: <br><ul><li>  They are inefficient when we have rich interfaces that have several methods of reading the same object.  The reason is that they cache the path to the object, not the object itself. </li><li>  Their size depends not on the number of possible objects (results), but on the number of possible requests, and therefore they are usually heavier than alternatives.  Their size and amount of necessary memory is hard to plan. </li><li>  They are ugly. </li></ul><br><br>  The situation with object caches is quite different: they are harder to integrate, but they are much more efficient.  The ideal implementation of an object cache is a collection (a list or set depends on requirements), which contains all the objects managed by this service in their object form.  Ideally, the service should be able to respond to each request with a cache and without accessing external persistence (for example, a database).  Unfortunately, this 100% cacheability is rarely achievable, but where it can be applied, it is always cost-effective.  The best example for 100% cache is user accounts.  They are usually small (consist of id, mail, name, registration time, etc.) and are constantly required in different places of the application. <br><br><h5>  Cache what is not </h5><br>  Another useful form of cache is the so-called zero-cache, or negative cache.  In most cases, object caches are filled while the application is running, so that a so-called ‚Äúcold start‚Äù and the creation of new objects in the database are possible, while several instances of the same service exist simultaneously.  As a result, appeals to the application can "break through" through the cache and reach the base.  In case such ‚Äúpenetration‚Äù will occur constantly, it can lead to base overload.  Then all our caches, built with such difficulty, will lose all effectiveness and protective function.  To combat this overload, there are negative caches that remember once unsuccessfully polled objects, thereby giving the service the next request to stop processing them at an early stage. <br><br><h5>  Cache what changes </h5><br>  Another subcategory of caches is ExpiryCaches.  They are based on the postulation that the object or its parts will not change their state for a certain period of time.  A typical example of such an object is a user profile on an online dating site.  If user A edits his profile, then for user B, who views user A‚Äôs profile, it does not matter whether he sees these changes after 5, 30 or 60 seconds (especially if these users do not contact).  Thus, we can fix the state of user A‚Äôs profile for a time that is insignificant for a person, but long from the point of view of the machine, and work with the fixed version.  In this way, we prevent the processing of a significant number of requests, which, with a high probability, would return an identical result (because users change the profile much less often than, for example, they search or respond to messages), and save resources.  Paying for this savings is just a risk to show the update in the profile a bit later than we could.  This technique with particular popularity is used on the client (web server) to save network traffic (to a database or service) and, accordingly, time.  But this is not the only example when using Expiry Cache is advisable.  Another use case is when, in the course of processing a request, we assume that the same object will be requested many times, but from places so remote from each other in the code that it is impossible or impractical to store its value in a variable.  A popular technology for implementing such intermediate caches is ThreadLocal (Java). <br>  ExpiryCache is nothing more than resource sharing (trade off): we sacrifice the speed of displaying changes for the sake of application performance. <br><br>  In general, scaling applications (and especially portals) is the exchange of resources, which we have a lot of, for those that are not enough: for example, RAM on the CPU, network traffic or IO. <br><br>  Caching is a good method for optimizing a single component or service, but the potential for such optimization is limited.  At some point we will have to recognize that the limit on what one instance can handle has been reached, and we need to scale the components of our architecture (i.e., run multiple copies of them).  This is the <a href="http://habrahabr.ru/post/209758/">third part</a> . </div><p>Source: <a href="https://habr.com/ru/post/209352/">https://habr.com/ru/post/209352/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209336/index.html">The main thing is trust</a></li>
<li><a href="../209342/index.html">Role-playing technology. Part 1. Technology and magic</a></li>
<li><a href="../209346/index.html">How I tested the IDE of the company "Multiklet"</a></li>
<li><a href="../209348/index.html">Recovering LSI RAID Controller firmware</a></li>
<li><a href="../209350/index.html">Components by TJHolowaychuk</a></li>
<li><a href="../209354/index.html">Components. Example</a></li>
<li><a href="../209356/index.html">How to force the process to use the new DNS server address from the updated resolv.conf without restarting the process itself</a></li>
<li><a href="../209360/index.html">Video recordings of reports on the stream ‚ÄúJavaScript on backend‚Äù of the FOSS Sea conference</a></li>
<li><a href="../209362/index.html">14 tools for web design and web development for 2014</a></li>
<li><a href="../209364/index.html">Tronsmart T1000 - ‚Äúeasy‚Äù media player for broadcasting images to the big screen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>