<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What DDoS protection services do not negotiate or why protection does not work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The reason for this article was a security audit in one Internet project. The customer asked to deal with their security system and check how they are...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What DDoS protection services do not negotiate or why protection does not work</h1><div class="post__text post__text-html js-mediator-article">  The reason for this article was a security audit in one Internet project.  The customer asked to deal with their security system and check how they are subject to one or another attack.  At the same time, we were assured that they are fully protected from DDoS attacks and there is no reason to worry, as they are protected by one of the market leaders, Incapsula. <br><br>  It was then that a great surprise awaited us - the customer was absolutely not protected. <br><br>  Let's see what happened, but first a little theory. <br><a name="habracut"></a><br>  I will not describe what a DDoS attack is, I note only that they are divided into 2 types: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - DDoS Layer 3 &amp; 4 on the OSI model.  One of the characteristics of this attack is a large number of packets that attack a resource.  At the moment, the average attack power in the world is 9.7 Gb / s and 19 Mpps. <br>  - DDoS Layer 7 on the OSI model, that is, an attack on the application layer.  As a rule, the attack does not contain a large number of packets (by orders of magnitude lower than with DDoS L3 &amp; 4), rather it is characterized by a point strike on the weak point of the attacked site. <br><br>  Connection to services protecting from DDoS attacks is as follows: <br><br>  - For the protected resource, the address of the protecting one is entered in the DNS; <br>  - The client indicates which IP address to forward the cleared traffic (as a rule, to the same address that was before connecting to the service).  Perhaps raising the tunnel. <br><br>  Now I specifically do not understand the case of connecting with the help of BGP, there is also not so good, but most of the clients are connected through changes in the DNS record. <br><br>  The customer is satisfied, relaxed and completely confident in the future!  <b>But, in fact, at the very moment when the customer relaxed, he became even less protected!</b> <br><br>  Let's take a look at why or how to bypass the protection. <br><br>  Indeed, when trying to get the ip-address of the customer by the site name, we get the ip-address of the protection service: <br><br>  $ nslookup <a href="http://www.xxxxxxxx.ru/">www.XXXXXXXX.ru</a> <br>  <a href="http://www.xxxxxxxx.ru/">www.XXXXXXXX.ru</a> canonical name = xxx.incapdns.net. <br>  Name: xxx.incapdns.net <br>  Address: 149.126.xxx.xxx <br><br>  But no one bothers us to see the DNS history for this name.  We go to any site that provides such information.  And what we see: <br><br><table><tbody><tr><th>  IP Address </th><th>  Location </th><th>  IP Address Owner </th><th>  Last seen on this IP </th></tr><tr><td>  149.126.xxx.xxx </td><td>  Binghamton - United States </td><td>  Incapsula Inc. </td><td>  2015 </td></tr><tr><td>  149.126.yyy.yyy </td><td>  Binghamton - United States </td><td>  Incapsula Inc. </td><td>  2015 </td></tr><tr><td>  zzz.zzz.zzz.zzz </td><td>  United States </td><td>  HOSTER LTD </td><td>  2014 </td></tr></tbody></table><br><br>  As a result, we see that its previous ip-address is zzz.zzz.zzz.zzz;  Moreover, now we know that it is located at the HOSTER LTD site in the USA (it will be clear further why this is also important). <br><br>  It remains only to look closely at the server that has this ip-address and we already know for sure that this is the client server we are looking for. <br><br>  Everything!  We attack this server by ip-address and the customer lies as much as we need.  A lot of money was spent on the wind, but the costs did not pay off, the protection does not work. <br><br>  Below I will describe recommendations for the proper use of such services. <br><br>  Strangely enough, but none of the popular DDoS protection services, both in the West and in Russia, provide any recommendations on this issue to their clients. <br><br><h4>  So what needs to be done? </h4><br>  As soon as you at least once lit your ip-address in the DNS service, you will never be able to delete this information - it will always be available in DNS history.  Moreover, you lit up your location (hoster, commercial data center, etc.). <br>  Do you want to fully protect yourself - leave this place.  As soon as you stayed, your service will be attacked if you present at least some value to the attackers. <br><br>  Consider how the attackers will behave and try to understand, depending on the size of your project, what to do in this situation. <br><br>  1) <u>You have a small website and you initially placed it at the hosting provider</u> .  The correct actions are to configure the http-server in such a way that it accepts requests only from the ip-addresses of the protecting one (this way you will precisely remove the possibility of the DDoS Layer 7 attack) and change the ip-address (protection from DDoS Layer 3 &amp; 4).  In this case, the attackers will not be able to find your site directly, but this does not mean that you are safe.  The average hoster in Russia has channels 1-5 Gb / s and if you are really interesting to the attackers, they will attack (DDoS Layer 3 &amp; 4) on the hoster channels and put it and you along with it. <br><br>  2) <u>You have a dedicated Virtual Private Server and it hosts your project</u> .  Correct actions: <br>  - configure the http server so that it accepts requests only from the ip-addresses of the protecting (so you just remove the possibility of an attack DDoS Layer 7); <br>  - configure the firewall so that all unnecessary ports are closed and / or accept connections only from ip-addresses known to you.  If you did not do this from the very beginning when you connected to the DDoS protection service, then perhaps the attackers have already studied your server and found out which ports are open and which are not (the attackers made a fingerprint on your system).  This means that they know what kind of car they need to look for in the provider's network; <br>  - change the ip-address (protection from DDoS Layer 3 &amp; 4). <br><br>  If you stayed on an existing cloud provider, you are still not safe.  The most vulnerable part of the cloud provider is the management console (even with Amazon it is not very well protected).  Attackers can launch a DDoS Layer 3 &amp; 4 attack on the channels of a small cloud-based provider and put the entire cloud on. <br><br>  3) You have a big project and a lot of servers that are located in any commercial data center.  Such a project is the most difficult to protect.  It is necessary to take a comprehensive approach to this task, changing the ip and configuring the firewall does not solve anything (but this does not mean that this should not be done).  At a minimum, you need to change the grid that the provider gave you.  It is to change, not to add a new one, otherwise, you don‚Äôt even have to look for you - the attackers will simply put your channels in, attacking the old grid.  As a rule, in such projects there are services that cannot or cannot be protected from DDoS - think about how to properly distribute these services across different networks or even sites, otherwise you will be found precisely by them (the simplest example is MX mail service records). <br><br><h4>  Conclusion </h4><br>  DDoS protection services are not a panacea, but they can help a lot if you take a number of steps in the right direction. <br><br>  Good luck to you and your projects. </div><p>Source: <a href="https://habr.com/ru/post/250735/">https://habr.com/ru/post/250735/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250725/index.html">Results of testing algorithms of Russian biometric companies in the world market</a></li>
<li><a href="../250727/index.html">DIY Math Package for Android</a></li>
<li><a href="../250729/index.html">How to simplify the verification of a bank card holder for online payments?</a></li>
<li><a href="../250731/index.html">JMeter: Forget Beanshell Sampler</a></li>
<li><a href="../250733/index.html">Introducing the Realtek RTL8954C debug card</a></li>
<li><a href="../250743/index.html">Weekly assembly Vivaldi 1.0.105.7</a></li>
<li><a href="../250745/index.html">The story of one failure (the development of the first mobile game) with conclusions and tips</a></li>
<li><a href="../250749/index.html">Where do the security gaps come from?</a></li>
<li><a href="../250753/index.html">How Linux works with memory. Yandex Workshop</a></li>
<li><a href="../250755/index.html">Configure autoscaling in InfoboxCloud</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>