<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pending Yii2 2.0.4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you probably guessed, I want to talk about Yii2 and what awaits newbies in a startup who chose this framework. It's no secret that many frameworks ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pending Yii2 2.0.4</h1><div class="post__text post__text-html js-mediator-article">  As you probably guessed, I want to talk about Yii2 and what awaits newbies in a startup who chose this framework.  It's no secret that many frameworks use symfony components in order not to reinvent the new bike.  Many, but not Yii, but at the same time Yii borrowed a lot from symfony and absorbed the best from Ruby on Rails.  On github in issues, you can often see a suggestion for expanding the functionality taken from these frameworks.  In this article, I would like to describe exactly those moments in which the Yii developers do not agree with the developers of other frameworks. <br><a name="habracut"></a><br><h2>  ActiveRecord </h2><br>  AR is a model that represents 1 entry in the repository, but few people know that in Yii the finder also hides behind the static find methods and is called ActiveQuery. <br><br><h3>  ActiveQuery </h3><br>  Consider the example of User :: find () -&gt; andWhere (['username' =&gt; 'ok']) -&gt; one (). <br><br>  At first glance, everything is logical, apart from the fact that User :: findByUsername ('ok') is used in the box in the advanced template.  But if in the first case we can get rid of the User class, passing, for example, to the constructor $ query = User :: find () -&gt; andWhere (/ * something else * /), then in the "boxed" version you need to add a condition extend the User class and <a href="https://github.com/yiisoft/yii2-app-advanced/blob/master/common/models/User.php">override the</a> work logic in the <a href="https://github.com/yiisoft/yii2-app-advanced/blob/master/common/models/User.php">findByUsername</a> method. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>It is worth noting that ActiveQuery is tied to a model class, and if you want to add a default scope, then you need to expand from the model and block the above-mentioned find method:</i> <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::find()-&gt;andWhere([<span class="hljs-string"><span class="hljs-string">'status'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'active'</span></span>]); }</code> </pre> <br>  <b>To impose a default condition on ActiveQuery, we need to extend ActiveRecord.</b> <br><br><h3>  Rules or validation </h3><br>  The <a href="http://guides.rubyonrails.org/active_record_validations.html">guide on Ruby on Rails</a> on this account says the following: <br><br><blockquote>  1.1 Why Use Validations? <br><br>  Validations are saved to your database. <br></blockquote><br>  yiisoft / core-developers do not think so, and believe that you only need to validate incoming data from the user in the form, and everything else is a problem in the hands of the programmer, i.e.  you have to catch the pdo exception yourself, if something suddenly went wrong - don't wait for validation errors.  Therefore, in the box the <a href="https://github.com/yiisoft/yii2-app-advanced/blob/master/common/models/User.php">minimum</a> data is checked before writing to the database.  Perhaps this is due to savings in performance: <br>  - all validators are created immediately when the model is initialized, regardless of the script; <br>  - <a href="https://github.com/yiisoft/yii2/blob/master/framework/helpers/BaseHtml.php">render input type = text</a> (on matches). <br><br>  By the way, about performance.  Tests posted on the Internet were performed with a minimum number of Yii code, that is, now the picture will clearly be different for the worse. <br><br>  <b>Safety or performance - everyone decides for himself.</b>  <b>In the box advanced app - performance.</b> <br><br>  But even choosing security, you can safely forget about ‚Äúboxed behaviors for attributes‚Äù that are <a href="https://github.com/yiisoft/yii2/blob/master/framework/behaviors/TimestampBehavior.php">tied to the beforeInsert and beforeUpdate</a> events, and there are only one beforeValidate events, or you need to upgrade the <a href="https://github.com/yiisoft/yii2/blob/master/framework/behaviors/TimestampBehavior.php">value property</a> with checking $ event-&gt; sender-&gt; isNewRecord. <br><br>  Also, when choosing security, you should forget about the link method, which should link two models together by foreign key.  This is due to the fact that the link method saves the model after the "re-routing" and this behavior is inevitable, and the <a href="https://github.com/yiisoft/yii2/blob/master/framework/db/BaseActiveRecord.php">saving goes without validation</a> , therefore the above-mentioned behaviors for attributes will not be worked out and we will get the exception pdo that the field is required to be filled.  We cannot validate before the link method, because for foreign keys there is a validator <a href="https://github.com/yiisoft/yii2/blob/master/framework/validators/ExistValidator.php">exist</a> that will fail, or we must do selective validation, and it is necessary to pass a white attribute list, and when adding a new attribute to the model, be ready to shovel a bunch of code. <br><br>  <b>Safety or buns out of the box - you decide.</b> <br><br><h3>  ActiveRelation </h3><br>  Here we will talk about the connection between models or the concept of a module in Yii. <br>  As is known, the module is a self-sufficient unit of application.  Consider an example: by connecting 2 User and BankAccount modules, we must link the User and UserAccount models together.  I will leave this to you as homework, as the developers themselves cannot yet give an answer to this.  That is why it seems to me, User and Rbac are in the yii box, and not in the form of extensions.  For now, let's take a look at what <a href="http://symfony.com/doc/current/cookbook/doctrine/resolve_target_entity.html">symfony</a> has come up with for a long time. <br><br>  Those who seriously decide to do the ‚Äúhomework‚Äù, it is necessary to take into account that the models cannot be configured for a number of reasons, one of them is to <a href="https://github.com/yiisoft/yii2/blob/master/framework/db/BaseActiveRecord.php">create the model as keyed</a> . <br><br>  If you decide to "homework", try to solve it again, but not blocking both models from the modules. <br><br>  <b>Let's say amicably, modules are unnecessary.</b> <br><br>  On this article will be considered complete.  In the appendage below there will be a few more bonuses, but first I want to say that I have been developing on this framework for more than 5 years (I started with yii 1.x) and I like it with my ability to configure components, but in yii2 more and more is tied to Closure, which does not allow to configure as flexibly as we would like.  Perhaps this is due to the fact that there are many <a href="https://github.com/yiisoft/yii2/issues%3Futf8%3D%25E2%259C%2593%26q%3Dlaravel">Laravel</a> fans in the community?  I would also like to thank the developers of yii2 for their contribution and work, the first pancake is always a lump, the second is better. <br><br><h4>  Bonuses </h4><br>  - In all programming languages, when calling an event, you can pass parameters to it, in Yii, parameters must be passed when the <a href="https://github.com/yiisoft/yii2/blob/master/framework/base/Component.php">handler is hung</a> ; <br>  - It happens and <a href="https://github.com/yiisoft/yii2/issues/6259">Vika</a> teaches "bydlokodit"; <br>  - Mystic <a href="https://github.com/yiisoft/yii2/issues/6289">aliases</a> (https://github.com/yiisoft/yii2/blob/master/framework/helpers/BaseFileHelper.php#L135). <br><br>  Love Yii, help the community.  If your issue is immediately wrapped up - do not worry.  It is possible that someone later will create a similar one and will not wrap it (there were also such cases).  All clean code, clear comments in it and no errors in the tests. <br><br>  PS I know that some of the developers of yii visit this resource, I would like to apologize to them.  Maybe I lied somewhere - I will be glad to any comments below. <br><br>  UPD: The proposed version of <a href="http://habrahabr.ru/users/zelenin/" class="user_link">zelenin</a> <a href="http://habrahabr.ru/post/254179/">habrahabr.ru/post/254179/#comment_8348781</a> has the right to life and even quite a worker, as for me this strange behavior of the container di.  But thanks to this behavior, I think it will turn out to make friends 2 models from different modules - later I will write about the results. </div><p>Source: <a href="https://habr.com/ru/post/254179/">https://habr.com/ru/post/254179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254167/index.html">Python, xlsx with pictures, macros, media-art, embedded objects</a></li>
<li><a href="../254171/index.html">What is good: how we developed the criteria for assessing the quality of the layout of web projects</a></li>
<li><a href="../254173/index.html">How Trendnet tricked me the 2nd time</a></li>
<li><a href="../254175/index.html">Chrome: Popular Developer Extensions</a></li>
<li><a href="../254177/index.html">PNG resize automation for iOS and Android applications</a></li>
<li><a href="../254183/index.html">About MAC tables in switches</a></li>
<li><a href="../254185/index.html">DIY control of Dom.ru TV from a tablet using arduino</a></li>
<li><a href="../254187/index.html">Record of the webinar "Certified FSTEK version of Kerio Control 8.2"</a></li>
<li><a href="../254193/index.html">IBM invites to the Innovations in Business with IBM Cloud webinar</a></li>
<li><a href="../254195/index.html">Dart for the whole web</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>