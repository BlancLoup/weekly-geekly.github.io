<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Readable Naming Tests in JS and Behavioral Pattern</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the next review of Thick Pull Request, I came across Unit Test's with incorrectly naming test cases. The discussion of the wording in the test ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Readable Naming Tests in JS and Behavioral Pattern</h1><div class="post__text post__text-html js-mediator-article"><p>  During the next review of Thick Pull Request, I came across Unit Test's with incorrectly naming test cases.  The discussion of the wording in the test cases turned out to be similar to the conversation of Janicara and Legkostupov in the movie "72 meters" ("if I was so lucid at school ...").  In the conversation, the thought was sounded that in Russian-speaking resources it is difficult to find an intelligent guide precisely by textual formulations.  I decided to look for myself in Russian (usually I use only English-language sources).  On Habr√©, I found several manuals about unit tests, but they all bypass the details of the wording in the test cases.  Under the cut, my attempt to fill this gap. </p><a name="habracut"></a><br><h3 id="disklemer">  Disclamer </h3><br><p>  There is a chance that I was looking bad / too diagonally read.  Here is an example of how the topic of this article is covered in those articles that caught my eye. </p><br><p><img src="https://habrastorage.org/webt/xj/85/eu/xj85eux2nk1lxg3fjcdxhbo-0_y.png"><br>  <a href="https://habr.com/ru/post/82842/">TDD for beginners</a> </p><br><p>  At the request of colleagues who are not comfortable reading manuals in English, I decided to translate and compile English manuals. </p><br><h3 id="ot-perevodchika">  From translator </h3><br><p>  The basis for the article took these two materials: </p><br><ul><li>  <a href="https://medium.com/%40yahelyechieli/5-tips-for-writing-great-javascript-unit-tests-86296ad2d997">5 Tips for Writing Great Javascript Unit Tests</a> </li><li>  <a href="https://github.com/mawrkus/js-unit-testing-guide">A guide to unit testing in JavaScript</a> </li></ul><br><p>  I also have to note that in some examples of tests I had to do a partial translation into Russian.  The wording in the blocks "describe" deliberately remain in English, because  most likely they will contain the name of functions, JS modules or other entities in the code, but the text is already translated in read-only blocks in "it" blocks. </p><br><p>  <em>My personal preference is that everything in the code should be in English.</em> </p><br><h3 id="imenovanie-testov">  Naming tests </h3><br><p>  The name of the test should describe its purpose as briefly and explicitly as possible.  The name and description of the test is the first thing that should indicate the cause of the fault.  The test result in the console must be read correctly in terms of grammar.  Third-party developers should not solve rebuses in their heads, trying to guess what the test author was thinking.  Tests are part of the program documentation and must also be written correctly. </p><br><p>  <strong>BAD</strong> example: </p><br><pre><code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'discoveryService =&gt; initDiscoveries'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">' discoveries ( ,    ..)'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// ... }); }); describe('MyGallery', () =&gt; { it('init      ( , - )', () =&gt; { }); // ... });</span></span></code> </pre> <br><p>  From the examples above, it is difficult to understand what specific action (actions) is performed and to which specific result the action should lead. </p><br><p>  <strong>GOOD</strong> EXAMPLE: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'discoveryService =&gt; initDiscoveries'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'   discoveries'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// ... }); it('     discoveries', () =&gt; { // ... }); }); describe(' Gallery', () =&gt; { it('       ', () =&gt; { }); it('       ', () =&gt; { }); // ... });</span></span></code> </pre> <br><p>  <em>Note</em>  <em>trans.</em>  <em># 1: note, the block of text in <strong>it</strong> begins with a lowercase, because</em>  <em>is a continuation of the sentence that began in <strong>descibe</strong> .</em> </p><br><p>  <em>Note</em>  <em>trans.</em>  <em># 2: in the examples above, "discoveryService =&gt; initDiscoveries" is more correct to break into two <strong>descibe</strong> blocks (one is nested in the other).</em> </p><br><p>  <em>Note</em>  <em>trans.</em>  <em># 3: note, in the examples about discovery above there is no second part of the description of the test case;</em>  <em>it implies the text of the form "when it is called", which is not very good in terms of clarity;</em>  <em>in simple cases, copy-paste "when it is called" is not particularly profitable, IMHO.</em> </p><br><p>  The description of elementary work (Unit of Work, UoW) is usually placed in the <strong>describe</strong> block.  The statement in the <strong>it</strong> block should continue the pattern " <strong>unit of work - scenario / context - expected behavior</strong> ", which began in the describe: <br> <code>[ ]  [  / ]  (  | ) [     ]</code> </p> <br><p>  or in the form of code: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'[unit of work]'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">' [ ] / [/]'</span></span>, () =&gt; { }); });</code> </pre> <br><p>  If several test groups follow the same scenario or fit into the same context, then you can use <strong>describe</strong> nested blocks. </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'[unit of work]'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'// [scenario/context]'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'/ [expected behaviour]'</span></span>, () =&gt; { }); }); }); describe(<span class="hljs-string"><span class="hljs-string">' Gallery'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">' '</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'    '</span></span>, () =&gt; { }); it(<span class="hljs-string"><span class="hljs-string">'    '</span></span>, () =&gt; { }); }); <span class="hljs-comment"><span class="hljs-comment">// ... });</span></span></code> </pre> <br><h3 id="odin-test---odna-problema">  ONE TEST - ONE PROBLEM </h3><br><p>  Each test should focus on one specific scenario in the operation of the application.  A test responsible for one particular aspect is able to identify the specific cause of the fault.  The more specific the test, the less likely it is that there may be several reasons for incorrect behavior.  Try to place only one <strong>expect</strong> block in one block. </p><br><p>  <strong>BAD</strong> example: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'isUndefined function'</span></span>, ()=&gt; { it(<span class="hljs-string"><span class="hljs-string">'  true or false    undefined'</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }); });</code> </pre> <br><p>  The <strong>it</strong> block contains two <strong>expect</strong> blocks.  This means that the developer, seeing a negative result of this test, will not be able to determine exactly what is specific in his code incorrectly and how to fix it. </p><br><p>  <strong>GOOD</strong> EXAMPLE: </p><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">'isUndefined function'</span></span>, ()=&gt; { it(<span class="hljs-string"><span class="hljs-string">'  true,    undefined'</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); }); it(<span class="hljs-string"><span class="hljs-string">'  false      '</span></span>, () =&gt; { expect(isUndefined(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)).toEqual(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); }); });</code> </pre> <br><p>  Each test in the example above evaluates one particular problem.  In addition, the test description clearly describes in which case it will be passed.  In both cases in the console, the developer will read in the form of a list which results under what actions / conditions are expected from the user functionality being tested. </p><br><h3 id="testiruem-povedenie">  Testing Behavior </h3><br><p>  Look at the picture, do not look at the strokes.  Test custom script / behavior, not implementation details.  Then changing the details of the implementation will not affect the test results.  A negative test result should indicate whether the program behaves correctly or not from the user's point of view.  The test should not control / limit implementation details. </p><br><p>  <strong>BAD</strong> example: </p><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'   discovery  '</span></span>, () =&gt; { discoveriesCache.addDiscovery(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>); expect(discoveriesCache._discoveries[<span class="hljs-number"><span class="hljs-number">0</span></span>].id).toBe(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>); expect(discoveriesCache._discoveries[<span class="hljs-number"><span class="hljs-number">0</span></span>].name).toBe(<span class="hljs-string"><span class="hljs-string">'John'</span></span>); });</code> </pre> <br><p>  What is bad here?  First, the two blocks <strong>expect</strong> , but this is not important.  Secondly, it is not the behavior that is tested, but implementation details.  The implementation details will change (private fields are renamed) - the test will become invalid and will need to be rewritten. </p><br><p>  <strong>GOOD</strong> EXAMPLE: </p><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'   discovery  '</span></span>, () =&gt; { discoveriesCache.addDiscovery(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>); expect(discoveriesCache.isDiscoveryExist(<span class="hljs-string"><span class="hljs-string">'57463'</span></span>, <span class="hljs-string"><span class="hljs-string">'John'</span></span>)).toBe(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); });</code> </pre> <br><p>  This example tests the public API, which should be as stable as possible. </p><br><h3 id="zaklyuchenie-ot-perevodchika">  CONCLUSION FROM TRANSLATOR </h3><br><p>  "Onegin was a pedant ..." I get the impression that most developers are not paying enough attention to the accuracy and readability of test names.  I often observe quite lengthy discussions of the form ‚ÄúWhat does this code do‚Äù or ‚ÄúWhy does this code do‚Äù.  This applies to both the main code in JS (unclear, fuzzy names of modules, services, functions, and variables) and tests (fuzzy cases, testing implementation details, fuzzy descriptions).  All this leads to the fact that the code does not exactly what is expected. </p><br><p>  In one of his interviews, David Heinemeier Hansson (creator of the Rails framework) said something like the following: <br>  "Unit tests only show what your program does in the expected way%: o." </p><br><p>  He meant that it is necessary to test the behavior, not the code units.  And textual formulations should have a behavioral pattern.  Those.  "Essence A must behave this way under such and such conditions."  A chain of the type <strong>describe</strong> [- <strong>describe</strong> ] - <strong>it</strong> - <strong>expect</strong> should turn into such a folding formulation. </p><br><p>  Thanks for attention! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/454884/">https://habr.com/ru/post/454884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454872/index.html">Space Invaders: now in 512 bytes (Assembler x86)</a></li>
<li><a href="../454874/index.html">A little bit about multitasking in microcontrollers</a></li>
<li><a href="../454876/index.html">About designing a flexible system of character abilities in games</a></li>
<li><a href="../454878/index.html">We study MITER ATT & CK. Mobile Matrices: Device Access. Part 3</a></li>
<li><a href="../454880/index.html">"Off-season" in the life of a freelancer: how to survive and survive?</a></li>
<li><a href="../454886/index.html">In the liver sits. Why removal of liver tumors is an indicator of the surgeon's superior skill</a></li>
<li><a href="../45489/index.html">Unicode Normalization</a></li>
<li><a href="../454894/index.html">WWDC 2019 :: what to see</a></li>
<li><a href="../454896/index.html">Why I changed my freelance to a remote team</a></li>
<li><a href="../454898/index.html">Programming is more than coding</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>