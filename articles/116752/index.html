<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Draw widgets in the title bar</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It's no secret that today the population is dominated by widescreen monitors and they are forced to save the number of pixels vertically. This spawned...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Draw widgets in the title bar</h1><div class="post__text post__text-html js-mediator-article">  It's no secret that today the population is dominated by widescreen monitors and they are forced to save the number of pixels vertically.  This spawned a fashion for drawing controls right in the window title.  Now you won‚Äôt surprise anyone, but, nevertheless, I haven‚Äôt found a solution to this problem anywhere on Qt, so now we‚Äôll fix it: <br><img src="https://habrastorage.org/getpro/habr/post_images/cd7/d46/d0b/cd7d46d0b6554443c1a2c7ec4443964f.png"><br><a name="habracut"></a><br><br>  In the dark dungeons of our qutIM <a href="https://gitorious.org/qutim/labs">lab</a> , the ToolFrameWindow class was born, which is in many ways similar to such classes as QMainWindow and QToolBar.  WinAPI ordeal I will not describe, do not want to clutter the article.  To achieve this effect, it is necessary to expand the client area to the whole window and process the cursor position with your hands so that you can move and resize the window.  At the same time, transparency disappears, QtDWM helps us to return it. <br><br><h5>  Next, I would like to describe the principle of its use: </h5>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First of all, you need to give it a widget, for which we will draw in the button header, this is done through a call to the setCentralWidget method <br><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">ToolFrameWindow w; <br> Form form; <br> w.setCentralWidget(&amp;form);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">ToolFrameWindow w; <br> Form form; <br> w.setCentralWidget(&amp;form);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">ToolFrameWindow w; <br> Form form; <br> w.setCentralWidget(&amp;form);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br><br>  This is done in such a way that it is as easy as possible to ensure the transfer of already existing code and not create difficulties on other platforms. <br><br><h6>  Adding action: </h6><br>  Buttons are added to the header using the addAction method, you can also add empty space addSpace or add the separator addSeparator. <br><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">QAction action(&amp;w); <br> w.addSpace(16); <br> w.addAction(&amp;action); <br> w.addSeparator();</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">QAction action(&amp;w); <br> w.addSpace(16); <br> w.addAction(&amp;action); <br> w.addSeparator();</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">QAction action(&amp;w); <br> w.addSpace(16); <br> w.addAction(&amp;action); <br> w.addSeparator();</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br><br><h6>  Adding tabs, buttons, labels and other widgets: </h6><br><br>  Especially for adding all this ugliness, the addWidget method was provided, when adding, you can specify an alignment through Qt :: Aligment, which allows you to make buttons like in the screenshot.  As for the button itself, it is made from QPushButton using qss styles, in particular, border-image helped a lot <br><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">QPushButton btn; <br> btn.setIcon(QIcon( <font color="#A31515">":/ubuntu.png"</font> )); <br> btn.setStyleSheet( <font color="#A31515">"QPushButton { "</font> <br> <font color="#A31515">"border: 5px;"</font> <br> <font color="#A31515">"border-image: url(:/button.png);"</font> <br> <font color="#A31515">"}"</font> ); <br> btn.setMinimumSize(64, 22); <br> btn.setMaximumSize(64, 22);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">QPushButton btn; <br> btn.setIcon(QIcon( <font color="#A31515">":/ubuntu.png"</font> )); <br> btn.setStyleSheet( <font color="#A31515">"QPushButton { "</font> <br> <font color="#A31515">"border: 5px;"</font> <br> <font color="#A31515">"border-image: url(:/button.png);"</font> <br> <font color="#A31515">"}"</font> ); <br> btn.setMinimumSize(64, 22); <br> btn.setMaximumSize(64, 22);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  To draw a glow under the text, I tried using QGraphicsDropShadowEffect, but the glow strength was too small.  This led to some confusion, but I remembered the good old border-image and decided to make a knight's move: draw the glow as a picture and impose it as a border-image <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">QLabel lbl(QObject::tr( <font color="#A31515">"Glow caption. Text with glow"</font> )); <br> lbl.setStyleSheet( <font color="#A31515">"QLabel {border-image: url(:/background.png);border: 5px; }"</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  It turned out not quite perfect, there is still much to strive for in choosing the right parameters and dimensions of the glow, but in general this solution is quite simple and at the same time flexible. <br><br>  I want to note that Qt sometimes breaks the roof of the fact that the widget's space has expanded due to the title.  For example, now pos () can take negative values, although this should ideally not be. <br><br><h5>  Conclusion </h5><br><br>  One small screenshot: <br><img src="https://habrastorage.org/storage/6af22209/2a172050/876ccaa8/c81b2c1f.png"><br>  The bravest can try this <a href="http://narod.ru/disk/9183225001/libsimplecontactlistwidget.dll.html">plugin.</a>  But he is still not frankly endorsed, we will talk about it later. <br><br>  Many thanks to <a href="https://habrahabr.ru/users/dtf/" class="user_link">dtf</a> for the war with APIs and for the implementation of all winAPI methods.  The library code is available in <a href="https://gitorious.org/qutim/labs/trees/habrahabr">gitorious</a> (download habrahabr tag).  The license is currently GPLv2.  To use it in your code, just copy the necessary files to your project, the test program is located in the wincaption directory. </div><p>Source: <a href="https://habr.com/ru/post/116752/">https://habr.com/ru/post/116752/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116740/index.html">Intuitive revision of Vote Up / Down and User Karma (joyful emotions of a new drupalist)</a></li>
<li><a href="../116741/index.html">Django PR Hero project: what's inside and the experience gained</a></li>
<li><a href="../116747/index.html">Once again about port forwarding due to firewall</a></li>
<li><a href="../116748/index.html">Motorola Milestone 2 Review</a></li>
<li><a href="../116749/index.html">Microcomputer BK 0010-01</a></li>
<li><a href="../116753/index.html">IT in medicine: the way of the USA</a></li>
<li><a href="../116754/index.html">Pop-up flash message from the depths of background tasks</a></li>
<li><a href="../116759/index.html">Adding Input Method to Arduino</a></li>
<li><a href="../116760/index.html">Haskell Tutorial on the other hand</a></li>
<li><a href="../116761/index.html">Encrypt files in black and white images.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>