<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why are VR shots so lame, and what to do about it?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Throws - one of the first actions that players try in virtual reality. We take a virtual mug with coffee and throw it away. A mug, donut or ball begin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why are VR shots so lame, and what to do about it?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/683/767/794/68376779475943fea1b883e9a683091c.gif"><br><br>  Throws - one of the first actions that players try in virtual reality.  We take a virtual mug with coffee and throw it away.  A mug, donut or ball begins to spin wildly.  You do not have time to look back, as the player is already throwing flower pots at the training bot. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Job simulator</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/0b5/4f1/260/0b54f1260a87b0ad8c7b8f71a2704bec.gif" alt="image"></div></div><br>  Some throws are too strong.  Others are extremely weak.  Once or twice it still manages to get into the pursued NPC.  Probably the very first lesson in VR is definitely quite difficult to throw.  When I experienced this feeling, I first thought that I was not playing well in VR.  We consider it natural that mastering the control scheme is part of the learning curve of the game.  But when the throws of the same movements lead to completely different results, it is very frustrating. <br><br>  A sharp throw with a swing ends with a short flight of the subject ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Trying to throw a bottle of water with a swing</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/a7e/5c3/32e/a7e5c332ec645677466a84af6006f439.gif" alt="image"></div></div><br>  ... and a slight wave of the wrist can send an item on a long flight. <br><br><div class="spoiler">  <b class="spoiler_title">I just moved my wrist slightly ...</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/f56/9d0/7fb/f569d07fb4a316f6991f0575ef87a702.gif" alt="image"></div></div><br><h4>  Rescuties: tossing children </h4><br>  This summer I worked on a casual action game called <a href="http://rescuti.es/">Rescuties</a> .  This is a VR game about throwing and catching children and other cute animals. <br><br>  If in the virtual reality the world reacts to our actions counterintuitively, it interferes with players immersion in the process or strains them.  The whole gameplay is about throwing, so the Rescuties could not rely on such an inherently uncomfortable mechanic. <br><br><div class="spoiler">  <b class="spoiler_title">Rescuties</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/8d8/6c2/254/8d86c2254850da71945504827098cb32.gif" alt="image"></div></div><br>  Irritation is an integral part of the design of such games.  In short, it is difficult to throw in VR, because it is <strong>impossible to feel the weight of a virtual object</strong> .  Approaches may be different, but in most games they strive to make the physics of a virtual object as plausible as possible.  The player grabs the object, gives him a virtual impulse, and he flies away. <br><br>  But here's the problem: there is a difference between what the player feels in his hand and what is happening in the virtual world.  When the virtual object is lifted, the center of gravity of the object and the center of gravity felt in the hand do not match.  <strong>Muscles get the wrong data.</strong> <br><br>  If a player simply shoved his hands in some direction during a throw, this discrepancy would not be very important.  But when throwing, he bends his arm and turns his wrist.  (What is the secret of a good throw? ‚ÄúIt's all in the wrist!‚Äù) When you turn your real hand, the player applies an unnecessary moment to the virtual object, as if he is throwing it with a small spoon. <br><br>  This is a very uncompromising phenomenon.  In many VR games, the user can ‚Äúpick up‚Äù an object that is half a meter away from his hand.  When you press the button, the object flies into the hand, but remains at a constant distance, turning the hand into a catapult.  The difference between seven and thirty centimeters can mean that the movement of the wrist will cause the object to fly across the room or just slightly push it forward. <br><br><div class="spoiler">  <b class="spoiler_title">Wrist movement like a catapult</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/407/c25/250/407c252502655a04948f8b1e44adafe3.gif" alt="image"></div></div><br>  In Rescuties, the player catches flying children quickly and seeks to transfer them to a safe place as soon as possible.  Using the traditional approach led to too whimsical management and annoying gameplay.  ‚ÄúWhy can't I just throw the baby the way I feel is right?‚Äù <br><br><h4>  Physical and virtual weight </h4><br>  The key to successful throwing mechanics is to consider how control is felt by the user, and not what the physics of the game offers. <br><br>  Instead of measuring the speed of throwing a virtual object that the player is holding.  you need to perform measurements for the <i>object that the player</i> is <i>holding</i> - the real object, i.e.  controller HTC Vive or Oculus Touch.  It is his weight and the moment he feels in his hand.  And his muscular memory (physical skill and instinct that developed during his life) responds to this weight and moment. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3bc/38d/4a9/3bc38d4a989396039a5aead9734c31c0.png" alt="image"><br>  <i>The center of gravity felt by the player does not change, no matter what virtual object he raises</i> <br><br>  You can link physical and virtual weight to determine in-game speed using the center of gravity of the physical controller.  First, you need to determine where this real center of gravity is in the game.  Controllers report their location in the game space.  The player himself can take a look from under the head-mounted display to calibrate the position of the center of gravity.  When tracking this point relative to the controller, the speed is calculated when its position changes. <br><br>  After making these changes, the testers started playing Rescuties much better, but I still saw and felt a strong discrepancy. <br><br>  (There are interesting considerations in <a href="https://medium.com/%40B__REEL/simulating-weight-in-vr-d161e87990b">this article</a> about transferring information about virtual weight to players. This approach is the opposite; instead of maximally using the physical sensations of the controller's weight, it gives the user virtual signals about the behavior of virtual objects.) <br><br><h4>  Timing </h4><br>  At what exact moment the player intends to throw the object? <br><br>  In real life, when throwing, we relax our fingers, the object breaks out of the grip, and the fingertips continue to push it in the right direction until we lose control of it at all.  We can twist or roll the object to the very last split second. <br><br>  Instead of such tactile feedback in most VR games, a trigger is used under the index finger.  This is better than a button: in Rescuties, pressing a trigger by 20% squeezes a virtual glove by about 20%, and a 100 percent press squeezes a fist completely.  But the player will not feel the object, breaking out of the grip and sliding on the fingers.  The release of the fingers described above is implemented by simply releasing the trigger (possibly gradual).  I found out that you need to determine the throw signal from the player immediately when he starts to relax his fingers.  Throws are recognized when the pressure on the trigger is weakened, not only to 0% or to a small value, but to the experimentally found one. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b7f/791/141/b7f791141db0f06f43335e1d5c60e0c9.png" alt="image"><br><br>  The graph shows the change in pressure on the trigger in the cycle "grab-hold-throw".  In this case, the user does not click on the trigger 100%.  This is often the case, because with HTC controllers, the trigger can be easily pressed up to about 80%, and then you need to put much more effort to press up to 100%.  First, the player presses the trigger to raise the object.  Then the pressure is more or less constant.  because the player captures the object and swings for a throw.  There is a slight noise of the trigger sensor.  The player releases the trigger when throwing or throwing the object. <br><br>  The noise of the signal and the pulse of the player can lead to fluctuations in the force of pressing the trigger.  Therefore, the required threshold recognition of player actions.  In particular, this means that the game registers the ejection, when the pressure on the trigger (for example) is 20% less than the peak pressure recorded when the player lifts the object.  The threshold should be large enough so that the player does not accidentally drop the child.  We found the required value with testers by trial and error.  In addition, if one recognizes an action as a seizure with too little pressure, there will not be enough interval for a reliable determination of a throw or release.  You will get the same thing that I have in one of the unsuccessful iterations: a strange super-fast cycle ‚Äúlift-throw-lift-throw‚Äù. <br><br><h4>  Speed ‚Äã‚Äãnoise </h4><br>  Measuring the correct speed and improving the timing well enough to reduce the effect of the mismatch of shots.  But the initial data themselves - the speed measurements coming from the equipment sensors - are quite noisy.  Noise is especially noticeable when the head-mounted display or controllers move quickly.  (Let's say when a player throws something!) <br><br>  Working with noise requires smoothing. <br><br>  I tried to smooth the speed with a moving average (also known as a low-pass filter), but as a result, only the slowest (swing) and fastest (release) stages of the throw were averaged.  It seemed to my testers that it was very difficult to throw, as if they were under water.  (This is what I used to feel in the Rec Room game.) <br><br><div class="spoiler">  <b class="spoiler_title">Averaging the speed of the controller gives reliable, but too slow results, completely different from the sensations in Job Simulator</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/e3b/0d6/979/e3b0d6979c281847b02cb6b2aaf34f7c.gif" alt="image"></div></div><br>  I tried to take the peak values ‚Äã‚Äãof the last measured speeds, and at least the testers children began to fly at the speed with which they wanted, but not always in the right direction, because the last measured direction was also exposed to noise. <br><br>  I needed to take a few last frames of measurements, and observe how they develop, i.e.  draw a trend line.  Simple linear regression of measurements gave us a much more reliable result.  Finally I managed to throw the children when and where I want! <br><br><div class="spoiler">  <b class="spoiler_title">The debug visualization of speed shows in red the last four frames of the measured speed, and in yellow - the result of the regression used in the game.</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/58c/c18/117/58cc18117a12f3c997679773cc4f5f5b.gif" alt="image"></div></div><br><h3>  How I refined the shots in the Rescuties (tl; dr) </h3><br><ul><li>  We measure the speed of the throw from the center of gravity, which is felt by the user, that is, from the center of gravity of the controller. </li><li>  We recognize the shot exactly at the moment when the player is going to throw, i.e.  with partial release of the trigger. </li><li>  We transform most of the measured velocity data by regression in order to better evaluate the player‚Äôs intentions. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/707/8d8/7b1/7078d87b1ac30b032c695b7d74499544.png" alt="image"><br><br>  If you are interested in testing these different approaches and comparing them, in the Rescuties there is a ‚ÄúLabs!‚Äù Menu where you can switch between different throw modes, choose a way to measure speed and control the number of measurement frames used for regression / smoothing. <br><br>  But this problem is by no means solved.  In VR games, there are many different approaches to shots, and players like them.  When creating throws in Rescuties, I wanted to make the physical expectations of muscle memory correspond as closely as possible to the sensations in virtual reality of flying kids.  Now they are much better, but I want to further improve them. <br><br>  Therefore, any suggestions on my approach and any criticism are welcome: you can contact me on <a href="http://twitter.com/bigblueboo">Twitter</a> or by <a href="">mail</a> at any time. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b3b/004/7a2/b3b0047a20f1b58eb15fbfc82e72d493.gif" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/319250/">https://habr.com/ru/post/319250/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319240/index.html">iOS: Work with the gallery (Photos framework). Part 2</a></li>
<li><a href="../319242/index.html">Mobile OCR. How it all began (part 2)</a></li>
<li><a href="../319244/index.html">BLE under the microscope</a></li>
<li><a href="../319246/index.html">How can I save on taxes 13.3 times</a></li>
<li><a href="../319248/index.html">Skype Out vs Out vs Tviggo vs Signal</a></li>
<li><a href="../319252/index.html">Puzzle on STL associative containers or How to solve one problem in eight very different ways</a></li>
<li><a href="../319254/index.html">"How do games": a two-hour talk about the monetization of online games</a></li>
<li><a href="../319256/index.html">First steps with STM32 and mikroC compiler for ARM architecture - Part 2, continued</a></li>
<li><a href="../319258/index.html">Oracle APEX: Interactive Report with Checkboxes</a></li>
<li><a href="../319260/index.html">Develop and publish a game for Android in a week</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>