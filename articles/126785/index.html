<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Detecting 2D object collisions in the Marmalade SDK</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! I want to share my experience in developing applications for the Marmalade SDK. 

 I want to remind you that Marmalade is a great tool f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Detecting 2D object collisions in the Marmalade SDK</h1><div class="post__text post__text-html js-mediator-article"><img src="http://lh5.googleusercontent.com/-4z06P9K3CtU/TlIaYhXSCDI/AAAAAAAAAEc/3vkn8w_GV8U/s290/marmalade.png" alt="Marmalade" align="left">  Hello to all!  I want to share my experience in developing applications for the Marmalade SDK. <br><br>  I want to remind you that Marmalade is a great tool for creating multiplatform applications.  You can write applications for both LG TVs and mobile devices (based on Android, Bada, iOS, Symbian and Windows Mobile). <br>  In this article you will find: <br><ul><li>  the process of creating an application under the Marmalade SDK; </li><li>  collision detection of convex polygons using projection construction; </li><li>  determination of the reaction to the collision (the withdrawal of the object by the minimum path). </li></ul><br><br>  A little preface.  Once, for one project, I needed to implement a check for collisions of various objects.  And I was very surprised by the fact that, despite the fact that almost no game can do without checks for collision and intersection of objects, it is not so easy to find ready-made solutions and simple examples for such a task.  Especially with more or less clear explanations.  I had to implement independently. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I want to warn you in advance that all the code in the article is written in C ++. <br><a name="habracut"></a><br>  A description of collision checking was found at one of the sites using projection construction.  This method is relatively simple and fast enough.  Probably the biggest drawback is that it is suitable only for convex polygons.  But this problem can be solved by dividing a concave polygon into two or more convex ones. <br><br>  So let's start with the simple creation of a Marmalade project. <br><br>  In Marmalade, everything starts with the file mkb, so consider it.  Create a file in the project folder <b>test2d.mkb</b> and the <b>source</b> folder.  In the mkb file we write the following: <br><br> <code>#!/usr/bin/env mkb <br> files { <br> [Source] <br> (source) <br> main.cpp <br> entity.cpp <br> entity.h <br> } <br> subprojects { <br> iw2d <br> } <br></code> <br><br>  In the "files" tag we describe the list of files of our project.  We will only have three files that are in the ‚Äúsource‚Äù folder (indicated by the contents of the parentheses).  In the ‚Äúsubprojects‚Äù tag, we will list the Marmalade libraries that we will use.  In this case, we only have an ode library for working with 2d graphics. <br><br>  Create three empty files (main.cpp, entity.cpp and entity.h) in the ‚Äúsource‚Äù folder, and then run test2d.mkb.  As a result, Marmalade will generate the necessary data for the development environment (in my case, this is the ‚Äúbuild_test2d_vc10‚Äù folder for Visual Studio), as well as the ‚Äúdata‚Äù folder with the project settings. <br><br>  The project has been created, now let's start writing the code. <br><br>  The primary task is as follows: <br><ul><li>  create several objects on the scene; </li><li>  we realize the management of one of the objects (the control will be carried out by the keyboard: arrows - movement, 1 and 2 - rotation); </li><li>  We implement a check for collisions of a managed object with the rest of the objects in the scene, as well as provide an adequate response to the collisions. </li></ul><br><br><img src="http://lh3.googleusercontent.com/-tdPTJ0dxUYg/TkvBiJQrcuI/AAAAAAAAAEE/Y_zV6-VoOMQ/s800/screen1.png" alt="image"><br><br>  So, consider the code of the main.cpp file, in which we will perform initialization, create the necessary shapes and objects, implement the main application loop, and also perform data cleansing when the application terminates. <br><br><pre> <code class="cpp hljs"> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"iw2d.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"iwArray.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"entity.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"s3eKeyboard.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"s3eDevice.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;time.h&gt; #include &lt;s3e.h&gt; #define FPS 30 #define MOVE_SPEED 100 #define OBJECT_DIMENSION 50 /***************************************************************/ int main(int argc, char* argv[]) { s3eResult result = S3E_RESULT_SUCCESS; /*      2D  */ Iw2DInit(); /*    */ uint32 width = Iw2DGetSurfaceWidth(); uint32 height = Iw2DGetSurfaceHeight(); /*    "" */ int wall_size = MAX(width, height); /*    */ CIwArray&lt;CEntity*&gt; arr_objects; /*  3    */ /*    */ CIwSVec2 m_Verts1[5]; CIwSVec2 m_Verts2[4]; CIwSVec2 m_Verts3[4]; /*  1 */ m_Verts1[0] = CIwVec2(-OBJECT_DIMENSION, -OBJECT_DIMENSION); m_Verts1[1] = CIwVec2(OBJECT_DIMENSION, -OBJECT_DIMENSION); m_Verts1[2] = CIwVec2(OBJECT_DIMENSION, 0); m_Verts1[3] = CIwVec2(0, OBJECT_DIMENSION); m_Verts1[4] = CIwVec2(-OBJECT_DIMENSION, OBJECT_DIMENSION); /*  2 */ m_Verts2[0] = CIwVec2(-OBJECT_DIMENSION/2, OBJECT_DIMENSION + OBJECT_DIMENSION/2); m_Verts2[1] = CIwVec2(OBJECT_DIMENSION/2, OBJECT_DIMENSION/2); m_Verts2[2] = CIwVec2(OBJECT_DIMENSION/2, -OBJECT_DIMENSION/2); m_Verts2[3] = CIwVec2(-OBJECT_DIMENSION/2, -OBJECT_DIMENSION/2); /*  3:  */ m_Verts3[0] = CIwVec2(-5, wall_size/2); m_Verts3[1] = CIwVec2(5, wall_size/2); m_Verts3[2] = CIwVec2(5, -wall_size/2); m_Verts3[3] = CIwVec2(-5, -wall_size/2); /*  ,    */ /*  ,     */ CEntity *main_object = new CEntity(CIwSVec2(width/2, height/2), &amp;m_Verts2[0], 4, 0xFFff0000); arr_objects.append(main_object); /*         ,   . */ CEntity *tmp_object = new CEntity(CIwSVec2(width/2, height/2), &amp;m_Verts1[0], 5, 0xFF0000ff); tmp_object-&gt;SetAngle(IW_ANGLE_PI/3); arr_objects.append(tmp_object); tmp_object = new CEntity(CIwSVec2(50, 50), &amp;m_Verts1[0], 5, 0xFF0000ff); tmp_object-&gt;SetAngle(IW_ANGLE_PI/2); arr_objects.append(tmp_object); /*  4 "" */ tmp_object = new CEntity(CIwSVec2(0, height/2), &amp;m_Verts3[0], 4, 0xFFff0000); arr_objects.append(tmp_object); tmp_object = new CEntity(CIwSVec2(width, height/2), &amp;m_Verts3[0], 4, 0xFFff0000); arr_objects.append(tmp_object); tmp_object = new CEntity(CIwSVec2(width/2, 0), &amp;m_Verts3[0], 4, 0xFFff0000); tmp_object-&gt;SetAngle(IW_ANGLE_PI/2); arr_objects.append(tmp_object); tmp_object = new CEntity(CIwSVec2(width/2, height), &amp;m_Verts3[0], 4, 0xFFff0000); tmp_object-&gt;SetAngle(IW_ANGLE_PI/2); arr_objects.append(tmp_object); /*     */ int time_between_frames = 1000/FPS; /*    */ uint32 timer = (uint32)s3eTimerGetMs(); while(result == S3E_RESULT_SUCCESS) { /*    */ s3eKeyboardUpdate(); /*     .    . */ if (s3eDeviceCheckQuitRequest()) break; /*       .      */ uint32 now_time = (uint32)s3eTimerGetMs(); int delta = now_time - timer; if (delta &lt; 0) delta = 0; /*        */ main_object-&gt;Move(CIwSVec2::g_Zero); main_object-&gt;Rotate(0); /*             */ if ( (s3eKeyboardGetState(s3eKeyLeft) &amp; S3E_KEY_STATE_DOWN) ) { main_object-&gt;Move(CIwSVec2(-MOVE_SPEED, 0)); } else if ( (s3eKeyboardGetState(s3eKeyRight) &amp; S3E_KEY_STATE_DOWN) ) { main_object-&gt;Move(CIwSVec2(MOVE_SPEED, 0)); } else if ( (s3eKeyboardGetState(s3eKeyUp) &amp; S3E_KEY_STATE_DOWN) ) { main_object-&gt;Move(CIwSVec2(0, -MOVE_SPEED)); } else if ( (s3eKeyboardGetState(s3eKeyDown) &amp; S3E_KEY_STATE_DOWN) ) { main_object-&gt;Move(CIwSVec2(0, MOVE_SPEED)); } if ( (s3eKeyboardGetState(s3eKey1) &amp; S3E_KEY_STATE_DOWN) ) { main_object-&gt;Rotate(-IW_ANGLE_PI / 2); } else if ( (s3eKeyboardGetState(s3eKey2) &amp; S3E_KEY_STATE_DOWN) ) { main_object-&gt;Rotate(IW_ANGLE_PI / 2); } /*    */ Iw2DSurfaceClear(0xffffffff); /*    */ for(int i=0; i &lt; (int)arr_objects.size(); ++i) { arr_objects[i]-&gt;Update(delta); } /*     ().      . */ main_object-&gt;SetColour(0xff00ff00); /*      ,   . */ int try_count = 10; bool b_collide; do{ b_collide = false; /*      */ for(int i = 0; i &lt; (int)arr_objects.size(); ++i) { /*       */ if(arr_objects[i] != main_object){ /*  .  vec_reaction  ,   . */ CIwVec2 vec_reaction = main_object-&gt;CollideRect(arr_objects[i], true); if(!vec_reaction.IsZero()){ main_object-&gt;SetColour(0xff000000); b_collide = true; } } } --try_count; /*      ,   ""  ,      . */ } while(b_collide &amp;&amp; try_count &gt; 0); /*    */ for(int i=0; i &lt; (int)arr_objects.size(); ++i) { arr_objects[i]-&gt;Render(); } /*     */ Iw2DSurfaceShow(); /*        . */ int32 wait_time = (uint32)time_between_frames - ((uint32)s3eTimerGetMs() - now_time); if(wait_time&lt;0)wait_time = 0; timer = now_time; s3eDeviceYield(wait_time); } /*      */ for(int i=0; i &lt; (int)arr_objects.size(); ++i) { delete arr_objects[i]; } /*   */ arr_objects.clear_optimised(); /*       2d . */ Iw2DTerminate(); return 0; }</span></span></span></span></code> </pre><br><br>  It seems to be nothing complicated.  Now let's consider the objects themselves, in which the following features will be implemented: <br><ul><li>  the object has a shape and color; </li><li>  the object can change position (move) and rotate; </li><li>  the object can react to collisions with other objects; </li><li>  an object can draw itself; </li></ul><br>  Let's look at the description of our class of objects (entity.h file).  It fairly clearly describes the capabilities of the object. <br><br><pre> <code class="cpp hljs"> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"iw2d.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"iwArray.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"IwMath.h"</span></span></span><span class="hljs-meta"> class CEntity{ private: CIwMat2D m_MatLocal; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*    */</span></span></span><span class="hljs-meta"> iwangle angle; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*    */</span></span></span><span class="hljs-meta"> iwangle angle_velocity; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*    */</span></span></span><span class="hljs-meta"> CIwSVec2 m_MoveVelocity; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   */</span></span></span><span class="hljs-meta"> uint32 m_NumPoints; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   */</span></span></span><span class="hljs-meta"> CIwSVec2 *m_Points; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   */</span></span></span><span class="hljs-meta"> CIwVec2 *m_PointsMod; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*  */</span></span></span><span class="hljs-meta"> CIwVec2 *m_Axis; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   */</span></span></span><span class="hljs-meta"> uint32 colour; public: </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*  */</span></span></span><span class="hljs-meta"> CEntity(CIwSVec2 position, CIwSVec2 *verts, int num_verts, uint32 colour = 0xff000000); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*  */</span></span></span><span class="hljs-meta"> virtual ~CEntity(); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   */</span></span></span><span class="hljs-meta"> void Update(int speed); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   */</span></span></span><span class="hljs-meta"> void Render(); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*     */</span></span></span><span class="hljs-meta"> void SetAngle(iwangle angle) {this-&gt;angle = angle % IW_ANGLE_PI;}; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*     */</span></span></span><span class="hljs-meta"> void Rotate(iwangle rot_angle) { angle_velocity = rot_angle; } </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*     */</span></span></span><span class="hljs-meta"> void Move(CIwSVec2 move_velocity) { m_MoveVelocity = move_velocity; } </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*    */</span></span></span><span class="hljs-meta"> void SetColour(int colour){this-&gt;colour = colour;} </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*      */</span></span></span><span class="hljs-meta"> const CIwVec2 *GetVerts(){ return m_PointsMod; } </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   */</span></span></span><span class="hljs-meta"> int GetNumVerts() {return m_NumPoints;} </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*   .         */</span></span></span><span class="hljs-meta"> CIwVec2 CollideRect(CEntity *other, bool b_uncollide = false); private: </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*    */</span></span></span><span class="hljs-meta"> void UpdateVerts(); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*      */</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*         */</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* b_revert -   . */</span></span></span><span class="hljs-meta"> bool TestOverlaps(CEntity *other, CIwVec2 &amp;min_axis, int &amp;min_t, int b_revert); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*          */</span></span></span><span class="hljs-meta"> void GetInterval(const CIwVec2 *verts, int count, CIwVec2 axis, int &amp;min, int &amp;max); };</span></span></code> </pre><br><br>  Let's look at the implementation of the class itself.  Special attention should be paid to the methods: <b>CollideRect</b> and <b>TestOverlaps</b> . <br><br><pre> <code class="cpp hljs"> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"entity.h"</span></span></span><span class="hljs-meta"> CEntity::CEntity(CIwSVec2 position, CIwSVec2 *verts, int num_verts, uint32 colour ): m_MatLocal(CIwMat2D::g_Identity), m_MoveVelocity(CIwSVec2::g_Zero), angle(0), angle_velocity(0) { this-&gt;colour = colour; this-&gt;m_NumPoints = num_verts; m_Points = NULL; m_PointsMod = new CIwVec2[m_NumPoints]; m_Axis = new CIwVec2[num_verts]; m_MatLocal.t = position; m_Points = verts; } CEntity::~CEntity() { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(m_PointsMod)delete m_PointsMod; delete m_Axis; } void CEntity::Update(int speed) { angle += (angle_velocity * speed) / 1000; angle = angle % IW_ANGLE_2PI; m_MatLocal.SetRot(angle, false); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(!m_MoveVelocity.IsZero()) { m_MatLocal.t += ( m_MoveVelocity * speed) / 1000; } UpdateVerts(); } void CEntity::UpdateVerts() { </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(!m_Points) return; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*    */</span></span></span><span class="hljs-meta"> for(uint32 i = 0; i </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; m_NumPoints; ++i) { m_PointsMod[i] = m_MatLocal.TransformVec(m_Points[i]); } /*   */ for(uint32 i = 0; i &lt; m_NumPoints; ++i) { /*      */ m_Axis[i] = m_PointsMod[(i + 1) % m_NumPoints] - m_PointsMod[i]; /*  */ m_Axis[i].Normalise(); /*     */ m_Axis[i] = CIwVec2(-m_Axis[i].y, m_Axis[i].x); } } void CEntity::Render() { /*    */ Iw2DSetColour(colour); if(!m_Points)return; /*      */ Iw2DSetTransformMatrix(m_MatLocal); /*   */ Iw2DFillPolygon(m_Points, m_NumPoints); /*   */ Iw2DSetColour(0xff00ffff); Iw2DFillArc(CIwSVec2::g_Zero, CIwSVec2(5,5), 0, IW_ANGLE_2PI); } CIwVec2 CEntity::CollideRect(CEntity *other, bool b_uncollide) { /*   ,       */ int min_t(0); CIwVec2 min_axis(CIwFVec2::g_Zero); /*         ,   */ /*   ..      ,      */ /*        ,  ,    . */ if(!TestOverlaps(other, min_axis, min_t, false))return CIwVec2::g_Zero; if(!other-&gt;TestOverlaps(this, min_axis, min_t, true))return CIwVec2::g_Zero; /*   ,      */ if(b_uncollide){ CIwVec2 fvec = min_axis * min_t; /*   */ m_MatLocal.t += fvec; /*  . */ UpdateVerts(); } return min_axis * min_t; } bool CEntity::TestOverlaps(CEntity *other, CIwVec2 &amp;min_axis, int &amp;min_t, int b_revert) { /*   ,     */ const CIwVec2 *other_corner = other-&gt;GetVerts(); int other_corner_count = other-&gt;GetNumVerts(); /*       */ for (uint32 i = 0; i &lt; m_NumPoints; ++i) { int aMin; int aMax; int bMin; int bMax; /*           */ GetInterval(m_PointsMod, m_NumPoints, m_Axis[i], aMin, aMax); GetInterval(other_corner, other_corner_count, m_Axis[i], bMin, bMax); /* ,       */ if ((aMax &lt;= bMin) || (bMax &lt;= aMin)) { /*   .  */ return false; } /*   .  ,   ,      */ /*               */ int t = 0; if(aMax &gt;= bMin) { t = bMin - aMax ; if(min_axis.IsZero() || ABS(min_t) &gt; ABS(t)){ min_t = t * (b_revert?-1:1); min_axis = m_Axis[i]; } } if(bMax &gt;= aMin) { t = bMax - aMin; if(min_axis.IsZero() || ABS(min_t) &gt; ABS(t)){ min_t = t * (b_revert?-1:1); min_axis = m_Axis[i]; } } } return true; } void CEntity::GetInterval(const CIwVec2 *verts, int count, CIwVec2 axis, int &amp;min, int &amp;max) { min = max = axis.Dot(verts[0]); for (int i = 1; i &lt; count; i++) { int value = axis.Dot(verts[i]); min = MIN(min, value); max = MAX(max, value); } }</span></span></span></span></code> </pre><br><br>  Well, that's all, our application is ready.  Now we compile it and see the results. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/eUU71OQA63k%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhj1GpZTCp1MVnW7ym0-q2RvU5QNXw" frameborder="0" allowfullscreen=""></iframe><br><br>  I want to note that the application is quite simple and works with some error.  To remove it, you can, for example, use floats.  It would also do well to add a coarse, but faster, primary collision check.  You can also change the reaction of objects to collisions (for example, to bounce objects in a collision) and much more. <br><br>  Any criticism, comments, additions and corrections are welcome. <br><br>  When writing this article, one <a href="http://noregret.org/tutor/n/collision/">resource</a> dedicated to collision detection algorithms turned out to be very useful.  With good visual flash-examples. </div><p>Source: <a href="https://habr.com/ru/post/126785/">https://habr.com/ru/post/126785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126777/index.html">Orchard CMS extension: creating widgets</a></li>
<li><a href="../126778/index.html">AKADO as it should</a></li>
<li><a href="../126780/index.html">Video tour in the data center: The strategy of creating data centers</a></li>
<li><a href="../126782/index.html">Homemade googletranslateclient for linux</a></li>
<li><a href="../126784/index.html">Skype has agreed to purchase service GroupMe</a></li>
<li><a href="../126786/index.html">Support for RTL interfaces in GXT (Ext GWT)</a></li>
<li><a href="../126787/index.html">Headset with PS3 Headset Overview</a></li>
<li><a href="../126788/index.html">5 useful tricks</a></li>
<li><a href="../126790/index.html">WPF Applications Deployment: merging .NET assemblies into a single executable file</a></li>
<li><a href="../126791/index.html">In the wake of the post "Rapid development of web applications in Java"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>