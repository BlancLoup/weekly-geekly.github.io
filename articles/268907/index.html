<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 42: SHA-1 collisions, practical hacking of routers, Android / Security / Sadness</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When you are at the epicenter of events, it is sometimes difficult to understand what really happened. Being in a traffic jam, you will not know that ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 42: SHA-1 collisions, practical hacking of routers, Android / Security / Sadness</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/bc0/17a/a70/bc017aa70efe4f1b804382226ac60f61.jpg" align="right">  When you are at the epicenter of events, it is sometimes difficult to understand what really happened.  Being in a traffic jam, you will not know that it occurred due to an accident until you reach two shot down pilots who have occupied three lanes.  Up to this point, you simply do not have enough information to draw conclusions.  In the information security industry, it happens so often: the topic is complex, there are many nuances, and the result of some research can only be realistically assessed in a few years. <br><br>  This week, the three most interesting security news have nothing to do with each other, except for a thick layer of subtexts.  If you do not constantly deal with the topic, the importance of some events can be estimated incorrectly, or you may not see some important details.  I will try, as far as I can, to explain with examples, although the subtexts are such a thing ‚Äî everyone sees something different.  Welcome to episode 11 of Security Week.  Disruption Pokrovov.  Traditional rules: Every week, the editors of the news site <a href="https://threatpost.ru/">Threatpost</a> selects the three most significant news, to which I add an extended and merciless comment.  All episodes of the series can be found <a href="http://habrahabr.ru/search/%3Ftarget_type%3Dposts%26q%3D%255Bklsw%255D%2520%26order_by%3Ddate">here</a> . <br><a name="habracut"></a><br>  <b>The collision search for the SHA-1 algorithm has fallen in price seriously</b> <br>  <a href="https://threatpost.ru/algoritm-sha-1-mozhno-vzlomat-za-75-tys/12595/">News</a>  Bruce Schneier's <a href="https://www.schneier.com/blog/archives/2012/10/when_will_we_se.html">post</a> three years ago.  <a href="https://www.schneier.com/blog/archives/2015/10/sha-1_freestart.html">A new study</a> that changed the concept of security algorithm. <br><br>  Those who have come to know Linux a little further than the automatic installation of Ubuntu know that this system motivates them to read instructions.  I mean, first, of course, I try to google the dock, where the sequence of commands is simply indicated, but in some cases it will not work for me at first, and then everything will break.  This news is from the same series: without at least a minimum immersion in the materiel it is difficult to understand.  Despite the fact that this is perhaps the most difficult topic for the entire existence of the series, I will try to tell you what the essence is, in simple words. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/files/c95/323/ae5/c95323ae59c64f38b86d6a627f85c407.gif"></div><br>  <i>Well, somehow I will try.</i> <br><br>  SHA-1 is a cryptographic hashing algorithm.  Such an algorithm can be given at the input a sequence of data of almost unlimited length, and at the output to get 160 bits of information that allow you to identify the original data array.  Unless, of course, you have it: recovering information from the hash fails, the stuffing cannot be turned back. <br><br>  More precisely, it should not be obtained, even if, for example, there is a password for an unlucky user of type 123456. For any such algorithm there are two requirements: the inability to obtain source data, having only a hash and the inability to select such a pair of data sets so that their hash matches .  More precisely, the opportunity to do both is almost always there.  It just has to be connected with such a large amount of calculations that there is nothing even to try.  Well, that is, you buy the most powerful supercomputer, give it a task to break the cipher.  After 240 years, he says that the answer is 42, but by that time you don‚Äôt care. <br><br>  <i>But there is a nuance</i> .  First, the performance of computers is constantly growing.  Secondly, researchers are looking for workarounds to allow hacking into cryptographic systems.  For a hashing algorithm, finding a collision is much easier than decrypting the original data.  Meanwhile, the same SHA-1 is used in various encryption and authorization systems, where its main task is to make sure that the data of two different subscribers coincide.  If you can find two or more data arrays that have the same hash, and to do it <i>cheaply and quickly</i> , then the algorithm is no longer reliable. <br><br>  Perhaps, I‚Äôll stop on this, because then begins a very severe matan who doesn‚Äôt change the essence of the matter.  The work of researchers looks like this: we come up with a collision search algorithm, which allows us to find one in a slightly smaller number of operations than a simple search.  More precisely, it makes sense to talk about the attack of " <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D1%2582%25D0%25B0%25D0%25BA%25D0%25B0_%25C2%25AB%25D0%25B4%25D0%25BD%25D0%25B5%25D0%25B9_%25D1%2580%25D0%25BE%25D0%25B6%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F%25C2%25BB">Birthdays</a> ".  Birthdays, Karl! <br><br>  <i>I have some wrong simple words.</i> <br><br>  Then the researchers improve this algorithm, further reducing the number of operations.  As a result, the very attack, which required 240 years, becomes possible to accomplish in 120 years.  Or for 12. Or for 2. That's when instead of two and a half centuries it takes only two months, you can start to worry.  So, three years ago, Jessie Walker from Intel, a cryptographic expert, suggested that by 2015, finding the collisions of the SHA-1 algorithm would require two to eleventh degree server-years (well, if we take this spherical typical server in a vacuum).  Fortunately, thanks to cloud services, specifically Amazon EC2, you can calculate a more specific monetary equivalent: about 700 thousand dollars and you will get a theoretical way, for example, to fake a digital signature in a relatively short time. <br><br>  But it was a 2012 estimate.  It turned out that even then the SHA-1 algorithm was not as reliable as we would like, only very wealthy organizations could exploit this <i>unreliability</i> , for example, the intelligence of some non-poor country.  Naturally, such offices are not in a hurry to issue press releases about their successes in the field of the fight against cryptography.  So it is more important to understand when access to such a ‚Äútool‚Äù will be obtained, albeit well-to-do, but cybercriminals. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e65/2b2/8d7/e652b28d7bcd4b9ca6104f44defa82f4.jpg"></div><br><br>  Recently, a team of researchers from universities in the Netherlands, Singapore and France published a report in which they shared new ideas for optimizing the collision search algorithm.  Thanks to them, in short, the real attack can cost "at Amazon prices" only 75 thousand dollars and take about 49 days.  Well, or more expensive and faster, as you like.  Well-known expert in the field of cryptography Bruce Schneier commented on it this way: the 2012 assessment took into account Moore's law, but did not take into account the improvement of the attack algorithm and the <i>method of</i> conducting the attack (for example, using graphics processors for calculations that perform the task faster and cheaper).  It is really impossible to reliably predict the effect of such optimization. <br><br>  And then we ask the traditional question: in practice is this new research and a new assessment of someone threatening?  Not so much.  How can such ‚Äúvulnerabilities‚Äù be exploited?  There is <a href="https://threatpost.ru/issledovateli-smogli-vosproizvesti-ataku-kolliziej-hesha/4558/">an example</a> for a much less robust MD5 algorithm: we take two different files (in this case, we used photos of rock stars) and, successively modifying the data in one of them, we end up with the same hash for two completely different images. <br><br>  And if more specifically?  Cyber ‚Äã‚Äãspy campaign <a href="https://securelist.ru/blog/intsidenty/2762/flame-rasprostranenie-cherez-mitm-ataku-i-fal/">Flame</a> used this technique to sign a malicious file with a valid (at that time) Microsoft certificate.  More precisely, the signature was fake, but the hashes of the fake signature and the real one coincided.  According to <a href="https://threatpost.com/what-have-we-learned-flame-malware-061512/76701/">independent estimates</a> , such a trick, even with a weaker algorithm, could cost from 200 thousand to 2 million dollars.  Expensive! <br><br>  And what about SHA-1?  The algorithm has been used since 1995, and, in general, already in 2005, 10 years ago, it was clear that this is not the most reliable technology in the world.  But even with the new input data, the practical operation is still far away, while SHA-1 is gradually being withdrawn from use and replaced with more reliable hashing algorithms.  Until 2017, the developers of the main browsers plan to abandon the use of SHA-1.  Perhaps we should hurry, because if in three years the estimated price of the attack fell from 2.77 million dollars to 100 thousand, what could happen in a year?  On the other hand, all SHA-1 vulnerability studies have so far been of purely scientific value.  Trying to understand in practice what this threatens is the same as from the message ‚Äú250 tons of rocket fuel burned over April 12 over Kazakhstan‚Äù to conclude that a man first flew into space, not knowing this in advance.  Wait and see. <br><br>  Fun fact: a hash is generally properly called a digest or message digest.  So, you just listened to a digest about a digest.  Recursion, uiiii! <br><br>  <b>Vulnerability in Netgear routers is exploited in practice</b> <br>  <a href="https://threatpost.ru/disclosed-netgear-router-vulnerability-under-attack/12574/">News</a>  <a href="http://seclists.org/fulldisclosure/2015/Oct/29">Description of the</a> vulnerability. <br><br>  A vulnerability has been discovered in Netgear N300 routers.  Well, yes, another hole in the routers, and somehow it turns out that they are all different, but at the same time on the same person.  In one of the previous series, we have already <a href="http://habrahabr.ru/company/kaspersky/blog/266119/">discussed a</a> bunch of holes in Belkin devices.  At Netgear and all somehow completely offensive.  Open the web interface of the router.  We enter the password, wrong, because the router is someone else's and we do not know the password.  We are sent to the page where they write Access Denied.  But if you try to open a page with the name BRS_netgear_success.html, then ... we, too, will not be allowed anywhere.  But if you try to do it several times in a row, then they will let it go. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/284/42f/101/28442f1013264d96a5187d7ea946f4f7.jpg"></div><br><br>  Naturally, it is desirable to be already inside the local network, which somewhat complicates the task.  Although if a router, for example, distributes WiFi to a cafe, getting inside is not a problem.  And if the owner for some reason turned on access to the web interface from the Internet, then in general everything is simple.  By the way, can anyone say why, in principle, you need access to the web interface from the outside?  It is to the web interface of the router, and not to any pieces on the local network.  It seems to me there are no reasons for doing this at all, but, as you see, there are plenty of reasons not to do it. <br><br>  In general, everything went quite well here: the vendor was notified, two months later he made a beta version of the firmware.  It would have cost a little bit more, but no, it turned out that the vulnerability was exploited, as they say, ‚Äúin the fields‚Äù.  The Swiss company Compass Security discovered such a router with changed settings: the address of the provider was not registered as the DNS server, as is usually the case, but don‚Äôt understand what.  Accordingly, all DNS queries passed through this nepolimichto.  An investigation of the server of the attackers showed that it ‚Äúservices‚Äù more than 10 thousand hacked routers. <br><br>  Fun fact: Compass Security has been unable to get any response from NetGear for quite a while.  Then the dialogue did happen, and they even sent a beta version of the firmware for verification.  But here (out of nowhere) Shellshock Labs company appeared and published its study of the same vulnerability without any agreement with anyone at all (which, however, is not very good).  Of course, to call a company after a bug in bash is cool, but the principle of "do no harm" has not been canceled.  But from the study of "shell shooters" it becomes clear where the vulnerability in the web interface came from.  The firmware code provides the ability to enter the web interface without a password <i>once, at the first launch</i> .  To further it did not work, a flag was provided, which was simply forgotten.  Yes, the firmware was finally <a href="https://threatpost.ru/netgear-publishes-patched-firmware-for-routers-under-attack/12693/">updated</a> . <br><br>  <b>85% of Android devices are insecure</b> <br>  <a href="https://threatpost.ru/researchers-find-85-percent-of-android-devices-insecure/12759/">News</a>  <a href="http://androidvulnerabilities.org/">The site of researchers</a> , with a rating of security vendors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/264/044/f3b/264044f3ba504711b76f2aeecf4b25d9.jpg"></div><br><br>  What do you mean!  Never was this, and here again!  Meanwhile, we are talking about another scientific study, although of course not as much as in the history of SHA-1.  Researchers from the University of Cambridge did an interesting thing.  We collected data on 32 serious vulnerabilities in Android, so we chose 13 of them to be the most serious, and immediately checked many phones from different manufacturers for the presence of this vulnerability.  They checked it like this: they made <a href="https://play.google.com/store/apps/details%3Fid%3Duk.ac.cam.deviceanalyzer">the</a> Device Analyzer <a href="https://play.google.com/store/apps/details%3Fid%3Duk.ac.cam.deviceanalyzer">application</a> , through which various anonymous telemetry was openly collected from the experiment participants, including such parameters as the OS version and the build number.  In total, we managed to collect information from more than 20 thousand smartphones. <br><br>  Further, comparing the version number of Android with information about vulnerabilities, we were able to <i>roughly</i> estimate the scale of the trouble.  The result was this picture: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f9e/e6e/d05/f9ee6ed05abb42ffa148d2f63f205d9e.jpg"></div><br><br>  Averaging the indicators for the entire study time gave the same figure of 85% - on average, at any given time, this proportion of Android devices is exposed to one of the known and potentially dangerous vulnerabilities.  Or not one.  As usual, the emphasis should be placed on ‚Äúpotentially‚Äù - using the example of <a href="https://threatpost.ru/globalnyj-vzlom-android-foto-i-pochta-dostupny-hakeram/10373/">Stagefright</a> it is clear that even the most dangerous vulnerability is subject to severe restrictions on practical implementation. <br><br>  But the researchers did not stop there and made a rating of the ‚Äúdanger‚Äù of devices by manufacturers, calling it FUM Score.  It also takes into account the vendor's reaction time to information about a new vulnerability ‚Äî how quickly the patch appears in the devices of a particular manufacturer.  The winner was, predictably, the Nexus series of smartphones: it fixes bugs as quickly as possible.  LG is second, Motorola is third.  But there are actually no ‚Äúwinners‚Äù here, only losers.  The calculation takes into account the proportion of updated devices, that is, not only the vendor must release the patch, but also the owner - do not be lazy to update.  The older the device, the worse: in a separate rating on the models of smartphones not the oldest devices of two or three years ago are very dull indicators.  Why?  Do not update.  But enjoy. <br><br>  In general, there are quite a few voluntary assumptions in the research methodology, and it also proves what everyone knows already.  According to the researchers, one of the goals of their work is an additional motivation of manufacturers to repair the system of patching holes in their devices.  But what is really important: in the picture above, we see an example of an ecosystem that, in principle, cannot be one hundred percent safe.  Although Android with its fragmentation is the most telling example, there are many such ecosystems.  You can say that iOS is safer, but as the first story of the digest pro, um, digest, there are no absolutely reliable systems, there are limitations on the budget.  And this is such a very important point when choosing a protection strategy. <br><br>  <b>What else happened:</b> <br>  Apple <a href="https://threatpost.ru/apple-removes-apps-that-expose-encrypted-traffic/12625/">removed</a> applications that installed root certificates from the App Store, which allowed them to intercept, track, or modify data transmitted over a secure connection.  For example, to block ads, or something worse.  I understand that new applications with this functionality can no longer be downloaded.  Why was it possible before? <br><br>  The European Aviation Safety Agency <a href="https://threatpost.ru/european-aviation-agency-warns-of-aircraft-hacking/12619/">reported</a> on the vulnerability in the <a href="https://ru.wikipedia.org/wiki/ACARS">ACARS</a> system used for data transmission between the aircraft and the ground station.  In general, it was initially clear that it was easy to send a fake message in the system without any package verification.  It‚Äôs impossible to steer an airplane, but you can send a message that will mislead the pilots.  Researchers <a href="https://conference.hitb.org/hitbsecconf2013ams/materials/D1T1%2520-%2520Hugo%2520Teso%2520-%2520Aircraft%2520Hacking%2520-%2520Practical%2520Aero%2520Series.pdf">spoke</a> about the vulnerability of ACARS (docks in PDF format) in 2013, but they were information security specialists, and here the supervisory authority directly responsible for security.  And this is good news. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  "Indicator-734" <br><br>  Dangerous resident virus.  Infects .COM files when they are loaded into memory.  The old beginning of the file encrypts, and uses 10h bytes of BIOS as the key.  Those.  files will be properly decrypted and normally executed only on a computer with the same BIOS version on which they were infected.  If, however, it was not possible to decrypt the old beginning of the file, the virus blocks the operation of the file (performs int 20h), after running its counters.  Depending on their condition (approximately 1 time per hour), the virus draws a red cross on the screen, in the center of which is the inscription: "VINDICATOR".  Intercepts int 1Ch, 21h. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 70.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/268907/">https://habr.com/ru/post/268907/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268895/index.html">IoT cloud on Netty or 10k rec-sec per core</a></li>
<li><a href="../268897/index.html">Difficulties of "translation"</a></li>
<li><a href="../268899/index.html">The scandal around Volkswagen and the role of programmers in it</a></li>
<li><a href="../268903/index.html">Hibernate Developer Documentation - Chapter V. Locks</a></li>
<li><a href="../268905/index.html">Do-it-yourself audio codec</a></li>
<li><a href="../268909/index.html">CRM is a mockingbird. We integrate amoCRM, telephony and cellular communication</a></li>
<li><a href="../268911/index.html">Interview with Audrey Tan, Part 1</a></li>
<li><a href="../268915/index.html">Accordion about architecture and localization</a></li>
<li><a href="../268917/index.html">Visualization of static and dynamic networks on R, part 6</a></li>
<li><a href="../268921/index.html">Steam Files. Part 2 - BLOB, CDR, VDF, PAK, VPK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>